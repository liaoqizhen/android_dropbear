cscope 15 $HOME/workspaces/h5/android/android/external/dropbear -q 0000015683 0002861756
	@agentfwd.h

24 #iâdeà
_AGENTFWD_H_


25 
	#_AGENTFWD_H_


	)

27 
	~"šşudes.h
"

28 
	~"chª£ssiÚ.h
"

29 
	~"chªÃl.h
"

30 
	~"auth.h
"

31 
	~"li¡.h
"

36 
	#MAX_AGENT_REPLY
 10000

	)

38 
svr_ag’Œeq
(
ChªSess
 * 
chª£ss
);

39 
svr_ag’tş—nup
(
ChªSess
 * 
chª£ss
);

40 
svr_ag’t£t
(
ChªSess
 *
chª£ss
);

43 
şi_lßd_ag’t_keys
(
m_li¡
 * 
»t_li¡
);

44 
ag’t_buf_sign
(
bufãr
 *
sigblob
, 
sign_key
 *
key
,

45 cÚ¡ *
d©a
, 
Ën
);

46 
şi_£tup_ag’t
(
ChªÃl
 *
chªÃl
);

49 #ifdeà
__hpux


50 
	#£‹uid
(
a
è
	`£Œesuid
(-1, (a), -1)

	)

51 
	#£‹gid
(
a
è
	`£Œesgid
(-1, (a), -1)

	)

54 cÚ¡ 
ChªTy³
 
şi_chª_ag’t
;

	@algo.h

25 #iâdeà
_ALGO_H_


27 
	#_ALGO_H_


	)

29 
	~"šşudes.h
"

30 
	~"bufãr.h
"

32 
	#DROPBEAR_MODE_UNUSED
 0

	)

33 
	#DROPBEAR_MODE_CBC
 1

	)

34 
	#DROPBEAR_MODE_CTR
 2

	)

36 
	sAlgo_Ty³
 {

38 *
	mÇme
;

39 
	mv®
;

40 cÚ¡ *
	md©a
;

41 
	mu§bË
;

42 cÚ¡ *
	mmode
;

46 
Algo_Ty³
 
	t®go_ty³
;

49 
®go_ty³
 
sshkex
[];

50 
®go_ty³
 
sshho¡key
[];

51 
®go_ty³
 
sshch”s
[];

52 
®go_ty³
 
sshhashes
[];

53 
®go_ty³
 
ssh_com´ess
[];

54 
®go_ty³
 
ssh_nocom´ess
[];

56 cÚ¡ 
drİb—r_ch”
 
drİb—r_noch”
;

57 cÚ¡ 
drİb—r_ch”_mode
 
drİb—r_mode_nÚe
;

58 cÚ¡ 
drİb—r_hash
 
drİb—r_nohash
;

60 
	sdrİb—r_ch”
 {

61 cÚ¡ 
Éc_ch”_desütÜ
 *
	mch”desc
;

62 
	mkeysize
;

63 
	mblocksize
;

66 
	sdrİb—r_ch”_mode
 {

67 (*
	m¡¬t
)(
	mch”
, cÚ¡ *
	mIV
,

68 cÚ¡ *
	mkey
,

69 
	mkeyËn
, 
	mnum_rounds
, *
	mch”_¡©e
);

70 (*
	m’üy±
)(cÚ¡ *
	m±
, *
	mù
,

71 
	mËn
, *
	mch”_¡©e
);

72 (*
	mdeüy±
)(cÚ¡ *
	mù
, *
	m±
,

73 
	mËn
, *
	mch”_¡©e
);

76 
	sdrİb—r_hash
 {

77 cÚ¡ 
Éc_hash_desütÜ
 *
	mhashdesc
;

78 
	mkeysize
;

79 
	mhashsize
;

82 
üy±o_š™
();

83 
have_®go
(* 
®go
, 
size_t
 
®gŞ’
, 
®go_ty³
 
®gos
[]);

84 
buf_put_®gŞi¡
(
bufãr
 * 
buf
, 
®go_ty³
 
loÿÏlgos
[]);

86 
®go_ty³
 * 
svr_buf_m©ch_®go
(
bufãr
* 
buf
,‡lgo_ty³ 
loÿÏlgos
[],

87 *
goodguess
);

88 
®go_ty³
 * 
şi_buf_m©ch_®go
(
bufãr
* 
buf
,‡lgo_ty³ 
loÿÏlgos
[],

89 *
goodguess
);

	@atomicio.c

30 
	~"©omicio.h
"

35 
ssize_t


36 
	$©omicio
(
f
, 
fd
, 
_s
, 
n
)

37 
	`ssize_t
 (*
f
) ();

38 
fd
;

39 *
_s
;

40 
size_t
 
n
;

42 *
s
 = 
_s
;

43 
ssize_t
 
»s
;

44 
size_t
 
pos
 = 0;

46 
n
 > 
pos
) {

47 
»s
 = (
f
è(
fd
, 
s
 + 
pos
, 
n
 -…os);

48 
»s
) {

50 #ifdeà
EWOULDBLOCK


51 ià(
”ºo
 =ğ
EINTR
 ||ƒ¼nØ=ğ
EAGAIN
 ||ƒ¼nØ=ğ
EWOULDBLOCK
)

53 ià(
”ºo
 =ğ
EINTR
 ||ƒ¼nØ=ğ
EAGAIN
)

57  (
»s
);

59 
pos
 +ğ
»s
;

62  (
pos
);

63 
	}
}

	@atomicio.h

31 
	~"šşudes.h
"

36 
ssize_t
 
©omicio
(ssize_ˆ(*)(), , *, 
size_t
);

	@auth.h

25 #iâdeà
_AUTH_H_


26 
	#_AUTH_H_


	)

28 
	~"šşudes.h
"

29 
	~"signkey.h
"

30 
	~"chª£ssiÚ.h
"

32 
svr_authš™Ÿli£
();

33 
şi_authš™Ÿli£
();

36 
»cv_msg_u£¿uth_»que¡
();

37 
£nd_msg_u£¿uth_çu»
(
·¹Ÿl
, 
šüç
);

38 
£nd_msg_u£¿uth_sucûss
();

39 
svr_auth_·sswÜd
();

40 
svr_auth_pubkey
();

41 
svr_auth_·m
();

43 #ifdeà
ENABLE_SVR_PUBKEY_OPTIONS


44 
svr_pubkey_®lows_ag’tfwd
();

45 
svr_pubkey_®lows_tıfwd
();

46 
svr_pubkey_®lows_x11fwd
();

47 
svr_pubkey_®lows_±y
();

48 
svr_pubkey_£t_fÜûd_commªd
(
ChªSess
 *
chª£ss
);

49 
svr_pubkey_İtiÚs_ş—nup
();

50 
svr_add_pubkey_İtiÚs
(
bufãr
 *
İtiÚs_buf
, 
lše_num
, cÚ¡ * 
f’ame
);

53 
	#svr_pubkey_®lows_ag’tfwd
(è1

	)

54 
	#svr_pubkey_®lows_tıfwd
(è1

	)

55 
	#svr_pubkey_®lows_x11fwd
(è1

	)

56 
	#svr_pubkey_®lows_±y
(è1

	)

57 
šlše
 
	$svr_pubkey_£t_fÜûd_commªd
(
ChªSess
 *
chª£ss
è{ 
	}
}

58 
šlše
 
	$svr_pubkey_İtiÚs_ş—nup
(è{ 
	}
}

59 
	#svr_add_pubkey_İtiÚs
(
x
,
y
,
z
è
DROPBEAR_SUCCESS


	)

63 
»cv_msg_u£¿uth_çu»
();

64 
»cv_msg_u£¿uth_sucûss
();

65 
»cv_msg_u£¿uth_¥ecific_60
();

66 
»cv_msg_u£¿uth_pk_ok
();

67 
»cv_msg_u£¿uth_šfo_»que¡
();

68 
şi_g‘_u£r
();

69 
şi_auth_g‘m‘hods
();

70 
şi_auth_Œy
();

71 
»cv_msg_u£¿uth_bªÃr
();

72 
şi_pubkeyç
();

73 
şi_auth_·sswÜd
();

74 
şi_auth_pubkey
();

75 
şi_auth_š‹¿ùive
();

76 * 
g‘·ss_Ü_ÿnûl
(* 
´om±
);

77 
şi_auth_pubkey_ş—nup
();

80 
	#MAX_USERNAME_LEN
 25

	)

82 
	#AUTH_TYPE_NONE
 1

	)

83 
	#AUTH_TYPE_PUBKEY
 1 << 1

	)

84 
	#AUTH_TYPE_PASSWORD
 1 << 2

	)

85 
	#AUTH_TYPE_INTERACT
 1 << 3

	)

87 
	#AUTH_METHOD_NONE
 "nÚe"

	)

88 
	#AUTH_METHOD_NONE_LEN
 4

	)

89 
	#AUTH_METHOD_PUBKEY
 "publickey"

	)

90 
	#AUTH_METHOD_PUBKEY_LEN
 9

	)

91 
	#AUTH_METHOD_PASSWORD
 "·sswÜd"

	)

92 
	#AUTH_METHOD_PASSWORD_LEN
 8

	)

93 
	#AUTH_METHOD_INTERACT
 "keybßrd-š‹¿ùive"

	)

94 
	#AUTH_METHOD_INTERACT_LEN
 20

	)

101 
	sAuthS‹
 {

102 *
	mu£ºame
;

104 
	mauthty³s
;

106 
	mçcouÁ
;

107 
	mauthdÚe
 : 1;

110 
	m³rm_w¬n
 : 1;

115 
uid_t
 
	mpw_uid
;

116 
gid_t
 
	mpw_gid
;

117 *
	mpw_dœ
;

118 *
	mpw_sh–l
;

119 *
	mpw_Çme
;

120 *
	mpw_·sswd
;

121 #ifdeà
ENABLE_SVR_PUBKEY_OPTIONS


122 
PubKeyO±iÚs
* 
	mpubkey_İtiÚs
;

126 #ifdeà
ENABLE_SVR_PUBKEY_OPTIONS


127 
	gPubKeyO±iÚs
;

128 
	sPubKeyO±iÚs
 {

130 
	mno_pÜt_fÜw¬dšg_æag
;

131 
	mno_ag’t_fÜw¬dšg_æag
;

132 
	mno_x11_fÜw¬dšg_æag
;

133 
	mno_±y_æag
;

135 * 
	mfÜûd_commªd
;

136 * 
	mÜigš®_commªd
;

	@bignum.c

27 
	~"šşudes.h
"

28 
	~"dbut.h
"

31 
	$m_mp_š™
(
mp_št
 *
mp
) {

33 ià(
	`mp_š™
(
mp
è!ğ
MP_OKAY
) {

34 
	`drİb—r_ex™
("Mem‡llocƒrror");

36 
	}
}

40 
	$m_mp_š™_muÉi
(
mp_št
 *
mp
, ...)

42 
mp_št
* 
cur_¬g
 = 
mp
;

43 
va_li¡
 
¬gs
;

45 
	`va_¡¬t
(
¬gs
, 
mp
);

46 
cur_¬g
 !ğ
NULL
) {

47 ià(
	`mp_š™
(
cur_¬g
è!ğ
MP_OKAY
) {

48 
	`drİb—r_ex™
("Mem‡llocƒrror");

50 
cur_¬g
 = 
	`va_¬g
(
¬gs
, 
mp_št
*);

52 
	`va_’d
(
¬gs
);

53 
	}
}

55 
	$by‹s_to_mp
(
mp_št
 *
mp
, cÚ¡ * 
by‹s
, 
Ën
) {

57 ià(
	`mp_»ad_unsigÃd_bš
(
mp
, (*)
by‹s
, 
Ën
è!ğ
MP_OKAY
) {

58 
	`drİb—r_ex™
("Mem‡llocƒrror");

60 
	}
}

63 
	$sha1_´oûss_mp
(
hash_¡©e
 *
hs
, 
mp_št
 *
mp
) {

65 
i
;

66 
bufãr
 * 
buf
;

68 
buf
 = 
	`buf_Ãw
(512 + 20);

70 
	`buf_putmpšt
(
buf
, 
mp
);

71 
i
 = 
buf
->
pos
;

72 
	`buf_£os
(
buf
, 0);

73 
	`sha1_´oûss
(
hs
, 
	`buf_g‘±r
(
buf
, 
i
), i);

74 
	`buf_ä“
(
buf
);

75 
	}
}

	@bignum.h

25 #iâdeà
_BIGNUM_H_


26 
	#_BIGNUM_H_


	)

28 
	~"šşudes.h
"

30 
m_mp_š™
(
mp_št
 *
mp
);

31 
m_mp_š™_muÉi
(
mp_št
 *
mp
, ...);

32 
by‹s_to_mp
(
mp_št
 *
mp
, cÚ¡ * 
by‹s
, 
Ën
);

33 
sha1_´oûss_mp
(
hash_¡©e
 *
hs
, 
mp_št
 *
mp
);

	@buffer.c

27 
	~"šşudes.h
"

28 
	~"dbut.h
"

29 
	~"bufãr.h
"

34 
	#BUF_MAX_INCR
 1000000000

	)

35 
	#BUF_MAX_SIZE
 1000000000

	)

38 
	#BUF_MAX_MPINT
 (8240 / 8)

	)

41 
bufãr
* 
	$buf_Ãw
(
size
) {

43 
bufãr
* 
buf
;

45 ià(
size
 > 
BUF_MAX_SIZE
) {

46 
	`drİb—r_ex™
("buf->sizeoo big");

49 
buf
 = (
bufãr
*)
	`m_m®loc
((buffer));

51 ià(
size
 > 0) {

52 
buf
->
d©a
 = (*)
	`m_m®loc
(
size
);

54 
buf
->
d©a
 = 
NULL
;

57 
buf
->
size
 = size;

58 
buf
->
pos
 = 0;

59 
buf
->
Ën
 = 0;

61  
buf
;

63 
	}
}

66 
	$buf_ä“
(
bufãr
* 
buf
) {

68 
	`m_ä“
(
buf
->
d©a
)

69 
	`m_ä“
(
buf
);

70 
	}
}

73 
	$buf_buº
(
bufãr
* 
buf
) {

75 
	`m_buº
(
buf
->
d©a
, buf->
size
);

77 
	}
}

81 
	$buf_»size
(
bufãr
 *
buf
, 
Ãwsize
) {

83 ià(
Ãwsize
 > 
BUF_MAX_SIZE
) {

84 
	`drİb—r_ex™
("buf->sizeoo big");

87 
buf
->
d©a
 = 
	`m_»®loc
(buf->d©a, 
Ãwsize
);

88 
buf
->
size
 = 
Ãwsize
;

89 
buf
->
Ën
 = 
	`MIN
(
Ãwsize
, buf->len);

90 
buf
->
pos
 = 
	`MIN
(
Ãwsize
, buf->pos);

92 
	}
}

96 
bufãr
* 
	$buf_Ãwcİy
(
bufãr
* 
buf
) {

98 
bufãr
* 
»t
;

100 
»t
 = 
	`buf_Ãw
(
buf
->
Ën
);

101 
»t
->
Ën
 = 
buf
->len;

102 
	`memıy
(
»t
->
d©a
, 
buf
->d©a, buf->
Ën
);

103  
»t
;

104 
	}
}

107 
	$buf_£’
(
bufãr
* 
buf
, 
Ën
) {

108 ià(
Ën
 > 
buf
->
size
) {

109 
	`drİb—r_ex™
("Bad buf_setlen");

111 
buf
->
Ën
 =†en;

112 
	}
}

115 
	$buf_šüËn
(
bufãr
* 
buf
, 
šü
) {

116 ià(
šü
 > 
BUF_MAX_INCR
 || 
buf
->
Ën
 + inü > buf->
size
) {

117 
	`drİb—r_ex™
("Bad buf_incrlen");

119 
buf
->
Ën
 +ğ
šü
;

120 
	}
}

122 
	$buf_£os
(
bufãr
* 
buf
, 
pos
) {

124 ià(
pos
 > 
buf
->
Ën
) {

125 
	`drİb—r_ex™
("Bad buf_setpos");

127 
buf
->
pos
 =…os;

128 
	}
}

131 
	$buf_šüwr™•os
(
bufãr
* 
buf
, 
šü
) {

132 ià(
šü
 > 
BUF_MAX_INCR
 || 
buf
->
pos
 + inü > buf->
size
) {

133 
	`drİb—r_ex™
("Bad buf_incrwritepos");

135 
buf
->
pos
 +ğ
šü
;

136 ià(
buf
->
pos
 > buf->
Ën
) {

137 
buf
->
Ën
 = buf->
pos
;

139 
	}
}

143 
	$buf_šüpos
(
bufãr
* 
buf
, 
šü
) {

144 ià(
šü
 > 
BUF_MAX_INCR
 ||

145 ()(()
buf
->
pos
 + 
šü
è> buf->
Ën


146 || (()
buf
->
pos
 + 
šü
) < 0) {

147 
	`drİb—r_ex™
("Bad buf_incrpos");

149 
buf
->
pos
 +ğ
šü
;

150 
	}
}

153 
	$buf_g‘by‹
(
bufãr
* 
buf
) {

157 ià(
buf
->
pos
 >ğbuf->
Ën
) {

158 
	`drİb—r_ex™
("Bad buf_getbyte");

160  
buf
->
d©a
[buf->
pos
++];

161 
	}
}

164 
	$buf_g‘boŞ
(
bufãr
* 
buf
) {

166 
b
;

167 
b
 = 
	`buf_g‘by‹
(
buf
);

168 ià(
b
 != 0)

169 
b
 = 1;

170  
b
;

171 
	}
}

174 
	$buf_putby‹
(
bufãr
* 
buf
, 
v®
) {

176 ià(
buf
->
pos
 >ğbuf->
Ën
) {

177 
	`buf_šüËn
(
buf
, 1);

179 
buf
->
d©a
[buf->
pos
] = 
v®
;

180 
buf
->
pos
++;

181 
	}
}

185 * 
	$buf_g‘±r
(
bufãr
* 
buf
, 
Ën
) {

187 ià(
buf
->
pos
 + 
Ën
 > buf->len) {

188 
	`drİb—r_ex™
("Bad buf_getptr");

190  &
buf
->
d©a
[buf->
pos
];

191 
	}
}

195 * 
	$buf_g‘wr™•Œ
(
bufãr
* 
buf
, 
Ën
) {

197 ià(
buf
->
pos
 + 
Ën
 > buf->
size
) {

198 
	`drİb—r_ex™
("Bad buf_getwriteptr");

200  &
buf
->
d©a
[buf->
pos
];

201 
	}
}

206 * 
	$buf_g‘¡ršg
(
bufãr
* 
buf
, *
»’
) {

208 
Ën
;

209 * 
»t
;

210 
Ën
 = 
	`buf_g‘št
(
buf
);

211 ià(
Ën
 > 
MAX_STRING_LEN
) {

212 
	`drİb—r_ex™
("Stringoo†ong");

215 ià(
»’
 !ğ
NULL
) {

216 *
»’
 = 
Ën
;

218 
»t
 = 
	`m_m®loc
(
Ën
+1);

219 
	`memıy
(
»t
, 
	`buf_g‘±r
(
buf
, 
Ën
),†en);

220 
	`buf_šüpos
(
buf
, 
Ën
);

221 
»t
[
Ën
] = '\0';

223  
»t
;

224 
	}
}

227 
bufãr
 * 
	$buf_g‘¡ršgbuf
(
bufãr
 *
buf
) {

228 
bufãr
 *
»t
;

229 * 
¡r
;

230 
Ën
;

231 
¡r
 = 
	`buf_g‘¡ršg
(
buf
, &
Ën
);

232 
»t
 = 
	`m_m®loc
((*ret));

233 
»t
->
d©a
 = 
¡r
;

234 
»t
->
Ën
 =†en;

235 
»t
->
size
 = 
Ën
;

236 
»t
->
pos
 = 0;

237  
»t
;

238 
	}
}

242 
	$buf_—t¡ršg
(
bufãr
 *
buf
) {

244 
	`buf_šüpos
Ğ
buf
, 
	`buf_g‘št
(buf) );

245 
	}
}

248 
	$buf_g‘št
(
bufãr
* 
buf
) {

249 
»t
;

251 
	`LOAD32H
(
»t
, 
	`buf_g‘±r
(
buf
, 4));

252 
	`buf_šüpos
(
buf
, 4);

253  
»t
;

254 
	}
}

257 
	$buf_putšt
(
bufãr
* 
buf
, 
v®
) {

259 
	`STORE32H
(
v®
, 
	`buf_g‘wr™•Œ
(
buf
, 4));

260 
	`buf_šüwr™•os
(
buf
, 4);

262 
	}
}

265 
	$buf_put¡ršg
(
bufãr
* 
buf
, cÚ¡ * 
¡r
, 
Ën
) {

267 
	`buf_putšt
(
buf
, 
Ën
);

268 
	`buf_putby‹s
(
buf
, 
¡r
, 
Ën
);

270 
	}
}

274 
	$buf_putby‹s
(
bufãr
 *
buf
, cÚ¡ *
by‹s
, 
Ën
) {

275 
	`memıy
(
	`buf_g‘wr™•Œ
(
buf
, 
Ën
), 
by‹s
,†en);

276 
	`buf_šüwr™•os
(
buf
, 
Ën
);

277 
	}
}

282 
	$buf_putmpšt
(
bufãr
* 
buf
, 
mp_št
 * 
mp
) {

284 
Ën
, 
·d
 = 0;

285 
	`TRACE
(("enter buf_putmpint"))

287 
	`drİb—r_as£¹
(
mp
 !ğ
NULL
);

289 ià(
	`SIGN
(
mp
è=ğ
MP_NEG
) {

290 
	`drİb—r_ex™
("negative bignum");

294 ià(
	`USED
(
mp
è=ğ1 && 
	`DIGIT
(mp, 0) == 0) {

295 
Ën
 = 0;

299 
Ën
 = 
	`mp_couÁ_b™s
(
mp
);

301 
·d
 = (
Ën
%8 == 0) ? 1 : 0;

302 
Ën
 =†en / 8 + 1;

308 
	`buf_putšt
(
buf
, 
Ën
);

311 ià(
Ën
 > 0) {

312 ià(
·d
) {

313 
	`buf_putby‹
(
buf
, 0x00);

315 ià(
	`mp_to_unsigÃd_bš
(
mp
, 
	`buf_g‘wr™•Œ
(
buf
, 
Ën
-
·d
)è!ğ
MP_OKAY
) {

316 
	`drİb—r_ex™
("mpintƒrror");

318 
	`buf_šüwr™•os
(
buf
, 
Ën
-
·d
);

321 
	`TRACE
(("leave buf_putmpint"))

322 
	}
}

327 
	$buf_g‘mpšt
(
bufãr
* 
buf
, 
mp_št
* 
mp
) {

329 
Ën
;

330 
Ën
 = 
	`buf_g‘št
(
buf
);

332 ià(
Ën
 == 0) {

333 
	`mp_z”o
(
mp
);

334  
DROPBEAR_SUCCESS
;

337 ià(
Ën
 > 
BUF_MAX_MPINT
) {

338  
DROPBEAR_FAILURE
;

342 ià(*
	`buf_g‘±r
(
buf
, 1è& (1 << (
CHAR_BIT
-1))) {

343  
DROPBEAR_FAILURE
;

346 ià(
	`mp_»ad_unsigÃd_bš
(
mp
, 
	`buf_g‘±r
(
buf
, 
Ën
),†’è!ğ
MP_OKAY
) {

347  
DROPBEAR_FAILURE
;

350 
	`buf_šüpos
(
buf
, 
Ën
);

351  
DROPBEAR_SUCCESS
;

352 
	}
}

	@buffer.h

25 #iâdeà
_BUFFER_H_


27 
	#_BUFFER_H_


	)

29 
	~"šşudes.h
"

31 
	sbuf
 {

33 * 
	md©a
;

34 
	mËn
;

35 
	mpos
;

36 
	msize
;

40 
buf
 
	tbufãr
;

42 
bufãr
 * 
buf_Ãw
(
size
);

43 
buf_»size
(
bufãr
 *
buf
, 
Ãwsize
);

44 
buf_ä“
(
bufãr
* 
buf
);

45 
buf_buº
(
bufãr
* 
buf
);

46 
bufãr
* 
buf_Ãwcİy
(bufãr* 
buf
);

47 
buf_£’
(
bufãr
* 
buf
, 
Ën
);

48 
buf_šüËn
(
bufãr
* 
buf
, 
šü
);

49 
buf_£os
(
bufãr
* 
buf
, 
pos
);

50 
buf_šüpos
(
bufãr
* 
buf
, 
šü
);

51 
buf_šüwr™•os
(
bufãr
* 
buf
, 
šü
);

52 
buf_g‘by‹
(
bufãr
* 
buf
);

53 
buf_g‘boŞ
(
bufãr
* 
buf
);

54 
buf_putby‹
(
bufãr
* 
buf
, 
v®
);

55 * 
buf_g‘±r
(
bufãr
* 
buf
, 
Ën
);

56 * 
buf_g‘wr™•Œ
(
bufãr
* 
buf
, 
Ën
);

57 * 
buf_g‘¡ršg
(
bufãr
* 
buf
, *
»’
);

58 
bufãr
 * 
buf_g‘¡ršgbuf
(bufã¸*
buf
);

59 
buf_—t¡ršg
(
bufãr
 *
buf
);

60 
buf_putšt
(
bufãr
* 
buf
, 
v®
);

61 
buf_put¡ršg
(
bufãr
* 
buf
, cÚ¡ * 
¡r
, 
Ën
);

62 
buf_putby‹s
(
bufãr
 *
buf
, cÚ¡ *
by‹s
, 
Ën
);

63 
buf_putmpšt
(
bufãr
* 
buf
, 
mp_št
 * 
mp
);

64 
buf_g‘mpšt
(
bufãr
* 
buf
, 
mp_št
* 
mp
);

65 
buf_g‘št
(
bufãr
* 
buf
);

	@channel.h

25 #iâdeà
_CHANNEL_H_


26 
	#_CHANNEL_H_


	)

28 
	~"šşudes.h
"

29 
	~"bufãr.h
"

30 
	~"cœcbufãr.h
"

33 
	#CHANNEL_ID_NONE
 0

	)

34 
	#CHANNEL_ID_SESSION
 1

	)

35 
	#CHANNEL_ID_X11
 2

	)

36 
	#CHANNEL_ID_AGENT
 3

	)

37 
	#CHANNEL_ID_TCPDIRECT
 4

	)

38 
	#CHANNEL_ID_TCPFORWARDED
 5

	)

40 
	#SSH_OPEN_ADMINISTRATIVELY_PROHIBITED
 1

	)

41 
	#SSH_OPEN_CONNECT_FAILED
 2

	)

42 
	#SSH_OPEN_UNKNOWN_CHANNEL_TYPE
 3

	)

43 
	#SSH_OPEN_RESOURCE_SHORTAGE
 4

	)

46 
	#SSH_OPEN_IN_PROGRESS
 99

	)

48 
	#CHAN_EXTEND_SIZE
 3

	)

50 
	gChªTy³
;

52 
	sChªÃl
 {

54 
	mšdex
;

55 
	m»mÙechª
;

56 
	m»cvwšdow
, 
	mŒªswšdow
;

57 
	m»cvdÚ–’
;

58 
	m»cvmax·ck‘
, 
	mŒªsmax·ck‘
;

59 * 
	mty³d©a
;

60 
	mwr™efd
;

61 
	m»adfd
;

62 
	m”rfd
;

64 
cœcbufãr
 *
	mwr™ebuf
;

65 
cœcbufãr
 *
	mexŒabuf
;

69 
	m£Á_şo£
, 
	m»cv_şo£
;

70 
	m»cv_eof
, 
	m£Á_eof
;

72 
	mš™cÚn
;

75 
	mawa™_İ’
;

79 
	mæushšg
;

81 cÚ¡ 
ChªTy³
* 
	mty³
;

85 
	sChªTy³
 {

87 
	m£pfds
;

88 *
	mÇme
;

89 (*
	mš™hªdËr
)(
	mChªÃl
*);

90 (*
	mcheck_şo£
)(
	mChªÃl
*);

91 (*
	m»qhªdËr
)(
	mChªÃl
*);

92 (*
	mşo£hªdËr
)(
	mChªÃl
*);

96 
chªš™Ÿli£
(cÚ¡ 
ChªTy³
 *
chªty³s
[]);

97 
chªş—nup
();

98 
£tchªÃlfds
(
fd_£t
 *
»adfd
, fd_£ˆ*
wr™efd
);

99 
chªÃlio
(
fd_£t
 *
»adfd
, fd_£ˆ*
wr™efd
);

100 
ChªÃl
* 
g‘chªÃl
();

101 
ChªÃl
* 
ÃwchªÃl
(
»mÙechª
,

102 cÚ¡ 
ChªTy³
 *
ty³
,

103 
Œªswšdow
, 
Œªsmax·ck‘
);

105 
»cv_msg_chªÃl_İ’
();

106 
»cv_msg_chªÃl_»que¡
();

107 
£nd_msg_chªÃl_çu»
(
ChªÃl
 *
chªÃl
);

108 
£nd_msg_chªÃl_sucûss
(
ChªÃl
 *
chªÃl
);

109 
»cv_msg_chªÃl_d©a
();

110 
»cv_msg_chªÃl_ex‹nded_d©a
();

111 
»cv_msg_chªÃl_wšdow_adju¡
();

112 
»cv_msg_chªÃl_şo£
();

113 
»cv_msg_chªÃl_eof
();

115 
commÚ_»cv_msg_chªÃl_d©a
(
ChªÃl
 *
chªÃl
, 
fd
,

116 
cœcbufãr
 * 
buf
);

118 #ifdeà
DROPBEAR_CLIENT


119 cÚ¡ 
ChªTy³
 
şichª£ss
;

122 #ià
defšed
(
USING_LISTENERS
è|| defšed(
DROPBEAR_CLIENT
)

123 
£nd_msg_chªÃl_İ’_š™
(
fd
, cÚ¡ 
ChªTy³
 *
ty³
);

124 
»cv_msg_chªÃl_İ’_cÚfœm©iÚ
();

125 
»cv_msg_chªÃl_İ’_çu»
();

	@chansession.h

25 #iâdeà
_CHANSESSION_H_


26 
	#_CHANSESSION_H_


	)

28 
	~"logš»c.h
"

29 
	~"chªÃl.h
"

30 
	~"li¡’”.h
"

32 
	sex™šfo
 {

34 
	mex™pid
;

35 
	mex™¡©us
;

36 
	mex™sigÇl
;

37 
	mex™cÜe
;

40 
	sChªSess
 {

42 * 
	mcmd
;

43 
pid_t
 
	mpid
;

46 
	mma¡”
;

47 
	m¦ave
;

48 * 
	m‰y
;

49 * 
	m‹rm
;

52 
ex™šfo
 
	mex™
;

56 *
	mcÚÃùiÚ_¡ršg
;

58 #iâdeà
DISABLE_X11FWD


59 
Li¡’”
 * 
	mx11li¡’”
;

60 
	mx11pÜt
;

61 * 
	mx11auth´Ù
;

62 * 
	mx11authcook›
;

63 
	mx11sü“Âum
;

64 
	mx11sšgËcÚn
;

67 #ifdeà
ENABLE_SVR_AGENTFWD


68 
Li¡’”
 * 
	mag’i¡’”
;

69 * 
	mag’tfe
;

70 * 
	mag’tdœ
;

74 
	sChdPid
 {

75 
pid_t
 
	mpid
;

76 
ChªSess
 * 
	mchª£ss
;

80 
addÃwv¬
(cÚ¡ * 
·¿m
, cÚ¡ * 
v¬
);

82 
şi_£nd_chª£ss_»que¡
();

83 
şi_‰y_ş—nup
();

84 
şi_chª£ss_wšchªge
();

85 #ifdeà
ENABLE_CLI_NETCAT


86 
şi_£nd_Ãtÿt_»que¡
();

88 
şi_¡¬t_£nd_chªÃl_»que¡
(
ChªÃl
 *
chªÃl
, *
ty³
);

90 
svr_chª£ssš™Ÿli£
();

91 cÚ¡ 
ChªTy³
 
svrchª£ss
;

93 
	sSigM­
 {

94 
	msigÇl
;

95 * 
	mÇme
;

98 cÚ¡ 
SigM­
 
sigÇmes
[];

	@circbuffer.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"cœcbufãr.h
"

29 
	#MAX_CBUF_SIZE
 100000000

	)

31 
cœcbufãr
 * 
	$cbuf_Ãw
(
size
) {

33 
cœcbufãr
 *
cbuf
 = 
NULL
;

35 ià(
size
 > 
MAX_CBUF_SIZE
) {

36 
	`drİb—r_ex™
("Bad cbuf size");

39 
cbuf
 = (
cœcbufãr
*)
	`m_m®loc
((circbuffer));

40 
cbuf
->
d©a
 = (*)
	`m_m®loc
(
size
);

41 
cbuf
->
u£d
 = 0;

42 
cbuf
->
»adpos
 = 0;

43 
cbuf
->
wr™•os
 = 0;

44 
cbuf
->
size
 = size;

46  
cbuf
;

47 
	}
}

49 
	$cbuf_ä“
(
cœcbufãr
 * 
cbuf
) {

51 
	`m_ä“
(
cbuf
->
d©a
);

52 
	`m_ä“
(
cbuf
);

53 
	}
}

55 
	$cbuf_g‘u£d
(
cœcbufãr
 * 
cbuf
) {

57  
cbuf
->
u£d
;

59 
	}
}

61 
	$cbuf_g‘ava
(
cœcbufãr
 * 
cbuf
) {

63  
cbuf
->
size
 - cbuf->
u£d
;

65 
	}
}

67 
	$cbuf_»adËn
(
cœcbufãr
 *
cbuf
) {

69 
	`drİb—r_as£¹
(((2*
cbuf
->
size
)+cbuf->
wr™•os
-cbuf->
»adpos
)%cbuf->siz=ğcbuf->
u£d
%cbuf->size);

70 
	`drİb—r_as£¹
(((2*
cbuf
->
size
)+cbuf->
»adpos
-cbuf->
wr™•os
)%cbuf->siz=ğ(cbuf->size-cbuf->
u£d
)%cbuf->size);

72 ià(
cbuf
->
u£d
 == 0) {

73 
	`TRACE
(("cbuf_readlen: unused buffer"))

77 ià(
cbuf
->
»adpos
 < cbuf->
wr™•os
) {

78  
cbuf
->
wr™•os
 - cbuf->
»adpos
;

81  
cbuf
->
size
 - cbuf->
»adpos
;

82 
	}
}

84 
	$cbuf_wr™–’
(
cœcbufãr
 *
cbuf
) {

86 
	`drİb—r_as£¹
(
cbuf
->
u£d
 <ğcbuf->
size
);

87 
	`drİb—r_as£¹
(((2*
cbuf
->
size
)+cbuf->
wr™•os
-cbuf->
»adpos
)%cbuf->siz=ğcbuf->
u£d
%cbuf->size);

88 
	`drİb—r_as£¹
(((2*
cbuf
->
size
)+cbuf->
»adpos
-cbuf->
wr™•os
)%cbuf->siz=ğ(cbuf->size-cbuf->
u£d
)%cbuf->size);

90 ià(
cbuf
->
u£d
 =ğcbuf->
size
) {

91 
	`TRACE
(("cbuf_writelen: full buffer"))

95 ià(
cbuf
->
wr™•os
 < cbuf->
»adpos
) {

96  
cbuf
->
»adpos
 - cbuf->
wr™•os
;

99  
cbuf
->
size
 - cbuf->
wr™•os
;

100 
	}
}

102 * 
	$cbuf_»ad±r
(
cœcbufãr
 *
cbuf
, 
Ën
) {

103 ià(
Ën
 > 
	`cbuf_»adËn
(
cbuf
)) {

104 
	`drİb—r_ex™
("Bad cbuf„ead");

107  &
cbuf
->
d©a
[cbuf->
»adpos
];

108 
	}
}

110 * 
	$cbuf_wr™•Œ
(
cœcbufãr
 *
cbuf
, 
Ën
) {

112 ià(
Ën
 > 
	`cbuf_wr™–’
(
cbuf
)) {

113 
	`drİb—r_ex™
("Bad cbuf write");

116  &
cbuf
->
d©a
[cbuf->
wr™•os
];

117 
	}
}

119 
	$cbuf_šüwr™e
(
cœcbufãr
 *
cbuf
, 
Ën
) {

120 ià(
Ën
 > 
	`cbuf_wr™–’
(
cbuf
)) {

121 
	`drİb—r_ex™
("Bad cbuf write");

124 
cbuf
->
u£d
 +ğ
Ën
;

125 
	`drİb—r_as£¹
(
cbuf
->
u£d
 <ğcbuf->
size
);

126 
cbuf
->
wr™•os
 = (cbuf->wr™•o + 
Ën
è% cbuf->
size
;

127 
	}
}

130 
	$cbuf_šü»ad
(
cœcbufãr
 *
cbuf
, 
Ën
) {

131 ià(
Ën
 > 
	`cbuf_»adËn
(
cbuf
)) {

132 
	`drİb—r_ex™
("Bad cbuf„ead");

135 
	`drİb—r_as£¹
(
cbuf
->
u£d
 >ğ
Ën
);

136 
cbuf
->
u£d
 -ğ
Ën
;

137 
cbuf
->
»adpos
 = (cbuf->»adpo + 
Ën
è% cbuf->
size
;

138 
	}
}

	@circbuffer.h

25 #iâdeà
_CIRCBUFFER_H_


26 
	#_CIRCBUFFER_H_


	)

27 
	scœcbuf
 {

29 
	msize
;

30 
	m»adpos
;

31 
	mwr™•os
;

32 
	mu£d
;

33 * 
	md©a
;

36 
cœcbuf
 
	tcœcbufãr
;

38 
cœcbufãr
 * 
cbuf_Ãw
(
size
);

39 
cbuf_ä“
(
cœcbufãr
 * 
cbuf
);

41 
cbuf_g‘u£d
(
cœcbufãr
 * 
cbuf
);

42 
cbuf_g‘ava
(
cœcbufãr
 * 
cbuf
);

43 
cbuf_»adËn
(
cœcbufãr
 *
cbuf
);

44 
cbuf_wr™–’
(
cœcbufãr
 *
cbuf
);

46 * 
cbuf_»ad±r
(
cœcbufãr
 *
cbuf
, 
Ën
);

47 * 
cbuf_wr™•Œ
(
cœcbufãr
 *
cbuf
, 
Ën
);

48 
cbuf_šüwr™e
(
cœcbufãr
 *
cbuf
, 
Ën
);

49 
cbuf_šü»ad
(
cœcbufãr
 *
cbuf
, 
Ën
);

	@cli-agentfwd.c

25 
	~"šşudes.h
"

27 #ifdeà
ENABLE_CLI_AGENTFWD


29 
	~"ag’tfwd.h
"

30 
	~"£ssiÚ.h
"

31 
	~"ssh.h
"

32 
	~"dbut.h
"

33 
	~"chª£ssiÚ.h
"

34 
	~"chªÃl.h
"

35 
	~"·ck‘.h
"

36 
	~"bufãr.h
"

37 
	~"¿ndom.h
"

38 
	~"li¡’”.h
"

39 
	~"runİts.h
"

40 
	~"©omicio.h
"

41 
	~"signkey.h
"

42 
	~"auth.h
"

47 
Ãw_ag’t_chª
(
ChªÃl
 * 
chªÃl
);

49 cÚ¡ 
ChªTy³
 
	gşi_chª_ag’t
 = {

52 
Ãw_ag’t_chª
,

53 
NULL
,

54 
NULL
,

55 
NULL


58 
	$cÚÃù_ag’t
() {

60 
fd
 = -1;

61 * 
ag’t_sock
 = 
NULL
;

63 
ag’t_sock
 = 
	`g‘’v
("SSH_AUTH_SOCK");

64 ià(
ag’t_sock
 =ğ
NULL
)

67 
fd
 = 
	`cÚÃù_unix
(
ag’t_sock
);

69 ià(
fd
 < 0) {

70 
	`drİb—r_log
(
LOG_INFO
, "Failedo connecto‡gent");

73  
fd
;

74 
	}
}

78 
	$Ãw_ag’t_chª
(
ChªÃl
 * 
chªÃl
) {

80 
fd
 = -1;

82 ià(!
şi_İts
.
ag’t_fwd
)

83  
SSH_OPEN_ADMINISTRATIVELY_PROHIBITED
;

85 
fd
 = 
	`cÚÃù_ag’t
();

86 ià(
şi_İts
.
ag’t_fd
 < 0) {

87  
SSH_OPEN_CONNECT_FAILED
;

90 
	`£ŠÚblockšg
(
fd
);

92 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
fd
);

94 
chªÃl
->
»adfd
 = 
fd
;

95 
chªÃl
->
wr™efd
 = 
fd
;

99 
	}
}

112 
bufãr
 * 
	$ag’t_»que¡
(
ty³
, 
bufãr
 *
d©a
) {

114 
bufãr
 * 
·ylßd
 = 
NULL
;

115 
bufãr
 * 
šbuf
 = 
NULL
;

116 
size_t
 
»adËn
 = 0;

117 
ssize_t
 
»t
;

118 cÚ¡ 
fd
 = 
şi_İts
.
ag’t_fd
;

119 
d©a_Ën
 = 0;

120 ià(
d©a
)

122 
d©a_Ën
 = 
d©a
->
Ën
;

125 
·ylßd
 = 
	`buf_Ãw
(4 + 1 + 
d©a_Ën
);

127 
	`buf_putšt
(
·ylßd
, 1 + 
d©a_Ën
);

128 
	`buf_putby‹
(
·ylßd
, 
ty³
);

129 ià(
d©a
) {

130 
	`buf_putby‹s
(
·ylßd
, 
d©a
->d©a, d©a->
Ën
);

132 
	`buf_£os
(
·ylßd
, 0);

134 
»t
 = 
	`©omicio
(
wr™e
, 
fd
, 
	`buf_g‘±r
(
·ylßd
,…aylßd->
Ën
),…ayload->len);

135 ià((
size_t
)
»t
 !ğ
·ylßd
->
Ën
) {

136 
	`TRACE
(("wr™çed fd %d fÜ‡g’t_»que¡, %s", 
fd
, 
	`¡»¼Ü
(
”ºo
)))

137 
out
;

140 
	`buf_ä“
(
·ylßd
);

141 
·ylßd
 = 
NULL
;

142 
	`TRACE
(("Wrote out bytes for‡gent_request"))

144 
šbuf
 = 
	`buf_Ãw
(4);

145 
»t
 = 
	`©omicio
(
»ad
, 
fd
, 
	`buf_g‘wr™•Œ
(
šbuf
, 4), 4);

146 ià(
»t
 != 4) {

147 
	`TRACE
(("read of†ength failed for‡gent_request"))

148 
out
;

150 
	`buf_£os
(
šbuf
, 0);

151 
	`buf_£’
(
šbuf
, 
»t
);

153 
»adËn
 = 
	`buf_g‘št
(
šbuf
);

154 ià(
»adËn
 > 
MAX_AGENT_REPLY
) {

155 
	`TRACE
(("agent„eply isoo big"));

156 
out
;

159 
	`TRACE
(("ag’t_»que¡„—dËÀi %d", 
»adËn
))

161 
	`buf_»size
(
šbuf
, 
»adËn
);

162 
	`buf_£os
(
šbuf
, 0);

163 
»t
 = 
	`©omicio
(
»ad
, 
fd
, 
	`buf_g‘wr™•Œ
(
šbuf
, 
»adËn
),„eadlen);

164 ià((
size_t
)
»t
 !ğ
»adËn
) {

165 
	`TRACE
(("read of data failed for‡gent_request"))

166 
out
;

168 
	`buf_šüwr™•os
(
šbuf
, 
»adËn
);

169 
	`buf_£os
(
šbuf
, 0);

170 
	`TRACE
(("ag’t_»que¡ sucûss,†’gth %d", 
»adËn
))

172 
out
:

173 ià(
·ylßd
)

174 
	`buf_ä“
(
·ylßd
);

176  
šbuf
;

177 
	}
}

179 
	$ag’t_g‘_key_li¡
(
m_li¡
 * 
»t_li¡
)

181 
bufãr
 * 
šbuf
 = 
NULL
;

182 
num
 = 0;

183 
·ck‘_ty³
;

184 
i
;

185 
»t
;

187 
šbuf
 = 
	`ag’t_»que¡
(
SSH2_AGENTC_REQUEST_IDENTITIES
, 
NULL
);

188 ià(!
šbuf
) {

189 
	`TRACE
(("agent_request failed„eturning identities"))

190 
out
;

200 
·ck‘_ty³
 = 
	`buf_g‘by‹
(
šbuf
);

201 ià(
·ck‘_ty³
 !ğ
SSH2_AGENT_IDENTITIES_ANSWER
) {

202 
out
;

205 
num
 = 
	`buf_g‘št
(
šbuf
);

206 
i
 = 0; i < 
num
; i++) {

207 
sign_key
 * 
pubkey
 = 
NULL
;

208 
key_ty³
 = 
DROPBEAR_SIGNKEY_ANY
;

209 
bufãr
 * 
key_buf
;

212 
key_buf
 = 
	`buf_g‘¡ršgbuf
(
šbuf
);

213 
pubkey
 = 
	`Ãw_sign_key
();

214 
»t
 = 
	`buf_g‘_pub_key
(
key_buf
, 
pubkey
, &
key_ty³
);

215 
	`buf_ä“
(
key_buf
);

216 ià(
»t
 !ğ
DROPBEAR_SUCCESS
) {

218 
	`drİb—r_ex™
("Bad…ubkey„eceived from‡gent");

220 
pubkey
->
ty³
 = 
key_ty³
;

221 
pubkey
->
sourû
 = 
SIGNKEY_SOURCE_AGENT
;

223 
	`li¡_­³nd
(
»t_li¡
, 
pubkey
);

226 
	`buf_—t¡ršg
(
šbuf
);

229 
out
:

230 ià(
šbuf
) {

231 
	`buf_ä“
(
šbuf
);

232 
šbuf
 = 
NULL
;

234 
	}
}

236 
	$şi_£tup_ag’t
(
ChªÃl
 *
chªÃl
) {

237 ià(!
	`g‘’v
("SSH_AUTH_SOCK")) {

241 
	`şi_¡¬t_£nd_chªÃl_»que¡
(
chªÃl
, "auth-agent-req@openssh.com");

243 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

244 
	`’üy±_·ck‘
();

245 
	}
}

249 
	$şi_lßd_ag’t_keys
(
m_li¡
 *
»t_li¡
) {

251 
şi_İts
.
ag’t_fd
 = 
	`cÚÃù_ag’t
();

252 ià(
şi_İts
.
ag’t_fd
 < 0) {

256 
	`ag’t_g‘_key_li¡
(
»t_li¡
);

257 
	}
}

259 
	$ag’t_buf_sign
(
bufãr
 *
sigblob
, 
sign_key
 *
key
,

260 cÚ¡ *
d©a
, 
Ën
) {

261 
bufãr
 *
»que¡_d©a
 = 
	`buf_Ãw
(
MAX_PUBKEY_SIZE
 + 
Ën
 + 12);

262 
bufãr
 *
»¥Ú£
;

263 
keyËn
, 
sigËn
;

264 
·ck‘_ty³
;

274 
	`buf_put_pub_key
(
»que¡_d©a
, 
key
, key->
ty³
);

275 
keyËn
 = 
»que¡_d©a
->
Ën
 - 4;

280 
	`buf_put¡ršg
(
»que¡_d©a
, 
d©a
, 
Ën
);

281 
	`buf_putšt
(
»que¡_d©a
, 0);

283 
»¥Ú£
 = 
	`ag’t_»que¡
(
SSH2_AGENTC_SIGN_REQUEST
, 
»que¡_d©a
);

284 
	`buf_ä“
(
»que¡_d©a
);

286 ià(!
»¥Ú£
) {

287 
ç
;

290 
·ck‘_ty³
 = 
	`buf_g‘by‹
(
»¥Ú£
);

291 ià(
·ck‘_ty³
 !ğ
SSH2_AGENT_SIGN_RESPONSE
) {

292 
ç
;

299 
sigËn
 = 
	`buf_g‘št
(
»¥Ú£
);

300 
	`buf_putby‹s
(
sigblob
, 
	`buf_g‘±r
(
»¥Ú£
, 
sigËn
), siglen);

301 
	`buf_ä“
(
»¥Ú£
);

304 
ç
:

308 
	`drİb—r_ex™
("Agent failed signing key");

309 
	}
}

	@cli-algo.c

27 
	~"®go.h
"

28 
	~"dbut.h
"

36 
®go_ty³
 * 
	$şi_buf_m©ch_®go
(
bufãr
* 
buf
, 
®go_ty³
 
loÿÏlgos
[],

37 *
goodguess
) {

39 * 
®gŞi¡
 = 
NULL
;

40 * 
»mÙ—lgos
[
MAX_PROPOSED_ALGO
];

41 
Ën
;

42 
couÁ
, 
i
, 
j
;

43 
®go_ty³
 * 
»t
 = 
NULL
;

45 *
goodguess
 = 0;

48 
®gŞi¡
 = 
	`buf_g‘¡ršg
(
buf
, &
Ën
);

49 
	`TRACE
(("şi_buf_m©ch_®go: %s", 
®gŞi¡
))

50 ià(
Ën
 > 
MAX_PROPOSED_ALGO
*(
MAX_NAME_LEN
+1)) {

51 
out
;

56 
»mÙ—lgos
[0] = 
®gŞi¡
;

57 
couÁ
 = 1;

60 
i
 = 0; i < 
Ën
; i++) {

61 ià(
®gŞi¡
[
i
] == '\0') {

63 
out
;

65 ià(
®gŞi¡
[
i
] == ',') {

66 
®gŞi¡
[
i
] = '\0';

67 
»mÙ—lgos
[
couÁ
] = &
®gŞi¡
[
i
+1];

68 
couÁ
++;

70 ià(
couÁ
 =ğ
MAX_PROPOSED_ALGO
) {

77 
j
 = 0; 
loÿÏlgos
[j].
Çme
 !ğ
NULL
; j++) {

78 ià(
loÿÏlgos
[
j
].
u§bË
) {

79 
Ën
 = 
	`¡¾’
(
loÿÏlgos
[
j
].
Çme
);

80 
i
 = 0; i < 
couÁ
; i++) {

81 ià(
Ën
 =ğ
	`¡¾’
(
»mÙ—lgos
[
i
])

82 && 
	`¡ºcmp
(
loÿÏlgos
[
j
].
Çme
,

83 
»mÙ—lgos
[
i
], 
Ën
) == 0) {

84 ià(
i
 =ğ0 && 
j
 == 0) {

86 *
goodguess
 = 1;

88 
»t
 = &
loÿÏlgos
[
j
];

89 
out
;

95 
out
:

96 
	`m_ä“
(
®gŞi¡
);

97  
»t
;

98 
	}
}

	@cli-auth.c

26 
	~"šşudes.h
"

27 
	~"£ssiÚ.h
"

28 
	~"auth.h
"

29 
	~"dbut.h
"

30 
	~"bufãr.h
"

31 
	~"ssh.h
"

32 
	~"·ck‘.h
"

33 
	~"runİts.h
"

35 
	$şi_authš™Ÿli£
() {

37 
	`mem£t
(&
£s
.
auth¡©e
, 0, (ses.authstate));

38 
	}
}

42 
	$şi_auth_g‘m‘hods
() {

44 
	`TRACE
(("enter cli_auth_getmethods"))

46 
	`CHECKCLEARTOWRITE
();

48 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_REQUEST
);

49 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
şi_İts
.
u£ºame
,

50 
	`¡¾’
(
şi_İts
.
u£ºame
));

51 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
SSH_SERVICE_CONNECTION
,

52 
SSH_SERVICE_CONNECTION_LEN
);

53 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "none", 4);

55 
	`’üy±_·ck‘
();

56 
	`TRACE
(("leave cli_auth_getmethods"))

58 
	}
}

60 
	$»cv_msg_u£¿uth_bªÃr
() {

62 * 
bªÃr
 = 
NULL
;

63 
bªÃ¾’
;

64 
i
, 
lšecouÁ
;

66 
	`TRACE
(("enter„ecv_msg_userauth_banner"))

67 ià(
£s
.
auth¡©e
.
authdÚe
) {

68 
	`TRACE
(("leave„ecv_msg_userauth_banner: banner‡fter‡uth done"))

72 
bªÃr
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
bªÃ¾’
);

73 
	`buf_—t¡ršg
(
£s
.
·ylßd
);

75 ià(
bªÃ¾’
 > 
MAX_BANNER_SIZE
) {

76 
	`TRACE
(("»cv_msg_u£¿uth_bªÃr: bªÃ¾’oØlÚg: %d", 
bªÃ¾’
))

77 
out
;

80 
	`ş—Áext
(
bªÃr
);

83 
lšecouÁ
 = 1;

84 
i
 = 0; i < 
bªÃ¾’
; i++) {

85 ià(
bªÃr
[
i
] == '\n') {

86 ià(
lšecouÁ
 >ğ
MAX_BANNER_LINES
) {

87 
bªÃr
[
i
] = '\0';

90 
lšecouÁ
++;

94 
	`årštf
(
¡d”r
, "%s\n", 
bªÃr
);

96 
out
:

97 
	`m_ä“
(
bªÃr
);

98 
	`TRACE
(("leave„ecv_msg_userauth_banner"))

99 
	}
}

106 
	$»cv_msg_u£¿uth_¥ecific_60
() {

108 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


109 ià(
şi_£s
.
Ï¡authty³
 =ğ
AUTH_TYPE_PUBKEY
) {

110 
	`»cv_msg_u£¿uth_pk_ok
();

115 #ifdeà
ENABLE_CLI_INTERACT_AUTH


116 ià(
şi_£s
.
Ï¡authty³
 =ğ
AUTH_TYPE_INTERACT
) {

117 
	`»cv_msg_u£¿uth_šfo_»que¡
();

122 #ifdeà
ENABLE_CLI_PASSWORD_AUTH


123 ià(
şi_£s
.
Ï¡authty³
 =ğ
AUTH_TYPE_PASSWORD
) {

129 
	`drİb—r_şo£
("Your…assword hasƒxpired.");

133 
	`drİb—r_ex™
("Unexpected userauth…acket");

134 
	}
}

136 
	$»cv_msg_u£¿uth_çu»
() {

138 * 
m‘hods
 = 
NULL
;

139 * 
tok
 = 
NULL
;

140 
m‘hËn
 = 0;

141 
·¹Ÿl
 = 0;

142 
i
 = 0;

144 
	`TRACE
(("<- MSG_USERAUTH_FAILURE"))

145 
	`TRACE
(("enter„ecv_msg_userauth_failure"))

147 ià(
şi_£s
.
¡©e
 !ğ
USERAUTH_REQ_SENT
) {

149 
	`drİb—r_ex™
("Unexpected userauth failure");

152 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


155 ià(
şi_£s
.
Ï¡authty³
 =ğ
AUTH_TYPE_PUBKEY
) {

156 
	`şi_pubkeyç
();

160 #ifdeà
ENABLE_CLI_INTERACT_AUTH


164 ià(
şi_£s
.
Ï¡authty³
 =ğ
AUTH_TYPE_INTERACT


165 && !
şi_£s
.
š‹¿ù_»que¡_»ûived
) {

166 
	`TRACE
(("setting‡uth_interact_failed = 1"))

167 
şi_£s
.
auth_š‹¿ù_çed
 = 1;

171 
şi_£s
.
Ï¡authty³
 = 
AUTH_TYPE_NONE
;

173 
m‘hods
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
m‘hËn
);

175 
·¹Ÿl
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

177 ià(
·¹Ÿl
) {

178 
	`drİb—r_log
(
LOG_INFO
, "Authentication…artially succeeded, more‡ttempts„equired");

180 
£s
.
auth¡©e
.
çcouÁ
++;

183 
	`TRACE
(("M‘hod Ö’ %d): '%s'", 
m‘hËn
, 
m‘hods
))

185 
£s
.
auth¡©e
.
authdÚe
=0;

186 
£s
.
auth¡©e
.
authty³s
=0;

189 
i
 = 0; i < 
m‘hËn
; i++) {

190 ià(
m‘hods
[
i
] == ',') {

191 
m‘hods
[
i
] = '\0';

195 
tok
 = 
m‘hods
;

196 
i
 = 0; i <ğ
m‘hËn
; i++) {

197 ià(
m‘hods
[
i
] == '\0') {

198 
	`TRACE
(("auth m‘hod '%s'", 
tok
))

199 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


200 ià(
	`¡ºcmp
(
AUTH_METHOD_PUBKEY
, 
tok
,

201 
AUTH_METHOD_PUBKEY_LEN
) == 0) {

202 
£s
.
auth¡©e
.
authty³s
 |ğ
AUTH_TYPE_PUBKEY
;

205 #ifdeà
ENABLE_CLI_INTERACT_AUTH


206 ià(
	`¡ºcmp
(
AUTH_METHOD_INTERACT
, 
tok
,

207 
AUTH_METHOD_INTERACT_LEN
) == 0) {

208 
£s
.
auth¡©e
.
authty³s
 |ğ
AUTH_TYPE_INTERACT
;

211 #ifdeà
ENABLE_CLI_PASSWORD_AUTH


212 ià(
	`¡ºcmp
(
AUTH_METHOD_PASSWORD
, 
tok
,

213 
AUTH_METHOD_PASSWORD_LEN
) == 0) {

214 
£s
.
auth¡©e
.
authty³s
 |ğ
AUTH_TYPE_PASSWORD
;

217 
tok
 = &
m‘hods
[
i
+1];

223 
	`m_ä“
(
m‘hods
);

225 
şi_£s
.
¡©e
 = 
USERAUTH_FAIL_RCVD
;

227 
	`TRACE
(("leave„ecv_msg_userauth_failure"))

228 
	}
}

230 
	$»cv_msg_u£¿uth_sucûss
() {

231 
	`TRACE
(("received msg_userauth_success"))

234 
£s
.
auth¡©e
.
authdÚe
 = 1;

235 
şi_£s
.
¡©e
 = 
USERAUTH_SUCCESS_RCVD
;

236 
şi_£s
.
Ï¡authty³
 = 
AUTH_TYPE_NONE
;

238 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


239 
	`şi_auth_pubkey_ş—nup
();

241 
	}
}

243 
	$şi_auth_Œy
() {

245 
fšished
 = 0;

246 
	`TRACE
(("enter cli_auth_try"))

248 
	`CHECKCLEARTOWRITE
();

252 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


253 ià(
£s
.
auth¡©e
.
authty³s
 & 
AUTH_TYPE_PUBKEY
) {

254 
fšished
 = 
	`şi_auth_pubkey
();

255 
şi_£s
.
Ï¡authty³
 = 
AUTH_TYPE_PUBKEY
;

259 #ifdeà
ENABLE_CLI_INTERACT_AUTH


260 ià(!
fšished
 && 
£s
.
auth¡©e
.
authty³s
 & 
AUTH_TYPE_INTERACT
) {

261 ià(
şi_£s
.
auth_š‹¿ù_çed
) {

262 
fšished
 = 0;

264 
	`şi_auth_š‹¿ùive
();

265 
şi_£s
.
Ï¡authty³
 = 
AUTH_TYPE_INTERACT
;

266 
fšished
 = 1;

271 #ifdeà
ENABLE_CLI_PASSWORD_AUTH


272 ià(!
fšished
 && 
£s
.
auth¡©e
.
authty³s
 & 
AUTH_TYPE_PASSWORD
) {

273 
	`şi_auth_·sswÜd
();

274 
fšished
 = 1;

275 
şi_£s
.
Ï¡authty³
 = 
AUTH_TYPE_PASSWORD
;

279 
	`TRACE
(("şi_auth_Œy†a¡authty³ %d", 
şi_£s
.
Ï¡authty³
))

281 ià(!
fšished
) {

282 
	`drİb—r_ex™
("No‡uth methods could be used.");

285 
	`TRACE
(("leave cli_auth_try"))

286 
	}
}

290 * 
	$g‘·ss_Ü_ÿnûl
(* 
´om±
)

292 * 
·sswÜd
 = 
NULL
;

294 #ifdeà
DROPBEAR_PASSWORD_ENV


296 
·sswÜd
 = 
	`g‘’v
(
DROPBEAR_PASSWORD_ENV
);

297 ià(
·sswÜd
)

299  
·sswÜd
;

303 
·sswÜd
 = 
	`g‘·ss
(
´om±
);

306 ià(
·sswÜd
 =ğ
NULL
 || 
	`¡rchr
(password, '\3') != NULL) {

307 
	`drİb—r_şo£
("Interrupted.");

309  
·sswÜd
;

310 
	}
}

	@cli-authinteract.c

25 
	~"šşudes.h
"

26 
	~"bufãr.h
"

27 
	~"dbut.h
"

28 
	~"£ssiÚ.h
"

29 
	~"ssh.h
"

30 
	~"runİts.h
"

32 #ifdeà
ENABLE_CLI_INTERACT_AUTH


34 * 
	$g‘_»¥Ú£
(* 
´om±
)

36 
FILE
* 
‰y
 = 
NULL
;

37 * 
»¥Ú£
 = 
NULL
;

39 
buf
[
DROPBEAR_MAX_CLI_PASS
];

40 * 
»t
 = 
NULL
;

42 
	`årštf
(
¡d”r
, "%s", 
´om±
);

44 
‰y
 = 
	`fİ’
(
_PATH_TTY
, "r");

45 ià(
‰y
) {

46 
»t
 = 
	`fg‘s
(
buf
, (buf), 
‰y
);

47 
	`fşo£
(
‰y
);

49 
»t
 = 
	`fg‘s
(
buf
, (buf), 
¡dš
);

52 ià(
»t
 =ğ
NULL
) {

53 
»¥Ú£
 = (*)
	`m_¡rdup
("");

55 
buæ’
 = 
	`¡¾’
(
buf
);

57 ià(
buæ’
 > 0 && 
buf
[buflen-1] == '\n')

58 
buf
[
buæ’
-1] = '\0';

59 
»¥Ú£
 = (*)
	`m_¡rdup
(
buf
);

62 
	`m_buº
(
buf
, (buf));

64  
»¥Ú£
;

65 
	}
}

67 
	$»cv_msg_u£¿uth_šfo_»que¡
() {

69 *
Çme
 = 
NULL
;

70 *
š¡ruùiÚ
 = 
NULL
;

71 
num_´om±s
 = 0;

72 
i
;

74 *
´om±
 = 
NULL
;

75 
echo
 = 0;

76 *
»¥Ú£
 = 
NULL
;

78 
	`TRACE
(("enter„ecv_msg_recv_userauth_info_request"))

81 ià(!
şi_£s
.
š‹¿ù_»que¡_»ûived
) {

82 
	`årštf
(
¡d”r
, "Logš fÜ %s@%s\n", 
şi_İts
.
u£ºame
,

83 
şi_İts
.
»mÙeho¡
);

85 
şi_£s
.
š‹¿ù_»que¡_»ûived
 = 1;

87 
Çme
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

88 
š¡ruùiÚ
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

91 
	`buf_—t¡ršg
(
£s
.
·ylßd
);

93 
num_´om±s
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

95 ià(
num_´om±s
 >ğ
DROPBEAR_MAX_CLI_INTERACT_PROMPTS
) {

96 
	`drİb—r_ex™
("Too many…rompts„eceived for keyboard-interactive");

100 
	`CHECKCLEARTOWRITE
();

101 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_INFO_RESPONSE
);

102 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
num_´om±s
);

104 ià(
	`¡¾’
(
Çme
) > 0) {

105 
	`ş—Áext
(
Çme
);

106 
	`årštf
(
¡d”r
, "%s", 
Çme
);

108 
	`m_ä“
(
Çme
);

110 ià(
	`¡¾’
(
š¡ruùiÚ
) > 0) {

111 
	`ş—Áext
(
š¡ruùiÚ
);

112 
	`årštf
(
¡d”r
, "%s", 
š¡ruùiÚ
);

114 
	`m_ä“
(
š¡ruùiÚ
);

116 
i
 = 0; i < 
num_´om±s
; i++) {

117 
»¥Ú£_Ën
 = 0;

118 
´om±
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

119 
	`ş—Áext
(
´om±
);

121 
echo
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

123 ià(!
echo
) {

124 * 
p
 = 
	`g‘·ss_Ü_ÿnûl
(
´om±
);

125 
»¥Ú£
 = 
	`m_¡rdup
(
p
);

126 
	`m_buº
(
p
, 
	`¡¾’
(p));

128 
»¥Ú£
 = 
	`g‘_»¥Ú£
(
´om±
);

131 
»¥Ú£_Ën
 = 
	`¡¾’
(
»¥Ú£
);

132 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
»¥Ú£
, 
»¥Ú£_Ën
);

133 
	`m_buº
(
»¥Ú£
, 
»¥Ú£_Ën
);

134 
	`m_ä“
(
»¥Ú£
);

137 
	`’üy±_·ck‘
();

140 
	`TRACE
(("leave„ecv_msg_recv_userauth_info_request"))

141 
	}
}

143 
	$şi_auth_š‹¿ùive
() {

145 
	`TRACE
(("enter cli_auth_interactive"))

146 
	`CHECKCLEARTOWRITE
();

148 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_REQUEST
);

151 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
şi_İts
.
u£ºame
,

152 
	`¡¾’
(
şi_İts
.
u£ºame
));

155 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
SSH_SERVICE_CONNECTION
,

156 
SSH_SERVICE_CONNECTION_LEN
);

159 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
AUTH_METHOD_INTERACT
,

160 
AUTH_METHOD_INTERACT_LEN
);

163 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "", 0);

166 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "", 0);

168 
	`’üy±_·ck‘
();

169 
şi_£s
.
š‹¿ù_»que¡_»ûived
 = 0;

171 
	`TRACE
(("leave cli_auth_interactive"))

173 
	}
}

	@cli-authpasswd.c

25 
	~"šşudes.h
"

26 
	~"bufãr.h
"

27 
	~"dbut.h
"

28 
	~"£ssiÚ.h
"

29 
	~"ssh.h
"

30 
	~"runİts.h
"

32 #ifdeà
ENABLE_CLI_PASSWORD_AUTH


34 #ifdeà
ENABLE_CLI_ASKPASS_HELPER


36 
	$wªt_ask·ss
()

38 * 
ask·ss_´og
 = 
NULL
;

40 
ask·ss_´og
 = 
	`g‘’v
("SSH_ASKPASS");

41  
ask·ss_´og
 &&

42 ((!
	`i§‰y
(
STDIN_FILENO
è&& 
	`g‘’v
("DISPLAY") )

43 || 
	`g‘’v
("SSH_ASKPASS_ALWAYS"));

44 
	}
}

48 *
	$gui_g‘·ss
(cÚ¡ *
´om±
) {

50 
pid_t
 
pid
;

51 
p
[2], 
maxËn
, 
Ën
, 
¡©us
;

52 
buf
[
DROPBEAR_MAX_CLI_PASS
 + 1];

53 * 
h–³r
 = 
NULL
;

55 
	`TRACE
(("enter gui_getpass"))

57 
h–³r
 = 
	`g‘’v
("SSH_ASKPASS");

58 ià(!
h–³r
)

60 
	`TRACE
(("leave gui_getpass:‚o‡skpass…rogram"))

61  
NULL
;

64 ià(
	`pe
(
p
) < 0) {

65 
	`TRACE
(("error creating child…ipe"))

66  
NULL
;

69 
pid
 = 
	`fÜk
();

71 ià(
pid
 < 0) {

72 
	`TRACE
(("forkƒrror"))

73  
NULL
;

76 ià(!
pid
) {

78 
	`şo£
(
p
[0]);

79 ià(
	`dup2
(
p
[1], 
STDOUT_FILENO
) < 0) {

80 
	`TRACE
(("error„edirecting stdout"))

81 
	`ex™
(1);

83 
	`şo£
(
p
[1]);

84 
	`exeşp
(
h–³r
, h–³r, 
´om±
, (*)0);

85 
	`TRACE
(("execlpƒrror"))

86 
	`ex™
(1);

89 
	`şo£
(
p
[1]);

90 
maxËn
 = (
buf
);

91 
maxËn
 > 0) {

92 
Ën
 = 
	`»ad
(
p
[0], 
buf
 + (bufè- 
maxËn
, maxlen);

93 ià(
Ën
 > 0) {

94 
maxËn
 -ğ
Ën
;

96 ià(
”ºo
 !ğ
EINTR
)

101 
	`şo£
(
p
[0]);

103 
	`wa™pid
(
pid
, &
¡©us
, 0è< 0 && 
”ºo
 =ğ
EINTR
)

105 ià(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0)

106 (
NULL
);

108 
Ën
 = (
buf
è- 
maxËn
;

109 
buf
[
Ën
] = '\0';

110 ià(
Ën
 > 0 && 
buf
[len - 1] == '\n')

111 
buf
[
Ën
 - 1] = '\0';

113 
	`TRACE
(("leave gui_getpass"))

114 (
buf
);

115 
	}
}

118 
	$şi_auth_·sswÜd
() {

120 * 
·sswÜd
 = 
NULL
;

121 
´om±
[80];

123 
	`TRACE
(("enter cli_auth_password"))

124 
	`CHECKCLEARTOWRITE
();

126 
	`¢´štf
(
´om±
, (prompt), "%s@%s's…assword: ",

127 
şi_İts
.
u£ºame
, cli_İts.
»mÙeho¡
);

128 #ifdeà
ENABLE_CLI_ASKPASS_HELPER


129 ià(
	`wªt_ask·ss
())

131 
·sswÜd
 = 
	`gui_g‘·ss
(
´om±
);

132 ià(!
·sswÜd
) {

133 
	`drİb—r_ex™
("No…assword");

138 
·sswÜd
 = 
	`g‘·ss_Ü_ÿnûl
(
´om±
);

141 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_REQUEST
);

143 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
şi_İts
.
u£ºame
,

144 
	`¡¾’
(
şi_İts
.
u£ºame
));

146 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
SSH_SERVICE_CONNECTION
,

147 
SSH_SERVICE_CONNECTION_LEN
);

149 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
AUTH_METHOD_PASSWORD
,

150 
AUTH_METHOD_PASSWORD_LEN
);

152 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

154 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
·sswÜd
, 
	`¡¾’
(password));

156 
	`’üy±_·ck‘
();

157 
	`m_buº
(
·sswÜd
, 
	`¡¾’
(password));

159 
	`TRACE
(("leave cli_auth_password"))

160 
	}
}

	@cli-authpubkey.c

26 
	~"šşudes.h
"

27 
	~"bufãr.h
"

28 
	~"dbut.h
"

29 
	~"£ssiÚ.h
"

30 
	~"ssh.h
"

31 
	~"runİts.h
"

32 
	~"auth.h
"

33 
	~"ag’tfwd.h
"

35 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


36 
£nd_msg_u£¿uth_pubkey
(
sign_key
 *
key
, 
ty³
, 
»®sign
);

40 
	$şi_pubkeyç
() {

41 
m_li¡_–em
 *
™”
;

42 
™”
 = 
şi_İts
.
´ivkeys
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
) {

43 
sign_key
 *
™”_key
 = (sign_key*)
™”
->
™em
;

45 ià(
™”_key
 =ğ
şi_£s
.
Ï¡´ivkey
)

48 
	`li¡_»move
(
™”
);

49 
	`sign_key_ä“
(
™”_key
);

50 
şi_£s
.
Ï¡´ivkey
 = 
NULL
;

54 
	}
}

56 
	$»cv_msg_u£¿uth_pk_ok
() {

57 
m_li¡_–em
 *
™”
;

58 
bufãr
* 
keybuf
 = 
NULL
;

59 * 
®gÙy³
 = 
NULL
;

60 
®gŞ’
;

61 
keyty³
;

62 
»mÙ–’
;

64 
	`TRACE
(("enter„ecv_msg_userauth_pk_ok"))

66 
®gÙy³
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
®gŞ’
);

67 
keyty³
 = 
	`signkey_ty³_äom_Çme
(
®gÙy³
, 
®gŞ’
);

68 
	`TRACE
(("»cv_msg_u£¿uth_pk_ok:y³ %d", 
keyty³
))

69 
	`m_ä“
(
®gÙy³
);

71 
keybuf
 = 
	`buf_Ãw
(
MAX_PUBKEY_SIZE
);

73 
»mÙ–’
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

77 
™”
 = 
şi_İts
.
´ivkeys
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
) {

78 
sign_key
 *
key
 = (sign_key*)
™”
->
™em
;

79 ià(
key
->
ty³
 !ğ
keyty³
) {

81 
	`TRACE
(("types differed"))

86 
keybuf
->
pos
 = keybuf->
Ën
 = 0;

87 
	`buf_put_pub_key
(
keybuf
, 
key
, 
keyty³
);

88 
	`buf_£os
(
keybuf
, 0);

89 
	`buf_šüpos
(
keybuf
, 4);

94 ià(
keybuf
->
Ën
-4 !ğ
»mÙ–’
) {

95 
	`TRACE
(("Ëngth difã»d:†oÿlh %d„emÙ%d", 
keybuf
->
Ën
, 
»mÙ–’
))

99 ià(
	`memcmp
(
	`buf_g‘±r
(
keybuf
, 
»mÙ–’
),

100 
	`buf_g‘±r
(
£s
.
·ylßd
, 
»mÙ–’
),„emotelen) != 0) {

102 
	`TRACE
(("data differed"))

109 
	`buf_ä“
(
keybuf
);

111 ià(
™”
 !ğ
NULL
) {

112 
	`TRACE
(("matching key"))

115 
	`£nd_msg_u£¿uth_pubkey
((
sign_key
*)
™”
->
™em
, 
keyty³
, 1);

117 
	`TRACE
(("That was whacky. We gotoldhat‡ key was valid, but it didn't match our†ist. Sounds†ike dodgy code on Dropbear's…art"))

120 
	`TRACE
(("leave„ecv_msg_userauth_pk_ok"))

121 
	}
}

123 
	$şi_buf_put_sign
(
bufãr
* 
buf
, 
sign_key
 *
key
, 
ty³
,

124 cÚ¡ *
d©a
, 
Ën
)

126 ià(
key
->
sourû
 =ğ
SIGNKEY_SOURCE_AGENT
) {

128 
bufãr
 *
sigblob
;

129 
sigblob
 = 
	`buf_Ãw
(
MAX_PUBKEY_SIZE
);

130 
	`ag’t_buf_sign
(
sigblob
, 
key
, 
d©a
, 
Ën
);

131 
	`buf_£os
(
sigblob
, 0);

132 
	`buf_put¡ršg
(
buf
, 
	`buf_g‘±r
(
sigblob
, sigblob->
Ën
),

133 
sigblob
->
Ën
);

135 
	`buf_ä“
(
sigblob
);

137 
	`buf_put_sign
(
buf
, 
key
, 
ty³
, 
d©a
, 
Ën
);

140 
	}
}

143 
	$£nd_msg_u£¿uth_pubkey
(
sign_key
 *
key
, 
ty³
, 
»®sign
) {

145 cÚ¡ *
®gÚame
 = 
NULL
;

146 
®gŞ’
;

147 
bufãr
* 
sigbuf
 = 
NULL
;

149 
	`TRACE
(("enter send_msg_userauth_pubkey"))

150 
	`CHECKCLEARTOWRITE
();

152 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_REQUEST
);

154 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
şi_İts
.
u£ºame
,

155 
	`¡¾’
(
şi_İts
.
u£ºame
));

157 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
SSH_SERVICE_CONNECTION
,

158 
SSH_SERVICE_CONNECTION_LEN
);

160 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
AUTH_METHOD_PUBKEY
,

161 
AUTH_METHOD_PUBKEY_LEN
);

163 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
»®sign
);

165 
®gÚame
 = 
	`signkey_Çme_äom_ty³
(
ty³
, &
®gŞ’
);

167 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
®gÚame
, 
®gŞ’
);

168 
	`buf_put_pub_key
(
£s
.
wr™•aylßd
, 
key
, 
ty³
);

170 ià(
»®sign
) {

171 
	`TRACE
(("realsign"))

174 
sigbuf
 = 
	`buf_Ãw
(4 + 
SHA1_HASH_SIZE
 + 
£s
.
wr™•aylßd
->
Ën
);

175 
	`buf_put¡ršg
(
sigbuf
, 
£s
.
£ssiÚ_id
, 
SHA1_HASH_SIZE
);

176 
	`buf_putby‹s
(
sigbuf
, 
£s
.
wr™•aylßd
->
d©a
, ses.wr™•aylßd->
Ën
);

177 
	`şi_buf_put_sign
(
£s
.
wr™•aylßd
, 
key
, 
ty³
, 
sigbuf
->
d©a
, sigbuf->
Ën
);

178 
	`buf_ä“
(
sigbuf
);

181 
	`’üy±_·ck‘
();

182 
	`TRACE
(("leave send_msg_userauth_pubkey"))

183 
	}
}

186 
	$şi_auth_pubkey
() {

188 
	`TRACE
(("enter cli_auth_pubkey"))

190 ià(!
şi_İts
.
ag’t_keys_lßded
) {

192 
	`şi_lßd_ag’t_keys
(
şi_İts
.
´ivkeys
);

193 
şi_İts
.
ag’t_keys_lßded
 = 1;

196 ià(
şi_İts
.
´ivkeys
->
fœ¡
) {

197 
sign_key
 * 
key
 = (sign_key*)
şi_İts
.
´ivkeys
->
fœ¡
->
™em
;

199 
	`£nd_msg_u£¿uth_pubkey
(
key
, key->
ty³
, 0);

200 
şi_£s
.
Ï¡´ivkey
 = 
key
;

201 
	`TRACE
(("leave cli_auth_pubkey-success"))

205 
	`TRACE
(("leave cli_auth_pubkey-failure"))

208 
	}
}

210 
	$şi_auth_pubkey_ş—nup
() {

212 #ifdeà
ENABLE_CLI_AGENTFWD


213 
	`m_şo£
(
şi_İts
.
ag’t_fd
);

214 
şi_İts
.
ag’t_fd
 = -1;

217 
şi_İts
.
´ivkeys
->
fœ¡
) {

218 
sign_key
 * 
key
 = 
	`li¡_»move
(
şi_İts
.
´ivkeys
->
fœ¡
);

219 
	`sign_key_ä“
(
key
);

221 
	}
}

	@cli-channel.c

25 
	~"šşudes.h
"

26 
	~"chªÃl.h
"

27 
	~"bufãr.h
"

28 
	~"cœcbufãr.h
"

29 
	~"dbut.h
"

30 
	~"£ssiÚ.h
"

31 
	~"ssh.h
"

34 
	$»cv_msg_chªÃl_ex‹nded_d©a
() {

36 
ChªÃl
 *
chªÃl
;

37 
d©©y³
;

39 
	`TRACE
(("enter„ecv_msg_channel_extended_data"))

41 
chªÃl
 = 
	`g‘chªÃl
();

43 ià(
chªÃl
->
ty³
 !ğ&
şichª£ss
) {

44 
	`TRACE
(("leave„ecv_msg_channel_extended_data: chantype is wrong"))

48 
d©©y³
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

50 ià(
d©©y³
 !ğ
SSH_EXTENDED_DATA_STDERR
) {

51 
	`TRACE
(("leave„ecv_msg_channel_extended_data: wrong datatype: %d",

52 
d©©y³
))

56 
	`commÚ_»cv_msg_chªÃl_d©a
(
chªÃl
, chªÃl->
”rfd
, chªÃl->
exŒabuf
);

58 
	`TRACE
(("leave„ecv_msg_channel_extended_data"))

59 
	}
}

	@cli-chansession.c

26 
	~"šşudes.h
"

27 
	~"·ck‘.h
"

28 
	~"bufãr.h
"

29 
	~"£ssiÚ.h
"

30 
	~"dbut.h
"

31 
	~"chªÃl.h
"

32 
	~"ssh.h
"

33 
	~"runİts.h
"

34 
	~"‹rmcodes.h
"

35 
	~"chª£ssiÚ.h
"

36 
	~"ag’tfwd.h
"

38 
şi_şo£chª£ss
(
ChªÃl
 *
chªÃl
);

39 
şi_š™chª£ss
(
ChªÃl
 *
chªÃl
);

40 
şi_chª£s¤eq
(
ChªÃl
 *
chªÃl
);

42 
£nd_chª£ss_±y_»q
(
ChªÃl
 *
chªÃl
);

43 
£nd_chª£ss_sh–l_»q
(
ChªÃl
 *
chªÃl
);

45 
şi_‰y_£tup
();

47 cÚ¡ 
ChªTy³
 
	gşichª£ss
 = {

50 
şi_š™chª£ss
,

51 
NULL
,

52 
şi_chª£s¤eq
,

53 
şi_şo£chª£ss
,

56 
	$şi_chª£s¤eq
(
ChªÃl
 *
chªÃl
) {

58 * 
ty³
 = 
NULL
;

59 
wªŒ•ly
;

61 
	`TRACE
(("enter cli_chansessreq"))

63 
ty³
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

64 
wªŒ•ly
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

66 ià(
	`¡rcmp
(
ty³
, "exit-status") == 0) {

67 
şi_£s
.
»tv®
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

68 
	`TRACE
(("gÙƒx™-¡©u oà'%d'", 
şi_£s
.
»tv®
))

69 } ià(
	`¡rcmp
(
ty³
, "exit-signal") == 0) {

70 
	`TRACE
(("gotƒxit-signal, ignoring it"))

72 
	`TRACE
(("unknowÀ»que¡ '%s'", 
ty³
))

73 
	`£nd_msg_chªÃl_çu»
(
chªÃl
);

74 
out
;

77 
out
:

78 
	`m_ä“
(
ty³
);

79 
	}
}

83 
şi_şo£chª£ss
(
ChªÃl
 *
	$UNUSED
(
chªÃl
)) {

86 ià(
£s
.
chªcouÁ
 > 1) {

87 
	`drİb—r_log
(
LOG_INFO
, "Waiting for other channelso close...");

90 
	`şi_‰y_ş—nup
();

92 
	}
}

94 
	$şi_¡¬t_£nd_chªÃl_»que¡
(
ChªÃl
 *
chªÃl
,

95 *
ty³
) {

97 
	`CHECKCLEARTOWRITE
();

98 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_REQUEST
);

99 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

101 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
ty³
, 
	`¡¾’
(type));

103 
	}
}

107 
	$şi_‰y_£tup
() {

109 
‹rmios
 
tio
;

111 
	`TRACE
(("enter cli_pty_setup"))

113 ià(
şi_£s
.
‰y_¿w_mode
 == 1) {

114 
	`TRACE
(("leave cli_tty_setup:‡lready in„aw mode!"))

118 ià(
	`tcg‘©Œ
(
STDIN_FILENO
, &
tio
) == -1) {

119 
	`drİb—r_ex™
("Failedo set„aw TTY mode");

123 
şi_£s
.
§ved_tio
 = 
tio
;

125 
tio
.
c_iæag
 |ğ
IGNPAR
;

126 
tio
.
c_iæag
 &ğ~(
ISTRIP
 | 
INLCR
 | 
IGNCR
 | 
ICRNL
 | 
IXON
 | 
IXANY
 | 
IXOFF
);

127 #ifdeà
IUCLC


128 
tio
.
c_iæag
 &ğ~
IUCLC
;

130 
tio
.
c_læag
 &ğ~(
ISIG
 | 
ICANON
 | 
ECHO
 | 
ECHOE
 | 
ECHOK
 | 
ECHONL
);

131 #ifdeà
IEXTEN


132 
tio
.
c_læag
 &ğ~
IEXTEN
;

134 
tio
.
c_oæag
 &ğ~
OPOST
;

135 
tio
.
c_cc
[
VMIN
] = 1;

136 
tio
.
c_cc
[
VTIME
] = 0;

137 ià(
	`tc£‰r
(
STDIN_FILENO
, 
TCSADRAIN
, &
tio
) == -1) {

138 
	`drİb—r_ex™
("Failedo set„aw TTY mode");

141 
şi_£s
.
‰y_¿w_mode
 = 1;

142 
	`TRACE
(("leave cli_tty_setup"))

143 
	}
}

145 
	$şi_‰y_ş—nup
() {

147 
	`TRACE
(("enter cli_tty_cleanup"))

149 ià(
şi_£s
.
‰y_¿w_mode
 == 0) {

150 
	`TRACE
(("leave cli_tty_cleanup:‚ot in„aw mode"))

154 ià(
	`tc£‰r
(
STDIN_FILENO
, 
TCSADRAIN
, &
şi_£s
.
§ved_tio
) == -1) {

155 
	`drİb—r_log
(
LOG_WARNING
, "Failed„estoring TTY");

157 
şi_£s
.
‰y_¿w_mode
 = 0;

160 
	`TRACE
(("leave cli_tty_cleanup"))

161 
	}
}

163 
	$put_‹rmcodes
() {

165 
‹rmios
 
tio
;

166 
sshcode
;

167 cÚ¡ 
T”mCode
 *
‹rmcode
;

168 
v®ue
;

169 
m­code
;

171 
buåos1
, 
buåos2
;

173 
	`TRACE
(("enter…ut_termcodes"))

175 ià(
	`tcg‘©Œ
(
STDIN_FILENO
, &
tio
) == -1) {

176 
	`drİb—r_log
(
LOG_WARNING
, "Failed„eadingermmodes");

177 
	`buf_putšt
(
£s
.
wr™•aylßd
, 1);

178 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

182 
buåos1
 = 
£s
.
wr™•aylßd
->
pos
;

183 
	`buf_putšt
(
£s
.
wr™•aylßd
, 0);

186 
sshcode
 = 1; sshcod< 
MAX_TERMCODE
; sshcode++) {

188 
‹rmcode
 = &
‹rmcodes
[
sshcode
];

189 
m­code
 = 
‹rmcode
->mapcode;

191 
‹rmcode
->
ty³
) {

193 
TERMCODE_NONE
:

196 
TERMCODE_CONTROLCHAR
:

197 
v®ue
 = 
tio
.
c_cc
[
m­code
];

200 
TERMCODE_INPUT
:

201 
v®ue
 = 
tio
.
c_iæag
 & 
m­code
;

204 
TERMCODE_OUTPUT
:

205 
v®ue
 = 
tio
.
c_oæag
 & 
m­code
;

208 
TERMCODE_LOCAL
:

209 
v®ue
 = 
tio
.
c_læag
 & 
m­code
;

212 
TERMCODE_CONTROL
:

213 
v®ue
 = 
tio
.
c_cæag
 & 
m­code
;

222 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
sshcode
);

223 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
v®ue
);

226 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

229 
buåos2
 = 
£s
.
wr™•aylßd
->
pos
;

231 
	`buf_£os
(
£s
.
wr™•aylßd
, 
buåos1
);

232 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
buåos2
 - 
buåos1
 - 4);

233 
	`buf_£os
(
£s
.
wr™•aylßd
, 
buåos2
);

235 
	`TRACE
(("leave…ut_termcodes"))

236 
	}
}

238 
	$put_wšsize
() {

240 
wšsize
 
ws
;

242 ià(
	`ioùl
(
STDIN_FILENO
, 
TIOCGWINSZ
, &
ws
) < 0) {

244 
ws
.
ws_row
 = 25;

245 
ws
.
ws_cŞ
 = 80;

246 
ws
.
ws_xpix–
 = 0;

247 
ws
.
ws_ypix–
 = 0;

250 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
ws
.
ws_cŞ
);

251 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
ws
.
ws_row
);

252 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
ws
.
ws_xpix–
);

253 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
ws
.
ws_ypix–
);

255 
	}
}

257 
sigwšch_hªdËr
(
	$UNUSED
(
unu£d
)) {

259 
şi_£s
.
wšchªge
 = 1;

261 
	}
}

263 
	$şi_chª£ss_wšchªge
() {

265 
i
;

266 
ChªÃl
 *
chªÃl
 = 
NULL
;

268 
i
 = 0; i < 
£s
.
chªsize
; i++) {

269 
chªÃl
 = 
£s
.
chªÃls
[
i
];

270 ià(
chªÃl
 !ğ
NULL
 && chªÃl->
ty³
 =ğ&
şichª£ss
) {

271 
	`CHECKCLEARTOWRITE
();

272 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_REQUEST
);

273 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

274 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "window-change", 13);

275 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

276 
	`put_wšsize
();

277 
	`’üy±_·ck‘
();

280 
şi_£s
.
wšchªge
 = 0;

281 
	}
}

283 
	$£nd_chª£ss_±y_»q
(
ChªÃl
 *
chªÃl
) {

285 * 
‹rm
 = 
NULL
;

287 
	`TRACE
(("enter send_chansess_pty_req"))

289 
	`şi_¡¬t_£nd_chªÃl_»que¡
(
chªÃl
, "pty-req");

292 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

295 
‹rm
 = 
	`g‘’v
("TERM");

296 ià(
‹rm
 =ğ
NULL
) {

297 
‹rm
 = "vt100";

299 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
‹rm
, 
	`¡¾’
(term));

302 
	`put_wšsize
();

305 
	`put_‹rmcodes
();

307 
	`’üy±_·ck‘
();

310 ià(
	`sigÇl
(
SIGWINCH
, 
sigwšch_hªdËr
è=ğ
SIG_ERR
) {

311 
	`drİb—r_ex™
("Signalƒrror");

313 
	`TRACE
(("leave send_chansess_pty_req"))

314 
	}
}

316 
	$£nd_chª£ss_sh–l_»q
(
ChªÃl
 *
chªÃl
) {

318 * 
»qty³
 = 
NULL
;

320 
	`TRACE
(("enter send_chansess_shell_req"))

322 ià(
şi_İts
.
cmd
) {

323 ià(
şi_İts
.
is_subsy¡em
) {

324 
»qty³
 = "subsystem";

326 
»qty³
 = "exec";

329 
»qty³
 = "shell";

332 
	`şi_¡¬t_£nd_chªÃl_»que¡
(
chªÃl
, 
»qty³
);

335 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

336 ià(
şi_İts
.
cmd
) {

337 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
şi_İts
.
cmd
, 
	`¡¾’
(cli_opts.cmd));

340 
	`’üy±_·ck‘
();

341 
	`TRACE
(("leave send_chansess_shell_req"))

342 
	}
}

345 
	$şi_š™_¡dpe_£ss
(
ChªÃl
 *
chªÃl
) {

346 
chªÃl
->
wr™efd
 = 
STDOUT_FILENO
;

347 
	`£ŠÚblockšg
(
STDOUT_FILENO
);

349 
chªÃl
->
»adfd
 = 
STDIN_FILENO
;

350 
	`£ŠÚblockšg
(
STDIN_FILENO
);

352 
chªÃl
->
”rfd
 = 
STDERR_FILENO
;

353 
	`£ŠÚblockšg
(
STDERR_FILENO
);

355 
chªÃl
->
exŒabuf
 = 
	`cbuf_Ãw
(
İts
.
»cv_wšdow
);

357 
	}
}

359 
	$şi_š™chª£ss
(
ChªÃl
 *
chªÃl
) {

361 
	`şi_š™_¡dpe_£ss
(
chªÃl
);

363 #ifdeà
ENABLE_CLI_AGENTFWD


364 ià(
şi_İts
.
ag’t_fwd
) {

365 
	`şi_£tup_ag’t
(
chªÃl
);

369 ià(
şi_İts
.
wªty
) {

370 
	`£nd_chª£ss_±y_»q
(
chªÃl
);

373 
	`£nd_chª£ss_sh–l_»q
(
chªÃl
);

375 ià(
şi_İts
.
wªty
) {

376 
	`şi_‰y_£tup
();

380 
	}
}

382 #ifdeà
ENABLE_CLI_NETCAT


384 cÚ¡ 
ChªTy³
 
	gşi_chª_Ãtÿt
 = {

387 
şi_š™_¡dpe_£ss
,

388 
NULL
,

389 
NULL
,

390 
şi_şo£chª£ss


393 
	$şi_£nd_Ãtÿt_»que¡
() {

395 cÚ¡ * 
sourû_ho¡
 = "127.0.0.1";

396 cÚ¡ 
sourû_pÜt
 = 22;

398 
şi_İts
.
wªty
 = 0;

400 ià(
	`£nd_msg_chªÃl_İ’_š™
(
STDIN_FILENO
, &
şi_chª_Ãtÿt
)

401 =ğ
DROPBEAR_FAILURE
) {

402 
	`drİb—r_ex™
("Couldn't open initial channel");

405 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
şi_İts
.
Ãtÿt_ho¡
,

406 
	`¡¾’
(
şi_İts
.
Ãtÿt_ho¡
));

407 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
şi_İts
.
Ãtÿt_pÜt
);

410 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
sourû_ho¡
, 
	`¡¾’
(source_host));

411 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
sourû_pÜt
);

413 
	`’üy±_·ck‘
();

414 
	`TRACE
(("leave cli_send_chansess_request"))

415 
	}
}

418 
	$şi_£nd_chª£ss_»que¡
() {

420 
	`TRACE
(("enter cli_send_chansess_request"))

422 ià(
	`£nd_msg_chªÃl_İ’_š™
(
STDIN_FILENO
, &
şichª£ss
)

423 =ğ
DROPBEAR_FAILURE
) {

424 
	`drİb—r_ex™
("Couldn't open initial channel");

428 
	`’üy±_·ck‘
();

429 
	`TRACE
(("leave cli_send_chansess_request"))

431 
	}
}

	@cli-kex.c

26 
	~"šşudes.h
"

27 
	~"£ssiÚ.h
"

28 
	~"dbut.h
"

29 
	~"®go.h
"

30 
	~"bufãr.h
"

31 
	~"£ssiÚ.h
"

32 
	~"kex.h
"

33 
	~"ssh.h
"

34 
	~"·ck‘.h
"

35 
	~"bignum.h
"

36 
	~"¿ndom.h
"

37 
	~"runİts.h
"

38 
	~"signkey.h
"

41 
checkho¡key
(* 
keyblob
, 
keyblobËn
);

42 
	#MAX_KNOWNHOSTS_LINE
 4500

	)

44 
	$£nd_msg_kexdh_š™
() {

46 
şi_£s
.
dh_e
 = (
mp_št
*)
	`m_m®loc
((mp_int));

47 
şi_£s
.
dh_x
 = (
mp_št
*)
	`m_m®loc
((mp_int));

48 
	`m_mp_š™_muÉi
(
şi_£s
.
dh_e
, cli_£s.
dh_x
, 
NULL
);

50 
	`g’_kexdh_v®s
(
şi_£s
.
dh_e
, cli_£s.
dh_x
);

52 
	`CHECKCLEARTOWRITE
();

53 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_KEXDH_INIT
);

54 
	`buf_putmpšt
(
£s
.
wr™•aylßd
, 
şi_£s
.
dh_e
);

55 
	`’üy±_·ck‘
();

56 
£s
.
»quœ’ext
 = 
SSH_MSG_KEXDH_REPLY
;

57 
	}
}

60 
	$»cv_msg_kexdh_»¶y
() {

62 
	`DEF_MP_INT
(
dh_f
);

63 
sign_key
 *
ho¡key
 = 
NULL
;

64 
ty³
, 
keyblobËn
;

65 * 
keyblob
 = 
NULL
;

68 
	`TRACE
(("enter„ecv_msg_kexdh_reply"))

70 ià(
şi_£s
.
kex_¡©e
 !ğ
KEXDH_INIT_SENT
) {

71 
	`drİb—r_ex™
("Received out-of-order kexdhreply");

73 
	`m_mp_š™
(&
dh_f
);

74 
ty³
 = 
£s
.
Ãwkeys
->
®go_ho¡key
;

75 
	`TRACE
(("ty³ i %d", 
ty³
))

77 
ho¡key
 = 
	`Ãw_sign_key
();

78 
keyblobËn
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

80 
keyblob
 = 
	`buf_g‘±r
(
£s
.
·ylßd
, 
keyblobËn
);

81 ià(!
£s
.
kex¡©e
.
dÚefœ¡kex
) {

83 
	`checkho¡key
(
keyblob
, 
keyblobËn
);

86 ià(
	`buf_g‘_pub_key
(
£s
.
·ylßd
, 
ho¡key
, &
ty³
è!ğ
DROPBEAR_SUCCESS
) {

87 
	`TRACE
(("failed getting…ubkey"))

88 
	`drİb—r_ex™
("Bad KEX…acket");

91 ià(
	`buf_g‘mpšt
(
£s
.
·ylßd
, &
dh_f
è!ğ
DROPBEAR_SUCCESS
) {

92 
	`TRACE
(("failed getting mpint"))

93 
	`drİb—r_ex™
("Bad KEX…acket");

96 
	`kexdh_comb_key
(
şi_£s
.
dh_e
, cli_£s.
dh_x
, &
dh_f
, 
ho¡key
);

97 
	`mp_ş—r
(&
dh_f
);

98 
	`mp_ş—r_muÉi
(
şi_£s
.
dh_e
, cli_£s.
dh_x
, 
NULL
);

99 
	`m_ä“
(
şi_£s
.
dh_e
);

100 
	`m_ä“
(
şi_£s
.
dh_x
);

102 ià(
	`buf_v”ify
(
£s
.
·ylßd
, 
ho¡key
, ses.
hash
, 
SHA1_HASH_SIZE
)

103 !ğ
DROPBEAR_SUCCESS
) {

104 
	`drİb—r_ex™
("Bad hostkey signature");

107 
	`sign_key_ä“
(
ho¡key
);

108 
ho¡key
 = 
NULL
;

110 
	`£nd_msg_Ãwkeys
();

111 
£s
.
»quœ’ext
 = 
SSH_MSG_NEWKEYS
;

112 
	`TRACE
(("leave„ecv_msg_kexdh_init"))

113 
	}
}

115 
	$ask_to_cÚfœm
(* 
keyblob
, 
keyblobËn
) {

117 * 
å
 = 
NULL
;

118 
FILE
 *
‰y
 = 
NULL
;

119 
»¥Ú£
 = 'z';

121 
å
 = 
	`sign_key_fšg”´št
(
keyblob
, 
keyblobËn
);

122 ià(
şi_İts
.
®ways_acû±_key
) {

123 
	`årštf
(
¡d”r
, "\nHost '%s' key‡ccepted unconditionally.\n(fingerprint %s)\n",

124 
şi_İts
.
»mÙeho¡
,

125 
å
);

126 
	`m_ä“
(
å
);

129 
	`årštf
(
¡d”r
, "\nHost '%s' is‚ot inherusted hosts file.\n(fingerprint %s)\nDo you wanto continue connecting? (y/n) ",

130 
şi_İts
.
»mÙeho¡
,

131 
å
);

132 
	`m_ä“
(
å
);

134 
‰y
 = 
	`fİ’
(
_PATH_TTY
, "r");

135 ià(
‰y
) {

136 
»¥Ú£
 = 
	`g‘c
(
‰y
);

137 
	`fşo£
(
‰y
);

139 
»¥Ú£
 = 
	`g‘c
(
¡dš
);

142 ià(
»¥Ú£
 == 'y') {

146 
	`drİb—r_ex™
("Didn't validate host key");

147 
	}
}

149 
FILE
* 
	$İ’_known_ho¡s_fe
(* 
»adÚly
)

151 
FILE
 * 
ho¡sfe
 = 
NULL
;

152 * 
f’ame
 = 
NULL
;

153 * 
homedœ
 = 
NULL
;

155 
homedœ
 = 
	`g‘’v
("HOME");

157 ià(!
homedœ
) {

158 
·sswd
 * 
pw
 = 
NULL
;

159 
pw
 = 
	`g‘pwuid
(
	`g‘uid
());

160 ià(
pw
) {

161 
homedœ
 = 
pw
->
pw_dœ
;

165 ià(
homedœ
) {

166 
Ën
;

167 
Ën
 = 
	`¡¾’
(
homedœ
);

168 
f’ame
 = 
	`m_m®loc
(
Ën
 + 18);

170 
	`¢´štf
(
f’ame
, 
Ën
+18, "%s/.ssh", 
homedœ
);

172 ià(
	`mkdœ
(
f’ame
, 
S_IRWXU
) != 0) {

173 ià(
”ºo
 !ğ
EEXIST
) {

174 
	`drİb—r_log
(
LOG_INFO
, "Warning: failed creating %s/.ssh: %s",

175 
homedœ
, 
	`¡»¼Ü
(
”ºo
));

176 
	`TRACE
(("mkdœ didn'ˆwÜk: %s", 
	`¡»¼Ü
(
”ºo
)))

177 
out
;

181 
	`¢´štf
(
f’ame
, 
Ën
+18, "%s/.ssh/known_ho¡s", 
homedœ
);

182 
ho¡sfe
 = 
	`fİ’
(
f’ame
, "a+");

184 ià(
ho¡sfe
 !ğ
NULL
) {

185 *
»adÚly
 = 0;

186 
	`f£ek
(
ho¡sfe
, 0, 
SEEK_SET
);

189 ià(
”ºo
 =ğ
EACCES
 ||ƒ¼nØ=ğ
EROFS
) {

190 
	`TRACE
(("Œyšg„—dÚly: %s", 
	`¡»¼Ü
(
”ºo
)))

191 *
»adÚly
 = 1;

192 
ho¡sfe
 = 
	`fİ’
(
f’ame
, "r");

197 ià(
ho¡sfe
 =ğ
NULL
) {

198 
	`TRACE
(("ho¡sfdidn'ˆİ’: %s", 
	`¡»¼Ü
(
”ºo
)))

199 
	`drİb—r_log
(
LOG_WARNING
, "Failedo open %s/.ssh/known_hosts",

200 
homedœ
);

201 
out
;

204 
out
:

205 
	`m_ä“
(
f’ame
);

206  
ho¡sfe
;

207 
	}
}

209 
	$checkho¡key
(* 
keyblob
, 
keyblobËn
) {

211 
FILE
 *
ho¡sfe
 = 
NULL
;

212 
»adÚly
 = 0;

213 
ho¡Ën
, 
®gŞ’
;

214 
Ën
;

215 cÚ¡ *
®gÚame
 = 
NULL
;

216 * 
fšg”´št
 = 
NULL
;

217 
bufãr
 * 
lše
 = 
NULL
;

218 
»t
;

220 
ho¡sfe
 = 
	`İ’_known_ho¡s_fe
(&
»adÚly
);

221 ià(!
ho¡sfe
) {

222 
	`ask_to_cÚfœm
(
keyblob
, 
keyblobËn
);

227 
lše
 = 
	`buf_Ãw
(
MAX_KNOWNHOSTS_LINE
);

228 
ho¡Ën
 = 
	`¡¾’
(
şi_İts
.
»mÙeho¡
);

229 
®gÚame
 = 
	`signkey_Çme_äom_ty³
(
£s
.
Ãwkeys
->
®go_ho¡key
, &
®gŞ’
);

232 ià(
	`buf_g‘lše
(
lše
, 
ho¡sfe
è=ğ
DROPBEAR_FAILURE
) {

233 
	`TRACE
(("failed„eading†ine:…rob EOF"))

241 ià(
lše
->
Ën
 < (
ho¡Ën
+30) ) {

242 
	`TRACE
(("line isoo shorto be sensible"))

247 ià(
	`¡ºcmp
(
şi_İts
.
»mÙeho¡
, 
	`buf_g‘±r
(
lše
, 
ho¡Ën
),

248 
ho¡Ën
) != 0) {

249 
	`TRACE
(("hosts don't match"))

253 
	`buf_šüpos
(
lše
, 
ho¡Ën
);

254 ià(
	`buf_g‘by‹
(
lše
) != ' ') {

256 
	`TRACE
(("missing space‡fte matching hostname"))

260 ià(
	`¡ºcmp
(
	`buf_g‘±r
(
lše
, 
®gŞ’
), 
®gÚame
,‡lgolen) != 0) {

261 
	`TRACE
(("algo doesn't match"))

265 
	`buf_šüpos
(
lše
, 
®gŞ’
);

266 ià(
	`buf_g‘by‹
(
lše
) != ' ') {

267 
	`TRACE
(("missing space‡fter‡lgo"))

272 
»t
 = 
	`cmp_ba£64_key
(
keyblob
, 
keyblobËn
, 
®gÚame
, 
®gŞ’
,

273 
lše
, &
fšg”´št
);

275 ià(
»t
 =ğ
DROPBEAR_SUCCESS
) {

277 
	`TRACE
(("good matching key"))

278 
out
;

283 
	`drİb—r_ex™
("\n\nHost key mismatch for %s !\n"

287 
şi_İts
.
»mÙeho¡
,

288 
	`sign_key_fšg”´št
(
keyblob
, 
keyblobËn
),

289 
fšg”´št
 ? fingerprint : "UNKNOWN");

293 
	`ask_to_cÚfœm
(
keyblob
, 
keyblobËn
);

297 ià(
»adÚly
) {

298 
	`TRACE
(("readonly"))

299 
out
;

302 ià(!
şi_İts
.
®ways_acû±_key
) {

304 
	`f£ek
(
ho¡sfe
, 0, 
SEEK_END
);

305 
	`buf_£os
(
lše
, 0);

306 
	`buf_£’
(
lše
, 0);

307 
	`buf_putby‹s
(
lše
, 
şi_İts
.
»mÙeho¡
, 
ho¡Ën
);

308 
	`buf_putby‹
(
lše
, ' ');

309 
	`buf_putby‹s
(
lše
, 
®gÚame
, 
®gŞ’
);

310 
	`buf_putby‹
(
lše
, ' ');

311 
Ën
 = 
lše
->
size
 -†še->
pos
;

312 
	`TRACE
(("keyblobËÀ%d,†’ %d", 
keyblobËn
, 
Ën
))

315 
	`ba£64_’code
(
keyblob
, 
keyblobËn
, 
	`buf_g‘wr™•Œ
(
lše
, 
Ën
), &len);

316 
	`buf_šüwr™•os
(
lše
, 
Ën
);

317 
	`buf_putby‹
(
lše
, '\n');

318 
	`buf_£os
(
lše
, 0);

319 
	`fwr™e
(
	`buf_g‘±r
(
lše
,†še->
Ën
),†še->Ën, 1, 
ho¡sfe
);

323 
out
:

324 ià(
ho¡sfe
 !ğ
NULL
) {

325 
	`fşo£
(
ho¡sfe
);

327 ià(
lše
 !ğ
NULL
) {

328 
	`buf_ä“
(
lše
);

330 
	`m_ä“
(
fšg”´št
);

331 
	}
}

	@cli-main.c

27 
	~"šşudes.h
"

28 
	~"dbut.h
"

29 
	~"runİts.h
"

30 
	~"£ssiÚ.h
"

32 
şi_drİb—r_ex™
(
ex™code
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
);

33 
şi_drİb—r_log
(
´iÜ™y
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
);

35 #ifdeà
ENABLE_CLI_PROXYCMD


36 
şi_´oxy_cmd
(*
sock_š
, *
sock_out
);

39 #ià
defšed
(
DBMULTI_dbş›Á
è|| !defšed(
DROPBEAR_MULTI
)

40 #ià
defšed
(
DBMULTI_dbş›Á
è&& defšed(
DROPBEAR_MULTI
)

41 
	$şi_maš
(
¬gc
, ** 
¬gv
) {

43 
	$maš
(
¬gc
, ** 
¬gv
) {

46 
sock_š
, 
sock_out
;

47 * 
”rÜ
 = 
NULL
;

49 
_drİb—r_ex™
 = 
şi_drİb—r_ex™
;

50 
_drİb—r_log
 = 
şi_drİb—r_log
;

52 
	`di§Îow_cÜe
();

54 
	`şi_g‘İts
(
¬gc
, 
¬gv
);

56 
	`TRACE
(("u£r='%s' ho¡='%s'…Üt='%s'", 
şi_İts
.
u£ºame
,

57 
şi_İts
.
»mÙeho¡
, cli_İts.
»mÙ•Üt
))

59 ià(
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
è=ğ
SIG_ERR
) {

60 
	`drİb—r_ex™
("signal()ƒrror");

63 #ifdeà
ENABLE_CLI_PROXYCMD


64 ià(
şi_İts
.
´oxycmd
) {

65 
	`şi_´oxy_cmd
(&
sock_š
, &
sock_out
);

66 
	`m_ä“
(
şi_İts
.
´oxycmd
);

70 
sock
 = 
	`cÚÃù_»mÙe
(
şi_İts
.
»mÙeho¡
, cli_İts.
»mÙ•Üt
,

71 0, &
”rÜ
);

72 
sock_š
 = 
sock_out
 = 
sock
;

75 ià(
sock_š
 < 0) {

76 
	`drİb—r_ex™
("%s", 
”rÜ
);

79 
	`şi_£ssiÚ
(
sock_š
, 
sock_out
);

83 
	}
}

86 
	$şi_drİb—r_ex™
(
ex™code
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
) {

88 
fmtbuf
[300];

90 ià(!
£ssš™dÚe
) {

91 
	`¢´štf
(
fmtbuf
, (fmtbuf), "Exited: %s",

92 
fÜm©
);

94 
	`¢´štf
(
fmtbuf
, (fmtbuf),

96 
şi_İts
.
u£ºame
, cli_İts.
»mÙeho¡
,

97 
şi_İts
.
»mÙ•Üt
, 
fÜm©
);

101 
	`şi_£ssiÚ_ş—nup
();

102 
	`commÚ_£ssiÚ_ş—nup
();

104 
	`_drİb—r_log
(
LOG_INFO
, 
fmtbuf
, 
·¿m
);

106 
	`ex™
(
ex™code
);

107 
	}
}

109 
şi_drİb—r_log
(
UNUSED
(
´iÜ™y
),

110 cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
) {

112 
	g´štbuf
[1024];

114 
v¢´štf
(
´štbuf
, Õrštbuf), 
fÜm©
, 
·¿m
);

116 
årštf
(
¡d”r
, "%s: %s\n", 
şi_İts
.
´ogÇme
, 
´štbuf
);

120 
	$exec_´oxy_cmd
(*
u£r_d©a_cmd
) {

121 cÚ¡ *
cmd
 = 
u£r_d©a_cmd
;

122 *
u£rsh–l
;

124 
u£rsh–l
 = 
	`m_¡rdup
(
	`g‘_u£r_sh–l
());

125 
	`run_sh–l_commªd
(
cmd
, 
£s
.
maxfd
, 
u£rsh–l
);

126 
	`drİb—r_ex™
("FaedØruÀ'%s'\n", 
cmd
);

127 
	}
}

129 #ifdeà
ENABLE_CLI_PROXYCMD


130 
	$şi_´oxy_cmd
(*
sock_š
, *
sock_out
) {

131 
»t
;

133 
	`fl_·sswd
(
şi_İts
.
own_u£r
);

135 
»t
 = 
	`¥awn_commªd
(
exec_´oxy_cmd
, 
şi_İts
.
´oxycmd
,

136 
sock_out
, 
sock_š
, 
NULL
, NULL);

137 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

138 
	`drİb—r_ex™
("Failed„unning…roxy command");

139 *
sock_š
 = *
sock_out
 = -1;

141 
	}
}

	@cli-runopts.c

25 
	~"šşudes.h
"

26 
	~"runİts.h
"

27 
	~"signkey.h
"

28 
	~"bufãr.h
"

29 
	~"dbut.h
"

30 
	~"®go.h
"

31 
	~"tıfwd.h
"

32 
	~"li¡.h
"

34 
şi_runİts
 
	gşi_İts
;

36 
´šth–p
();

37 
·r£_ho¡Çme
(cÚ¡ * 
Üigho¡¬g
);

38 
·r£_muÉihİ_ho¡Çme
(cÚ¡ * 
Üigho¡¬g
, cÚ¡ * 
¬gv0
);

39 
fl_own_u£r
();

40 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


41 
lßdid’t™yfe
(cÚ¡ * 
f’ame
);

43 #ifdeà
ENABLE_CLI_ANYTCPFWD


44 
addfÜw¬d
(cÚ¡ * 
¡r
, 
m_li¡
 *
fwdli¡
);

46 #ifdeà
ENABLE_CLI_NETCAT


47 
add_Ãtÿt
(cÚ¡ *
¡r
);

50 
	$´šth–p
() {

52 
	`årštf
(
¡d”r
, "Dropbear client v%s\n"

53 #ifdeà
ENABLE_CLI_MULTIHOP


67 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


70 #ifdeà
ENABLE_CLI_AGENTFWD


73 #ifdeà
ENABLE_CLI_LOCALTCPFWD


77 #ifdeà
ENABLE_CLI_REMOTETCPFWD


83 #ifdeà
ENABLE_CLI_NETCAT


86 #ifdeà
ENABLE_CLI_PROXYCMD


89 #ifdeà
DEBUG_TRACE


92 ,
DROPBEAR_VERSION
, 
şi_İts
.
´ogÇme
,

93 
DEFAULT_RECV_WINDOW
, 
DEFAULT_KEEPALIVE
, 
DEFAULT_IDLE_TIMEOUT
);

95 
	}
}

97 
	$şi_g‘İts
(
¬gc
, ** 
¬gv
) {

98 
i
, 
j
;

99 ** 
Ãxt
 = 0;

100 
cmdËn
;

101 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


102 
Ãxtiskey
 = 0;

104 #ifdeà
ENABLE_CLI_LOCALTCPFWD


105 
Ãxti¦oÿl
 = 0;

107 #ifdeà
ENABLE_CLI_REMOTETCPFWD


108 
Ãxti¤emÙe
 = 0;

110 #ifdeà
ENABLE_CLI_NETCAT


111 
Ãxti¢‘ÿt
 = 0;

113 * 
dummy
 = 
NULL
;

115 * 
»cv_wšdow_¬g
 = 
NULL
;

116 * 
k“·live_¬g
 = 
NULL
;

117 * 
idË_timeout_¬g
 = 
NULL
;

118 *
ho¡_¬g
 = 
NULL
;

121 
şi_İts
.
´ogÇme
 = 
¬gv
[0];

122 
şi_İts
.
»mÙeho¡
 = 
NULL
;

123 
şi_İts
.
»mÙ•Üt
 = 
NULL
;

124 
şi_İts
.
u£ºame
 = 
NULL
;

125 
şi_İts
.
cmd
 = 
NULL
;

126 
şi_İts
.
no_cmd
 = 0;

127 
şi_İts
.
backgrounded
 = 0;

128 
şi_İts
.
wªty
 = 9;

129 
şi_İts
.
®ways_acû±_key
 = 0;

130 
şi_İts
.
is_subsy¡em
 = 0;

131 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


132 
şi_İts
.
´ivkeys
 = 
	`li¡_Ãw
();

134 #ifdeà
ENABLE_CLI_LOCALTCPFWD


135 
şi_İts
.
loÿlfwds
 = 
	`li¡_Ãw
();

136 
İts
.
li¡’_fwd_®l
 = 0;

138 #ifdeà
ENABLE_CLI_REMOTETCPFWD


139 
şi_İts
.
»mÙefwds
 = 
	`li¡_Ãw
();

141 #ifdeà
ENABLE_CLI_AGENTFWD


142 
şi_İts
.
ag’t_fwd
 = 0;

143 
şi_İts
.
ag’t_keys_lßded
 = 0;

145 #ifdeà
ENABLE_CLI_PROXYCMD


146 
şi_İts
.
´oxycmd
 = 
NULL
;

148 #iâdeà
DISABLE_ZLIB


149 
İts
.
’abË_com´ess
 = 1;

155 
İts
.
»cv_wšdow
 = 
DEFAULT_RECV_WINDOW
;

157 
	`fl_own_u£r
();

160 
i
 = 1; i < ()
¬gc
; i++) {

161 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


162 ià(
Ãxtiskey
) {

164 
	`lßdid’t™yfe
(
¬gv
[
i
]);

165 
Ãxtiskey
 = 0;

169 #ifdeà
ENABLE_CLI_REMOTETCPFWD


170 ià(
Ãxti¤emÙe
) {

171 
	`TRACE
(("nextisremoterue"))

172 
	`addfÜw¬d
(
¬gv
[
i
], 
şi_İts
.
»mÙefwds
);

173 
Ãxti¤emÙe
 = 0;

177 #ifdeà
ENABLE_CLI_LOCALTCPFWD


178 ià(
Ãxti¦oÿl
) {

179 
	`TRACE
(("nextislocalrue"))

180 
	`addfÜw¬d
(
¬gv
[
i
], 
şi_İts
.
loÿlfwds
);

181 
Ãxti¦oÿl
 = 0;

185 #ifdeà
ENABLE_CLI_NETCAT


186 ià(
Ãxti¢‘ÿt
) {

187 
	`TRACE
(("nextisnetcatrue"))

188 
	`add_Ãtÿt
(
¬gv
[
i
]);

189 
Ãxti¢‘ÿt
 = 0;

193 ià(
Ãxt
) {

195 *
Ãxt
 = 
¬gv
[
i
];

196 ià(*
Ãxt
 =ğ
NULL
) {

197 
	`drİb—r_ex™
("Invalid‚ull‡rgument");

199 
Ãxt
 = 
NULL
;

203 ià(
¬gv
[
i
][0] == '-') {

206 
¬gv
[
i
][1]) {

208 
şi_İts
.
®ways_acû±_key
 = 1;

211 
Ãxt
 = &
şi_İts
.
»mÙ•Üt
;

213 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


216 ià(
	`¡¾’
(
¬gv
[
i
]) > 2) {

217 
	`lßdid’t™yfe
(&
¬gv
[
i
][2]);

219 
Ãxtiskey
 = 1;

224 
şi_İts
.
wªty
 = 1;

227 
şi_İts
.
wªty
 = 0;

230 
şi_İts
.
no_cmd
 = 1;

233 
şi_İts
.
backgrounded
 = 1;

236 
şi_İts
.
is_subsy¡em
 = 1;

238 #ifdeà
ENABLE_CLI_LOCALTCPFWD


240 
Ãxti¦oÿl
 = 1;

243 
İts
.
li¡’_fwd_®l
 = 1;

246 #ifdeà
ENABLE_CLI_REMOTETCPFWD


248 
Ãxti¤emÙe
 = 1;

251 #ifdeà
ENABLE_CLI_NETCAT


253 
Ãxti¢‘ÿt
 = 1;

256 #ifdeà
ENABLE_CLI_PROXYCMD


258 
Ãxt
 = &
şi_İts
.
´oxycmd
;

262 
Ãxt
 = &
şi_İts
.
u£ºame
;

265 
	`´šth–p
();

266 
	`ex™
(
EXIT_SUCCESS
);

272 
Ãxt
 = &
»cv_wšdow_¬g
;

275 
Ãxt
 = &
k“·live_¬g
;

278 
Ãxt
 = &
idË_timeout_¬g
;

280 #ifdeà
ENABLE_CLI_AGENTFWD


282 
şi_İts
.
ag’t_fwd
 = 1;

285 #ifdeà
DEBUG_TRACE


287 
debug_Œaû
 = 1;

295 #iâdeà
ENABLE_CLI_REMOTETCPFWD


298 #iâdeà
ENABLE_CLI_LOCALTCPFWD


303 
Ãxt
 = &
dummy
;

305 
	`årštf
(
¡d”r
,

306 "WARNING: IgnÜšg unknowÀ¬gum’ˆ'%s'\n", 
¬gv
[
i
]);

311 ià(
Ãxt
 && 
	`¡¾’
(
¬gv
[
i
]) > 2) {

312 *
Ãxt
 = &
¬gv
[
i
][2];

313 
Ãxt
 = 
NULL
;

319 
	`TRACE
(("nÚ-æag‡rg: '%s'", 
¬gv
[
i
]))

323 ià(
ho¡_¬g
 =ğ
NULL
) {

324 
ho¡_¬g
 = 
¬gv
[
i
];

330 
cmdËn
 = 0;

331 
j
 = 
i
; j < ()
¬gc
; j++) {

332 
cmdËn
 +ğ
	`¡¾’
(
¬gv
[
j
]) + 1;

335 
şi_İts
.
cmd
 = (*)
	`m_m®loc
(
cmdËn
);

336 
şi_İts
.
cmd
[0] = '\0';

339 
j
 = 
i
; j < ()
¬gc
; j++) {

340 
	`¡¾ÿt
(
şi_İts
.
cmd
, 
¬gv
[
j
], 
cmdËn
);

341 
	`¡¾ÿt
(
şi_İts
.
cmd
, " ", 
cmdËn
);

353 ià(
ho¡_¬g
 =ğ
NULL
) {

354 
	`´šth–p
();

355 
	`ex™
(
EXIT_FAILURE
);

358 ià(
şi_İts
.
»mÙ•Üt
 =ğ
NULL
) {

359 
şi_İts
.
»mÙ•Üt
 = "22";

364 ià(
şi_İts
.
wªty
 == 9) {

365 ià(
şi_İts
.
cmd
 =ğ
NULL
) {

366 
şi_İts
.
wªty
 = 1;

368 
şi_İts
.
wªty
 = 0;

372 ià(
şi_İts
.
backgrounded
 && cli_İts.
cmd
 =ğ
NULL


373 && 
şi_İts
.
no_cmd
 == 0) {

374 
	`drİb—r_ex™
("Command„equired for -f");

377 ià(
»cv_wšdow_¬g
) {

378 
İts
.
»cv_wšdow
 = 
	`©Ş
(
»cv_wšdow_¬g
);

379 ià(
İts
.
»cv_wšdow
 =ğ0 || o±s.»cv_wšdow > 
MAX_RECV_WINDOW
) {

380 
	`drİb—r_ex™
("Bad„ecv wšdow '%s'", 
»cv_wšdow_¬g
);

383 ià(
k“·live_¬g
) {

384 
v®
;

385 ià(
	`m_¡r_to_ušt
(
k“·live_¬g
, &
v®
è=ğ
DROPBEAR_FAILURE
) {

386 
	`drİb—r_ex™
("Bad k“·liv'%s'", 
k“·live_¬g
);

388 
İts
.
k“·live_£cs
 = 
v®
;

391 ià(
idË_timeout_¬g
) {

392 
v®
;

393 ià(
	`m_¡r_to_ušt
(
idË_timeout_¬g
, &
v®
è=ğ
DROPBEAR_FAILURE
) {

394 
	`drİb—r_ex™
("Bad idË_timeouˆ'%s'", 
idË_timeout_¬g
);

396 
İts
.
idË_timeout_£cs
 = 
v®
;

399 #ifdeà
ENABLE_CLI_NETCAT


400 ià(
şi_İts
.
cmd
 && cli_İts.
Ãtÿt_ho¡
) {

401 
	`drİb—r_log
(
LOG_INFO
, "IgnÜšg commªd '%s' iÀÃtÿˆmode", 
şi_İts
.
cmd
);

408 #ifdeà
ENABLE_CLI_MULTIHOP


409 
	`·r£_muÉihİ_ho¡Çme
(
ho¡_¬g
, 
¬gv
[0]);

411 
	`·r£_ho¡Çme
(
ho¡_¬g
);

413 
	}
}

415 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


416 
	$lßdid’t™yfe
(cÚ¡ * 
f’ame
) {

417 
sign_key
 *
key
;

418 
keyty³
;

420 
key
 = 
	`Ãw_sign_key
();

421 
keyty³
 = 
DROPBEAR_SIGNKEY_ANY
;

422 iàĞ
	`»adho¡key
(
f’ame
, 
key
, &
keyty³
è!ğ
DROPBEAR_SUCCESS
 ) {

423 
	`årštf
(
¡d”r
, "Faed†ßdšg keyf'%s'\n", 
f’ame
);

424 
	`sign_key_ä“
(
key
);

426 
key
->
ty³
 = 
keyty³
;

427 
key
->
sourû
 = 
SIGNKEY_SOURCE_RAW_FILE
;

428 
key
->
f’ame
 = 
	`m_¡rdup
(filename);

429 
	`li¡_­³nd
(
şi_İts
.
´ivkeys
, 
key
);

431 
	}
}

434 #ifdeà
ENABLE_CLI_MULTIHOP


437 
	$muÉihİ_·s¡hrough_¬gs
() {

438 *
»t
;

439 
tÙ®
;

440 
Ën
 = 0;

441 
m_li¡_–em
 *
™”
;

444 
™”
 = 
şi_İts
.
´ivkeys
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
)

446 
sign_key
 * 
key
 = (sign_key*)
™”
->
™em
;

447 
Ën
 +ğ3 + 
	`¡¾’
(
key
->
f’ame
);

449 
Ën
 += 20;

450 
»t
 = 
	`m_m®loc
(
Ën
);

451 
tÙ®
 = 0;

453 ià(
İts
.
»cv_wšdow
 !ğ
DEFAULT_RECV_WINDOW
)

455 
wr™‹n
 = 
	`¢´štf
(
»t
+
tÙ®
, 
Ën
-tÙ®, "-W %d", 
İts
.
»cv_wšdow
);

456 
tÙ®
 +ğ
wr™‹n
;

459 
™”
 = 
şi_İts
.
´ivkeys
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
)

461 
sign_key
 * 
key
 = (sign_key*)
™”
->
™em
;

462 cÚ¡ 
size_t
 
size
 = 
Ën
 - 
tÙ®
;

463 
wr™‹n
 = 
	`¢´štf
(
»t
+
tÙ®
, 
size
, "-˜%s", 
key
->
f’ame
);

464 
	`drİb—r_as£¹
(()
wr™‹n
 < 
size
);

465 
tÙ®
 +ğ
wr™‹n
;

468  
»t
;

469 
	}
}

483 
	$·r£_muÉihİ_ho¡Çme
(cÚ¡ * 
Üigho¡¬g
, cÚ¡ * 
¬gv0
) {

484 *
u£rho¡¬g
 = 
NULL
;

485 *
ho¡buf
 = 
NULL
;

486 *
Ï¡_hİ
 = 
NULL
;

487 *
»mašd”
 = 
NULL
;

494 ià(
şi_İts
.
u£ºame


495 && 
	`¡rchr
(
şi_İts
.
u£ºame
, ',')

496 && 
	`¡rchr
(
şi_İts
.
u£ºame
, '@')) {

497 
Ën
 = 
	`¡¾’
(
Üigho¡¬g
è+ sŒËn(
şi_İts
.
u£ºame
) + 2;

498 
ho¡buf
 = 
	`m_m®loc
(
Ën
);

499 
	`¢´štf
(
ho¡buf
, 
Ën
, "%s@%s", 
şi_İts
.
u£ºame
, 
Üigho¡¬g
);

501 
ho¡buf
 = 
	`m_¡rdup
(
Üigho¡¬g
);

503 
u£rho¡¬g
 = 
ho¡buf
;

505 
Ï¡_hİ
 = 
	`¡¼chr
(
u£rho¡¬g
, ',');

506 ià(
Ï¡_hİ
) {

507 ià(
Ï¡_hİ
 =ğ
u£rho¡¬g
) {

508 
	`drİb—r_ex™
("Bad multi-hop hostnames");

510 *
Ï¡_hİ
 = '\0';

511 
Ï¡_hİ
++;

512 
»mašd”
 = 
u£rho¡¬g
;

513 
u£rho¡¬g
 = 
Ï¡_hİ
;

516 
	`·r£_ho¡Çme
(
u£rho¡¬g
);

518 ià(
Ï¡_hİ
) {

520 
cmd_Ën
 = 0;

521 *
·s¡hrough_¬gs
 = 
	`muÉihİ_·s¡hrough_¬gs
();

522 ià(
şi_İts
.
´oxycmd
) {

523 
	`drİb—r_ex™
("-J can't be used with multihop mode");

525 ià(
şi_İts
.
»mÙ•Üt
 =ğ
NULL
) {

526 
şi_İts
.
»mÙ•Üt
 = "22";

528 
cmd_Ën
 = 
	`¡¾’
(
¬gv0
è+ sŒËn(
»mašd”
)

529 + 
	`¡¾’
(
şi_İts
.
»mÙeho¡
è+ sŒËn(şi_İts.
»mÙ•Üt
)

530 + 
	`¡¾’
(
·s¡hrough_¬gs
)

532 
şi_İts
.
´oxycmd
 = 
	`m_m®loc
(
cmd_Ën
);

533 
	`¢´štf
(
şi_İts
.
´oxycmd
, 
cmd_Ën
, "%s -B %s:%s %s %s",

534 
¬gv0
, 
şi_İts
.
»mÙeho¡
, cli_İts.
»mÙ•Üt
,

535 
·s¡hrough_¬gs
, 
»mašd”
);

536 #iâdeà
DISABLE_ZLIB


538 
İts
.
’abË_com´ess
 = 0;

540 
	`m_ä“
(
·s¡hrough_¬gs
);

542 
	`m_ä“
(
ho¡buf
);

543 
	}
}

547 
	$·r£_ho¡Çme
(cÚ¡ * 
Üigho¡¬g
) {

548 *
u£rho¡¬g
 = 
NULL
;

549 *
pÜt
 = 
NULL
;

551 
u£rho¡¬g
 = 
	`m_¡rdup
(
Üigho¡¬g
);

553 
şi_İts
.
»mÙeho¡
 = 
	`¡rchr
(
u£rho¡¬g
, '@');

554 ià(
şi_İts
.
»mÙeho¡
 =ğ
NULL
) {

557 
şi_İts
.
»mÙeho¡
 = 
u£rho¡¬g
;

559 
şi_İts
.
»mÙeho¡
[0] = '\0';

560 
şi_İts
.
»mÙeho¡
++;

561 
şi_İts
.
u£ºame
 = 
u£rho¡¬g
;

564 ià(
şi_İts
.
u£ºame
 =ğ
NULL
) {

565 
şi_İts
.
u£ºame
 = 
	`m_¡rdup
(şi_İts.
own_u£r
);

568 
pÜt
 = 
	`¡rchr
(
şi_İts
.
»mÙeho¡
, '/');

569 ià(
pÜt
) {

570 *
pÜt
 = '\0';

571 
şi_İts
.
»mÙ•Üt
 = 
pÜt
+1;

574 ià(
şi_İts
.
»mÙeho¡
[0] == '\0') {

575 
	`drİb—r_ex™
("Bad hostname");

577 
	}
}

579 #ifdeà
ENABLE_CLI_NETCAT


580 
	$add_Ãtÿt
(cÚ¡ * 
Üig¡r
) {

581 *
pÜt¡r
 = 
NULL
;

583 * 
¡r
 = 
	`m_¡rdup
(
Üig¡r
);

585 
pÜt¡r
 = 
	`¡rchr
(
¡r
, ':');

586 ià(
pÜt¡r
 =ğ
NULL
) {

587 
	`TRACE
(("No‚etcat…ort"))

588 
ç
;

590 *
pÜt¡r
 = '\0';

591 
pÜt¡r
++;

593 ià(
	`¡rchr
(
pÜt¡r
, ':')) {

594 
	`TRACE
(("Multiple‚etcat colons"))

595 
ç
;

598 ià(
	`m_¡r_to_ušt
(
pÜt¡r
, &
şi_İts
.
Ãtÿt_pÜt
è=ğ
DROPBEAR_FAILURE
) {

599 
	`TRACE
(("bad‚etcat…ort"))

600 
ç
;

603 ià(
şi_İts
.
Ãtÿt_pÜt
 > 65535) {

604 
	`TRACE
(("too†arge‚etcat…ort"))

605 
ç
;

608 
şi_İts
.
Ãtÿt_ho¡
 = 
¡r
;

611 
ç
:

612 
	`drİb—r_ex™
("Bad‚‘ÿˆ’dpošˆ'%s'", 
Üig¡r
);

613 
	}
}

616 
	$fl_own_u£r
() {

617 
uid_t
 
uid
;

618 
·sswd
 *
pw
 = 
NULL
;

620 
uid
 = 
	`g‘uid
();

622 
pw
 = 
	`g‘pwuid
(
uid
);

623 ià(
pw
 =ğ
NULL
 ||…w->
pw_Çme
 == NULL) {

624 
	`drİb—r_ex™
("Unknown own user");

627 
şi_İts
.
own_u£r
 = 
	`m_¡rdup
(
pw
->
pw_Çme
);

628 
	}
}

630 #ifdeà
ENABLE_CLI_ANYTCPFWD


633 
	$addfÜw¬d
(cÚ¡ * 
Üig¡r
, 
m_li¡
 *
fwdli¡
) {

635 *
·¹1
 = 
NULL
, *
·¹2
 = NULL, *
·¹3
 = NULL, *
·¹4
 = NULL;

636 * 
li¡’addr
 = 
NULL
;

637 * 
li¡’pÜt
 = 
NULL
;

638 * 
cÚÃùaddr
 = 
NULL
;

639 * 
cÚÃùpÜt
 = 
NULL
;

640 
TCPFwdEÁry
* 
Ãwfwd
 = 
NULL
;

641 * 
¡r
 = 
NULL
;

643 
	`TRACE
(("enter‡ddforward"))

647 
¡r
 = 
	`m_¡rdup
(
Üig¡r
);

649 
·¹1
 = 
¡r
;

651 
·¹2
 = 
	`¡rchr
(
¡r
, ':');

652 ià(
·¹2
 =ğ
NULL
) {

653 
	`TRACE
(("part2 == NULL"))

654 
ç
;

656 *
·¹2
 = '\0';

657 
·¹2
++;

659 
·¹3
 = 
	`¡rchr
(
·¹2
, ':');

660 ià(
·¹3
 =ğ
NULL
) {

661 
	`TRACE
(("part3 == NULL"))

662 
ç
;

664 *
·¹3
 = '\0';

665 
·¹3
++;

667 
·¹4
 = 
	`¡rchr
(
·¹3
, ':');

668 ià(
·¹4
) {

669 *
·¹4
 = '\0';

670 
·¹4
++;

673 ià(
·¹4
) {

674 
li¡’addr
 = 
·¹1
;

675 
li¡’pÜt
 = 
·¹2
;

676 
cÚÃùaddr
 = 
·¹3
;

677 
cÚÃùpÜt
 = 
·¹4
;

679 
li¡’addr
 = 
NULL
;

680 
li¡’pÜt
 = 
·¹1
;

681 
cÚÃùaddr
 = 
·¹2
;

682 
cÚÃùpÜt
 = 
·¹3
;

685 
Ãwfwd
 = 
	`m_m®loc
((
TCPFwdEÁry
));

689 ià(
	`m_¡r_to_ušt
(
li¡’pÜt
, &
Ãwfwd
->li¡’pÜtè=ğ
DROPBEAR_FAILURE
) {

690 
	`TRACE
(("bad†istenport strtoul"))

691 
ç
;

694 ià(
	`m_¡r_to_ušt
(
cÚÃùpÜt
, &
Ãwfwd
->cÚÃùpÜtè=ğ
DROPBEAR_FAILURE
) {

695 
	`TRACE
(("bad connectport strtoul"))

696 
ç
;

699 
Ãwfwd
->
li¡’addr
 =†istenaddr;

700 
Ãwfwd
->
cÚÃùaddr
 = connectaddr;

702 ià(
Ãwfwd
->
li¡’pÜt
 > 65535) {

703 
	`TRACE
(("listenport > 65535"))

704 
badpÜt
;

707 ià(
Ãwfwd
->
cÚÃùpÜt
 > 65535) {

708 
	`TRACE
(("connectport > 65535"))

709 
badpÜt
;

712 
Ãwfwd
->
have_»¶y
 = 0;

713 
	`li¡_­³nd
(
fwdli¡
, 
Ãwfwd
);

715 
	`TRACE
(("leave‡ddforward: done"))

718 
ç
:

719 
	`drİb—r_ex™
("Bad TCP fÜw¬d '%s'", 
Üig¡r
);

721 
badpÜt
:

722 
	`drİb—r_ex™
("Bad TCP…Üˆš '%s'", 
Üig¡r
);

723 
	}
}

	@cli-service.c

26 
	~"šşudes.h
"

27 
	~"£rviû.h
"

28 
	~"dbut.h
"

29 
	~"·ck‘.h
"

30 
	~"bufãr.h
"

31 
	~"£ssiÚ.h
"

32 
	~"ssh.h
"

34 
	$£nd_msg_£rviû_»que¡
(* 
£rviûÇme
) {

36 
	`TRACE
(("’‹¸£nd_msg_£rviû_»que¡: s”viûÇme='%s'", 
£rviûÇme
))

38 
	`CHECKCLEARTOWRITE
();

40 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_SERVICE_REQUEST
);

41 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
£rviûÇme
, 
	`¡¾’
(servicename));

43 
	`’üy±_·ck‘
();

44 
	`TRACE
(("leave send_msg_service_request"))

45 
	}
}

49 
	$»cv_msg_£rviû_acû±
() {

51 * 
£rviûÇme
;

52 
Ën
;

54 
	`TRACE
(("enter„ecv_msg_service_accept"))

56 
£rviûÇme
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
Ën
);

59 ià(
şi_£s
.
¡©e
 =ğ
SERVICE_AUTH_REQ_SENT


60 && 
Ën
 =ğ
SSH_SERVICE_USERAUTH_LEN


61 && 
	`¡ºcmp
(
SSH_SERVICE_USERAUTH
, 
£rviûÇme
, 
Ën
) == 0) {

63 
şi_£s
.
¡©e
 = 
SERVICE_AUTH_ACCEPT_RCVD
;

64 
	`m_ä“
(
£rviûÇme
);

65 
	`TRACE
(("leave„ecv_msg_service_accept: done ssh-userauth"))

70 ià(
şi_£s
.
¡©e
 =ğ
SERVICE_CONN_REQ_SENT


71 && 
Ën
 =ğ
SSH_SERVICE_CONNECTION_LEN


72 && 
	`¡ºcmp
(
SSH_SERVICE_CONNECTION
, 
£rviûÇme
, 
Ën
) == 0) {

74 ià(
£s
.
auth¡©e
.
authdÚe
 != 1) {

75 
	`drİb—r_ex™
("Request for connection before‡uth");

78 
şi_£s
.
¡©e
 = 
SERVICE_CONN_ACCEPT_RCVD
;

79 
	`m_ä“
(
£rviûÇme
);

80 
	`TRACE
(("leave„ecv_msg_service_accept: done ssh-connection"))

84 
	`drİb—r_ex™
("Unrecognised service‡ccept");

85 
	}
}

	@cli-session.c

26 
	~"šşudes.h
"

27 
	~"£ssiÚ.h
"

28 
	~"dbut.h
"

29 
	~"kex.h
"

30 
	~"ssh.h
"

31 
	~"·ck‘.h
"

32 
	~"tıfwd.h
"

33 
	~"chªÃl.h
"

34 
	~"¿ndom.h
"

35 
	~"£rviû.h
"

36 
	~"runİts.h
"

37 
	~"chª£ssiÚ.h
"

38 
	~"ag’tfwd.h
"

40 
şi_»mÙeşo£d
();

41 
şi_£ssiÚloİ
();

42 
şi_£ssiÚ_š™
();

43 
şi_fšished
();

45 
ş›Á£ssiÚ
 
	gşi_£s
;

49 cÚ¡ 
·ck‘ty³
 
	gşi_·ck‘ty³s
[] = {

51 {
SSH_MSG_CHANNEL_DATA
, 
»cv_msg_chªÃl_d©a
},

52 {
SSH_MSG_CHANNEL_EXTENDED_DATA
, 
»cv_msg_chªÃl_ex‹nded_d©a
},

53 {
SSH_MSG_CHANNEL_WINDOW_ADJUST
, 
»cv_msg_chªÃl_wšdow_adju¡
},

54 {
SSH_MSG_USERAUTH_FAILURE
, 
»cv_msg_u£¿uth_çu»
},

55 {
SSH_MSG_USERAUTH_SUCCESS
, 
»cv_msg_u£¿uth_sucûss
},

56 {
SSH_MSG_KEXINIT
, 
»cv_msg_kexš™
},

57 {
SSH_MSG_KEXDH_REPLY
, 
»cv_msg_kexdh_»¶y
},

58 {
SSH_MSG_NEWKEYS
, 
»cv_msg_Ãwkeys
},

59 {
SSH_MSG_SERVICE_ACCEPT
, 
»cv_msg_£rviû_acû±
},

60 {
SSH_MSG_CHANNEL_REQUEST
, 
»cv_msg_chªÃl_»que¡
},

61 {
SSH_MSG_CHANNEL_OPEN
, 
»cv_msg_chªÃl_İ’
},

62 {
SSH_MSG_CHANNEL_EOF
, 
»cv_msg_chªÃl_eof
},

63 {
SSH_MSG_CHANNEL_CLOSE
, 
»cv_msg_chªÃl_şo£
},

64 {
SSH_MSG_CHANNEL_OPEN_CONFIRMATION
, 
»cv_msg_chªÃl_İ’_cÚfœm©iÚ
},

65 {
SSH_MSG_CHANNEL_OPEN_FAILURE
, 
»cv_msg_chªÃl_İ’_çu»
},

66 {
SSH_MSG_USERAUTH_BANNER
, 
»cv_msg_u£¿uth_bªÃr
},

67 {
SSH_MSG_USERAUTH_SPECIFIC_60
, 
»cv_msg_u£¿uth_¥ecific_60
},

68 #ifdeà 
ENABLE_CLI_REMOTETCPFWD


69 {
SSH_MSG_REQUEST_SUCCESS
, 
şi_»cv_msg_»que¡_sucûss
},

70 {
SSH_MSG_REQUEST_FAILURE
, 
şi_»cv_msg_»que¡_çu»
},

75 cÚ¡ 
ChªTy³
 *
	gşi_chªty³s
[] = {

76 #ifdeà
ENABLE_CLI_REMOTETCPFWD


77 &
şi_chª_tı»mÙe
,

79 #ifdeà
ENABLE_CLI_AGENTFWD


80 &
şi_chª_ag’t
,

82 
NULL


85 
	$şi_£ssiÚ
(
sock_š
, 
sock_out
) {

87 
	`£ed¿ndom
();

89 
	`üy±o_š™
();

91 
	`commÚ_£ssiÚ_š™
(
sock_š
, 
sock_out
);

93 
	`chªš™Ÿli£
(
şi_chªty³s
);

96 
	`şi_£ssiÚ_š™
();

99 
£ssš™dÚe
 = 1;

102 
	`£ssiÚ_id’tifiÿtiÚ
();

104 
	`£nd_msg_kexš™
();

106 
	`£ssiÚ_loİ
(
şi_£ssiÚloİ
);

110 
	}
}

112 
	$şi_£ssiÚ_š™
() {

114 
şi_£s
.
¡©e
 = 
STATE_NOTHING
;

115 
şi_£s
.
kex_¡©e
 = 
KEX_NOTHING
;

117 
şi_£s
.
‰y_¿w_mode
 = 0;

118 
şi_£s
.
wšchªge
 = 0;

122 
şi_£s
.
¡dšcİy
 = 
	`dup
(
STDIN_FILENO
);

123 
şi_£s
.
¡dšæags
 = 
	`fú
(
STDIN_FILENO
, 
F_GETFL
, 0);

124 
şi_£s
.
¡doutcİy
 = 
	`dup
(
STDOUT_FILENO
);

125 
şi_£s
.
¡doutæags
 = 
	`fú
(
STDOUT_FILENO
, 
F_GETFL
, 0);

126 
şi_£s
.
¡d”rcİy
 = 
	`dup
(
STDERR_FILENO
);

127 
şi_£s
.
¡d”ræags
 = 
	`fú
(
STDERR_FILENO
, 
F_GETFL
, 0);

129 
şi_£s
.
»tv®
 = 
EXIT_SUCCESS
;

133 
şi_£s
.
Ï¡´ivkey
 = 
NULL
;

134 
şi_£s
.
Ï¡authty³
 = 0;

137 
£s
.
»mÙeşo£d
 = 
şi_»mÙeşo£d
;

138 
£s
.
buf_m©ch_®go
 = 
şi_buf_m©ch_®go
;

141 
£s
.
·ck‘ty³s
 = 
şi_·ck‘ty³s
;

143 
£s
.
is£rv”
 = 0;

144 
	}
}

148 
	$şi_£ssiÚloİ
() {

150 
	`TRACE
(("enter cli_sessionloop"))

152 ià(
£s
.
Ï¡·ck‘
 =ğ
SSH_MSG_KEXINIT
 && 
şi_£s
.
kex_¡©e
 =ğ
KEX_NOTHING
) {

153 
şi_£s
.
kex_¡©e
 = 
KEXINIT_RCVD
;

156 ià(
şi_£s
.
kex_¡©e
 =ğ
KEXINIT_RCVD
) {

160 
	`£nd_msg_kexdh_š™
();

161 
şi_£s
.
kex_¡©e
 = 
KEXDH_INIT_SENT
;

162 
	`TRACE
(("leave cli_sessionloop: done with KEXINIT_RCVD"))

167 ià(
şi_£s
.
kex_¡©e
 !ğ
KEX_NOTHING
 && 
£s
.
kex¡©e
.
»cvkexš™
 == 0

168 && 
£s
.
kex¡©e
.
£Ákexš™
 == 0) {

169 
şi_£s
.
kex_¡©e
 = 
KEX_NOTHING
;

173 ià(
şi_£s
.
kex_¡©e
 !ğ
KEX_NOTHING
) {

174 
	`TRACE
(("leave cli_sessionloop: kex_state != KEX_NOTHING"))

180 ià(
£s
.
kex¡©e
.
dÚefœ¡kex
 == 0) {

181 
	`TRACE
(("XXX XXX might be bad!†eave cli_sessionloop: haven't donefirstkex"))

185 
şi_£s
.
¡©e
) {

187 
STATE_NOTHING
:

190 
	`£nd_msg_£rviû_»que¡
(
SSH_SERVICE_USERAUTH
);

191 
şi_£s
.
¡©e
 = 
SERVICE_AUTH_REQ_SENT
;

192 
	`TRACE
(("leave cli_sessionloop: sent userauth service„eq"))

196 
SERVICE_AUTH_ACCEPT_RCVD
:

197 
	`şi_auth_g‘m‘hods
();

198 
şi_£s
.
¡©e
 = 
USERAUTH_REQ_SENT
;

199 
	`TRACE
(("leave cli_sessionloop: sent userauth methods„eq"))

202 
USERAUTH_FAIL_RCVD
:

203 
	`şi_auth_Œy
();

204 
şi_£s
.
¡©e
 = 
USERAUTH_REQ_SENT
;

205 
	`TRACE
(("leave cli_sessionloop: cli_auth_try"))

208 
USERAUTH_SUCCESS_RCVD
:

210 ià(
şi_İts
.
backgrounded
) {

211 
devnuÎ
;

214 
devnuÎ
 = 
	`İ’
(
_PATH_DEVNULL
, 
O_RDONLY
);

215 ià(
devnuÎ
 < 0) {

216 
	`drİb—r_ex™
("Opening /dev/null: %d %s",

217 
”ºo
, 
	`¡»¼Ü
(errno));

219 
	`dup2
(
devnuÎ
, 
STDIN_FILENO
);

220 ià(
	`d«mÚ
(0, 1) < 0) {

221 
	`drİb—r_ex™
("Backgrounding failed: %d %s",

222 
”ºo
, 
	`¡»¼Ü
(errno));

226 #ifdeà
ENABLE_CLI_LOCALTCPFWD


227 
	`£tup_loÿÉı
();

229 #ifdeà
ENABLE_CLI_REMOTETCPFWD


230 
	`£tup_»mÙ‘ı
();

233 #ifdeà
ENABLE_CLI_NETCAT


234 ià(
şi_İts
.
Ãtÿt_ho¡
) {

235 
	`şi_£nd_Ãtÿt_»que¡
();

238 ià(!
şi_İts
.
no_cmd
) {

239 
	`şi_£nd_chª£ss_»que¡
();

241 
	`TRACE
(("leave cli_sessionloop:„unning"))

242 
şi_£s
.
¡©e
 = 
SESSION_RUNNING
;

245 
SESSION_RUNNING
:

246 ià(
£s
.
chªcouÁ
 < 1 && !
şi_İts
.
no_cmd
) {

247 
	`şi_fšished
();

250 ià(
şi_£s
.
wšchªge
) {

251 
	`şi_chª£ss_wšchªge
();

262 
	`TRACE
(("leave cli_sessionloop: fell out"))

264 
	}
}

266 
	$şi_£ssiÚ_ş—nup
() {

268 ià(!
£ssš™dÚe
) {

274 
	`fú
(
şi_£s
.
¡dšcİy
, 
F_SETFL
, cli_£s.
¡dšæags
);

275 
	`fú
(
şi_£s
.
¡doutcİy
, 
F_SETFL
, cli_£s.
¡doutæags
);

276 
	`fú
(
şi_£s
.
¡d”rcİy
, 
F_SETFL
, cli_£s.
¡d”ræags
);

278 
	`şi_‰y_ş—nup
();

280 
	}
}

282 
	$şi_fšished
() {

284 
	`şi_£ssiÚ_ş—nup
();

285 
	`commÚ_£ssiÚ_ş—nup
();

286 
	`årštf
(
¡d”r
, "CÚÃùiÚØ%s@%s:% şo£d.\n", 
şi_İts
.
u£ºame
,

287 
şi_İts
.
»mÙeho¡
, cli_İts.
»mÙ•Üt
);

288 
	`ex™
(
şi_£s
.
»tv®
);

289 
	}
}

293 
	$şi_»mÙeşo£d
() {

297 
	`m_şo£
(
£s
.
sock_š
);

298 
	`m_şo£
(
£s
.
sock_out
);

299 
£s
.
sock_š
 = -1;

300 
£s
.
sock_out
 = -1;

301 
	`drİb—r_ex™
("Remote closedhe connection");

302 
	}
}

307 
	$ş—Áext
(* 
dœty‹xt
) {

309 
i
, 
j
;

310 
c
;

312 
j
 = 0;

313 
i
 = 0; 
dœty‹xt
[i] != '\0'; i++) {

315 
c
 = 
dœty‹xt
[
i
];

317 iàĞ(
c
 >= ' ' && c <= '~') || c == '\n' || c == '\t') {

318 
dœty‹xt
[
j
] = 
c
;

319 
j
++;

323 
dœty‹xt
[
j
] = '\0';

324 
	}
}

	@cli-tcpfwd.c

25 
	~"šşudes.h
"

26 
	~"İtiÚs.h
"

27 
	~"dbut.h
"

28 
	~"tıfwd.h
"

29 
	~"chªÃl.h
"

30 
	~"runİts.h
"

31 
	~"£ssiÚ.h
"

32 
	~"ssh.h
"

34 #ifdeà
ENABLE_CLI_REMOTETCPFWD


35 
ÃwtıfÜw¬ded
(
ChªÃl
 * 
chªÃl
);

37 cÚ¡ 
ChªTy³
 
	gşi_chª_tı»mÙe
 = {

40 
ÃwtıfÜw¬ded
,

41 
NULL
,

42 
NULL
,

43 
NULL


47 #ifdeà
ENABLE_CLI_LOCALTCPFWD


48 
şi_loÿÉı
(cÚ¡ * 
li¡’addr
,

49 
li¡’pÜt
,

50 cÚ¡ * 
»mÙ—ddr
,

51 
»mÙ•Üt
);

52 cÚ¡ 
ChªTy³
 
	gşi_chª_tıloÿl
 = {

55 
NULL
,

56 
NULL
,

57 
NULL
,

58 
NULL


62 #ifdeà
ENABLE_CLI_LOCALTCPFWD


63 
	$£tup_loÿÉı
() {

64 
m_li¡_–em
 *
™”
;

65 
»t
;

67 
	`TRACE
(("enter setup_localtcp"))

69 
™”
 = 
şi_İts
.
loÿlfwds
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
) {

70 
TCPFwdEÁry
 * 
fwd
 = (TCPFwdEÁry*)
™”
->
™em
;

71 
»t
 = 
	`şi_loÿÉı
(

72 
fwd
->
li¡’addr
,

73 
fwd
->
li¡’pÜt
,

74 
fwd
->
cÚÃùaddr
,

75 
fwd
->
cÚÃùpÜt
);

76 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

77 
	`drİb—r_log
(
LOG_WARNING
, "Failed†ocal…ort forward %s:%d:%s:%d",

78 
fwd
->
li¡’addr
,

79 
fwd
->
li¡’pÜt
,

80 
fwd
->
cÚÃùaddr
,

81 
fwd
->
cÚÃùpÜt
);

84 
	`TRACE
(("leave setup_localtcp"))

86 
	}
}

88 
	$şi_loÿÉı
(cÚ¡ * 
li¡’addr
,

89 
li¡’pÜt
,

90 cÚ¡ * 
»mÙ—ddr
,

91 
»mÙ•Üt
) {

93 
TCPLi¡’”
* 
tıšfo
 = 
NULL
;

94 
»t
;

96 
	`TRACE
(("’‹¸şi_loÿÉı: %d % %d", 
li¡’pÜt
, 
»mÙ—ddr
,

97 
»mÙ•Üt
));

99 
tıšfo
 = (
TCPLi¡’”
*)
	`m_m®loc
((TCPListener));

101 
tıšfo
->
£ndaddr
 = 
	`m_¡rdup
(
»mÙ—ddr
);

102 
tıšfo
->
£ndpÜt
 = 
»mÙ•Üt
;

104 ià(
li¡’addr
)

106 
tıšfo
->
li¡’addr
 = 
	`m_¡rdup
(listenaddr);

110 ià(
İts
.
li¡’_fwd_®l
) {

111 
tıšfo
->
li¡’addr
 = 
	`m_¡rdup
("");

113 
tıšfo
->
li¡’addr
 = 
	`m_¡rdup
("localhost");

116 
tıšfo
->
li¡’pÜt
 =†istenport;

118 
tıšfo
->
chªty³
 = &
şi_chª_tıloÿl
;

119 
tıšfo
->
tı_ty³
 = 
dœeù
;

121 
»t
 = 
	`li¡’_tıfwd
(
tıšfo
);

123 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

124 
	`m_ä“
(
tıšfo
);

126 
	`TRACE
(("Ëavşi_loÿÉı: %d", 
»t
))

127  
»t
;

128 
	}
}

131 #ifdeà 
ENABLE_CLI_REMOTETCPFWD


132 
	$£nd_msg_glob®_»que¡_»mÙ‘ı
(cÚ¡ *
addr
, 
pÜt
) {

134 
	`TRACE
(("enter send_msg_global_request_remotetcp"))

136 
	`CHECKCLEARTOWRITE
();

137 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_GLOBAL_REQUEST
);

138 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "tcpip-forward", 13);

139 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 1);

140 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
addr
, 
	`¡¾’
(addr));

141 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
pÜt
);

143 
	`’üy±_·ck‘
();

145 
	`TRACE
(("leave send_msg_global_request_remotetcp"))

146 
	}
}

152 
	$şi_»cv_msg_»que¡_sucûss
() {

155 
m_li¡_–em
 * 
™”
 = 
NULL
;

156 
™”
 = 
şi_İts
.
»mÙefwds
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
) {

157 
TCPFwdEÁry
 *
fwd
 = (TCPFwdEÁry*)
™”
->
™em
;

158 ià(!
fwd
->
have_»¶y
) {

159 
fwd
->
have_»¶y
 = 1;

163 
	}
}

165 
	$şi_»cv_msg_»que¡_çu»
() {

166 
m_li¡_–em
 *
™”
;

167 
™”
 = 
şi_İts
.
»mÙefwds
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
) {

168 
TCPFwdEÁry
 *
fwd
 = (TCPFwdEÁry*)
™”
->
™em
;

169 ià(!
fwd
->
have_»¶y
) {

170 
fwd
->
have_»¶y
 = 1;

171 
	`drİb—r_log
(
LOG_WARNING
, "RemÙTCP fÜw¬d„eque¡ faed (pÜˆ%d -> %s:%d)", 
fwd
->
li¡’pÜt
, fwd->
cÚÃùaddr
, fwd->
cÚÃùpÜt
);

175 
	}
}

177 
	$£tup_»mÙ‘ı
() {

178 
m_li¡_–em
 *
™”
;

179 
	`TRACE
(("enter setup_remotetcp"))

181 
™”
 = 
şi_İts
.
»mÙefwds
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
) {

182 
TCPFwdEÁry
 *
fwd
 = (TCPFwdEÁry*)
™”
->
™em
;

183 ià(!
fwd
->
li¡’addr
)

187 ià(
İts
.
li¡’_fwd_®l
) {

188 
fwd
->
li¡’addr
 = 
	`m_¡rdup
("");

190 
fwd
->
li¡’addr
 = 
	`m_¡rdup
("localhost");

193 
	`£nd_msg_glob®_»que¡_»mÙ‘ı
(
fwd
->
li¡’addr
, fwd->
li¡’pÜt
);

196 
	`TRACE
(("leave setup_remotetcp"))

197 
	}
}

199 
	$ÃwtıfÜw¬ded
(
ChªÃl
 * 
chªÃl
) {

201 *
Üigaddr
 = 
NULL
;

202 
ÜigpÜt
;

203 
m_li¡_–em
 * 
™”
 = 
NULL
;

204 
TCPFwdEÁry
 *
fwd
;

205 
pÜt¡ršg
[
NI_MAXSERV
];

206 
sock
;

207 
”r
 = 
SSH_OPEN_ADMINISTRATIVELY_PROHIBITED
;

209 
Üigaddr
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

210 
ÜigpÜt
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

213 
™”
 = 
şi_İts
.
»mÙefwds
->
fœ¡
; i‹r; i‹¸ğ™”->
Ãxt
) {

214 
fwd
 = (
TCPFwdEÁry
*)
™”
->
™em
;

215 ià(
ÜigpÜt
 =ğ
fwd
->
li¡’pÜt


216 && (
	`¡rcmp
(
Üigaddr
, 
fwd
->
li¡’addr
) == 0)) {

221 ià(
™”
 =ğ
NULL
) {

223 
	`ş—Áext
(
Üigaddr
);

224 
	`drİb—r_log
(
LOG_INFO
, "Server sent unrequested forward from \"%s:%d\"",

225 
Üigaddr
, 
ÜigpÜt
);

226 
out
;

229 
	`¢´štf
(
pÜt¡ršg
, ÕÜt¡ršg), "%d", 
fwd
->
cÚÃùpÜt
);

230 
sock
 = 
	`cÚÃù_»mÙe
(
fwd
->
cÚÃùaddr
, 
pÜt¡ršg
, 1, 
NULL
);

231 ià(
sock
 < 0) {

232 
	`TRACE
(("leave‚ewtcpdirect: sock failed"))

233 
”r
 = 
SSH_OPEN_CONNECT_FAILED
;

234 
out
;

237 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
sock
);

241 
chªÃl
->
wr™efd
 = 
sock
;

242 
chªÃl
->
š™cÚn
 = 1;

244 
”r
 = 
SSH_OPEN_IN_PROGRESS
;

246 
out
:

247 
	`m_ä“
(
Üigaddr
);

248 
	`TRACE
(("ËavÃwtıdœeù:ƒ¼ %d", 
”r
))

249  
”r
;

250 
	}
}

	@common-algo.c

26 
	~"®go.h
"

27 
	~"dbut.h
"

32 
	$void_ch”
(cÚ¡ * 
š
, * 
out
,

33 
Ën
, *
ch”_¡©e
) {

34 ià(
š
 !ğ
out
) {

35 
	`memmove
(
out
, 
š
, 
Ën
);

37  
CRYPT_OK
;

38 
	}
}

40 
	$void_¡¬t
(
ch”
, cÚ¡ *
IV
,

41 cÚ¡ *
key
,

42 
keyËn
, 
num_rounds
, *
ch”_¡©e
) {

43  
CRYPT_OK
;

44 
	}
}

51 #ifdeà
DROPBEAR_AES256


52 cÚ¡ 
drİb—r_ch”
 
	gdrİb—r_«s256
 =

53 {&
«s_desc
, 32, 16};

55 #ifdeà
DROPBEAR_AES128


56 cÚ¡ 
drİb—r_ch”
 
	gdrİb—r_«s128
 =

57 {&
«s_desc
, 16, 16};

59 #ifdeà
DROPBEAR_BLOWFISH


60 cÚ¡ 
drİb—r_ch”
 
	gdrİb—r_blowfish
 =

61 {&
blowfish_desc
, 16, 8};

63 #ifdeà
DROPBEAR_TWOFISH256


64 cÚ¡ 
drİb—r_ch”
 
	gdrİb—r_twofish256
 =

65 {&
twofish_desc
, 32, 16};

67 #ifdeà
DROPBEAR_TWOFISH128


68 cÚ¡ 
drİb—r_ch”
 
	gdrİb—r_twofish128
 =

69 {&
twofish_desc
, 16, 16};

71 #ifdeà
DROPBEAR_3DES


72 cÚ¡ 
drİb—r_ch”
 
	gdrİb—r_3des
 =

73 {&
des3_desc
, 24, 8};

77 cÚ¡ 
drİb—r_ch”
 
	gdrİb—r_noch”
 =

78 {
NULL
, 16, 8};

82 cÚ¡ 
drİb—r_ch”_mode
 
	gdrİb—r_mode_cbc
 =

83 {(*)
cbc_¡¬t
, (*)
cbc_’üy±
, (*)
cbc_deüy±
};

84 cÚ¡ 
drİb—r_ch”_mode
 
	gdrİb—r_mode_nÚe
 =

85 {
void_¡¬t
, 
void_ch”
, void_cipher};

86 #ifdeà
DROPBEAR_ENABLE_CTR_MODE


88 
	$drİb—r_big_’dŸn_ùr_¡¬t
(
ch”
,

89 cÚ¡ *
IV
,

90 cÚ¡ *
key
, 
keyËn
,

91 
num_rounds
, 
symm‘ric_CTR
 *
ùr
) {

92  
	`ùr_¡¬t
(
ch”
, 
IV
, 
key
, 
keyËn
, 
num_rounds
, 
CTR_COUNTER_BIG_ENDIAN
, 
ùr
);

93 
	}
}

94 cÚ¡ 
drİb—r_ch”_mode
 
	gdrİb—r_mode_ùr
 =

95 {(*)
drİb—r_big_’dŸn_ùr_¡¬t
, (*)
ùr_’üy±
, (*)
ùr_deüy±
};

101 #ifdeà
DROPBEAR_SHA1_HMAC


102 cÚ¡ 
drİb—r_hash
 
	gdrİb—r_sha1
 =

103 {&
sha1_desc
, 20, 20};

105 #ifdeà
DROPBEAR_SHA1_96_HMAC


106 cÚ¡ 
drİb—r_hash
 
	gdrİb—r_sha1_96
 =

107 {&
sha1_desc
, 20, 12};

109 #ifdeà
DROPBEAR_MD5_HMAC


110 cÚ¡ 
drİb—r_hash
 
	gdrİb—r_md5
 =

111 {&
md5_desc
, 16, 16};

114 cÚ¡ 
drİb—r_hash
 
	gdrİb—r_nohash
 =

115 {
NULL
, 16, 0};

122 
®go_ty³
 
	gsshch”s
[] = {

123 #ifdeà
DROPBEAR_ENABLE_CTR_MODE


124 #ifdeà
DROPBEAR_AES128


125 {"«s128-ùr", 0, &
drİb—r_«s128
, 1, &
drİb—r_mode_ùr
},

127 #ifdeà
DROPBEAR_3DES


128 {"3des-ùr", 0, &
drİb—r_3des
, 1, &
drİb—r_mode_ùr
},

130 #ifdeà
DROPBEAR_AES256


131 {"«s256-ùr", 0, &
drİb—r_«s256
, 1, &
drİb—r_mode_ùr
},

136 #ifdeà
DROPBEAR_AES128


137 {"«s128-cbc", 0, &
drİb—r_«s128
, 1, &
drİb—r_mode_cbc
},

139 #ifdeà
DROPBEAR_3DES


140 {"3des-cbc", 0, &
drİb—r_3des
, 1, &
drİb—r_mode_cbc
},

142 #ifdeà
DROPBEAR_AES256


143 {"«s256-cbc", 0, &
drİb—r_«s256
, 1, &
drİb—r_mode_cbc
},

145 #ifdeà
DROPBEAR_TWOFISH256


146 {"twofish256-cbc", 0, &
drİb—r_twofish256
, 1, &
drİb—r_mode_cbc
},

147 {"twofish-cbc", 0, &
drİb—r_twofish256
, 1, &
drİb—r_mode_cbc
},

149 #ifdeà
DROPBEAR_TWOFISH128


150 {"twofish128-cbc", 0, &
drİb—r_twofish128
, 1, &
drİb—r_mode_cbc
},

152 #ifdeà
DROPBEAR_BLOWFISH


153 {"blowfish-cbc", 0, &
drİb—r_blowfish
, 1, &
drİb—r_mode_cbc
},

155 {
NULL
, 0, NULL, 0, NULL}

158 
®go_ty³
 
	gsshhashes
[] = {

159 #ifdeà
DROPBEAR_SHA1_96_HMAC


160 {"hmac-sha1-96", 0, &
drİb—r_sha1_96
, 1, 
NULL
},

162 #ifdeà
DROPBEAR_SHA1_HMAC


163 {"hmac-sha1", 0, &
drİb—r_sha1
, 1, 
NULL
},

165 #ifdeà
DROPBEAR_MD5_HMAC


166 {"hmac-md5", 0, &
drİb—r_md5
, 1, 
NULL
},

168 {
NULL
, 0, NULL, 0, NULL}

171 #iâdeà
DISABLE_ZLIB


172 
®go_ty³
 
	gssh_com´ess
[] = {

173 {"zlib", 
DROPBEAR_COMP_ZLIB
, 
NULL
, 1, NULL},

174 {"zlib@İ’ssh.com", 
DROPBEAR_COMP_ZLIB_DELAY
, 
NULL
, 1, NULL},

175 {"nÚe", 
DROPBEAR_COMP_NONE
, 
NULL
, 1, NULL},

176 {
NULL
, 0, NULL, 0, NULL}

180 
®go_ty³
 
	gssh_nocom´ess
[] = {

181 {"nÚe", 
DROPBEAR_COMP_NONE
, 
NULL
, 1, NULL},

182 {
NULL
, 0, NULL, 0, NULL}

185 
®go_ty³
 
	gsshho¡key
[] = {

186 #ifdeà
DROPBEAR_RSA


187 {"ssh-r§", 
DROPBEAR_SIGNKEY_RSA
, 
NULL
, 1, NULL},

189 #ifdeà
DROPBEAR_DSS


190 {"ssh-dss", 
DROPBEAR_SIGNKEY_DSS
, 
NULL
, 1, NULL},

192 {
NULL
, 0, NULL, 0, NULL}

195 
®go_ty³
 
	gsshkex
[] = {

196 {"diff›-h–lmª-group1-sha1", 
DROPBEAR_KEX_DH_GROUP1
, 
NULL
, 1, NULL},

197 {"diff›-h–lmª-group14-sha1", 
DROPBEAR_KEX_DH_GROUP14
, 
NULL
, 1, NULL},

198 {
NULL
, 0, NULL, 0, NULL}

204 
	$üy±o_š™
() {

206 cÚ¡ 
Éc_ch”_desütÜ
 *
»gch”s
[] = {

207 #ifdeà
DROPBEAR_AES


208 &
«s_desc
,

210 #ifdeà
DROPBEAR_BLOWFISH


211 &
blowfish_desc
,

213 #ifdeà
DROPBEAR_TWOFISH


214 &
twofish_desc
,

216 #ifdeà
DROPBEAR_3DES


217 &
des3_desc
,

219 
NULL


222 cÚ¡ 
Éc_hash_desütÜ
 *
»ghashes
[] = {

224 &
sha1_desc
,

225 #ifdeà
DROPBEAR_MD5_HMAC


226 &
md5_desc
,

228 
NULL


230 
i
;

232 
i
 = 0; 
»gch”s
[i] !ğ
NULL
; i++) {

233 ià(
	`»gi¡”_ch”
(
»gch”s
[
i
]) == -1) {

234 
	`drİb—r_ex™
("Error„egistering crypto");

238 
i
 = 0; 
»ghashes
[i] !ğ
NULL
; i++) {

239 ià(
	`»gi¡”_hash
(
»ghashes
[
i
]) == -1) {

240 
	`drİb—r_ex™
("Error„egistering crypto");

243 
	}
}

249 
	$have_®go
(* 
®go
, 
size_t
 
®gŞ’
, 
®go_ty³
 
®gos
[]) {

251 
i
;

253 
i
 = 0; 
®gos
[i].
Çme
 !ğ
NULL
; i++) {

254 ià(
	`¡¾’
(
®gos
[
i
].
Çme
è=ğ
®gŞ’


255 && (
	`¡ºcmp
(
®gos
[
i
].
Çme
, 
®go
, 
®gŞ’
) == 0)) {

256  
DROPBEAR_SUCCESS
;

260  
DROPBEAR_FAILURE
;

261 
	}
}

266 
	$buf_put_®gŞi¡
(
bufãr
 * 
buf
, 
®go_ty³
 
loÿÏlgos
[]) {

268 
i
, 
Ën
;

269 
dÚefœ¡
 = 0;

270 
bufãr
 *
®gŞi¡
 = 
NULL
;

272 
®gŞi¡
 = 
	`buf_Ãw
(160);

273 
i
 = 0; 
loÿÏlgos
[i].
Çme
 !ğ
NULL
; i++) {

274 ià(
loÿÏlgos
[
i
].
u§bË
) {

275 ià(
dÚefœ¡
)

276 
	`buf_putby‹
(
®gŞi¡
, ',');

277 
dÚefœ¡
 = 1;

278 
Ën
 = 
	`¡¾’
(
loÿÏlgos
[
i
].
Çme
);

279 
	`buf_putby‹s
(
®gŞi¡
, 
loÿÏlgos
[
i
].
Çme
, 
Ën
);

282 
	`buf_put¡ršg
(
buf
, 
®gŞi¡
->
d©a
,‡lgŞi¡->
Ën
);

283 
	`buf_ä“
(
®gŞi¡
);

284 
	}
}

	@common-channel.c

27 
	~"šşudes.h
"

28 
	~"£ssiÚ.h
"

29 
	~"·ck‘.h
"

30 
	~"ssh.h
"

31 
	~"bufãr.h
"

32 
	~"cœcbufãr.h
"

33 
	~"dbut.h
"

34 
	~"chªÃl.h
"

35 
	~"ssh.h
"

36 
	~"li¡’”.h
"

37 
	~"runİts.h
"

39 
£nd_msg_chªÃl_İ’_çu»
(
»mÙechª
, 
»asÚ
,

40 cÚ¡ *
‹xt
, cÚ¡ *
Ïng
);

41 
£nd_msg_chªÃl_İ’_cÚfœm©iÚ
(
ChªÃl
* 
chªÃl
,

42 
»cvwšdow
,

43 
»cvmax·ck‘
);

44 
wr™echªÃl
(
ChªÃl
* 
chªÃl
, 
fd
, 
cœcbufãr
 *
cbuf
);

45 
£nd_msg_chªÃl_wšdow_adju¡
(
ChªÃl
 *
chªÃl
,

46 
šü
);

47 
£nd_msg_chªÃl_d©a
(
ChªÃl
 *
chªÃl
, 
i£x‹nded
);

48 
£nd_msg_chªÃl_eof
(
ChªÃl
 *
chªÃl
);

49 
£nd_msg_chªÃl_şo£
(
ChªÃl
 *
chªÃl
);

50 
»move_chªÃl
(
ChªÃl
 *
chªÃl
);

51 
d–‘e_chªÃl
(
ChªÃl
 *
chªÃl
);

52 
check_š_´og»ss
(
ChªÃl
 *
chªÃl
);

53 
wr™e_³ndšg
(
ChªÃl
 * 
chªÃl
);

54 
check_şo£
(
ChªÃl
 *
chªÃl
);

55 
şo£_chª_fd
(
ChªÃl
 *
chªÃl
, 
fd
, 
how
);

57 
	#FD_UNINIT
 (-2)

	)

58 
	#FD_CLOSED
 (-1)

	)

60 
	#ERRFD_IS_READ
(
chªÃl
è((chªÃl)->
exŒabuf
 =ğ
NULL
)

	)

61 
	#ERRFD_IS_WRITE
(
chªÃl
è(!
	`ERRFD_IS_READ
(chªÃl))

	)

64 
	$chªš™Ÿli£
(cÚ¡ 
ChªTy³
 *
chªty³s
[]) {

67 
£s
.
chªÃls
 = (
ChªÃl
**)
	`m_m®loc
((Channel*));

68 
£s
.
chªsize
 = 1;

69 
£s
.
chªÃls
[0] = 
NULL
;

70 
£s
.
chªcouÁ
 = 0;

72 
£s
.
chªty³s
 = chantypes;

74 #ifdeà
USING_LISTENERS


75 
	`li¡’”s_š™Ÿli£
();

78 
	}
}

81 
	$chªş—nup
() {

83 
i
;

85 
	`TRACE
(("enter chancleanup"))

86 
i
 = 0; i < 
£s
.
chªsize
; i++) {

87 ià(
£s
.
chªÃls
[
i
] !ğ
NULL
) {

88 
	`TRACE
(("chªÃÈ%d closšg", 
i
))

89 
	`»move_chªÃl
(
£s
.
chªÃls
[
i
]);

92 
	`m_ä“
(
£s
.
chªÃls
);

93 
	`TRACE
(("leave chancleanup"))

94 
	}
}

100 
ChªÃl
* 
	$ÃwchªÃl
(
»mÙechª
,

101 cÚ¡ 
ChªTy³
 *
ty³
,

102 
Œªswšdow
, 
Œªsmax·ck‘
) {

104 
ChªÃl
 * 
Ãwchª
;

105 
i
, 
j
;

107 
	`TRACE
(("enter‚ewchannel"))

110 
i
 = 0; i < 
£s
.
chªsize
; i++) {

111 ià(
£s
.
chªÃls
[
i
] =ğ
NULL
) {

117 ià(
i
 =ğ
£s
.
chªsize
) {

118 ià(
£s
.
chªsize
 >ğ
MAX_CHANNELS
) {

119 
	`TRACE
(("leave‚ewchannel: max chans„eached"))

120  
NULL
;

124 
£s
.
chªÃls
 = (
ChªÃl
**)
	`m_»®loc
(ses.channels,

125 (
£s
.
chªsize
+
CHAN_EXTEND_SIZE
)*(
ChªÃl
*));

127 
£s
.
chªsize
 +ğ
CHAN_EXTEND_SIZE
;

130 
j
 = 
i
; j < 
£s
.
chªsize
; j++) {

131 
£s
.
chªÃls
[
j
] = 
NULL
;

136 
Ãwchª
 = (
ChªÃl
*)
	`m_m®loc
((Channel));

137 
Ãwchª
->
ty³
 =ype;

138 
Ãwchª
->
šdex
 = 
i
;

139 
Ãwchª
->
£Á_şo£
 =‚ewchª->
»cv_şo£
 = 0;

140 
Ãwchª
->
£Á_eof
 =‚ewchª->
»cv_eof
 = 0;

142 
Ãwchª
->
»mÙechª
 =„emotechan;

143 
Ãwchª
->
Œªswšdow
 =ranswindow;

144 
Ãwchª
->
Œªsmax·ck‘
 =ransmaxpacket;

146 
Ãwchª
->
ty³d©a
 = 
NULL
;

147 
Ãwchª
->
wr™efd
 = 
FD_UNINIT
;

148 
Ãwchª
->
»adfd
 = 
FD_UNINIT
;

149 
Ãwchª
->
”rfd
 = 
FD_CLOSED
;

150 
Ãwchª
->
š™cÚn
 = 0;

151 
Ãwchª
->
awa™_İ’
 = 0;

152 
Ãwchª
->
æushšg
 = 0;

154 
Ãwchª
->
wr™ebuf
 = 
	`cbuf_Ãw
(
İts
.
»cv_wšdow
);

155 
Ãwchª
->
exŒabuf
 = 
NULL
;

156 
Ãwchª
->
»cvwšdow
 = 
İts
.
»cv_wšdow
;

157 
Ãwchª
->
»cvdÚ–’
 = 0;

158 
Ãwchª
->
»cvmax·ck‘
 = 
RECV_MAX_PAYLOAD_LEN
;

160 
£s
.
chªÃls
[
i
] = 
Ãwchª
;

161 
£s
.
chªcouÁ
++;

163 
	`TRACE
(("leave‚ewchannel"))

165  
Ãwchª
;

166 
	}
}

172 
ChªÃl
* 
	$g‘chªÃl_msg
(cÚ¡ * 
kšd
) {

174 
chª
;

176 
chª
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

177 ià(
chª
 >ğ
£s
.
chªsize
 || ses.
chªÃls
[chª] =ğ
NULL
) {

178 ià(
kšd
) {

179 
	`drİb—r_ex™
("% fÜ unknowÀchªÃÈ%d", 
kšd
, 
chª
);

181 
	`drİb—r_ex™
("UnknowÀchªÃÈ%d", 
chª
);

184  
£s
.
chªÃls
[
chª
];

185 
	}
}

187 
ChªÃl
* 
	$g‘chªÃl
() {

188  
	`g‘chªÃl_msg
(
NULL
);

189 
	}
}

192 
	$chªÃlio
(
fd_£t
 *
»adfds
, fd_£ˆ*
wr™efds
) {

194 
ChªÃl
 *
chªÃl
;

195 
i
;

198 
i
 = 0; i < 
£s
.
chªsize
; i++) {

200 
chªÃl
 = 
£s
.
chªÃls
[
i
];

201 ià(
chªÃl
 =ğ
NULL
) {

207 ià(
chªÃl
->
»adfd
 >ğ0 && 
	`FD_ISSET
(chªÃl->»adfd, 
»adfds
)) {

208 
	`TRACE
(("send‚ormal„eadfd"))

209 
	`£nd_msg_chªÃl_d©a
(
chªÃl
, 0);

213 ià(
	`ERRFD_IS_READ
(
chªÃl
è&& chªÃl->
”rfd
 >= 0

214 && 
	`FD_ISSET
(
chªÃl
->
”rfd
, 
»adfds
)) {

215 
	`TRACE
(("send‚ormalƒrrfd"))

216 
	`£nd_msg_chªÃl_d©a
(
chªÃl
, 1);

220 ià(
chªÃl
->
wr™efd
 >ğ0 && 
	`FD_ISSET
(chªÃl->wr™efd, 
wr™efds
)) {

221 ià(
chªÃl
->
š™cÚn
) {

223 
	`check_š_´og»ss
(
chªÃl
);

227 
	`wr™echªÃl
(
chªÃl
, chªÃl->
wr™efd
, chªÃl->
wr™ebuf
);

231 ià(
	`ERRFD_IS_WRITE
(
chªÃl
)

232 && 
chªÃl
->
”rfd
 >ğ0 && 
	`FD_ISSET
(chªÃl->”rfd, 
wr™efds
)) {

233 
	`wr™echªÃl
(
chªÃl
, chªÃl->
”rfd
, chªÃl->
exŒabuf
);

237 
	`check_şo£
(
chªÃl
);

242 #ifdeà
USING_LISTENERS


243 
	`hªdË_li¡’”s
(
»adfds
);

245 
	}
}

250 
	$wr™e_³ndšg
(
ChªÃl
 * 
chªÃl
) {

252 ià(
chªÃl
->
wr™efd
 >ğ0 && 
	`cbuf_g‘u£d
(chªÃl->
wr™ebuf
) > 0) {

254 } ià(
chªÃl
->
”rfd
 >ğ0 && chªÃl->
exŒabuf
 &&

255 
	`cbuf_g‘u£d
(
chªÃl
->
exŒabuf
) > 0) {

259 
	}
}

263 
	$check_şo£
(
ChªÃl
 *
chªÃl
) {

264 
şo£_®lowed
 = 0;

266 
	`TRACE
(("check_close: writefd %d,„eadfd %d,ƒrrfd %d, sent_close %d,„ecv_close %d",

267 
chªÃl
->
wr™efd
, chªÃl->
»adfd
,

268 
chªÃl
->
”rfd
, chªÃl->
£Á_şo£
, chªÃl->
»cv_şo£
))

269 
	`TRACE
(("writebuf size %dƒxtrabuf size %d",

270 
	`cbuf_g‘u£d
(
chªÃl
->
wr™ebuf
),

271 
chªÃl
->
exŒabuf
 ? 
	`cbuf_g‘u£d
(channel->extrabuf) : 0))

273 ià(!
chªÃl
->
æushšg
 && chªÃl->
ty³
->
check_şo£


274 && 
chªÃl
->
ty³
->
	`check_şo£
(channel))

276 
chªÃl
->
æushšg
 = 1;

283 ià(!
chªÃl
->
ty³
->
check_şo£


284 || 
chªÃl
->
ty³
->
	`check_şo£
(channel)) {

285 
şo£_®lowed
 = 1;

288 ià(
chªÃl
->
»cv_şo£
 && !
	`wr™e_³ndšg
(chªÃlè&& 
şo£_®lowed
) {

289 ià(!
chªÃl
->
£Á_şo£
) {

290 
	`TRACE
(("Sending MSG_CHANNEL_CLOSE in„esponseo same."))

291 
	`£nd_msg_chªÃl_şo£
(
chªÃl
);

293 
	`»move_chªÃl
(
chªÃl
);

297 ià(
chªÃl
->
»cv_eof
 && !
	`wr™e_³ndšg
(channel)) {

298 
	`şo£_chª_fd
(
chªÃl
, chªÃl->
wr™efd
, 
SHUT_WR
);

304 ià(
chªÃl
->
æushšg
) {

305 
	`TRACE
(("might send data, flushing"))

306 ià(
chªÃl
->
»adfd
 >ğ0 && chªÃl->
Œªswšdow
 > 0) {

307 
	`TRACE
(("send data„eadfd"))

308 
	`£nd_msg_chªÃl_d©a
(
chªÃl
, 0);

310 ià(
	`ERRFD_IS_READ
(
chªÃl
è&& chªÃl->
”rfd
 >= 0

311 && 
chªÃl
->
Œªswšdow
 > 0) {

312 
	`TRACE
(("send dataƒrrfd"))

313 
	`£nd_msg_chªÃl_d©a
(
chªÃl
, 1);

318 ià(!
chªÃl
->
£Á_eof


319 && 
chªÃl
->
»adfd
 =ğ
FD_CLOSED


320 && (
	`ERRFD_IS_WRITE
(
chªÃl
è|| chªÃl->
”rfd
 =ğ
FD_CLOSED
)) {

321 
	`£nd_msg_chªÃl_eof
(
chªÃl
);

325 ià(
chªÃl
->
»adfd
 =ğ
FD_CLOSED


326 && (
	`ERRFD_IS_WRITE
(
chªÃl
è|| chªÃl->
”rfd
 =ğ
FD_CLOSED
)

327 && !
chªÃl
->
£Á_şo£


328 && 
şo£_®lowed


329 && !
	`wr™e_³ndšg
(
chªÃl
)) {

330 
	`TRACE
(("sending close,„eadfd is closed"))

331 
	`£nd_msg_chªÃl_şo£
(
chªÃl
);

333 
	}
}

339 
	$check_š_´og»ss
(
ChªÃl
 *
chªÃl
) {

341 
v®
;

342 
sockËn_t
 
v®Ën
 = (
v®
);

344 
	`TRACE
(("enter check_in_progress"))

346 ià(
	`g‘sockİt
(
chªÃl
->
wr™efd
, 
SOL_SOCKET
, 
SO_ERROR
, &
v®
, &
v®Ën
)

347 || 
v®
 != 0) {

348 
	`£nd_msg_chªÃl_İ’_çu»
(
chªÃl
->
»mÙechª
,

349 
SSH_OPEN_CONNECT_FAILED
, "", "");

350 
	`şo£
(
chªÃl
->
wr™efd
);

351 
	`d–‘e_chªÃl
(
chªÃl
);

352 
	`TRACE
(("leave check_in_progress: fail"))

354 
	`£nd_msg_chªÃl_İ’_cÚfœm©iÚ
(
chªÃl
, chªÃl->
»cvwšdow
,

355 
chªÃl
->
»cvmax·ck‘
);

356 
chªÃl
->
»adfd
 = chªÃl->
wr™efd
;

357 
chªÃl
->
š™cÚn
 = 0;

358 
	`TRACE
(("leave check_in_progress: success"))

360 
	}
}

364 
	$£nd_msg_chªÃl_şo£
(
ChªÃl
 *
chªÃl
) {

366 
	`TRACE
(("enter send_msg_channel_close"))

367 ià(
chªÃl
->
ty³
->
şo£hªdËr
) {

368 
chªÃl
->
ty³
->
	`şo£hªdËr
(channel);

371 
	`CHECKCLEARTOWRITE
();

373 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_CLOSE
);

374 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

376 
	`’üy±_·ck‘
();

378 
chªÃl
->
£Á_eof
 = 1;

379 
chªÃl
->
£Á_şo£
 = 1;

380 
	`şo£_chª_fd
(
chªÃl
, chªÃl->
»adfd
, 
SHUT_RD
);

381 
	`şo£_chª_fd
(
chªÃl
, chªÃl->
”rfd
, 
SHUT_RDWR
);

382 
	`şo£_chª_fd
(
chªÃl
, chªÃl->
wr™efd
, 
SHUT_WR
);

383 
	`TRACE
(("leave send_msg_channel_close"))

384 
	}
}

387 
	$£nd_msg_chªÃl_eof
(
ChªÃl
 *
chªÃl
) {

389 
	`TRACE
(("enter send_msg_channel_eof"))

390 
	`CHECKCLEARTOWRITE
();

392 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_EOF
);

393 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

395 
	`’üy±_·ck‘
();

397 
chªÃl
->
£Á_eof
 = 1;

399 
	`TRACE
(("leave send_msg_channel_eof"))

400 
	}
}

405 
	$wr™echªÃl
(
ChªÃl
* 
chªÃl
, 
fd
, 
cœcbufãr
 *
cbuf
) {

407 
Ën
, 
maxËn
;

409 
	`TRACE
(("’‹¸wr™echªÃÈfd %d", 
fd
))

411 
maxËn
 = 
	`cbuf_»adËn
(
cbuf
);

414 
Ën
 = 
	`wr™e
(
fd
, 
	`cbuf_»ad±r
(
cbuf
, 
maxËn
), maxlen);

415 ià(
Ën
 <= 0) {

416 
	`TRACE
(("”ºØ%d†’ %d", 
”ºo
, 
Ën
))

417 ià(
Ën
 < 0 && 
”ºo
 !ğ
EINTR
) {

418 
	`şo£_chª_fd
(
chªÃl
, 
fd
, 
SHUT_WR
);

420 
	`TRACE
(("leave writechannel:†en <= 0"))

423 
	`TRACE
(("wr™echªÃÈwrÙ%d", 
Ën
))

425 
	`cbuf_šü»ad
(
cbuf
, 
Ën
);

426 
chªÃl
->
»cvdÚ–’
 +ğ
Ën
;

429 ià(
chªÃl
->
»cvdÚ–’
 >ğ
RECV_WINDOWEXTEND
) {

431 
	`£nd_msg_chªÃl_wšdow_adju¡
(
chªÃl
, chªÃl->
»cvdÚ–’
);

432 
chªÃl
->
»cvwšdow
 +ğchªÃl->
»cvdÚ–’
;

433 
chªÃl
->
»cvdÚ–’
 = 0;

436 
	`drİb—r_as£¹
(
chªÃl
->
»cvwšdow
 <ğ
İts
.
»cv_wšdow
);

437 
	`drİb—r_as£¹
(
chªÃl
->
»cvwšdow
 <ğ
	`cbuf_g‘ava
(chªÃl->
wr™ebuf
));

438 
	`drİb—r_as£¹
(
chªÃl
->
exŒabuf
 =ğ
NULL
 ||

439 
chªÃl
->
»cvwšdow
 <ğ
	`cbuf_g‘ava
(chªÃl->
exŒabuf
));

441 
	`TRACE
(("leave writechannel"))

442 
	}
}

446 
	$£tchªÃlfds
(
fd_£t
 *
»adfds
, fd_£ˆ*
wr™efds
) {

448 
i
;

449 
ChªÃl
 * 
chªÃl
;

451 
i
 = 0; i < 
£s
.
chªsize
; i++) {

453 
chªÃl
 = 
£s
.
chªÃls
[
i
];

454 ià(
chªÃl
 =ğ
NULL
) {

459 ià(
chªÃl
->
Œªswšdow
 > 0) {

461 ià(
chªÃl
->
»adfd
 >= 0) {

462 
	`FD_SET
(
chªÃl
->
»adfd
, 
»adfds
);

465 ià(
	`ERRFD_IS_READ
(
chªÃl
è&& chªÃl->
”rfd
 >= 0) {

466 
	`FD_SET
(
chªÃl
->
”rfd
, 
»adfds
);

471 ià((
chªÃl
->
wr™efd
 >ğ0 && 
	`cbuf_g‘u£d
(chªÃl->
wr™ebuf
) > 0 )

472 || 
chªÃl
->
š™cÚn
) {

473 
	`FD_SET
(
chªÃl
->
wr™efd
, 
wr™efds
);

476 ià(
	`ERRFD_IS_WRITE
(
chªÃl
è&& chªÃl->
”rfd
 >= 0

477 && 
	`cbuf_g‘u£d
(
chªÃl
->
exŒabuf
) > 0 ) {

478 
	`FD_SET
(
chªÃl
->
”rfd
, 
wr™efds
);

483 #ifdeà
USING_LISTENERS


484 
	`£t_li¡’”_fds
(
»adfds
);

487 
	}
}

492 
	$»cv_msg_chªÃl_eof
() {

494 
ChªÃl
 * 
chªÃl
;

496 
	`TRACE
(("enter„ecv_msg_channel_eof"))

498 
chªÃl
 = 
	`g‘chªÃl_msg
("EOF");

500 
chªÃl
->
»cv_eof
 = 1;

502 
	`check_şo£
(
chªÃl
);

503 
	`TRACE
(("leave„ecv_msg_channel_eof"))

504 
	}
}

508 
	$»cv_msg_chªÃl_şo£
() {

510 
ChªÃl
 * 
chªÃl
;

512 
	`TRACE
(("enter„ecv_msg_channel_close"))

514 
chªÃl
 = 
	`g‘chªÃl_msg
("Close");

516 
chªÃl
->
»cv_eof
 = 1;

517 
chªÃl
->
»cv_şo£
 = 1;

519 
	`check_şo£
(
chªÃl
);

520 
	`TRACE
(("leave„ecv_msg_channel_close"))

521 
	}
}

525 
	$»move_chªÃl
(
ChªÃl
 * 
chªÃl
) {

527 
	`TRACE
(("enter„emove_channel"))

528 
	`TRACE
(("chªÃÈšdex i %d", 
chªÃl
->
šdex
))

530 
	`cbuf_ä“
(
chªÃl
->
wr™ebuf
);

531 
chªÃl
->
wr™ebuf
 = 
NULL
;

533 ià(
chªÃl
->
exŒabuf
) {

534 
	`cbuf_ä“
(
chªÃl
->
exŒabuf
);

535 
chªÃl
->
exŒabuf
 = 
NULL
;

541 
	`TRACE
(("CLOSE wr™efd %d", 
chªÃl
->
wr™efd
))

542 
	`şo£
(
chªÃl
->
wr™efd
);

543 
	`TRACE
(("CLOSE„—dfd %d", 
chªÃl
->
»adfd
))

544 
	`şo£
(
chªÃl
->
»adfd
);

545 
	`TRACE
(("CLOSEƒ¼fd %d", 
chªÃl
->
”rfd
))

546 
	`şo£
(
chªÃl
->
”rfd
);

548 
chªÃl
->
ty³d©a
 = 
NULL
;

550 
	`d–‘e_chªÃl
(
chªÃl
);

552 
	`TRACE
(("leave„emove_channel"))

553 
	}
}

556 
	$d–‘e_chªÃl
(
ChªÃl
 *
chªÃl
) {

558 
£s
.
chªÃls
[
chªÃl
->
šdex
] = 
NULL
;

559 
	`m_ä“
(
chªÃl
);

560 
£s
.
chªcouÁ
--;

562 
	}
}

567 
	$»cv_msg_chªÃl_»que¡
() {

569 
ChªÃl
 *
chªÃl
;

571 
	`TRACE
(("enter„ecv_msg_channel_request"))

573 
chªÃl
 = 
	`g‘chªÃl
();

575 ià(
chªÃl
->
£Á_şo£
) {

576 
	`TRACE
(("leave„ecv_msg_channel_request:‡lready closed channel"))

580 ià(
chªÃl
->
ty³
->
»qhªdËr
) {

581 
chªÃl
->
ty³
->
	`»qhªdËr
(channel);

583 
	`£nd_msg_chªÃl_çu»
(
chªÃl
);

586 
	`TRACE
(("leave„ecv_msg_channel_request"))

588 
	}
}

595 
	$£nd_msg_chªÃl_d©a
(
ChªÃl
 *
chªÃl
, 
i£x‹nded
) {

597 
Ën
;

598 
size_t
 
maxËn
, 
size_pos
;

599 
fd
;

601 
	`CHECKCLEARTOWRITE
();

603 
	`TRACE
(("enter send_msg_channel_data"))

604 
	`drİb—r_as£¹
(!
chªÃl
->
£Á_şo£
);

606 ià(
i£x‹nded
) {

607 
fd
 = 
chªÃl
->
”rfd
;

609 
fd
 = 
chªÃl
->
»adfd
;

611 
	`TRACE
(("’‹¸£nd_msg_chªÃl_d©¨i£x‹nded %d fd %d", 
i£x‹nded
, 
fd
))

612 
	`drİb—r_as£¹
(
fd
 >= 0);

614 
maxËn
 = 
	`MIN
(
chªÃl
->
Œªswšdow
, chªÃl->
Œªsmax·ck‘
);

617 
maxËn
 = 
	`MIN
(maxlen,

618 
£s
.
wr™•aylßd
->
size
 - 1 - 4 - 4 - (
i£x‹nded
 ? 4 : 0));

619 
	`TRACE
(("maxËÀ%d", 
maxËn
))

620 ià(
maxËn
 == 0) {

621 
	`TRACE
(("leave send_msg_channel_data:‚o window"))

625 
	`buf_putby‹
(
£s
.
wr™•aylßd
,

626 
i£x‹nded
 ? 
SSH_MSG_CHANNEL_EXTENDED_DATA
 : 
SSH_MSG_CHANNEL_DATA
);

627 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

628 ià(
i£x‹nded
) {

629 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
SSH_EXTENDED_DATA_STDERR
);

632 
size_pos
 = 
£s
.
wr™•aylßd
->
pos
;

633 
	`buf_putšt
(
£s
.
wr™•aylßd
, 0);

636 
Ën
 = 
	`»ad
(
fd
, 
	`buf_g‘wr™•Œ
(
£s
.
wr™•aylßd
, 
maxËn
), maxlen);

637 ià(
Ën
 <= 0) {

638 ià(
Ën
 =ğ0 || 
”ºo
 !ğ
EINTR
) {

642 
	`şo£_chª_fd
(
chªÃl
, 
fd
, 
SHUT_RD
);

644 
£s
.
wr™•aylßd
->
Ën
 = ses.wr™•aylßd->
pos
 = 0;

645 
	`TRACE
(("leave send_msg_channel_data:†en %d„eadƒrr %d or EOF for fd %d",

646 
Ën
, 
”ºo
, 
fd
))

649 
	`buf_šüwr™•os
(
£s
.
wr™•aylßd
, 
Ën
);

651 
	`buf_£os
(
£s
.
wr™•aylßd
, 
size_pos
);

652 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
Ën
);

654 
chªÃl
->
Œªswšdow
 -ğ
Ën
;

656 
	`’üy±_·ck‘
();

660 ià(
chªÃl
->
æushšg
 && 
Ën
 < (
ssize_t
)
maxËn
)

662 
	`TRACE
(("closing from channel, flushing out."))

663 
	`şo£_chª_fd
(
chªÃl
, 
fd
, 
SHUT_RD
);

665 
	`TRACE
(("leave send_msg_channel_data"))

666 
	}
}

669 
	$»cv_msg_chªÃl_d©a
() {

671 
ChªÃl
 *
chªÃl
;

673 
chªÃl
 = 
	`g‘chªÃl
();

675 
	`commÚ_»cv_msg_chªÃl_d©a
(
chªÃl
, chªÃl->
wr™efd
, chªÃl->
wr™ebuf
);

676 
	}
}

680 
	$commÚ_»cv_msg_chªÃl_d©a
(
ChªÃl
 *
chªÃl
, 
fd
,

681 
cœcbufãr
 * 
cbuf
) {

683 
d©®’
;

684 
maxd©a
;

685 
buæ’
;

686 
Ën
;

688 
	`TRACE
(("enter„ecv_msg_channel_data"))

690 ià(
chªÃl
->
»cv_eof
) {

691 
	`drİb—r_ex™
("Received data‡fterƒof");

694 ià(
fd
 < 0) {

701 
d©®’
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

702 
	`TRACE
(("Ëngth %d", 
d©®’
))

704 
maxd©a
 = 
	`cbuf_g‘ava
(
cbuf
);

709 ià(
d©®’
 > 
maxd©a
) {

710 
	`drİb—r_ex™
("Oversized…acket");

716 
Ën
 = 
d©®’
;

717 
Ën
 > 0) {

718 
buæ’
 = 
	`cbuf_wr™–’
(
cbuf
);

719 
buæ’
 = 
	`MIN
(buæ’, 
Ën
);

721 
	`memıy
(
	`cbuf_wr™•Œ
(
cbuf
, 
buæ’
),

722 
	`buf_g‘±r
(
£s
.
·ylßd
, 
buæ’
), buflen);

723 
	`cbuf_šüwr™e
(
cbuf
, 
buæ’
);

724 
	`buf_šüpos
(
£s
.
·ylßd
, 
buæ’
);

725 
Ën
 -ğ
buæ’
;

728 
	`drİb—r_as£¹
(
chªÃl
->
»cvwšdow
 >ğ
d©®’
);

729 
chªÃl
->
»cvwšdow
 -ğ
d©®’
;

730 
	`drİb—r_as£¹
(
chªÃl
->
»cvwšdow
 <ğ
İts
.
»cv_wšdow
);

732 
	`TRACE
(("leave„ecv_msg_channel_data"))

733 
	}
}

738 
	$»cv_msg_chªÃl_wšdow_adju¡
() {

740 
ChªÃl
 * 
chªÃl
;

741 
šü
;

743 
chªÃl
 = 
	`g‘chªÃl
();

745 
šü
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

746 
	`TRACE
(("»ûived wšdow inüem’ˆ%d", 
šü
))

747 
šü
 = 
	`MIN
(šü, 
TRANS_MAX_WIN_INCR
);

749 
chªÃl
->
Œªswšdow
 +ğ
šü
;

750 
chªÃl
->
Œªswšdow
 = 
	`MIN
(chªÃl->Œªswšdow, 
TRANS_MAX_WINDOW
);

752 
	}
}

756 
	$£nd_msg_chªÃl_wšdow_adju¡
(
ChªÃl
* 
chªÃl
,

757 
šü
) {

759 
	`TRACE
(("£ndšg wšdow‡dju¡ %d", 
šü
))

760 
	`CHECKCLEARTOWRITE
();

762 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_WINDOW_ADJUST
);

763 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

764 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
šü
);

766 
	`’üy±_·ck‘
();

767 
	}
}

770 
	$»cv_msg_chªÃl_İ’
() {

772 *
ty³
;

773 
ty³Ën
;

774 
»mÙechª
, 
Œªswšdow
, 
Œªsmax·ck‘
;

775 
ChªÃl
 *
chªÃl
;

776 cÚ¡ 
ChªTy³
 **
ı
;

777 cÚ¡ 
ChªTy³
 *
chªty³
;

778 
”¹y³
 = 
SSH_OPEN_UNKNOWN_CHANNEL_TYPE
;

779 
»t
;

782 
	`TRACE
(("enter„ecv_msg_channel_open"))

785 
ty³
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
ty³Ën
);

787 
»mÙechª
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

788 
Œªswšdow
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

789 
Œªswšdow
 = 
	`MIN
Ñ¿nswšdow, 
TRANS_MAX_WINDOW
);

790 
Œªsmax·ck‘
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

791 
Œªsmax·ck‘
 = 
	`MIN
Ñ¿nsmax·ck‘, 
TRANS_MAX_PAYLOAD_LEN
);

794 ià(
ty³Ën
 > 
MAX_NAME_LEN
) {

795 
çu»
;

801 
ı
 = &
£s
.
chªty³s
[0], 
chªty³
 = (*cp);

802 
chªty³
 !ğ
NULL
;

803 
ı
++, 
chªty³
 = (*cp)) {

804 ià(
	`¡rcmp
(
ty³
, 
chªty³
->
Çme
) == 0) {

809 ià(
chªty³
 =ğ
NULL
) {

810 
	`TRACE
(("NØm©chšgy³ fÜ '%s'", 
ty³
))

811 
çu»
;

814 
	`TRACE
(("m©chedy³ '%s'", 
ty³
))

817 
chªÃl
 = 
	`ÃwchªÃl
(
»mÙechª
, 
chªty³
, 
Œªswšdow
, 
Œªsmax·ck‘
);

819 ià(
chªÃl
 =ğ
NULL
) {

820 
	`TRACE
(("newchannel„eturned NULL"))

821 
çu»
;

824 ià(
chªÃl
->
ty³
->
š™hªdËr
) {

825 
»t
 = 
chªÃl
->
ty³
->
	`š™hªdËr
(channel);

826 ià(
»t
 =ğ
SSH_OPEN_IN_PROGRESS
) {

828 
ş—nup
;

830 ià(
»t
 > 0) {

831 
”¹y³
 = 
»t
;

832 
	`d–‘e_chªÃl
(
chªÃl
);

833 
	`TRACE
(("š™hªdË¸»tuºed fau» %d", 
»t
))

834 
çu»
;

839 
	`£nd_msg_chªÃl_İ’_cÚfœm©iÚ
(
chªÃl
, chªÃl->
»cvwšdow
,

840 
chªÃl
->
»cvmax·ck‘
);

841 
ş—nup
;

843 
çu»
:

844 
	`TRACE
(("recv_msg_channel_open failure"))

845 
	`£nd_msg_chªÃl_İ’_çu»
(
»mÙechª
, 
”¹y³
, "", "");

847 
ş—nup
:

848 
	`m_ä“
(
ty³
);

850 
	`TRACE
(("leave„ecv_msg_channel_open"))

851 
	}
}

854 
	$£nd_msg_chªÃl_çu»
(
ChªÃl
 *
chªÃl
) {

856 
	`TRACE
(("enter send_msg_channel_failure"))

857 
	`CHECKCLEARTOWRITE
();

859 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_FAILURE
);

860 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

862 
	`’üy±_·ck‘
();

863 
	`TRACE
(("leave send_msg_channel_failure"))

864 
	}
}

867 
	$£nd_msg_chªÃl_sucûss
(
ChªÃl
 *
chªÃl
) {

869 
	`TRACE
(("enter send_msg_channel_success"))

870 
	`CHECKCLEARTOWRITE
();

872 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_SUCCESS
);

873 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

875 
	`’üy±_·ck‘
();

876 
	`TRACE
(("leave send_msg_channel_success"))

877 
	}
}

881 
	$£nd_msg_chªÃl_İ’_çu»
(
»mÙechª
,

882 
»asÚ
, cÚ¡ *
‹xt
, cÚ¡ *
Ïng
) {

884 
	`TRACE
(("enter send_msg_channel_open_failure"))

885 
	`CHECKCLEARTOWRITE
();

887 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_OPEN_FAILURE
);

888 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
»mÙechª
);

889 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
»asÚ
);

890 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
‹xt
, 
	`¡¾’
((*)text));

891 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
Ïng
, 
	`¡¾’
((*)lang));

893 
	`’üy±_·ck‘
();

894 
	`TRACE
(("leave send_msg_channel_open_failure"))

895 
	}
}

899 
	$£nd_msg_chªÃl_İ’_cÚfœm©iÚ
(
ChªÃl
* 
chªÃl
,

900 
»cvwšdow
,

901 
»cvmax·ck‘
) {

903 
	`TRACE
(("enter send_msg_channel_open_confirmation"))

904 
	`CHECKCLEARTOWRITE
();

906 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_OPEN_CONFIRMATION
);

907 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

908 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
šdex
);

909 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
»cvwšdow
);

910 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
»cvmax·ck‘
);

912 
	`’üy±_·ck‘
();

913 
	`TRACE
(("leave send_msg_channel_open_confirmation"))

914 
	}
}

917 
	$şo£_chª_fd
(
ChªÃl
 *
chªÃl
, 
fd
, 
how
) {

919 
şo£š
 = 0, 
şo£out
 = 0;

921 ià(
chªÃl
->
ty³
->
£pfds
) {

922 
	`TRACE
(("SHUTDOWN(%d, %d)", 
fd
, 
how
))

923 
	`shutdown
(
fd
, 
how
);

924 ià(
how
 == 0) {

925 
şo£out
 = 1;

927 
şo£š
 = 1;

930 
	`TRACE
(("CLOSE somfd %d", 
fd
))

931 
	`şo£
(
fd
);

932 
şo£š
 = 
şo£out
 = 1;

935 ià(
şo£out
 && (
fd
 =ğ
chªÃl
->
»adfd
)) {

936 
chªÃl
->
»adfd
 = 
FD_CLOSED
;

938 ià(
şo£out
 && 
	`ERRFD_IS_READ
(
chªÃl
è&& (
fd
 =ğchªÃl->
”rfd
)) {

939 
chªÃl
->
”rfd
 = 
FD_CLOSED
;

942 ià(
şo£š
 && 
fd
 =ğ
chªÃl
->
wr™efd
) {

943 
chªÃl
->
wr™efd
 = 
FD_CLOSED
;

945 ià(
şo£š
 && 
	`ERRFD_IS_WRITE
(
chªÃl
è&& (
fd
 =ğchªÃl->
”rfd
)) {

946 
chªÃl
->
”rfd
 = 
FD_CLOSED
;

951 ià(
chªÃl
->
ty³
->
£pfds
 && chªÃl->
»adfd
 =ğ
FD_CLOSED


952 && 
chªÃl
->
wr™efd
 =ğ
FD_CLOSED
 && chªÃl->
”rfd
 == FD_CLOSED) {

953 
	`TRACE
(("CLOSE (fš®lyèoà%d", 
fd
))

954 
	`şo£
(
fd
);

956 
	}
}

959 #ià
defšed
(
USING_LISTENERS
è|| defšed(
DROPBEAR_CLIENT
)

965 
	$£nd_msg_chªÃl_İ’_š™
(
fd
, cÚ¡ 
ChªTy³
 *
ty³
) {

967 
ChªÃl
* 
chª
;

969 
	`TRACE
(("enter send_msg_channel_open_init()"))

970 
chª
 = 
	`ÃwchªÃl
(0, 
ty³
, 0, 0);

971 ià(!
chª
) {

972 
	`TRACE
(("leave send_msg_channel_open_init() - FAILED in‚ewchannel()"))

973  
DROPBEAR_FAILURE
;

977 
	`£ŠÚblockšg
(
fd
);

979 
chª
->
wr™efd
 = chª->
»adfd
 = 
fd
;

980 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
fd
);

982 
chª
->
awa™_İ’
 = 1;

985 
	`CHECKCLEARTOWRITE
();

987 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_OPEN
);

988 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
ty³
->
Çme
, 
	`¡¾’
(type->name));

989 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chª
->
šdex
);

990 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
İts
.
»cv_wšdow
);

991 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
RECV_MAX_PAYLOAD_LEN
);

993 
	`TRACE
(("leave send_msg_channel_open_init()"))

994  
DROPBEAR_SUCCESS
;

995 
	}
}

999 
	$»cv_msg_chªÃl_İ’_cÚfœm©iÚ
() {

1001 
ChªÃl
 * 
chªÃl
;

1002 
»t
;

1004 
	`TRACE
(("enter„ecv_msg_channel_open_confirmation"))

1006 
chªÃl
 = 
	`g‘chªÃl
();

1008 ià(!
chªÃl
->
awa™_İ’
) {

1009 
	`drİb—r_ex™
("Unexpected channel„eply");

1011 
chªÃl
->
awa™_İ’
 = 0;

1013 
chªÃl
->
»mÙechª
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

1014 
chªÃl
->
Œªswšdow
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

1015 
chªÃl
->
Œªsmax·ck‘
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

1017 
	`TRACE
(("new chan„emote %d†ocal %d",

1018 
chªÃl
->
»mÙechª
, chªÃl->
šdex
))

1021 ià(
chªÃl
->
ty³
->
š™hªdËr
) {

1022 
»t
 = 
chªÃl
->
ty³
->
	`š™hªdËr
(channel);

1023 ià(
»t
 > 0) {

1024 
	`»move_chªÃl
(
chªÃl
);

1025 
	`TRACE
(("š™hªdË¸»tuºed fau» %d", 
»t
))

1030 
	`TRACE
(("leave„ecv_msg_channel_open_confirmation"))

1031 
	}
}

1034 
	$»cv_msg_chªÃl_İ’_çu»
() {

1036 
ChªÃl
 * 
chªÃl
;

1038 
chªÃl
 = 
	`g‘chªÃl
();

1040 ià(!
chªÃl
->
awa™_İ’
) {

1041 
	`drİb—r_ex™
("Unexpected channel„eply");

1043 
chªÃl
->
awa™_İ’
 = 0;

1045 
	`»move_chªÃl
(
chªÃl
);

1046 
	}
}

	@common-chansession.c

25 
	~"chª£ssiÚ.h
"

28 cÚ¡ 
SigM­
 
	gsigÇmes
[] = {

29 {
SIGABRT
, "ABRT"},

30 {
SIGALRM
, "ALRM"},

31 {
SIGFPE
, "FPE"},

32 {
SIGHUP
, "HUP"},

33 {
SIGILL
, "ILL"},

34 {
SIGINT
, "INT"},

35 {
SIGKILL
, "KILL"},

36 {
SIGPIPE
, "PIPE"},

37 {
SIGQUIT
, "QUIT"},

38 {
SIGSEGV
, "SEGV"},

39 {
SIGTERM
, "TERM"},

40 {
SIGUSR1
, "USR1"},

41 {
SIGUSR2
, "USR2"},

42 {0, 
NULL
}

	@common-kex.c

26 
	~"šşudes.h
"

27 
	~"dbut.h
"

28 
	~"®go.h
"

29 
	~"bufãr.h
"

30 
	~"£ssiÚ.h
"

31 
	~"kex.h
"

32 
	~"ssh.h
"

33 
	~"·ck‘.h
"

34 
	~"bignum.h
"

35 
	~"¿ndom.h
"

36 
	~"runİts.h
"

39 
	#DH_P_1_LEN
 128

	)

40 cÚ¡ 
	gdh_p_1
[
DH_P_1_LEN
] = {

54 
	#DH_P_14_LEN
 256

	)

55 cÚ¡ 
	gdh_p_14
[
DH_P_14_LEN
] = {

80 cÚ¡ 
	gDH_G_VAL
 = 2;

82 
kexš™Ÿli£
();

83 
g’_Ãw_keys
();

84 #iâdeà
DISABLE_ZLIB


85 
g’_Ãw_z¡»ams
();

87 
»ad_kex_®gos
();

89 
hashkeys
(*
out
, 
ou’
,

90 cÚ¡ 
hash_¡©e
 * 
hs
, cÚ¡ 
X
);

94 
	$£nd_msg_kexš™
() {

96 
	`CHECKCLEARTOWRITE
();

97 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_KEXINIT
);

100 
	`g’¿ndom
(
	`buf_g‘wr™•Œ
(
£s
.
wr™•aylßd
, 16), 16);

101 
	`buf_šüwr™•os
(
£s
.
wr™•aylßd
, 16);

104 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, 
sshkex
);

107 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, 
sshho¡key
);

110 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, 
sshch”s
);

113 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, 
sshch”s
);

116 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, 
sshhashes
);

119 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, 
sshhashes
);

122 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, ses.
com´ess_®gos
);

125 
	`buf_put_®gŞi¡
(
£s
.
wr™•aylßd
, ses.
com´ess_®gos
);

128 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "", 0);

131 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "", 0);

134 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0x00);

137 
	`buf_putšt
(
£s
.
wr™•aylßd
, 0);

141 
£s
.
Œªskexš™
 = 
	`buf_Ãwcİy
(£s.
wr™•aylßd
);

143 
	`’üy±_·ck‘
();

144 
£s
.
d©¯Îowed
 = 0;

146 
	`TRACE
(("DATAALLOWED=0"))

147 
	`TRACE
(("-> KEXINIT"))

148 
£s
.
kex¡©e
.
£Ákexš™
 = 1;

149 
	}
}

158 
	$£nd_msg_Ãwkeys
() {

160 
	`TRACE
(("enter send_msg_newkeys"))

163 
	`CHECKCLEARTOWRITE
();

164 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_NEWKEYS
);

165 
	`’üy±_·ck‘
();

169 ià(
£s
.
kex¡©e
.
»cvÃwkeys
) {

170 
	`TRACE
(("while RECVNEWKEYS=1"))

171 
	`g’_Ãw_keys
();

172 
	`kexš™Ÿli£
();

173 
	`TRACE
((" -> DATAALLOWED=1"))

174 
£s
.
d©¯Îowed
 = 1;

175 
£s
.
kex¡©e
.
dÚefœ¡kex
 = 1;

177 
£s
.
kex¡©e
.
£ÁÃwkeys
 = 1;

178 
	`TRACE
(("SENTNEWKEYS=1"))

181 
	`TRACE
(("-> MSG_NEWKEYS"))

182 
	`TRACE
(("leave send_msg_newkeys"))

183 
	}
}

186 
	$»cv_msg_Ãwkeys
() {

188 
	`TRACE
(("<- MSG_NEWKEYS"))

189 
	`TRACE
(("enter„ecv_msg_newkeys"))

193 ià(
£s
.
kex¡©e
.
£ÁÃwkeys
) {

194 
	`TRACE
(("while SENTNEWKEYS=1"))

195 
	`g’_Ãw_keys
();

196 
	`kexš™Ÿli£
();

197 
	`TRACE
((" -> DATAALLOWED=1"))

198 
£s
.
d©¯Îowed
 = 1;

199 
£s
.
kex¡©e
.
dÚefœ¡kex
 = 1;

201 
	`TRACE
(("RECVNEWKEYS=1"))

202 
£s
.
kex¡©e
.
»cvÃwkeys
 = 1;

205 
	`TRACE
(("leave„ecv_msg_newkeys"))

206 
	}
}

210 
	$kexfœ¡š™Ÿli£
() {

211 
£s
.
kex¡©e
.
dÚefœ¡kex
 = 0;

213 #iâdeà
DISABLE_ZLIB


214 ià(
İts
.
’abË_com´ess
) {

215 
£s
.
com´ess_®gos
 = 
ssh_com´ess
;

219 
£s
.
com´ess_®gos
 = 
ssh_nocom´ess
;

221 
	`kexš™Ÿli£
();

222 
	}
}

225 
	$kexš™Ÿli£
() {

227 
	`TRACE
(("kexinitialise()"))

230 
£s
.
kex¡©e
.
£Ákexš™
 = 0;

231 
£s
.
kex¡©e
.
»cvkexš™
 = 0;

234 
£s
.
kex¡©e
.
»cvÃwkeys
 = 0;

235 
£s
.
kex¡©e
.
£ÁÃwkeys
 = 0;

238 
£s
.
kex¡©e
.
fœ¡fŞlows
 = 0;

240 
£s
.
kex¡©e
.
d©©¿ns
 = 0;

241 
£s
.
kex¡©e
.
d©¬ecv
 = 0;

243 
£s
.
kex¡©e
.
Ï¡kextime
 = 
	`time
(
NULL
);

245 
	}
}

255 
	$hashkeys
(*
out
, 
ou’
,

256 cÚ¡ 
hash_¡©e
 * 
hs
, cÚ¡ 
X
) {

258 
hash_¡©e
 
hs2
;

259 
k2
[
SHA1_HASH_SIZE
];

261 
	`memıy
(&
hs2
, 
hs
, (
hash_¡©e
));

262 
	`sha1_´oûss
(&
hs2
, &
X
, 1);

263 
	`sha1_´oûss
(&
hs2
, 
£s
.
£ssiÚ_id
, 
SHA1_HASH_SIZE
);

264 
	`sha1_dÚe
(&
hs2
, 
out
);

265 ià(
SHA1_HASH_SIZE
 < 
ou’
) {

267 
	`memıy
(&
hs2
, 
hs
, (
hash_¡©e
));

268 
	`sha1_´oûss
(&
hs2
, 
out
, 
SHA1_HASH_SIZE
);

269 
	`sha1_dÚe
(&
hs2
, 
k2
);

270 
	`memıy
(&
out
[
SHA1_HASH_SIZE
], 
k2
, 
ou’
 - SHA1_HASH_SIZE);

272 
	}
}

282 
	$g’_Ãw_keys
() {

284 
C2S_IV
[
MAX_IV_LEN
];

285 
C2S_key
[
MAX_KEY_LEN
];

286 
S2C_IV
[
MAX_IV_LEN
];

287 
S2C_key
[
MAX_KEY_LEN
];

289 *
Œªs_IV
, *
Œªs_key
, *
»cv_IV
, *
»cv_key
;

291 
hash_¡©e
 
hs
;

292 
C2S_keysize
, 
S2C_keysize
;

293 
maù¿n¦‘‹r
, 
maüecvË‰”
;

294 
»cv_ch”
 = 0, 
Œªs_ch”
 = 0;

296 
	`TRACE
(("enter gen_new_keys"))

299 
	`sha1_š™
(&
hs
);

300 
	`sha1_´oûss_mp
(&
hs
, 
£s
.
dh_K
);

301 
	`mp_ş—r
(
£s
.
dh_K
);

302 
	`m_ä“
(
£s
.
dh_K
);

303 
	`sha1_´oûss
(&
hs
, 
£s
.
hash
, 
SHA1_HASH_SIZE
);

304 
	`m_buº
(
£s
.
hash
, 
SHA1_HASH_SIZE
);

306 ià(
IS_DROPBEAR_CLIENT
) {

307 
Œªs_IV
 = 
C2S_IV
;

308 
»cv_IV
 = 
S2C_IV
;

309 
Œªs_key
 = 
C2S_key
;

310 
»cv_key
 = 
S2C_key
;

311 
C2S_keysize
 = 
£s
.
Ãwkeys
->
Œªs
.
®go_üy±
->
keysize
;

312 
S2C_keysize
 = 
£s
.
Ãwkeys
->
»cv
.
®go_üy±
->
keysize
;

313 
maù¿n¦‘‹r
 = 'E';

314 
maüecvË‰”
 = 'F';

316 
Œªs_IV
 = 
S2C_IV
;

317 
»cv_IV
 = 
C2S_IV
;

318 
Œªs_key
 = 
S2C_key
;

319 
»cv_key
 = 
C2S_key
;

320 
C2S_keysize
 = 
£s
.
Ãwkeys
->
»cv
.
®go_üy±
->
keysize
;

321 
S2C_keysize
 = 
£s
.
Ãwkeys
->
Œªs
.
®go_üy±
->
keysize
;

322 
maù¿n¦‘‹r
 = 'F';

323 
maüecvË‰”
 = 'E';

326 
	`hashkeys
(
C2S_IV
, 
SHA1_HASH_SIZE
, &
hs
, 'A');

327 
	`hashkeys
(
S2C_IV
, 
SHA1_HASH_SIZE
, &
hs
, 'B');

328 
	`hashkeys
(
C2S_key
, 
C2S_keysize
, &
hs
, 'C');

329 
	`hashkeys
(
S2C_key
, 
S2C_keysize
, &
hs
, 'D');

331 
»cv_ch”
 = 
	`fšd_ch”
(
£s
.
Ãwkeys
->
»cv
.
®go_üy±
->
ch”desc
->
Çme
);

332 ià(
»cv_ch”
 < 0)

333 
	`drİb—r_ex™
("Cryptoƒrror");

334 ià(
£s
.
Ãwkeys
->
»cv
.
üy±_mode
->
	`¡¬t
(
»cv_ch”
,

335 
»cv_IV
, 
»cv_key
,

336 
£s
.
Ãwkeys
->
»cv
.
®go_üy±
->
keysize
, 0,

337 &
£s
.
Ãwkeys
->
»cv
.
ch”_¡©e
è!ğ
CRYPT_OK
) {

338 
	`drİb—r_ex™
("Cryptoƒrror");

341 
Œªs_ch”
 = 
	`fšd_ch”
(
£s
.
Ãwkeys
->
Œªs
.
®go_üy±
->
ch”desc
->
Çme
);

342 ià(
Œªs_ch”
 < 0)

343 
	`drİb—r_ex™
("Cryptoƒrror");

344 ià(
£s
.
Ãwkeys
->
Œªs
.
üy±_mode
->
	`¡¬t
(
Œªs_ch”
,

345 
Œªs_IV
, 
Œªs_key
,

346 
£s
.
Ãwkeys
->
Œªs
.
®go_üy±
->
keysize
, 0,

347 &
£s
.
Ãwkeys
->
Œªs
.
ch”_¡©e
è!ğ
CRYPT_OK
) {

348 
	`drİb—r_ex™
("Cryptoƒrror");

352 
	`hashkeys
(
£s
.
Ãwkeys
->
Œªs
.
mackey
,

353 
£s
.
Ãwkeys
->
Œªs
.
®go_mac
->
keysize
, &
hs
, 
maù¿n¦‘‹r
);

354 
	`hashkeys
(
£s
.
Ãwkeys
->
»cv
.
mackey
,

355 
£s
.
Ãwkeys
->
»cv
.
®go_mac
->
keysize
, &
hs
, 
maüecvË‰”
);

356 
£s
.
Ãwkeys
->
Œªs
.
hash_šdex
 = 
	`fšd_hash
(£s.Ãwkeys->Œªs.
®go_mac
->
hashdesc
->
Çme
),

357 
£s
.
Ãwkeys
->
»cv
.
hash_šdex
 = 
	`fšd_hash
(£s.Ãwkeys->»cv.
®go_mac
->
hashdesc
->
Çme
),

359 #iâdeà
DISABLE_ZLIB


360 
	`g’_Ãw_z¡»ams
();

364 
	`m_buº
(
£s
.
keys
, (
key_cÚ‹xt
));

365 
	`m_ä“
(
£s
.
keys
);

366 
£s
.
keys
 = ses.
Ãwkeys
;

367 
£s
.
Ãwkeys
 = 
NULL
;

369 
	`TRACE
(("leave gen_new_keys"))

370 
	}
}

372 #iâdeà
DISABLE_ZLIB


374 
	$is_com´ess_Œªs
() {

375  
£s
.
keys
->
Œªs
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB


376 || (
£s
.
auth¡©e
.
authdÚe


377 && 
£s
.
keys
->
Œªs
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB_DELAY
);

378 
	}
}

380 
	$is_com´ess_»cv
() {

381  
£s
.
keys
->
»cv
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB


382 || (
£s
.
auth¡©e
.
authdÚe


383 && 
£s
.
keys
->
»cv
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB_DELAY
);

384 
	}
}

388 
	$g’_Ãw_z¡»ams
() {

391 ià(
£s
.
Ãwkeys
->
»cv
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB


392 || 
£s
.
Ãwkeys
->
»cv
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB_DELAY
) {

393 
£s
.
Ãwkeys
->
»cv
.
z¡»am
 = (
z_¡»amp
)
	`m_m®loc
((
z_¡»am
));

394 
£s
.
Ãwkeys
->
»cv
.
z¡»am
->
z®loc
 = 
Z_NULL
;

395 
£s
.
Ãwkeys
->
»cv
.
z¡»am
->
zä“
 = 
Z_NULL
;

397 ià(
	`šæ©eIn™
(
£s
.
Ãwkeys
->
»cv
.
z¡»am
è!ğ
Z_OK
) {

398 
	`drİb—r_ex™
("zlibƒrror");

401 
£s
.
Ãwkeys
->
»cv
.
z¡»am
 = 
NULL
;

404 ià(
£s
.
Ãwkeys
->
Œªs
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB


405 || 
£s
.
Ãwkeys
->
Œªs
.
®go_comp
 =ğ
DROPBEAR_COMP_ZLIB_DELAY
) {

406 
£s
.
Ãwkeys
->
Œªs
.
z¡»am
 = (
z_¡»amp
)
	`m_m®loc
((
z_¡»am
));

407 
£s
.
Ãwkeys
->
Œªs
.
z¡»am
->
z®loc
 = 
Z_NULL
;

408 
£s
.
Ãwkeys
->
Œªs
.
z¡»am
->
zä“
 = 
Z_NULL
;

410 ià(
	`deæ©eIn™2
(
£s
.
Ãwkeys
->
Œªs
.
z¡»am
, 
Z_DEFAULT_COMPRESSION
,

411 
Z_DEFLATED
, 
DROPBEAR_ZLIB_WINDOW_BITS
,

412 
DROPBEAR_ZLIB_MEM_LEVEL
, 
Z_DEFAULT_STRATEGY
)

413 !ğ
Z_OK
) {

414 
	`drİb—r_ex™
("zlibƒrror");

417 
£s
.
Ãwkeys
->
Œªs
.
z¡»am
 = 
NULL
;

421 ià(
£s
.
keys
->
»cv
.
z¡»am
 !ğ
NULL
) {

422 ià(
	`šæ©eEnd
(
£s
.
keys
->
»cv
.
z¡»am
è=ğ
Z_STREAM_ERROR
) {

424 
	`drİb—r_ex™
("Cryptoƒrror");

426 
	`m_ä“
(
£s
.
keys
->
»cv
.
z¡»am
);

428 ià(
£s
.
keys
->
Œªs
.
z¡»am
 !ğ
NULL
) {

429 ià(
	`deæ©eEnd
(
£s
.
keys
->
Œªs
.
z¡»am
è=ğ
Z_STREAM_ERROR
) {

431 
	`drİb—r_ex™
("Cryptoƒrror");

433 
	`m_ä“
(
£s
.
keys
->
Œªs
.
z¡»am
);

435 
	}
}

448 
	$»cv_msg_kexš™
() {

450 
kexhashbuf_Ën
 = 0;

451 
»mÙe_id’t_Ën
 = 0;

452 
loÿl_id’t_Ën
 = 0;

454 
	`TRACE
(("<- KEXINIT"))

455 
	`TRACE
(("enter„ecv_msg_kexinit"))

457 ià(!
£s
.
kex¡©e
.
£Ákexš™
) {

459 
	`£nd_msg_kexš™
();

460 
	`TRACE
(("continue„ecv_msg_kexinit: sent kexinit"))

464 
loÿl_id’t_Ën
 = 
	`¡¾’
(
LOCAL_IDENT
);

465 
»mÙe_id’t_Ën
 = 
	`¡¾’
((*)
£s
.
»mÙeid’t
);

467 
kexhashbuf_Ën
 = 
loÿl_id’t_Ën
 + 
»mÙe_id’t_Ën


468 + 
£s
.
Œªskexš™
->
Ën
 + ses.
·ylßd
->len

469 + 
KEXHASHBUF_MAX_INTS
;

471 
£s
.
kexhashbuf
 = 
	`buf_Ãw
(
kexhashbuf_Ën
);

473 ià(
IS_DROPBEAR_CLIENT
) {

476 
	`»ad_kex_®gos
();

479 
	`buf_put¡ršg
(
£s
.
kexhashbuf
,

480 (*)
LOCAL_IDENT
, 
loÿl_id’t_Ën
);

482 
	`buf_put¡ršg
(
£s
.
kexhashbuf
, ses.
»mÙeid’t
, 
»mÙe_id’t_Ën
);

485 
	`buf_put¡ršg
(
£s
.
kexhashbuf
,

486 
£s
.
Œªskexš™
->
d©a
, ses.Œªskexš™->
Ën
);

488 
	`buf_£os
(
£s
.
·ylßd
, 0);

489 
	`buf_put¡ršg
(
£s
.
kexhashbuf
, ses.
·ylßd
->
d©a
, ses.·ylßd->
Ën
);

495 
	`»ad_kex_®gos
();

497 
	`buf_put¡ršg
(
£s
.
kexhashbuf
, ses.
»mÙeid’t
, 
»mÙe_id’t_Ën
);

499 
	`buf_put¡ršg
(
£s
.
kexhashbuf
,

500 (*)
LOCAL_IDENT
, 
loÿl_id’t_Ën
);

503 
	`buf_£os
(
£s
.
·ylßd
, 0);

504 
	`buf_put¡ršg
(
£s
.
kexhashbuf
, ses.
·ylßd
->
d©a
, ses.·ylßd->
Ën
);

507 
	`buf_put¡ršg
(
£s
.
kexhashbuf
,

508 
£s
.
Œªskexš™
->
d©a
, ses.Œªskexš™->
Ën
);

510 
£s
.
»quœ’ext
 = 
SSH_MSG_KEXDH_INIT
;

513 
	`buf_ä“
(
£s
.
Œªskexš™
);

514 
£s
.
Œªskexš™
 = 
NULL
;

517 
£s
.
kex¡©e
.
»cvkexš™
 = 1;

519 
	`TRACE
(("leave„ecv_msg_kexinit"))

520 
	}
}

522 
	$lßd_dh_p
(
mp_št
 * 
dh_p
)

524 
£s
.
Ãwkeys
->
®go_kex
) {

525 
DROPBEAR_KEX_DH_GROUP1
:

526 
	`by‹s_to_mp
(
dh_p
, 
dh_p_1
, 
DH_P_1_LEN
);

528 
DROPBEAR_KEX_DH_GROUP14
:

529 
	`by‹s_to_mp
(
dh_p
, 
dh_p_14
, 
DH_P_14_LEN
);

532 
	}
}

537 
	$g’_kexdh_v®s
(
mp_št
 *
dh_pub
, mp_šˆ*
dh_´iv
) {

539 
	`DEF_MP_INT
(
dh_p
);

540 
	`DEF_MP_INT
(
dh_q
);

541 
	`DEF_MP_INT
(
dh_g
);

543 
	`TRACE
(("enter send_msg_kexdh_reply"))

545 
	`m_mp_š™_muÉi
(&
dh_g
, &
dh_p
, &
dh_q
, 
NULL
);

548 
	`lßd_dh_p
(&
dh_p
);

550 ià(
	`mp_£t_št
(&
dh_g
, 
DH_G_VAL
è!ğ
MP_OKAY
) {

551 
	`drİb—r_ex™
("Diffie-Hellmanƒrror");

556 ià(
	`mp_sub_d
(&
dh_p
, 1, 
dh_´iv
è!ğ
MP_OKAY
) {

557 
	`drİb—r_ex™
("Diffie-Hellmanƒrror");

559 ià(
	`mp_div_2
(
dh_´iv
, &
dh_q
è!ğ
MP_OKAY
) {

560 
	`drİb—r_ex™
("Diffie-Hellmanƒrror");

564 
	`g’_¿ndom_mpšt
(&
dh_q
, 
dh_´iv
);

567 ià(
	`mp_ex±mod
(&
dh_g
, 
dh_´iv
, &
dh_p
, 
dh_pub
è!ğ
MP_OKAY
) {

568 
	`drİb—r_ex™
("Diffie-Hellmanƒrror");

570 
	`mp_ş—r_muÉi
(&
dh_g
, &
dh_p
, &
dh_q
, 
NULL
);

571 
	}
}

577 
	$kexdh_comb_key
(
mp_št
 *
dh_pub_us
, mp_šˆ*
dh_´iv
, mp_šˆ*
dh_pub_them
,

578 
sign_key
 *
ho¡key
) {

580 
mp_št
 
dh_p
;

581 
mp_št
 *
dh_e
 = 
NULL
, *
dh_f
 = NULL;

582 
hash_¡©e
 
hs
;

585 
	`m_mp_š™
(&
dh_p
);

586 
	`lßd_dh_p
(&
dh_p
);

589 ià(
	`mp_cmp
(
dh_pub_them
, &
dh_p
è!ğ
MP_LT


590 || 
	`mp_cmp_d
(
dh_pub_them
, 0è!ğ
MP_GT
) {

591 
	`drİb—r_ex™
("Diffie-Hellmanƒrror");

595 
£s
.
dh_K
 = (
mp_št
*)
	`m_m®loc
((mp_int));

596 
	`m_mp_š™
(
£s
.
dh_K
);

597 ià(
	`mp_ex±mod
(
dh_pub_them
, 
dh_´iv
, &
dh_p
, 
£s
.
dh_K
è!ğ
MP_OKAY
) {

598 
	`drİb—r_ex™
("Diffie-Hellmanƒrror");

602 
	`mp_ş—r_muÉi
(&
dh_p
, 
NULL
);

606 ià(
IS_DROPBEAR_CLIENT
) {

607 
dh_e
 = 
dh_pub_us
;

608 
dh_f
 = 
dh_pub_them
;

610 
dh_e
 = 
dh_pub_them
;

611 
dh_f
 = 
dh_pub_us
;

616 
	`buf_put_pub_key
(
£s
.
kexhashbuf
, 
ho¡key
, ses.
Ãwkeys
->
®go_ho¡key
);

618 
	`buf_putmpšt
(
£s
.
kexhashbuf
, 
dh_e
);

620 
	`buf_putmpšt
(
£s
.
kexhashbuf
, 
dh_f
);

622 
	`buf_putmpšt
(
£s
.
kexhashbuf
, ses.
dh_K
);

625 
	`sha1_š™
(&
hs
);

626 
	`buf_£os
(
£s
.
kexhashbuf
, 0);

627 
	`sha1_´oûss
(&
hs
, 
	`buf_g‘±r
(
£s
.
kexhashbuf
, ses.kexhashbuf->
Ën
),

628 
£s
.
kexhashbuf
->
Ën
);

629 
	`sha1_dÚe
(&
hs
, 
£s
.
hash
);

631 
	`buf_buº
(
£s
.
kexhashbuf
);

632 
	`buf_ä“
(
£s
.
kexhashbuf
);

633 
£s
.
kexhashbuf
 = 
NULL
;

636 ià(
£s
.
£ssiÚ_id
 =ğ
NULL
) {

638 
£s
.
£ssiÚ_id
 = (*)
	`m_m®loc
(
SHA1_HASH_SIZE
);

639 
	`memıy
(
£s
.
£ssiÚ_id
, ses.
hash
, 
SHA1_HASH_SIZE
);

641 
	}
}

645 
	$»ad_kex_®gos
() {

648 
®go_ty³
 * 
c2s_hash_®go
 = 
NULL
;

649 
®go_ty³
 * 
s2c_hash_®go
 = 
NULL
;

650 
®go_ty³
 * 
c2s_ch”_®go
 = 
NULL
;

651 
®go_ty³
 * 
s2c_ch”_®go
 = 
NULL
;

652 
®go_ty³
 * 
c2s_comp_®go
 = 
NULL
;

653 
®go_ty³
 * 
s2c_comp_®go
 = 
NULL
;

655 
®go_ty³
 * 
®go
 = 
NULL
;

658 * 
”¿lgo
 = 
NULL
;

660 
goodguess
 = 0;

661 
®lgood
 = 1;

664 
	`buf_šüpos
(
£s
.
·ylßd
, 16);

666 
£s
.
Ãwkeys
 = (
key_cÚ‹xt
*)
	`m_m®loc
((key_context));

669 
®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, 
sshkex
, &
goodguess
);

670 
®lgood
 &ğ
goodguess
;

671 ià(
®go
 =ğ
NULL
) {

672 
”¿lgo
 = "kex";

673 
”rÜ
;

675 
	`TRACE
(("kex‡lgØ%s", 
®go
->
Çme
))

676 
£s
.
Ãwkeys
->
®go_kex
 = 
®go
->
v®
;

679 
®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, 
sshho¡key
, &
goodguess
);

680 
®lgood
 &ğ
goodguess
;

681 ià(
®go
 =ğ
NULL
) {

682 
”¿lgo
 = "hostkey";

683 
”rÜ
;

685 
	`TRACE
(("ho¡key‡lgØ%s", 
®go
->
Çme
))

686 
£s
.
Ãwkeys
->
®go_ho¡key
 = 
®go
->
v®
;

689 
c2s_ch”_®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, 
sshch”s
, &
goodguess
);

690 ià(
c2s_ch”_®go
 =ğ
NULL
) {

691 
”¿lgo
 = "enc c->s";

692 
”rÜ
;

694 
	`TRACE
(("’øc2 i  %s", 
c2s_ch”_®go
->
Çme
))

697 
s2c_ch”_®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, 
sshch”s
, &
goodguess
);

698 ià(
s2c_ch”_®go
 =ğ
NULL
) {

699 
”¿lgo
 = "enc s->c";

700 
”rÜ
;

702 
	`TRACE
(("’øs2øi  %s", 
s2c_ch”_®go
->
Çme
))

705 
c2s_hash_®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, 
sshhashes
, &
goodguess
);

706 ià(
c2s_hash_®go
 =ğ
NULL
) {

707 
”¿lgo
 = "mac c->s";

708 
”rÜ
;

710 
	`TRACE
(("hash c2 i  %s", 
c2s_hash_®go
->
Çme
))

713 
s2c_hash_®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, 
sshhashes
, &
goodguess
);

714 ià(
s2c_hash_®go
 =ğ
NULL
) {

715 
”¿lgo
 = "mac s->c";

716 
”rÜ
;

718 
	`TRACE
(("hash s2øi  %s", 
s2c_hash_®go
->
Çme
))

721 
c2s_comp_®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, ses.
com´ess_®gos
, &
goodguess
);

722 ià(
c2s_comp_®go
 =ğ
NULL
) {

723 
”¿lgo
 = "comp c->s";

724 
”rÜ
;

726 
	`TRACE
(("hash c2 i  %s", 
c2s_comp_®go
->
Çme
))

729 
s2c_comp_®go
 = 
£s
.
	`buf_m©ch_®go
(£s.
·ylßd
, ses.
com´ess_®gos
, &
goodguess
);

730 ià(
s2c_comp_®go
 =ğ
NULL
) {

731 
”¿lgo
 = "comp s->c";

732 
”rÜ
;

734 
	`TRACE
(("hash s2øi  %s", 
s2c_comp_®go
->
Çme
))

737 
	`buf_—t¡ršg
(
£s
.
·ylßd
);

740 
	`buf_—t¡ršg
(
£s
.
·ylßd
);

743 ià(
	`buf_g‘boŞ
(
£s
.
·ylßd
)) {

744 
£s
.
kex¡©e
.
fœ¡fŞlows
 = 1;

746 ià(!
®lgood
) {

747 
£s
.
ignÜ’ext
 = 1;

752 ià(
IS_DROPBEAR_CLIENT
) {

753 
£s
.
Ãwkeys
->
»cv
.
®go_üy±
 =

754 (
drİb—r_ch”
*)
s2c_ch”_®go
->
d©a
;

755 
£s
.
Ãwkeys
->
Œªs
.
®go_üy±
 =

756 (
drİb—r_ch”
*)
c2s_ch”_®go
->
d©a
;

757 
£s
.
Ãwkeys
->
»cv
.
üy±_mode
 =

758 (
drİb—r_ch”_mode
*)
s2c_ch”_®go
->
mode
;

759 
£s
.
Ãwkeys
->
Œªs
.
üy±_mode
 =

760 (
drİb—r_ch”_mode
*)
c2s_ch”_®go
->
mode
;

761 
£s
.
Ãwkeys
->
»cv
.
®go_mac
 =

762 (
drİb—r_hash
*)
s2c_hash_®go
->
d©a
;

763 
£s
.
Ãwkeys
->
Œªs
.
®go_mac
 =

764 (
drİb—r_hash
*)
c2s_hash_®go
->
d©a
;

765 
£s
.
Ãwkeys
->
»cv
.
®go_comp
 = 
s2c_comp_®go
->
v®
;

766 
£s
.
Ãwkeys
->
Œªs
.
®go_comp
 = 
c2s_comp_®go
->
v®
;

769 
£s
.
Ãwkeys
->
»cv
.
®go_üy±
 =

770 (
drİb—r_ch”
*)
c2s_ch”_®go
->
d©a
;

771 
£s
.
Ãwkeys
->
Œªs
.
®go_üy±
 =

772 (
drİb—r_ch”
*)
s2c_ch”_®go
->
d©a
;

773 
£s
.
Ãwkeys
->
»cv
.
üy±_mode
 =

774 (
drİb—r_ch”_mode
*)
c2s_ch”_®go
->
mode
;

775 
£s
.
Ãwkeys
->
Œªs
.
üy±_mode
 =

776 (
drİb—r_ch”_mode
*)
s2c_ch”_®go
->
mode
;

777 
£s
.
Ãwkeys
->
»cv
.
®go_mac
 =

778 (
drİb—r_hash
*)
c2s_hash_®go
->
d©a
;

779 
£s
.
Ãwkeys
->
Œªs
.
®go_mac
 =

780 (
drİb—r_hash
*)
s2c_hash_®go
->
d©a
;

781 
£s
.
Ãwkeys
->
»cv
.
®go_comp
 = 
c2s_comp_®go
->
v®
;

782 
£s
.
Ãwkeys
->
Œªs
.
®go_comp
 = 
s2c_comp_®go
->
v®
;

786 
	`buf_g‘št
(
£s
.
·ylßd
);

789 
”rÜ
:

790 
	`drİb—r_ex™
("NØm©chšg‡lgØ%s", 
”¿lgo
);

791 
	}
}

	@common-runopts.c

25 
	~"šşudes.h
"

26 
	~"runİts.h
"

27 
	~"signkey.h
"

28 
	~"bufãr.h
"

29 
	~"dbut.h
"

30 
	~"auth.h
"

32 
runİts
 
	gİts
;

36 
	$»adho¡key
(cÚ¡ * 
f’ame
, 
sign_key
 * 
ho¡key
, *
ty³
) {

38 
»t
 = 
DROPBEAR_FAILURE
;

39 
bufãr
 *
buf
;

41 
buf
 = 
	`buf_Ãw
(
MAX_PRIVKEY_SIZE
);

43 ià(
	`buf_»adfe
(
buf
, 
f’ame
è=ğ
DROPBEAR_FAILURE
) {

44 
out
;

46 
	`buf_£os
(
buf
, 0);

47 ià(
	`buf_g‘_´iv_key
(
buf
, 
ho¡key
, 
ty³
è=ğ
DROPBEAR_FAILURE
) {

48 
out
;

51 
»t
 = 
DROPBEAR_SUCCESS
;

52 
out
:

54 
	`buf_buº
(
buf
);

55 
	`buf_ä“
(
buf
);

56  
»t
;

57 
	}
}

	@common-session.c

25 
	~"šşudes.h
"

26 
	~"£ssiÚ.h
"

27 
	~"dbut.h
"

28 
	~"·ck‘.h
"

29 
	~"®go.h
"

30 
	~"bufãr.h
"

31 
	~"dss.h
"

32 
	~"ssh.h
"

33 
	~"¿ndom.h
"

34 
	~"kex.h
"

35 
	~"chªÃl.h
"

36 
	~"©omicio.h
"

37 
	~"runİts.h
"

39 
checktimeouts
();

40 
£Ëù_timeout
();

41 
id’t_»adÊ
(
fd
, * 
buf
, 
couÁ
);

43 
ssh£ssiÚ
 
	g£s
;

47 
	g£ssš™dÚe
 = 0;

50 
	gex™æag
 = 0;

55 
	$commÚ_£ssiÚ_š™
(
sock_š
, 
sock_out
) {

57 
	`TRACE
(("enter session_init"))

59 
£s
.
sock_š
 = sock_in;

60 
£s
.
sock_out
 = sock_out;

61 
£s
.
maxfd
 = 
	`MAX
(
sock_š
, 
sock_out
);

63 
£s
.
cÚÃù_time
 = 0;

64 
£s
.
Ï¡_Œx_·ck‘_time
 = 0;

65 
£s
.
Ï¡_·ck‘_time
 = 0;

67 ià(
	`pe
(
£s
.
sigÇl_pe
) < 0) {

68 
	`drİb—r_ex™
("Signal…ipe failed");

70 
	`£ŠÚblockšg
(
£s
.
sigÇl_pe
[0]);

71 
	`£ŠÚblockšg
(
£s
.
sigÇl_pe
[1]);

73 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, ses.
sigÇl_pe
[0]);

74 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, ses.
sigÇl_pe
[1]);

76 
	`kexfœ¡š™Ÿli£
();

78 
£s
.
wr™•aylßd
 = 
	`buf_Ãw
(
TRANS_MAX_PAYLOAD_LEN
);

79 
£s
.
Œªs£q
 = 0;

81 
£s
.
»adbuf
 = 
NULL
;

82 
£s
.
·ylßd
 = 
NULL
;

83 
£s
.
»cv£q
 = 0;

85 
	`š™queue
(&
£s
.
wr™equeue
);

87 
£s
.
»quœ’ext
 = 
SSH_MSG_KEXINIT
;

88 
£s
.
d©¯Îowed
 = 1;

90 
£s
.
ignÜ’ext
 = 0;

91 
£s
.
Ï¡·ck‘
 = 0;

92 
£s
.
»¶y_queue_h—d
 = 
NULL
;

93 
£s
.
»¶y_queue_
 = 
NULL
;

96 
£s
.
keys
 = (
key_cÚ‹xt
*)
	`m_m®loc
((key_context));

97 
£s
.
Ãwkeys
 = 
NULL
;

98 
£s
.
keys
->
»cv
.
®go_üy±
 = &
drİb—r_noch”
;

99 
£s
.
keys
->
Œªs
.
®go_üy±
 = &
drİb—r_noch”
;

100 
£s
.
keys
->
»cv
.
üy±_mode
 = &
drİb—r_mode_nÚe
;

101 
£s
.
keys
->
Œªs
.
üy±_mode
 = &
drİb—r_mode_nÚe
;

103 
£s
.
keys
->
»cv
.
®go_mac
 = &
drİb—r_nohash
;

104 
£s
.
keys
->
Œªs
.
®go_mac
 = &
drİb—r_nohash
;

106 
£s
.
keys
->
®go_kex
 = -1;

107 
£s
.
keys
->
®go_ho¡key
 = -1;

108 
£s
.
keys
->
»cv
.
®go_comp
 = 
DROPBEAR_COMP_NONE
;

109 
£s
.
keys
->
Œªs
.
®go_comp
 = 
DROPBEAR_COMP_NONE
;

111 #iâdeà
DISABLE_ZLIB


112 
£s
.
keys
->
»cv
.
z¡»am
 = 
NULL
;

113 
£s
.
keys
->
Œªs
.
z¡»am
 = 
NULL
;

117 
£s
.
£ssiÚ_id
 = 
NULL
;

118 
£s
.
kexhashbuf
 = 
NULL
;

119 
£s
.
Œªskexš™
 = 
NULL
;

120 
£s
.
dh_K
 = 
NULL
;

121 
£s
.
»mÙeid’t
 = 
NULL
;

123 
£s
.
chªty³s
 = 
NULL
;

125 
£s
.
®low´ivpÜt
 = 0;

127 
	`TRACE
(("leave session_init"))

128 
	}
}

130 
£ssiÚ_loİ
((*
loİhªdËr
)()) {

132 
fd_£t
 
»adfd
, 
wr™efd
;

133 
timev®
 
timeout
;

134 
v®
;

139 
timeout
.
tv_£c
 = 
	`£Ëù_timeout
();

140 
timeout
.
tv_u£c
 = 0;

141 
	`FD_ZERO
(&
wr™efd
);

142 
	`FD_ZERO
(&
»adfd
);

143 
	`drİb—r_as£¹
(
£s
.
·ylßd
 =ğ
NULL
);

144 ià(
£s
.
sock_š
 != -1) {

145 
	`FD_SET
(
£s
.
sock_š
, &
»adfd
);

147 ià(
£s
.
sock_out
 !ğ-1 && !
	`i£m±y
(&£s.
wr™equeue
)) {

148 
	`FD_SET
(
£s
.
sock_out
, &
wr™efd
);

153 
	`FD_SET
(
£s
.
sigÇl_pe
[0], &
»adfd
);

156 ià(
£s
.
d©¯Îowed
) {

157 
	`£tchªÃlfds
(&
»adfd
, &
wr™efd
);

159 
v®
 = 
	`£Ëù
(
£s
.
maxfd
+1, &
»adfd
, &
wr™efd
, 
NULL
, &
timeout
);

161 ià(
ex™æag
) {

162 
	`drİb—r_ex™
("Terminated by signal");

165 ià(
v®
 < 0 && 
”ºo
 !ğ
EINTR
) {

166 
	`drİb—r_ex™
("Error in select");

169 ià(
v®
 <= 0) {

174 
	`FD_ZERO
(&
wr™efd
);

175 
	`FD_ZERO
(&
»adfd
);

181 ià(
	`FD_ISSET
(
£s
.
sigÇl_pe
[0], &
»adfd
)) {

182 
x
;

183 
	`»ad
(
£s
.
sigÇl_pe
[0], &
x
, 1) > 0) {}

187 
	`checktimeouts
();

190 ià(
£s
.
sock_out
 != -1) {

191 ià(
	`FD_ISSET
(
£s
.
sock_out
, &
wr™efd
è&& !
	`i£m±y
(&£s.
wr™equeue
)) {

192 
	`wr™e_·ck‘
();

196 ià(
£s
.
sock_š
 != -1) {

197 ià(
	`FD_ISSET
(
£s
.
sock_š
, &
»adfd
)) {

198 
	`»ad_·ck‘
();

203 ià(
£s
.
·ylßd
 !ğ
NULL
) {

204 
	`´oûss_·ck‘
();

210 
	`maybe_æush_»¶y_queue
();

214 ià(
£s
.
d©¯Îowed
) {

215 
	`chªÃlio
(&
»adfd
, &
wr™efd
);

218 ià(
loİhªdËr
) {

219 
	`loİhªdËr
();

225 
	}
}

228 
	$commÚ_£ssiÚ_ş—nup
() {

230 
	`TRACE
(("enter session_cleanup"))

233 ià(!
£ssš™dÚe
) {

234 
	`TRACE
(("leave session_cleanup: !sessinitdone"))

238 
	`m_ä“
(
£s
.
£ssiÚ_id
);

239 
	`m_buº
(
£s
.
keys
, (
key_cÚ‹xt
));

240 
	`m_ä“
(
£s
.
keys
);

242 
	`chªş—nup
();

244 
	`TRACE
(("leave session_cleanup"))

245 
	}
}

248 
	$£ssiÚ_id’tifiÿtiÚ
() {

251 
lšebuf
[256];

252 
Ën
 = 0;

253 
dÚe
 = 0;

254 
i
;

257 ià(
	`©omicio
(
wr™e
, 
£s
.
sock_out
, 
LOCAL_IDENT
 "\r\n",

258 
	`¡¾’
(
LOCAL_IDENT
 "\r\n")è=ğ
DROPBEAR_FAILURE
) {

259 
£s
.
	`»mÙeşo£d
();

263 
i
 = 0; i < 50; i++) {

264 
Ën
 = 
	`id’t_»adÊ
(
£s
.
sock_š
, 
lšebuf
, (linebuf));

266 ià(
Ën
 < 0 && 
”ºo
 !ğ
EINTR
) {

271 ià(
Ën
 >ğ4 && 
	`memcmp
(
lšebuf
, "SSH-", 4) == 0) {

273 
dÚe
 = 1;

278 ià(!
dÚe
) {

279 
	`TRACE
(("”r: % fÜ '%s'\n", 
	`¡»¼Ü
(
”ºo
), 
lšebuf
))

280 
£s
.
	`»mÙeşo£d
();

283 
£s
.
»mÙeid’t
 = 
	`m_m®loc
(
Ën
);

284 
	`memıy
(
£s
.
»mÙeid’t
, 
lšebuf
, 
Ën
);

288 ià(
	`¡ºcmp
(
£s
.
»mÙeid’t
, "SSH-2.", 6) != 0

289 && 
	`¡ºcmp
(
£s
.
»mÙeid’t
, "SSH-1.99-", 9) != 0) {

290 
	`drİb—r_ex™
("Incom·tibË„emÙv”siÚ '%s'", 
£s
.
»mÙeid’t
);

293 
	`TRACE
(("»mÙeid’t: %s", 
£s
.
»mÙeid’t
))

295 
	}
}

299 
	$id’t_»adÊ
(
fd
, * 
buf
, 
couÁ
) {

301 
š
;

302 
pos
 = 0;

303 
num
 = 0;

304 
fd_£t
 
fds
;

305 
timev®
 
timeout
;

307 
	`TRACE
(("enter ident_readln"))

309 ià(
couÁ
 < 1) {

313 
	`FD_ZERO
(&
fds
);

318 
pos
 < 
couÁ
-1) {

320 
	`FD_SET
(
fd
, &
fds
);

322 
timeout
.
tv_£c
 = 1;

323 
timeout
.
tv_u£c
 = 0;

324 ià(
	`£Ëù
(
fd
+1, &
fds
, 
NULL
, NULL, &
timeout
) < 0) {

325 ià(
”ºo
 =ğ
EINTR
) {

328 
	`TRACE
(("leave ident_readln: selectƒrror"))

332 
	`checktimeouts
();

337 ià(
	`FD_ISSET
(
fd
, &
fds
)) {

338 
num
 = 
	`»ad
(
fd
, &
š
, 1);

341 ià(
num
 < 0) {

343 ià(
”ºo
 =ğ
EINTR
) {

346 
	`TRACE
(("leave ident_readln:„eadƒrror"))

349 ià(
num
 == 0) {

351 
	`TRACE
(("leave ident_readln: EOF"))

354 ià(
š
 == '\n') {

359 ià(
š
 != '\r') {

360 
buf
[
pos
] = 
š
;

361 
pos
++;

366 
buf
[
pos
] = '\0';

367 
	`TRACE
(("Ëavid’t_»adÊ:„‘uº %d", 
pos
+1))

368  
pos
+1;

369 
	}
}

371 
	$£nd_msg_ignÜe
() {

372 
	`CHECKCLEARTOWRITE
();

373 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_IGNORE
);

374 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "", 0);

375 
	`’üy±_·ck‘
();

376 
	}
}

380 
	$checktimeouts
() {

382 
time_t
 
now
;

384 
now
 = 
	`time
(
NULL
);

386 ià(
£s
.
cÚÃù_time
 !ğ0 && 
now
 - ses.cÚÃù_tim>ğ
AUTH_TIMEOUT
) {

387 
	`drİb—r_şo£
("Timeout before‡uth");

391 ià(
£s
.
»mÙeid’t
 =ğ
NULL
) {

395 ià(!
£s
.
kex¡©e
.
£Ákexš™


396 && (
now
 - 
£s
.
kex¡©e
.
Ï¡kextime
 >ğ
KEX_REKEY_TIMEOUT


397 || 
£s
.
kex¡©e
.
d©¬ecv
+£s.kex¡©e.
d©©¿ns
 >ğ
KEX_REKEY_DATA
)) {

398 
	`TRACE
(("rekeying‡fterimeout or max data„eached"))

399 
	`£nd_msg_kexš™
();

402 ià(
İts
.
k“·live_£cs
 > 0

403 && 
now
 - 
£s
.
Ï¡_Œx_·ck‘_time
 >ğ
İts
.
k“·live_£cs
) {

404 
	`£nd_msg_ignÜe
();

407 ià(
İts
.
idË_timeout_£cs
 > 0 && 
£s
.
Ï¡_·ck‘_time
 > 0

408 && 
now
 - 
£s
.
Ï¡_·ck‘_time
 >ğ
İts
.
idË_timeout_£cs
) {

409 
	`drİb—r_şo£
("Idleimeout");

411 
	}
}

413 
	$£Ëù_timeout
() {

416 
»t
 = 
LONG_MAX
;

417 ià(
KEX_REKEY_TIMEOUT
 > 0)

418 
»t
 = 
	`MIN
(
KEX_REKEY_TIMEOUT
,„et);

419 ià(
AUTH_TIMEOUT
 > 0)

420 
»t
 = 
	`MIN
(
AUTH_TIMEOUT
,„et);

421 ià(
İts
.
k“·live_£cs
 > 0)

422 
»t
 = 
	`MIN
(
İts
.
k“·live_£cs
,„et);

423 ià(
İts
.
idË_timeout_£cs
 > 0)

424 
»t
 = 
	`MIN
(
İts
.
idË_timeout_£cs
,„et);

425  
»t
;

426 
	}
}

428 cÚ¡ * 
	$g‘_u£r_sh–l
() {

430 ià(
£s
.
auth¡©e
.
pw_sh–l
[0] == '\0') {

433  
£s
.
auth¡©e
.
pw_sh–l
;

435 
	}
}

436 
	$fl_·sswd
(cÚ¡ * 
u£ºame
) {

437 
·sswd
 *
pw
 = 
NULL
;

438 ià(
£s
.
auth¡©e
.
pw_Çme
)

439 
	`m_ä“
(
£s
.
auth¡©e
.
pw_Çme
);

440 ià(
£s
.
auth¡©e
.
pw_dœ
)

441 
	`m_ä“
(
£s
.
auth¡©e
.
pw_dœ
);

442 ià(
£s
.
auth¡©e
.
pw_sh–l
)

443 
	`m_ä“
(
£s
.
auth¡©e
.
pw_sh–l
);

444 ià(
£s
.
auth¡©e
.
pw_·sswd
)

445 
	`m_ä“
(
£s
.
auth¡©e
.
pw_·sswd
);

447 
pw
 = 
	`g‘pwÇm
(
u£ºame
);

448 ià(!
pw
) {

452 ià(
pw
->
pw_·sswd
 =ğ
NULL
)

453 
pw
->
pw_·sswd
 = "";

454 
£s
.
auth¡©e
.
pw_uid
 = 
pw
->pw_uid;

455 
£s
.
auth¡©e
.
pw_gid
 = 
pw
->pw_gid;

456 
£s
.
auth¡©e
.
pw_Çme
 = 
	`m_¡rdup
(
pw
->pw_name);

457 
£s
.
auth¡©e
.
pw_dœ
 = 
	`m_¡rdup
(
pw
->pw_dir);

458 
£s
.
auth¡©e
.
pw_sh–l
 = 
	`m_¡rdup
(
pw
->pw_shell);

459 
£s
.
auth¡©e
.
pw_·sswd
 = 
	`m_¡rdup
(
pw
->pw_passwd);

460 
	}
}

	@compat.c

83 
	~"šşudes.h
"

85 #iâdeà
HAVE_GETUSERSHELL


86 **
	gcursh–l
, **
	gsh–ls
, *
	g¡ršgs
;

87 **
š™sh–ls
();

90 #iâdeà
HAVE_STRLCPY


93 
size_t
 
	$¡¾ıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
size
) {

95 
size_t
 
i
;

98 ià(
size
 < 1) {

102 
i
 = 0; i < 
size
-1; i++) {

103 ià(
¤c
[
i
] == '\0') {

106 
d¡
[
i
] = 
¤c
[i];

110 
d¡
[
i
] = '\0';

111  
	`¡¾’
(
¤c
);

113 
	}
}

116 #iâdeà
HAVE_STRLCAT


126 
size_t


127 
	$¡¾ÿt
(
d¡
, 
¤c
, 
siz
)

128 *
d¡
;

129 cÚ¡ *
¤c
;

130 
size_t
 
siz
;

132 *
d
 = 
d¡
;

133 cÚ¡ *
s
 = 
¤c
;

134 
size_t
 
n
 = 
siz
;

135 
size_t
 
dËn
;

138 
n
-- !ğ0 && *
d
 != '\0')

139 
d
++;

140 
dËn
 = 
d
 - 
d¡
;

141 
n
 = 
siz
 - 
dËn
;

143 ià(
n
 == 0)

144 (
dËn
 + 
	`¡¾’
(
s
));

145 *
s
 != '\0') {

146 ià(
n
 != 1) {

147 *
d
++ = *
s
;

148 
n
--;

150 
s
++;

152 *
d
 = '\0';

154 (
dËn
 + (
s
 - 
¤c
));

155 
	}
}

158 #iâdeà
HAVE_DAEMON


161 
	$d«mÚ
(
nochdœ
, 
noşo£
) {

163 
fd
;

165 
	`fÜk
()) {

171 
	`_ex™
(0);

174 ià(
	`£tsid
() == -1)

177 ià(!
nochdœ
)

178 ()
	`chdœ
("/");

180 ià(!
noşo£
 && (
fd
 = 
	`İ’
(
_PATH_DEVNULL
, 
O_RDWR
, 0)) != -1) {

181 ()
	`dup2
(
fd
, 
STDIN_FILENO
);

182 ()
	`dup2
(
fd
, 
STDOUT_FILENO
);

183 ()
	`dup2
(
fd
, 
STDERR_FILENO
);

184 ià(
fd
 > 
STDERR_FILENO
)

185 ()
	`şo£
(
fd
);

188 
	}
}

191 #iâdeà
HAVE_BASENAME


193 *
	$ba£Çme
(cÚ¡ *
·th
) {

195 *
foo
 = 
	`¡¼chr
(
·th
, '/');

196  ++
foo
;

197 
	}
}

201 #iâdeà
HAVE_GETUSERSHELL


206 * 
	$g‘u£rsh–l
() {

207 *
»t
;

209 ià(
cursh–l
 =ğ
NULL
)

210 
cursh–l
 = 
	`š™sh–ls
();

211 
»t
 = *
cursh–l
;

212 ià(
»t
 !ğ
NULL
)

213 
cursh–l
++;

214  (
»t
);

215 
	}
}

217 
	$’du£rsh–l
() {

219 ià(
sh–ls
 !ğ
NULL
)

220 
	`ä“
(
sh–ls
);

221 
sh–ls
 = 
NULL
;

222 ià(
¡ršgs
 !ğ
NULL
)

223 
	`ä“
(
¡ršgs
);

224 
¡ršgs
 = 
NULL
;

225 
cursh–l
 = 
NULL
;

226 
	}
}

228 
	$£tu£rsh–l
() {

229 
cursh–l
 = 
	`š™sh–ls
();

230 
	}
}

232 **
	$š™sh–ls
() {

234 cÚ¡ *
oksh–ls
[] = { "/bš/sh", "/bš/csh", 
NULL
 };

235 **
¥
, *
ı
;

236 
FILE
 *
å
;

237 
¡©
 
¡©b
;

238 
æ’
;

240 ià(
sh–ls
 !ğ
NULL
)

241 
	`ä“
(
sh–ls
);

242 
sh–ls
 = 
NULL
;

243 ià(
¡ršgs
 !ğ
NULL
)

244 
	`ä“
(
¡ršgs
);

245 
¡ršgs
 = 
NULL
;

246 ià((
å
 = 
	`fİ’
("/‘c/sh–ls", "rc")è=ğ
NULL
)

247  (**è
oksh–ls
;

248 ià(
	`f¡©
(
	`f’o
(
å
), &
¡©b
) == -1) {

249 ()
	`fşo£
(
å
);

250  (**è
oksh–ls
;

252 ià((
¡ršgs
 = 
	`m®loc
((
u_št
)
¡©b
.
¡_size
 + 1)è=ğ
NULL
) {

253 ()
	`fşo£
(
å
);

254  (**è
oksh–ls
;

256 
sh–ls
 = 
	`ÿÎoc
(()
¡©b
.
¡_size
 / 3,  (*));

257 ià(
sh–ls
 =ğ
NULL
) {

258 ()
	`fşo£
(
å
);

259 
	`ä“
(
¡ršgs
);

260 
¡ršgs
 = 
NULL
;

261  (**è
oksh–ls
;

263 
¥
 = 
sh–ls
;

264 
ı
 = 
¡ršgs
;

265 
æ’
 = 
¡©b
.
¡_size
;

266 
	`fg‘s
(
ı
, 
æ’
 - (ı - 
¡ršgs
), 
å
è!ğ
NULL
) {

267 *
ı
 != '#' && *cp != '/' && *cp != '\0')

268 
ı
++;

269 ià(*
ı
 == '#' || *cp == '\0')

271 *
¥
++ = 
ı
;

272 !
	`is¥aû
(*
ı
) && *cp != '#' && *cp != '\0')

273 
ı
++;

274 *
ı
++ = '\0';

276 *
¥
 = 
NULL
;

277 ()
	`fşo£
(
å
);

278  (
sh–ls
);

279 
	}
}

	@compat.h

25 #iâdeà
_COMPAT_H_


26 
	#_COMPAT_H_


	)

28 
	~"šşudes.h
"

30 #iâdeà
HAVE_STRLCPY


31 
size_t
 
¡¾ıy
(*
d¡
, cÚ¡ *
¤c
, size_ˆ
size
);

34 #iâdeà
HAVE_STRLCAT


35 
size_t
 
¡¾ÿt
(*
d¡
, cÚ¡ *
¤c
, size_ˆ
siz
);

38 #iâdeà
HAVE_DAEMON


39 
d«mÚ
(
nochdœ
, 
noşo£
);

42 #iâdeà
HAVE_BASENAME


43 *
ba£Çme
(cÚ¡ * 
·th
);

46 #iâdeà
HAVE_GETUSERSHELL


47 *
g‘u£rsh–l
();

48 
£tu£rsh–l
();

49 
’du£rsh–l
();

52 #iâdeà
_PATH_DEVNULL


53 
	#_PATH_DEVNULL
 "/dev/nuÎ"

	)

	@config.h

26 
	#DISABLE_LASTLOG
 1

	)

29 
	#DISABLE_PAM
 1

	)

41 
	#DISABLE_UTMP
 1

	)

44 
	#DISABLE_UTMPX
 1

	)

47 
	#DISABLE_WTMP
 1

	)

50 
	#DISABLE_WTMPX
 1

	)

53 
	#DISABLE_ZLIB
 1

	)

56 
	#HAVE_BASENAME
 1

	)

62 
	#HAVE_CONST_GAI_STRERROR_PROTO
 1

	)

68 
	#HAVE_DAEMON
 1

	)

74 
	#HAVE_DUP2
 1

	)

77 
	#HAVE_ENDUTENT
 1

	)

80 
	#HAVE_ENDUTXENT
 1

	)

83 
	#HAVE_FCNTL_H
 1

	)

86 
	#HAVE_FREEADDRINFO
 1

	)

89 
	#HAVE_GAI_STRERROR
 1

	)

92 
	#HAVE_GETADDRINFO
 1

	)

95 
	#HAVE_GETNAMEINFO
 1

	)

98 
	#HAVE_GETSPNAM
 1

	)

104 
	#HAVE_GETUTENT
 1

	)

107 
	#HAVE_GETUTID
 1

	)

110 
	#HAVE_GETUTLINE
 1

	)

113 
	#HAVE_GETUTXENT
 1

	)

116 
	#HAVE_GETUTXID
 1

	)

119 
	#HAVE_GETUTXLINE
 1

	)

122 
	#HAVE_INTTYPES_H
 1

	)

128 
	#HAVE_LASTLOG_H
 1

	)

143 
	#HAVE_LIMITS_H
 1

	)

149 
	#HAVE_LOGOUT
 1

	)

152 
	#HAVE_LOGWTMP
 1

	)

155 
	#HAVE_MEMORY_H
 1

	)

158 
	#HAVE_MEMSET
 1

	)

161 
	#HAVE_NETDB_H
 1

	)

164 
	#HAVE_NETINET_IN_H
 1

	)

170 
	#HAVE_NETINET_TCP_H
 1

	)

173 
	#HAVE_OPENPTY
 1

	)

179 
	#HAVE_PATHS_H
 1

	)

185 
	#HAVE_PUTENV
 1

	)

188 
	#HAVE_PUTUTLINE
 1

	)

191 
	#HAVE_PUTUTXLINE
 1

	)

197 
	#HAVE_SELECT
 1

	)

203 
	#HAVE_SETUTXENT
 1

	)

209 
	#HAVE_SOCKET
 1

	)

212 
	#HAVE_STDINT_H
 1

	)

215 
	#HAVE_STDLIB_H
 1

	)

218 
	#HAVE_STRDUP
 1

	)

221 
	#HAVE_STRINGS_H
 1

	)

224 
	#HAVE_STRING_H
 1

	)

233 
	#HAVE_STROPTS_H
 1

	)

236 
	#HAVE_STRUCT_ADDRINFO


	)

239 
	#HAVE_STRUCT_IN6_ADDR


	)

242 
	#HAVE_STRUCT_SOCKADDR_IN6


	)

245 
	#HAVE_STRUCT_SOCKADDR_STORAGE
 1

	)

248 
	#HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY
 1

	)

254 
	#HAVE_STRUCT_UTMPX_UT_ADDR_V6
 1

	)

257 
	#HAVE_STRUCT_UTMPX_UT_HOST
 1

	)

260 
	#HAVE_STRUCT_UTMPX_UT_ID
 1

	)

269 
	#HAVE_STRUCT_UTMPX_UT_TV
 1

	)

272 
	#HAVE_STRUCT_UTMPX_UT_TYPE
 1

	)

275 
	#HAVE_STRUCT_UTMP_UT_ADDR
 1

	)

278 
	#HAVE_STRUCT_UTMP_UT_ADDR_V6
 1

	)

281 
	#HAVE_STRUCT_UTMP_UT_EXIT
 1

	)

284 
	#HAVE_STRUCT_UTMP_UT_HOST
 1

	)

287 
	#HAVE_STRUCT_UTMP_UT_ID
 1

	)

290 
	#HAVE_STRUCT_UTMP_UT_PID
 1

	)

293 
	#HAVE_STRUCT_UTMP_UT_TIME
 1

	)

296 
	#HAVE_STRUCT_UTMP_UT_TV
 1

	)

299 
	#HAVE_STRUCT_UTMP_UT_TYPE
 1

	)

302 
	#HAVE_SYS_SELECT_H
 1

	)

305 
	#HAVE_SYS_SOCKET_H
 1

	)

308 
	#HAVE_SYS_STAT_H
 1

	)

311 
	#HAVE_SYS_TIME_H
 1

	)

314 
	#HAVE_SYS_TYPES_H
 1

	)

317 
	#HAVE_SYS_WAIT_H
 1

	)

320 
	#HAVE_TERMIOS_H
 1

	)

323 
	#HAVE_UINT16_T
 1

	)

326 
	#HAVE_UNISTD_H
 1

	)

329 
	#HAVE_UPDWTMP
 1

	)

344 
	#HAVE_UTMP_H
 1

	)

347 
	#HAVE_U_INT16_T
 1

	)

353 
	#PACKAGE_BUGREPORT
 ""

	)

356 
	#PACKAGE_NAME
 ""

	)

359 
	#PACKAGE_STRING
 ""

	)

362 
	#PACKAGE_TARNAME
 ""

	)

365 
	#PACKAGE_VERSION
 ""

	)

368 
	#RETSIGTYPE
 

	)

371 
	#SELECT_TYPE_ARG1
 

	)

374 
	#SELECT_TYPE_ARG234
 (
fd_£t
 *)

	)

377 
	#SELECT_TYPE_ARG5
 (
timev®
 *)

	)

380 
	#STDC_HEADERS
 1

	)

383 
	#TIME_WITH_SYS_TIME
 1

	)

389 
	#_FILE_OFFSET_BITS
 64

	)

	@dbmulti.c

25 
	~"šşudes.h
"

28 
drİb—r_maš
(
¬gc
, ** 
¬gv
);

29 
drİb—rkey_maš
(
¬gc
, ** 
¬gv
);

30 
drİb—rcÚv”t_maš
(
¬gc
, ** 
¬gv
);

31 
sı_maš
(
¬gc
, ** 
¬gv
);

33 
	$maš
(
¬gc
, ** 
¬gv
) {

35 * 
´ogÇme
;

37 ià(
¬gc
 > 0) {

39 
´ogÇme
 = 
	`ba£Çme
(
¬gv
[0]);

41 #ifdeà
DBMULTI_drİb—r


42 ià(
	`¡rcmp
(
´ogÇme
, "dropbear") == 0) {

43  
	`drİb—r_maš
(
¬gc
, 
¬gv
);

46 #ifdeà
DBMULTI_dbş›Á


47 ià(
	`¡rcmp
(
´ogÇme
, "dbclient") == 0

48 || 
	`¡rcmp
(
´ogÇme
, "ssh") == 0) {

49  
	`şi_maš
(
¬gc
, 
¬gv
);

52 #ifdeà
DBMULTI_drİb—rkey


53 ià(
	`¡rcmp
(
´ogÇme
, "dropbearkey") == 0) {

54  
	`drİb—rkey_maš
(
¬gc
, 
¬gv
);

57 #ifdeà
DBMULTI_drİb—rcÚv”t


58 ià(
	`¡rcmp
(
´ogÇme
, "dropbearconvert") == 0) {

59  
	`drİb—rcÚv”t_maš
(
¬gc
, 
¬gv
);

62 #ifdeà
DBMULTI_sı


63 ià(
	`¡rcmp
(
´ogÇme
, "scp") == 0) {

64  
	`sı_maš
(
¬gc
, 
¬gv
);

69 
	`årštf
(
¡d”r
, "Dropbear multi-purpose version %s\n"

71 #ifdeà
DBMULTI_drİb—r


74 #ifdeà
DBMULTI_dbş›Á


77 #ifdeà
DBMULTI_drİb—rkey


80 #ifdeà
DBMULTI_drİb—rcÚv”t


83 #ifdeà
DBMULTI_sı


87 
DROPBEAR_VERSION
);

88 
	`ex™
(1);

90 
	}
}

	@dbutil.c

51 
	~"šşudes.h
"

52 
	~"dbut.h
"

53 
	~"bufãr.h
"

54 
	~"£ssiÚ.h
"

55 
	~"©omicio.h
"

57 
	#MAX_FMT
 100

	)

59 
g’”ic_drİb—r_ex™
(
ex™code
, cÚ¡ * 
fÜm©
,

60 
va_li¡
 
·¿m
);

61 
g’”ic_drİb—r_log
(
´iÜ™y
, cÚ¡ * 
fÜm©
,

62 
va_li¡
 
·¿m
);

64 (*
_drİb—r_ex™
)(
ex™code
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
)

65 ğ
g’”ic_drİb—r_ex™
;

66 (*
_drİb—r_log
)(
´iÜ™y
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
)

67 ğ
g’”ic_drİb—r_log
;

69 #ifdeà
DEBUG_TRACE


70 
debug_Œaû
 = 0;

73 #iâdeà
DISABLE_SYSLOG


74 
	$¡¬tsy¦og
() {

76 
	`İ’log
(
PROGNAME
, 
LOG_PID
, 
LOG_AUTHPRIV
);

78 
	}
}

82 
	$drİb—r_şo£
(cÚ¡ * 
fÜm©
, ...) {

84 
va_li¡
 
·¿m
;

86 
	`va_¡¬t
(
·¿m
, 
fÜm©
);

87 
	`_drİb—r_ex™
(
EXIT_SUCCESS
, 
fÜm©
, 
·¿m
);

88 
	`va_’d
(
·¿m
);

90 
	}
}

92 
	$drİb—r_ex™
(cÚ¡ * 
fÜm©
, ...) {

94 
va_li¡
 
·¿m
;

96 
	`va_¡¬t
(
·¿m
, 
fÜm©
);

97 
	`_drİb—r_ex™
(
EXIT_FAILURE
, 
fÜm©
, 
·¿m
);

98 
	`va_’d
(
·¿m
);

99 
	}
}

101 
	$g’”ic_drİb—r_ex™
(
ex™code
, cÚ¡ * 
fÜm©
,

102 
va_li¡
 
·¿m
) {

104 
fmtbuf
[300];

106 
	`¢´štf
(
fmtbuf
, (fmtbuf), "Ex™ed: %s", 
fÜm©
);

108 
	`_drİb—r_log
(
LOG_INFO
, 
fmtbuf
, 
·¿m
);

110 
	`ex™
(
ex™code
);

111 
	}
}

113 
	$ç_as£¹
(cÚ¡ * 
ex´
, cÚ¡ * 
fe
, 
lše
) {

114 
	`drİb—r_ex™
("Faed‡s£¹iÚ (%s:%d): `%s'", 
fe
, 
lše
, 
ex´
);

115 
	}
}

117 
g’”ic_drİb—r_log
(
UNUSED
(
´iÜ™y
), cÚ¡ * 
fÜm©
,

118 
va_li¡
 
·¿m
) {

120 
	g´štbuf
[1024];

122 
v¢´štf
(
´štbuf
, Õrštbuf), 
fÜm©
, 
·¿m
);

124 
årštf
(
¡d”r
, "%s\n", 
´štbuf
);

129 
	$drİb—r_log
(
´iÜ™y
, cÚ¡ * 
fÜm©
, ...) {

131 
va_li¡
 
·¿m
;

133 
	`va_¡¬t
(
·¿m
, 
fÜm©
);

134 
	`_drİb—r_log
(
´iÜ™y
, 
fÜm©
, 
·¿m
);

135 
	`va_’d
(
·¿m
);

136 
	}
}

139 #ifdeà
DEBUG_TRACE


140 
	$drİb—r_Œaû
(cÚ¡ * 
fÜm©
, ...) {

142 
va_li¡
 
·¿m
;

144 ià(!
debug_Œaû
) {

148 
	`va_¡¬t
(
·¿m
, 
fÜm©
);

149 
	`årštf
(
¡d”r
, "TRACE (%d): ", 
	`g‘pid
());

150 
	`vårštf
(
¡d”r
, 
fÜm©
, 
·¿m
);

151 
	`årštf
(
¡d”r
, "\n");

152 
	`va_’d
(
·¿m
);

153 
	}
}

156 
	$£t_sock_´iÜ™y
(
sock
) {

158 
v®
;

161 
v®
 = 1;

162 
	`£tsockİt
(
sock
, 
IPPROTO_TCP
, 
TCP_NODELAY
, (*)&
v®
, (val));

166 #ifdeà
IPTOS_LOWDELAY


167 
v®
 = 
IPTOS_LOWDELAY
;

168 
	`£tsockİt
(
sock
, 
IPPROTO_IP
, 
IP_TOS
, (*)&
v®
, (val));

171 #ifdeà
SO_PRIORITY


174 
v®
 = 6;

175 
	`£tsockİt
(
sock
, 
SOL_SOCKET
, 
SO_PRIORITY
, (*è&
v®
, (val));

178 
	}
}

186 
	$drİb—r_li¡’
(cÚ¡ * 
add»ss
, cÚ¡ * 
pÜt
,

187 *
socks
, 
sockcouÁ
, **
”r¡ršg
, *
maxfd
) {

189 
addršfo
 
hšts
, *
»s
 = 
NULL
, *
»s0
 = NULL;

190 
”r
;

191 
nsock
;

192 
lšg”
†inger;

193 
v®
;

194 
sock
;

196 
	`TRACE
(("enter dropbear_listen"))

198 
	`mem£t
(&
hšts
, 0, (hints));

199 
hšts
.
ai_çmy
 = 
AF_UNSPEC
;

200 
hšts
.
ai_sockty³
 = 
SOCK_STREAM
;

206 ià(!
add»ss
) {

207 
	`TRACE
(("dropbear_listen:†ocal†oopback"))

209 ià(
add»ss
[0] == '\0') {

210 
	`TRACE
(("dropbear_listen:‡ll interfaces"))

211 
add»ss
 = 
NULL
;

213 
hšts
.
ai_æags
 = 
AI_PASSIVE
;

215 
”r
 = 
	`g‘addršfo
(
add»ss
, 
pÜt
, &
hšts
, &
»s0
);

217 ià(
”r
) {

218 ià(
”r¡ršg
 !ğ
NULL
 && *errstring == NULL) {

219 
Ën
;

220 
Ën
 = 20 + 
	`¡¾’
(
	`gai_¡»¼Ü
(
”r
));

221 *
”r¡ršg
 = (*)
	`m_m®loc
(
Ën
);

222 
	`¢´štf
(*
”r¡ršg
, 
Ën
, "E¼Ü„esŞvšg: %s", 
	`gai_¡»¼Ü
(
”r
));

224 ià(
»s0
) {

225 
	`ä“addršfo
(
»s0
);

226 
»s0
 = 
NULL
;

228 
	`TRACE
(("leave dropbear_listen: failed„esolving"))

233 
nsock
 = 0;

234 
»s
 = 
»s0
;„e !ğ
NULL
 && 
nsock
 < 
sockcouÁ
;

235 
»s
 =„es->
ai_Ãxt
) {

238 
socks
[
nsock
] = 
	`sock‘
(
»s
->
ai_çmy
,„es->
ai_sockty³
,

239 
»s
->
ai_´ÙocŞ
);

241 
sock
 = 
socks
[
nsock
];

243 ià(
sock
 < 0) {

244 
”r
 = 
”ºo
;

245 
	`TRACE
(("socket() failed"))

250 
v®
 = 1;

252 
	`£tsockİt
(
sock
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (*è&
v®
, (val));

253 
lšg”
.
l_Úoff
 = 1;

254 
lšg”
.
l_lšg”
 = 5;

255 
	`£tsockİt
(
sock
, 
SOL_SOCKET
, 
SO_LINGER
, (*)&
lšg”
, (linger));

257 
	`£t_sock_´iÜ™y
(
sock
);

259 ià(
	`bšd
(
sock
, 
»s
->
ai_addr
,„es->
ai_add¾’
) < 0) {

260 
”r
 = 
”ºo
;

261 
	`şo£
(
sock
);

262 
	`TRACE
(("bšd(%sèçed", 
pÜt
))

266 ià(
	`li¡’
(
sock
, 20) < 0) {

267 
”r
 = 
”ºo
;

268 
	`şo£
(
sock
);

269 
	`TRACE
(("listen() failed"))

273 *
maxfd
 = 
	`MAX
(*maxfd, 
sock
);

275 
nsock
++;

278 ià(
»s0
) {

279 
	`ä“addršfo
(
»s0
);

280 
»s0
 = 
NULL
;

283 ià(
nsock
 == 0) {

284 ià(
”r¡ršg
 !ğ
NULL
 && *errstring == NULL) {

285 
Ën
;

286 
Ën
 = 20 + 
	`¡¾’
(
	`¡»¼Ü
(
”r
));

287 *
”r¡ršg
 = (*)
	`m_m®loc
(
Ën
);

288 
	`¢´štf
(*
”r¡ršg
, 
Ën
, "E¼Ü†i¡’šg: %s", 
	`¡»¼Ü
(
”r
));

290 
	`TRACE
(("Ëavdrİb—r_li¡’: fau», %s", 
	`¡»¼Ü
(
”r
)))

294 
	`TRACE
(("Ëavdrİb—r_li¡’: sucûss, %d sock bound", 
nsock
))

295  
nsock
;

296 
	}
}

299 #ifdeà
ENABLE_CONNECT_UNIX


300 
	$cÚÃù_unix
(cÚ¡ * 
·th
) {

301 
sockaddr_un
 
addr
;

302 
fd
 = -1;

304 
	`mem£t
((*)&
addr
, 0x0, (addr));

305 
addr
.
sun_çmy
 = 
AF_UNIX
;

306 
	`¡¾ıy
(
addr
.
sun_·th
, 
·th
, (addr.sun_path));

307 
fd
 = 
	`sock‘
(
PF_UNIX
, 
SOCK_STREAM
, 0);

308 ià(
fd
 < 0) {

309 
	`TRACE
(("Failedo open unix socket"))

312 ià(
	`cÚÃù
(
fd
, (
sockaddr
*)&
addr
, (addr)) < 0) {

313 
	`TRACE
(("FaedØcÚÃùØ'%s' sock‘", 
·th
))

316  
fd
;

317 
	}
}

325 
	$cÚÃù_»mÙe
(cÚ¡ * 
»mÙeho¡
, cÚ¡ * 
»mÙ•Üt
,

326 
nÚblockšg
, ** 
”r¡ršg
) {

328 
addršfo
 *
»s0
 = 
NULL
, *
»s
 = NULL, 
hšts
;

329 
sock
;

330 
”r
;

332 
	`TRACE
(("enter connect_remote"))

334 ià(
”r¡ršg
 !ğ
NULL
) {

335 *
”r¡ršg
 = 
NULL
;

338 
	`mem£t
(&
hšts
, 0, (hints));

339 
hšts
.
ai_sockty³
 = 
SOCK_STREAM
;

340 
hšts
.
ai_çmy
 = 
PF_UNSPEC
;

342 
”r
 = 
	`g‘addršfo
(
»mÙeho¡
, 
»mÙ•Üt
, &
hšts
, &
»s0
);

343 ià(
”r
) {

344 ià(
”r¡ršg
 !ğ
NULL
 && *errstring == NULL) {

345 
Ën
;

346 
Ën
 = 100 + 
	`¡¾’
(
	`gai_¡»¼Ü
(
”r
));

347 *
”r¡ršg
 = (*)
	`m_m®loc
(
Ën
);

348 
	`¢´štf
(*
”r¡ršg
, 
Ën
, "Error„esolving '%s'…ort '%s'. %s",

349 
»mÙeho¡
, 
»mÙ•Üt
, 
	`gai_¡»¼Ü
(
”r
));

351 
	`TRACE
(("E¼Ü„esŞvšg: %s", 
	`gai_¡»¼Ü
(
”r
)))

355 
sock
 = -1;

356 
”r
 = 
EADDRNOTAVAIL
;

357 
»s
 = 
»s0
;„es;„e ğ»s->
ai_Ãxt
) {

359 
sock
 = 
	`sock‘
(
»s
->
ai_çmy
,„es->
ai_sockty³
,„es->
ai_´ÙocŞ
);

360 ià(
sock
 < 0) {

361 
”r
 = 
”ºo
;

365 ià(
nÚblockšg
) {

366 
	`£ŠÚblockšg
(
sock
);

369 ià(
	`cÚÃù
(
sock
, 
»s
->
ai_addr
,„es->
ai_add¾’
) < 0) {

370 ià(
”ºo
 =ğ
EINPROGRESS
 && 
nÚblockšg
) {

371 
	`TRACE
(("Connect in…rogress"))

374 
”r
 = 
”ºo
;

375 
	`şo£
(
sock
);

376 
sock
 = -1;

384 ià(
sock
 < 0 && !(
”ºo
 =ğ
EINPROGRESS
 && 
nÚblockšg
)) {

386 ià(
”r¡ršg
 !ğ
NULL
 && *errstring == NULL) {

387 
Ën
;

388 
Ën
 = 20 + 
	`¡¾’
(
	`¡»¼Ü
(
”r
));

389 *
”r¡ršg
 = (*)
	`m_m®loc
(
Ën
);

390 
	`¢´štf
(*
”r¡ršg
, 
Ën
, "E¼Ü cÚÃùšg: %s", 
	`¡»¼Ü
(
”r
));

392 
	`TRACE
(("E¼Ü cÚÃùšg: %s", 
	`¡»¼Ü
(
”r
)))

395 
	`£t_sock_´iÜ™y
(
sock
);

398 
	`ä“addršfo
(
»s0
);

399 ià(
sock
 > 0 && 
”r¡ršg
 !ğ
NULL
 && *errstring != NULL) {

400 
	`m_ä“
(*
”r¡ršg
);

403 
	`TRACE
(("ËavcÚÃù_»mÙe: sock %d\n", 
sock
))

404  
sock
;

405 
	}
}

412 
¥awn_commªd
((*
exec_â
)(*
u£r_d©a
), *
exec_d©a
,

413 *
»t_wr™efd
, *
»t_»adfd
, *
»t_”rfd
, 
pid_t
 *
»t_pid
) {

414 
šfds
[2];

415 
outfds
[2];

416 
”rfds
[2];

417 
pid_t
 
pid
;

419 cÚ¡ 
FDIN
 = 0;

420 cÚ¡ 
FDOUT
 = 1;

423 ià(
	`pe
(
šfds
) != 0) {

424  
DROPBEAR_FAILURE
;

426 ià(
	`pe
(
outfds
) != 0) {

427  
DROPBEAR_FAILURE
;

429 ià(
»t_”rfd
 && 
	`pe
(
”rfds
) != 0) {

430  
DROPBEAR_FAILURE
;

433 #ifdeà
__uClšux__


434 
pid
 = 
	`vfÜk
();

436 
pid
 = 
	`fÜk
();

439 ià(
pid
 < 0) {

440  
DROPBEAR_FAILURE
;

443 ià(!
pid
) {

446 
	`TRACE
(("backo‚ormal sigchld"))

448 ià(
	`sigÇl
(
SIGCHLD
, 
SIG_DFL
è=ğ
SIG_ERR
) {

449 
	`drİb—r_ex™
("signal()ƒrror");

454 ià((
	`dup2
(
šfds
[
FDIN
], 
STDIN_FILENO
) < 0) ||

455 (
	`dup2
(
outfds
[
FDOUT
], 
STDOUT_FILENO
) < 0) ||

456 (
»t_”rfd
 && 
	`dup2
(
”rfds
[
FDOUT
], 
STDERR_FILENO
) < 0)) {

457 
	`TRACE
(("leave‚optycommand:ƒrror„edirecting FDs"))

458 
	`drİb—r_ex™
("Child dup2() failure");

461 
	`şo£
(
šfds
[
FDOUT
]);

462 
	`şo£
(
šfds
[
FDIN
]);

463 
	`şo£
(
outfds
[
FDIN
]);

464 
	`şo£
(
outfds
[
FDOUT
]);

465 ià(
»t_”rfd
)

467 
	`şo£
(
”rfds
[
FDIN
]);

468 
	`şo£
(
”rfds
[
FDOUT
]);

471 
	`exec_â
(
exec_d©a
);

473  
DROPBEAR_FAILURE
;

476 
	`şo£
(
šfds
[
FDIN
]);

477 
	`şo£
(
outfds
[
FDOUT
]);

479 
	`£ŠÚblockšg
(
outfds
[
FDIN
]);

480 
	`£ŠÚblockšg
(
šfds
[
FDOUT
]);

482 ià(
»t_”rfd
) {

483 
	`şo£
(
”rfds
[
FDOUT
]);

484 
	`£ŠÚblockšg
(
”rfds
[
FDIN
]);

487 ià(
»t_pid
) {

488 *
»t_pid
 = 
pid
;

491 *
»t_wr™efd
 = 
šfds
[
FDOUT
];

492 *
»t_»adfd
 = 
outfds
[
FDIN
];

493 ià(
»t_”rfd
) {

494 *
»t_”rfd
 = 
”rfds
[
FDIN
];

496  
DROPBEAR_SUCCESS
;

498 
	}
}

503 
	$run_sh–l_commªd
(cÚ¡ * 
cmd
, 
maxfd
, * 
u£rsh–l
) {

504 * 
¬gv
[4];

505 * 
ba£sh–l
 = 
NULL
;

506 
i
;

508 
ba£sh–l
 = 
	`ba£Çme
(
u£rsh–l
);

510 ià(
cmd
 !ğ
NULL
) {

511 
¬gv
[0] = 
ba£sh–l
;

514 
Ën
 = 
	`¡¾’
(
ba£sh–l
) + 2;

515 
¬gv
[0] = (*)
	`m_m®loc
(
Ën
);

516 
	`¢´štf
(
¬gv
[0], 
Ën
, "-%s", 
ba£sh–l
);

519 ià(
cmd
 !ğ
NULL
) {

520 
¬gv
[1] = "-c";

521 
¬gv
[2] = (*)
cmd
;

522 
¬gv
[3] = 
NULL
;

525 
¬gv
[1] = 
NULL
;

529 ià(
	`sigÇl
(
SIGPIPE
, 
SIG_DFL
è=ğ
SIG_ERR
) {

530 
	`drİb—r_ex™
("signal()ƒrror");

536 #ifdeà
ANDROID_CHANGES


538 *
pws
 = 
	`g‘’v
("ANDROID_PROPERTY_WORKSPACE");

539 
pws_fd
 = 0;

540 ià(
pws
) {

541 *
pws2
 = 
	`¡rdup
(
pws
);

542 *
comma
 = 
	`¡rchr
(
pws2
, ',');

543 ià(
comma
) {

544 *
comma
 = '\0';

545 
pws_fd
 = 
	`©oi
(
pws2
);

547 
	`ä“
(
pws2
);

551 
i
 = 3; i <ğ
maxfd
; i++) {

552 #ifdeà
ANDROID_CHANGES


553 ià(
i
 !ğ
pws_fd
)

555 
	`m_şo£
(
i
);

558 
	`execv
(
u£rsh–l
, 
¬gv
);

559 
	}
}

561 
	$g‘_sock‘_add»ss
(
fd
, **
loÿl_ho¡
, **
loÿl_pÜt
,

562 **
»mÙe_ho¡
, **
»mÙe_pÜt
, 
ho¡_lookup
)

564 
sockaddr_¡Üage
 
addr
;

565 
sockËn_t
 
add¾’
;

567 ià(
loÿl_ho¡
 || 
loÿl_pÜt
) {

568 
add¾’
 = (
addr
);

569 ià(
	`g‘sockÇme
(
fd
, (
sockaddr
*)&
addr
, &
add¾’
) < 0) {

570 
	`drİb—r_ex™
("Faed sock‘‡dd»ss: %s", 
	`¡»¼Ü
(
”ºo
));

572 
	`g‘addr¡ršg
(&
addr
, 
loÿl_ho¡
, 
loÿl_pÜt
, 
ho¡_lookup
);

574 ià(
»mÙe_ho¡
 || 
»mÙe_pÜt
) {

575 
add¾’
 = (
addr
);

576 ià(
	`g‘³”Çme
(
fd
, (
sockaddr
*)&
addr
, &
add¾’
) < 0) {

577 
	`drİb—r_ex™
("Faed sock‘‡dd»ss: %s", 
	`¡»¼Ü
(
”ºo
));

579 
	`g‘addr¡ršg
(&
addr
, 
»mÙe_ho¡
, 
»mÙe_pÜt
, 
ho¡_lookup
);

581 
	}
}

585 
	$g‘addr¡ršg
(
sockaddr_¡Üage
* 
addr
,

586 **
»t_ho¡
, **
»t_pÜt
,

587 
ho¡_lookup
) {

589 
ho¡
[
NI_MAXHOST
+1], 
£rv
[
NI_MAXSERV
+1];

590 
Ën
;

591 
»t
;

593 
æags
 = 
NI_NUMERICSERV
 | 
NI_NUMERICHOST
;

595 #iâdeà
DO_HOST_LOOKUP


596 
ho¡_lookup
 = 0;

599 ià(
ho¡_lookup
) {

600 
æags
 = 
NI_NUMERICSERV
;

603 
Ën
 = (
sockaddr_¡Üage
);

608 #ifdeà
HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY


609 ià(
addr
->
ss_çmy
 =ğ
AF_INET
) {

610 
Ën
 = (
sockaddr_š
);

612 #ifdeà
AF_INET6


613 ià(
addr
->
ss_çmy
 =ğ
AF_INET6
) {

614 
Ën
 = (
sockaddr_š6
);

619 
»t
 = 
	`g‘Çmešfo
((
sockaddr
*)
addr
, 
Ën
, 
ho¡
, (host)-1,

620 
£rv
, (£rv)-1, 
æags
);

622 ià(
»t
 != 0) {

623 ià(
ho¡_lookup
) {

627 
	`g‘addr¡ršg
(
addr
, 
»t_ho¡
, 
»t_pÜt
, 0);

631 
	`drİb—r_ex™
("Faed†ookup: %s", 
	`gai_¡»¼Ü
(
»t
));

635 ià(
»t_ho¡
) {

636 *
»t_ho¡
 = 
	`m_¡rdup
(
ho¡
);

638 ià(
»t_pÜt
) {

639 *
»t_pÜt
 = 
	`m_¡rdup
(
£rv
);

641 
	}
}

643 #ifdeà
DEBUG_TRACE


644 
	$´šthex
(cÚ¡ * 
Ïb–
, cÚ¡ * 
buf
, 
Ën
) {

646 
i
;

648 
	`årštf
(
¡d”r
, "%s\n", 
Ïb–
);

649 
i
 = 0; i < 
Ën
; i++) {

650 
	`årštf
(
¡d”r
, "%02x", 
buf
[
i
]);

651 ià(
i
 % 16 == 15) {

652 
	`årštf
(
¡d”r
, "\n");

654 ià(
i
 % 2 == 1) {

655 
	`årštf
(
¡d”r
, " ");

658 
	`årštf
(
¡d”r
, "\n");

659 
	}
}

666 * 
	$¡rcÚŒŞ
(cÚ¡ * 
‹xt
) {

668 * 
»t
;

669 
Ën
, 
pos
;

670 
i
;

672 
Ën
 = 
	`¡¾’
(
‹xt
);

673 
»t
 = 
	`m_m®loc
(
Ën
+1);

675 
pos
 = 0;

676 
i
 = 0; i < 
Ën
; i++) {

677 ià((
‹xt
[
i
] <= '~' &&ext[i] >= ' ')

678 || 
‹xt
[
i
] == '\n' ||ext[i] == '\r' ||ext[i] == '\t') {

679 
»t
[
pos
] = 
‹xt
[
i
];

680 
pos
++;

683 
»t
[
pos
] = 0x0;

684  
»t
;

685 
	}
}

691 
	$buf_»adfe
(
bufãr
* 
buf
, cÚ¡ * 
f’ame
) {

693 
fd
 = -1;

694 
Ën
;

695 
maxËn
;

696 
»t
 = 
DROPBEAR_FAILURE
;

698 
fd
 = 
	`İ’
(
f’ame
, 
O_RDONLY
);

700 ià(
fd
 < 0) {

701 
out
;

705 
maxËn
 = 
buf
->
size
 - buf->
pos
;

706 
Ën
 = 
	`»ad
(
fd
, 
	`buf_g‘wr™•Œ
(
buf
, 
maxËn
), maxlen);

707 ià(
Ën
 < 0) {

708 ià(
”ºo
 =ğ
EINTR
 ||ƒ¼nØ=ğ
EAGAIN
) {

711 
out
;

713 
	`buf_šüwr™•os
(
buf
, 
Ën
);

714 } 
Ën
 < 
maxËn
 &&†en > 0);

716 
»t
 = 
DROPBEAR_SUCCESS
;

718 
out
:

719 ià(
fd
 >= 0) {

720 
	`m_şo£
(
fd
);

722  
»t
;

723 
	}
}

729 #ià
defšed
(
DROPBEAR_CLIENT
è|| defšed(
ENABLE_SVR_PUBKEY_AUTH
)

730 
	$buf_g‘lše
(
bufãr
 * 
lše
, 
FILE
 * 
authfe
) {

732 
c
 = 
EOF
;

734 
	`TRACE
(("enter buf_getline"))

736 
	`buf_£os
(
lše
, 0);

737 
	`buf_£’
(
lše
, 0);

739 
lše
->
pos
 <†še->
size
) {

741 
c
 = 
	`fg‘c
(
authfe
);

742 ià(
c
 =ğ
EOF
 || c == '\n' || c == '\r') {

743 
out
;

746 
	`buf_putby‹
(
lše
, ()
c
);

749 
	`TRACE
(("leave getauthline:†ineoo†ong"))

752 
	`buf_£’
(
lše
, 0);

754 
out
:

758 ià(
c
 =ğ
EOF
 && 
lše
->
pos
 == 0) {

759 
	`TRACE
(("leave buf_getline: failure"))

760  
DROPBEAR_FAILURE
;

762 
	`TRACE
(("leave buf_getline: success"))

763 
	`buf_£os
(
lše
, 0);

764  
DROPBEAR_SUCCESS
;

767 
	}
}

771 
	$m_şo£
(
fd
) {

773 
v®
;

775 
v®
 = 
	`şo£
(
fd
);

776 } 
v®
 < 0 && 
”ºo
 =ğ
EINTR
);

778 ià(
v®
 < 0 && 
”ºo
 !ğ
EBADF
) {

780 
	`drİb—r_ex™
("E¼Ü closšg fd %d, %s", 
fd
, 
	`¡»¼Ü
(
”ºo
));

782 
	}
}

784 * 
	$m_m®loc
(
size_t
 
size
) {

786 * 
»t
;

788 ià(
size
 == 0) {

789 
	`drİb—r_ex™
("m_malloc failed");

791 
»t
 = 
	`ÿÎoc
(1, 
size
);

792 ià(
»t
 =ğ
NULL
) {

793 
	`drİb—r_ex™
("m_malloc failed");

795  
»t
;

797 
	}
}

799 * 
	$m_¡rdup
(cÚ¡ * 
¡r
) {

800 * 
»t
;

802 
»t
 = 
	`¡rdup
(
¡r
);

803 ià(
»t
 =ğ
NULL
) {

804 
	`drİb—r_ex™
("m_strdup failed");

806  
»t
;

807 
	}
}

809 
	$__m_ä“
(* 
±r
) {

810 ià(
±r
 !ğ
NULL
) {

811 
	`ä“
(
±r
);

813 
	}
}

815 * 
	$m_»®loc
(* 
±r
, 
size_t
 
size
) {

817 *
»t
;

819 ià(
size
 == 0) {

820 
	`drİb—r_ex™
("m_realloc failed");

822 
»t
 = 
	`»®loc
(
±r
, 
size
);

823 ià(
»t
 =ğ
NULL
) {

824 
	`drİb—r_ex™
("m_realloc failed");

826  
»t
;

827 
	}
}

833 
	$m_buº
(*
d©a
, 
Ën
) {

834 vŞ©*
p
 = 
d©a
;

836 ià(
d©a
 =ğ
NULL
)

838 
Ën
--) {

839 *
p
++ = 0x66;

841 
	}
}

844 
	$£ŠÚblockšg
(
fd
) {

846 
	`TRACE
(("£ŠÚblockšg: %d", 
fd
))

848 ià(
	`fú
(
fd
, 
F_SETFL
, 
O_NONBLOCK
) < 0) {

849 ià(
”ºo
 =ğ
ENODEV
) {

852 
	`TRACE
(("ignoring ENODEV for setnonblocking"))

854 
	`drİb—r_ex™
("Couldn't set‚onblocking");

857 
	`TRACE
(("leave setnonblocking"))

858 
	}
}

860 
	$di§Îow_cÜe
() {

861 
¾im™
 
lim
;

862 
lim
.
¾im_cur
 =†im.
¾im_max
 = 0;

863 
	`£Œlim™
(
RLIMIT_CORE
, &
lim
);

864 
	}
}

867 
	$m_¡r_to_ušt
(cÚ¡ * 
¡r
, *
v®
) {

868 
”ºo
 = 0;

869 *
v®
 = 
	`¡¹oul
(
¡r
, 
NULL
, 10);

872 ià((*
v®
 =ğ0 && 
”ºo
 =ğ
EINVAL
)

873 || (*
v®
 =ğ
ULONG_MAX
 && 
”ºo
 =ğ
ERANGE
)) {

874  
DROPBEAR_FAILURE
;

876  
DROPBEAR_SUCCESS
;

878 
	}
}

	@dbutil.h

25 #iâdeà
_DBUTIL_H_


27 
	#_DBUTIL_H_


	)

29 
	~"šşudes.h
"

30 
	~"bufãr.h
"

32 #iâdeà
DISABLE_SYSLOG


33 
¡¬tsy¦og
();

36 (*
_drİb—r_ex™
)(
ex™code
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
);

37 (*
_drİb—r_log
)(
´iÜ™y
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
);

39 
	`drİb—r_ex™
(cÚ¡ * 
fÜm©
, ...);

40 
	`drİb—r_şo£
(cÚ¡ * 
fÜm©
, ...);

41 
	`drİb—r_log
(
´iÜ™y
, cÚ¡ * 
fÜm©
, ...);

42 
	`ç_as£¹
(cÚ¡ * 
ex´
, cÚ¡ * 
fe
, 
lše
);

43 #ifdeà
DEBUG_TRACE


44 
	`drİb—r_Œaû
(cÚ¡ * 
fÜm©
, ...);

45 
	`´šthex
(cÚ¡ * 
Ïb–
, cÚ¡ * 
buf
, 
Ën
);

46 
debug_Œaû
;

48 * 
	`¡rcÚŒŞ
(cÚ¡ * 
‹xt
);

49 
	`g‘_sock‘_add»ss
(
fd
, **
loÿl_ho¡
, **
loÿl_pÜt
,

50 **
»mÙe_ho¡
, **
»mÙe_pÜt
, 
ho¡_lookup
);

51 
	`g‘addr¡ršg
(
sockaddr_¡Üage
* 
addr
,

52 **
»t_ho¡
, **
»t_pÜt
, 
ho¡_lookup
);

53 
	`drİb—r_li¡’
(cÚ¡ * 
add»ss
, cÚ¡ * 
pÜt
,

54 *
socks
, 
sockcouÁ
, **
”r¡ršg
, *
maxfd
);

55 
	`¥awn_commªd
((*
exec_â
)(*
u£r_d©a
), *
exec_d©a
,

56 *
wr™efd
, *
»adfd
, *
”rfd
, 
pid_t
 *
pid
);

57 
	`run_sh–l_commªd
(cÚ¡ * 
cmd
, 
maxfd
, * 
u£rsh–l
);

58 #ifdeà
ENABLE_CONNECT_UNIX


59 
	`cÚÃù_unix
(cÚ¡ * 
addr
);

61 
	`cÚÃù_»mÙe
(cÚ¡ * 
»mÙeho¡
, cÚ¡ * 
»mÙ•Üt
,

62 
nÚblockšg
, ** 
”r¡ršg
);

63 
	`buf_»adfe
(
bufãr
* 
buf
, cÚ¡ * 
f’ame
);

64 
	`buf_g‘lše
(
bufãr
 * 
lše
, 
FILE
 * 
authfe
);

66 
	`m_şo£
(
fd
);

67 * 
	`m_m®loc
(
size_t
 
size
);

68 * 
	`m_¡rdup
(cÚ¡ * 
¡r
);

69 * 
	`m_»®loc
(* 
±r
, 
size_t
 
size
);

70 
	#m_ä“
(
X
è
	`__m_ä“
(X); (Xèğ
NULL
;

	)

71 
	`__m_ä“
(* 
±r
);

72 
	`m_buº
(* 
d©a
, 
Ën
);

73 
	`£ŠÚblockšg
(
fd
);

74 
	`di§Îow_cÜe
();

75 
	`m_¡r_to_ušt
(cÚ¡ * 
¡r
, *
v®
);

78 
	#DEF_MP_INT
(
X
è
mp_št
 X = {0, 0, 0, 
NULL
}

81 
	#drİb—r_as£¹
(
X
èdØ{ ià(!(X)è{ 
	`ç_as£¹
(#X, 
__FILE__
, 
__LINE__
); } } 0)

	)

	@debug.h

25 #iâdeà
_DEBUG_H_


26 
	#_DEBUG_H_


	)

28 
	~"šşudes.h
"

42 
	#DEBUG_TRACE


	)

50 
	#CHECKCLEARTOWRITE
()

	)

64 #ifdeà
DEBUG_TRACE


65 
	#TRACE
(
X
è
drİb—r_Œaû
 X;

	)

67 
	#TRACE
(
X
)

	)

79 
	#DEBUG_HACKCRYPT
 "hL8ÄFDt0aJ3E"

	)

	@dropbearconvert.c

26 
	~"šşudes.h
"

27 
	~"signkey.h
"

28 
	~"bufãr.h
"

29 
	~"dbut.h
"

30 
	~"keyimpÜt.h
"

33 
do_cÚv”t
(
šty³
, cÚ¡ * 
šfe
, 
ou‰y³
,

34 cÚ¡ * 
outfe
);

36 
´šth–p
(* 
´ogÇme
);

38 
	$´šth–p
(* 
´ogÇme
) {

40 
	`årštf
(
¡d”r
, "Usage: %s <inputtype> <outputtype> <inputfile> <outputfile>\n\n"

51 
´ogÇme
);

52 
	}
}

54 #ià
defšed
(
DBMULTI_drİb—rcÚv”t
è|| !defšed(
DROPBEAR_MULTI
)

55 #ià
defšed
(
DBMULTI_drİb—rcÚv”t
è&& defšed(
DROPBEAR_MULTI
)

56 
	$drİb—rcÚv”t_maš
(
¬gc
, ** 
¬gv
) {

58 
	$maš
(
¬gc
, ** 
¬gv
) {

61 
šty³
, 
ou‰y³
;

62 cÚ¡ * 
šfe
;

63 cÚ¡ * 
outfe
;

65 #ifdeà
DEBUG_TRACE


67 
debug_Œaû
 = 1;

71 ià(
¬gc
 != 5) {

72 
	`årštf
(
¡d”r
, "All‡rguments must be specified\n");

73 
u§ge
;

77 ià(
¬gv
[1][0] == 'd') {

78 
šty³
 = 
KEYFILE_DROPBEAR
;

79 } ià(
¬gv
[1][0] == 'o') {

80 
šty³
 = 
KEYFILE_OPENSSH
;

82 
	`årštf
(
¡d”r
, "Invalid input keyype\n");

83 
u§ge
;

87 ià(
¬gv
[2][0] == 'd') {

88 
ou‰y³
 = 
KEYFILE_DROPBEAR
;

89 } ià(
¬gv
[2][0] == 'o') {

90 
ou‰y³
 = 
KEYFILE_OPENSSH
;

92 
	`årštf
(
¡d”r
, "Invalid output keyype\n");

93 
u§ge
;

97 
	`umask
(077);

99 
šfe
 = 
¬gv
[3];

100 
outfe
 = 
¬gv
[4];

102  
	`do_cÚv”t
(
šty³
, 
šfe
, 
ou‰y³
, 
outfe
);

104 
u§ge
:

105 
	`´šth–p
(
¬gv
[0]);

107 
	}
}

110 
	$do_cÚv”t
(
šty³
, cÚ¡ * 
šfe
, 
ou‰y³
,

111 cÚ¡ * 
outfe
) {

113 
sign_key
 * 
key
 = 
NULL
;

114 * 
keyty³
 = 
NULL
;

115 
»t
 = 1;

117 
key
 = 
	`impÜt_»ad
(
šfe
, 
NULL
, 
šty³
);

118 ià(!
key
) {

119 
	`årštf
(
¡d”r
, "Error„eading key from '%s'\n",

120 
šfe
);

121 
out
;

124 #ifdeà
DROPBEAR_RSA


125 ià(
key
->
r§key
 !ğ
NULL
) {

126 
keyty³
 = "RSA";

129 #ifdeà
DROPBEAR_DSS


130 ià(
key
->
dsskey
 !ğ
NULL
) {

131 
keyty³
 = "DSS";

135 
	`årštf
(
¡d”r
, "Key i ¨% key\n", 
keyty³
);

137 ià(
	`impÜt_wr™e
(
outfe
, 
key
, 
NULL
, 
ou‰y³
) != 1) {

138 
	`årštf
(
¡d”r
, "E¼Ü wr™šg keyØ'%s'\n", 
outfe
);

140 
	`årštf
(
¡d”r
, "WrÙkeyØ'%s'\n", 
outfe
);

141 
»t
 = 0;

144 
out
:

145 ià(
key
) {

146 
	`sign_key_ä“
(
key
);

148  
»t
;

149 
	}
}

	@dropbearkey.c

47 
	~"šşudes.h
"

48 
	~"signkey.h
"

49 
	~"bufãr.h
"

50 
	~"dbut.h
"

52 
	~"g’r§.h
"

53 
	~"g’dss.h
"

55 
´šth–p
(* 
´ogÇme
);

57 
	#RSA_SIZE
 (1024/8è

	)

58 
	#DSS_SIZE
 (1024/8è

	)

60 
buf_wr™efe
(
bufãr
 * 
buf
, cÚ¡ * 
f’ame
);

61 
´šubkey
(
sign_key
 * 
key
, 
keyty³
);

62 
ju¡´šub
(cÚ¡ * 
f’ame
);

65 
	$´šth–p
(* 
´ogÇme
) {

67 
	`årštf
(
¡d”r
, "Usage: %s -t <type> -f <filename> [-s bits]\n"

70 #ifdeà
DROPBEAR_RSA


73 #ifdeà
DROPBEAR_DSS


80 #ifdeà
DEBUG_TRACE


83 ,
´ogÇme
);

84 
	}
}

86 #ià
defšed
(
DBMULTI_drİb—rkey
è|| !defšed(
DROPBEAR_MULTI
)

87 #ià
defšed
(
DBMULTI_drİb—rkey
è&& defšed(
DROPBEAR_MULTI
)

88 
	$drİb—rkey_maš
(
¬gc
, ** 
¬gv
) {

90 
	$maš
(
¬gc
, ** 
¬gv
) {

93 
i
;

94 ** 
Ãxt
 = 0;

95 
sign_key
 *
key
 = 
NULL
;

96 
bufãr
 *
buf
 = 
NULL
;

97 * 
f’ame
 = 
NULL
;

98 
keyty³
 = -1;

99 * 
ty³‹xt
 = 
NULL
;

100 * 
siz‘ext
 = 
NULL
;

101 
b™s
;

102 
keysize
;

103 
´šub
 = 0;

106 
i
 = 1; i < 
¬gc
; i++) {

107 ià(
¬gv
[
i
] =ğ
NULL
) {

110 ià(
Ãxt
) {

111 *
Ãxt
 = 
¬gv
[
i
];

112 
Ãxt
 = 
NULL
;

116 ià(
¬gv
[
i
][0] == '-') {

117 
¬gv
[
i
][1]) {

119 
Ãxt
 = &
f’ame
;

122 
Ãxt
 = &
ty³‹xt
;

125 
Ãxt
 = &
siz‘ext
;

128 
´šub
 = 1;

131 
	`´šth–p
(
¬gv
[0]);

132 
	`ex™
(
EXIT_SUCCESS
);

134 #ifdeà
DEBUG_TRACE


136 
debug_Œaû
 = 1;

140 
	`årštf
(
¡d”r
, "UnknowÀ¬gum’ˆ%s\n", 
¬gv
[
i
]);

141 
	`´šth–p
(
¬gv
[0]);

142 
	`ex™
(
EXIT_FAILURE
);

148 ià(!
f’ame
) {

149 
	`årštf
(
¡d”r
, "Must specify‡ key filename\n");

150 
	`´šth–p
(
¬gv
[0]);

151 
	`ex™
(
EXIT_FAILURE
);

154 ià(
´šub
) {

155 
	`ju¡´šub
(
f’ame
);

160 ià(!
ty³‹xt
) {

161 
	`årštf
(
¡d”r
, "Must specify keyype\n");

162 
	`´šth–p
(
¬gv
[0]);

163 
	`ex™
(
EXIT_FAILURE
);

166 ià(
	`¡¾’
(
ty³‹xt
) == 3) {

167 #ifdeà
DROPBEAR_RSA


168 ià(
	`¡ºcmp
(
ty³‹xt
, "rsa", 3) == 0) {

169 
keyty³
 = 
DROPBEAR_SIGNKEY_RSA
;

170 
	`TRACE
(("type is„sa"))

173 #ifdeà
DROPBEAR_DSS


174 ià(
	`¡ºcmp
(
ty³‹xt
, "dss", 3) == 0) {

175 
keyty³
 = 
DROPBEAR_SIGNKEY_DSS
;

176 
	`TRACE
(("type is dss"))

180 ià(
keyty³
 == -1) {

181 
	`årštf
(
¡d”r
, "UnknowÀkeyy³ '%s'\n", 
ty³‹xt
);

182 
	`´šth–p
(
¬gv
[0]);

183 
	`ex™
(
EXIT_FAILURE
);

186 ià(
siz‘ext
) {

187 ià(
	`ssÿnf
(
siz‘ext
, "%u", &
b™s
) != 1) {

188 
	`årštf
(
¡d”r
, "Bits must be‡n integer\n");

189 
	`ex™
(
EXIT_FAILURE
);

192 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_DSS
 && 
b™s
 != 1024) {

193 
	`årštf
(
¡d”r
, "DSS keys have‡ fixed size of 1024 bits\n");

194 
	`ex™
(
EXIT_FAILURE
);

195 } ià(
b™s
 < 512 || bits > 4096 || (bits % 8 != 0)) {

196 
	`årštf
(
¡d”r
, "Bits must satisfy 512 <= bits <= 4096,‡nd be‡"

198 
	`ex™
(
EXIT_FAILURE
);

201 
keysize
 = 
b™s
 / 8;

203 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

204 
keysize
 = 
DSS_SIZE
;

205 } ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

206 
keysize
 = 
RSA_SIZE
;

208 
	`ex™
(
EXIT_FAILURE
);

213 
	`årštf
(
¡d”r
, "WÈouuˆ%d b™ % £ü‘ keyØ'%s'\n", 
keysize
*8,

214 
ty³‹xt
, 
f’ame
);

217 
	`umask
(077);

220 
key
 = 
	`Ãw_sign_key
();

222 
	`årštf
(
¡d”r
, "Generating key,his mayake‡ while...\n");

223 
keyty³
) {

224 #ifdeà
DROPBEAR_RSA


225 
DROPBEAR_SIGNKEY_RSA
:

226 
key
->
r§key
 = 
	`g’_r§_´iv_key
(
keysize
);

229 #ifdeà
DROPBEAR_DSS


230 
DROPBEAR_SIGNKEY_DSS
:

231 
key
->
dsskey
 = 
	`g’_dss_´iv_key
(
keysize
);

235 
	`årštf
(
¡d”r
, "Internalƒrror, bad keyype\n");

236 
	`ex™
(
EXIT_FAILURE
);

239 
buf
 = 
	`buf_Ãw
(
MAX_PRIVKEY_SIZE
);

241 
	`buf_put_´iv_key
(
buf
, 
key
, 
keyty³
);

242 
	`buf_£os
(
buf
, 0);

243 
	`buf_wr™efe
(
buf
, 
f’ame
);

245 
	`buf_buº
(
buf
);

246 
	`buf_ä“
(
buf
);

248 
	`´šubkey
(
key
, 
keyty³
);

250 
	`sign_key_ä“
(
key
);

252  
EXIT_SUCCESS
;

253 
	}
}

256 
	$ju¡´šub
(cÚ¡ * 
f’ame
) {

258 
bufãr
 *
buf
 = 
NULL
;

259 
sign_key
 *
key
 = 
NULL
;

260 
keyty³
;

261 
»t
;

262 
”r
 = 
DROPBEAR_FAILURE
;

264 
buf
 = 
	`buf_Ãw
(
MAX_PRIVKEY_SIZE
);

265 
»t
 = 
	`buf_»adfe
(
buf
, 
f’ame
);

267 ià(
»t
 !ğ
DROPBEAR_SUCCESS
) {

268 
	`årštf
(
¡d”r
, "Faed„—dšg '%s'\n", 
f’ame
);

269 
out
;

272 
key
 = 
	`Ãw_sign_key
();

273 
keyty³
 = 
DROPBEAR_SIGNKEY_ANY
;

275 
	`buf_£os
(
buf
, 0);

276 
»t
 = 
	`buf_g‘_´iv_key
(
buf
, 
key
, &
keyty³
);

277 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

278 
	`årštf
(
¡d”r
, "Bad key iÀ'%s'\n", 
f’ame
);

279 
out
;

282 
	`´šubkey
(
key
, 
keyty³
);

284 
”r
 = 
DROPBEAR_SUCCESS
;

286 
out
:

287 
	`buf_buº
(
buf
);

288 
	`buf_ä“
(
buf
);

289 
buf
 = 
NULL
;

290 ià(
key
) {

291 
	`sign_key_ä“
(
key
);

292 
key
 = 
NULL
;

294 
	`ex™
(
”r
);

295 
	}
}

297 
	$´šubkey
(
sign_key
 * 
key
, 
keyty³
) {

299 
bufãr
 * 
buf
 = 
NULL
;

300 
ba£64key
[
MAX_PUBKEY_SIZE
*2];

301 
ba£64Ën
;

302 
”r
;

303 cÚ¡ * 
ty³¡ršg
 = 
NULL
;

304 *
å
 = 
NULL
;

305 
Ën
;

306 
·sswd
 * 
pw
 = 
NULL
;

307 * 
u£ºame
 = 
NULL
;

308 
ho¡Çme
[100];

310 
buf
 = 
	`buf_Ãw
(
MAX_PUBKEY_SIZE
);

311 
	`buf_put_pub_key
(
buf
, 
key
, 
keyty³
);

312 
	`buf_£os
(
buf
, 4);

314 
Ën
 = 
buf
->ËÀ- buf->
pos
;

316 
ba£64Ën
 = (
ba£64key
);

317 
”r
 = 
	`ba£64_’code
(
	`buf_g‘±r
(
buf
, 
Ën
),†’, 
ba£64key
, &
ba£64Ën
);

319 ià(
”r
 !ğ
CRYPT_OK
) {

320 
	`årštf
(
¡d”r
, "base64 failed");

323 
ty³¡ršg
 = 
	`signkey_Çme_äom_ty³
(
keyty³
, &
”r
);

325 
å
 = 
	`sign_key_fšg”´št
(
	`buf_g‘±r
(
buf
, 
Ën
),†en);

328 
u£ºame
 = "";

329 
pw
 = 
	`g‘pwuid
(
	`g‘uid
());

330 ià(
pw
) {

331 
u£ºame
 = 
pw
->
pw_Çme
;

334 
	`g‘ho¡Çme
(
ho¡Çme
, (hostname));

335 
ho¡Çme
[(hostname)-1] = '\0';

337 
	`´štf
("Public key…ortion is:\n%s %s %s@%s\nFingerprint: %s\n",

338 
ty³¡ršg
, 
ba£64key
, 
u£ºame
, 
ho¡Çme
, 
å
);

340 
	`m_ä“
(
å
);

341 
	`buf_ä“
(
buf
);

342 
	}
}

345 
	$buf_wr™efe
(
bufãr
 * 
buf
, cÚ¡ * 
f’ame
) {

347 
fd
;

348 
Ën
;

350 
fd
 = 
	`İ’
(
f’ame
, 
O_RDWR
 | 
O_CREAT
 | 
O_EXCL
, 
S_IRUSR
 | 
S_IWUSR
);

351 ià(
fd
 < 0) {

352 
	`årštf
(
¡d”r
, "Couldn'ˆü—‹‚ew f%s\n", 
f’ame
);

353 
	`³¼Ü
("Reason");

354 
	`buf_buº
(
buf
);

355 
	`ex™
(
EXIT_FAILURE
);

359 
buf
->
pos
 !ğbuf->
Ën
) {

360 
Ën
 = 
	`wr™e
(
fd
, 
	`buf_g‘±r
(
buf
, buf->ËÀ- buf->
pos
),

361 
buf
->
Ën
 - buf->
pos
);

362 ià(
”ºo
 =ğ
EINTR
) {

365 ià(
Ën
 <= 0) {

366 
	`årštf
(
¡d”r
, "Faed wr™šg f'%s'\n",
f’ame
);

367 
	`³¼Ü
("Reason");

368 
	`ex™
(
EXIT_FAILURE
);

370 
	`buf_šüpos
(
buf
, 
Ën
);

373 
	`şo£
(
fd
);

374 
	}
}

	@dss.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"bignum.h
"

28 
	~"dss.h
"

29 
	~"bufãr.h
"

30 
	~"ssh.h
"

31 
	~"¿ndom.h
"

40 #ifdeà
DROPBEAR_DSS


46 
	$buf_g‘_dss_pub_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
) {

48 
	`TRACE
(("enter buf_get_dss_pub_key"))

49 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

50 
key
->
p
 = 
	`m_m®loc
((
mp_št
));

51 
key
->
q
 = 
	`m_m®loc
((
mp_št
));

52 
key
->
g
 = 
	`m_m®loc
((
mp_št
));

53 
key
->
y
 = 
	`m_m®loc
((
mp_št
));

54 
	`m_mp_š™_muÉi
(
key
->
p
, key->
q
, key->
g
, key->
y
, 
NULL
);

55 
key
->
x
 = 
NULL
;

57 
	`buf_šüpos
(
buf
, 4+
SSH_SIGNKEY_DSS_LEN
);

58 ià(
	`buf_g‘mpšt
(
buf
, 
key
->
p
è=ğ
DROPBEAR_FAILURE


59 || 
	`buf_g‘mpšt
(
buf
, 
key
->
q
è=ğ
DROPBEAR_FAILURE


60 || 
	`buf_g‘mpšt
(
buf
, 
key
->
g
è=ğ
DROPBEAR_FAILURE


61 || 
	`buf_g‘mpšt
(
buf
, 
key
->
y
è=ğ
DROPBEAR_FAILURE
) {

62 
	`TRACE
(("leave buf_get_dss_pub_key: failed„eading mpints"))

63  
DROPBEAR_FAILURE
;

66 ià(
	`mp_couÁ_b™s
(
key
->
p
è< 
MIN_DSS_KEYLEN
) {

67 
	`drİb—r_log
(
LOG_WARNING
, "DSS keyoo short");

68 
	`TRACE
(("leave buf_get_dss_pub_key: short key"))

69  
DROPBEAR_FAILURE
;

72 
	`TRACE
(("leave buf_get_dss_pub_key: success"))

73  
DROPBEAR_SUCCESS
;

74 
	}
}

79 
	$buf_g‘_dss_´iv_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
) {

81 
»t
 = 
DROPBEAR_FAILURE
;

83 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

85 
»t
 = 
	`buf_g‘_dss_pub_key
(
buf
, 
key
);

86 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

87  
DROPBEAR_FAILURE
;

90 
key
->
x
 = 
	`m_m®loc
((
mp_št
));

91 
	`m_mp_š™
(
key
->
x
);

92 
»t
 = 
	`buf_g‘mpšt
(
buf
, 
key
->
x
);

93 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

94 
	`m_ä“
(
key
->
x
);

97  
»t
;

98 
	}
}

102 
	$dss_key_ä“
(
drİb—r_dss_key
 *
key
) {

104 
	`TRACE
(("enter dsa_key_free"))

105 ià(
key
 =ğ
NULL
) {

106 
	`TRACE
(("enter dsa_key_free: key == NULL"))

109 ià(
key
->
p
) {

110 
	`mp_ş—r
(
key
->
p
);

111 
	`m_ä“
(
key
->
p
);

113 ià(
key
->
q
) {

114 
	`mp_ş—r
(
key
->
q
);

115 
	`m_ä“
(
key
->
q
);

117 ià(
key
->
g
) {

118 
	`mp_ş—r
(
key
->
g
);

119 
	`m_ä“
(
key
->
g
);

121 ià(
key
->
y
) {

122 
	`mp_ş—r
(
key
->
y
);

123 
	`m_ä“
(
key
->
y
);

125 ià(
key
->
x
) {

126 
	`mp_ş—r
(
key
->
x
);

127 
	`m_ä“
(
key
->
x
);

129 
	`m_ä“
(
key
);

130 
	`TRACE
(("leave dsa_key_free"))

131 
	}
}

141 
	$buf_put_dss_pub_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
) {

143 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

144 
	`buf_put¡ršg
(
buf
, 
SSH_SIGNKEY_DSS
, 
SSH_SIGNKEY_DSS_LEN
);

145 
	`buf_putmpšt
(
buf
, 
key
->
p
);

146 
	`buf_putmpšt
(
buf
, 
key
->
q
);

147 
	`buf_putmpšt
(
buf
, 
key
->
g
);

148 
	`buf_putmpšt
(
buf
, 
key
->
y
);

150 
	}
}

153 
	$buf_put_dss_´iv_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
) {

155 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

156 
	`buf_put_dss_pub_key
(
buf
, 
key
);

157 
	`buf_putmpšt
(
buf
, 
key
->
x
);

159 
	}
}

161 #ifdeà
DROPBEAR_SIGNKEY_VERIFY


164 
	$buf_dss_v”ify
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
, cÚ¡ * 
d©a
,

165 
Ën
) {

167 
msghash
[
SHA1_HASH_SIZE
];

168 
hash_¡©e
 
hs
;

169 
»t
 = 
DROPBEAR_FAILURE
;

170 
	`DEF_MP_INT
(
v®1
);

171 
	`DEF_MP_INT
(
v®2
);

172 
	`DEF_MP_INT
(
v®3
);

173 
	`DEF_MP_INT
(
v®4
);

174 * 
¡ršg
 = 
NULL
;

175 
¡ršgËn
;

177 
	`TRACE
(("enter buf_dss_verify"))

178 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

180 
	`m_mp_š™_muÉi
(&
v®1
, &
v®2
, &
v®3
, &
v®4
, 
NULL
);

183 
¡ršg
 = 
	`buf_g‘¡ršg
(
buf
, &
¡ršgËn
);

184 ià(
¡ršgËn
 !ğ2*
SHA1_HASH_SIZE
) {

185 
out
;

189 
	`sha1_š™
(&
hs
);

190 
	`sha1_´oûss
(&
hs
, 
d©a
, 
Ën
);

191 
	`sha1_dÚe
(&
hs
, 
msghash
);

196 
	`by‹s_to_mp
(&
v®1
, &
¡ršg
[
SHA1_HASH_SIZE
], SHA1_HASH_SIZE);

198 ià(
	`mp_cmp
(&
v®1
, 
key
->
q
è!ğ
MP_LT
) {

199 
	`TRACE
(("verify failed, s' >= q"))

200 
out
;

203 ià(
	`mp_švmod
(&
v®1
, 
key
->
q
, &
v®2
è!ğ
MP_OKAY
) {

204 
out
;

209 
	`by‹s_to_mp
(&
v®1
, 
msghash
, 
SHA1_HASH_SIZE
);

212 ià(
	`mp_mulmod
(&
v®1
, &
v®2
, 
key
->
q
, &
v®3
è!ğ
MP_OKAY
) {

213 
out
;

218 
	`by‹s_to_mp
(&
v®1
, &
¡ršg
[0], 
SHA1_HASH_SIZE
);

219 ià(
	`mp_cmp
(&
v®1
, 
key
->
q
è!ğ
MP_LT
) {

220 
	`TRACE
(("verify failed,„' >= q"))

221 
out
;

224 ià(
	`mp_mulmod
(&
v®1
, &
v®2
, 
key
->
q
, &
v®4
è!ğ
MP_OKAY
) {

225 
out
;

230 ià(
	`mp_ex±mod
(
key
->
g
, &
v®3
, key->
p
, &
v®2
è!ğ
MP_OKAY
) {

231 
out
;

234 ià(
	`mp_ex±mod
(
key
->
y
, &
v®4
, key->
p
, &
v®3
è!ğ
MP_OKAY
) {

235 
out
;

238 ià(
	`mp_mulmod
(&
v®2
, &
v®3
, 
key
->
p
, &
v®4
è!ğ
MP_OKAY
) {

239 
out
;

242 ià(
	`mp_mod
(&
v®4
, 
key
->
q
, &
v®2
è!ğ
MP_OKAY
) {

243 
out
;

247 ià(
	`mp_cmp
(&
v®2
, &
v®1
è=ğ
MP_EQ
) {

249 
»t
 = 
DROPBEAR_SUCCESS
;

252 
out
:

253 
	`mp_ş—r_muÉi
(&
v®1
, &
v®2
, &
v®3
, &
v®4
, 
NULL
);

254 
	`m_ä“
(
¡ršg
);

256  
»t
;

258 
	}
}

261 #ifdeà
DSS_PROTOK


265 * 
	$m±oby‹s
(
mp_št
 *
mp
, *
Ën
) {

267 * 
»t
;

268 
size
;

270 
size
 = 
	`mp_unsigÃd_bš_size
(
mp
);

271 
»t
 = 
	`m_m®loc
(
size
);

272 ià(
	`mp_to_unsigÃd_bš
(
mp
, 
»t
è!ğ
MP_OKAY
) {

273 
	`drİb—r_ex™
("Mem‡llocƒrror");

275 ià(
Ën
 !ğ
NULL
) {

276 *
Ën
 = 
size
;

278  
»t
;

279 
	}
}

295 
	$buf_put_dss_sign
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
, cÚ¡ * 
d©a
,

296 
Ën
) {

298 
msghash
[
SHA1_HASH_SIZE
];

299 
wr™–’
;

300 
i
;

301 #ifdeà
DSS_PROTOK


302 
´ivkeyhash
[
SHA512_HASH_SIZE
];

303 *
´ivkeytmp
;

304 
´Ùo_k
[
SHA512_HASH_SIZE
];

305 
	`DEF_MP_INT
(
dss_´Ùok
);

307 
	`DEF_MP_INT
(
dss_k
);

308 
	`DEF_MP_INT
(
dss_m
);

309 
	`DEF_MP_INT
(
dss_‹mp1
);

310 
	`DEF_MP_INT
(
dss_‹mp2
);

311 
	`DEF_MP_INT
(
dss_r
);

312 
	`DEF_MP_INT
(
dss_s
);

313 
hash_¡©e
 
hs
;

315 
	`TRACE
(("enter buf_put_dss_sign"))

316 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

319 
	`sha1_š™
(&
hs
);

320 
	`sha1_´oûss
(&
hs
, 
d©a
, 
Ën
);

321 
	`sha1_dÚe
(&
hs
, 
msghash
);

323 
	`m_mp_š™_muÉi
(&
dss_k
, &
dss_‹mp1
, &
dss_‹mp2
, &
dss_r
, &
dss_s
,

324 &
dss_m
, 
NULL
);

325 #ifdeà
DSS_PROTOK


327 
´ivkeytmp
 = 
	`m±oby‹s
(
key
->
x
, &
i
);

328 
	`sha512_š™
(&
hs
);

329 
	`sha512_´oûss
(&
hs
, "the quick brown fox jumped overhe†azy dog", 44);

330 
	`sha512_´oûss
(&
hs
, 
´ivkeytmp
, 
i
);

331 
	`sha512_dÚe
(&
hs
, 
´ivkeyhash
);

332 
	`m_buº
(
´ivkeytmp
, 
i
);

333 
	`m_ä“
(
´ivkeytmp
);

336 
	`sha512_š™
(&
hs
);

337 
	`sha512_´oûss
(&
hs
, 
´ivkeyhash
, 
SHA512_HASH_SIZE
);

338 
	`sha512_´oûss
(&
hs
, 
msghash
, 
SHA1_HASH_SIZE
);

339 
	`sha512_dÚe
(&
hs
, 
´Ùo_k
);

342 
	`m_mp_š™
(&
dss_´Ùok
);

343 
	`by‹s_to_mp
(&
dss_´Ùok
, 
´Ùo_k
, 
SHA512_HASH_SIZE
);

344 ià(
	`mp_mod
(&
dss_´Ùok
, 
key
->
q
, &
dss_k
è!ğ
MP_OKAY
) {

345 
	`drİb—r_ex™
("DSSƒrror");

347 
	`mp_ş—r
(&
dss_´Ùok
);

348 
	`m_buº
(
´Ùo_k
, 
SHA512_HASH_SIZE
);

350 
	`g’_¿ndom_mpšt
(
key
->
q
, &
dss_k
);

354 
	`by‹s_to_mp
(&
dss_m
, 
msghash
, 
SHA1_HASH_SIZE
);

357 ià(
	`mp_ex±mod
(
key
->
g
, &
dss_k
, key->
p
, &
dss_‹mp1
è!ğ
MP_OKAY
) {

358 
	`drİb—r_ex™
("DSSƒrror");

361 ià(
	`mp_mod
(&
dss_‹mp1
, 
key
->
q
, &
dss_r
è!ğ
MP_OKAY
) {

362 
	`drİb—r_ex™
("DSSƒrror");

366 ià(
	`mp_mulmod
(&
dss_r
, 
key
->
x
, key->
q
, &
dss_‹mp1
è!ğ
MP_OKAY
) {

367 
	`drİb—r_ex™
("DSSƒrror");

370 ià(
	`mp_addmod
(&
dss_m
, &
dss_‹mp1
, 
key
->
q
, &
dss_‹mp2
è!ğ
MP_OKAY
) {

371 
	`drİb—r_ex™
("DSSƒrror");

375 ià(
	`mp_švmod
(&
dss_k
, 
key
->
q
, &
dss_‹mp1
è!ğ
MP_OKAY
) {

376 
	`drİb—r_ex™
("DSSƒrror");

380 ià(
	`mp_mulmod
(&
dss_‹mp1
, &
dss_‹mp2
, 
key
->
q
, &
dss_s
è!ğ
MP_OKAY
) {

381 
	`drİb—r_ex™
("DSSƒrror");

384 
	`buf_put¡ršg
(
buf
, 
SSH_SIGNKEY_DSS
, 
SSH_SIGNKEY_DSS_LEN
);

385 
	`buf_putšt
(
buf
, 2*
SHA1_HASH_SIZE
);

387 
wr™–’
 = 
	`mp_unsigÃd_bš_size
(&
dss_r
);

388 
	`drİb—r_as£¹
(
wr™–’
 <ğ
SHA1_HASH_SIZE
);

390 
i
 = 0; i < 
SHA1_HASH_SIZE
 - 
wr™–’
; i++) {

391 
	`buf_putby‹
(
buf
, 0);

393 ià(
	`mp_to_unsigÃd_bš
(&
dss_r
, 
	`buf_g‘wr™•Œ
(
buf
, 
wr™–’
))

394 !ğ
MP_OKAY
) {

395 
	`drİb—r_ex™
("DSSƒrror");

397 
	`mp_ş—r
(&
dss_r
);

398 
	`buf_šüwr™•os
(
buf
, 
wr™–’
);

400 
wr™–’
 = 
	`mp_unsigÃd_bš_size
(&
dss_s
);

401 
	`drİb—r_as£¹
(
wr™–’
 <ğ
SHA1_HASH_SIZE
);

403 
i
 = 0; i < 
SHA1_HASH_SIZE
 - 
wr™–’
; i++) {

404 
	`buf_putby‹
(
buf
, 0);

406 ià(
	`mp_to_unsigÃd_bš
(&
dss_s
, 
	`buf_g‘wr™•Œ
(
buf
, 
wr™–’
))

407 !ğ
MP_OKAY
) {

408 
	`drİb—r_ex™
("DSSƒrror");

410 
	`mp_ş—r
(&
dss_s
);

411 
	`buf_šüwr™•os
(
buf
, 
wr™–’
);

413 
	`mp_ş—r_muÉi
(&
dss_k
, &
dss_‹mp1
, &
dss_‹mp2
, &
dss_r
, &
dss_s
,

414 &
dss_m
, 
NULL
);

418 
	`TRACE
(("leave buf_put_dss_sign"))

419 
	}
}

	@dss.h

25 #iâdeà
_DSS_H_


26 
	#_DSS_H_


	)

28 
	~"šşudes.h
"

29 
	~"bufãr.h
"

31 #ifdeà
DROPBEAR_DSS


33 
	#DSS_SIGNATURE_SIZE
 4+
SSH_SIGNKEY_DSS_LEN
+4+2*
SHA1_HASH_SIZE


	)

37 
mp_št
* 
	mp
;

38 
mp_št
* 
	mq
;

39 
mp_št
* 
	mg
;

40 
mp_št
* 
	my
;

42 
mp_št
* 
	mx
;

44 } 
	tdrİb—r_dss_key
;

46 
buf_put_dss_sign
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
, cÚ¡ * 
d©a
,

47 
Ën
);

48 #ifdeà
DROPBEAR_SIGNKEY_VERIFY


49 
buf_dss_v”ify
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
, cÚ¡ * 
d©a
,

50 
Ën
);

52 
buf_g‘_dss_pub_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
);

53 
buf_g‘_dss_´iv_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
);

54 
buf_put_dss_pub_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
);

55 
buf_put_dss_´iv_key
(
bufãr
* 
buf
, 
drİb—r_dss_key
 *
key
);

56 
dss_key_ä“
(
drİb—r_dss_key
 *
key
);

	@fake-rfc2553.c

40 
	~"šşudes.h
"

42 
	~<¡dlib.h
>

43 
	~<¡ršg.h
>

45 
	~<Ãtš‘/š.h
>

46 
	~<¬·/š‘.h
>

48 #iâdeà
HAVE_GETNAMEINFO


49 
	$g‘Çmešfo
(cÚ¡ 
sockaddr
 *
§
, 
size_t
 
§Ën
, *
ho¡
,

50 
size_t
 
ho¡Ën
, *
£rv
, size_ˆ
£rvËn
, 
æags
)

52 
sockaddr_š
 *
sš
 = (sockaddr_š *)
§
;

53 
ho¡’t
 *
hp
;

54 
tmp£rv
[16];

56 ià(
§
->
§_çmy
 !ğ
AF_UNSPEC
 && sa->§_çmy !ğ
AF_INET
)

57  (
EAI_FAMILY
);

58 ià(
£rv
 !ğ
NULL
) {

59 
	`¢´štf
(
tmp£rv
, Ñmp£rv), "%d", 
	`Áohs
(
sš
->
sš_pÜt
));

60 ià(
	`¡¾ıy
(
£rv
, 
tmp£rv
, 
£rvËn
) >= servlen)

61  (
EAI_MEMORY
);

64 ià(
ho¡
 !ğ
NULL
) {

65 ià(
æags
 & 
NI_NUMERICHOST
) {

66 ià(
	`¡¾ıy
(
ho¡
, 
	`š‘_Áß
(
sš
->
sš_addr
),

67 
ho¡Ën
) >= hostlen)

68  (
EAI_MEMORY
);

72 
hp
 = 
	`g‘ho¡byaddr
((*)&
sš
->
sš_addr
,

73 (
š_addr
), 
AF_INET
);

74 ià(
hp
 =ğ
NULL
)

75  (
EAI_NODATA
);

77 ià(
	`¡¾ıy
(
ho¡
, 
hp
->
h_Çme
, 
ho¡Ën
) >= hostlen)

78  (
EAI_MEMORY
);

84 
	}
}

87 #iâdeà
HAVE_GAI_STRERROR


88 #ifdeà
HAVE_CONST_GAI_STRERROR_PROTO


93 
	$gai_¡»¼Ü
(
”r
)

95 
”r
) {

96 
EAI_NODATA
:

98 
EAI_MEMORY
:

100 
EAI_NONAME
:

102 
EAI_FAMILY
:

107 
	}
}

110 #iâdeà
HAVE_FREEADDRINFO


112 
	$ä“addršfo
(
addršfo
 *
ai
)

114 
addršfo
 *
Ãxt
;

116 ; 
ai
 !ğ
NULL
;) {

117 
Ãxt
 = 
ai
->
ai_Ãxt
;

118 
	`ä“
(
ai
);

119 
ai
 = 
Ãxt
;

121 
	}
}

124 #iâdeà
HAVE_GETADDRINFO


126 
addršfo
 *
	$m®loc_ai
(
pÜt
, 
u_lÚg
 
addr
, cÚ¡ 
addršfo
 *
hšts
)

128 
addršfo
 *
ai
;

130 
ai
 = 
	`m®loc
((*aiè+ (
sockaddr_š
));

131 ià(
ai
 =ğ
NULL
)

132  (
NULL
);

134 
	`mem£t
(
ai
, '\0', (*aiè+ (
sockaddr_š
));

136 
ai
->
ai_addr
 = (
sockaddr
 *)(ai + 1);

138 
ai
->
ai_add¾’
 = (
sockaddr_š
);

139 
ai
->
ai_addr
->
§_çmy
 =‡i->
ai_çmy
 = 
AF_INET
;

141 ((
sockaddr_š
 *)(
ai
)->
ai_addr
)->
sš_pÜt
 = 
pÜt
;

142 ((
sockaddr_š
 *)(
ai
)->
ai_addr
)->
sš_addr
.
s_addr
 = 
addr
;

145 ià(
hšts
->
ai_sockty³
)

146 
ai
->
ai_sockty³
 = 
hšts
->ai_socktype;

148 
ai
->
ai_sockty³
 = 
SOCK_STREAM
;

150 ià(
hšts
->
ai_´ÙocŞ
)

151 
ai
->
ai_´ÙocŞ
 = 
hšts
->ai_protocol;

153  (
ai
);

154 
	}
}

157 
	$g‘addršfo
(cÚ¡ *
ho¡Çme
, cÚ¡ *
£rvÇme
,

158 cÚ¡ 
addršfo
 *
hšts
, addršfØ**
»s
)

160 
ho¡’t
 *
hp
;

161 
£rv’t
 *
¥
;

162 
š_addr
 
š
;

163 
i
;

164 
pÜt
;

165 
u_lÚg
 
addr
;

167 
pÜt
 = 0;

168 ià(
hšts
 && hšts->
ai_çmy
 !ğ
AF_UNSPEC
 &&

169 
hšts
->
ai_çmy
 !ğ
AF_INET
)

170  (
EAI_FAMILY
);

171 ià(
£rvÇme
 !ğ
NULL
) {

172 *
ı
;

174 
pÜt
 = 
	`¡¹Ş
(
£rvÇme
, &
ı
, 10);

175 ià(
pÜt
 > 0 &&…Üˆ<ğ65535 && *
ı
 == '\0')

176 
pÜt
 = 
	`htÚs
(port);

177 ià((
¥
 = 
	`g‘£rvbyÇme
(
£rvÇme
, 
NULL
)) != NULL)

178 
pÜt
 = 
¥
->
s_pÜt
;

180 
pÜt
 = 0;

183 ià(
hšts
 && hšts->
ai_æags
 & 
AI_PASSIVE
) {

184 
addr
 = 
	`htÚl
(0x00000000);

185 ià(
ho¡Çme
 && 
	`š‘_©Ú
(ho¡Çme, &
š
) != 0)

186 
addr
 = 
š
.
s_addr
;

187 *
»s
 = 
	`m®loc_ai
(
pÜt
, 
addr
, 
hšts
);

188 ià(*
»s
 =ğ
NULL
)

189  (
EAI_MEMORY
);

193 ià(!
ho¡Çme
) {

194 *
»s
 = 
	`m®loc_ai
(
pÜt
, 
	`htÚl
(0x7f000001), 
hšts
);

195 ià(*
»s
 =ğ
NULL
)

196  (
EAI_MEMORY
);

200 ià(
	`š‘_©Ú
(
ho¡Çme
, &
š
)) {

201 *
»s
 = 
	`m®loc_ai
(
pÜt
, 
š
.
s_addr
, 
hšts
);

202 ià(*
»s
 =ğ
NULL
)

203  (
EAI_MEMORY
);

208 ià(
hšts
 && hšts->
ai_æags
 & 
AI_NUMERICHOST
)

209  (
EAI_NONAME
);

211 
hp
 = 
	`g‘ho¡byÇme
(
ho¡Çme
);

212 ià(
hp
 && hp->
h_Çme
 && hp->h_Çme[0] && hp->
h_addr_li¡
[0]) {

213 
addršfo
 *
cur
, *
´ev
;

215 
cur
 = 
´ev
 = *
»s
 = 
NULL
;

216 
i
 = 0; 
hp
->
h_addr_li¡
[i]; i++) {

217 
š_addr
 *
š
 = (š_add¸*)
hp
->
h_addr_li¡
[
i
];

219 
cur
 = 
	`m®loc_ai
(
pÜt
, 
š
->
s_addr
, 
hšts
);

220 ià(
cur
 =ğ
NULL
) {

221 ià(*
»s
 !ğ
NULL
)

222 
	`ä“addršfo
(*
»s
);

223  (
EAI_MEMORY
);

225 ià(
´ev
)

226 
´ev
->
ai_Ãxt
 = 
cur
;

228 *
»s
 = 
cur
;

230 
´ev
 = 
cur
;

235  (
EAI_NODATA
);

236 
	}
}

	@fake-rfc2553.h

42 #iâdeà
_FAKE_RFC2553_H


43 
	#_FAKE_RFC2553_H


	)

45 
	~"šşudes.h
"

46 
	~<sys/ty³s.h
>

47 #ià
defšed
(
HAVE_NETDB_H
)

48 
	~<Ãtdb.h
>

54 #iâdeà
HAVE_STRUCT_SOCKADDR_STORAGE


55 
	#_SS_MAXSIZE
 128

	)

56 
	#_SS_PADSIZE
 (
_SS_MAXSIZE
 -  (
sockaddr
))

	)

57 
	ssockaddr_¡Üage
 {

58 
sockaddr
 
	mss_§
;

59 
	m__ss_·d2
[
_SS_PADSIZE
];

61 
	#ss_çmy
 
ss_§
.
§_çmy


	)

64 #iâdeà
IN6_IS_ADDR_LOOPBACK


65 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

66 (((
u_št32_t
 *)(
a
))[0] == 0 && ((u_int32_t *)(a))[1] == 0 && \

67 ((
u_št32_t
 *)(
a
))[2] =ğ0 && ((u_št32_ˆ*)×))[3] =ğ
	`htÚl
(1))

	)

70 #iâdeà
HAVE_STRUCT_IN6_ADDR


71 
	sš6_addr
 {

72 
u_št8_t
 
	ms6_addr
[16];

76 #iâdeà
HAVE_STRUCT_SOCKADDR_IN6


77 
	ssockaddr_š6
 {

78 
	msš6_çmy
;

79 
u_št16_t
 
	msš6_pÜt
;

80 
u_št32_t
 
	msš6_æowšfo
;

81 
š6_addr
 
	msš6_addr
;

82 
u_št32_t
 
	msš6_scİe_id
;

86 #iâdeà
AF_INET6


88 
	#AF_INET6
 
AF_MAX


	)

95 #iâdeà
NI_NUMERICHOST


96 
	#NI_NUMERICHOST
 (1)

	)

98 #iâdeà
NI_NAMEREQD


99 
	#NI_NAMEREQD
 (1<<1)

	)

101 #iâdeà
NI_NUMERICSERV


102 
	#NI_NUMERICSERV
 (1<<2)

	)

105 #iâdeà
AI_PASSIVE


106 
	#AI_PASSIVE
 (1)

	)

108 #iâdeà
AI_CANONNAME


109 
	#AI_CANONNAME
 (1<<1)

	)

111 #iâdeà
AI_NUMERICHOST


112 
	#AI_NUMERICHOST
 (1<<2)

	)

115 #iâdeà
NI_MAXSERV


116 
	#NI_MAXSERV
 32

	)

118 #iâdeà
NI_MAXHOST


119 
	#NI_MAXHOST
 1025

	)

122 #iâdeà
EAI_NODATA


123 
	#EAI_NODATA
 (
INT_MAX
 - 1)

	)

125 #iâdeà
EAI_MEMORY


126 
	#EAI_MEMORY
 (
INT_MAX
 - 2)

	)

128 #iâdeà
EAI_NONAME


129 
	#EAI_NONAME
 (
INT_MAX
 - 3)

	)

131 #iâdeà
EAI_SYSTEM


132 
	#EAI_SYSTEM
 (
INT_MAX
 - 4)

	)

134 #iâdeà
EAI_FAMILY


135 
	#EAI_FAMILY
 (
INT_MAX
 - 5)

	)

138 #iâdeà
HAVE_STRUCT_ADDRINFO


139 
	saddršfo
 {

140 
	mai_æags
;

141 
	mai_çmy
;

142 
	mai_sockty³
;

143 
	mai_´ÙocŞ
;

144 
size_t
 
	mai_add¾’
;

145 *
	mai_ÿnÚÇme
;

146 
sockaddr
 *
	mai_addr
;

147 
addršfo
 *
	mai_Ãxt
;

151 #iâdeà
HAVE_GETADDRINFO


152 #ifdeà
g‘addršfo


153 #undeà
g‘addršfo


155 
	#g‘addršfo
(
a
,
b
,
c
,
d
è(
	`ssh_g‘addršfo
×,b,c,d))

	)

156 
g‘addršfo
(const *, const *,

157 cÚ¡ 
addršfo
 *, addrinfo **);

160 #ià!
defšed
(
HAVE_GAI_STRERROR
è&& !defšed(
HAVE_CONST_GAI_STRERROR_PROTO
)

161 
	#gai_¡»¼Ü
(
a
è(
	`_ssh_com·t_gai_¡»¼Ü
×))

	)

162 *
gai_¡»¼Ü
();

165 #iâdeà
HAVE_FREEADDRINFO


166 
	#ä“addršfo
(
a
è(
	`ssh_ä“addršfo
×))

	)

167 
ä“addršfo
(
addršfo
 *);

170 #iâdeà
HAVE_GETNAMEINFO


171 
	#g‘Çmešfo
(
a
,
b
,
c
,
d
,
e
,
f
,
g
è(
	`ssh_g‘Çmešfo
×,b,c,d,e,f,g))

	)

172 
g‘Çmešfo
(cÚ¡ 
sockaddr
 *, 
size_t
, *, size_t,

173 *, 
size_t
, );

	@gendss.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"signkey.h
"

28 
	~"bignum.h
"

29 
	~"¿ndom.h
"

30 
	~"bufãr.h
"

31 
	~"g’dss.h
"

32 
	~"dss.h
"

34 
	#QSIZE
 20

	)

38 #ifdeà
DROPBEAR_DSS


40 
g‘q
(
drİb—r_dss_key
 *
key
);

41 
g‘p
(
drİb—r_dss_key
 *
key
, 
size
);

42 
g‘g
(
drİb—r_dss_key
 *
key
);

43 
g‘x
(
drİb—r_dss_key
 *
key
);

44 
g‘y
(
drİb—r_dss_key
 *
key
);

46 
drİb—r_dss_key
 * 
	$g’_dss_´iv_key
(
size
) {

48 
drİb—r_dss_key
 *
key
;

50 
key
 = 
	`m_m®loc
((*key));

52 
key
->
p
 = (
mp_št
*)
	`m_m®loc
((mp_int));

53 
key
->
q
 = (
mp_št
*)
	`m_m®loc
((mp_int));

54 
key
->
g
 = (
mp_št
*)
	`m_m®loc
((mp_int));

55 
key
->
y
 = (
mp_št
*)
	`m_m®loc
((mp_int));

56 
key
->
x
 = (
mp_št
*)
	`m_m®loc
((mp_int));

57 
	`m_mp_š™_muÉi
(
key
->
p
, key->
q
, key->
g
, key->
y
, key->
x
, 
NULL
);

59 
	`£ed¿ndom
();

61 
	`g‘q
(
key
);

62 
	`g‘p
(
key
, 
size
);

63 
	`g‘g
(
key
);

64 
	`g‘x
(
key
);

65 
	`g‘y
(
key
);

67  
key
;

69 
	}
}

71 
	$g‘q
(
drİb—r_dss_key
 *
key
) {

73 
buf
[
QSIZE
];

76 
	`g’¿ndom
(
buf
, 
QSIZE
);

77 
buf
[0] |= 0x80;

78 
buf
[
QSIZE
-1] |= 0x01;

80 
	`by‹s_to_mp
(
key
->
q
, 
buf
, 
QSIZE
);

83 ià(
	`mp_´ime_Ãxt_´ime
(
key
->
q
, 18, 0è!ğ
MP_OKAY
) {

84 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

85 
	`ex™
(1);

87 
	}
}

89 
	$g‘p
(
drİb—r_dss_key
 *
key
, 
size
) {

91 
	`DEF_MP_INT
(
‹mpX
);

92 
	`DEF_MP_INT
(
‹mpC
);

93 
	`DEF_MP_INT
(
‹mpP
);

94 
	`DEF_MP_INT
(
‹mp2q
);

95 
»suÉ
;

96 *
buf
;

98 
	`m_mp_š™_muÉi
(&
‹mpX
, &
‹mpC
, &
‹mpP
, &
‹mp2q
, 
NULL
);

102 ià(
	`mp_mul_d
(
key
->
q
, 2, &
‹mp2q
è!ğ
MP_OKAY
) {

103 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

104 
	`ex™
(1);

107 
buf
 = (*)
	`m_m®loc
(
size
);

109 
»suÉ
 = 0;

112 
	`g’¿ndom
(
buf
, 
size
);

113 
buf
[0] |= 0x80;

116 
	`by‹s_to_mp
(&
‹mpX
, 
buf
, 
size
);

119 ià(
	`mp_mod
(&
‹mpX
, &
‹mp2q
, &
‹mpC
è!ğ
MP_OKAY
) {

120 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

121 
	`ex™
(1);

125 ià(
	`mp_sub
(&
‹mpX
, &
‹mpC
, &
‹mpP
è!ğ
MP_OKAY
) {

126 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

127 
	`ex™
(1);

130 ià(
	`mp_add_d
(&
‹mpP
, 1, 
key
->
p
è!ğ
MP_OKAY
) {

131 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

132 
	`ex™
(1);

137 ià(
	`mp_´ime_is_´ime
(
key
->
p
, 5, &
»suÉ
è!ğ
MP_OKAY
) {

138 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

139 
	`ex™
(1);

141 } !
»suÉ
);

143 
	`mp_ş—r_muÉi
(&
‹mpX
, &
‹mpC
, &
‹mpP
, &
‹mp2q
, 
NULL
);

144 
	`m_buº
(
buf
, 
size
);

145 
	`m_ä“
(
buf
);

146 
	}
}

148 
	$g‘g
(
drİb—r_dss_key
 * 
key
) {

150 
	`DEF_MP_INT
(
div
);

151 
	`DEF_MP_INT
(
h
);

152 
	`DEF_MP_INT
(
v®
);

154 
	`m_mp_š™_muÉi
(&
div
, &
h
, &
v®
, 
NULL
);

157 ià(
	`mp_sub_d
(
key
->
p
, 1, &
v®
è!ğ
MP_OKAY
) {

158 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

159 
	`ex™
(1);

161 ià(
	`mp_div
(&
v®
, 
key
->
q
, &
div
, 
NULL
è!ğ
MP_OKAY
) {

162 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

163 
	`ex™
(1);

167 
	`mp_£t
(&
h
, 1);

170 ià(
	`mp_ex±mod
(&
h
, &
div
, 
key
->
p
, key->
g
è!ğ
MP_OKAY
) {

171 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

172 
	`ex™
(1);

175 ià(
	`mp_add_d
(&
h
, 1, &hè!ğ
MP_OKAY
) {

176 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

177 
	`ex™
(1);

180 } 
	`mp_cmp_d
(
key
->
g
, 1è!ğ
MP_GT
);

182 
	`mp_ş—r_muÉi
(&
div
, &
h
, &
v®
, 
NULL
);

183 
	}
}

185 
	$g‘x
(
drİb—r_dss_key
 *
key
) {

187 
	`g’_¿ndom_mpšt
(
key
->
q
, key->
x
);

188 
	}
}

190 
	$g‘y
(
drİb—r_dss_key
 *
key
) {

192 ià(
	`mp_ex±mod
(
key
->
g
, key->
x
, key->
p
, key->
y
è!ğ
MP_OKAY
) {

193 
	`årštf
(
¡d”r
, "DSS key generation failed\n");

194 
	`ex™
(1);

196 
	}
}

	@gendss.h

25 #iâdeà
_GENDSS_H_


26 
	#_GENDSS_H_


	)

28 
	~"dss.h
"

30 #ifdeà
DROPBEAR_DSS


32 
drİb—r_dss_key
 * 
g’_dss_´iv_key
(
size
);

	@genrsa.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"bignum.h
"

28 
	~"¿ndom.h
"

29 
	~"r§.h
"

30 
	~"g’r§.h
"

32 
	#RSA_E
 65537

	)

34 #ifdeà
DROPBEAR_RSA


36 
g‘r§´ime
(
mp_št
* 
´ime
, mp_šˆ*
´imemšus
,

37 
mp_št
* 
r§_e
, 
size
);

40 
drİb—r_r§_key
 * 
	$g’_r§_´iv_key
(
size
) {

42 
drİb—r_r§_key
 * 
key
;

43 
	`DEF_MP_INT
(
pmšus
);

44 
	`DEF_MP_INT
(
qmšus
);

45 
	`DEF_MP_INT
(
lcm
);

47 
key
 = 
	`m_m®loc
((*key));

49 
key
->
e
 = (
mp_št
*)
	`m_m®loc
((mp_int));

50 
key
->
n
 = (
mp_št
*)
	`m_m®loc
((mp_int));

51 
key
->
d
 = (
mp_št
*)
	`m_m®loc
((mp_int));

52 
key
->
p
 = (
mp_št
*)
	`m_m®loc
((mp_int));

53 
key
->
q
 = (
mp_št
*)
	`m_m®loc
((mp_int));

55 
	`m_mp_š™_muÉi
(
key
->
e
, key->
n
, key->
d
, key->
p
, key->
q
,

56 &
pmšus
, &
lcm
, &
qmšus
, 
NULL
);

58 
	`£ed¿ndom
();

60 ià(
	`mp_£t_št
(
key
->
e
, 
RSA_E
è!ğ
MP_OKAY
) {

61 
	`årštf
(
¡d”r
, "RSA generation failed\n");

62 
	`ex™
(1);

65 
	`g‘r§´ime
(
key
->
p
, &
pmšus
, key->
e
, 
size
/2);

66 
	`g‘r§´ime
(
key
->
q
, &
qmšus
, key->
e
, 
size
/2);

68 ià(
	`mp_mul
(
key
->
p
, key->
q
, key->
n
è!ğ
MP_OKAY
) {

69 
	`årštf
(
¡d”r
, "RSA generation failed\n");

70 
	`ex™
(1);

74 ià(
	`mp_lcm
(&
pmšus
, &
qmšus
, &
lcm
è!ğ
MP_OKAY
) {

75 
	`årštf
(
¡d”r
, "RSA generation failed\n");

76 
	`ex™
(1);

81 ià(
	`mp_švmod
(
key
->
e
, &
lcm
, key->
d
è!ğ
MP_OKAY
) {

82 
	`årštf
(
¡d”r
, "RSA generation failed\n");

83 
	`ex™
(1);

86 
	`mp_ş—r_muÉi
(&
pmšus
, &
qmšus
, &
lcm
, 
NULL
);

88  
key
;

89 
	}
}

92 
	$g‘r§´ime
(
mp_št
* 
´ime
, mp_šˆ*
´imemšus
,

93 
mp_št
* 
r§_e
, 
size
) {

95 *
buf
;

96 
	`DEF_MP_INT
(
‹mp_gcd
);

98 
buf
 = (*)
	`m_m®loc
(
size
+1);

100 
	`m_mp_š™
(&
‹mp_gcd
);

104 
	`g’¿ndom
(
buf
, 
size
+1);

105 
buf
[0] |= 0x80;

107 
	`by‹s_to_mp
(
´ime
, 
buf
, 
size
+1);

110 ià(
	`mp_´ime_Ãxt_´ime
(
´ime
, 8, 0è!ğ
MP_OKAY
) {

111 
	`årštf
(
¡d”r
, "RSA generation failed\n");

112 
	`ex™
(1);

116 ià(
	`mp_sub_d
(
´ime
, 1, 
´imemšus
è!ğ
MP_OKAY
) {

117 
	`årštf
(
¡d”r
, "RSA generation failed\n");

118 
	`ex™
(1);

121 ià(
	`mp_gcd
(
´imemšus
, 
r§_e
, &
‹mp_gcd
è!ğ
MP_OKAY
) {

122 
	`årštf
(
¡d”r
, "RSA generation failed\n");

123 
	`ex™
(1);

125 } 
	`mp_cmp_d
(&
‹mp_gcd
, 1è!ğ
MP_EQ
);

128 
	`mp_ş—r
(&
‹mp_gcd
);

129 
	`m_buº
(
buf
, 
size
+1);

130 
	`m_ä“
(
buf
);

131 
	}
}

	@genrsa.h

25 #iâdeà
_GENRSA_H_


26 
	#_GENRSA_H_


	)

28 
	~"r§.h
"

30 #ifdeà
DROPBEAR_RSA


32 
drİb—r_r§_key
 * 
g’_r§_´iv_key
(
size
);

	@includes.h

25 #iâdeà
_INCLUDES_H_


26 
	#_INCLUDES_H_


	)

29 
	~"cÚfig.h
"

30 
	~"İtiÚs.h
"

31 
	~"debug.h
"

33 
	~<sys/ty³s.h
>

34 
	~<sys/ioùl.h
>

35 
	~<sys/·¿m.h
>

36 
	~<sys/sock‘.h
>

37 
	~<sys/¡©.h
>

38 
	~<sys/time.h
>

39 
	~<sys/un.h
>

40 
	~<sys/wa™.h
>

41 
	~<sys/»sourû.h
>

43 
	~<¡dio.h
>

44 
	~<”ºo.h
>

45 
	~<fú.h
>

46 
	~<g½.h
>

47 
	~<lim™s.h
>

48 
	~<pwd.h
>

49 
	~<sigÇl.h
>

50 
	~<¡dlib.h
>

51 
	~<¡ršg.h
>

52 
	~<‹rmios.h
>

53 
	~<uni¡d.h
>

54 
	~<sy¦og.h
>

55 
	~<Ãtdb.h
>

56 
	~<ùy³.h
>

57 
	~<¡d¬g.h
>

58 
	~<dœ’t.h
>

59 
	~<time.h
>

61 #ifdeà
HAVE_UTMP_H


62 
	~<utmp.h
>

65 #ifdeà
HAVE_UTMPX_H


66 
	~<utmpx.h
>

69 #ifdeà
HAVE_PATHS_H


70 
	~<·ths.h
>

73 #ifdeà
HAVE_LASTLOG_H


74 
	~<Ï¡log.h
>

77 #ifdeà
HAVE_NETINET_IN_H


78 
	~<Ãtš‘/š.h
>

81 
	~<¬·/š‘.h
>

85 #ifdeà
HAVE_NETINET_IN_SYSTM_H


86 
	~<Ãtš‘/š_sy¡m.h
>

89 
	~<Ãtš‘/.h
>

91 #ifdeà
HAVE_NETINET_TCP_H


92 
	~<Ãtš‘/tı.h
>

95 #ifdeà
HAVE_INTTYPES_H


96 
	~<š‰y³s.h
>

99 #ifdeà
HAVE_LIBUTIL_H


100 
	~<libut.h
>

103 #ifdeà
HAVE_CRYPT_H


104 
	~<üy±.h
>

107 #iâdeà
DISABLE_ZLIB


108 
	~<zlib.h
>

111 #ifdeà
HAVE_UTIL_H


112 
	~<ut.h
>

115 #ifdeà
HAVE_SHADOW_H


116 
	~<shadow.h
>

119 #ifdeà
HAVE_LIBGEN_H


120 
	~<libg’.h
>

123 #ifdeà
BUNDLED_LIBTOM


124 
	~"libtomüy±/¤c/h—d”s/tomüy±.h
"

125 
	~"libtomm©h/tomm©h.h
"

127 
	~<tomüy±.h
>

128 
	~<tomm©h.h
>

132 
	~"com·t.h
"

133 
	~"çke-rfc2553.h
"

135 #iâdeà
HAVE_UINT16_T


136 #iâdeà
HAVE_U_INT16_T


137 
	tu_št16_t
;

139 
u_št16_t
 
	tušt16_t
;

142 #iâdeà
LOG_AUTHPRIV


143 
	#LOG_AUTHPRIV
 
LOG_AUTH


	)

147 #ifdeà
UNUSED


148 #–ià
defšed
(
__GNUC__
)

149 
	#UNUSED
(
x
è
UNUSED_
 ## x 
	`__©Œibu‹__
((
unu£d
))

	)

150 #–ià
defšed
(
__LCLINT__
)

151 
	#UNUSED
(
x
è 
	)
x

153 
	#UNUSED
(
x
è
	)
x

	@kex.h

25 #iâdeà
_KEX_H_


26 
	#_KEX_H_


	)

28 
	~"šşudes.h
"

29 
	~"®go.h
"

31 
£nd_msg_kexš™
();

32 
»cv_msg_kexš™
();

33 
£nd_msg_Ãwkeys
();

34 
»cv_msg_Ãwkeys
();

35 
kexfœ¡š™Ÿli£
();

36 
g’_kexdh_v®s
(
mp_št
 *
dh_pub
, mp_šˆ*
dh_´iv
);

37 
kexdh_comb_key
(
mp_št
 *
dh_pub_us
, mp_šˆ*
dh_´iv
, mp_šˆ*
dh_pub_them
,

38 
sign_key
 *
ho¡key
);

40 #iâdeà
DISABLE_ZLIB


41 
is_com´ess_Œªs
();

42 
is_com´ess_»cv
();

45 
»cv_msg_kexdh_š™
();

47 
£nd_msg_kexdh_š™
();

48 
»cv_msg_kexdh_»¶y
();

50 
	sKEXS‹
 {

52 
	m£Ákexš™
 : 1;

53 
	m»cvkexš™
 : 1;

54 
	mfœ¡fŞlows
 : 1;

55 
	m£ÁÃwkeys
 : 1;

56 
	m»cvÃwkeys
 : 1;

58 
	mdÚefœ¡kex
 : 1;

61 
time_t
 
	mÏ¡kextime
;

62 
	md©©¿ns
;

63 
	md©¬ecv
;

67 
	#MAX_KEXHASHBUF
 2000

	)

	@keyimport.c

35 
	~"keyimpÜt.h
"

36 
	~"bignum.h
"

37 
	~"bufãr.h
"

38 
	~"dbut.h
"

40 
	#PUT_32BIT
(
ı
, 
v®ue
) do { \

41 (
ı
)[3] = ()(
v®ue
); \

42 (
ı
)[2] = ()((
v®ue
) >> 8); \

43 (
ı
)[1] = ()((
v®ue
) >> 16); \

44 (
ı
)[0] = ()((
v®ue
è>> 24); } 0)

	)

46 
	#GET_32BIT
(
ı
) \

47 ((()()(
ı
)[0] << 24) | \

48 (()()(
ı
)[1] << 16) | \

49 (()()(
ı
)[2] << 8) | \

50 (()()(
ı
)[3]))

	)

52 
İ’ssh_’üy±ed
(cÚ¡ *
f’ame
);

53 
sign_key
 *
İ’ssh_»ad
(cÚ¡ *
f’ame
, *
·s¥h¿£
);

54 
İ’ssh_wr™e
(cÚ¡ *
f’ame
, 
sign_key
 *
key
,

55 *
·s¥h¿£
);

57 
drİb—r_wr™e
(cÚ¡ *
f’ame
, 
sign_key
 * 
key
);

58 
sign_key
 *
drİb—r_»ad
(cÚ¡ * 
f’ame
);

61 
sshcom_’üy±ed
(cÚ¡ *
f’ame
, **
comm’t
);

62 
ssh2_u£rkey
 *
sshcom_»ad
(cÚ¡ *
f’ame
, *
·s¥h¿£
);

63 
sshcom_wr™e
(cÚ¡ *
f’ame
, 
ssh2_u£rkey
 *
key
,

64 *
·s¥h¿£
);

67 
	$impÜt_’üy±ed
(cÚ¡ * 
f’ame
, 
f‘y³
) {

69 ià(
f‘y³
 =ğ
KEYFILE_OPENSSH
) {

70  
	`İ’ssh_’üy±ed
(
f’ame
);

72 } ià(
f‘y³
 =ğ
KEYFILE_SSHCOM
) {

73  
	`sshcom_’üy±ed
(
f’ame
, 
NULL
);

77 
	}
}

79 
sign_key
 *
	$impÜt_»ad
(cÚ¡ *
f’ame
, *
·s¥h¿£
, 
f‘y³
) {

81 ià(
f‘y³
 =ğ
KEYFILE_OPENSSH
) {

82  
	`İ’ssh_»ad
(
f’ame
, 
·s¥h¿£
);

83 } ià(
f‘y³
 =ğ
KEYFILE_DROPBEAR
) {

84  
	`drİb—r_»ad
(
f’ame
);

86 } ià(
f‘y³
 =ğ
KEYFILE_SSHCOM
) {

87  
	`sshcom_»ad
(
f’ame
, 
·s¥h¿£
);

90  
NULL
;

91 
	}
}

93 
	$impÜt_wr™e
(cÚ¡ *
f’ame
, 
sign_key
 *
key
, *
·s¥h¿£
,

94 
f‘y³
) {

96 ià(
f‘y³
 =ğ
KEYFILE_OPENSSH
) {

97  
	`İ’ssh_wr™e
(
f’ame
, 
key
, 
·s¥h¿£
);

98 } ià(
f‘y³
 =ğ
KEYFILE_DROPBEAR
) {

99  
	`drİb—r_wr™e
(
f’ame
, 
key
);

101 } ià(
f‘y³
 =ğ
KEYFILE_SSHCOM
) {

102  
	`sshcom_wr™e
(
f’ame
, 
key
, 
·s¥h¿£
);

106 
	}
}

108 
sign_key
 *
	$drİb—r_»ad
(cÚ¡ * 
f’ame
) {

110 
bufãr
 * 
buf
 = 
NULL
;

111 
sign_key
 *
»t
 = 
NULL
;

112 
ty³
;

114 
buf
 = 
	`buf_Ãw
(
MAX_PRIVKEY_SIZE
);

115 ià(
	`buf_»adfe
(
buf
, 
f’ame
è=ğ
DROPBEAR_FAILURE
) {

116 
”rÜ
;

119 
	`buf_£os
(
buf
, 0);

120 
»t
 = 
	`Ãw_sign_key
();

122 
ty³
 = 
DROPBEAR_SIGNKEY_ANY
;

123 ià(
	`buf_g‘_´iv_key
(
buf
, 
»t
, &
ty³
è=ğ
DROPBEAR_FAILURE
){

124 
”rÜ
;

126 
	`buf_ä“
(
buf
);

128  
»t
;

130 
”rÜ
:

131 ià(
buf
) {

132 
	`buf_ä“
(
buf
);

134 ià(
»t
) {

135 
	`sign_key_ä“
(
»t
);

137  
NULL
;

138 
	}
}

141 
	$drİb—r_wr™e
(cÚ¡ *
f’ame
, 
sign_key
 * 
key
) {

143 
keyty³
 = -1;

144 
bufãr
 * 
buf
;

145 
FILE
*
å
;

146 
Ën
;

147 
»t
;

149 #ifdeà
DROPBEAR_RSA


150 ià(
key
->
r§key
 !ğ
NULL
) {

151 
keyty³
 = 
DROPBEAR_SIGNKEY_RSA
;

154 #ifdeà
DROPBEAR_DSS


155 ià(
key
->
dsskey
 !ğ
NULL
) {

156 
keyty³
 = 
DROPBEAR_SIGNKEY_DSS
;

160 
buf
 = 
	`buf_Ãw
(
MAX_PRIVKEY_SIZE
);

161 
	`buf_put_´iv_key
(
buf
, 
key
, 
keyty³
);

163 
å
 = 
	`fİ’
(
f’ame
, "w");

164 ià(!
å
) {

165 
»t
 = 0;

166 
out
;

169 
	`buf_£os
(
buf
, 0);

171 
Ën
 = 
	`fwr™e
(
	`buf_g‘±r
(
buf
, buf->ËÀ- buf->
pos
),

172 1, 
buf
->
Ën
 - buf->
pos
, 
å
);

173 
	`buf_šüpos
(
buf
, 
Ën
);

174 } 
Ën
 > 0 && 
buf
->ËÀ!ğbuf->
pos
);

176 
	`fşo£
(
å
);

178 ià(
buf
->
pos
 !ğbuf->
Ën
) {

179 
»t
 = 0;

181 
»t
 = 1;

183 
out
:

184 
	`buf_ä“
(
buf
);

185  
»t
;

186 
	}
}

193 
	#isba£64
(
c
) ( ((c) >= 'A' && (c) <= 'Z') || \

194 ((
c
) >= 'a' && (c) <= 'z') || \

195 ((
c
) >= '0' && (c) <= '9') || \

196 (
c
) == '+' || (c) == '/' || (c) == '=' \

197 )

	)

200 
	$ba£64_’code_å
(
FILE
 * 
å
, *
d©a
,

201 
d©®’
, 
ıl
)

203 
out
[100];

204 
n
;

205 
ou’
;

206 
¿wıl
;

207 
¿wıl
 = 
ıl
 * 3 / 4;

208 
	`drİb—r_as£¹
(()
ıl
 < (
out
));

210 
d©®’
 > 0) {

211 
n
 = (
d©®’
 < 
¿wıl
 ? datalen :„awcpl);

212 
ou’
 = (
out
);

213 
	`ba£64_’code
(
d©a
, 
n
, 
out
, &
ou’
);

214 
d©a
 +ğ
n
;

215 
d©®’
 -ğ
n
;

216 
	`fwr™e
(
out
, 1, 
ou’
, 
å
);

217 
	`åutc
('\n', 
å
);

219 
	}
}

230 
	#ASN1_CLASS_UNIVERSAL
 (0 << 6)

	)

231 
	#ASN1_CLASS_APPLICATION
 (1 << 6)

	)

232 
	#ASN1_CLASS_CONTEXT_SPECIFIC
 (2 << 6)

	)

233 
	#ASN1_CLASS_PRIVATE
 (3 << 6)

	)

234 
	#ASN1_CLASS_MASK
 (3 << 6)

	)

237 
	#ASN1_CONSTRUCTED
 (1 << 5)

	)

239 
	$b”_»ad_id_Ën
(*
sourû
, 
sourûËn
,

240 *
id
, *
Ëngth
, *
æags
)

242 *
p
 = (*è
sourû
;

244 ià(
sourûËn
 == 0)

247 *
æags
 = (*
p
 & 0xE0);

248 ià((*
p
 & 0x1F) == 0x1F) {

249 *
id
 = 0;

250 *
p
 & 0x80) {

251 *
id
 = (*id << 7è| (*
p
 & 0x7F);

252 
p
++, 
sourûËn
--;

253 ià(
sourûËn
 == 0)

256 *
id
 = (*id << 7è| (*
p
 & 0x7F);

257 
p
++, 
sourûËn
--;

259 *
id
 = *
p
 & 0x1F;

260 
p
++, 
sourûËn
--;

263 ià(
sourûËn
 == 0)

266 ià(*
p
 & 0x80) {

267 
n
 = *
p
 & 0x7F;

268 
p
++, 
sourûËn
--;

269 ià(
sourûËn
 < 
n
)

271 *
Ëngth
 = 0;

272 
n
--)

273 *
Ëngth
 = (*Ëngth << 8è| (*
p
++);

274 
sourûËn
 -ğ
n
;

276 *
Ëngth
 = *
p
;

277 
p
++, 
sourûËn
--;

280  
p
 - (*è
sourû
;

281 
	}
}

289 
	$b”_wr™e_id_Ën
(*
de¡
, 
id
, 
Ëngth
, 
æags
)

291 *
d
 = (*)
de¡
;

292 
Ën
 = 0;

294 ià(
id
 <= 30) {

298 
Ën
++;

299 ià(
d
è*d++ = 
id
 | 
æags
;

301 
n
;

308 
Ën
++;

309 ià(
d
è*d++ = 0x1F | 
æags
;

310 
n
 = 1; (
id
 >> (7*n)) > 0;‚++)

312 
n
--) {

313 
Ën
++;

314 ià(
d
è*d++ = (
n
 ? 0x80 : 0è| ((
id
 >> (7*n)) & 0x7F);

318 ià(
Ëngth
 < 128) {

322 
Ën
++;

323 ià(
d
è*d++ = 
Ëngth
;

325 
n
;

331 
n
 = 1; (
Ëngth
 >> (8*n)) > 0;‚++)

333 
Ën
++;

334 ià(
d
è*d++ = 0x80 | 
n
;

335 
n
--) {

336 
Ën
++;

337 ià(
d
è*d++ = (
Ëngth
 >> (8*
n
)) & 0xFF;

341  
Ën
;

342 
	}
}

346 
	smpšt_pos
 { *
	m¡¬t
; 
	mby‹s
; };

352 ’um { 
	mOSSH_DSA
, 
	mOSSH_RSA
 };

353 
	sİ’ssh_key
 {

354 
	mty³
;

355 
	m’üy±ed
;

356 
	miv
[32];

357 *
	mkeyblob
;

358 
	mkeyblob_Ën
, 
	mkeyblob_size
;

361 
İ’ssh_key
 *
	$lßd_İ’ssh_key
(cÚ¡ *
f’ame
)

363 
İ’ssh_key
 *
»t
;

364 
FILE
 *
å
 = 
NULL
;

365 
bufãr
[256];

366 *
”rmsg
 = 
NULL
, *
p
 = NULL;

367 
h—d”s_dÚe
;

368 
Ën
, 
ou’
;

370 
»t
 = (
İ’ssh_key
*)
	`m_m®loc
((openssh_key));

371 
»t
->
keyblob
 = 
NULL
;

372 
»t
->
keyblob_Ën
 =„‘->
keyblob_size
 = 0;

373 
»t
->
’üy±ed
 = 0;

374 
	`mem£t
(
»t
->
iv
, 0, (ret->iv));

376 ià(
	`¡¾’
(
f’ame
) == 1 && filename[0] == '-') {

377 
å
 = 
¡dš
;

379 
å
 = 
	`fİ’
(
f’ame
, "r");

381 ià(!
å
) {

382 
”rmsg
 = "Unableo open key file";

383 
”rÜ
;

385 ià(!
	`fg‘s
(
bufãr
, (bufãr), 
å
) ||

386 0 !ğ
	`¡ºcmp
(
bufãr
, "-----BEGIN ", 11) ||

387 0 !ğ
	`¡rcmp
(
bufãr
+
	`¡¾’
(buffer)-17, "PRIVATE KEY-----\n")) {

388 
”rmsg
 = "File does‚ot begin with OpenSSH key header";

389 
”rÜ
;

391 ià(!
	`¡rcmp
(
bufãr
, "-----BEGIN RSA PRIVATE KEY-----\n"))

392 
»t
->
ty³
 = 
OSSH_RSA
;

393 ià(!
	`¡rcmp
(
bufãr
, "-----BEGIN DSA PRIVATE KEY-----\n"))

394 
»t
->
ty³
 = 
OSSH_DSA
;

396 
”rmsg
 = "Unrecognised keyype";

397 
”rÜ
;

400 
h—d”s_dÚe
 = 0;

402 ià(!
	`fg‘s
(
bufãr
, (bufãr), 
å
)) {

403 
”rmsg
 = "Unexpectedƒnd of file";

404 
”rÜ
;

406 ià(0 =ğ
	`¡ºcmp
(
bufãr
, "-----END ", 9) &&

407 0 =ğ
	`¡rcmp
(
bufãr
+
	`¡¾’
(buffer)-17, "PRIVATE KEY-----\n"))

409 ià((
p
 = 
	`¡rchr
(
bufãr
, ':')è!ğ
NULL
) {

410 ià(
h—d”s_dÚe
) {

411 
”rmsg
 = "Header found in body of key data";

412 
”rÜ
;

414 *
p
++ = '\0';

415 *
p
 && 
	`is¥aû
(()*p))…++;

416 ià(!
	`¡rcmp
(
bufãr
, "Proc-Type")) {

417 ià(
p
[0] != '4' ||…[1] != ',') {

418 
”rmsg
 = "Proc-Type is‚ot 4 (only 4 is supported)";

419 
”rÜ
;

421 
p
 += 2;

422 ià(!
	`¡rcmp
(
p
, "ENCRYPTED\n"))

423 
»t
->
’üy±ed
 = 1;

424 } ià(!
	`¡rcmp
(
bufãr
, "DEK-Info")) {

425 
i
, 
j
;

427 ià(
	`¡ºcmp
(
p
, "DES-EDE3-CBC,", 13)) {

428 
”rmsg
 = "Ciphers otherhan DES-EDE3-CBC‚ot supported";

429 
”rÜ
;

431 
p
 += 13;

432 
i
 = 0; i < 8; i++) {

433 ià(1 !ğ
	`ssÿnf
(
p
, "%2x", &
j
))

435 
»t
->
iv
[
i
] = 
j
;

436 
p
 += 2;

438 ià(
i
 < 8) {

439 
”rmsg
 = "Expected 16-digit iv in DEK-Info";

440 
”rÜ
;

444 
h—d”s_dÚe
 = 1;

445 
Ën
 = 
	`¡¾’
(
bufãr
);

446 
ou’
 = 
Ën
*4/3;

447 ià(
»t
->
keyblob_Ën
 + 
ou’
 >„‘->
keyblob_size
) {

448 
»t
->
keyblob_size
 =„‘->
keyblob_Ën
 + 
ou’
 + 256;

449 
»t
->
keyblob
 = (*)
	`m_»®loc
(ret->keyblob,

450 
»t
->
keyblob_size
);

452 
ou’
 = 
»t
->
keyblob_size
 -„‘->
keyblob_Ën
;

453 ià(
	`ba£64_decode
(
bufãr
, 
Ën
,

454 
»t
->
keyblob
 +„‘->
keyblob_Ën
, &
ou’
è!ğ
CRYPT_OK
){

455 
”rmsg
 = "Error decoding base64";

456 
”rÜ
;

458 
»t
->
keyblob_Ën
 +ğ
ou’
;

462 ià(
»t
->
keyblob_Ën
 =ğ0 || !»t->
keyblob
) {

463 
”rmsg
 = "Key body‚ot…resent";

464 
”rÜ
;

467 ià(
»t
->
’üy±ed
 &&„‘->
keyblob_Ën
 % 8 != 0) {

468 
”rmsg
 = "Encrypted key blob is‚ot‡ multiple of cipher block size";

469 
”rÜ
;

472 
	`mem£t
(
bufãr
, 0, (buffer));

473  
»t
;

475 
”rÜ
:

476 
	`mem£t
(
bufãr
, 0, (buffer));

477 ià(
»t
) {

478 ià(
»t
->
keyblob
) {

479 
	`mem£t
(
»t
->
keyblob
, 0,„‘->
keyblob_size
);

480 
	`m_ä“
(
»t
->
keyblob
);

482 
	`mem£t
(&
»t
, 0, (ret));

483 
	`m_ä“
(
»t
);

485 ià(
å
) {

486 
	`fşo£
(
å
);

488 ià(
”rmsg
) {

489 
	`årštf
(
¡d”r
, "E¼Ü: %s\n", 
”rmsg
);

491  
NULL
;

492 
	}
}

494 
	$İ’ssh_’üy±ed
(cÚ¡ *
f’ame
)

496 
İ’ssh_key
 *
key
 = 
	`lßd_İ’ssh_key
(
f’ame
);

497 
»t
;

499 ià(!
key
)

501 
»t
 = 
key
->
’üy±ed
;

502 
	`mem£t
(
key
->
keyblob
, 0, key->
keyblob_size
);

503 
	`m_ä“
(
key
->
keyblob
);

504 
	`mem£t
(&
key
, 0, (key));

505 
	`m_ä“
(
key
);

506  
»t
;

507 
	}
}

509 
sign_key
 *
	$İ’ssh_»ad
(cÚ¡ *
f’ame
, *
·s¥h¿£
)

511 
İ’ssh_key
 *
key
;

512 *
p
;

513 
»t
, 
id
, 
Ën
, 
æags
;

514 
i
, 
num_š‹g”s
 = 0;

515 
sign_key
 *
»tv®
 = 
NULL
;

516 *
”rmsg
;

517 *
mod±r
 = 
NULL
;

518 
modËn
 = -9999;

519 
ty³
;

521 
sign_key
 *
»tkey
;

522 
bufãr
 * 
blobbuf
 = 
NULL
;

524 
key
 = 
	`lßd_İ’ssh_key
(
f’ame
);

526 ià(!
key
)

527  
NULL
;

529 ià(
key
->
’üy±ed
) {

530 
”rmsg
 = "encrypted keys‚ot supported currently";

531 
”rÜ
;

542 
MD5CÚ‹xt
 
md5c
;

543 
keybuf
[32];

545 
	`MD5In™
(&
md5c
);

546 
	`MD5Upd©e
(&
md5c
, (*)
·s¥h¿£
, 
	`¡¾’
(passphrase));

547 
	`MD5Upd©e
(&
md5c
, (*)
key
->
iv
, 8);

548 
	`MD5Fš®
(
keybuf
, &
md5c
);

550 
	`MD5In™
(&
md5c
);

551 
	`MD5Upd©e
(&
md5c
, 
keybuf
, 16);

552 
	`MD5Upd©e
(&
md5c
, (*)
·s¥h¿£
, 
	`¡¾’
(passphrase));

553 
	`MD5Upd©e
(&
md5c
, (*)
key
->
iv
, 8);

554 
	`MD5Fš®
(
keybuf
+16, &
md5c
);

559 
	`des3_deüy±_pubkey_ossh
(
keybuf
, (*)
key
->
iv
,

560 
key
->
keyblob
, key->
keyblob_Ën
);

562 
	`mem£t
(&
md5c
, 0, (md5c));

563 
	`mem£t
(
keybuf
, 0, (keybuf));

585 
p
 = 
key
->
keyblob
;

588 
»t
 = 
	`b”_»ad_id_Ën
(
p
, 
key
->
keyblob_Ën
, &
id
, &
Ën
, &
æags
);

589 
p
 +ğ
»t
;

590 ià(
»t
 < 0 || 
id
 != 16) {

591 
”rmsg
 = "ASN.1 decoding failure - wrong…assword?";

592 
”rÜ
;

596 ià(
key
->
ty³
 =ğ
OSSH_RSA
)

597 
num_š‹g”s
 = 9;

598 ià(
key
->
ty³
 =ğ
OSSH_DSA
)

599 
num_š‹g”s
 = 6;

604 
blobbuf
 = 
	`buf_Ãw
(3000);

606 ià(
key
->
ty³
 =ğ
OSSH_DSA
) {

607 
	`buf_put¡ršg
(
blobbuf
, "ssh-dss", 7);

608 } ià(
key
->
ty³
 =ğ
OSSH_RSA
) {

609 
	`buf_put¡ršg
(
blobbuf
, "ssh-rsa", 7);

612 
i
 = 0; i < 
num_š‹g”s
; i++) {

613 
»t
 = 
	`b”_»ad_id_Ën
(
p
, 
key
->
keyblob
+key->
keyblob_Ën
-p,

614 &
id
, &
Ën
, &
æags
);

615 
p
 +ğ
»t
;

616 ià(
»t
 < 0 || 
id
 != 2 ||

617 
key
->
keyblob
+key->
keyblob_Ën
-
p
 < 
Ën
) {

618 
”rmsg
 = "ASN.1 decoding failure";

619 
”rÜ
;

622 ià(
i
 == 0) {

627 ià(
Ën
 !ğ1 || 
p
[0] != 0) {

628 
”rmsg
 = "Version‚umber mismatch";

629 
”rÜ
;

631 } ià(
key
->
ty³
 =ğ
OSSH_RSA
) {

636 ià(
i
 == 1) {

638 
mod±r
 = (*)
p
;

639 
modËn
 = 
Ën
;

640 } ià(
i
 >= 2 && i <= 5) {

641 
	`buf_put¡ršg
(
blobbuf
, 
p
, 
Ën
);

642 ià(
i
 == 2) {

643 
	`buf_put¡ršg
(
blobbuf
, 
mod±r
, 
modËn
);

646 } ià(
key
->
ty³
 =ğ
OSSH_DSA
) {

651 
	`buf_put¡ršg
(
blobbuf
, 
p
, 
Ën
);

655 
p
 +ğ
Ën
;

664 
»tkey
 = 
	`Ãw_sign_key
();

665 
	`buf_£os
(
blobbuf
, 0);

666 
ty³
 = 
DROPBEAR_SIGNKEY_ANY
;

667 ià(
	`buf_g‘_´iv_key
(
blobbuf
, 
»tkey
, &
ty³
)

668 !ğ
DROPBEAR_SUCCESS
) {

669 
”rmsg
 = "unableo create key structure";

670 
	`sign_key_ä“
(
»tkey
);

671 
»tkey
 = 
NULL
;

672 
”rÜ
;

675 
”rmsg
 = 
NULL
;

676 
»tv®
 = 
»tkey
;

678 
”rÜ
:

679 ià(
blobbuf
) {

680 
	`buf_buº
(
blobbuf
);

681 
	`buf_ä“
(
blobbuf
);

683 
	`m_buº
(
key
->
keyblob
, key->
keyblob_size
);

684 
	`m_ä“
(
key
->
keyblob
);

685 
	`m_buº
(
key
, (key));

686 
	`m_ä“
(
key
);

687 ià(
”rmsg
) {

688 
	`årštf
(
¡d”r
, "E¼Ü: %s\n", 
”rmsg
);

690  
»tv®
;

691 
	}
}

693 
	$İ’ssh_wr™e
(cÚ¡ *
f’ame
, 
sign_key
 *
key
,

694 *
·s¥h¿£
)

696 
bufãr
 * 
keyblob
 = 
NULL
;

697 
bufãr
 * 
exŒablob
 = 
NULL
;

698 *
outblob
 = 
NULL
;

699 
ou’
 = -9999;

700 
mpšt_pos
 
numb”s
[9];

701 
Âumb”s
 = -1, 
pos
, 
Ën
, 
£qËn
, 
i
;

702 *
h—d”
 = 
NULL
, *
foÙ”
 = NULL;

703 
z”o
[1];

704 
»t
 = 0;

705 
FILE
 *
å
;

706 
keyty³
 = -1;

708 #ifdeà
DROPBEAR_RSA


709 
mp_št
 
dmp1
, 
dmq1
, 
iqmp
, 
tmpv®
;

711 ià(
key
->
r§key
 !ğ
NULL
) {

712 
keyty³
 = 
DROPBEAR_SIGNKEY_RSA
;

715 #ifdeà
DROPBEAR_DSS


716 ià(
key
->
dsskey
 !ğ
NULL
) {

717 
keyty³
 = 
DROPBEAR_SIGNKEY_DSS
;

721 
	`drİb—r_as£¹
(
keyty³
 != -1);

726 
keyblob
 = 
	`buf_Ãw
(3000);

727 
	`buf_put_´iv_key
(
keyblob
, 
key
, 
keyty³
);

729 
	`buf_£os
(
keyblob
, 0);

731 
	`buf_šüpos
(
keyblob
, 
	`buf_g‘št
(keyblob));

737 
numb”s
[0].
¡¬t
 = 
z”o
;‚umb”s[0].
by‹s
 = 1; zero[0] = '\0';

739 #ifdeà
DROPBEAR_RSA


740 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

742 ià(
key
->
r§key
->
p
 =ğ
NULL
 || key->r§key->
q
 == NULL) {

743 
	`årštf
(
¡d”r
, "Pre-0.33 Dropbear keys cannot be convertedo OpenSSH keys.\n");

744 
”rÜ
;

748 
numb”s
[2].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

749 
numb”s
[2].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[2].
by‹s
);

750 
	`buf_šüpos
(
keyblob
, 
numb”s
[2].
by‹s
);

753 
numb”s
[1].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

754 
numb”s
[1].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[1].
by‹s
);

755 
	`buf_šüpos
(
keyblob
, 
numb”s
[1].
by‹s
);

758 
numb”s
[3].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

759 
numb”s
[3].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[3].
by‹s
);

760 
	`buf_šüpos
(
keyblob
, 
numb”s
[3].
by‹s
);

763 
numb”s
[4].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

764 
numb”s
[4].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[4].
by‹s
);

765 
	`buf_šüpos
(
keyblob
, 
numb”s
[4].
by‹s
);

768 
numb”s
[5].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

769 
numb”s
[5].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[5].
by‹s
);

770 
	`buf_šüpos
(
keyblob
, 
numb”s
[5].
by‹s
);

773 
	`m_mp_š™
(&
tmpv®
);

774 
	`m_mp_š™
(&
dmp1
);

775 
	`m_mp_š™
(&
dmq1
);

776 
	`m_mp_š™
(&
iqmp
);

779 ià(
	`mp_sub_d
(
key
->
r§key
->
p
, 1, &
tmpv®
è!ğ
MP_OKAY
) {

780 
	`årštf
(
¡d”r
, "Bignumƒrror for…-1\n");

781 
”rÜ
;

783 ià(
	`mp_mod
(
key
->
r§key
->
d
, &
tmpv®
, &
dmp1
è!ğ
MP_OKAY
) {

784 
	`årštf
(
¡d”r
, "Bignumƒrror for dmp1\n");

785 
”rÜ
;

789 ià(
	`mp_sub_d
(
key
->
r§key
->
q
, 1, &
tmpv®
è!ğ
MP_OKAY
) {

790 
	`årštf
(
¡d”r
, "Bignumƒrror for q-1\n");

791 
”rÜ
;

793 ià(
	`mp_mod
(
key
->
r§key
->
d
, &
tmpv®
, &
dmq1
è!ğ
MP_OKAY
) {

794 
	`årštf
(
¡d”r
, "Bignumƒrror for dmq1\n");

795 
”rÜ
;

799 ià(
	`mp_švmod
(
key
->
r§key
->
q
, key->r§key->
p
, &
iqmp
è!ğ
MP_OKAY
) {

800 
	`årštf
(
¡d”r
, "Bignumƒrror for iqmp\n");

801 
”rÜ
;

804 
exŒablob
 = 
	`buf_Ãw
(2000);

805 
	`buf_putmpšt
(
exŒablob
, &
dmp1
);

806 
	`buf_putmpšt
(
exŒablob
, &
dmq1
);

807 
	`buf_putmpšt
(
exŒablob
, &
iqmp
);

808 
	`buf_£os
(
exŒablob
, 0);

809 
	`mp_ş—r
(&
dmp1
);

810 
	`mp_ş—r
(&
dmq1
);

811 
	`mp_ş—r
(&
iqmp
);

812 
	`mp_ş—r
(&
tmpv®
);

815 
numb”s
[6].
by‹s
 = 
	`buf_g‘št
(
exŒablob
);

816 
numb”s
[6].
¡¬t
 = 
	`buf_g‘±r
(
exŒablob
,‚umb”s[6].
by‹s
);

817 
	`buf_šüpos
(
exŒablob
, 
numb”s
[6].
by‹s
);

820 
numb”s
[7].
by‹s
 = 
	`buf_g‘št
(
exŒablob
);

821 
numb”s
[7].
¡¬t
 = 
	`buf_g‘±r
(
exŒablob
,‚umb”s[7].
by‹s
);

822 
	`buf_šüpos
(
exŒablob
, 
numb”s
[7].
by‹s
);

825 
numb”s
[8].
by‹s
 = 
	`buf_g‘št
(
exŒablob
);

826 
numb”s
[8].
¡¬t
 = 
	`buf_g‘±r
(
exŒablob
,‚umb”s[8].
by‹s
);

827 
	`buf_šüpos
(
exŒablob
, 
numb”s
[8].
by‹s
);

829 
Âumb”s
 = 9;

830 
h—d”
 = "-----BEGIN RSA PRIVATE KEY-----\n";

831 
foÙ”
 = "-----END RSA PRIVATE KEY-----\n";

835 #ifdeà
DROPBEAR_DSS


836 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

839 
numb”s
[1].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

840 
numb”s
[1].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[1].
by‹s
);

841 
	`buf_šüpos
(
keyblob
, 
numb”s
[1].
by‹s
);

844 
numb”s
[2].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

845 
numb”s
[2].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[2].
by‹s
);

846 
	`buf_šüpos
(
keyblob
, 
numb”s
[2].
by‹s
);

849 
numb”s
[3].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

850 
numb”s
[3].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[3].
by‹s
);

851 
	`buf_šüpos
(
keyblob
, 
numb”s
[3].
by‹s
);

854 
numb”s
[4].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

855 
numb”s
[4].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[4].
by‹s
);

856 
	`buf_šüpos
(
keyblob
, 
numb”s
[4].
by‹s
);

859 
numb”s
[5].
by‹s
 = 
	`buf_g‘št
(
keyblob
);

860 
numb”s
[5].
¡¬t
 = 
	`buf_g‘±r
(
keyblob
,‚umb”s[5].
by‹s
);

861 
	`buf_šüpos
(
keyblob
, 
numb”s
[5].
by‹s
);

863 
Âumb”s
 = 6;

864 
h—d”
 = "-----BEGIN DSA PRIVATE KEY-----\n";

865 
foÙ”
 = "-----END DSA PRIVATE KEY-----\n";

873 
Ën
 = 0;

874 
i
 = 0; i < 
Âumb”s
; i++) {

875 
Ën
 +ğ
	`b”_wr™e_id_Ën
(
NULL
, 2, 
numb”s
[
i
].
by‹s
, 0);

876 
Ën
 +ğ
numb”s
[
i
].
by‹s
;

878 
£qËn
 = 
Ën
;

880 
Ën
 +ğ
	`b”_wr™e_id_Ën
(
NULL
, 16, 
£qËn
, 
ASN1_CONSTRUCTED
);

883 
ou’
 = 
Ën
;

884 ià(
·s¥h¿£
)

885 
ou’
 = (outlen+8) &~ 7;

890 
outblob
 = (*)
	`m_m®loc
(
ou’
);

895 
pos
 = 0;

896 
pos
 +ğ
	`b”_wr™e_id_Ën
(
outblob
+pos, 16, 
£qËn
, 
ASN1_CONSTRUCTED
);

897 
i
 = 0; i < 
Âumb”s
; i++) {

898 
pos
 +ğ
	`b”_wr™e_id_Ën
(
outblob
+pos, 2, 
numb”s
[
i
].
by‹s
, 0);

899 
	`memıy
(
outblob
+
pos
, 
numb”s
[
i
].
¡¬t
,‚umb”s[i].
by‹s
);

900 
pos
 +ğ
numb”s
[
i
].
by‹s
;

920 
	`drİb—r_as£¹
(
pos
 =ğ
Ën
);

921 
pos
 < 
ou’
) {

922 
outblob
[
pos
++] = 
ou’
 - 
Ën
;

928 ià(
·s¥h¿£
) {

929 
	`årštf
(
¡d”r
, "Encrypted keys‡ren't supported currently\n");

930 
”rÜ
;

937 ià(
	`¡¾’
(
f’ame
) == 1 && filename[0] == '-') {

938 
å
 = 
¡dout
;

940 
å
 = 
	`fİ’
(
f’ame
, "wb");

942 ià(!
å
) {

943 
	`årštf
(
¡d”r
, "Failed opening output file\n");

944 
”rÜ
;

946 
	`åuts
(
h—d”
, 
å
);

947 
	`ba£64_’code_å
(
å
, 
outblob
, 
ou’
, 64);

948 
	`åuts
(
foÙ”
, 
å
);

949 
	`fşo£
(
å
);

950 
»t
 = 1;

952 
”rÜ
:

953 ià(
outblob
) {

954 
	`mem£t
(
outblob
, 0, 
ou’
);

955 
	`m_ä“
(
outblob
);

957 ià(
keyblob
) {

958 
	`buf_buº
(
keyblob
);

959 
	`buf_ä“
(
keyblob
);

961 ià(
exŒablob
) {

962 
	`buf_buº
(
exŒablob
);

963 
	`buf_ä“
(
exŒablob
);

965  
»t
;

966 
	}
}

1045 
	#SSHCOM_MAGIC_NUMBER
 0x3f6ff9eb

	)

1047 
	ssshcom_key
 {

1048 
	mcomm’t
[256];

1049 *
	mkeyblob
;

1050 
	mkeyblob_Ën
, 
	mkeyblob_size
;

1053 
sshcom_key
 *
	$lßd_sshcom_key
(cÚ¡ *
f’ame
)

1055 
sshcom_key
 *
»t
;

1056 
FILE
 *
å
;

1057 
bufãr
[256];

1058 
Ën
;

1059 *
”rmsg
, *
p
;

1060 
h—d”s_dÚe
;

1061 
ba£64_b™
[4];

1062 
ba£64_ch¬s
 = 0;

1064 
»t
 = 
	`¢ew
(
sshcom_key
);

1065 
»t
->
comm’t
[0] = '\0';

1066 
»t
->
keyblob
 = 
NULL
;

1067 
»t
->
keyblob_Ën
 =„‘->
keyblob_size
 = 0;

1069 
å
 = 
	`fİ’
(
f’ame
, "r");

1070 ià(!
å
) {

1071 
”rmsg
 = "Unableo open key file";

1072 
”rÜ
;

1074 ià(!
	`fg‘s
(
bufãr
, (bufãr), 
å
) ||

1075 0 !ğ
	`¡rcmp
(
bufãr
, "---- BEGIN SSH2 ENCRYPTED PRIVATE KEY ----\n")) {

1076 
”rmsg
 = "File does‚ot begin with ssh.com key header";

1077 
”rÜ
;

1080 
h—d”s_dÚe
 = 0;

1082 ià(!
	`fg‘s
(
bufãr
, (bufãr), 
å
)) {

1083 
”rmsg
 = "Unexpectedƒnd of file";

1084 
”rÜ
;

1086 ià(!
	`¡rcmp
(
bufãr
, "---- END SSH2 ENCRYPTED PRIVATE KEY ----\n"))

1088 ià((
p
 = 
	`¡rchr
(
bufãr
, ':')è!ğ
NULL
) {

1089 ià(
h—d”s_dÚe
) {

1090 
”rmsg
 = "Header found in body of key data";

1091 
”rÜ
;

1093 *
p
++ = '\0';

1094 *
p
 && 
	`is¥aû
(()*p))…++;

1099 (
Ën
 = 
	`¡¾’
(
p
)è> ()((
bufãr
) - (p-buffer) -1) ||

1100 
p
[
Ën
-1] != '\n' ||…[len-2] == '\\') {

1101 ià(
Ën
 > ()((
p
-
bufãr
) + (buffer)-2)) {

1102 
”rmsg
 = "Header†ineoo†ongo deal with";

1103 
”rÜ
;

1105 ià(!
	`fg‘s
(
p
+
Ën
-2, (
bufãr
)-Õ-bufãr)-Ö’-2), 
å
)) {

1106 
”rmsg
 = "Unexpectedƒnd of file";

1107 
”rÜ
;

1110 
p
[
	`¡rc¥n
(p, "\n")] = '\0';

1111 ià(!
	`¡rcmp
(
bufãr
, "Comment")) {

1113 ià(
p
[0] =ğ'"' &&…[
	`¡¾’
(p)-1] == '"') {

1114 
p
++;

1115 
p
[
	`¡¾’
(p)-1] = '\0';

1117 
	`¡ºıy
(
»t
->
comm’t
, 
p
, (ret->comment));

1118 
»t
->
comm’t
[(ret->comment)-1] = '\0';

1121 
h—d”s_dÚe
 = 1;

1123 
p
 = 
bufãr
;

1124 
	`isba£64
(*
p
)) {

1125 
ba£64_b™
[
ba£64_ch¬s
++] = *
p
;

1126 ià(
ba£64_ch¬s
 == 4) {

1127 
out
[3];

1129 
ba£64_ch¬s
 = 0;

1131 
Ën
 = 
	`ba£64_decode_©om
(
ba£64_b™
, 
out
);

1133 ià(
Ën
 <= 0) {

1134 
”rmsg
 = "Invalid base64ƒncoding";

1135 
”rÜ
;

1138 ià(
»t
->
keyblob_Ën
 + 
Ën
 >„‘->
keyblob_size
) {

1139 
»t
->
keyblob_size
 =„‘->
keyblob_Ën
 + 
Ën
 + 256;

1140 
»t
->
keyblob
 = 
	`¤esize
Ô‘->keyblob,„‘->
keyblob_size
,

1144 
	`memıy
(
»t
->
keyblob
 +„‘->
keyblob_Ën
, 
out
, 
Ën
);

1145 
»t
->
keyblob_Ën
 +ğ
Ën
;

1148 
p
++;

1153 ià(
»t
->
keyblob_Ën
 =ğ0 || !»t->
keyblob
) {

1154 
”rmsg
 = "Key body‚ot…resent";

1155 
”rÜ
;

1158  
»t
;

1160 
”rÜ
:

1161 ià(
»t
) {

1162 ià(
»t
->
keyblob
) {

1163 
	`mem£t
(
»t
->
keyblob
, 0,„‘->
keyblob_size
);

1164 
	`m_ä“
(
»t
->
keyblob
);

1166 
	`mem£t
(&
»t
, 0, (ret));

1167 
	`m_ä“
(
»t
);

1169  
NULL
;

1170 
	}
}

1172 
	$sshcom_’üy±ed
(cÚ¡ *
f’ame
, **
comm’t
)

1174 
sshcom_key
 *
key
 = 
	`lßd_sshcom_key
(
f’ame
);

1175 
pos
, 
Ën
, 
ªsw”
;

1177 *
comm’t
 = 
NULL
;

1178 ià(!
key
)

1184 ià(
	`GET_32BIT
(
key
->
keyblob
) != 0x3f6ff9eb)

1190 
ªsw”
 = 0;

1191 
pos
 = 8;

1192 ià(
key
->
keyblob_Ën
 < 
pos
+4)

1193 
dÚe
;

1194 
pos
 +ğ4 + 
	`GET_32BIT
(
key
->
keyblob
 +…os);

1195 ià(
key
->
keyblob_Ën
 < 
pos
+4)

1196 
dÚe
;

1197 
Ën
 = 
	`GET_32BIT
(
key
->
keyblob
 + 
pos
);

1198 ià(
key
->
keyblob_Ën
 < 
pos
+4+
Ën
)

1199 
dÚe
;

1200 ià(
Ën
 !ğ4 || 0 !ğ
	`memcmp
(
key
->
keyblob
 + 
pos
 + 4, "none", 4))

1201 
ªsw”
 = 1;

1203 
dÚe
:

1204 *
comm’t
 = 
	`dup¡r
(
key
->comment);

1205 
	`mem£t
(
key
->
keyblob
, 0, key->
keyblob_size
);

1206 
	`m_ä“
(
key
->
keyblob
);

1207 
	`mem£t
(&
key
, 0, (key));

1208 
	`m_ä“
(
key
);

1209  
ªsw”
;

1210 
	}
}

1212 
	$sshcom_»ad_mpšt
(*
d©a
, 
Ën
, 
mpšt_pos
 *
»t
)

1214 
b™s
;

1215 
by‹s
;

1216 *
d
 = (*è
d©a
;

1218 ià(
Ën
 < 4)

1219 
”rÜ
;

1220 
b™s
 = 
	`GET_32BIT
(
d
);

1222 
by‹s
 = (
b™s
 + 7) / 8;

1223 ià(
Ën
 < 4+
by‹s
)

1224 
”rÜ
;

1226 
»t
->
¡¬t
 = 
d
 + 4;

1227 
»t
->
by‹s
 = bytes;

1228  
by‹s
+4;

1230 
”rÜ
:

1231 
»t
->
¡¬t
 = 
NULL
;

1232 
»t
->
by‹s
 = -1;

1233  
Ën
;

1234 
	}
}

1236 
	$sshcom_put_mpšt
(*
rg‘
, *
d©a
, 
Ën
)

1238 *
d
 = (*)
rg‘
;

1239 *
i
 = (*)
d©a
;

1240 
b™s
 = 
Ën
 * 8 - 1;

1242 
b™s
 > 0) {

1243 ià(*
i
 & (1 << (
b™s
 & 7)))

1245 ià(!(
b™s
-- & 7))

1246 
i
++, 
Ën
--;

1249 
	`PUT_32BIT
(
d
, 
b™s
+1);

1250 
	`memıy
(
d
+4, 
i
, 
Ën
);

1251  
Ën
+4;

1252 
	}
}

1254 
sign_key
 *
	$sshcom_»ad
(cÚ¡ *
f’ame
, *
·s¥h¿£
)

1256 
sshcom_key
 *
key
 = 
	`lßd_sshcom_key
(
f’ame
);

1257 *
”rmsg
;

1258 
pos
, 
Ën
;

1259 cÚ¡ 
´efix_r§
[] = "if-modn{sign{rsa";

1260 cÚ¡ 
´efix_d§
[] = "dl-modp{sign{dsa";

1261 ’um { 
RSA
, 
DSA
 } 
ty³
;

1262 
’üy±ed
;

1263 *
ch”‹xt
;

1264 
ch”Ën
;

1265 
ssh2_u£rkey
 *
»t
 = 
NULL
, *
»tkey
;

1266 cÚ¡ 
ssh_signkey
 *
®g
;

1267 *
blob
 = 
NULL
;

1268 
blobsize
, 
pubËn
, 
´ivËn
;

1270 ià(!
key
)

1271  
NULL
;

1276 ià(
	`GET_32BIT
(
key
->
keyblob
è!ğ
SSHCOM_MAGIC_NUMBER
) {

1277 
”rmsg
 = "Key does‚ot begin with magic‚umber";

1278 
”rÜ
;

1284 
pos
 = 8;

1285 ià(
key
->
keyblob_Ën
 < 
pos
+4 ||

1286 (
Ën
 = 
	`GET_32BIT
(
key
->
keyblob
 + 
pos
)è> key->
keyblob_Ën
 -…os - 4) {

1287 
”rmsg
 = "Key blob does‚ot contain‡ keyype string";

1288 
”rÜ
;

1290 ià(
Ën
 > (
´efix_r§
) - 1 &&

1291 !
	`memcmp
(
key
->
keyblob
+
pos
+4, 
´efix_r§
, (prefix_rsa) - 1)) {

1292 
ty³
 = 
RSA
;

1293 } ià(
Ën
 > (
´efix_d§
) - 1 &&

1294 !
	`memcmp
(
key
->
keyblob
+
pos
+4, 
´efix_d§
, (prefix_dsa) - 1)) {

1295 
ty³
 = 
DSA
;

1297 
”rmsg
 = "Key is of unknownype";

1298 
”rÜ
;

1300 
pos
 +ğ4+
Ën
;

1305 ià(
key
->
keyblob_Ën
 < 
pos
+4 ||

1306 (
Ën
 = 
	`GET_32BIT
(
key
->
keyblob
 + 
pos
)è> key->
keyblob_Ën
 -…os - 4) {

1307 
”rmsg
 = "Key blob does‚ot contain‡ cipherype string";

1308 
”rÜ
;

1310 ià(
Ën
 =ğ4 && !
	`memcmp
(
key
->
keyblob
+
pos
+4, "none", 4))

1311 
’üy±ed
 = 0;

1312 ià(
Ën
 =ğ8 && !
	`memcmp
(
key
->
keyblob
+
pos
+4, "3des-cbc", 8))

1313 
’üy±ed
 = 1;

1315 
”rmsg
 = "Keyƒncryption is of unknownype";

1316 
”rÜ
;

1318 
pos
 +ğ4+
Ën
;

1323 ià(
key
->
keyblob_Ën
 < 
pos
+4 ||

1324 (
Ën
 = 
	`GET_32BIT
(
key
->
keyblob
 + 
pos
)è> key->
keyblob_Ën
 -…os - 4) {

1325 
”rmsg
 = "Key blob does‚ot contain‡ctual key data";

1326 
”rÜ
;

1328 
ch”‹xt
 = (*)
key
->
keyblob
 + 
pos
 + 4;

1329 
ch”Ën
 = 
Ën
;

1330 ià(
ch”Ën
 == 0) {

1331 
”rmsg
 = "Length of key data is zero";

1332 
”rÜ
;

1338 ià(
’üy±ed
) {

1347 
MD5CÚ‹xt
 
md5c
;

1348 
keybuf
[32], 
iv
[8];

1350 ià(
ch”Ën
 % 8 != 0) {

1351 
”rmsg
 = "Encrypted…art of key is‚ot‡ multiple of cipher block"

1353 
”rÜ
;

1356 
	`MD5In™
(&
md5c
);

1357 
	`MD5Upd©e
(&
md5c
, (*)
·s¥h¿£
, 
	`¡¾’
(passphrase));

1358 
	`MD5Fš®
(
keybuf
, &
md5c
);

1360 
	`MD5In™
(&
md5c
);

1361 
	`MD5Upd©e
(&
md5c
, (*)
·s¥h¿£
, 
	`¡¾’
(passphrase));

1362 
	`MD5Upd©e
(&
md5c
, 
keybuf
, 16);

1363 
	`MD5Fš®
(
keybuf
+16, &
md5c
);

1368 
	`mem£t
(
iv
, 0, (iv));

1369 
	`des3_deüy±_pubkey_ossh
(
keybuf
, 
iv
, (*)
ch”‹xt
,

1370 
ch”Ën
);

1372 
	`mem£t
(&
md5c
, 0, (md5c));

1373 
	`mem£t
(
keybuf
, 0, (keybuf));

1381 ià(
’üy±ed
)

1382 
»t
 = 
SSH2_WRONG_PASSPHRASE
;

1388 
Ën
 = 
	`GET_32BIT
(
ch”‹xt
);

1389 ià(
Ën
 > 
ch”Ën
-4) {

1390 
”rmsg
 = "containing string was ill-formed";

1391 
”rÜ
;

1393 
ch”‹xt
 += 4;

1394 
ch”Ën
 = 
Ën
;

1401 
blobsize
 = 
ch”Ën
 + 256;

1402 
blob
 = 
	`¢ewn
(
blobsize
, );

1403 
´ivËn
 = 0;

1404 ià(
ty³
 =ğ
RSA
) {

1405 
mpšt_pos
 
n
, 
e
, 
d
, 
u
, 
p
, 
q
;

1406 
pos
 = 0;

1407 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
e
);

1408 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
d
);

1409 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
n
);

1410 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
u
);

1411 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
p
);

1412 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
q
);

1413 ià(!
q
.
¡¬t
) {

1414 
”rmsg
 = "key data did‚ot contain six integers";

1415 
”rÜ
;

1418 
®g
 = &
ssh_r§
;

1419 
pos
 = 0;

1420 
pos
 +ğ
	`put_¡ršg
(
blob
+pos, "ssh-rsa", 7);

1421 
pos
 +ğ
	`put_mp
(
blob
+pos, 
e
.
¡¬t
,ƒ.
by‹s
);

1422 
pos
 +ğ
	`put_mp
(
blob
+pos, 
n
.
¡¬t
,‚.
by‹s
);

1423 
pubËn
 = 
pos
;

1424 
pos
 +ğ
	`put_¡ršg
(
blob
+pos, 
d
.
¡¬t
, d.
by‹s
);

1425 
pos
 +ğ
	`put_mp
(
blob
+pos, 
q
.
¡¬t
, q.
by‹s
);

1426 
pos
 +ğ
	`put_mp
(
blob
+pos, 
p
.
¡¬t
,….
by‹s
);

1427 
pos
 +ğ
	`put_mp
(
blob
+pos, 
u
.
¡¬t
, u.
by‹s
);

1428 
´ivËn
 = 
pos
 - 
pubËn
;

1429 } ià(
ty³
 =ğ
DSA
) {

1430 
mpšt_pos
 
p
, 
q
, 
g
, 
x
, 
y
;

1431 
pos
 = 4;

1432 ià(
	`GET_32BIT
(
ch”‹xt
) != 0) {

1433 
”rmsg
 = "predefined DSA…arameters‚ot supported";

1434 
”rÜ
;

1436 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
p
);

1437 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
g
);

1438 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
q
);

1439 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
y
);

1440 
pos
 +ğ
	`sshcom_»ad_mpšt
(
ch”‹xt
+pos, 
ch”Ën
-pos, &
x
);

1441 ià(!
x
.
¡¬t
) {

1442 
”rmsg
 = "key data did‚ot contain five integers";

1443 
”rÜ
;

1446 
®g
 = &
ssh_dss
;

1447 
pos
 = 0;

1448 
pos
 +ğ
	`put_¡ršg
(
blob
+pos, "ssh-dss", 7);

1449 
pos
 +ğ
	`put_mp
(
blob
+pos, 
p
.
¡¬t
,….
by‹s
);

1450 
pos
 +ğ
	`put_mp
(
blob
+pos, 
q
.
¡¬t
, q.
by‹s
);

1451 
pos
 +ğ
	`put_mp
(
blob
+pos, 
g
.
¡¬t
, g.
by‹s
);

1452 
pos
 +ğ
	`put_mp
(
blob
+pos, 
y
.
¡¬t
, y.
by‹s
);

1453 
pubËn
 = 
pos
;

1454 
pos
 +ğ
	`put_mp
(
blob
+pos, 
x
.
¡¬t
, x.
by‹s
);

1455 
´ivËn
 = 
pos
 - 
pubËn
;

1458 
	`drİb—r_as£¹
(
´ivËn
 > 0);

1460 
»tkey
 = 
	`¢ew
(
ssh2_u£rkey
);

1461 
»tkey
->
®g
 =‡lg;

1462 
»tkey
->
d©a
 = 
®g
->
	`ü—‹key
(
blob
, 
pubËn
, blob+pubËn, 
´ivËn
);

1463 ià(!
»tkey
->
d©a
) {

1464 
	`m_ä“
(
»tkey
);

1465 
”rmsg
 = "unableo create key data structure";

1466 
”rÜ
;

1468 
»tkey
->
comm’t
 = 
	`dup¡r
(
key
->comment);

1470 
”rmsg
 = 
NULL
;

1471 
»t
 = 
»tkey
;

1473 
”rÜ
:

1474 ià(
blob
) {

1475 
	`mem£t
(
blob
, 0, 
blobsize
);

1476 
	`m_ä“
(
blob
);

1478 
	`mem£t
(
key
->
keyblob
, 0, key->
keyblob_size
);

1479 
	`m_ä“
(
key
->
keyblob
);

1480 
	`mem£t
(&
key
, 0, (key));

1481 
	`m_ä“
(
key
);

1482  
»t
;

1483 
	}
}

1485 
	$sshcom_wr™e
(cÚ¡ *
f’ame
, 
sign_key
 *
key
,

1486 *
·s¥h¿£
)

1488 *
pubblob
, *
´ivblob
;

1489 
pubËn
, 
´ivËn
;

1490 *
outblob
;

1491 
ou’
;

1492 
mpšt_pos
 
numb”s
[6];

1493 
Âumb”s
, 
š™Ÿl_z”o
, 
pos
, 
ËÅos
, 
i
;

1494 *
ty³
;

1495 *
ch”‹xt
;

1496 
ch”Ën
;

1497 
»t
 = 0;

1498 
FILE
 *
å
;

1503 
pubblob
 = 
key
->
®g
->
	`public_blob
(key->
d©a
, &
pubËn
);

1504 
´ivblob
 = 
key
->
®g
->
	`´iv©e_blob
(key->
d©a
, &
´ivËn
);

1505 
outblob
 = 
NULL
;

1511 ià(
key
->
®g
 =ğ&
ssh_r§
) {

1512 
pos
;

1513 
mpšt_pos
 
n
, 
e
, 
d
, 
p
, 
q
, 
iqmp
;

1515 
pos
 = 4 + 
	`GET_32BIT
(
pubblob
);

1516 
pos
 +ğ
	`ssh2_»ad_mpšt
(
pubblob
+pos, 
pubËn
-pos, &
e
);

1517 
pos
 +ğ
	`ssh2_»ad_mpšt
(
pubblob
+pos, 
pubËn
-pos, &
n
);

1518 
pos
 = 0;

1519 
pos
 +ğ
	`ssh2_»ad_mpšt
(
´ivblob
+pos, 
´ivËn
-pos, &
d
);

1520 
pos
 +ğ
	`ssh2_»ad_mpšt
(
´ivblob
+pos, 
´ivËn
-pos, &
p
);

1521 
pos
 +ğ
	`ssh2_»ad_mpšt
(
´ivblob
+pos, 
´ivËn
-pos, &
q
);

1522 
pos
 +ğ
	`ssh2_»ad_mpšt
(
´ivblob
+pos, 
´ivËn
-pos, &
iqmp
);

1524 
	`drİb—r_as£¹
(
e
.
¡¬t
 && 
iqmp
.start);

1526 
numb”s
[0] = 
e
;

1527 
numb”s
[1] = 
d
;

1528 
numb”s
[2] = 
n
;

1529 
numb”s
[3] = 
iqmp
;

1530 
numb”s
[4] = 
q
;

1531 
numb”s
[5] = 
p
;

1533 
Âumb”s
 = 6;

1534 
š™Ÿl_z”o
 = 0;

1535 
ty³
 = "if-modn{sign{rsa-pkcs1-sha1},encrypt{rsa-pkcs1v2-oaep}}";

1536 } ià(
key
->
®g
 =ğ&
ssh_dss
) {

1537 
pos
;

1538 
mpšt_pos
 
p
, 
q
, 
g
, 
y
, 
x
;

1540 
pos
 = 4 + 
	`GET_32BIT
(
pubblob
);

1541 
pos
 +ğ
	`ssh2_»ad_mpšt
(
pubblob
+pos, 
pubËn
-pos, &
p
);

1542 
pos
 +ğ
	`ssh2_»ad_mpšt
(
pubblob
+pos, 
pubËn
-pos, &
q
);

1543 
pos
 +ğ
	`ssh2_»ad_mpšt
(
pubblob
+pos, 
pubËn
-pos, &
g
);

1544 
pos
 +ğ
	`ssh2_»ad_mpšt
(
pubblob
+pos, 
pubËn
-pos, &
y
);

1545 
pos
 = 0;

1546 
pos
 +ğ
	`ssh2_»ad_mpšt
(
´ivblob
+pos, 
´ivËn
-pos, &
x
);

1548 
	`drİb—r_as£¹
(
y
.
¡¬t
 && 
x
.start);

1550 
numb”s
[0] = 
p
;

1551 
numb”s
[1] = 
g
;

1552 
numb”s
[2] = 
q
;

1553 
numb”s
[3] = 
y
;

1554 
numb”s
[4] = 
x
;

1556 
Âumb”s
 = 5;

1557 
š™Ÿl_z”o
 = 1;

1558 
ty³
 = "dl-modp{sign{dsa-nist-sha1},dh{plain}}";

1560 
	`drİb—r_as£¹
(0);

1568 
ou’
 = 512;

1569 
i
 = 0; i < 
Âumb”s
; i++)

1570 
ou’
 +ğ4 + 
numb”s
[
i
].
by‹s
;

1571 
outblob
 = 
	`¢ewn
(
ou’
, );

1576 
pos
 = 0;

1577 
	`PUT_32BIT
(
outblob
+
pos
, 
SSHCOM_MAGIC_NUMBER
);…os += 4;

1578 
pos
 += 4;

1579 
pos
 +ğ
	`put_¡ršg
(
outblob
+pos, 
ty³
, 
	`¡¾’
(type));

1581 *
ch”ty³
 = 
·s¥h¿£
 ? "3des-cbc" : "none";

1582 
pos
 +ğ
	`put_¡ršg
(
outblob
+pos, 
ch”ty³
, 
	`¡¾’
(ciphertype));

1584 
ËÅos
 = 
pos
;

1585 
pos
 += 4;

1586 
pos
 += 4;

1587 ià(
š™Ÿl_z”o
) {

1588 
	`PUT_32BIT
(
outblob
+
pos
, 0);

1589 
pos
 += 4;

1591 
i
 = 0; i < 
Âumb”s
; i++)

1592 
pos
 +ğ
	`sshcom_put_mpšt
(
outblob
+pos,

1593 
numb”s
[
i
].
¡¬t
,‚umb”s[i].
by‹s
);

1595 
	`PUT_32BIT
(
outblob
+
ËÅos
+4, 
pos
 - (lenpos+8));

1597 ià(
·s¥h¿£
) {

1598 
·ddšg
 = -(
pos
 - (
ËÅos
+4)) & 7;

1599 
·ddšg
--)

1600 
outblob
[
pos
++] = 
	`¿ndom_by‹
();

1602 
ch”‹xt
 = (*)
outblob
+
ËÅos
+4;

1603 
ch”Ën
 = 
pos
 - (
ËÅos
+4);

1604 
	`drİb—r_as£¹
(!
·s¥h¿£
 || 
ch”Ën
 % 8 == 0);

1606 
	`PUT_32BIT
(
outblob
+
ËÅos
, 
ch”Ën
);

1608 
	`PUT_32BIT
(
outblob
+4, 
pos
);

1610 
	`drİb—r_as£¹
(
pos
 < 
ou’
);

1615 ià(
·s¥h¿£
) {

1624 
MD5CÚ‹xt
 
md5c
;

1625 
keybuf
[32], 
iv
[8];

1627 
	`MD5In™
(&
md5c
);

1628 
	`MD5Upd©e
(&
md5c
, (*)
·s¥h¿£
, 
	`¡¾’
(passphrase));

1629 
	`MD5Fš®
(
keybuf
, &
md5c
);

1631 
	`MD5In™
(&
md5c
);

1632 
	`MD5Upd©e
(&
md5c
, (*)
·s¥h¿£
, 
	`¡¾’
(passphrase));

1633 
	`MD5Upd©e
(&
md5c
, 
keybuf
, 16);

1634 
	`MD5Fš®
(
keybuf
+16, &
md5c
);

1639 
	`mem£t
(
iv
, 0, (iv));

1640 
	`des3_’üy±_pubkey_ossh
(
keybuf
, 
iv
, (*)
ch”‹xt
,

1641 
ch”Ën
);

1643 
	`mem£t
(&
md5c
, 0, (md5c));

1644 
	`mem£t
(
keybuf
, 0, (keybuf));

1651 
å
 = 
	`fİ’
(
f’ame
, "wb");

1652 ià(!
å
)

1653 
”rÜ
;

1654 
	`åuts
("---- BEGIN SSH2 ENCRYPTED PRIVATE KEY ----\n", 
å
);

1655 
	`årštf
(
å
, "Comment: \"");

1663 
¦’
 = 60;

1664 *
c
 = 
key
->
comm’t
;

1665 ()
	`¡¾’
(
c
è> 
¦’
) {

1666 
	`årštf
(
å
, "%.*s\\\n", 
¦’
, 
c
);

1667 
c
 +ğ
¦’
;

1668 
¦’
 = 70;

1670 
	`årštf
(
å
, "%s\"\n", 
c
);

1672 
	`ba£64_’code_å
(
å
, 
outblob
, 
pos
, 70);

1673 
	`åuts
("---- END SSH2 ENCRYPTED PRIVATE KEY ----\n", 
å
);

1674 
	`fşo£
(
å
);

1675 
»t
 = 1;

1677 
”rÜ
:

1678 ià(
outblob
) {

1679 
	`mem£t
(
outblob
, 0, 
ou’
);

1680 
	`m_ä“
(
outblob
);

1682 ià(
´ivblob
) {

1683 
	`mem£t
(
´ivblob
, 0, 
´ivËn
);

1684 
	`m_ä“
(
´ivblob
);

1686 ià(
pubblob
) {

1687 
	`mem£t
(
pubblob
, 0, 
pubËn
);

1688 
	`m_ä“
(
pubblob
);

1690  
»t
;

1691 
	}
}

	@keyimport.h

25 #iâdeà
_KEYIMPORT_H_


26 
	#_KEYIMPORT_H_


	)

28 
	~"šşudes.h
"

29 
	~"signkey.h
"

32 
	mKEYFILE_DROPBEAR
,

33 
	mKEYFILE_OPENSSH
,

34 
	mKEYFILE_SSHCOM


37 
impÜt_wr™e
(cÚ¡ *
f’ame
, 
sign_key
 *
key
, *
·s¥h¿£
,

38 
f‘y³
);

39 
sign_key
 *
impÜt_»ad
(cÚ¡ *
f’ame
, *
·s¥h¿£
, 
f‘y³
);

40 
impÜt_’üy±ed
(cÚ¡ * 
f’ame
, 
f‘y³
);

	@libtomcrypt/demos/encrypt.c

10 
	~<tomüy±.h
>

12 
	g”ºo
;

14 
	$u§ge
(*
Çme
)

16 
x
;

18 
	`´štf
("U§ge: % [-d]Óüy±èch” infoutfe\nCh”s:\n", 
Çme
);

19 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

20 
	`´štf
("%s\n",
ch”_desütÜ
[
x
].
Çme
);

22 
	`ex™
(1);

23 
	}
}

25 
	$»gi¡”_®gs
()

27 
x
;

29 #ifdeà
RIJNDAEL


30 
	`»gi¡”_ch”
 (&
«s_desc
);

32 #ifdeà
BLOWFISH


33 
	`»gi¡”_ch”
 (&
blowfish_desc
);

35 #ifdeà
XTEA


36 
	`»gi¡”_ch”
 (&
x‹a_desc
);

38 #ifdeà
RC5


39 
	`»gi¡”_ch”
 (&
rc5_desc
);

41 #ifdeà
RC6


42 
	`»gi¡”_ch”
 (&
rc6_desc
);

44 #ifdeà
SAFERP


45 
	`»gi¡”_ch”
 (&
§ã½_desc
);

47 #ifdeà
TWOFISH


48 
	`»gi¡”_ch”
 (&
twofish_desc
);

50 #ifdeà
SAFER


51 
	`»gi¡”_ch”
 (&
§ãr_k64_desc
);

52 
	`»gi¡”_ch”
 (&
§ãr_sk64_desc
);

53 
	`»gi¡”_ch”
 (&
§ãr_k128_desc
);

54 
	`»gi¡”_ch”
 (&
§ãr_sk128_desc
);

56 #ifdeà
RC2


57 
	`»gi¡”_ch”
 (&
rc2_desc
);

59 #ifdeà
DES


60 
	`»gi¡”_ch”
 (&
des_desc
);

61 
	`»gi¡”_ch”
 (&
des3_desc
);

63 #ifdeà
CAST5


64 
	`»gi¡”_ch”
 (&
ÿ¡5_desc
);

66 #ifdeà
NOEKEON


67 
	`»gi¡”_ch”
 (&
nÛkeÚ_desc
);

69 #ifdeà
SKIPJACK


70 
	`»gi¡”_ch”
 (&
skjack_desc
);

72 #ifdeà
KHAZAD


73 
	`»gi¡”_ch”
 (&
khazad_desc
);

75 #ifdeà
ANUBIS


76 
	`»gi¡”_ch”
 (&
ªubis_desc
);

79 ià(
	`»gi¡”_hash
(&
sha256_desc
) == -1) {

80 
	`´štf
("Error„egistering SHA256\n");

81 
	`ex™
(-1);

84 ià(
	`»gi¡”_´ng
(&
y¬row_desc
) == -1) {

85 
	`´štf
("Error„egistering yarrow PRNG\n");

86 
	`ex™
(-1);

89 ià(
	`»gi¡”_´ng
(&
¥ºg_desc
) == -1) {

90 
	`´štf
("Error„egistering sprng PRNG\n");

91 
	`ex™
(-1);

93 
	}
}

95 
	$maš
(
¬gc
, *
¬gv
[])

97 
¶aš‹xt
[512],
ch”‹xt
[512];

98 
tmpkey
[512], 
key
[
MAXBLOCKSIZE
], 
IV
[MAXBLOCKSIZE];

99 
šbuf
[512];

100 
ou’
, 
y
, 
ivsize
, 
x
, 
deüy±
;

101 
symm‘ric_CTR
 
ùr
;

102 
ch”_idx
, 
hash_idx
, 
ks
;

103 *
šfe
, *
outfe
, *
ch”
;

104 
´ng_¡©e
 
´ng
;

105 
FILE
 *
fdš
, *
fdout
;

108 
	`»gi¡”_®gs
();

110 ià(
¬gc
 < 4) {

111  
	`u§ge
(
¬gv
[0]);

114 ià(!
	`¡rcmp
(
¬gv
[1], "-d")) {

115 
deüy±
 = 1;

116 
ch”
 = 
¬gv
[2];

117 
šfe
 = 
¬gv
[3];

118 
outfe
 = 
¬gv
[4];

120 
deüy±
 = 0;

121 
ch”
 = 
¬gv
[1];

122 
šfe
 = 
¬gv
[2];

123 
outfe
 = 
¬gv
[3];

127 
fdš
 = 
	`fİ’
(
šfe
,"rb");

128 ià(
fdš
 =ğ
NULL
) {

129 
	`³¼Ü
("Can't open input for„eading");

130 
	`ex™
(-1);

133 
fdout
 = 
	`fİ’
(
outfe
,"wb");

134 ià(
fdout
 =ğ
NULL
) {

135 
	`³¼Ü
("Can't open output for writing");

136 
	`ex™
(-1);

139 
ch”_idx
 = 
	`fšd_ch”
(
ch”
);

140 ià(
ch”_idx
 == -1) {

141 
	`´štf
("Invalid cipherƒntered on command†ine.\n");

142 
	`ex™
(-1);

145 
hash_idx
 = 
	`fšd_hash
("sha256");

146 ià(
hash_idx
 == -1) {

147 
	`´štf
("SHA256‚ot found...?\n");

148 
	`ex™
(-1);

151 
ivsize
 = 
ch”_desütÜ
[
ch”_idx
].
block_Ëngth
;

152 
ks
 = 
hash_desütÜ
[
hash_idx
].
hashsize
;

153 ià(
ch”_desütÜ
[
ch”_idx
].
	`keysize
(&
ks
è!ğ
CRYPT_OK
) {

154 
	`´štf
("Invalid keysize???\n");

155 
	`ex™
(-1);

158 
	`´štf
("\nEnter key: ");

159 
	`fg‘s
((*)
tmpkey
,Ñmpkey), 
¡dš
);

160 
ou’
 = (
key
);

161 ià((
”ºo
 = 
	`hash_memÜy
(
hash_idx
,
tmpkey
,
	`¡¾’
((*émpkey),
key
,&
ou’
)è!ğ
CRYPT_OK
) {

162 
	`´štf
("E¼Ü hashšg key: %s\n", 
	`”rÜ_to_¡ršg
(
”ºo
));

163 
	`ex™
(-1);

166 ià(
deüy±
) {

168 ià(
	`ä—d
(
IV
,1,
ivsize
,
fdš
) != ivsize) {

169 
	`´štf
("Error„eading IV from input.\n");

170 
	`ex™
(-1);

173 ià((
”ºo
 = 
	`ùr_¡¬t
(
ch”_idx
,
IV
,
key
,
ks
,0,
CTR_COUNTER_LITTLE_ENDIAN
,&
ùr
)è!ğ
CRYPT_OK
) {

174 
	`´štf
("ùr_¡¬ˆ”rÜ: %s\n",
	`”rÜ_to_¡ršg
(
”ºo
));

175 
	`ex™
(-1);

180 
y
 = 
	`ä—d
(
šbuf
,1,(šbuf),
fdš
);

182 ià((
”ºo
 = 
	`ùr_deüy±
(
šbuf
,
¶aš‹xt
,
y
,&
ùr
)è!ğ
CRYPT_OK
) {

183 
	`´štf
("ùr_deüy±ƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”ºo
));

184 
	`ex™
(-1);

187 ià(
	`fwr™e
(
¶aš‹xt
,1,
y
,
fdout
) != y) {

188 
	`´štf
("Error writingo file.\n");

189 
	`ex™
(-1);

191 } 
y
 =ğ(
šbuf
));

192 
	`fşo£
(
fdš
);

193 
	`fşo£
(
fdout
);

198 ià((
”ºo
 = 
	`ºg_make_´ng
(128, 
	`fšd_´ng
("y¬row"), &
´ng
, 
NULL
)è!ğ
CRYPT_OK
) {

199 
	`´štf
("E¼Ü s‘tšg u°PRNG, %s\n", 
	`”rÜ_to_¡ršg
(
”ºo
));

204 
x
 = 
	`y¬row_»ad
(
IV
,
ivsize
,&
´ng
);

205 ià(
x
 !ğ
ivsize
) {

206 
	`´štf
("Error„eading PRNG for IV„equired.\n");

207 
	`ex™
(-1);

210 ià(
	`fwr™e
(
IV
,1,
ivsize
,
fdout
) != ivsize) {

211 
	`´štf
("Error writing IVo output.\n");

212 
	`ex™
(-1);

215 ià((
”ºo
 = 
	`ùr_¡¬t
(
ch”_idx
,
IV
,
key
,
ks
,0,
CTR_COUNTER_LITTLE_ENDIAN
,&
ùr
)è!ğ
CRYPT_OK
) {

216 
	`´štf
("ùr_¡¬ˆ”rÜ: %s\n",
	`”rÜ_to_¡ršg
(
”ºo
));

217 
	`ex™
(-1);

221 
y
 = 
	`ä—d
(
šbuf
,1,(šbuf),
fdš
);

223 ià((
”ºo
 = 
	`ùr_’üy±
(
šbuf
,
ch”‹xt
,
y
,&
ùr
)è!ğ
CRYPT_OK
) {

224 
	`´štf
("ùr_’üy±ƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”ºo
));

225 
	`ex™
(-1);

228 ià(
	`fwr™e
(
ch”‹xt
,1,
y
,
fdout
) != y) {

229 
	`´štf
("Error writingo output.\n");

230 
	`ex™
(-1);

232 } 
y
 =ğ(
šbuf
));

233 
	`fşo£
(
fdout
);

234 
	`fşo£
(
fdš
);

237 
	}
}

	@libtomcrypt/demos/hashsum.c

10 
	~<tomüy±.h
>

12 
	g”ºo
;

14 
»gi¡”_®gs
();

16 
	$maš
(
¬gc
, **
¬gv
)

18 
idx
, 
x
, 
z
;

19 
w
;

20 
hash_bufãr
[
MAXBLOCKSIZE
];

21 
hash_¡©e
 
md
;

24 
	`»gi¡”_®gs
();

25 ià(
¬gc
 < 2) {

26 
	`´štf
("usage: ./hash‡lgorithm file [file ...]\n");

27 
	`´štf
("Algorithms:\n");

28 
x
 = 0; 
hash_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

29 
	`´štf
(" % (%d)\n", 
hash_desütÜ
[
x
].
Çme
, hash_desütÜ[x].
ID
);

31 
	`ex™
(
EXIT_SUCCESS
);

34 
idx
 = 
	`fšd_hash
(
¬gv
[1]);

35 ià(
idx
 == -1) {

36 
	`årštf
(
¡d”r
, "\nInvalid hash specified on command†ine.\n");

40 ià(
¬gc
 == 2) {

41 
hash_desütÜ
[
idx
].
	`š™
(&
md
);

43 
x
 = 
	`ä—d
(
hash_bufãr
, 1, (hash_bufãr), 
¡dš
);

44 
hash_desütÜ
[
idx
].
	`´oûss
(&
md
, 
hash_bufãr
, 
x
);

45 } 
x
 =ğ(
hash_bufãr
));

46 
hash_desütÜ
[
idx
].
	`dÚe
(&
md
, 
hash_bufãr
);

47 
x
 = 0; x < ()
hash_desütÜ
[
idx
].
hashsize
; x++) {

48 
	`´štf
("%02x",
hash_bufãr
[
x
]);

50 
	`´štf
(" (stdin)\n");

52 
z
 = 2; z < 
¬gc
; z++) {

53 
w
 = (
hash_bufãr
);

54 ià((
”ºo
 = 
	`hash_fe
(
idx
,
¬gv
[
z
],
hash_bufãr
,&
w
)è!ğ
CRYPT_OK
) {

55 
	`´štf
("Fhashƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”ºo
));

57 
x
 = 0; x < ()
hash_desütÜ
[
idx
].
hashsize
; x++) {

58 
	`´štf
("%02x",
hash_bufãr
[
x
]);

60 
	`´štf
(" %s\n", 
¬gv
[
z
]);

64  
EXIT_SUCCESS
;

65 
	}
}

67 
	$»gi¡”_®gs
()

69 
”r
;

71 #ifdeà
TIGER


72 
	`»gi¡”_hash
 (&
tig”_desc
);

74 #ifdeà
MD2


75 
	`»gi¡”_hash
 (&
md2_desc
);

77 #ifdeà
MD4


78 
	`»gi¡”_hash
 (&
md4_desc
);

80 #ifdeà
MD5


81 
	`»gi¡”_hash
 (&
md5_desc
);

83 #ifdeà
SHA1


84 
	`»gi¡”_hash
 (&
sha1_desc
);

86 #ifdeà
SHA224


87 
	`»gi¡”_hash
 (&
sha224_desc
);

89 #ifdeà
SHA256


90 
	`»gi¡”_hash
 (&
sha256_desc
);

92 #ifdeà
SHA384


93 
	`»gi¡”_hash
 (&
sha384_desc
);

95 #ifdeà
SHA512


96 
	`»gi¡”_hash
 (&
sha512_desc
);

98 #ifdeà
RIPEMD128


99 
	`»gi¡”_hash
 (&
rmd128_desc
);

101 #ifdeà
RIPEMD160


102 
	`»gi¡”_hash
 (&
rmd160_desc
);

104 #ifdeà
WHIRLPOOL


105 
	`»gi¡”_hash
 (&
whœÍoŞ_desc
);

107 #ifdeà
CHC_HASH


108 
	`»gi¡”_hash
(&
chc_desc
);

109 ià((
”r
 = 
	`chc_»gi¡”
(
	`»gi¡”_ch”
(&
«s_’c_desc
))è!ğ
CRYPT_OK
) {

110 
	`´štf
("chc_»gi¡”ƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

111 
	`ex™
(
EXIT_FAILURE
);

115 
	}
}

	@libtomcrypt/demos/multi.c

2 
	~<tomüy±.h
>

4 
	$maš
()

6 
key
[16], 
buf
[2][
MAXBLOCKSIZE
];

7 
Ën
, 
Ën2
;

11 
	`»gi¡”_hash
(&
sha256_desc
);

12 
	`»gi¡”_ch”
(&
«s_desc
);

15 
Ën
 = (
buf
[0]);

16 
	`hash_memÜy
(
	`fšd_hash
("sha256"), (*)"h–lo", 5, 
buf
[0], &
Ën
);

17 
Ën2
 = (
buf
[0]);

18 
	`hash_memÜy_muÉi
(
	`fšd_hash
("sha256"), 
buf
[1], &
Ën2
, (*)"h–lo", 5, 
NULL
);

19 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

20 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

21  
EXIT_FAILURE
;

23 
Ën2
 = (
buf
[0]);

24 
	`hash_memÜy_muÉi
(
	`fšd_hash
("sha256"), 
buf
[1], &
Ën2
, (*)"he", 2UL, "Îo", 3UL, 
NULL
, 0);

25 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

26 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

27  
EXIT_FAILURE
;

29 
Ën2
 = (
buf
[0]);

30 
	`hash_memÜy_muÉi
(
	`fšd_hash
("sha256"), 
buf
[1], &
Ën2
, (*)"h", 1UL, "e", 1UL, "l", 1UL, "l", 1UL, "o", 1UL, 
NULL
);

31 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

32 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

33  
EXIT_FAILURE
;

37 
Ën
 = (
buf
[0]);

38 
	`hmac_memÜy
(
	`fšd_hash
("sha256"), 
key
, 16, (*)"h–lo", 5, 
buf
[0], &
Ën
);

39 
Ën2
 = (
buf
[0]);

40 
	`hmac_memÜy_muÉi
(
	`fšd_hash
("sha256"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"h–lo", 5UL, 
NULL
);

41 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

42 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

43  
EXIT_FAILURE
;

45 
Ën2
 = (
buf
[0]);

46 
	`hmac_memÜy_muÉi
(
	`fšd_hash
("sha256"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"he", 2UL, "Îo", 3UL, 
NULL
);

47 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

48 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

49  
EXIT_FAILURE
;

51 
Ën2
 = (
buf
[0]);

52 
	`hmac_memÜy_muÉi
(
	`fšd_hash
("sha256"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"h", 1UL, "e", 1UL, "l", 1UL, "l", 1UL, "o", 1UL, 
NULL
);

53 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

54 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

55  
EXIT_FAILURE
;

59 
Ën
 = (
buf
[0]);

60 
	`omac_memÜy
(
	`fšd_ch”
("«s"), 
key
, 16, (*)"h–lo", 5, 
buf
[0], &
Ën
);

61 
Ën2
 = (
buf
[0]);

62 
	`omac_memÜy_muÉi
(
	`fšd_ch”
("«s"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"h–lo", 5UL, 
NULL
);

63 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

64 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

65  
EXIT_FAILURE
;

67 
Ën2
 = (
buf
[0]);

68 
	`omac_memÜy_muÉi
(
	`fšd_ch”
("«s"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"he", 2UL, "Îo", 3UL, 
NULL
);

69 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

70 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

71  
EXIT_FAILURE
;

73 
Ën2
 = (
buf
[0]);

74 
	`omac_memÜy_muÉi
(
	`fšd_ch”
("«s"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"h", 1UL, "e", 1UL, "l", 1UL, "l", 1UL, "o", 1UL, 
NULL
);

75 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

76 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

77  
EXIT_FAILURE
;

81 
Ën
 = (
buf
[0]);

82 
	`pmac_memÜy
(
	`fšd_ch”
("«s"), 
key
, 16, (*)"h–lo", 5, 
buf
[0], &
Ën
);

83 
Ën2
 = (
buf
[0]);

84 
	`pmac_memÜy_muÉi
(
	`fšd_ch”
("«s"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"h–lo", 5, 
NULL
);

85 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

86 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

87  
EXIT_FAILURE
;

89 
Ën2
 = (
buf
[0]);

90 
	`pmac_memÜy_muÉi
(
	`fšd_ch”
("«s"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"he", 2UL, "Îo", 3UL, 
NULL
);

91 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

92 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

93  
EXIT_FAILURE
;

95 
Ën2
 = (
buf
[0]);

96 
	`pmac_memÜy_muÉi
(
	`fšd_ch”
("«s"), 
key
, 16, 
buf
[1], &
Ën2
, (*)"h", 1UL, "e", 1UL, "l", 1UL, "l", 1UL, "o", 1UL, 
NULL
);

97 ià(
Ën
 !ğ
Ën2
 || 
	`memcmp
(
buf
[0], buf[1],†en)) {

98 
	`´štf
("Faed: %d %lu %lu\n", 
__LINE__
, 
Ën
, 
Ën2
);

99  
EXIT_FAILURE
;

103 
	`´štf
("All…assed\n");

104  
EXIT_SUCCESS
;

105 
	}
}

	@libtomcrypt/demos/small.c

2 
	~<tomüy±.h
>

4 
	$maš
()

6 
	`»gi¡”_ch”
(&
rijnd«l_’c_desc
);

7 
	`»gi¡”_´ng
(&
y¬row_desc
);

8 
	`»gi¡”_hash
(&
sha256_desc
);

10 
	}
}

	@libtomcrypt/demos/test.c

1 
	~<tomüy±_‹¡.h
>

3 
	$maš
()

5 
x
;

6 
	`»g_®gs
();

8 #ifdeà
USE_LTM


9 
Éc_mp
 = 
Ém_desc
;

10 #–ià
	`defšed
(
USE_TFM
)

11 
Éc_mp
 = 
tfm_desc
;

12 #–ià
	`defšed
(
USE_GMP
)

13 
Éc_mp
 = 
gmp_desc
;

15 
Éc_m©h_desütÜ
 
EXT_MATH_LIB
;

16 
Éc_mp
 = 
EXT_MATH_LIB
;

19 
	`´štf
("bud =ğ\n%s\n", 
üy±_bud_£‰šgs
);

20 
	`´štf
("\n¡Üe_‹¡...."); 
	`fæush
(
¡dout
); 
x
 = 
	`¡Üe_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

21 
	`´štf
("\nch”_‹¡..."); 
	`fæush
(
¡dout
); 
x
 = 
	`ch”_hash_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

22 
	`´štf
("\nmodes_‹¡...."); 
	`fæush
(
¡dout
); 
x
 = 
	`modes_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

23 
	`´štf
("\nd”_‹¡......"); 
	`fæush
(
¡dout
); 
x
 = 
	`d”_‹¡s
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

24 
	`´štf
("\nmac_‹¡......"); 
	`fæush
(
¡dout
); 
x
 = 
	`mac_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

25 
	`´štf
("\Åkcs_1_‹¡..."); 
	`fæush
(
¡dout
); 
x
 = 
	`pkcs_1_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

26 
	`´štf
("\Ä§_‹¡......"); 
	`fæush
(
¡dout
); 
x
 = 
	`r§_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

27 
	`´štf
("\Ãcc_‹¡......"); 
	`fæush
(
¡dout
); 
x
 = 
	`ecc_‹¡s
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

28 
	`´štf
("\nd§_‹¡......"); 
	`fæush
(
¡dout
); 
x
 = 
	`d§_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

29 
	`´štf
("\nk©ja_‹¡...."); 
	`fæush
(
¡dout
); 
x
 = 
	`k©ja_‹¡
();…rštf(x ? "çed" : "·s£d");ià(xè
	`ex™
(
EXIT_FAILURE
);

30 
	`´štf
("\n");

31  
EXIT_SUCCESS
;

32 
	}
}

	@libtomcrypt/demos/timing.c

1 
	~<tomüy±_‹¡.h
>

3 
	$maš
()

6 
	`š™_tim”
();

7 
	`»g_®gs
();

9 #ifdeà
USE_LTM


10 
Éc_mp
 = 
Ém_desc
;

11 #–ià
	`defšed
(
USE_TFM
)

12 
Éc_mp
 = 
tfm_desc
;

13 #–ià
	`defšed
(
USE_GMP
)

14 
Éc_mp
 = 
gmp_desc
;

16 
Éc_m©h_desütÜ
 
EXT_MATH_LIB
;

17 
Éc_mp
 = 
EXT_MATH_LIB
;

20 
	`time_keysched
();

21 
	`time_ch”
();

22 
	`time_ch”2
();

23 
	`time_ch”3
();

24 
	`time_ch”4
();

25 
	`time_hash
();

26 
	`time_macs
();

27 
	`time_’cmacs
();

28 
	`time_´ng
();

29 
	`time_muÉ
();

30 
	`time_sqr
();

31 
	`time_r§
();

32 
	`time_ecc
();

33 #ifdeà
USE_LTM


34 
	`time_k©ja
();

36  
EXIT_SUCCESS
;

38 
	}
}

	@libtomcrypt/demos/tv_gen.c

1 
	~<tomüy±.h
>

3 
	$»g_®gs
()

5 
”r
;

7 #ifdeà
RIJNDAEL


8 
	`»gi¡”_ch”
 (&
«s_desc
);

10 #ifdeà
BLOWFISH


11 
	`»gi¡”_ch”
 (&
blowfish_desc
);

13 #ifdeà
XTEA


14 
	`»gi¡”_ch”
 (&
x‹a_desc
);

16 #ifdeà
RC5


17 
	`»gi¡”_ch”
 (&
rc5_desc
);

19 #ifdeà
RC6


20 
	`»gi¡”_ch”
 (&
rc6_desc
);

22 #ifdeà
SAFERP


23 
	`»gi¡”_ch”
 (&
§ã½_desc
);

25 #ifdeà
TWOFISH


26 
	`»gi¡”_ch”
 (&
twofish_desc
);

28 #ifdeà
SAFER


29 
	`»gi¡”_ch”
 (&
§ãr_k64_desc
);

30 
	`»gi¡”_ch”
 (&
§ãr_sk64_desc
);

31 
	`»gi¡”_ch”
 (&
§ãr_k128_desc
);

32 
	`»gi¡”_ch”
 (&
§ãr_sk128_desc
);

34 #ifdeà
RC2


35 
	`»gi¡”_ch”
 (&
rc2_desc
);

37 #ifdeà
DES


38 
	`»gi¡”_ch”
 (&
des_desc
);

39 
	`»gi¡”_ch”
 (&
des3_desc
);

41 #ifdeà
CAST5


42 
	`»gi¡”_ch”
 (&
ÿ¡5_desc
);

44 #ifdeà
NOEKEON


45 
	`»gi¡”_ch”
 (&
nÛkeÚ_desc
);

47 #ifdeà
SKIPJACK


48 
	`»gi¡”_ch”
 (&
skjack_desc
);

50 #ifdeà
ANUBIS


51 
	`»gi¡”_ch”
 (&
ªubis_desc
);

53 #ifdeà
KHAZAD


54 
	`»gi¡”_ch”
 (&
khazad_desc
);

57 #ifdeà
TIGER


58 
	`»gi¡”_hash
 (&
tig”_desc
);

60 #ifdeà
MD2


61 
	`»gi¡”_hash
 (&
md2_desc
);

63 #ifdeà
MD4


64 
	`»gi¡”_hash
 (&
md4_desc
);

66 #ifdeà
MD5


67 
	`»gi¡”_hash
 (&
md5_desc
);

69 #ifdeà
SHA1


70 
	`»gi¡”_hash
 (&
sha1_desc
);

72 #ifdeà
SHA224


73 
	`»gi¡”_hash
 (&
sha224_desc
);

75 #ifdeà
SHA256


76 
	`»gi¡”_hash
 (&
sha256_desc
);

78 #ifdeà
SHA384


79 
	`»gi¡”_hash
 (&
sha384_desc
);

81 #ifdeà
SHA512


82 
	`»gi¡”_hash
 (&
sha512_desc
);

84 #ifdeà
RIPEMD128


85 
	`»gi¡”_hash
 (&
rmd128_desc
);

87 #ifdeà
RIPEMD160


88 
	`»gi¡”_hash
 (&
rmd160_desc
);

90 #ifdeà
WHIRLPOOL


91 
	`»gi¡”_hash
 (&
whœÍoŞ_desc
);

93 #ifdeà
CHC_HASH


94 
	`»gi¡”_hash
(&
chc_desc
);

95 ià((
”r
 = 
	`chc_»gi¡”
(
	`»gi¡”_ch”
(&
«s_desc
))è!ğ
CRYPT_OK
) {

96 
	`´štf
("chc_»gi¡”ƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

97 
	`ex™
(
EXIT_FAILURE
);

101 #ifdeà
USE_LTM


102 
Éc_mp
 = 
Ém_desc
;

103 #–ià
	`defšed
(
USE_TFM
)

104 
Éc_mp
 = 
tfm_desc
;

105 #–ià
	`defšed
(
USE_GMP
)

106 
Éc_mp
 = 
gmp_desc
;

108 
Éc_m©h_desütÜ
 
EXT_MATH_LIB
;

109 
Éc_mp
 = 
EXT_MATH_LIB
;

113 
	}
}

115 
	$hash_g’
()

117 
md
[
MAXBLOCKSIZE
], *
buf
;

118 
ou’
, 
x
, 
y
, 
z
;

119 
FILE
 *
out
;

120 
”r
;

122 
out
 = 
	`fİ’
("hash_tv.txt", "w");

123 ià(
out
 =ğ
NULL
) {

124 
	`³¼Ü
("can't open hash_tv");

127 
	`årštf
(
out
, "Hash Test Vectors:\n\nThese‡rehe hashes of‚n bytes '00 01 02 03 .. (nn-1)'\n\n");

128 
x
 = 0; 
hash_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

129 
buf
 = 
	`XMALLOC
(2 * 
hash_desütÜ
[
x
].
blocksize
 + 1);

130 ià(
buf
 =ğ
NULL
) {

131 
	`³¼Ü
("can't‡lloc mem");

132 
	`ex™
(
EXIT_FAILURE
);

134 
	`årštf
(
out
, "Hash: %s\n", 
hash_desütÜ
[
x
].
Çme
);

135 
y
 = 0; y <ğ(
hash_desütÜ
[
x
].
blocksize
 * 2); y++) {

136 
z
 = 0; z < 
y
; z++) {

137 
buf
[
z
] = ()(z & 255);

139 
ou’
 = (
md
);

140 ià((
”r
 = 
	`hash_memÜy
(
x
, 
buf
, 
y
, 
md
, &
ou’
)è!ğ
CRYPT_OK
) {

141 
	`´štf
("hash_memÜyƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

142 
	`ex™
(
EXIT_FAILURE
);

144 
	`årštf
(
out
, "%3lu: ", 
y
);

145 
z
 = 0; z < 
ou’
; z++) {

146 
	`årštf
(
out
, "%02X", 
md
[
z
]);

148 
	`årštf
(
out
, "\n");

150 
	`årštf
(
out
, "\n");

151 
	`XFREE
(
buf
);

153 
	`fşo£
(
out
);

154 
	}
}

156 
	$ch”_g’
()

158 *
key
, 
±
[
MAXBLOCKSIZE
];

159 
x
, 
y
, 
z
, 
w
;

160 
”r
, 
kl
, 
Ï¡kl
;

161 
FILE
 *
out
;

162 
symm‘ric_key
 
skey
;

164 
out
 = 
	`fİ’
("cipher_tv.txt", "w");

166 
	`årštf
(
out
,

170 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

171 
	`årštf
(
out
, "Ch”: %s\n", 
ch”_desütÜ
[
x
].
Çme
);

174 
Ï¡kl
 = 10000;

175 
y
 = 0; y < 3; y++) {

176 
y
) {

177 0: 
kl
 = 
ch”_desütÜ
[
x
].
mš_key_Ëngth
; ;

178 1: 
kl
 = (
ch”_desütÜ
[
x
].
mš_key_Ëngth
 + ch”_desütÜ[x].
max_key_Ëngth
)/2; ;

179 2: 
kl
 = 
ch”_desütÜ
[
x
].
max_key_Ëngth
; ;

181 ià((
”r
 = 
ch”_desütÜ
[
x
].
	`keysize
(&
kl
)è!ğ
CRYPT_OK
) {

182 
	`´štf
("keysiz”rÜ: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

183 
	`ex™
(
EXIT_FAILURE
);

185 ià(
kl
 =ğ
Ï¡kl
) ;

186 
Ï¡kl
 = 
kl
;

187 
	`årštf
(
out
, "Key Size: %d by‹s\n", 
kl
);

189 
key
 = 
	`XMALLOC
(
kl
);

190 ià(
key
 =ğ
NULL
) {

191 
	`³¼Ü
("can't malloc memory");

192 
	`ex™
(
EXIT_FAILURE
);

195 
z
 = 0; ()z < 
kl
; z++) {

196 
key
[
z
] = ()z;

198 ià((
”r
 = 
ch”_desütÜ
[
x
].
	`£tup
(
key
, 
kl
, 0, &
skey
)è!ğ
CRYPT_OK
) {

199 
	`´štf
("£tu°”rÜ: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

200 
	`ex™
(
EXIT_FAILURE
);

203 
z
 = 0; ()z < 
ch”_desütÜ
[
x
].
block_Ëngth
; z++) {

204 
±
[
z
] = ()z;

206 
w
 = 0; w < 50; w++) {

207 
ch”_desütÜ
[
x
].
	`ecb_’üy±
(
±
,…t, &
skey
);

208 
	`årštf
(
out
, "%2lu: ", 
w
);

209 
z
 = 0; ()z < 
ch”_desütÜ
[
x
].
block_Ëngth
; z++) {

210 
	`årštf
(
out
, "%02X", 
±
[
z
]);

212 
	`årštf
(
out
, "\n");

215 
z
 = 0; z < ()
kl
; z++) {

216 
key
[
z
] = 
±
[z % 
ch”_desütÜ
[
x
].
block_Ëngth
];

218 ià((
”r
 = 
ch”_desütÜ
[
x
].
	`£tup
(
key
, 
kl
, 0, &
skey
)è!ğ
CRYPT_OK
) {

219 
	`´štf
("ch” s‘up2ƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

220 
	`ex™
(
EXIT_FAILURE
);

223 
	`årštf
(
out
, "\n");

224 
	`XFREE
(
key
);

226 
	`årštf
(
out
, "\n");

228 
	`fşo£
(
out
);

229 
	}
}

231 
	$hmac_g’
()

233 
key
[
MAXBLOCKSIZE
], 
ouut
[MAXBLOCKSIZE], *
šput
;

234 
x
, 
y
, 
z
, 
”r
;

235 
FILE
 *
out
;

236 
Ën
;

238 
out
 = 
	`fİ’
("hmac_tv.txt", "w");

240 
	`årštf
(
out
,

245 
x
 = 0; 
hash_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

246 
	`årštf
(
out
, "HMAC-%s\n", 
hash_desütÜ
[
x
].
Çme
);

249 
y
 = 0; y < ()
hash_desütÜ
[
x
].
hashsize
; y++) {

250 
key
[
y
] = (y&255);

253 
šput
 = 
	`XMALLOC
(
hash_desütÜ
[
x
].
blocksize
 * 2 + 1);

254 ià(
šput
 =ğ
NULL
) {

255 
	`³¼Ü
("Can't malloc memory");

256 
	`ex™
(
EXIT_FAILURE
);

259 
y
 = 0; y <ğ()(
hash_desütÜ
[
x
].
blocksize
 * 2); y++) {

260 
z
 = 0; z < 
y
; z++) {

261 
šput
[
z
] = ()(z & 255);

263 
Ën
 = (
ouut
);

264 ià((
”r
 = 
	`hmac_memÜy
(
x
, 
key
, 
hash_desütÜ
[x].
hashsize
, 
šput
, 
y
, 
ouut
, &
Ën
)è!ğ
CRYPT_OK
) {

265 
	`´štf
("E¼Ü hmacšg: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

266 
	`ex™
(
EXIT_FAILURE
);

268 
	`årštf
(
out
, "%3d: ", 
y
);

269 
z
 = 0; z <(è
Ën
; z++) {

270 
	`årštf
(
out
, "%02X", 
ouut
[
z
]);

272 
	`årštf
(
out
, "\n");

275 
	`memıy
(
key
, 
ouut
, 
hash_desütÜ
[
x
].
hashsize
);

277 
	`XFREE
(
šput
);

278 
	`årštf
(
out
, "\n");

280 
	`fşo£
(
out
);

281 
	}
}

283 
	$omac_g’
()

285 
key
[
MAXBLOCKSIZE
], 
ouut
[MAXBLOCKSIZE], 
šput
[MAXBLOCKSIZE*2+2];

286 
”r
, 
x
, 
y
, 
z
, 
kl
;

287 
FILE
 *
out
;

288 
Ën
;

290 
out
 = 
	`fİ’
("omac_tv.txt", "w");

292 
	`årštf
(
out
,

297 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

298 
kl
 = 
ch”_desütÜ
[
x
].
block_Ëngth
;

301 ià(
kl
 != 8 && kl != 16) ;

303 ià(
ch”_desütÜ
[
x
].
	`keysize
(&
kl
è!ğ
CRYPT_OK
) {

304 
kl
 = 
ch”_desütÜ
[
x
].
max_key_Ëngth
;

306 
	`årštf
(
out
, "OMAC-% (%d by‹ key)\n", 
ch”_desütÜ
[
x
].
Çme
, 
kl
);

309 
y
 = 0; y < 
kl
; y++) {

310 
key
[
y
] = (y & 255);

313 
y
 = 0; y <ğ()(
ch”_desütÜ
[
x
].
block_Ëngth
*2); y++) {

314 
z
 = 0; z < 
y
; z++) {

315 
šput
[
z
] = ()(z & 255);

317 
Ën
 = (
ouut
);

318 ià((
”r
 = 
	`omac_memÜy
(
x
, 
key
, 
kl
, 
šput
, 
y
, 
ouut
, &
Ën
)è!ğ
CRYPT_OK
) {

319 
	`´štf
("E¼Ü omacšg: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

320 
	`ex™
(
EXIT_FAILURE
);

322 
	`årštf
(
out
, "%3d: ", 
y
);

323 
z
 = 0; z <()
Ën
; z++) {

324 
	`årštf
(
out
, "%02X", 
ouut
[
z
]);

326 
	`årštf
(
out
, "\n");

329 
z
 = 0; z < 
kl
; z++) {

330 
key
[
z
] = 
ouut
[z % 
Ën
];

333 
	`årštf
(
out
, "\n");

335 
	`fşo£
(
out
);

336 
	}
}

338 
	$pmac_g’
()

340 
key
[
MAXBLOCKSIZE
], 
ouut
[MAXBLOCKSIZE], 
šput
[MAXBLOCKSIZE*2+2];

341 
”r
, 
x
, 
y
, 
z
, 
kl
;

342 
FILE
 *
out
;

343 
Ën
;

345 
out
 = 
	`fİ’
("pmac_tv.txt", "w");

347 
	`årštf
(
out
,

352 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

353 
kl
 = 
ch”_desütÜ
[
x
].
block_Ëngth
;

356 ià(
kl
 != 8 && kl != 16) ;

358 ià(
ch”_desütÜ
[
x
].
	`keysize
(&
kl
è!ğ
CRYPT_OK
) {

359 
kl
 = 
ch”_desütÜ
[
x
].
max_key_Ëngth
;

361 
	`årštf
(
out
, "PMAC-% (%d by‹ key)\n", 
ch”_desütÜ
[
x
].
Çme
, 
kl
);

364 
y
 = 0; y < 
kl
; y++) {

365 
key
[
y
] = (y & 255);

368 
y
 = 0; y <ğ()(
ch”_desütÜ
[
x
].
block_Ëngth
*2); y++) {

369 
z
 = 0; z < 
y
; z++) {

370 
šput
[
z
] = ()(z & 255);

372 
Ën
 = (
ouut
);

373 ià((
”r
 = 
	`pmac_memÜy
(
x
, 
key
, 
kl
, 
šput
, 
y
, 
ouut
, &
Ën
)è!ğ
CRYPT_OK
) {

374 
	`´štf
("E¼Ü omacšg: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

375 
	`ex™
(
EXIT_FAILURE
);

377 
	`årštf
(
out
, "%3d: ", 
y
);

378 
z
 = 0; z <()
Ën
; z++) {

379 
	`årštf
(
out
, "%02X", 
ouut
[
z
]);

381 
	`årštf
(
out
, "\n");

384 
z
 = 0; z < 
kl
; z++) {

385 
key
[
z
] = 
ouut
[z % 
Ën
];

388 
	`årštf
(
out
, "\n");

390 
	`fşo£
(
out
);

391 
	}
}

393 
	$—x_g’
()

395 
”r
, 
kl
, 
x
, 
y1
, 
z
;

396 
FILE
 *
out
;

397 
key
[
MAXBLOCKSIZE
], 
nÚû
[MAXBLOCKSIZE*2], 
h—d”
[MAXBLOCKSIZE*2],

398 
¶aš‹xt
[
MAXBLOCKSIZE
*2], 
g
[MAXBLOCKSIZE];

399 
Ën
;

401 
out
 = 
	`fİ’
("eax_tv.txt", "w");

402 
	`årštf
(
out
, "EAX Test Vectors. Useshe 00010203...NN-1…attern for header/nonce/plaintext/key. The outputs\n"

406 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

407 
kl
 = 
ch”_desütÜ
[
x
].
block_Ëngth
;

410 ià(
kl
 != 8 && kl != 16) ;

412 ià(
ch”_desütÜ
[
x
].
	`keysize
(&
kl
è!ğ
CRYPT_OK
) {

413 
kl
 = 
ch”_desütÜ
[
x
].
max_key_Ëngth
;

415 
	`årštf
(
out
, "EAX-% (%d by‹ key)\n", 
ch”_desütÜ
[
x
].
Çme
, 
kl
);

418 
z
 = 0; z < 
kl
; z++) {

419 
key
[
z
] = (z & 255);

422 
y1
 = 0; y1 <ğ()(
ch”_desütÜ
[
x
].
block_Ëngth
*2); y1++){

423 
z
 = 0; z < 
y1
; z++) {

424 
¶aš‹xt
[
z
] = ()(z & 255);

425 
nÚû
[
z
] = ()(z & 255);

426 
h—d”
[
z
] = ()(z & 255);

428 
Ën
 = (
g
);

429 ià((
”r
 = 
	`—x_’üy±_auth’tiÿ‹_memÜy
(
x
, 
key
, 
kl
, 
nÚû
, 
y1
, 
h—d”
, y1, 
¶aš‹xt
, y1,…Ïš‹xt, 
g
, &
Ën
)è!ğ
CRYPT_OK
) {

430 
	`´štf
("E¼Ü EAX'šg: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

431 
	`ex™
(
EXIT_FAILURE
);

433 
	`årštf
(
out
, "%3d: ", 
y1
);

434 
z
 = 0; z < 
y1
; z++) {

435 
	`årštf
(
out
, "%02X", 
¶aš‹xt
[
z
]);

437 
	`årštf
(
out
, ", ");

438 
z
 = 0; z <()
Ën
; z++) {

439 
	`årštf
(
out
, "%02X", 
g
[
z
]);

441 
	`årštf
(
out
, "\n");

444 
z
 = 0; z < 
kl
; z++) {

445 
key
[
z
] = 
g
[z % 
Ën
];

448 
	`årštf
(
out
, "\n");

450 
	`fşo£
(
out
);

451 
	}
}

453 
	$ocb_g’
()

455 
”r
, 
kl
, 
x
, 
y1
, 
z
;

456 
FILE
 *
out
;

457 
key
[
MAXBLOCKSIZE
], 
nÚû
[MAXBLOCKSIZE*2],

458 
¶aš‹xt
[
MAXBLOCKSIZE
*2], 
g
[MAXBLOCKSIZE];

459 
Ën
;

461 
out
 = 
	`fİ’
("ocb_tv.txt", "w");

462 
	`årštf
(
out
, "OCB Test Vectors. Useshe 00010203...NN-1…attern for‚once/plaintext/key. The outputs\n"

466 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

467 
kl
 = 
ch”_desütÜ
[
x
].
block_Ëngth
;

470 ià(
kl
 != 8 && kl != 16) ;

472 ià(
ch”_desütÜ
[
x
].
	`keysize
(&
kl
è!ğ
CRYPT_OK
) {

473 
kl
 = 
ch”_desütÜ
[
x
].
max_key_Ëngth
;

475 
	`årštf
(
out
, "OCB-% (%d by‹ key)\n", 
ch”_desütÜ
[
x
].
Çme
, 
kl
);

478 
z
 = 0; z < 
kl
; z++) {

479 
key
[
z
] = (z & 255);

483 
z
 = 0; z < 
ch”_desütÜ
[
x
].
block_Ëngth
; z++) {

484 
nÚû
[
z
] = z;

487 
y1
 = 0; y1 <ğ()(
ch”_desütÜ
[
x
].
block_Ëngth
*2); y1++){

488 
z
 = 0; z < 
y1
; z++) {

489 
¶aš‹xt
[
z
] = ()(z & 255);

491 
Ën
 = (
g
);

492 ià((
”r
 = 
	`ocb_’üy±_auth’tiÿ‹_memÜy
(
x
, 
key
, 
kl
, 
nÚû
, 
¶aš‹xt
, 
y1
,…Ïš‹xt, 
g
, &
Ën
)è!ğ
CRYPT_OK
) {

493 
	`´štf
("E¼Ü OCB'šg: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

494 
	`ex™
(
EXIT_FAILURE
);

496 
	`årštf
(
out
, "%3d: ", 
y1
);

497 
z
 = 0; z < 
y1
; z++) {

498 
	`årštf
(
out
, "%02X", 
¶aš‹xt
[
z
]);

500 
	`årštf
(
out
, ", ");

501 
z
 = 0; z <()
Ën
; z++) {

502 
	`årštf
(
out
, "%02X", 
g
[
z
]);

504 
	`årštf
(
out
, "\n");

507 
z
 = 0; z < 
kl
; z++) {

508 
key
[
z
] = 
g
[z % 
Ën
];

511 
	`årštf
(
out
, "\n");

513 
	`fşo£
(
out
);

514 
	}
}

517 
	$ccm_g’
()

519 
”r
, 
kl
, 
x
, 
y1
, 
z
;

520 
FILE
 *
out
;

521 
key
[
MAXBLOCKSIZE
], 
nÚû
[MAXBLOCKSIZE*2],

522 
¶aš‹xt
[
MAXBLOCKSIZE
*2], 
g
[MAXBLOCKSIZE];

523 
Ën
;

525 
out
 = 
	`fİ’
("ccm_tv.txt", "w");

526 
	`årštf
(
out
, "CCM Test Vectors. Useshe 00010203...NN-1…attern for‚once/header/plaintext/key. The outputs\n"

530 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

531 
kl
 = 
ch”_desütÜ
[
x
].
block_Ëngth
;

534 ià(
kl
 != 16) ;

536 ià(
ch”_desütÜ
[
x
].
	`keysize
(&
kl
è!ğ
CRYPT_OK
) {

537 
kl
 = 
ch”_desütÜ
[
x
].
max_key_Ëngth
;

539 
	`årštf
(
out
, "CCM-% (%d by‹ key)\n", 
ch”_desütÜ
[
x
].
Çme
, 
kl
);

542 
z
 = 0; z < 
kl
; z++) {

543 
key
[
z
] = (z & 255);

547 
z
 = 0; z < 
ch”_desütÜ
[
x
].
block_Ëngth
; z++) {

548 
nÚû
[
z
] = z;

551 
y1
 = 0; y1 <ğ()(
ch”_desütÜ
[
x
].
block_Ëngth
*2); y1++){

552 
z
 = 0; z < 
y1
; z++) {

553 
¶aš‹xt
[
z
] = ()(z & 255);

555 
Ën
 = (
g
);

556 ià((
”r
 = 
	`ccm_memÜy
(
x
, 
key
, 
kl
, 
NULL
, 
nÚû
, 13, 
¶aš‹xt
, 
y1
,…Ïš‹xt, y1,…Ïš‹xt, 
g
, &
Ën
, 
CCM_ENCRYPT
)è!ğ
CRYPT_OK
) {

557 
	`´štf
("E¼Ü CCM'šg: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

558 
	`ex™
(
EXIT_FAILURE
);

560 
	`årštf
(
out
, "%3d: ", 
y1
);

561 
z
 = 0; z < 
y1
; z++) {

562 
	`årštf
(
out
, "%02X", 
¶aš‹xt
[
z
]);

564 
	`årštf
(
out
, ", ");

565 
z
 = 0; z <()
Ën
; z++) {

566 
	`årštf
(
out
, "%02X", 
g
[
z
]);

568 
	`årštf
(
out
, "\n");

571 
z
 = 0; z < 
kl
; z++) {

572 
key
[
z
] = 
g
[z % 
Ën
];

575 
	`årštf
(
out
, "\n");

577 
	`fşo£
(
out
);

578 
	}
}

580 
	$gcm_g’
()

582 
”r
, 
kl
, 
x
, 
y1
, 
z
;

583 
FILE
 *
out
;

584 
key
[
MAXBLOCKSIZE
], 
¶aš‹xt
[MAXBLOCKSIZE*2], 
g
[MAXBLOCKSIZE];

585 
Ën
;

587 
out
 = 
	`fİ’
("gcm_tv.txt", "w");

588 
	`årštf
(
out
, "GCM Test Vectors. Useshe 00010203...NN-1…attern for‚once/header/plaintext/key. The outputs\n"

592 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

593 
kl
 = 
ch”_desütÜ
[
x
].
block_Ëngth
;

596 ià(
kl
 != 16) ;

598 ià(
ch”_desütÜ
[
x
].
	`keysize
(&
kl
è!ğ
CRYPT_OK
) {

599 
kl
 = 
ch”_desütÜ
[
x
].
max_key_Ëngth
;

601 
	`årštf
(
out
, "GCM-% (%d by‹ key)\n", 
ch”_desütÜ
[
x
].
Çme
, 
kl
);

604 
z
 = 0; z < 
kl
; z++) {

605 
key
[
z
] = (z & 255);

608 
y1
 = 0; y1 <ğ()(
ch”_desütÜ
[
x
].
block_Ëngth
*2); y1++){

609 
z
 = 0; z < 
y1
; z++) {

610 
¶aš‹xt
[
z
] = ()(z & 255);

612 
Ën
 = (
g
);

613 ià((
”r
 = 
	`gcm_memÜy
(
x
, 
key
, 
kl
, 
¶aš‹xt
, 
y1
,…Ïš‹xt, y1,…Ïš‹xt, y1,…Ïš‹xt, 
g
, &
Ën
, 
GCM_ENCRYPT
)è!ğ
CRYPT_OK
) {

614 
	`´štf
("E¼Ü GCM'šg: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

615 
	`ex™
(
EXIT_FAILURE
);

617 
	`årštf
(
out
, "%3d: ", 
y1
);

618 
z
 = 0; z < 
y1
; z++) {

619 
	`årštf
(
out
, "%02X", 
¶aš‹xt
[
z
]);

621 
	`årštf
(
out
, ", ");

622 
z
 = 0; z <()
Ën
; z++) {

623 
	`årštf
(
out
, "%02X", 
g
[
z
]);

625 
	`årštf
(
out
, "\n");

628 
z
 = 0; z < 
kl
; z++) {

629 
key
[
z
] = 
g
[z % 
Ën
];

632 
	`årštf
(
out
, "\n");

634 
	`fşo£
(
out
);

635 
	}
}

637 
	$ba£64_g’
()

639 
FILE
 *
out
;

640 
d¡
[256], 
¤c
[32];

641 
x
, 
y
, 
Ën
;

643 
out
 = 
	`fİ’
("base64_tv.txt", "w");

644 
	`årštf
(
out
, "Base64 vectors. These‡rehe base64ƒncodings ofhe strings 00,01,02...NN-1\n\n");

645 
x
 = 0; x <= 32; x++) {

646 
y
 = 0; y < 
x
; y++) {

647 
¤c
[
y
] = y;

649 
Ën
 = (
d¡
);

650 
	`ba£64_’code
(
¤c
, 
x
, 
d¡
, &
Ën
);

651 
	`årštf
(
out
, "%2lu: %s\n", 
x
, 
d¡
);

653 
	`fşo£
(
out
);

654 
	}
}

656 
	$m©h_g’
()

658 
	}
}

660 
	$ecc_g’
()

662 
FILE
 *
out
;

663 
¡r
[512];

664 *
k
, *
Üd”
, *
modulus
;

665 
ecc_pošt
 *
G
, *
R
;

666 
x
;

668 
out
 = 
	`fİ’
("ecc_tv.txt", "w");

669 
	`årštf
(
out
, "ecc vectors. These‡re for kG for k=1,3,9,27,...,3**n until k > order ofhe curve outputs‡re <k,x,y>riplets\n\n");

670 
G
 = 
	`Éc_ecc_Ãw_pošt
();

671 
R
 = 
	`Éc_ecc_Ãw_pošt
();

672 
	`mp_š™
(&
k
);

673 
	`mp_š™
(&
Üd”
);

674 
	`mp_š™
(&
modulus
);

676 
x
 = 0; 
Éc_ecc_£ts
[x].
size
 != 0; x++) {

677 
	`årštf
(
out
, "ECC-%d\n", 
Éc_ecc_£ts
[
x
].
size
*8);

678 
	`mp_£t
(
k
, 1);

680 
	`mp_»ad_¿dix
(
Üd”
, (*)
Éc_ecc_£ts
[
x
].order, 16);

681 
	`mp_»ad_¿dix
(
modulus
, (*)
Éc_ecc_£ts
[
x
].
´ime
, 16);

682 
	`mp_»ad_¿dix
(
G
->
x
, (*)
Éc_ecc_£ts
[x].
Gx
, 16);

683 
	`mp_»ad_¿dix
(
G
->
y
, (*)
Éc_ecc_£ts
[
x
].
Gy
, 16);

684 
	`mp_£t
(
G
->
z
, 1);

686 
	`mp_cmp
(
k
, 
Üd”
è=ğ
LTC_MP_LT
) {

687 
Éc_mp
.
	`ecc_±mul
(
k
, 
G
, 
R
, 
modulus
, 1);

688 
	`mp_tohex
(
k
, (*)
¡r
); 
	`årštf
(
out
, "%s, ", (*)str);

689 
	`mp_tohex
(
R
->
x
, (*)
¡r
); 
	`årštf
(
out
, "%s, ", (*)str);

690 
	`mp_tohex
(
R
->
y
, (*)
¡r
); 
	`årštf
(
out
, "%s\n", (*)str);

691 
	`mp_mul_d
(
k
, 3, k);

694 
	`mp_ş—r_muÉi
(
k
, 
Üd”
, 
modulus
, 
NULL
);

695 
	`Éc_ecc_d–_pošt
(
G
);

696 
	`Éc_ecc_d–_pošt
(
R
);

697 
	`fşo£
(
out
);

698 
	}
}

700 
	$Ìw_g’
()

702 
FILE
 *
out
;

703 
tw—k
[16], 
key
[16], 
iv
[16], 
buf
[1024];

704 
x
, 
y
, 
”r
;

705 
symm‘ric_LRW
 
Ìw
;

708 
x
 = 0; x < 16; x++) {

709 
tw—k
[
x
] = 
key
[x] = 
iv
[x] = x;

712 
out
 = 
	`fİ’
("lrw_tv.txt", "w");

713 
x
 = 16; x < ()((
buf
)); x += 16) {

714 ià((
”r
 = 
	`Ìw_¡¬t
(
	`fšd_ch”
("«s"), 
iv
, 
key
, 16, 
tw—k
, 0, &
Ìw
)è!ğ
CRYPT_OK
) {

715 
	`årštf
(
¡d”r
, "E¼Ü s¹šg LRW-AES: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

716 
	`ex™
(
EXIT_FAILURE
);

720 
y
 = 0; y < 
x
; y++) {

721 
buf
[
y
] = y & 255;

724 ià((
”r
 = 
	`Ìw_’üy±
(
buf
, buf, 
x
, &
Ìw
)è!ğ
CRYPT_OK
) {

725 
	`årštf
(
¡d”r
, "E¼Üƒnüy±šg w™h LRW-AES: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

726 
	`ex™
(
EXIT_FAILURE
);

730 
	`årštf
(
out
, "%d:", 
x
);

731 
y
 = 0; y < 
x
; y++) {

732 
	`årštf
(
out
, "%02x", 
buf
[
y
]);

734 
	`årštf
(
out
, "\n");

737 ià((
”r
 = 
	`Ìw_£tiv
(
iv
, 16, &
Ìw
)è!ğ
CRYPT_OK
) {

738 
	`årštf
(
¡d”r
, "E¼Ü s‘tšg IV: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

739 
	`ex™
(
EXIT_FAILURE
);

743 
y
 = 0; y < 16; y++) {

744 
key
[
y
] = 
buf
[y];

745 
iv
[
y
] = 
buf
[(y+16)%
x
];

746 
tw—k
[
y
] = 
buf
[(y+32)%
x
];

749 ià((
”r
 = 
	`Ìw_deüy±
(
buf
, buf, 
x
, &
Ìw
)è!ğ
CRYPT_OK
) {

750 
	`årštf
(
¡d”r
, "E¼Ü deüy±šg w™h LRW-AES: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

751 
	`ex™
(
EXIT_FAILURE
);

755 
	`årštf
(
out
, "%d:", 
x
);

756 
y
 = 0; y < 
x
; y++) {

757 
	`årštf
(
out
, "%02x", 
buf
[
y
]);

759 
	`årštf
(
out
, "\n");

760 
	`Ìw_dÚe
(&
Ìw
);

762 
	`fşo£
(
out
);

763 
	}
}

765 
	$maš
()

767 
	`»g_®gs
();

768 
	`´štf
("G’”©šg hash veùÜs..."); 
	`fæush
(
¡dout
); 
	`hash_g’
();…rintf("done\n");

769 
	`´štf
("G’”©šg ch” veùÜs..."); 
	`fæush
(
¡dout
); 
	`ch”_g’
();…rintf("done\n");

770 
	`´štf
("G’”©šg HMAC veùÜs..."); 
	`fæush
(
¡dout
); 
	`hmac_g’
();…rintf("done\n");

771 
	`´štf
("G’”©šg OMAC veùÜs..."); 
	`fæush
(
¡dout
); 
	`omac_g’
();…rintf("done\n");

772 
	`´štf
("G’”©šg PMAC veùÜs..."); 
	`fæush
(
¡dout
); 
	`pmac_g’
();…rintf("done\n");

773 
	`´štf
("G’”©šg EAX veùÜs..."); 
	`fæush
(
¡dout
); 
	`—x_g’
();…rintf("done\n");

774 
	`´štf
("G’”©šg OCB veùÜs..."); 
	`fæush
(
¡dout
); 
	`ocb_g’
();…rintf("done\n");

775 
	`´štf
("G’”©šg CCM veùÜs..."); 
	`fæush
(
¡dout
); 
	`ccm_g’
();…rintf("done\n");

776 
	`´štf
("G’”©šg GCM veùÜs..."); 
	`fæush
(
¡dout
); 
	`gcm_g’
();…rintf("done\n");

777 
	`´štf
("G’”©šg BASE64 veùÜs..."); 
	`fæush
(
¡dout
); 
	`ba£64_g’
();…rintf("done\n");

778 
	`´štf
("G’”©šg MATH veùÜs..."); 
	`fæush
(
¡dout
); 
	`m©h_g’
();…rintf("done\n");

779 
	`´štf
("G’”©šg ECC veùÜs..."); 
	`fæush
(
¡dout
); 
	`ecc_g’
();…rintf("done\n");

780 
	`´štf
("G’”©šg LRW veùÜs..."); 
	`fæush
(
¡dout
); 
	`Ìw_g’
();…rintf("done\n");

782 
	}
}

	@libtomcrypt/notes/etc/saferp_optimizer.c

3 
	~<¡dio.h
>

4 
	~<¡ršg.h
>

7 
	#SHUF
\

8 
b2
[0] = 
b
[8]; b2[1] = b[11]; b2[2] = b[12]; b2[3] = b[15]; \

9 
b2
[4] = 
b
[2]; b2[5] = b[1]; b2[6] = b[6]; b2[7] = b[5]; \

10 
b2
[8] = 
b
[10]; b2[9] = b[9]; b2[10] = b[14]; b2[11] = b[13]; \

11 
b2
[12] = 
b
[0]; b2[13] = b[7]; b2[14] = b[4]; b2[15] = b[3]; 
	`memıy
(b, b2, (b));

	)

14 
	#iSHUF
(
b
, 
b2
) \

15 
b2
[0] = 
b
[12]; b2[1] = b[5]; b2[2] = b[4]; b2[3] = b[15]; \

16 
b2
[4] = 
b
[14]; b2[5] = b[7]; b2[6] = b[6]; b2[7] = b[13]; \

17 
b2
[8] = 
b
[0]; b2[9] = b[9]; b2[10] = b[8]; b2[11] = b[1]; \

18 
b2
[12] = 
b
[2]; b2[13] = b[11]; b2[14] = b[10]; b2[15] = b[3]; 
	`memıy
(b, b2, (b));

	)

20 
	#ROUND
(
b
, 
i
) \

21 
b
[0] = (
§ãr_ebox
[(b[0] ^ 
skey
->
§ã½
.
K
[
i
][0]) & 255] + skey->saferp.K[i+1][0]) & 255; \

22 
b
[1] = 
§ãr_lbox
[(b[1] + 
skey
->
§ã½
.
K
[
i
][1]) & 255] ^ skey->saferp.K[i+1][1]; \

23 
b
[2] = 
§ãr_lbox
[(b[2] + 
skey
->
§ã½
.
K
[
i
][2]) & 255] ^ skey->saferp.K[i+1][2]; \

24 
b
[3] = (
§ãr_ebox
[(b[3] ^ 
skey
->
§ã½
.
K
[
i
][3]) & 255] + skey->saferp.K[i+1][3]) & 255; \

25 
b
[4] = (
§ãr_ebox
[(b[4] ^ 
skey
->
§ã½
.
K
[
i
][4]) & 255] + skey->saferp.K[i+1][4]) & 255; \

26 
b
[5] = 
§ãr_lbox
[(b[5] + 
skey
->
§ã½
.
K
[
i
][5]) & 255] ^ skey->saferp.K[i+1][5]; \

27 
b
[6] = 
§ãr_lbox
[(b[6] + 
skey
->
§ã½
.
K
[
i
][6]) & 255] ^ skey->saferp.K[i+1][6]; \

28 
b
[7] = (
§ãr_ebox
[(b[7] ^ 
skey
->
§ã½
.
K
[
i
][7]) & 255] + skey->saferp.K[i+1][7]) & 255; \

29 
b
[8] = (
§ãr_ebox
[(b[8] ^ 
skey
->
§ã½
.
K
[
i
][8]) & 255] + skey->saferp.K[i+1][8]) & 255; \

30 
b
[9] = 
§ãr_lbox
[(b[9] + 
skey
->
§ã½
.
K
[
i
][9]) & 255] ^ skey->saferp.K[i+1][9]; \

31 
b
[10] = 
§ãr_lbox
[(b[10] + 
skey
->
§ã½
.
K
[
i
][10]) & 255] ^ skey->saferp.K[i+1][10]; \

32 
b
[11] = (
§ãr_ebox
[(b[11] ^ 
skey
->
§ã½
.
K
[
i
][11]) & 255] + skey->saferp.K[i+1][11]) & 255; \

33 
b
[12] = (
§ãr_ebox
[(b[12] ^ 
skey
->
§ã½
.
K
[
i
][12]) & 255] + skey->saferp.K[i+1][12]) & 255; \

34 
b
[13] = 
§ãr_lbox
[(b[13] + 
skey
->
§ã½
.
K
[
i
][13]) & 255] ^ skey->saferp.K[i+1][13]; \

35 
b
[14] = 
§ãr_lbox
[(b[14] + 
skey
->
§ã½
.
K
[
i
][14]) & 255] ^ skey->saferp.K[i+1][14]; \

36 
b
[15] = (
§ãr_ebox
[(b[15] ^ 
skey
->
§ã½
.
K
[
i
][15]è& 255] + skey->§ã½.K[i+1][15]è& 255;

	)

38 
	$maš
()

40 
b
[16], 
b2
[16], 
x
, 
y
, 
z
;

43 
x
 = 0; x < 16; x++è
b
[x] = x;

45 
	`´štf
(

61 
x
 = 0; x < 8; x++) {

63 
y
 = 0; y < 16; y++) {

64 
	`´štf
("b[%d] = (safer_%cbox[(b[%d] %c skey->saferp.K[%d][%d]) & 255] %c skey->saferp.K[%d][%d]) & 255;\n",

65 
b
[
y
], "–Ë"[y&3], b[y], "^++^"[y&3], 
x
*2, y, "+^^+"[y&3], x*2+1, y);

69 
y
 = 0; y < 4; y++) {

70 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[0], b[0], b[1], b[0], b[1]);

71 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[2], b[2], b[3], b[3], b[2]);

72 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[4], b[4], b[5], b[5], b[4]);

73 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[6], b[6], b[7], b[7], b[6]);

74 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[8], b[8], b[9], b[9], b[8]);

75 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[10], b[10], b[11], b[11], b[10]);

76 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[12], b[12], b[13], b[13], b[12]);

77 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[14], b[14], b[15], b[15], b[14]);

78 ià(
y
 < 3) {

79 
SHUF
;

84 
	`´štf
(

87 
x
 = 0; x < 16; x++) {

88 
	`´štf
(

90 
x
, 
b
[x], "^++^"[x&3], x);

92 
	`´štf
("„eturn;\n }\n");

95 
	`´štf
(

100 
x
 = 8; x < 12; x++) {

102 
y
 = 0; y < 16; y++) {

103 
	`´štf
("b[%d] = (safer_%cbox[(b[%d] %c skey->saferp.K[%d][%d]) & 255] %c skey->saferp.K[%d][%d]) & 255;\n",

104 
b
[
y
], "–Ë"[y&3], b[y], "^++^"[y&3], 
x
*2, y, "+^^+"[y&3], x*2+1, y);

108 
y
 = 0; y < 4; y++) {

109 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[0], b[0], b[1], b[0], b[1]);

110 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[2], b[2], b[3], b[3], b[2]);

111 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[4], b[4], b[5], b[5], b[4]);

112 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[6], b[6], b[7], b[7], b[6]);

113 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[8], b[8], b[9], b[9], b[8]);

114 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[10], b[10], b[11], b[11], b[10]);

115 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[12], b[12], b[13], b[13], b[12]);

116 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[14], b[14], b[15], b[15], b[14]);

117 ià(
y
 < 3) {

118 
SHUF
;

122 
	`´štf
("}\n");

124 
	`´štf
(

127 
x
 = 0; x < 16; x++) {

128 
	`´štf
(

130 
x
, 
b
[x], "^++^"[x&3], x);

132 
	`´štf
("„eturn;\n }\n");

135 
	`´štf
(

140 
x
 = 12; x < 16; x++) {

142 
y
 = 0; y < 16; y++) {

143 
	`´štf
("b[%d] = (safer_%cbox[(b[%d] %c skey->saferp.K[%d][%d]) & 255] %c skey->saferp.K[%d][%d]) & 255;\n",

144 
b
[
y
], "–Ë"[y&3], b[y], "^++^"[y&3], 
x
*2, y, "+^^+"[y&3], x*2+1, y);

148 
y
 = 0; y < 4; y++) {

149 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[0], b[0], b[1], b[0], b[1]);

150 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[2], b[2], b[3], b[3], b[2]);

151 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[4], b[4], b[5], b[5], b[4]);

152 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[6], b[6], b[7], b[7], b[6]);

153 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[8], b[8], b[9], b[9], b[8]);

154 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[10], b[10], b[11], b[11], b[10]);

155 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[12], b[12], b[13], b[13], b[12]);

156 
	`´štf
(" b[%d] = (b[%d] + (b[%d] = (b[%d] + b[%d]è& 255)è& 255;\n", 
b
[14], b[14], b[15], b[15], b[14]);

157 ià(
y
 < 3) {

158 
SHUF
;

163 
x
 = 0; x < 16; x++) {

164 
	`´štf
(

166 
x
, 
b
[x], "^++^"[x&3], x);

168 
	`´štf
("„eturn;\n");

169 
	`´štf
(" }\n}\n\n");

172 
	}
}

	@libtomcrypt/notes/etc/whirlgen.c

1 
	~<¡dio.h
>

3 
	gE
[16] = { 1, 0xb, 9, 0xc, 0xd, 6, 0xf, 3, 0xe, 8, 7, 4, 0xa, 2, 5, 0 };

4 
	gEi
[16];

5 
	gR
[16] = { 7, 0xc, 0xb, 0xd, 0xe, 4, 9, 0xf, 6, 3, 8, 0xa, 2, 5, 1, 0 };

6 
	gcœ
[8][8] = {

11 
	$gf_mul
(
a
, 
b
)

13 
r
;

15 
r
 = 0;

16 
a
) {

17 ià(
a
 & 1è
r
 ^ğ
b
;

18 
a
 >>= 1;

19 
b
 = (b << 1) ^ (b & 0x80 ? 0x11d : 0x00);

21  
r
;

22 
	}
}

24 
	$sbox
(
x
)

26 
a
, 
b
, 
w
;

28 
a
 = 
x
 >> 4;

29 
b
 = 
x
 & 15;

31 
a
 = 
E
[a]; 
b
 = 
Ei
[b];

32 
w
 = 
a
 ^ 
b
; w = 
R
[w];

33 
a
 = 
E
[¨^ 
w
]; 
b
 = 
Ei
[b ^ w];

36  (
a
 << 4è| 
b
;

37 
	}
}

39 
	$maš
()

41 
x
, 
y
;

43 
x
 = 0; x < 16; x++è
Ei
[
E
[x]] = x;

46 
y
 = 1; y < 8; y++) {

47 
x
 = 0; x < 8; x++) {

48 
cœ
[
y
][
x
] = cir[y-1][(x-1)&7];

60 
y
 = 0; y < 8; y++) {

61 
	`´štf
("¡©iøcÚ¡ ulÚg64 sbox%d[] = {\n", 
y
);

62 
x
 = 0; x < 256; ) {

63 
	`´štf
("CONST64(0x%02x%02x%02x%02x%02x%02x%02x%02x)",

64 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][0]),

65 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][1]),

66 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][2]),

67 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][3]),

68 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][4]),

69 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][5]),

70 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][6]),

71 
	`gf_mul
(
	`sbox
(
x
), 
cœ
[
y
][7]));

72 ià(
x
 < 255è
	`´štf
(", ");

73 ià(!(++
x
 & 3)è
	`´štf
("\n");

75 
	`´štf
("};\n\n");

78 
	`´štf
("static const ulong64 cont[] = {\n");

79 
y
 = 0; y <= 10; y++) {

80 
	`´štf
("CONST64(0x");

81 
x
 = 0; x < 8; x++) {

82 
	`´štf
("%02x", 
	`sbox
((8*
y
 + 
x
)&255));

84 
	`´štf
("),\n");

86 
	`´štf
("};\n\n");

89 
	}
}

	@libtomcrypt/notes/etc/whirltest.c

1 
	~<¡dio.h
>

3 
	$maš
()

5 
buf
[4096];

6 
x
;

8 
	`fg‘s
(
buf
, (buf)-2, 
¡dš
è!ğ
NULL
) {

9 
x
 = 0; x < 128; ) {

10 
	`´štf
("0x%c%c, ", 
buf
[
x
], buf[x+1]);

11 ià(!((
x
 +ğ2è& 31)è
	`´štf
("\n");

14 
	}
}

	@libtomcrypt/src/ciphers/aes/aes.c

33 
	~"tomüy±.h
"

35 #ifdeà
RIJNDAEL


37 #iâdeà
ENCRYPT_ONLY


39 
	#SETUP
 
rijnd«l_£tup


	)

40 
	#ECB_ENC
 
rijnd«l_ecb_’üy±


	)

41 
	#ECB_DEC
 
rijnd«l_ecb_deüy±


	)

42 
	#ECB_DONE
 
rijnd«l_dÚe


	)

43 
	#ECB_TEST
 
rijnd«l_‹¡


	)

44 
	#ECB_KS
 
rijnd«l_keysize


	)

47 cÚ¡ 
Éc_ch”_desütÜ
 
	grijnd«l_desc
 =

52 
SETUP
, 
ECB_ENC
, 
ECB_DEC
, 
ECB_TEST
, 
ECB_DONE
, 
ECB_KS
,

53 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

57 cÚ¡ 
Éc_ch”_desütÜ
 
	g«s_desc
 =

62 
SETUP
, 
ECB_ENC
, 
ECB_DEC
, 
ECB_TEST
, 
ECB_DONE
, 
ECB_KS
,

63 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

68 
	#SETUP
 
rijnd«l_’c_£tup


	)

69 
	#ECB_ENC
 
rijnd«l_’c_ecb_’üy±


	)

70 
	#ECB_KS
 
rijnd«l_’c_keysize


	)

71 
	#ECB_DONE
 
rijnd«l_’c_dÚe


	)

73 cÚ¡ 
Éc_ch”_desütÜ
 
	grijnd«l_’c_desc
 =

78 
SETUP
, 
ECB_ENC
, 
NULL
, NULL, 
ECB_DONE
, 
ECB_KS
,

79 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

82 cÚ¡ 
Éc_ch”_desütÜ
 
	g«s_’c_desc
 =

87 
SETUP
, 
ECB_ENC
, 
NULL
, NULL, 
ECB_DONE
, 
ECB_KS
,

88 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

93 
	~"«s_b.c
"

95 
ulÚg32
 
	$£tup_mix
(
ulÚg32
 
‹mp
)

97  (
Te4_3
[
	`by‹
(
‹mp
, 2)]) ^

98 (
Te4_2
[
	`by‹
(
‹mp
, 1)]) ^

99 (
Te4_1
[
	`by‹
(
‹mp
, 0)]) ^

100 (
Te4_0
[
	`by‹
(
‹mp
, 3)]);

101 
	}
}

103 #iâdeà
ENCRYPT_ONLY


104 #ifdeà
LTC_SMALL_CODE


105 
ulÚg32
 
	$£tup_mix2
(
ulÚg32
 
‹mp
)

107  
	`Td0
(255 & 
Te4
[
	`by‹
(
‹mp
, 3)]) ^

108 
	`Td1
(255 & 
Te4
[
	`by‹
(
‹mp
, 2)]) ^

109 
	`Td2
(255 & 
Te4
[
	`by‹
(
‹mp
, 1)]) ^

110 
	`Td3
(255 & 
Te4
[
	`by‹
(
‹mp
, 0)]);

111 
	}
}

123 
	$SETUP
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

125 
i
, 
j
;

126 
ulÚg32
 
‹mp
, *
rk
;

127 #iâdeà
ENCRYPT_ONLY


128 
ulÚg32
 *
¼k
;

130 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

131 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

133 ià(
keyËn
 != 16 && keylen != 24 && keylen != 32) {

134  
CRYPT_INVALID_KEYSIZE
;

137 ià(
num_rounds
 !ğ0 &&‚um_round !ğ(10 + ((
keyËn
/8)-2)*2)) {

138  
CRYPT_INVALID_ROUNDS
;

141 
skey
->
rijnd«l
.
Nr
 = 10 + ((
keyËn
/8)-2)*2;

144 
i
 = 0;

145 
rk
 = 
skey
->
rijnd«l
.
eK
;

146 
	`LOAD32H
(
rk
[0], 
key
 );

147 
	`LOAD32H
(
rk
[1], 
key
 + 4);

148 
	`LOAD32H
(
rk
[2], 
key
 + 8);

149 
	`LOAD32H
(
rk
[3], 
key
 + 12);

150 ià(
keyËn
 == 16) {

151 
j
 = 44;

153 
‹mp
 = 
rk
[3];

154 
rk
[4] =„k[0] ^ 
	`£tup_mix
(
‹mp
è^ 
rcÚ
[
i
];

155 
rk
[5] =„k[1] ^„k[4];

156 
rk
[6] =„k[2] ^„k[5];

157 
rk
[7] =„k[3] ^„k[6];

158 ià(++
i
 == 10) {

161 
rk
 += 4;

163 } ià(
keyËn
 == 24) {

164 
j
 = 52;

165 
	`LOAD32H
(
rk
[4], 
key
 + 16);

166 
	`LOAD32H
(
rk
[5], 
key
 + 20);

168 #ifdeà
_MSC_VER


169 
‹mp
 = 
skey
->
rijnd«l
.
eK
[
rk
 - skey->rijndael.eK + 5];

171 
‹mp
 = 
rk
[5];

173 
rk
[ 6] =„k[ 0] ^ 
	`£tup_mix
(
‹mp
è^ 
rcÚ
[
i
];

174 
rk
[ 7] =„k[ 1] ^„k[ 6];

175 
rk
[ 8] =„k[ 2] ^„k[ 7];

176 
rk
[ 9] =„k[ 3] ^„k[ 8];

177 ià(++
i
 == 8) {

180 
rk
[10] =„k[ 4] ^„k[ 9];

181 
rk
[11] =„k[ 5] ^„k[10];

182 
rk
 += 6;

184 } ià(
keyËn
 == 32) {

185 
j
 = 60;

186 
	`LOAD32H
(
rk
[4], 
key
 + 16);

187 
	`LOAD32H
(
rk
[5], 
key
 + 20);

188 
	`LOAD32H
(
rk
[6], 
key
 + 24);

189 
	`LOAD32H
(
rk
[7], 
key
 + 28);

191 #ifdeà
_MSC_VER


192 
‹mp
 = 
skey
->
rijnd«l
.
eK
[
rk
 - skey->rijndael.eK + 7];

194 
‹mp
 = 
rk
[7];

196 
rk
[ 8] =„k[ 0] ^ 
	`£tup_mix
(
‹mp
è^ 
rcÚ
[
i
];

197 
rk
[ 9] =„k[ 1] ^„k[ 8];

198 
rk
[10] =„k[ 2] ^„k[ 9];

199 
rk
[11] =„k[ 3] ^„k[10];

200 ià(++
i
 == 7) {

203 
‹mp
 = 
rk
[11];

204 
rk
[12] =„k[ 4] ^ 
	`£tup_mix
(
	`RORc
(
‹mp
, 8));

205 
rk
[13] =„k[ 5] ^„k[12];

206 
rk
[14] =„k[ 6] ^„k[13];

207 
rk
[15] =„k[ 7] ^„k[14];

208 
rk
 += 8;

212  
CRYPT_ERROR
;

215 #iâdeà
ENCRYPT_ONLY


217 
rk
 = 
skey
->
rijnd«l
.
dK
;

218 
¼k
 = 
skey
->
rijnd«l
.
eK
 + 
j
 - 4;

222 *
rk
++ = *
¼k
++;

223 *
rk
++ = *
¼k
++;

224 *
rk
++ = *
¼k
++;

225 *
rk
 = *
¼k
;

226 
rk
 -ğ3; 
¼k
 -= 3;

228 
i
 = 1; i < 
skey
->
rijnd«l
.
Nr
; i++) {

229 
¼k
 -= 4;

230 
rk
 += 4;

231 #ifdeà
LTC_SMALL_CODE


232 
‹mp
 = 
¼k
[0];

233 
rk
[0] = 
	`£tup_mix2
(
‹mp
);

234 
‹mp
 = 
¼k
[1];

235 
rk
[1] = 
	`£tup_mix2
(
‹mp
);

236 
‹mp
 = 
¼k
[2];

237 
rk
[2] = 
	`£tup_mix2
(
‹mp
);

238 
‹mp
 = 
¼k
[3];

239 
rk
[3] = 
	`£tup_mix2
(
‹mp
);

241 
‹mp
 = 
¼k
[0];

242 
rk
[0] =

243 
Tks0
[
	`by‹
(
‹mp
, 3)] ^

244 
Tks1
[
	`by‹
(
‹mp
, 2)] ^

245 
Tks2
[
	`by‹
(
‹mp
, 1)] ^

246 
Tks3
[
	`by‹
(
‹mp
, 0)];

247 
‹mp
 = 
¼k
[1];

248 
rk
[1] =

249 
Tks0
[
	`by‹
(
‹mp
, 3)] ^

250 
Tks1
[
	`by‹
(
‹mp
, 2)] ^

251 
Tks2
[
	`by‹
(
‹mp
, 1)] ^

252 
Tks3
[
	`by‹
(
‹mp
, 0)];

253 
‹mp
 = 
¼k
[2];

254 
rk
[2] =

255 
Tks0
[
	`by‹
(
‹mp
, 3)] ^

256 
Tks1
[
	`by‹
(
‹mp
, 2)] ^

257 
Tks2
[
	`by‹
(
‹mp
, 1)] ^

258 
Tks3
[
	`by‹
(
‹mp
, 0)];

259 
‹mp
 = 
¼k
[3];

260 
rk
[3] =

261 
Tks0
[
	`by‹
(
‹mp
, 3)] ^

262 
Tks1
[
	`by‹
(
‹mp
, 2)] ^

263 
Tks2
[
	`by‹
(
‹mp
, 1)] ^

264 
Tks3
[
	`by‹
(
‹mp
, 0)];

270 
¼k
 -= 4;

271 
rk
 += 4;

272 *
rk
++ = *
¼k
++;

273 *
rk
++ = *
¼k
++;

274 *
rk
++ = *
¼k
++;

275 *
rk
 = *
¼k
;

278  
CRYPT_OK
;

279 
	}
}

288 #ifdeà
LTC_CLEAN_STACK


289 
	$_rijnd«l_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

291 
	$ECB_ENC
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

294 
ulÚg32
 
s0
, 
s1
, 
s2
, 
s3
, 
t0
, 
t1
, 
t2
, 
t3
, *
rk
;

295 
Nr
, 
r
;

297 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

298 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

299 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

301 
Nr
 = 
skey
->
rijnd«l
.Nr;

302 
rk
 = 
skey
->
rijnd«l
.
eK
;

308 
	`LOAD32H
(
s0
, 
±
 ); s0 ^ğ
rk
[0];

309 
	`LOAD32H
(
s1
, 
±
 + 4); s1 ^ğ
rk
[1];

310 
	`LOAD32H
(
s2
, 
±
 + 8); s2 ^ğ
rk
[2];

311 
	`LOAD32H
(
s3
, 
±
 + 12); s3 ^ğ
rk
[3];

313 #ifdeà
LTC_SMALL_CODE


315 
r
 = 0; ;„++) {

316 
rk
 += 4;

317 
t0
 =

318 
	`Te0
(
	`by‹
(
s0
, 3)) ^

319 
	`Te1
(
	`by‹
(
s1
, 2)) ^

320 
	`Te2
(
	`by‹
(
s2
, 1)) ^

321 
	`Te3
(
	`by‹
(
s3
, 0)) ^

322 
rk
[0];

323 
t1
 =

324 
	`Te0
(
	`by‹
(
s1
, 3)) ^

325 
	`Te1
(
	`by‹
(
s2
, 2)) ^

326 
	`Te2
(
	`by‹
(
s3
, 1)) ^

327 
	`Te3
(
	`by‹
(
s0
, 0)) ^

328 
rk
[1];

329 
t2
 =

330 
	`Te0
(
	`by‹
(
s2
, 3)) ^

331 
	`Te1
(
	`by‹
(
s3
, 2)) ^

332 
	`Te2
(
	`by‹
(
s0
, 1)) ^

333 
	`Te3
(
	`by‹
(
s1
, 0)) ^

334 
rk
[2];

335 
t3
 =

336 
	`Te0
(
	`by‹
(
s3
, 3)) ^

337 
	`Te1
(
	`by‹
(
s0
, 2)) ^

338 
	`Te2
(
	`by‹
(
s1
, 1)) ^

339 
	`Te3
(
	`by‹
(
s2
, 0)) ^

340 
rk
[3];

341 ià(
r
 =ğ
Nr
-2) {

344 
s0
 = 
t0
; 
s1
 = 
t1
; 
s2
 = 
t2
; 
s3
 = 
t3
;

346 
rk
 += 4;

353 
r
 = 
Nr
 >> 1;

355 
t0
 =

356 
	`Te0
(
	`by‹
(
s0
, 3)) ^

357 
	`Te1
(
	`by‹
(
s1
, 2)) ^

358 
	`Te2
(
	`by‹
(
s2
, 1)) ^

359 
	`Te3
(
	`by‹
(
s3
, 0)) ^

360 
rk
[4];

361 
t1
 =

362 
	`Te0
(
	`by‹
(
s1
, 3)) ^

363 
	`Te1
(
	`by‹
(
s2
, 2)) ^

364 
	`Te2
(
	`by‹
(
s3
, 1)) ^

365 
	`Te3
(
	`by‹
(
s0
, 0)) ^

366 
rk
[5];

367 
t2
 =

368 
	`Te0
(
	`by‹
(
s2
, 3)) ^

369 
	`Te1
(
	`by‹
(
s3
, 2)) ^

370 
	`Te2
(
	`by‹
(
s0
, 1)) ^

371 
	`Te3
(
	`by‹
(
s1
, 0)) ^

372 
rk
[6];

373 
t3
 =

374 
	`Te0
(
	`by‹
(
s3
, 3)) ^

375 
	`Te1
(
	`by‹
(
s0
, 2)) ^

376 
	`Te2
(
	`by‹
(
s1
, 1)) ^

377 
	`Te3
(
	`by‹
(
s2
, 0)) ^

378 
rk
[7];

380 
rk
 += 8;

381 ià(--
r
 == 0) {

385 
s0
 =

386 
	`Te0
(
	`by‹
(
t0
, 3)) ^

387 
	`Te1
(
	`by‹
(
t1
, 2)) ^

388 
	`Te2
(
	`by‹
(
t2
, 1)) ^

389 
	`Te3
(
	`by‹
(
t3
, 0)) ^

390 
rk
[0];

391 
s1
 =

392 
	`Te0
(
	`by‹
(
t1
, 3)) ^

393 
	`Te1
(
	`by‹
(
t2
, 2)) ^

394 
	`Te2
(
	`by‹
(
t3
, 1)) ^

395 
	`Te3
(
	`by‹
(
t0
, 0)) ^

396 
rk
[1];

397 
s2
 =

398 
	`Te0
(
	`by‹
(
t2
, 3)) ^

399 
	`Te1
(
	`by‹
(
t3
, 2)) ^

400 
	`Te2
(
	`by‹
(
t0
, 1)) ^

401 
	`Te3
(
	`by‹
(
t1
, 0)) ^

402 
rk
[2];

403 
s3
 =

404 
	`Te0
(
	`by‹
(
t3
, 3)) ^

405 
	`Te1
(
	`by‹
(
t0
, 2)) ^

406 
	`Te2
(
	`by‹
(
t1
, 1)) ^

407 
	`Te3
(
	`by‹
(
t2
, 0)) ^

408 
rk
[3];

417 
s0
 =

418 (
Te4_3
[
	`by‹
(
t0
, 3)]) ^

419 (
Te4_2
[
	`by‹
(
t1
, 2)]) ^

420 (
Te4_1
[
	`by‹
(
t2
, 1)]) ^

421 (
Te4_0
[
	`by‹
(
t3
, 0)]) ^

422 
rk
[0];

423 
	`STORE32H
(
s0
, 
ù
);

424 
s1
 =

425 (
Te4_3
[
	`by‹
(
t1
, 3)]) ^

426 (
Te4_2
[
	`by‹
(
t2
, 2)]) ^

427 (
Te4_1
[
	`by‹
(
t3
, 1)]) ^

428 (
Te4_0
[
	`by‹
(
t0
, 0)]) ^

429 
rk
[1];

430 
	`STORE32H
(
s1
, 
ù
+4);

431 
s2
 =

432 (
Te4_3
[
	`by‹
(
t2
, 3)]) ^

433 (
Te4_2
[
	`by‹
(
t3
, 2)]) ^

434 (
Te4_1
[
	`by‹
(
t0
, 1)]) ^

435 (
Te4_0
[
	`by‹
(
t1
, 0)]) ^

436 
rk
[2];

437 
	`STORE32H
(
s2
, 
ù
+8);

438 
s3
 =

439 (
Te4_3
[
	`by‹
(
t3
, 3)]) ^

440 (
Te4_2
[
	`by‹
(
t0
, 2)]) ^

441 (
Te4_1
[
	`by‹
(
t1
, 1)]) ^

442 (
Te4_0
[
	`by‹
(
t2
, 0)]) ^

443 
rk
[3];

444 
	`STORE32H
(
s3
, 
ù
+12);

446  
CRYPT_OK
;

447 
	}
}

449 #ifdeà
LTC_CLEAN_STACK


450 
	$ECB_ENC
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

452 
”r
 = 
	`_rijnd«l_ecb_’üy±
(
±
, 
ù
, 
skey
);

453 
	`buº_¡ack
(()*8 + (*) + ()*2);

454  
”r
;

455 
	}
}

458 #iâdeà
ENCRYPT_ONLY


467 #ifdeà
LTC_CLEAN_STACK


468 
	$_rijnd«l_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

470 
	$ECB_DEC
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

473 
ulÚg32
 
s0
, 
s1
, 
s2
, 
s3
, 
t0
, 
t1
, 
t2
, 
t3
, *
rk
;

474 
Nr
, 
r
;

476 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

477 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

478 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

480 
Nr
 = 
skey
->
rijnd«l
.Nr;

481 
rk
 = 
skey
->
rijnd«l
.
dK
;

487 
	`LOAD32H
(
s0
, 
ù
 ); s0 ^ğ
rk
[0];

488 
	`LOAD32H
(
s1
, 
ù
 + 4); s1 ^ğ
rk
[1];

489 
	`LOAD32H
(
s2
, 
ù
 + 8); s2 ^ğ
rk
[2];

490 
	`LOAD32H
(
s3
, 
ù
 + 12); s3 ^ğ
rk
[3];

492 #ifdeà
LTC_SMALL_CODE


493 
r
 = 0; ;„++) {

494 
rk
 += 4;

495 
t0
 =

496 
	`Td0
(
	`by‹
(
s0
, 3)) ^

497 
	`Td1
(
	`by‹
(
s3
, 2)) ^

498 
	`Td2
(
	`by‹
(
s2
, 1)) ^

499 
	`Td3
(
	`by‹
(
s1
, 0)) ^

500 
rk
[0];

501 
t1
 =

502 
	`Td0
(
	`by‹
(
s1
, 3)) ^

503 
	`Td1
(
	`by‹
(
s0
, 2)) ^

504 
	`Td2
(
	`by‹
(
s3
, 1)) ^

505 
	`Td3
(
	`by‹
(
s2
, 0)) ^

506 
rk
[1];

507 
t2
 =

508 
	`Td0
(
	`by‹
(
s2
, 3)) ^

509 
	`Td1
(
	`by‹
(
s1
, 2)) ^

510 
	`Td2
(
	`by‹
(
s0
, 1)) ^

511 
	`Td3
(
	`by‹
(
s3
, 0)) ^

512 
rk
[2];

513 
t3
 =

514 
	`Td0
(
	`by‹
(
s3
, 3)) ^

515 
	`Td1
(
	`by‹
(
s2
, 2)) ^

516 
	`Td2
(
	`by‹
(
s1
, 1)) ^

517 
	`Td3
(
	`by‹
(
s0
, 0)) ^

518 
rk
[3];

519 ià(
r
 =ğ
Nr
-2) {

522 
s0
 = 
t0
; 
s1
 = 
t1
; 
s2
 = 
t2
; 
s3
 = 
t3
;

524 
rk
 += 4;

531 
r
 = 
Nr
 >> 1;

534 
t0
 =

535 
	`Td0
(
	`by‹
(
s0
, 3)) ^

536 
	`Td1
(
	`by‹
(
s3
, 2)) ^

537 
	`Td2
(
	`by‹
(
s2
, 1)) ^

538 
	`Td3
(
	`by‹
(
s1
, 0)) ^

539 
rk
[4];

540 
t1
 =

541 
	`Td0
(
	`by‹
(
s1
, 3)) ^

542 
	`Td1
(
	`by‹
(
s0
, 2)) ^

543 
	`Td2
(
	`by‹
(
s3
, 1)) ^

544 
	`Td3
(
	`by‹
(
s2
, 0)) ^

545 
rk
[5];

546 
t2
 =

547 
	`Td0
(
	`by‹
(
s2
, 3)) ^

548 
	`Td1
(
	`by‹
(
s1
, 2)) ^

549 
	`Td2
(
	`by‹
(
s0
, 1)) ^

550 
	`Td3
(
	`by‹
(
s3
, 0)) ^

551 
rk
[6];

552 
t3
 =

553 
	`Td0
(
	`by‹
(
s3
, 3)) ^

554 
	`Td1
(
	`by‹
(
s2
, 2)) ^

555 
	`Td2
(
	`by‹
(
s1
, 1)) ^

556 
	`Td3
(
	`by‹
(
s0
, 0)) ^

557 
rk
[7];

559 
rk
 += 8;

560 ià(--
r
 == 0) {

565 
s0
 =

566 
	`Td0
(
	`by‹
(
t0
, 3)) ^

567 
	`Td1
(
	`by‹
(
t3
, 2)) ^

568 
	`Td2
(
	`by‹
(
t2
, 1)) ^

569 
	`Td3
(
	`by‹
(
t1
, 0)) ^

570 
rk
[0];

571 
s1
 =

572 
	`Td0
(
	`by‹
(
t1
, 3)) ^

573 
	`Td1
(
	`by‹
(
t0
, 2)) ^

574 
	`Td2
(
	`by‹
(
t3
, 1)) ^

575 
	`Td3
(
	`by‹
(
t2
, 0)) ^

576 
rk
[1];

577 
s2
 =

578 
	`Td0
(
	`by‹
(
t2
, 3)) ^

579 
	`Td1
(
	`by‹
(
t1
, 2)) ^

580 
	`Td2
(
	`by‹
(
t0
, 1)) ^

581 
	`Td3
(
	`by‹
(
t3
, 0)) ^

582 
rk
[2];

583 
s3
 =

584 
	`Td0
(
	`by‹
(
t3
, 3)) ^

585 
	`Td1
(
	`by‹
(
t2
, 2)) ^

586 
	`Td2
(
	`by‹
(
t1
, 1)) ^

587 
	`Td3
(
	`by‹
(
t0
, 0)) ^

588 
rk
[3];

596 
s0
 =

597 (
Td4
[
	`by‹
(
t0
, 3)] & 0xff000000) ^

598 (
Td4
[
	`by‹
(
t3
, 2)] & 0x00ff0000) ^

599 (
Td4
[
	`by‹
(
t2
, 1)] & 0x0000ff00) ^

600 (
Td4
[
	`by‹
(
t1
, 0)] & 0x000000ff) ^

601 
rk
[0];

602 
	`STORE32H
(
s0
, 
±
);

603 
s1
 =

604 (
Td4
[
	`by‹
(
t1
, 3)] & 0xff000000) ^

605 (
Td4
[
	`by‹
(
t0
, 2)] & 0x00ff0000) ^

606 (
Td4
[
	`by‹
(
t3
, 1)] & 0x0000ff00) ^

607 (
Td4
[
	`by‹
(
t2
, 0)] & 0x000000ff) ^

608 
rk
[1];

609 
	`STORE32H
(
s1
, 
±
+4);

610 
s2
 =

611 (
Td4
[
	`by‹
(
t2
, 3)] & 0xff000000) ^

612 (
Td4
[
	`by‹
(
t1
, 2)] & 0x00ff0000) ^

613 (
Td4
[
	`by‹
(
t0
, 1)] & 0x0000ff00) ^

614 (
Td4
[
	`by‹
(
t3
, 0)] & 0x000000ff) ^

615 
rk
[2];

616 
	`STORE32H
(
s2
, 
±
+8);

617 
s3
 =

618 (
Td4
[
	`by‹
(
t3
, 3)] & 0xff000000) ^

619 (
Td4
[
	`by‹
(
t2
, 2)] & 0x00ff0000) ^

620 (
Td4
[
	`by‹
(
t1
, 1)] & 0x0000ff00) ^

621 (
Td4
[
	`by‹
(
t0
, 0)] & 0x000000ff) ^

622 
rk
[3];

623 
	`STORE32H
(
s3
, 
±
+12);

625  
CRYPT_OK
;

626 
	}
}

629 #ifdeà
LTC_CLEAN_STACK


630 
	$ECB_DEC
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

632 
”r
 = 
	`_rijnd«l_ecb_deüy±
(
ù
, 
±
, 
skey
);

633 
	`buº_¡ack
(()*8 + (*) + ()*2);

634  
”r
;

635 
	}
}

642 
	$ECB_TEST
()

644 #iâdeà
LTC_TEST


645  
CRYPT_NOP
;

647 
”r
;

649 
keyËn
;

650 
key
[32], 
±
[16], 
ù
[16];

651 } 
‹¡s
[] = {

681 
symm‘ric_key
 
key
;

682 
tmp
[2][16];

683 
i
, 
y
;

685 
i
 = 0; i < ()((
‹¡s
)/(tests[0])); i++) {

686 
	`z”omem
(&
key
, (key));

687 ià((
”r
 = 
	`rijnd«l_£tup
(
‹¡s
[
i
].
key
,e¡s[i].
keyËn
, 0, &key)è!ğ
CRYPT_OK
) {

688  
”r
;

691 
	`rijnd«l_ecb_’üy±
(
‹¡s
[
i
].
±
, 
tmp
[0], &
key
);

692 
	`rijnd«l_ecb_deüy±
(
tmp
[0],mp[1], &
key
);

693 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
i
].
ù
, 16è|| XMEMCMPÑmp[1],e¡s[i].
±
, 16)) {

695 
	`´štf
("\n\nTe¡ %d faed\n", 
i
);

696 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
i
].
ù
, 16)) {

697 
	`´štf
("CT: ");

698 
i
 = 0; i < 16; i++) {

699 
	`´štf
("%02x ", 
tmp
[0][
i
]);

701 
	`´štf
("\n");

703 
	`´štf
("PT: ");

704 
i
 = 0; i < 16; i++) {

705 
	`´štf
("%02x ", 
tmp
[1][
i
]);

707 
	`´štf
("\n");

710  
CRYPT_FAIL_TESTVECTOR
;

714 
y
 = 0; y < 16; y++è
tmp
[0][y] = 0;

715 
y
 = 0; y < 1000; y++è
	`rijnd«l_ecb_’üy±
(
tmp
[0],mp[0], &
key
);

716 
y
 = 0; y < 1000; y++è
	`rijnd«l_ecb_deüy±
(
tmp
[0],mp[0], &
key
);

717 
y
 = 0; y < 16; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

719  
CRYPT_OK
;

721 
	}
}

729 
	$ECB_DONE
(
symm‘ric_key
 *
skey
)

731 
	}
}

739 
	$ECB_KS
(*
keysize
)

741 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

743 ià(*
keysize
 < 16)

744  
CRYPT_INVALID_KEYSIZE
;

745 ià(*
keysize
 < 24) {

746 *
keysize
 = 16;

747  
CRYPT_OK
;

748 } ià(*
keysize
 < 32) {

749 *
keysize
 = 24;

750  
CRYPT_OK
;

752 *
keysize
 = 32;

753  
CRYPT_OK
;

755 
	}
}

	@libtomcrypt/src/ciphers/aes/aes_tab.c

30 cÚ¡ 
ulÚg32
 
	gTE0
[256] = {

97 #iâdeà
PELI_TAB


98 cÚ¡ 
ulÚg32
 
	gTe4
[256] = {

166 #iâdeà
ENCRYPT_ONLY


168 cÚ¡ 
ulÚg32
 
	gTD0
[256] = {

235 cÚ¡ 
ulÚg32
 
	gTd4
[256] = {

304 #ifdeà
LTC_SMALL_CODE


306 
	#Te0
(
x
è
TE0
[x]

	)

307 
	#Te1
(
x
è
	`RORc
(
TE0
[x], 8)

	)

308 
	#Te2
(
x
è
	`RORc
(
TE0
[x], 16)

	)

309 
	#Te3
(
x
è
	`RORc
(
TE0
[x], 24)

	)

311 
	#Td0
(
x
è
TD0
[x]

	)

312 
	#Td1
(
x
è
	`RORc
(
TD0
[x], 8)

	)

313 
	#Td2
(
x
è
	`RORc
(
TD0
[x], 16)

	)

314 
	#Td3
(
x
è
	`RORc
(
TD0
[x], 24)

	)

316 
	#Te4_0
 0x000000FF & 
Te4


	)

317 
	#Te4_1
 0x0000FF00 & 
Te4


	)

318 
	#Te4_2
 0x00FF0000 & 
Te4


	)

319 
	#Te4_3
 0xFF000000 & 
Te4


	)

323 
	#Te0
(
x
è
TE0
[x]

	)

324 
	#Te1
(
x
è
TE1
[x]

	)

325 
	#Te2
(
x
è
TE2
[x]

	)

326 
	#Te3
(
x
è
TE3
[x]

	)

328 
	#Td0
(
x
è
TD0
[x]

	)

329 
	#Td1
(
x
è
TD1
[x]

	)

330 
	#Td2
(
x
è
TD2
[x]

	)

331 
	#Td3
(
x
è
TD3
[x]

	)

333 cÚ¡ 
ulÚg32
 
	gTE1
[256] = {

399 cÚ¡ 
ulÚg32
 
	gTE2
[256] = {

465 cÚ¡ 
ulÚg32
 
	gTE3
[256] = {

533 #iâdeà
PELI_TAB


534 cÚ¡ 
ulÚg32
 
	gTe4_0
[] = {

569 cÚ¡ 
ulÚg32
 
	gTe4_1
[] = {

604 cÚ¡ 
ulÚg32
 
	gTe4_2
[] = {

639 cÚ¡ 
ulÚg32
 
	gTe4_3
[] = {

675 #iâdeà
ENCRYPT_ONLY


677 cÚ¡ 
ulÚg32
 
	gTD1
[256] = {

743 cÚ¡ 
ulÚg32
 
	gTD2
[256] = {

809 cÚ¡ 
ulÚg32
 
	gTD3
[256] = {

876 cÚ¡ 
ulÚg32
 
	gTks0
[] = {

911 cÚ¡ 
ulÚg32
 
	gTks1
[] = {

946 cÚ¡ 
ulÚg32
 
	gTks2
[] = {

981 cÚ¡ 
ulÚg32
 
	gTks3
[] = {

1020 cÚ¡ 
ulÚg32
 
	grcÚ
[] = {

	@libtomcrypt/src/ciphers/anubis.c

18 
	~"tomüy±.h
"

20 #ifdeà
ANUBIS


22 cÚ¡ 
Éc_ch”_desütÜ
 
	gªubis_desc
 = {

26 &
ªubis_£tup
,

27 &
ªubis_ecb_’üy±
,

28 &
ªubis_ecb_deüy±
,

29 &
ªubis_‹¡
,

30 &
ªubis_dÚe
,

31 &
ªubis_keysize
,

32 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

35 
	#MIN_N
 4

	)

36 
	#MAX_N
 10

	)

37 
	#MIN_ROUNDS
 (8 + 
MIN_N
)

	)

38 
	#MAX_ROUNDS
 (8 + 
MAX_N
)

	)

39 
	#MIN_KEYSIZEB
 (4*
MIN_N
)

	)

40 
	#MAX_KEYSIZEB
 (4*
MAX_N
)

	)

41 
	#BLOCKSIZE
 128

	)

42 
	#BLOCKSIZEB
 (
BLOCKSIZE
/8)

	)

51 #ià
defšed
(
ANUBIS_TWEAK
)

53 cÚ¡ 
ulÚg32
 
	gT0
[256] = {

120 cÚ¡ 
ulÚg32
 
	gT1
[256] = {

187 cÚ¡ 
ulÚg32
 
	gT2
[256] = {

254 cÚ¡ 
ulÚg32
 
	gT3
[256] = {

321 cÚ¡ 
ulÚg32
 
	gT4
[256] = {

388 cÚ¡ 
ulÚg32
 
	gT5
[256] = {

458 cÚ¡ 
ulÚg32
 
	grc
[] = {

471 cÚ¡ 
ulÚg32
 
	gT0
[256] = {

538 cÚ¡ 
ulÚg32
 
	gT1
[256] = {

605 cÚ¡ 
ulÚg32
 
	gT2
[256] = {

672 cÚ¡ 
ulÚg32
 
	gT3
[256] = {

739 cÚ¡ 
ulÚg32
 
	gT4
[256] = {

806 cÚ¡ 
ulÚg32
 
	gT5
[256] = {

876 cÚ¡ 
ulÚg32
 
	grc
[] = {

894 #ifdeà
LTC_CLEAN_STACK


895 
	$_ªubis_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

897 
	$ªubis_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

900 
N
, 
R
, 
i
, 
pos
, 
r
;

901 
ulÚg32
 
k­·
[
MAX_N
];

902 
ulÚg32
 
š‹r
[
MAX_N
];

903 
ulÚg32
 
v
, 
K0
, 
K1
, 
K2
, 
K3
;

905 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

906 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

909 ià((
keyËn
 & 3) || (keylen < 16) || (keylen > 40)) {

910  
CRYPT_INVALID_KEYSIZE
;

912 
skey
->
ªubis
.
keyB™s
 = 
keyËn
*8;

918 
N
 = 
skey
->
ªubis
.
keyB™s
 >> 5;

923 
skey
->
ªubis
.
R
 = R = 8 + 
N
;

925 ià(
num_rounds
 !ğ0 &&‚um_round !ğ
skey
->
ªubis
.
R
) {

926  
CRYPT_INVALID_ROUNDS
;

932 
i
 = 0, 
pos
 = 0; i < 
N
; i++,…os += 4) {

933 
k­·
[
i
] =

934 (
key
[
pos
 ] << 24) ^

935 (
key
[
pos
 + 1] << 16) ^

936 (
key
[
pos
 + 2] << 8) ^

937 (
key
[
pos
 + 3] );

943 
r
 = 0;„ <ğ
R
;„++) {

947 
K0
 = 
T4
[(
k­·
[
N
 - 1] >> 24) & 0xff];

948 
K1
 = 
T4
[(
k­·
[
N
 - 1] >> 16) & 0xff];

949 
K2
 = 
T4
[(
k­·
[
N
 - 1] >> 8) & 0xff];

950 
K3
 = 
T4
[(
k­·
[
N
 - 1] ) & 0xff];

951 
i
 = 
N
 - 2; i >= 0; i--) {

952 
K0
 = 
T4
[(
k­·
[
i
] >> 24) & 0xff] ^

953 (
T5
[(
K0
 >> 24) & 0xff] & 0xff000000U) ^

954 (
T5
[(
K0
 >> 16) & 0xff] & 0x00ff0000U) ^

955 (
T5
[(
K0
 >> 8) & 0xff] & 0x0000ff00U) ^

956 (
T5
[(
K0
 ) & 0xff] & 0x000000ffU);

957 
K1
 = 
T4
[(
k­·
[
i
] >> 16) & 0xff] ^

958 (
T5
[(
K1
 >> 24) & 0xff] & 0xff000000U) ^

959 (
T5
[(
K1
 >> 16) & 0xff] & 0x00ff0000U) ^

960 (
T5
[(
K1
 >> 8) & 0xff] & 0x0000ff00U) ^

961 (
T5
[(
K1
 ) & 0xff] & 0x000000ffU);

962 
K2
 = 
T4
[(
k­·
[
i
] >> 8) & 0xff] ^

963 (
T5
[(
K2
 >> 24) & 0xff] & 0xff000000U) ^

964 (
T5
[(
K2
 >> 16) & 0xff] & 0x00ff0000U) ^

965 (
T5
[(
K2
 >> 8) & 0xff] & 0x0000ff00U) ^

966 (
T5
[(
K2
 ) & 0xff] & 0x000000ffU);

967 
K3
 = 
T4
[(
k­·
[
i
] ) & 0xff] ^

968 (
T5
[(
K3
 >> 24) & 0xff] & 0xff000000U) ^

969 (
T5
[(
K3
 >> 16) & 0xff] & 0x00ff0000U) ^

970 (
T5
[(
K3
 >> 8) & 0xff] & 0x0000ff00U) ^

971 (
T5
[(
K3
 ) & 0xff] & 0x000000ffU);

983 
skey
->
ªubis
.
roundKeyEnc
[
r
][0] = 
K0
;

984 
skey
->
ªubis
.
roundKeyEnc
[
r
][1] = 
K1
;

985 
skey
->
ªubis
.
roundKeyEnc
[
r
][2] = 
K2
;

986 
skey
->
ªubis
.
roundKeyEnc
[
r
][3] = 
K3
;

991 ià(
r
 =ğ
R
) {

994 
i
 = 0; i < 
N
; i++) {

995 
j
 = 
i
;

996 
š‹r
[
i
] = 
T0
[(
k­·
[
j
--] >> 24è& 0xff]; ià(j < 0èj = 
N
 - 1;

997 
š‹r
[
i
] ^ğ
T1
[(
k­·
[
j
--] >> 16è& 0xff]; ià(j < 0èj = 
N
 - 1;

998 
š‹r
[
i
] ^ğ
T2
[(
k­·
[
j
--] >> 8è& 0xff]; ià(j < 0èj = 
N
 - 1;

999 
š‹r
[
i
] ^ğ
T3
[(
k­·
[
j
 ] ) & 0xff];

1001 
k­·
[0] = 
š‹r
[0] ^ 
rc
[
r
];

1002 
i
 = 1; i < 
N
; i++) {

1003 
k­·
[
i
] = 
š‹r
[i];

1010 
i
 = 0; i < 4; i++) {

1011 
skey
->
ªubis
.
roundKeyDec
[0][
i
] = skey->ªubis.
roundKeyEnc
[
R
][i];

1012 
skey
->
ªubis
.
roundKeyDec
[
R
][
i
] = skey->ªubis.
roundKeyEnc
[0][i];

1014 
r
 = 1;„ < 
R
;„++) {

1015 
i
 = 0; i < 4; i++) {

1016 
v
 = 
skey
->
ªubis
.
roundKeyEnc
[
R
 - 
r
][
i
];

1017 
skey
->
ªubis
.
roundKeyDec
[
r
][
i
] =

1018 
T0
[
T4
[(
v
 >> 24) & 0xff] & 0xff] ^

1019 
T1
[
T4
[(
v
 >> 16) & 0xff] & 0xff] ^

1020 
T2
[
T4
[(
v
 >> 8) & 0xff] & 0xff] ^

1021 
T3
[
T4
[(
v
 ) & 0xff] & 0xff];

1025  
CRYPT_OK
;

1026 
	}
}

1028 #ifdeà
LTC_CLEAN_STACK


1029 
	$ªubis_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

1031 
”r
;

1032 
”r
 = 
	`_ªubis_£tup
(
key
, 
keyËn
, 
num_rounds
, 
skey
);

1033 
	`buº_¡ack
((è* 5 + (
ulÚg32
è* (
MAX_N
 + MAX_N + 5));

1034  
”r
;

1035 
	}
}

1039 
ªubis_üy±
(cÚ¡ *
¶aš‹xt
, *
ch”‹xt
,

1040 
ulÚg32
 
roundKey
[18 + 1][4], 
R
) {

1041 
	gi
, 
	gpos
, 
	gr
;

1042 
ulÚg32
 
	g¡©e
[4];

1043 
ulÚg32
 
	gš‹r
[4];

1049 
	gi
 = 0, 
	gpos
 = 0; i < 4; i++,…os += 4) {

1050 
¡©e
[
i
] =

1051 (
¶aš‹xt
[
pos
 ] << 24) ^

1052 (
¶aš‹xt
[
pos
 + 1] << 16) ^

1053 (
¶aš‹xt
[
pos
 + 2] << 8) ^

1054 (
¶aš‹xt
[
pos
 + 3] ) ^

1055 
roundKey
[0][
i
];

1061 
	gr
 = 1;„ < 
	gR
;„++) {

1062 
	gš‹r
[0] =

1063 
T0
[(
¡©e
[0] >> 24) & 0xff] ^

1064 
T1
[(
¡©e
[1] >> 24) & 0xff] ^

1065 
T2
[(
¡©e
[2] >> 24) & 0xff] ^

1066 
T3
[(
¡©e
[3] >> 24) & 0xff] ^

1067 
roundKey
[
r
][0];

1068 
	gš‹r
[1] =

1069 
T0
[(
¡©e
[0] >> 16) & 0xff] ^

1070 
T1
[(
¡©e
[1] >> 16) & 0xff] ^

1071 
T2
[(
¡©e
[2] >> 16) & 0xff] ^

1072 
T3
[(
¡©e
[3] >> 16) & 0xff] ^

1073 
roundKey
[
r
][1];

1074 
	gš‹r
[2] =

1075 
T0
[(
¡©e
[0] >> 8) & 0xff] ^

1076 
T1
[(
¡©e
[1] >> 8) & 0xff] ^

1077 
T2
[(
¡©e
[2] >> 8) & 0xff] ^

1078 
T3
[(
¡©e
[3] >> 8) & 0xff] ^

1079 
roundKey
[
r
][2];

1080 
	gš‹r
[3] =

1081 
T0
[(
¡©e
[0] ) & 0xff] ^

1082 
T1
[(
¡©e
[1] ) & 0xff] ^

1083 
T2
[(
¡©e
[2] ) & 0xff] ^

1084 
T3
[(
¡©e
[3] ) & 0xff] ^

1085 
roundKey
[
r
][3];

1086 
	g¡©e
[0] = 
š‹r
[0];

1087 
	g¡©e
[1] = 
š‹r
[1];

1088 
	g¡©e
[2] = 
š‹r
[2];

1089 
	g¡©e
[3] = 
š‹r
[3];

1095 
	gš‹r
[0] =

1096 (
T0
[(
¡©e
[0] >> 24) & 0xff] & 0xff000000U) ^

1097 (
T1
[(
¡©e
[1] >> 24) & 0xff] & 0x00ff0000U) ^

1098 (
T2
[(
¡©e
[2] >> 24) & 0xff] & 0x0000ff00U) ^

1099 (
T3
[(
¡©e
[3] >> 24) & 0xff] & 0x000000ffU) ^

1100 
roundKey
[
R
][0];

1101 
	gš‹r
[1] =

1102 (
T0
[(
¡©e
[0] >> 16) & 0xff] & 0xff000000U) ^

1103 (
T1
[(
¡©e
[1] >> 16) & 0xff] & 0x00ff0000U) ^

1104 (
T2
[(
¡©e
[2] >> 16) & 0xff] & 0x0000ff00U) ^

1105 (
T3
[(
¡©e
[3] >> 16) & 0xff] & 0x000000ffU) ^

1106 
roundKey
[
R
][1];

1107 
	gš‹r
[2] =

1108 (
T0
[(
¡©e
[0] >> 8) & 0xff] & 0xff000000U) ^

1109 (
T1
[(
¡©e
[1] >> 8) & 0xff] & 0x00ff0000U) ^

1110 (
T2
[(
¡©e
[2] >> 8) & 0xff] & 0x0000ff00U) ^

1111 (
T3
[(
¡©e
[3] >> 8) & 0xff] & 0x000000ffU) ^

1112 
roundKey
[
R
][2];

1113 
	gš‹r
[3] =

1114 (
T0
[(
¡©e
[0] ) & 0xff] & 0xff000000U) ^

1115 (
T1
[(
¡©e
[1] ) & 0xff] & 0x00ff0000U) ^

1116 (
T2
[(
¡©e
[2] ) & 0xff] & 0x0000ff00U) ^

1117 (
T3
[(
¡©e
[3] ) & 0xff] & 0x000000ffU) ^

1118 
roundKey
[
R
][3];

1123 
	gi
 = 0, 
	gpos
 = 0; i < 4; i++,…os += 4) {

1124 
ulÚg32
 
w
 = 
š‹r
[
i
];

1125 
	gch”‹xt
[
pos
 ] = ()(
w
 >> 24);

1126 
	gch”‹xt
[
pos
 + 1] = ()(
w
 >> 16);

1127 
	gch”‹xt
[
pos
 + 2] = ()(
w
 >> 8);

1128 
	gch”‹xt
[
pos
 + 3] = ()(
w
 );

1139 
	$ªubis_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

1141 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

1142 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

1143 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1144 
	`ªubis_üy±
(
±
, 
ù
, 
skey
->
ªubis
.
roundKeyEnc
, skey->ªubis.
R
);

1145  
CRYPT_OK
;

1146 
	}
}

1155 
	$ªubis_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

1157 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

1158 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

1159 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1160 
	`ªubis_üy±
(
ù
, 
±
, 
skey
->
ªubis
.
roundKeyDec
, skey->ªubis.
R
);

1161  
CRYPT_OK
;

1162 
	}
}

1168 
	$ªubis_‹¡
()

1170 #ià!
	`defšed
(
LTC_TEST
)

1171  
CRYPT_NOP
;

1173 cÚ¡ 
	s‹¡
 {

1174 
keyËn
;

1175 
±
[16], 
ù
[16], 
key
[40];

1176 } 
‹¡s
[] = {

1177 #iâdeà
ANUBIS_TWEAK


1495 
x
, 
y
;

1496 
buf
[2][16];

1497 
symm‘ric_key
 
skey
;

1499 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

1500 
	`ªubis_£tup
(
‹¡s
[
x
].
key
,e¡s[x].
keyËn
, 0, &
skey
);

1501 
	`ªubis_ecb_’üy±
(
‹¡s
[
x
].
±
, 
buf
[0], &
skey
);

1502 
	`ªubis_ecb_deüy±
(
buf
[0], buf[1], &
skey
);

1503 ià(
	`XMEMCMP
(
buf
[0], 
‹¡s
[
x
].
ù
, 16è|| XMEMCMP(buf[1],e¡s[x].
±
, 16)) {

1504  
CRYPT_FAIL_TESTVECTOR
;

1507 
y
 = 0; y < 1000; y++è
	`ªubis_ecb_’üy±
(
buf
[0], buf[0], &
skey
);

1508 
y
 = 0; y < 1000; y++è
	`ªubis_ecb_deüy±
(
buf
[0], buf[0], &
skey
);

1509 ià(
	`XMEMCMP
(
buf
[0], 
‹¡s
[
x
].
ù
, 16)) {

1510  
CRYPT_FAIL_TESTVECTOR
;

1514  
CRYPT_OK
;

1516 
	}
}

1521 
	$ªubis_dÚe
(
symm‘ric_key
 *
skey
)

1523 
	}
}

1530 
	$ªubis_keysize
(*
keysize
)

1532 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

1533 ià(*
keysize
 >= 40) {

1534 *
keysize
 = 40;

1535 } ià(*
keysize
 >= 36) {

1536 *
keysize
 = 36;

1537 } ià(*
keysize
 >= 32) {

1538 *
keysize
 = 32;

1539 } ià(*
keysize
 >= 28) {

1540 *
keysize
 = 28;

1541 } ià(*
keysize
 >= 24) {

1542 *
keysize
 = 24;

1543 } ià(*
keysize
 >= 20) {

1544 *
keysize
 = 20;

1545 } ià(*
keysize
 >= 16) {

1546 *
keysize
 = 16;

1548  
CRYPT_INVALID_KEYSIZE
;

1550  
CRYPT_OK
;

1551 
	}
}

	@libtomcrypt/src/ciphers/blowfish.c

15 
	~"tomüy±.h
"

17 #ifdeà
BLOWFISH


19 cÚ¡ 
Éc_ch”_desütÜ
 
	gblowfish_desc
 =

24 &
blowfish_£tup
,

25 &
blowfish_ecb_’üy±
,

26 &
blowfish_ecb_deüy±
,

27 &
blowfish_‹¡
,

28 &
blowfish_dÚe
,

29 &
blowfish_keysize
,

30 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

33 cÚ¡ 
ulÚg32
 
	gORIG_P
[16 + 2] = {

41 cÚ¡ 
ulÚg32
 
	gORIG_S
[4][256] = {

308 
	$blowfish_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
,

309 
symm‘ric_key
 *
skey
)

311 
ulÚg32
 
x
, 
y
, 
z
, 
A
;

312 
B
[8];

314 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

315 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

318 ià(
keyËn
 < 8 || keylen > 56) {

319  
CRYPT_INVALID_KEYSIZE
;

323 ià(
num_rounds
 != 0 &&‚um_rounds != 16) {

324  
CRYPT_INVALID_ROUNDS
;

328 
x
 = 
y
 = 0; x < 18; x++) {

329 
A
 = 0;

330 
z
 = 0; z < 4; z++) {

331 
A
 = (A << 8è| ((
ulÚg32
)
key
[
y
++] & 255);

332 ià(
y
 =ğ(
ulÚg32
)
keyËn
) {

333 
y
 = 0;

336 
skey
->
blowfish
.
K
[
x
] = 
ORIG_P
[x] ^ 
A
;

340 
x
 = 0; x < 4; x++) {

341 
y
 = 0; y < 256; y++) {

342 
skey
->
blowfish
.
S
[
x
][
y
] = 
ORIG_S
[x][y];

347 
x
 = 0; x < 8; x++) {

348 
B
[
x
] = 0;

351 
x
 = 0; x < 18; x += 2) {

353 
	`blowfish_ecb_’üy±
(
B
, B, 
skey
);

355 
	`LOAD32H
(
skey
->
blowfish
.
K
[
x
], &
B
[0]);

356 
	`LOAD32H
(
skey
->
blowfish
.
K
[
x
+1], &
B
[4]);

360 
x
 = 0; x < 4; x++) {

361 
y
 = 0; y < 256; y += 2) {

363 
	`blowfish_ecb_’üy±
(
B
, B, 
skey
);

365 
	`LOAD32H
(
skey
->
blowfish
.
S
[
x
][
y
], &
B
[0]);

366 
	`LOAD32H
(
skey
->
blowfish
.
S
[
x
][
y
+1], &
B
[4]);

370 #ifdeà
LTC_CLEAN_STACK


371 
	`z”omem
(
B
, (B));

374  
CRYPT_OK
;

375 
	}
}

377 #iâdeà
__GNUC__


378 
	#F
(
x
è((
S1
[
	`by‹
(x,3)] + 
S2
[by‹(x,2)]è^ 
S3
[by‹(x,1)]è+ 
S4
[by‹(x,0)]

	)

380 
	#F
(
x
è((
skey
->
blowfish
.
S
[0][
	`by‹
(x,3)] + skey->blowfish.S[1][by‹(x,2)]è^ skey->blowfish.S[2][by‹(x,1)]è+ skey->blowfish.S[3][by‹(x,0)]

	)

390 #ifdeà
LTC_CLEAN_STACK


391 
	$_blowfish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

393 
	$blowfish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

396 
ulÚg32
 
L
, 
R
;

397 
r
;

398 #iâdeà
__GNUC__


399 
ulÚg32
 *
S1
, *
S2
, *
S3
, *
S4
;

402 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

403 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

404 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

406 #iâdeà
__GNUC__


407 
S1
 = 
skey
->
blowfish
.
S
[0];

408 
S2
 = 
skey
->
blowfish
.
S
[1];

409 
S3
 = 
skey
->
blowfish
.
S
[2];

410 
S4
 = 
skey
->
blowfish
.
S
[3];

414 
	`LOAD32H
(
L
, &
±
[0]);

415 
	`LOAD32H
(
R
, &
±
[4]);

418 
r
 = 0;„ < 16; ) {

419 
L
 ^ğ
skey
->
blowfish
.
K
[
r
++]; 
R
 ^ğ
	`F
(L);

420 
R
 ^ğ
skey
->
blowfish
.
K
[
r
++]; 
L
 ^ğ
	`F
(R);

421 
L
 ^ğ
skey
->
blowfish
.
K
[
r
++]; 
R
 ^ğ
	`F
(L);

422 
R
 ^ğ
skey
->
blowfish
.
K
[
r
++]; 
L
 ^ğ
	`F
(R);

426 
R
 ^ğ
skey
->
blowfish
.
K
[17];

427 
L
 ^ğ
skey
->
blowfish
.
K
[16];

430 
	`STORE32H
(
R
, &
ù
[0]);

431 
	`STORE32H
(
L
, &
ù
[4]);

433  
CRYPT_OK
;

434 
	}
}

436 #ifdeà
LTC_CLEAN_STACK


437 
	$blowfish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

439 
”r
 = 
	`_blowfish_ecb_’üy±
(
±
, 
ù
, 
skey
);

440 
	`buº_¡ack
((
ulÚg32
) * 2 + ());

441  
”r
;

442 
	}
}

452 #ifdeà
LTC_CLEAN_STACK


453 
	$_blowfish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

455 
	$blowfish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

458 
ulÚg32
 
L
, 
R
;

459 
r
;

460 #iâdeà
__GNUC__


461 
ulÚg32
 *
S1
, *
S2
, *
S3
, *
S4
;

464 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

465 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

466 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

468 #iâdeà
__GNUC__


469 
S1
 = 
skey
->
blowfish
.
S
[0];

470 
S2
 = 
skey
->
blowfish
.
S
[1];

471 
S3
 = 
skey
->
blowfish
.
S
[2];

472 
S4
 = 
skey
->
blowfish
.
S
[3];

476 
	`LOAD32H
(
R
, &
ù
[0]);

477 
	`LOAD32H
(
L
, &
ù
[4]);

480 
R
 ^ğ
skey
->
blowfish
.
K
[17];

481 
L
 ^ğ
skey
->
blowfish
.
K
[16];

484 
r
 = 15;„ > 0; ) {

485 
L
 ^ğ
	`F
(
R
); R ^ğ
skey
->
blowfish
.
K
[
r
--];

486 
R
 ^ğ
	`F
(
L
); L ^ğ
skey
->
blowfish
.
K
[
r
--];

487 
L
 ^ğ
	`F
(
R
); R ^ğ
skey
->
blowfish
.
K
[
r
--];

488 
R
 ^ğ
	`F
(
L
); L ^ğ
skey
->
blowfish
.
K
[
r
--];

492 
	`STORE32H
(
L
, &
±
[0]);

493 
	`STORE32H
(
R
, &
±
[4]);

494  
CRYPT_OK
;

495 
	}
}

497 #ifdeà
LTC_CLEAN_STACK


498 
	$blowfish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

500 
”r
 = 
	`_blowfish_ecb_deüy±
(
ù
, 
±
, 
skey
);

501 
	`buº_¡ack
((
ulÚg32
) * 2 + ());

502  
”r
;

503 
	}
}

511 
	$blowfish_‹¡
()

513 #iâdeà
LTC_TEST


514  
CRYPT_NOP
;

516 
”r
;

517 
symm‘ric_key
 
key
;

519 
key
[8], 
±
[8], 
ù
[8];

520 } 
‹¡s
[] = {

537 
tmp
[2][8];

538 
x
, 
y
;

540 
x
 = 0; x < ()((
‹¡s
) / (tests[0])); x++) {

542 ià((
”r
 = 
	`blowfish_£tup
(
‹¡s
[
x
].
key
, 8, 16, &key)è!ğ
CRYPT_OK
) {

543  
”r
;

547 
	`blowfish_ecb_’üy±
(
‹¡s
[
x
].
±
, 
tmp
[0], &
key
);

548 
	`blowfish_ecb_deüy±
(
tmp
[0],mp[1], &
key
);

551 ià((
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
x
].
ù
, 8è!ğ0è|| (XMEMCMPÑmp[1],e¡s[x].
±
, 8) != 0)) {

552  
CRYPT_FAIL_TESTVECTOR
;

556 
y
 = 0; y < 8; y++è
tmp
[0][y] = 0;

557 
y
 = 0; y < 1000; y++è
	`blowfish_ecb_’üy±
(
tmp
[0],mp[0], &
key
);

558 
y
 = 0; y < 1000; y++è
	`blowfish_ecb_deüy±
(
tmp
[0],mp[0], &
key
);

559 
y
 = 0; y < 8; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

561  
CRYPT_OK
;

563 
	}
}

568 
	$blowfish_dÚe
(
symm‘ric_key
 *
skey
)

570 
	}
}

577 
	$blowfish_keysize
(*
keysize
)

579 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

581 ià(*
keysize
 < 8) {

582  
CRYPT_INVALID_KEYSIZE
;

583 } ià(*
keysize
 > 56) {

584 *
keysize
 = 56;

586  
CRYPT_OK
;

587 
	}
}

	@libtomcrypt/src/ciphers/cast5.c

16 
	~"tomüy±.h
"

18 #ifdeà
CAST5


20 cÚ¡ 
Éc_ch”_desütÜ
 
	gÿ¡5_desc
 = {

24 &
ÿ¡5_£tup
,

25 &
ÿ¡5_ecb_’üy±
,

26 &
ÿ¡5_ecb_deüy±
,

27 &
ÿ¡5_‹¡
,

28 &
ÿ¡5_dÚe
,

29 &
ÿ¡5_keysize
,

30 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

33 cÚ¡ 
ulÚg32
 
	gS1
[256] = {

78 cÚ¡ 
ulÚg32
 
	gS2
[256] = {

123 cÚ¡ 
ulÚg32
 
	gS3
[256] = {

168 cÚ¡ 
ulÚg32
 
	gS4
[256] = {

213 cÚ¡ 
ulÚg32
 
	gS5
[256] = {

258 cÚ¡ 
ulÚg32
 
	gS6
[256] = {

303 cÚ¡ 
ulÚg32
 
	gS7
[256] = {

348 cÚ¡ 
ulÚg32
 
	gS8
[256] = {

394 #ifdeà
_MSC_VER


395 
	#GB
(
x
, 
i
è(()((x[(15-i)>>2])>>()(8*((15-i)&3))))

	)

397 
	#GB
(
x
, 
i
è(((x[(15-i)>>2])>>()(8*((15-i)&3)))&255)

	)

408 #ifdeà
LTC_CLEAN_STACK


409 
	$_ÿ¡5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

411 
	$ÿ¡5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

414 
ulÚg32
 
x
[4], 
z
[4];

415 
buf
[16];

416 
y
, 
i
;

418 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

419 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

421 ià(
num_rounds
 != 12 &&‚um_rounds != 16 &&‚um_rounds != 0) {

422  
CRYPT_INVALID_ROUNDS
;

425 ià(
num_rounds
 =ğ12 && 
keyËn
 > 10) {

426  
CRYPT_INVALID_ROUNDS
;

429 ià(
keyËn
 < 5 || keylen > 16) {

430  
CRYPT_INVALID_KEYSIZE
;

434 
	`z”omem
(
buf
, (buf));

435 
	`XMEMCPY
(
buf
, 
key
, (
size_t
)
keyËn
);

438 
y
 = 0; y < 4; y++) {

439 
	`LOAD32H
(
x
[3-
y
],
buf
+4*y);

442 
i
 = 
y
 = 0; y < 2; y++) {

443 
z
[3] = 
x
[3] ^ 
S5
[
	`GB
(x, 0xD)] ^ 
S6
[GB(x, 0xF)] ^ 
S7
[GB(x, 0xC)] ^ 
S8
[GB(x, 0xE)] ^ S7[GB(x, 0x8)];

444 
z
[2] = 
x
[1] ^ 
S5
[
	`GB
(z, 0x0)] ^ 
S6
[GB(z, 0x2)] ^ 
S7
[GB(z, 0x1)] ^ 
S8
[GB(z, 0x3)] ^ S8[GB(x, 0xA)];

445 
z
[1] = 
x
[0] ^ 
S5
[
	`GB
(z, 0x7)] ^ 
S6
[GB(z, 0x6)] ^ 
S7
[GB(z, 0x5)] ^ 
S8
[GB(z, 0x4)] ^ S5[GB(x, 0x9)];

446 
z
[0] = 
x
[2] ^ 
S5
[
	`GB
(z, 0xA)] ^ 
S6
[GB(z, 0x9)] ^ 
S7
[GB(z, 0xb)] ^ 
S8
[GB(z, 0x8)] ^ S6[GB(x, 0xB)];

447 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0x8)] ^ 
S6
[GB(z, 0x9)] ^ 
S7
[GB(z, 0x7)] ^ 
S8
[GB(z, 0x6)] ^ S5[GB(z, 0x2)];

448 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0xA)] ^ 
S6
[GB(z, 0xB)] ^ 
S7
[GB(z, 0x5)] ^ 
S8
[GB(z, 0x4)] ^ S6[GB(z, 0x6)];

449 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0xC)] ^ 
S6
[GB(z, 0xd)] ^ 
S7
[GB(z, 0x3)] ^ 
S8
[GB(z, 0x2)] ^ S7[GB(z, 0x9)];

450 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0xE)] ^ 
S6
[GB(z, 0xF)] ^ 
S7
[GB(z, 0x1)] ^ 
S8
[GB(z, 0x0)] ^ S8[GB(z, 0xc)];

452 
x
[3] = 
z
[1] ^ 
S5
[
	`GB
(z, 0x5)] ^ 
S6
[GB(z, 0x7)] ^ 
S7
[GB(z, 0x4)] ^ 
S8
[GB(z, 0x6)] ^ S7[GB(z, 0x0)];

453 
x
[2] = 
z
[3] ^ 
S5
[
	`GB
(x, 0x0)] ^ 
S6
[GB(x, 0x2)] ^ 
S7
[GB(x, 0x1)] ^ 
S8
[GB(x, 0x3)] ^ S8[GB(z, 0x2)];

454 
x
[1] = 
z
[2] ^ 
S5
[
	`GB
(x, 0x7)] ^ 
S6
[GB(x, 0x6)] ^ 
S7
[GB(x, 0x5)] ^ 
S8
[GB(x, 0x4)] ^ S5[GB(z, 0x1)];

455 
x
[0] = 
z
[0] ^ 
S5
[
	`GB
(x, 0xA)] ^ 
S6
[GB(x, 0x9)] ^ 
S7
[GB(x, 0xb)] ^ 
S8
[GB(x, 0x8)] ^ S6[GB(z, 0x3)];

456 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0x3)] ^ 
S6
[GB(x, 0x2)] ^ 
S7
[GB(x, 0xc)] ^ 
S8
[GB(x, 0xd)] ^ S5[GB(x, 0x8)];

457 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0x1)] ^ 
S6
[GB(x, 0x0)] ^ 
S7
[GB(x, 0xe)] ^ 
S8
[GB(x, 0xf)] ^ S6[GB(x, 0xd)];

458 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0x7)] ^ 
S6
[GB(x, 0x6)] ^ 
S7
[GB(x, 0x8)] ^ 
S8
[GB(x, 0x9)] ^ S7[GB(x, 0x3)];

459 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0x5)] ^ 
S6
[GB(x, 0x4)] ^ 
S7
[GB(x, 0xa)] ^ 
S8
[GB(x, 0xb)] ^ S8[GB(x, 0x7)];

462 
z
[3] = 
x
[3] ^ 
S5
[
	`GB
(x, 0xD)] ^ 
S6
[GB(x, 0xF)] ^ 
S7
[GB(x, 0xC)] ^ 
S8
[GB(x, 0xE)] ^ S7[GB(x, 0x8)];

463 
z
[2] = 
x
[1] ^ 
S5
[
	`GB
(z, 0x0)] ^ 
S6
[GB(z, 0x2)] ^ 
S7
[GB(z, 0x1)] ^ 
S8
[GB(z, 0x3)] ^ S8[GB(x, 0xA)];

464 
z
[1] = 
x
[0] ^ 
S5
[
	`GB
(z, 0x7)] ^ 
S6
[GB(z, 0x6)] ^ 
S7
[GB(z, 0x5)] ^ 
S8
[GB(z, 0x4)] ^ S5[GB(x, 0x9)];

465 
z
[0] = 
x
[2] ^ 
S5
[
	`GB
(z, 0xA)] ^ 
S6
[GB(z, 0x9)] ^ 
S7
[GB(z, 0xb)] ^ 
S8
[GB(z, 0x8)] ^ S6[GB(x, 0xB)];

466 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0x3)] ^ 
S6
[GB(z, 0x2)] ^ 
S7
[GB(z, 0xc)] ^ 
S8
[GB(z, 0xd)] ^ S5[GB(z, 0x9)];

467 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0x1)] ^ 
S6
[GB(z, 0x0)] ^ 
S7
[GB(z, 0xe)] ^ 
S8
[GB(z, 0xf)] ^ S6[GB(z, 0xc)];

468 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0x7)] ^ 
S6
[GB(z, 0x6)] ^ 
S7
[GB(z, 0x8)] ^ 
S8
[GB(z, 0x9)] ^ S7[GB(z, 0x2)];

469 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
z
, 0x5)] ^ 
S6
[GB(z, 0x4)] ^ 
S7
[GB(z, 0xa)] ^ 
S8
[GB(z, 0xb)] ^ S8[GB(z, 0x6)];

471 
x
[3] = 
z
[1] ^ 
S5
[
	`GB
(z, 0x5)] ^ 
S6
[GB(z, 0x7)] ^ 
S7
[GB(z, 0x4)] ^ 
S8
[GB(z, 0x6)] ^ S7[GB(z, 0x0)];

472 
x
[2] = 
z
[3] ^ 
S5
[
	`GB
(x, 0x0)] ^ 
S6
[GB(x, 0x2)] ^ 
S7
[GB(x, 0x1)] ^ 
S8
[GB(x, 0x3)] ^ S8[GB(z, 0x2)];

473 
x
[1] = 
z
[2] ^ 
S5
[
	`GB
(x, 0x7)] ^ 
S6
[GB(x, 0x6)] ^ 
S7
[GB(x, 0x5)] ^ 
S8
[GB(x, 0x4)] ^ S5[GB(z, 0x1)];

474 
x
[0] = 
z
[0] ^ 
S5
[
	`GB
(x, 0xA)] ^ 
S6
[GB(x, 0x9)] ^ 
S7
[GB(x, 0xb)] ^ 
S8
[GB(x, 0x8)] ^ S6[GB(z, 0x3)];

475 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0x8)] ^ 
S6
[GB(x, 0x9)] ^ 
S7
[GB(x, 0x7)] ^ 
S8
[GB(x, 0x6)] ^ S5[GB(x, 0x3)];

476 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0xa)] ^ 
S6
[GB(x, 0xb)] ^ 
S7
[GB(x, 0x5)] ^ 
S8
[GB(x, 0x4)] ^ S6[GB(x, 0x7)];

477 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0xc)] ^ 
S6
[GB(x, 0xd)] ^ 
S7
[GB(x, 0x3)] ^ 
S8
[GB(x, 0x2)] ^ S7[GB(x, 0x8)];

478 
skey
->
ÿ¡5
.
K
[
i
++] = 
S5
[
	`GB
(
x
, 0xe)] ^ 
S6
[GB(x, 0xf)] ^ 
S7
[GB(x, 0x1)] ^ 
S8
[GB(x, 0x0)] ^ S8[GB(x, 0xd)];

481 
skey
->
ÿ¡5
.
keyËn
 = keylen;

483 #ifdeà
LTC_CLEAN_STACK


484 
	`z”omem
(
buf
, (buf));

485 
	`z”omem
(
x
, (x));

486 
	`z”omem
(
z
, (z));

489  
CRYPT_OK
;

490 
	}
}

492 #ifdeà
LTC_CLEAN_STACK


493 
	$ÿ¡5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

495 
z
;

496 
z
 = 
	`_ÿ¡5_£tup
(
key
, 
keyËn
, 
num_rounds
, 
skey
);

497 
	`buº_¡ack
((
ulÚg32
)*8 + 16 + ()*2);

498  
z
;

499 
	}
}

502 #ifdeà
_MSC_VER


503 
	#INLINE
 
__šlše


	)

505 
	#INLINE


	)

508 
INLINE
 
ulÚg32
 
	$FI
(
ulÚg32
 
R
, ulÚg32 
Km
, ulÚg32 
Kr
)

510 
ulÚg32
 
I
;

511 
I
 = (
Km
 + 
R
);

512 
I
 = 
	`ROL
(I, 
Kr
);

513  ((
S1
[
	`by‹
(
I
, 3)] ^ 
S2
[by‹(I,2)]è- 
S3
[by‹(I,1)]è+ 
S4
[byte(I,0)];

514 
	}
}

516 
INLINE
 
ulÚg32
 
	$FII
(
ulÚg32
 
R
, ulÚg32 
Km
, ulÚg32 
Kr
)

518 
ulÚg32
 
I
;

519 
I
 = (
Km
 ^ 
R
);

520 
I
 = 
	`ROL
(I, 
Kr
);

521  ((
S1
[
	`by‹
(
I
, 3)] - 
S2
[by‹(I,2)]è+ 
S3
[by‹(I,1)]è^ 
S4
[byte(I,0)];

522 
	}
}

524 
INLINE
 
ulÚg32
 
	$FIII
(
ulÚg32
 
R
, ulÚg32 
Km
, ulÚg32 
Kr
)

526 
ulÚg32
 
I
;

527 
I
 = (
Km
 - 
R
);

528 
I
 = 
	`ROL
(I, 
Kr
);

529  ((
S1
[
	`by‹
(
I
, 3)] + 
S2
[by‹(I,2)]è^ 
S3
[by‹(I,1)]è- 
S4
[byte(I,0)];

530 
	}
}

538 #ifdeà
LTC_CLEAN_STACK


539 
	$_ÿ¡5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

541 
	$ÿ¡5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

544 
ulÚg32
 
R
, 
L
;

546 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

547 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

548 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

550 
	`LOAD32H
(
L
,&
±
[0]);

551 
	`LOAD32H
(
R
,&
±
[4]);

552 
L
 ^ğ
	`FI
(
R
, 
skey
->
ÿ¡5
.
K
[0], skey->cast5.K[16]);

553 
R
 ^ğ
	`FII
(
L
, 
skey
->
ÿ¡5
.
K
[1], skey->cast5.K[17]);

554 
L
 ^ğ
	`FIII
(
R
, 
skey
->
ÿ¡5
.
K
[2], skey->cast5.K[18]);

555 
R
 ^ğ
	`FI
(
L
, 
skey
->
ÿ¡5
.
K
[3], skey->cast5.K[19]);

556 
L
 ^ğ
	`FII
(
R
, 
skey
->
ÿ¡5
.
K
[4], skey->cast5.K[20]);

557 
R
 ^ğ
	`FIII
(
L
, 
skey
->
ÿ¡5
.
K
[5], skey->cast5.K[21]);

558 
L
 ^ğ
	`FI
(
R
, 
skey
->
ÿ¡5
.
K
[6], skey->cast5.K[22]);

559 
R
 ^ğ
	`FII
(
L
, 
skey
->
ÿ¡5
.
K
[7], skey->cast5.K[23]);

560 
L
 ^ğ
	`FIII
(
R
, 
skey
->
ÿ¡5
.
K
[8], skey->cast5.K[24]);

561 
R
 ^ğ
	`FI
(
L
, 
skey
->
ÿ¡5
.
K
[9], skey->cast5.K[25]);

562 
L
 ^ğ
	`FII
(
R
, 
skey
->
ÿ¡5
.
K
[10], skey->cast5.K[26]);

563 
R
 ^ğ
	`FIII
(
L
, 
skey
->
ÿ¡5
.
K
[11], skey->cast5.K[27]);

564 ià(
skey
->
ÿ¡5
.
keyËn
 > 10) {

565 
L
 ^ğ
	`FI
(
R
, 
skey
->
ÿ¡5
.
K
[12], skey->cast5.K[28]);

566 
R
 ^ğ
	`FII
(
L
, 
skey
->
ÿ¡5
.
K
[13], skey->cast5.K[29]);

567 
L
 ^ğ
	`FIII
(
R
, 
skey
->
ÿ¡5
.
K
[14], skey->cast5.K[30]);

568 
R
 ^ğ
	`FI
(
L
, 
skey
->
ÿ¡5
.
K
[15], skey->cast5.K[31]);

570 
	`STORE32H
(
R
,&
ù
[0]);

571 
	`STORE32H
(
L
,&
ù
[4]);

572  
CRYPT_OK
;

573 
	}
}

576 #ifdeà
LTC_CLEAN_STACK


577 
	$ÿ¡5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

579 
”r
 =
	`_ÿ¡5_ecb_’üy±
(
±
,
ù
,
skey
);

580 
	`buº_¡ack
((
ulÚg32
)*3);

581  
”r
;

582 
	}
}

591 #ifdeà
LTC_CLEAN_STACK


592 
	$_ÿ¡5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

594 
	$ÿ¡5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

597 
ulÚg32
 
R
, 
L
;

599 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

600 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

601 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

603 
	`LOAD32H
(
R
,&
ù
[0]);

604 
	`LOAD32H
(
L
,&
ù
[4]);

605 ià(
skey
->
ÿ¡5
.
keyËn
 > 10) {

606 
R
 ^ğ
	`FI
(
L
, 
skey
->
ÿ¡5
.
K
[15], skey->cast5.K[31]);

607 
L
 ^ğ
	`FIII
(
R
, 
skey
->
ÿ¡5
.
K
[14], skey->cast5.K[30]);

608 
R
 ^ğ
	`FII
(
L
, 
skey
->
ÿ¡5
.
K
[13], skey->cast5.K[29]);

609 
L
 ^ğ
	`FI
(
R
, 
skey
->
ÿ¡5
.
K
[12], skey->cast5.K[28]);

611 
R
 ^ğ
	`FIII
(
L
, 
skey
->
ÿ¡5
.
K
[11], skey->cast5.K[27]);

612 
L
 ^ğ
	`FII
(
R
, 
skey
->
ÿ¡5
.
K
[10], skey->cast5.K[26]);

613 
R
 ^ğ
	`FI
(
L
, 
skey
->
ÿ¡5
.
K
[9], skey->cast5.K[25]);

614 
L
 ^ğ
	`FIII
(
R
, 
skey
->
ÿ¡5
.
K
[8], skey->cast5.K[24]);

615 
R
 ^ğ
	`FII
(
L
, 
skey
->
ÿ¡5
.
K
[7], skey->cast5.K[23]);

616 
L
 ^ğ
	`FI
(
R
, 
skey
->
ÿ¡5
.
K
[6], skey->cast5.K[22]);

617 
R
 ^ğ
	`FIII
(
L
, 
skey
->
ÿ¡5
.
K
[5], skey->cast5.K[21]);

618 
L
 ^ğ
	`FII
(
R
, 
skey
->
ÿ¡5
.
K
[4], skey->cast5.K[20]);

619 
R
 ^ğ
	`FI
(
L
, 
skey
->
ÿ¡5
.
K
[3], skey->cast5.K[19]);

620 
L
 ^ğ
	`FIII
(
R
, 
skey
->
ÿ¡5
.
K
[2], skey->cast5.K[18]);

621 
R
 ^ğ
	`FII
(
L
, 
skey
->
ÿ¡5
.
K
[1], skey->cast5.K[17]);

622 
L
 ^ğ
	`FI
(
R
, 
skey
->
ÿ¡5
.
K
[0], skey->cast5.K[16]);

623 
	`STORE32H
(
L
,&
±
[0]);

624 
	`STORE32H
(
R
,&
±
[4]);

626  
CRYPT_OK
;

627 
	}
}

629 #ifdeà
LTC_CLEAN_STACK


630 
	$ÿ¡5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

632 
”r
 = 
	`_ÿ¡5_ecb_deüy±
(
ù
,
±
,
skey
);

633 
	`buº_¡ack
((
ulÚg32
)*3);

634  
”r
;

635 
	}
}

642 
	$ÿ¡5_‹¡
()

644 #iâdeà
LTC_TEST


645  
CRYPT_NOP
;

648 
keyËn
;

649 
key
[16];

650 
±
[8];

651 
ù
[8];

652 } 
‹¡s
[] = {

669 
i
, 
y
, 
”r
;

670 
symm‘ric_key
 
key
;

671 
tmp
[2][8];

673 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

674 ià((
”r
 = 
	`ÿ¡5_£tup
(
‹¡s
[
i
].
key
,e¡s[i].
keyËn
, 0, &key)è!ğ
CRYPT_OK
) {

675  
”r
;

677 
	`ÿ¡5_ecb_’üy±
(
‹¡s
[
i
].
±
, 
tmp
[0], &
key
);

678 
	`ÿ¡5_ecb_deüy±
(
tmp
[0],mp[1], &
key
);

679 ià((
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
i
].
ù
, 8è!ğ0è|| (XMEMCMPÑmp[1],e¡s[i].
±
, 8) != 0)) {

680  
CRYPT_FAIL_TESTVECTOR
;

683 
y
 = 0; y < 8; y++è
tmp
[0][y] = 0;

684 
y
 = 0; y < 1000; y++è
	`ÿ¡5_ecb_’üy±
(
tmp
[0],mp[0], &
key
);

685 
y
 = 0; y < 1000; y++è
	`ÿ¡5_ecb_deüy±
(
tmp
[0],mp[0], &
key
);

686 
y
 = 0; y < 8; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

689  
CRYPT_OK
;

691 
	}
}

696 
	$ÿ¡5_dÚe
(
symm‘ric_key
 *
skey
)

698 
	}
}

705 
	$ÿ¡5_keysize
(*
keysize
)

707 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

708 ià(*
keysize
 < 5) {

709  
CRYPT_INVALID_KEYSIZE
;

710 } ià(*
keysize
 > 16) {

711 *
keysize
 = 16;

713  
CRYPT_OK
;

714 
	}
}

	@libtomcrypt/src/ciphers/des.c

11 
	~"tomüy±.h
"

18 #ifdeà
DES


20 
	#EN0
 0

	)

21 
	#DE1
 1

	)

24 cÚ¡ 
Éc_ch”_desütÜ
 
	gdes_desc
 =

29 &
des_£tup
,

30 &
des_ecb_’üy±
,

31 &
des_ecb_deüy±
,

32 &
des_‹¡
,

33 &
des_dÚe
,

34 &
des_keysize
,

35 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

39 cÚ¡ 
Éc_ch”_desütÜ
 
	gdes3_desc
 =

44 &
des3_£tup
,

45 &
des3_ecb_’üy±
,

46 &
des3_ecb_deüy±
,

47 &
des3_‹¡
,

48 &
des3_dÚe
,

49 &
des3_keysize
,

50 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

53 cÚ¡ 
ulÚg32
 
	gby‹b™
[8] =

58 cÚ¡ 
ulÚg32
 
	gbigby‹
[24] =

70 cÚ¡ 
	gpc1
[56] = {

77 cÚ¡ 
	gtÙrÙ
[16] = {

84 cÚ¡ 
	gpc2
[48] = {

92 cÚ¡ 
ulÚg32
 
	gSP1
[64] =

112 cÚ¡ 
ulÚg32
 
	gSP2
[64] =

132 cÚ¡ 
ulÚg32
 
	gSP3
[64] =

152 cÚ¡ 
ulÚg32
 
	gSP4
[64] =

172 cÚ¡ 
ulÚg32
 
	gSP5
[64] =

192 cÚ¡ 
ulÚg32
 
	gSP6
[64] =

212 cÚ¡ 
ulÚg32
 
	gSP7
[64] =

232 cÚ¡ 
ulÚg32
 
	gSP8
[64] =

252 #iâdeà
LTC_SMALL_CODE


254 cÚ¡ 
ulÚg64
 
	gdes_
[8][256] = {

256 { 
CONST64
(0x0000000000000000), CONST64(0x0000001000000000), CONST64(0x0000000000000010), CONST64(0x0000001000000010),

257 
CONST64
(0x0000100000000000), CONST64(0x0000101000000000), CONST64(0x0000100000000010), CONST64(0x0000101000000010),

258 
CONST64
(0x0000000000001000), CONST64(0x0000001000001000), CONST64(0x0000000000001010), CONST64(0x0000001000001010),

259 
CONST64
(0x0000100000001000), CONST64(0x0000101000001000), CONST64(0x0000100000001010), CONST64(0x0000101000001010),

260 
CONST64
(0x0010000000000000), CONST64(0x0010001000000000), CONST64(0x0010000000000010), CONST64(0x0010001000000010),

261 
CONST64
(0x0010100000000000), CONST64(0x0010101000000000), CONST64(0x0010100000000010), CONST64(0x0010101000000010),

262 
CONST64
(0x0010000000001000), CONST64(0x0010001000001000), CONST64(0x0010000000001010), CONST64(0x0010001000001010),

263 
CONST64
(0x0010100000001000), CONST64(0x0010101000001000), CONST64(0x0010100000001010), CONST64(0x0010101000001010),

264 
CONST64
(0x0000000000100000), CONST64(0x0000001000100000), CONST64(0x0000000000100010), CONST64(0x0000001000100010),

265 
CONST64
(0x0000100000100000), CONST64(0x0000101000100000), CONST64(0x0000100000100010), CONST64(0x0000101000100010),

266 
CONST64
(0x0000000000101000), CONST64(0x0000001000101000), CONST64(0x0000000000101010), CONST64(0x0000001000101010),

267 
CONST64
(0x0000100000101000), CONST64(0x0000101000101000), CONST64(0x0000100000101010), CONST64(0x0000101000101010),

268 
CONST64
(0x0010000000100000), CONST64(0x0010001000100000), CONST64(0x0010000000100010), CONST64(0x0010001000100010),

269 
CONST64
(0x0010100000100000), CONST64(0x0010101000100000), CONST64(0x0010100000100010), CONST64(0x0010101000100010),

270 
CONST64
(0x0010000000101000), CONST64(0x0010001000101000), CONST64(0x0010000000101010), CONST64(0x0010001000101010),

271 
CONST64
(0x0010100000101000), CONST64(0x0010101000101000), CONST64(0x0010100000101010), CONST64(0x0010101000101010),

272 
CONST64
(0x1000000000000000), CONST64(0x1000001000000000), CONST64(0x1000000000000010), CONST64(0x1000001000000010),

273 
CONST64
(0x1000100000000000), CONST64(0x1000101000000000), CONST64(0x1000100000000010), CONST64(0x1000101000000010),

274 
CONST64
(0x1000000000001000), CONST64(0x1000001000001000), CONST64(0x1000000000001010), CONST64(0x1000001000001010),

275 
CONST64
(0x1000100000001000), CONST64(0x1000101000001000), CONST64(0x1000100000001010), CONST64(0x1000101000001010),

276 
CONST64
(0x1010000000000000), CONST64(0x1010001000000000), CONST64(0x1010000000000010), CONST64(0x1010001000000010),

277 
CONST64
(0x1010100000000000), CONST64(0x1010101000000000), CONST64(0x1010100000000010), CONST64(0x1010101000000010),

278 
CONST64
(0x1010000000001000), CONST64(0x1010001000001000), CONST64(0x1010000000001010), CONST64(0x1010001000001010),

279 
CONST64
(0x1010100000001000), CONST64(0x1010101000001000), CONST64(0x1010100000001010), CONST64(0x1010101000001010),

280 
CONST64
(0x1000000000100000), CONST64(0x1000001000100000), CONST64(0x1000000000100010), CONST64(0x1000001000100010),

281 
CONST64
(0x1000100000100000), CONST64(0x1000101000100000), CONST64(0x1000100000100010), CONST64(0x1000101000100010),

282 
CONST64
(0x1000000000101000), CONST64(0x1000001000101000), CONST64(0x1000000000101010), CONST64(0x1000001000101010),

283 
CONST64
(0x1000100000101000), CONST64(0x1000101000101000), CONST64(0x1000100000101010), CONST64(0x1000101000101010),

284 
CONST64
(0x1010000000100000), CONST64(0x1010001000100000), CONST64(0x1010000000100010), CONST64(0x1010001000100010),

285 
CONST64
(0x1010100000100000), CONST64(0x1010101000100000), CONST64(0x1010100000100010), CONST64(0x1010101000100010),

286 
CONST64
(0x1010000000101000), CONST64(0x1010001000101000), CONST64(0x1010000000101010), CONST64(0x1010001000101010),

287 
CONST64
(0x1010100000101000), CONST64(0x1010101000101000), CONST64(0x1010100000101010), CONST64(0x1010101000101010),

288 
CONST64
(0x0000000010000000), CONST64(0x0000001010000000), CONST64(0x0000000010000010), CONST64(0x0000001010000010),

289 
CONST64
(0x0000100010000000), CONST64(0x0000101010000000), CONST64(0x0000100010000010), CONST64(0x0000101010000010),

290 
CONST64
(0x0000000010001000), CONST64(0x0000001010001000), CONST64(0x0000000010001010), CONST64(0x0000001010001010),

291 
CONST64
(0x0000100010001000), CONST64(0x0000101010001000), CONST64(0x0000100010001010), CONST64(0x0000101010001010),

292 
CONST64
(0x0010000010000000), CONST64(0x0010001010000000), CONST64(0x0010000010000010), CONST64(0x0010001010000010),

293 
CONST64
(0x0010100010000000), CONST64(0x0010101010000000), CONST64(0x0010100010000010), CONST64(0x0010101010000010),

294 
CONST64
(0x0010000010001000), CONST64(0x0010001010001000), CONST64(0x0010000010001010), CONST64(0x0010001010001010),

295 
CONST64
(0x0010100010001000), CONST64(0x0010101010001000), CONST64(0x0010100010001010), CONST64(0x0010101010001010),

296 
CONST64
(0x0000000010100000), CONST64(0x0000001010100000), CONST64(0x0000000010100010), CONST64(0x0000001010100010),

297 
CONST64
(0x0000100010100000), CONST64(0x0000101010100000), CONST64(0x0000100010100010), CONST64(0x0000101010100010),

298 
CONST64
(0x0000000010101000), CONST64(0x0000001010101000), CONST64(0x0000000010101010), CONST64(0x0000001010101010),

299 
CONST64
(0x0000100010101000), CONST64(0x0000101010101000), CONST64(0x0000100010101010), CONST64(0x0000101010101010),

300 
CONST64
(0x0010000010100000), CONST64(0x0010001010100000), CONST64(0x0010000010100010), CONST64(0x0010001010100010),

301 
CONST64
(0x0010100010100000), CONST64(0x0010101010100000), CONST64(0x0010100010100010), CONST64(0x0010101010100010),

302 
CONST64
(0x0010000010101000), CONST64(0x0010001010101000), CONST64(0x0010000010101010), CONST64(0x0010001010101010),

303 
CONST64
(0x0010100010101000), CONST64(0x0010101010101000), CONST64(0x0010100010101010), CONST64(0x0010101010101010),

304 
CONST64
(0x1000000010000000), CONST64(0x1000001010000000), CONST64(0x1000000010000010), CONST64(0x1000001010000010),

305 
CONST64
(0x1000100010000000), CONST64(0x1000101010000000), CONST64(0x1000100010000010), CONST64(0x1000101010000010),

306 
CONST64
(0x1000000010001000), CONST64(0x1000001010001000), CONST64(0x1000000010001010), CONST64(0x1000001010001010),

307 
CONST64
(0x1000100010001000), CONST64(0x1000101010001000), CONST64(0x1000100010001010), CONST64(0x1000101010001010),

308 
CONST64
(0x1010000010000000), CONST64(0x1010001010000000), CONST64(0x1010000010000010), CONST64(0x1010001010000010),

309 
CONST64
(0x1010100010000000), CONST64(0x1010101010000000), CONST64(0x1010100010000010), CONST64(0x1010101010000010),

310 
CONST64
(0x1010000010001000), CONST64(0x1010001010001000), CONST64(0x1010000010001010), CONST64(0x1010001010001010),

311 
CONST64
(0x1010100010001000), CONST64(0x1010101010001000), CONST64(0x1010100010001010), CONST64(0x1010101010001010),

312 
CONST64
(0x1000000010100000), CONST64(0x1000001010100000), CONST64(0x1000000010100010), CONST64(0x1000001010100010),

313 
CONST64
(0x1000100010100000), CONST64(0x1000101010100000), CONST64(0x1000100010100010), CONST64(0x1000101010100010),

314 
CONST64
(0x1000000010101000), CONST64(0x1000001010101000), CONST64(0x1000000010101010), CONST64(0x1000001010101010),

315 
CONST64
(0x1000100010101000), CONST64(0x1000101010101000), CONST64(0x1000100010101010), CONST64(0x1000101010101010),

316 
CONST64
(0x1010000010100000), CONST64(0x1010001010100000), CONST64(0x1010000010100010), CONST64(0x1010001010100010),

317 
CONST64
(0x1010100010100000), CONST64(0x1010101010100000), CONST64(0x1010100010100010), CONST64(0x1010101010100010),

318 
CONST64
(0x1010000010101000), CONST64(0x1010001010101000), CONST64(0x1010000010101010), CONST64(0x1010001010101010),

319 
CONST64
(0x1010100010101000), CONST64(0x1010101010101000), CONST64(0x1010100010101010), CONST64(0x1010101010101010)

321 { 
CONST64
(0x0000000000000000), CONST64(0x0000000800000000), CONST64(0x0000000000000008), CONST64(0x0000000800000008),

322 
CONST64
(0x0000080000000000), CONST64(0x0000080800000000), CONST64(0x0000080000000008), CONST64(0x0000080800000008),

323 
CONST64
(0x0000000000000800), CONST64(0x0000000800000800), CONST64(0x0000000000000808), CONST64(0x0000000800000808),

324 
CONST64
(0x0000080000000800), CONST64(0x0000080800000800), CONST64(0x0000080000000808), CONST64(0x0000080800000808),

325 
CONST64
(0x0008000000000000), CONST64(0x0008000800000000), CONST64(0x0008000000000008), CONST64(0x0008000800000008),

326 
CONST64
(0x0008080000000000), CONST64(0x0008080800000000), CONST64(0x0008080000000008), CONST64(0x0008080800000008),

327 
CONST64
(0x0008000000000800), CONST64(0x0008000800000800), CONST64(0x0008000000000808), CONST64(0x0008000800000808),

328 
CONST64
(0x0008080000000800), CONST64(0x0008080800000800), CONST64(0x0008080000000808), CONST64(0x0008080800000808),

329 
CONST64
(0x0000000000080000), CONST64(0x0000000800080000), CONST64(0x0000000000080008), CONST64(0x0000000800080008),

330 
CONST64
(0x0000080000080000), CONST64(0x0000080800080000), CONST64(0x0000080000080008), CONST64(0x0000080800080008),

331 
CONST64
(0x0000000000080800), CONST64(0x0000000800080800), CONST64(0x0000000000080808), CONST64(0x0000000800080808),

332 
CONST64
(0x0000080000080800), CONST64(0x0000080800080800), CONST64(0x0000080000080808), CONST64(0x0000080800080808),

333 
CONST64
(0x0008000000080000), CONST64(0x0008000800080000), CONST64(0x0008000000080008), CONST64(0x0008000800080008),

334 
CONST64
(0x0008080000080000), CONST64(0x0008080800080000), CONST64(0x0008080000080008), CONST64(0x0008080800080008),

335 
CONST64
(0x0008000000080800), CONST64(0x0008000800080800), CONST64(0x0008000000080808), CONST64(0x0008000800080808),

336 
CONST64
(0x0008080000080800), CONST64(0x0008080800080800), CONST64(0x0008080000080808), CONST64(0x0008080800080808),

337 
CONST64
(0x0800000000000000), CONST64(0x0800000800000000), CONST64(0x0800000000000008), CONST64(0x0800000800000008),

338 
CONST64
(0x0800080000000000), CONST64(0x0800080800000000), CONST64(0x0800080000000008), CONST64(0x0800080800000008),

339 
CONST64
(0x0800000000000800), CONST64(0x0800000800000800), CONST64(0x0800000000000808), CONST64(0x0800000800000808),

340 
CONST64
(0x0800080000000800), CONST64(0x0800080800000800), CONST64(0x0800080000000808), CONST64(0x0800080800000808),

341 
CONST64
(0x0808000000000000), CONST64(0x0808000800000000), CONST64(0x0808000000000008), CONST64(0x0808000800000008),

342 
CONST64
(0x0808080000000000), CONST64(0x0808080800000000), CONST64(0x0808080000000008), CONST64(0x0808080800000008),

343 
CONST64
(0x0808000000000800), CONST64(0x0808000800000800), CONST64(0x0808000000000808), CONST64(0x0808000800000808),

344 
CONST64
(0x0808080000000800), CONST64(0x0808080800000800), CONST64(0x0808080000000808), CONST64(0x0808080800000808),

345 
CONST64
(0x0800000000080000), CONST64(0x0800000800080000), CONST64(0x0800000000080008), CONST64(0x0800000800080008),

346 
CONST64
(0x0800080000080000), CONST64(0x0800080800080000), CONST64(0x0800080000080008), CONST64(0x0800080800080008),

347 
CONST64
(0x0800000000080800), CONST64(0x0800000800080800), CONST64(0x0800000000080808), CONST64(0x0800000800080808),

348 
CONST64
(0x0800080000080800), CONST64(0x0800080800080800), CONST64(0x0800080000080808), CONST64(0x0800080800080808),

349 
CONST64
(0x0808000000080000), CONST64(0x0808000800080000), CONST64(0x0808000000080008), CONST64(0x0808000800080008),

350 
CONST64
(0x0808080000080000), CONST64(0x0808080800080000), CONST64(0x0808080000080008), CONST64(0x0808080800080008),

351 
CONST64
(0x0808000000080800), CONST64(0x0808000800080800), CONST64(0x0808000000080808), CONST64(0x0808000800080808),

352 
CONST64
(0x0808080000080800), CONST64(0x0808080800080800), CONST64(0x0808080000080808), CONST64(0x0808080800080808),

353 
CONST64
(0x0000000008000000), CONST64(0x0000000808000000), CONST64(0x0000000008000008), CONST64(0x0000000808000008),

354 
CONST64
(0x0000080008000000), CONST64(0x0000080808000000), CONST64(0x0000080008000008), CONST64(0x0000080808000008),

355 
CONST64
(0x0000000008000800), CONST64(0x0000000808000800), CONST64(0x0000000008000808), CONST64(0x0000000808000808),

356 
CONST64
(0x0000080008000800), CONST64(0x0000080808000800), CONST64(0x0000080008000808), CONST64(0x0000080808000808),

357 
CONST64
(0x0008000008000000), CONST64(0x0008000808000000), CONST64(0x0008000008000008), CONST64(0x0008000808000008),

358 
CONST64
(0x0008080008000000), CONST64(0x0008080808000000), CONST64(0x0008080008000008), CONST64(0x0008080808000008),

359 
CONST64
(0x0008000008000800), CONST64(0x0008000808000800), CONST64(0x0008000008000808), CONST64(0x0008000808000808),

360 
CONST64
(0x0008080008000800), CONST64(0x0008080808000800), CONST64(0x0008080008000808), CONST64(0x0008080808000808),

361 
CONST64
(0x0000000008080000), CONST64(0x0000000808080000), CONST64(0x0000000008080008), CONST64(0x0000000808080008),

362 
CONST64
(0x0000080008080000), CONST64(0x0000080808080000), CONST64(0x0000080008080008), CONST64(0x0000080808080008),

363 
CONST64
(0x0000000008080800), CONST64(0x0000000808080800), CONST64(0x0000000008080808), CONST64(0x0000000808080808),

364 
CONST64
(0x0000080008080800), CONST64(0x0000080808080800), CONST64(0x0000080008080808), CONST64(0x0000080808080808),

365 
CONST64
(0x0008000008080000), CONST64(0x0008000808080000), CONST64(0x0008000008080008), CONST64(0x0008000808080008),

366 
CONST64
(0x0008080008080000), CONST64(0x0008080808080000), CONST64(0x0008080008080008), CONST64(0x0008080808080008),

367 
CONST64
(0x0008000008080800), CONST64(0x0008000808080800), CONST64(0x0008000008080808), CONST64(0x0008000808080808),

368 
CONST64
(0x0008080008080800), CONST64(0x0008080808080800), CONST64(0x0008080008080808), CONST64(0x0008080808080808),

369 
CONST64
(0x0800000008000000), CONST64(0x0800000808000000), CONST64(0x0800000008000008), CONST64(0x0800000808000008),

370 
CONST64
(0x0800080008000000), CONST64(0x0800080808000000), CONST64(0x0800080008000008), CONST64(0x0800080808000008),

371 
CONST64
(0x0800000008000800), CONST64(0x0800000808000800), CONST64(0x0800000008000808), CONST64(0x0800000808000808),

372 
CONST64
(0x0800080008000800), CONST64(0x0800080808000800), CONST64(0x0800080008000808), CONST64(0x0800080808000808),

373 
CONST64
(0x0808000008000000), CONST64(0x0808000808000000), CONST64(0x0808000008000008), CONST64(0x0808000808000008),

374 
CONST64
(0x0808080008000000), CONST64(0x0808080808000000), CONST64(0x0808080008000008), CONST64(0x0808080808000008),

375 
CONST64
(0x0808000008000800), CONST64(0x0808000808000800), CONST64(0x0808000008000808), CONST64(0x0808000808000808),

376 
CONST64
(0x0808080008000800), CONST64(0x0808080808000800), CONST64(0x0808080008000808), CONST64(0x0808080808000808),

377 
CONST64
(0x0800000008080000), CONST64(0x0800000808080000), CONST64(0x0800000008080008), CONST64(0x0800000808080008),

378 
CONST64
(0x0800080008080000), CONST64(0x0800080808080000), CONST64(0x0800080008080008), CONST64(0x0800080808080008),

379 
CONST64
(0x0800000008080800), CONST64(0x0800000808080800), CONST64(0x0800000008080808), CONST64(0x0800000808080808),

380 
CONST64
(0x0800080008080800), CONST64(0x0800080808080800), CONST64(0x0800080008080808), CONST64(0x0800080808080808),

381 
CONST64
(0x0808000008080000), CONST64(0x0808000808080000), CONST64(0x0808000008080008), CONST64(0x0808000808080008),

382 
CONST64
(0x0808080008080000), CONST64(0x0808080808080000), CONST64(0x0808080008080008), CONST64(0x0808080808080008),

383 
CONST64
(0x0808000008080800), CONST64(0x0808000808080800), CONST64(0x0808000008080808), CONST64(0x0808000808080808),

384 
CONST64
(0x0808080008080800), CONST64(0x0808080808080800), CONST64(0x0808080008080808), CONST64(0x0808080808080808)

386 { 
CONST64
(0x0000000000000000), CONST64(0x0000000400000000), CONST64(0x0000000000000004), CONST64(0x0000000400000004),

387 
CONST64
(0x0000040000000000), CONST64(0x0000040400000000), CONST64(0x0000040000000004), CONST64(0x0000040400000004),

388 
CONST64
(0x0000000000000400), CONST64(0x0000000400000400), CONST64(0x0000000000000404), CONST64(0x0000000400000404),

389 
CONST64
(0x0000040000000400), CONST64(0x0000040400000400), CONST64(0x0000040000000404), CONST64(0x0000040400000404),

390 
CONST64
(0x0004000000000000), CONST64(0x0004000400000000), CONST64(0x0004000000000004), CONST64(0x0004000400000004),

391 
CONST64
(0x0004040000000000), CONST64(0x0004040400000000), CONST64(0x0004040000000004), CONST64(0x0004040400000004),

392 
CONST64
(0x0004000000000400), CONST64(0x0004000400000400), CONST64(0x0004000000000404), CONST64(0x0004000400000404),

393 
CONST64
(0x0004040000000400), CONST64(0x0004040400000400), CONST64(0x0004040000000404), CONST64(0x0004040400000404),

394 
CONST64
(0x0000000000040000), CONST64(0x0000000400040000), CONST64(0x0000000000040004), CONST64(0x0000000400040004),

395 
CONST64
(0x0000040000040000), CONST64(0x0000040400040000), CONST64(0x0000040000040004), CONST64(0x0000040400040004),

396 
CONST64
(0x0000000000040400), CONST64(0x0000000400040400), CONST64(0x0000000000040404), CONST64(0x0000000400040404),

397 
CONST64
(0x0000040000040400), CONST64(0x0000040400040400), CONST64(0x0000040000040404), CONST64(0x0000040400040404),

398 
CONST64
(0x0004000000040000), CONST64(0x0004000400040000), CONST64(0x0004000000040004), CONST64(0x0004000400040004),

399 
CONST64
(0x0004040000040000), CONST64(0x0004040400040000), CONST64(0x0004040000040004), CONST64(0x0004040400040004),

400 
CONST64
(0x0004000000040400), CONST64(0x0004000400040400), CONST64(0x0004000000040404), CONST64(0x0004000400040404),

401 
CONST64
(0x0004040000040400), CONST64(0x0004040400040400), CONST64(0x0004040000040404), CONST64(0x0004040400040404),

402 
CONST64
(0x0400000000000000), CONST64(0x0400000400000000), CONST64(0x0400000000000004), CONST64(0x0400000400000004),

403 
CONST64
(0x0400040000000000), CONST64(0x0400040400000000), CONST64(0x0400040000000004), CONST64(0x0400040400000004),

404 
CONST64
(0x0400000000000400), CONST64(0x0400000400000400), CONST64(0x0400000000000404), CONST64(0x0400000400000404),

405 
CONST64
(0x0400040000000400), CONST64(0x0400040400000400), CONST64(0x0400040000000404), CONST64(0x0400040400000404),

406 
CONST64
(0x0404000000000000), CONST64(0x0404000400000000), CONST64(0x0404000000000004), CONST64(0x0404000400000004),

407 
CONST64
(0x0404040000000000), CONST64(0x0404040400000000), CONST64(0x0404040000000004), CONST64(0x0404040400000004),

408 
CONST64
(0x0404000000000400), CONST64(0x0404000400000400), CONST64(0x0404000000000404), CONST64(0x0404000400000404),

409 
CONST64
(0x0404040000000400), CONST64(0x0404040400000400), CONST64(0x0404040000000404), CONST64(0x0404040400000404),

410 
CONST64
(0x0400000000040000), CONST64(0x0400000400040000), CONST64(0x0400000000040004), CONST64(0x0400000400040004),

411 
CONST64
(0x0400040000040000), CONST64(0x0400040400040000), CONST64(0x0400040000040004), CONST64(0x0400040400040004),

412 
CONST64
(0x0400000000040400), CONST64(0x0400000400040400), CONST64(0x0400000000040404), CONST64(0x0400000400040404),

413 
CONST64
(0x0400040000040400), CONST64(0x0400040400040400), CONST64(0x0400040000040404), CONST64(0x0400040400040404),

414 
CONST64
(0x0404000000040000), CONST64(0x0404000400040000), CONST64(0x0404000000040004), CONST64(0x0404000400040004),

415 
CONST64
(0x0404040000040000), CONST64(0x0404040400040000), CONST64(0x0404040000040004), CONST64(0x0404040400040004),

416 
CONST64
(0x0404000000040400), CONST64(0x0404000400040400), CONST64(0x0404000000040404), CONST64(0x0404000400040404),

417 
CONST64
(0x0404040000040400), CONST64(0x0404040400040400), CONST64(0x0404040000040404), CONST64(0x0404040400040404),

418 
CONST64
(0x0000000004000000), CONST64(0x0000000404000000), CONST64(0x0000000004000004), CONST64(0x0000000404000004),

419 
CONST64
(0x0000040004000000), CONST64(0x0000040404000000), CONST64(0x0000040004000004), CONST64(0x0000040404000004),

420 
CONST64
(0x0000000004000400), CONST64(0x0000000404000400), CONST64(0x0000000004000404), CONST64(0x0000000404000404),

421 
CONST64
(0x0000040004000400), CONST64(0x0000040404000400), CONST64(0x0000040004000404), CONST64(0x0000040404000404),

422 
CONST64
(0x0004000004000000), CONST64(0x0004000404000000), CONST64(0x0004000004000004), CONST64(0x0004000404000004),

423 
CONST64
(0x0004040004000000), CONST64(0x0004040404000000), CONST64(0x0004040004000004), CONST64(0x0004040404000004),

424 
CONST64
(0x0004000004000400), CONST64(0x0004000404000400), CONST64(0x0004000004000404), CONST64(0x0004000404000404),

425 
CONST64
(0x0004040004000400), CONST64(0x0004040404000400), CONST64(0x0004040004000404), CONST64(0x0004040404000404),

426 
CONST64
(0x0000000004040000), CONST64(0x0000000404040000), CONST64(0x0000000004040004), CONST64(0x0000000404040004),

427 
CONST64
(0x0000040004040000), CONST64(0x0000040404040000), CONST64(0x0000040004040004), CONST64(0x0000040404040004),

428 
CONST64
(0x0000000004040400), CONST64(0x0000000404040400), CONST64(0x0000000004040404), CONST64(0x0000000404040404),

429 
CONST64
(0x0000040004040400), CONST64(0x0000040404040400), CONST64(0x0000040004040404), CONST64(0x0000040404040404),

430 
CONST64
(0x0004000004040000), CONST64(0x0004000404040000), CONST64(0x0004000004040004), CONST64(0x0004000404040004),

431 
CONST64
(0x0004040004040000), CONST64(0x0004040404040000), CONST64(0x0004040004040004), CONST64(0x0004040404040004),

432 
CONST64
(0x0004000004040400), CONST64(0x0004000404040400), CONST64(0x0004000004040404), CONST64(0x0004000404040404),

433 
CONST64
(0x0004040004040400), CONST64(0x0004040404040400), CONST64(0x0004040004040404), CONST64(0x0004040404040404),

434 
CONST64
(0x0400000004000000), CONST64(0x0400000404000000), CONST64(0x0400000004000004), CONST64(0x0400000404000004),

435 
CONST64
(0x0400040004000000), CONST64(0x0400040404000000), CONST64(0x0400040004000004), CONST64(0x0400040404000004),

436 
CONST64
(0x0400000004000400), CONST64(0x0400000404000400), CONST64(0x0400000004000404), CONST64(0x0400000404000404),

437 
CONST64
(0x0400040004000400), CONST64(0x0400040404000400), CONST64(0x0400040004000404), CONST64(0x0400040404000404),

438 
CONST64
(0x0404000004000000), CONST64(0x0404000404000000), CONST64(0x0404000004000004), CONST64(0x0404000404000004),

439 
CONST64
(0x0404040004000000), CONST64(0x0404040404000000), CONST64(0x0404040004000004), CONST64(0x0404040404000004),

440 
CONST64
(0x0404000004000400), CONST64(0x0404000404000400), CONST64(0x0404000004000404), CONST64(0x0404000404000404),

441 
CONST64
(0x0404040004000400), CONST64(0x0404040404000400), CONST64(0x0404040004000404), CONST64(0x0404040404000404),

442 
CONST64
(0x0400000004040000), CONST64(0x0400000404040000), CONST64(0x0400000004040004), CONST64(0x0400000404040004),

443 
CONST64
(0x0400040004040000), CONST64(0x0400040404040000), CONST64(0x0400040004040004), CONST64(0x0400040404040004),

444 
CONST64
(0x0400000004040400), CONST64(0x0400000404040400), CONST64(0x0400000004040404), CONST64(0x0400000404040404),

445 
CONST64
(0x0400040004040400), CONST64(0x0400040404040400), CONST64(0x0400040004040404), CONST64(0x0400040404040404),

446 
CONST64
(0x0404000004040000), CONST64(0x0404000404040000), CONST64(0x0404000004040004), CONST64(0x0404000404040004),

447 
CONST64
(0x0404040004040000), CONST64(0x0404040404040000), CONST64(0x0404040004040004), CONST64(0x0404040404040004),

448 
CONST64
(0x0404000004040400), CONST64(0x0404000404040400), CONST64(0x0404000004040404), CONST64(0x0404000404040404),

449 
CONST64
(0x0404040004040400), CONST64(0x0404040404040400), CONST64(0x0404040004040404), CONST64(0x0404040404040404)

451 { 
CONST64
(0x0000000000000000), CONST64(0x0000000200000000), CONST64(0x0000000000000002), CONST64(0x0000000200000002),

452 
CONST64
(0x0000020000000000), CONST64(0x0000020200000000), CONST64(0x0000020000000002), CONST64(0x0000020200000002),

453 
CONST64
(0x0000000000000200), CONST64(0x0000000200000200), CONST64(0x0000000000000202), CONST64(0x0000000200000202),

454 
CONST64
(0x0000020000000200), CONST64(0x0000020200000200), CONST64(0x0000020000000202), CONST64(0x0000020200000202),

455 
CONST64
(0x0002000000000000), CONST64(0x0002000200000000), CONST64(0x0002000000000002), CONST64(0x0002000200000002),

456 
CONST64
(0x0002020000000000), CONST64(0x0002020200000000), CONST64(0x0002020000000002), CONST64(0x0002020200000002),

457 
CONST64
(0x0002000000000200), CONST64(0x0002000200000200), CONST64(0x0002000000000202), CONST64(0x0002000200000202),

458 
CONST64
(0x0002020000000200), CONST64(0x0002020200000200), CONST64(0x0002020000000202), CONST64(0x0002020200000202),

459 
CONST64
(0x0000000000020000), CONST64(0x0000000200020000), CONST64(0x0000000000020002), CONST64(0x0000000200020002),

460 
CONST64
(0x0000020000020000), CONST64(0x0000020200020000), CONST64(0x0000020000020002), CONST64(0x0000020200020002),

461 
CONST64
(0x0000000000020200), CONST64(0x0000000200020200), CONST64(0x0000000000020202), CONST64(0x0000000200020202),

462 
CONST64
(0x0000020000020200), CONST64(0x0000020200020200), CONST64(0x0000020000020202), CONST64(0x0000020200020202),

463 
CONST64
(0x0002000000020000), CONST64(0x0002000200020000), CONST64(0x0002000000020002), CONST64(0x0002000200020002),

464 
CONST64
(0x0002020000020000), CONST64(0x0002020200020000), CONST64(0x0002020000020002), CONST64(0x0002020200020002),

465 
CONST64
(0x0002000000020200), CONST64(0x0002000200020200), CONST64(0x0002000000020202), CONST64(0x0002000200020202),

466 
CONST64
(0x0002020000020200), CONST64(0x0002020200020200), CONST64(0x0002020000020202), CONST64(0x0002020200020202),

467 
CONST64
(0x0200000000000000), CONST64(0x0200000200000000), CONST64(0x0200000000000002), CONST64(0x0200000200000002),

468 
CONST64
(0x0200020000000000), CONST64(0x0200020200000000), CONST64(0x0200020000000002), CONST64(0x0200020200000002),

469 
CONST64
(0x0200000000000200), CONST64(0x0200000200000200), CONST64(0x0200000000000202), CONST64(0x0200000200000202),

470 
CONST64
(0x0200020000000200), CONST64(0x0200020200000200), CONST64(0x0200020000000202), CONST64(0x0200020200000202),

471 
CONST64
(0x0202000000000000), CONST64(0x0202000200000000), CONST64(0x0202000000000002), CONST64(0x0202000200000002),

472 
CONST64
(0x0202020000000000), CONST64(0x0202020200000000), CONST64(0x0202020000000002), CONST64(0x0202020200000002),

473 
CONST64
(0x0202000000000200), CONST64(0x0202000200000200), CONST64(0x0202000000000202), CONST64(0x0202000200000202),

474 
CONST64
(0x0202020000000200), CONST64(0x0202020200000200), CONST64(0x0202020000000202), CONST64(0x0202020200000202),

475 
CONST64
(0x0200000000020000), CONST64(0x0200000200020000), CONST64(0x0200000000020002), CONST64(0x0200000200020002),

476 
CONST64
(0x0200020000020000), CONST64(0x0200020200020000), CONST64(0x0200020000020002), CONST64(0x0200020200020002),

477 
CONST64
(0x0200000000020200), CONST64(0x0200000200020200), CONST64(0x0200000000020202), CONST64(0x0200000200020202),

478 
CONST64
(0x0200020000020200), CONST64(0x0200020200020200), CONST64(0x0200020000020202), CONST64(0x0200020200020202),

479 
CONST64
(0x0202000000020000), CONST64(0x0202000200020000), CONST64(0x0202000000020002), CONST64(0x0202000200020002),

480 
CONST64
(0x0202020000020000), CONST64(0x0202020200020000), CONST64(0x0202020000020002), CONST64(0x0202020200020002),

481 
CONST64
(0x0202000000020200), CONST64(0x0202000200020200), CONST64(0x0202000000020202), CONST64(0x0202000200020202),

482 
CONST64
(0x0202020000020200), CONST64(0x0202020200020200), CONST64(0x0202020000020202), CONST64(0x0202020200020202),

483 
CONST64
(0x0000000002000000), CONST64(0x0000000202000000), CONST64(0x0000000002000002), CONST64(0x0000000202000002),

484 
CONST64
(0x0000020002000000), CONST64(0x0000020202000000), CONST64(0x0000020002000002), CONST64(0x0000020202000002),

485 
CONST64
(0x0000000002000200), CONST64(0x0000000202000200), CONST64(0x0000000002000202), CONST64(0x0000000202000202),

486 
CONST64
(0x0000020002000200), CONST64(0x0000020202000200), CONST64(0x0000020002000202), CONST64(0x0000020202000202),

487 
CONST64
(0x0002000002000000), CONST64(0x0002000202000000), CONST64(0x0002000002000002), CONST64(0x0002000202000002),

488 
CONST64
(0x0002020002000000), CONST64(0x0002020202000000), CONST64(0x0002020002000002), CONST64(0x0002020202000002),

489 
CONST64
(0x0002000002000200), CONST64(0x0002000202000200), CONST64(0x0002000002000202), CONST64(0x0002000202000202),

490 
CONST64
(0x0002020002000200), CONST64(0x0002020202000200), CONST64(0x0002020002000202), CONST64(0x0002020202000202),

491 
CONST64
(0x0000000002020000), CONST64(0x0000000202020000), CONST64(0x0000000002020002), CONST64(0x0000000202020002),

492 
CONST64
(0x0000020002020000), CONST64(0x0000020202020000), CONST64(0x0000020002020002), CONST64(0x0000020202020002),

493 
CONST64
(0x0000000002020200), CONST64(0x0000000202020200), CONST64(0x0000000002020202), CONST64(0x0000000202020202),

494 
CONST64
(0x0000020002020200), CONST64(0x0000020202020200), CONST64(0x0000020002020202), CONST64(0x0000020202020202),

495 
CONST64
(0x0002000002020000), CONST64(0x0002000202020000), CONST64(0x0002000002020002), CONST64(0x0002000202020002),

496 
CONST64
(0x0002020002020000), CONST64(0x0002020202020000), CONST64(0x0002020002020002), CONST64(0x0002020202020002),

497 
CONST64
(0x0002000002020200), CONST64(0x0002000202020200), CONST64(0x0002000002020202), CONST64(0x0002000202020202),

498 
CONST64
(0x0002020002020200), CONST64(0x0002020202020200), CONST64(0x0002020002020202), CONST64(0x0002020202020202),

499 
CONST64
(0x0200000002000000), CONST64(0x0200000202000000), CONST64(0x0200000002000002), CONST64(0x0200000202000002),

500 
CONST64
(0x0200020002000000), CONST64(0x0200020202000000), CONST64(0x0200020002000002), CONST64(0x0200020202000002),

501 
CONST64
(0x0200000002000200), CONST64(0x0200000202000200), CONST64(0x0200000002000202), CONST64(0x0200000202000202),

502 
CONST64
(0x0200020002000200), CONST64(0x0200020202000200), CONST64(0x0200020002000202), CONST64(0x0200020202000202),

503 
CONST64
(0x0202000002000000), CONST64(0x0202000202000000), CONST64(0x0202000002000002), CONST64(0x0202000202000002),

504 
CONST64
(0x0202020002000000), CONST64(0x0202020202000000), CONST64(0x0202020002000002), CONST64(0x0202020202000002),

505 
CONST64
(0x0202000002000200), CONST64(0x0202000202000200), CONST64(0x0202000002000202), CONST64(0x0202000202000202),

506 
CONST64
(0x0202020002000200), CONST64(0x0202020202000200), CONST64(0x0202020002000202), CONST64(0x0202020202000202),

507 
CONST64
(0x0200000002020000), CONST64(0x0200000202020000), CONST64(0x0200000002020002), CONST64(0x0200000202020002),

508 
CONST64
(0x0200020002020000), CONST64(0x0200020202020000), CONST64(0x0200020002020002), CONST64(0x0200020202020002),

509 
CONST64
(0x0200000002020200), CONST64(0x0200000202020200), CONST64(0x0200000002020202), CONST64(0x0200000202020202),

510 
CONST64
(0x0200020002020200), CONST64(0x0200020202020200), CONST64(0x0200020002020202), CONST64(0x0200020202020202),

511 
CONST64
(0x0202000002020000), CONST64(0x0202000202020000), CONST64(0x0202000002020002), CONST64(0x0202000202020002),

512 
CONST64
(0x0202020002020000), CONST64(0x0202020202020000), CONST64(0x0202020002020002), CONST64(0x0202020202020002),

513 
CONST64
(0x0202000002020200), CONST64(0x0202000202020200), CONST64(0x0202000002020202), CONST64(0x0202000202020202),

514 
CONST64
(0x0202020002020200), CONST64(0x0202020202020200), CONST64(0x0202020002020202), CONST64(0x0202020202020202)

516 { 
CONST64
(0x0000000000000000), CONST64(0x0000010000000000), CONST64(0x0000000000000100), CONST64(0x0000010000000100),

517 
CONST64
(0x0001000000000000), CONST64(0x0001010000000000), CONST64(0x0001000000000100), CONST64(0x0001010000000100),

518 
CONST64
(0x0000000000010000), CONST64(0x0000010000010000), CONST64(0x0000000000010100), CONST64(0x0000010000010100),

519 
CONST64
(0x0001000000010000), CONST64(0x0001010000010000), CONST64(0x0001000000010100), CONST64(0x0001010000010100),

520 
CONST64
(0x0100000000000000), CONST64(0x0100010000000000), CONST64(0x0100000000000100), CONST64(0x0100010000000100),

521 
CONST64
(0x0101000000000000), CONST64(0x0101010000000000), CONST64(0x0101000000000100), CONST64(0x0101010000000100),

522 
CONST64
(0x0100000000010000), CONST64(0x0100010000010000), CONST64(0x0100000000010100), CONST64(0x0100010000010100),

523 
CONST64
(0x0101000000010000), CONST64(0x0101010000010000), CONST64(0x0101000000010100), CONST64(0x0101010000010100),

524 
CONST64
(0x0000000001000000), CONST64(0x0000010001000000), CONST64(0x0000000001000100), CONST64(0x0000010001000100),

525 
CONST64
(0x0001000001000000), CONST64(0x0001010001000000), CONST64(0x0001000001000100), CONST64(0x0001010001000100),

526 
CONST64
(0x0000000001010000), CONST64(0x0000010001010000), CONST64(0x0000000001010100), CONST64(0x0000010001010100),

527 
CONST64
(0x0001000001010000), CONST64(0x0001010001010000), CONST64(0x0001000001010100), CONST64(0x0001010001010100),

528 
CONST64
(0x0100000001000000), CONST64(0x0100010001000000), CONST64(0x0100000001000100), CONST64(0x0100010001000100),

529 
CONST64
(0x0101000001000000), CONST64(0x0101010001000000), CONST64(0x0101000001000100), CONST64(0x0101010001000100),

530 
CONST64
(0x0100000001010000), CONST64(0x0100010001010000), CONST64(0x0100000001010100), CONST64(0x0100010001010100),

531 
CONST64
(0x0101000001010000), CONST64(0x0101010001010000), CONST64(0x0101000001010100), CONST64(0x0101010001010100),

532 
CONST64
(0x0000000100000000), CONST64(0x0000010100000000), CONST64(0x0000000100000100), CONST64(0x0000010100000100),

533 
CONST64
(0x0001000100000000), CONST64(0x0001010100000000), CONST64(0x0001000100000100), CONST64(0x0001010100000100),

534 
CONST64
(0x0000000100010000), CONST64(0x0000010100010000), CONST64(0x0000000100010100), CONST64(0x0000010100010100),

535 
CONST64
(0x0001000100010000), CONST64(0x0001010100010000), CONST64(0x0001000100010100), CONST64(0x0001010100010100),

536 
CONST64
(0x0100000100000000), CONST64(0x0100010100000000), CONST64(0x0100000100000100), CONST64(0x0100010100000100),

537 
CONST64
(0x0101000100000000), CONST64(0x0101010100000000), CONST64(0x0101000100000100), CONST64(0x0101010100000100),

538 
CONST64
(0x0100000100010000), CONST64(0x0100010100010000), CONST64(0x0100000100010100), CONST64(0x0100010100010100),

539 
CONST64
(0x0101000100010000), CONST64(0x0101010100010000), CONST64(0x0101000100010100), CONST64(0x0101010100010100),

540 
CONST64
(0x0000000101000000), CONST64(0x0000010101000000), CONST64(0x0000000101000100), CONST64(0x0000010101000100),

541 
CONST64
(0x0001000101000000), CONST64(0x0001010101000000), CONST64(0x0001000101000100), CONST64(0x0001010101000100),

542 
CONST64
(0x0000000101010000), CONST64(0x0000010101010000), CONST64(0x0000000101010100), CONST64(0x0000010101010100),

543 
CONST64
(0x0001000101010000), CONST64(0x0001010101010000), CONST64(0x0001000101010100), CONST64(0x0001010101010100),

544 
CONST64
(0x0100000101000000), CONST64(0x0100010101000000), CONST64(0x0100000101000100), CONST64(0x0100010101000100),

545 
CONST64
(0x0101000101000000), CONST64(0x0101010101000000), CONST64(0x0101000101000100), CONST64(0x0101010101000100),

546 
CONST64
(0x0100000101010000), CONST64(0x0100010101010000), CONST64(0x0100000101010100), CONST64(0x0100010101010100),

547 
CONST64
(0x0101000101010000), CONST64(0x0101010101010000), CONST64(0x0101000101010100), CONST64(0x0101010101010100),

548 
CONST64
(0x0000000000000001), CONST64(0x0000010000000001), CONST64(0x0000000000000101), CONST64(0x0000010000000101),

549 
CONST64
(0x0001000000000001), CONST64(0x0001010000000001), CONST64(0x0001000000000101), CONST64(0x0001010000000101),

550 
CONST64
(0x0000000000010001), CONST64(0x0000010000010001), CONST64(0x0000000000010101), CONST64(0x0000010000010101),

551 
CONST64
(0x0001000000010001), CONST64(0x0001010000010001), CONST64(0x0001000000010101), CONST64(0x0001010000010101),

552 
CONST64
(0x0100000000000001), CONST64(0x0100010000000001), CONST64(0x0100000000000101), CONST64(0x0100010000000101),

553 
CONST64
(0x0101000000000001), CONST64(0x0101010000000001), CONST64(0x0101000000000101), CONST64(0x0101010000000101),

554 
CONST64
(0x0100000000010001), CONST64(0x0100010000010001), CONST64(0x0100000000010101), CONST64(0x0100010000010101),

555 
CONST64
(0x0101000000010001), CONST64(0x0101010000010001), CONST64(0x0101000000010101), CONST64(0x0101010000010101),

556 
CONST64
(0x0000000001000001), CONST64(0x0000010001000001), CONST64(0x0000000001000101), CONST64(0x0000010001000101),

557 
CONST64
(0x0001000001000001), CONST64(0x0001010001000001), CONST64(0x0001000001000101), CONST64(0x0001010001000101),

558 
CONST64
(0x0000000001010001), CONST64(0x0000010001010001), CONST64(0x0000000001010101), CONST64(0x0000010001010101),

559 
CONST64
(0x0001000001010001), CONST64(0x0001010001010001), CONST64(0x0001000001010101), CONST64(0x0001010001010101),

560 
CONST64
(0x0100000001000001), CONST64(0x0100010001000001), CONST64(0x0100000001000101), CONST64(0x0100010001000101),

561 
CONST64
(0x0101000001000001), CONST64(0x0101010001000001), CONST64(0x0101000001000101), CONST64(0x0101010001000101),

562 
CONST64
(0x0100000001010001), CONST64(0x0100010001010001), CONST64(0x0100000001010101), CONST64(0x0100010001010101),

563 
CONST64
(0x0101000001010001), CONST64(0x0101010001010001), CONST64(0x0101000001010101), CONST64(0x0101010001010101),

564 
CONST64
(0x0000000100000001), CONST64(0x0000010100000001), CONST64(0x0000000100000101), CONST64(0x0000010100000101),

565 
CONST64
(0x0001000100000001), CONST64(0x0001010100000001), CONST64(0x0001000100000101), CONST64(0x0001010100000101),

566 
CONST64
(0x0000000100010001), CONST64(0x0000010100010001), CONST64(0x0000000100010101), CONST64(0x0000010100010101),

567 
CONST64
(0x0001000100010001), CONST64(0x0001010100010001), CONST64(0x0001000100010101), CONST64(0x0001010100010101),

568 
CONST64
(0x0100000100000001), CONST64(0x0100010100000001), CONST64(0x0100000100000101), CONST64(0x0100010100000101),

569 
CONST64
(0x0101000100000001), CONST64(0x0101010100000001), CONST64(0x0101000100000101), CONST64(0x0101010100000101),

570 
CONST64
(0x0100000100010001), CONST64(0x0100010100010001), CONST64(0x0100000100010101), CONST64(0x0100010100010101),

571 
CONST64
(0x0101000100010001), CONST64(0x0101010100010001), CONST64(0x0101000100010101), CONST64(0x0101010100010101),

572 
CONST64
(0x0000000101000001), CONST64(0x0000010101000001), CONST64(0x0000000101000101), CONST64(0x0000010101000101),

573 
CONST64
(0x0001000101000001), CONST64(0x0001010101000001), CONST64(0x0001000101000101), CONST64(0x0001010101000101),

574 
CONST64
(0x0000000101010001), CONST64(0x0000010101010001), CONST64(0x0000000101010101), CONST64(0x0000010101010101),

575 
CONST64
(0x0001000101010001), CONST64(0x0001010101010001), CONST64(0x0001000101010101), CONST64(0x0001010101010101),

576 
CONST64
(0x0100000101000001), CONST64(0x0100010101000001), CONST64(0x0100000101000101), CONST64(0x0100010101000101),

577 
CONST64
(0x0101000101000001), CONST64(0x0101010101000001), CONST64(0x0101000101000101), CONST64(0x0101010101000101),

578 
CONST64
(0x0100000101010001), CONST64(0x0100010101010001), CONST64(0x0100000101010101), CONST64(0x0100010101010101),

579 
CONST64
(0x0101000101010001), CONST64(0x0101010101010001), CONST64(0x0101000101010101), CONST64(0x0101010101010101)

581 { 
CONST64
(0x0000000000000000), CONST64(0x0000008000000000), CONST64(0x0000000000000080), CONST64(0x0000008000000080),

582 
CONST64
(0x0000800000000000), CONST64(0x0000808000000000), CONST64(0x0000800000000080), CONST64(0x0000808000000080),

583 
CONST64
(0x0000000000008000), CONST64(0x0000008000008000), CONST64(0x0000000000008080), CONST64(0x0000008000008080),

584 
CONST64
(0x0000800000008000), CONST64(0x0000808000008000), CONST64(0x0000800000008080), CONST64(0x0000808000008080),

585 
CONST64
(0x0080000000000000), CONST64(0x0080008000000000), CONST64(0x0080000000000080), CONST64(0x0080008000000080),

586 
CONST64
(0x0080800000000000), CONST64(0x0080808000000000), CONST64(0x0080800000000080), CONST64(0x0080808000000080),

587 
CONST64
(0x0080000000008000), CONST64(0x0080008000008000), CONST64(0x0080000000008080), CONST64(0x0080008000008080),

588 
CONST64
(0x0080800000008000), CONST64(0x0080808000008000), CONST64(0x0080800000008080), CONST64(0x0080808000008080),

589 
CONST64
(0x0000000000800000), CONST64(0x0000008000800000), CONST64(0x0000000000800080), CONST64(0x0000008000800080),

590 
CONST64
(0x0000800000800000), CONST64(0x0000808000800000), CONST64(0x0000800000800080), CONST64(0x0000808000800080),

591 
CONST64
(0x0000000000808000), CONST64(0x0000008000808000), CONST64(0x0000000000808080), CONST64(0x0000008000808080),

592 
CONST64
(0x0000800000808000), CONST64(0x0000808000808000), CONST64(0x0000800000808080), CONST64(0x0000808000808080),

593 
CONST64
(0x0080000000800000), CONST64(0x0080008000800000), CONST64(0x0080000000800080), CONST64(0x0080008000800080),

594 
CONST64
(0x0080800000800000), CONST64(0x0080808000800000), CONST64(0x0080800000800080), CONST64(0x0080808000800080),

595 
CONST64
(0x0080000000808000), CONST64(0x0080008000808000), CONST64(0x0080000000808080), CONST64(0x0080008000808080),

596 
CONST64
(0x0080800000808000), CONST64(0x0080808000808000), CONST64(0x0080800000808080), CONST64(0x0080808000808080),

597 
CONST64
(0x8000000000000000), CONST64(0x8000008000000000), CONST64(0x8000000000000080), CONST64(0x8000008000000080),

598 
CONST64
(0x8000800000000000), CONST64(0x8000808000000000), CONST64(0x8000800000000080), CONST64(0x8000808000000080),

599 
CONST64
(0x8000000000008000), CONST64(0x8000008000008000), CONST64(0x8000000000008080), CONST64(0x8000008000008080),

600 
CONST64
(0x8000800000008000), CONST64(0x8000808000008000), CONST64(0x8000800000008080), CONST64(0x8000808000008080),

601 
CONST64
(0x8080000000000000), CONST64(0x8080008000000000), CONST64(0x8080000000000080), CONST64(0x8080008000000080),

602 
CONST64
(0x8080800000000000), CONST64(0x8080808000000000), CONST64(0x8080800000000080), CONST64(0x8080808000000080),

603 
CONST64
(0x8080000000008000), CONST64(0x8080008000008000), CONST64(0x8080000000008080), CONST64(0x8080008000008080),

604 
CONST64
(0x8080800000008000), CONST64(0x8080808000008000), CONST64(0x8080800000008080), CONST64(0x8080808000008080),

605 
CONST64
(0x8000000000800000), CONST64(0x8000008000800000), CONST64(0x8000000000800080), CONST64(0x8000008000800080),

606 
CONST64
(0x8000800000800000), CONST64(0x8000808000800000), CONST64(0x8000800000800080), CONST64(0x8000808000800080),

607 
CONST64
(0x8000000000808000), CONST64(0x8000008000808000), CONST64(0x8000000000808080), CONST64(0x8000008000808080),

608 
CONST64
(0x8000800000808000), CONST64(0x8000808000808000), CONST64(0x8000800000808080), CONST64(0x8000808000808080),

609 
CONST64
(0x8080000000800000), CONST64(0x8080008000800000), CONST64(0x8080000000800080), CONST64(0x8080008000800080),

610 
CONST64
(0x8080800000800000), CONST64(0x8080808000800000), CONST64(0x8080800000800080), CONST64(0x8080808000800080),

611 
CONST64
(0x8080000000808000), CONST64(0x8080008000808000), CONST64(0x8080000000808080), CONST64(0x8080008000808080),

612 
CONST64
(0x8080800000808000), CONST64(0x8080808000808000), CONST64(0x8080800000808080), CONST64(0x8080808000808080),

613 
CONST64
(0x0000000080000000), CONST64(0x0000008080000000), CONST64(0x0000000080000080), CONST64(0x0000008080000080),

614 
CONST64
(0x0000800080000000), CONST64(0x0000808080000000), CONST64(0x0000800080000080), CONST64(0x0000808080000080),

615 
CONST64
(0x0000000080008000), CONST64(0x0000008080008000), CONST64(0x0000000080008080), CONST64(0x0000008080008080),

616 
CONST64
(0x0000800080008000), CONST64(0x0000808080008000), CONST64(0x0000800080008080), CONST64(0x0000808080008080),

617 
CONST64
(0x0080000080000000), CONST64(0x0080008080000000), CONST64(0x0080000080000080), CONST64(0x0080008080000080),

618 
CONST64
(0x0080800080000000), CONST64(0x0080808080000000), CONST64(0x0080800080000080), CONST64(0x0080808080000080),

619 
CONST64
(0x0080000080008000), CONST64(0x0080008080008000), CONST64(0x0080000080008080), CONST64(0x0080008080008080),

620 
CONST64
(0x0080800080008000), CONST64(0x0080808080008000), CONST64(0x0080800080008080), CONST64(0x0080808080008080),

621 
CONST64
(0x0000000080800000), CONST64(0x0000008080800000), CONST64(0x0000000080800080), CONST64(0x0000008080800080),

622 
CONST64
(0x0000800080800000), CONST64(0x0000808080800000), CONST64(0x0000800080800080), CONST64(0x0000808080800080),

623 
CONST64
(0x0000000080808000), CONST64(0x0000008080808000), CONST64(0x0000000080808080), CONST64(0x0000008080808080),

624 
CONST64
(0x0000800080808000), CONST64(0x0000808080808000), CONST64(0x0000800080808080), CONST64(0x0000808080808080),

625 
CONST64
(0x0080000080800000), CONST64(0x0080008080800000), CONST64(0x0080000080800080), CONST64(0x0080008080800080),

626 
CONST64
(0x0080800080800000), CONST64(0x0080808080800000), CONST64(0x0080800080800080), CONST64(0x0080808080800080),

627 
CONST64
(0x0080000080808000), CONST64(0x0080008080808000), CONST64(0x0080000080808080), CONST64(0x0080008080808080),

628 
CONST64
(0x0080800080808000), CONST64(0x0080808080808000), CONST64(0x0080800080808080), CONST64(0x0080808080808080),

629 
CONST64
(0x8000000080000000), CONST64(0x8000008080000000), CONST64(0x8000000080000080), CONST64(0x8000008080000080),

630 
CONST64
(0x8000800080000000), CONST64(0x8000808080000000), CONST64(0x8000800080000080), CONST64(0x8000808080000080),

631 
CONST64
(0x8000000080008000), CONST64(0x8000008080008000), CONST64(0x8000000080008080), CONST64(0x8000008080008080),

632 
CONST64
(0x8000800080008000), CONST64(0x8000808080008000), CONST64(0x8000800080008080), CONST64(0x8000808080008080),

633 
CONST64
(0x8080000080000000), CONST64(0x8080008080000000), CONST64(0x8080000080000080), CONST64(0x8080008080000080),

634 
CONST64
(0x8080800080000000), CONST64(0x8080808080000000), CONST64(0x8080800080000080), CONST64(0x8080808080000080),

635 
CONST64
(0x8080000080008000), CONST64(0x8080008080008000), CONST64(0x8080000080008080), CONST64(0x8080008080008080),

636 
CONST64
(0x8080800080008000), CONST64(0x8080808080008000), CONST64(0x8080800080008080), CONST64(0x8080808080008080),

637 
CONST64
(0x8000000080800000), CONST64(0x8000008080800000), CONST64(0x8000000080800080), CONST64(0x8000008080800080),

638 
CONST64
(0x8000800080800000), CONST64(0x8000808080800000), CONST64(0x8000800080800080), CONST64(0x8000808080800080),

639 
CONST64
(0x8000000080808000), CONST64(0x8000008080808000), CONST64(0x8000000080808080), CONST64(0x8000008080808080),

640 
CONST64
(0x8000800080808000), CONST64(0x8000808080808000), CONST64(0x8000800080808080), CONST64(0x8000808080808080),

641 
CONST64
(0x8080000080800000), CONST64(0x8080008080800000), CONST64(0x8080000080800080), CONST64(0x8080008080800080),

642 
CONST64
(0x8080800080800000), CONST64(0x8080808080800000), CONST64(0x8080800080800080), CONST64(0x8080808080800080),

643 
CONST64
(0x8080000080808000), CONST64(0x8080008080808000), CONST64(0x8080000080808080), CONST64(0x8080008080808080),

644 
CONST64
(0x8080800080808000), CONST64(0x8080808080808000), CONST64(0x8080800080808080), CONST64(0x8080808080808080)

646 { 
CONST64
(0x0000000000000000), CONST64(0x0000004000000000), CONST64(0x0000000000000040), CONST64(0x0000004000000040),

647 
CONST64
(0x0000400000000000), CONST64(0x0000404000000000), CONST64(0x0000400000000040), CONST64(0x0000404000000040),

648 
CONST64
(0x0000000000004000), CONST64(0x0000004000004000), CONST64(0x0000000000004040), CONST64(0x0000004000004040),

649 
CONST64
(0x0000400000004000), CONST64(0x0000404000004000), CONST64(0x0000400000004040), CONST64(0x0000404000004040),

650 
CONST64
(0x0040000000000000), CONST64(0x0040004000000000), CONST64(0x0040000000000040), CONST64(0x0040004000000040),

651 
CONST64
(0x0040400000000000), CONST64(0x0040404000000000), CONST64(0x0040400000000040), CONST64(0x0040404000000040),

652 
CONST64
(0x0040000000004000), CONST64(0x0040004000004000), CONST64(0x0040000000004040), CONST64(0x0040004000004040),

653 
CONST64
(0x0040400000004000), CONST64(0x0040404000004000), CONST64(0x0040400000004040), CONST64(0x0040404000004040),

654 
CONST64
(0x0000000000400000), CONST64(0x0000004000400000), CONST64(0x0000000000400040), CONST64(0x0000004000400040),

655 
CONST64
(0x0000400000400000), CONST64(0x0000404000400000), CONST64(0x0000400000400040), CONST64(0x0000404000400040),

656 
CONST64
(0x0000000000404000), CONST64(0x0000004000404000), CONST64(0x0000000000404040), CONST64(0x0000004000404040),

657 
CONST64
(0x0000400000404000), CONST64(0x0000404000404000), CONST64(0x0000400000404040), CONST64(0x0000404000404040),

658 
CONST64
(0x0040000000400000), CONST64(0x0040004000400000), CONST64(0x0040000000400040), CONST64(0x0040004000400040),

659 
CONST64
(0x0040400000400000), CONST64(0x0040404000400000), CONST64(0x0040400000400040), CONST64(0x0040404000400040),

660 
CONST64
(0x0040000000404000), CONST64(0x0040004000404000), CONST64(0x0040000000404040), CONST64(0x0040004000404040),

661 
CONST64
(0x0040400000404000), CONST64(0x0040404000404000), CONST64(0x0040400000404040), CONST64(0x0040404000404040),

662 
CONST64
(0x4000000000000000), CONST64(0x4000004000000000), CONST64(0x4000000000000040), CONST64(0x4000004000000040),

663 
CONST64
(0x4000400000000000), CONST64(0x4000404000000000), CONST64(0x4000400000000040), CONST64(0x4000404000000040),

664 
CONST64
(0x4000000000004000), CONST64(0x4000004000004000), CONST64(0x4000000000004040), CONST64(0x4000004000004040),

665 
CONST64
(0x4000400000004000), CONST64(0x4000404000004000), CONST64(0x4000400000004040), CONST64(0x4000404000004040),

666 
CONST64
(0x4040000000000000), CONST64(0x4040004000000000), CONST64(0x4040000000000040), CONST64(0x4040004000000040),

667 
CONST64
(0x4040400000000000), CONST64(0x4040404000000000), CONST64(0x4040400000000040), CONST64(0x4040404000000040),

668 
CONST64
(0x4040000000004000), CONST64(0x4040004000004000), CONST64(0x4040000000004040), CONST64(0x4040004000004040),

669 
CONST64
(0x4040400000004000), CONST64(0x4040404000004000), CONST64(0x4040400000004040), CONST64(0x4040404000004040),

670 
CONST64
(0x4000000000400000), CONST64(0x4000004000400000), CONST64(0x4000000000400040), CONST64(0x4000004000400040),

671 
CONST64
(0x4000400000400000), CONST64(0x4000404000400000), CONST64(0x4000400000400040), CONST64(0x4000404000400040),

672 
CONST64
(0x4000000000404000), CONST64(0x4000004000404000), CONST64(0x4000000000404040), CONST64(0x4000004000404040),

673 
CONST64
(0x4000400000404000), CONST64(0x4000404000404000), CONST64(0x4000400000404040), CONST64(0x4000404000404040),

674 
CONST64
(0x4040000000400000), CONST64(0x4040004000400000), CONST64(0x4040000000400040), CONST64(0x4040004000400040),

675 
CONST64
(0x4040400000400000), CONST64(0x4040404000400000), CONST64(0x4040400000400040), CONST64(0x4040404000400040),

676 
CONST64
(0x4040000000404000), CONST64(0x4040004000404000), CONST64(0x4040000000404040), CONST64(0x4040004000404040),

677 
CONST64
(0x4040400000404000), CONST64(0x4040404000404000), CONST64(0x4040400000404040), CONST64(0x4040404000404040),

678 
CONST64
(0x0000000040000000), CONST64(0x0000004040000000), CONST64(0x0000000040000040), CONST64(0x0000004040000040),

679 
CONST64
(0x0000400040000000), CONST64(0x0000404040000000), CONST64(0x0000400040000040), CONST64(0x0000404040000040),

680 
CONST64
(0x0000000040004000), CONST64(0x0000004040004000), CONST64(0x0000000040004040), CONST64(0x0000004040004040),

681 
CONST64
(0x0000400040004000), CONST64(0x0000404040004000), CONST64(0x0000400040004040), CONST64(0x0000404040004040),

682 
CONST64
(0x0040000040000000), CONST64(0x0040004040000000), CONST64(0x0040000040000040), CONST64(0x0040004040000040),

683 
CONST64
(0x0040400040000000), CONST64(0x0040404040000000), CONST64(0x0040400040000040), CONST64(0x0040404040000040),

684 
CONST64
(0x0040000040004000), CONST64(0x0040004040004000), CONST64(0x0040000040004040), CONST64(0x0040004040004040),

685 
CONST64
(0x0040400040004000), CONST64(0x0040404040004000), CONST64(0x0040400040004040), CONST64(0x0040404040004040),

686 
CONST64
(0x0000000040400000), CONST64(0x0000004040400000), CONST64(0x0000000040400040), CONST64(0x0000004040400040),

687 
CONST64
(0x0000400040400000), CONST64(0x0000404040400000), CONST64(0x0000400040400040), CONST64(0x0000404040400040),

688 
CONST64
(0x0000000040404000), CONST64(0x0000004040404000), CONST64(0x0000000040404040), CONST64(0x0000004040404040),

689 
CONST64
(0x0000400040404000), CONST64(0x0000404040404000), CONST64(0x0000400040404040), CONST64(0x0000404040404040),

690 
CONST64
(0x0040000040400000), CONST64(0x0040004040400000), CONST64(0x0040000040400040), CONST64(0x0040004040400040),

691 
CONST64
(0x0040400040400000), CONST64(0x0040404040400000), CONST64(0x0040400040400040), CONST64(0x0040404040400040),

692 
CONST64
(0x0040000040404000), CONST64(0x0040004040404000), CONST64(0x0040000040404040), CONST64(0x0040004040404040),

693 
CONST64
(0x0040400040404000), CONST64(0x0040404040404000), CONST64(0x0040400040404040), CONST64(0x0040404040404040),

694 
CONST64
(0x4000000040000000), CONST64(0x4000004040000000), CONST64(0x4000000040000040), CONST64(0x4000004040000040),

695 
CONST64
(0x4000400040000000), CONST64(0x4000404040000000), CONST64(0x4000400040000040), CONST64(0x4000404040000040),

696 
CONST64
(0x4000000040004000), CONST64(0x4000004040004000), CONST64(0x4000000040004040), CONST64(0x4000004040004040),

697 
CONST64
(0x4000400040004000), CONST64(0x4000404040004000), CONST64(0x4000400040004040), CONST64(0x4000404040004040),

698 
CONST64
(0x4040000040000000), CONST64(0x4040004040000000), CONST64(0x4040000040000040), CONST64(0x4040004040000040),

699 
CONST64
(0x4040400040000000), CONST64(0x4040404040000000), CONST64(0x4040400040000040), CONST64(0x4040404040000040),

700 
CONST64
(0x4040000040004000), CONST64(0x4040004040004000), CONST64(0x4040000040004040), CONST64(0x4040004040004040),

701 
CONST64
(0x4040400040004000), CONST64(0x4040404040004000), CONST64(0x4040400040004040), CONST64(0x4040404040004040),

702 
CONST64
(0x4000000040400000), CONST64(0x4000004040400000), CONST64(0x4000000040400040), CONST64(0x4000004040400040),

703 
CONST64
(0x4000400040400000), CONST64(0x4000404040400000), CONST64(0x4000400040400040), CONST64(0x4000404040400040),

704 
CONST64
(0x4000000040404000), CONST64(0x4000004040404000), CONST64(0x4000000040404040), CONST64(0x4000004040404040),

705 
CONST64
(0x4000400040404000), CONST64(0x4000404040404000), CONST64(0x4000400040404040), CONST64(0x4000404040404040),

706 
CONST64
(0x4040000040400000), CONST64(0x4040004040400000), CONST64(0x4040000040400040), CONST64(0x4040004040400040),

707 
CONST64
(0x4040400040400000), CONST64(0x4040404040400000), CONST64(0x4040400040400040), CONST64(0x4040404040400040),

708 
CONST64
(0x4040000040404000), CONST64(0x4040004040404000), CONST64(0x4040000040404040), CONST64(0x4040004040404040),

709 
CONST64
(0x4040400040404000), CONST64(0x4040404040404000), CONST64(0x4040400040404040), CONST64(0x4040404040404040)

711 { 
CONST64
(0x0000000000000000), CONST64(0x0000002000000000), CONST64(0x0000000000000020), CONST64(0x0000002000000020),

712 
CONST64
(0x0000200000000000), CONST64(0x0000202000000000), CONST64(0x0000200000000020), CONST64(0x0000202000000020),

713 
CONST64
(0x0000000000002000), CONST64(0x0000002000002000), CONST64(0x0000000000002020), CONST64(0x0000002000002020),

714 
CONST64
(0x0000200000002000), CONST64(0x0000202000002000), CONST64(0x0000200000002020), CONST64(0x0000202000002020),

715 
CONST64
(0x0020000000000000), CONST64(0x0020002000000000), CONST64(0x0020000000000020), CONST64(0x0020002000000020),

716 
CONST64
(0x0020200000000000), CONST64(0x0020202000000000), CONST64(0x0020200000000020), CONST64(0x0020202000000020),

717 
CONST64
(0x0020000000002000), CONST64(0x0020002000002000), CONST64(0x0020000000002020), CONST64(0x0020002000002020),

718 
CONST64
(0x0020200000002000), CONST64(0x0020202000002000), CONST64(0x0020200000002020), CONST64(0x0020202000002020),

719 
CONST64
(0x0000000000200000), CONST64(0x0000002000200000), CONST64(0x0000000000200020), CONST64(0x0000002000200020),

720 
CONST64
(0x0000200000200000), CONST64(0x0000202000200000), CONST64(0x0000200000200020), CONST64(0x0000202000200020),

721 
CONST64
(0x0000000000202000), CONST64(0x0000002000202000), CONST64(0x0000000000202020), CONST64(0x0000002000202020),

722 
CONST64
(0x0000200000202000), CONST64(0x0000202000202000), CONST64(0x0000200000202020), CONST64(0x0000202000202020),

723 
CONST64
(0x0020000000200000), CONST64(0x0020002000200000), CONST64(0x0020000000200020), CONST64(0x0020002000200020),

724 
CONST64
(0x0020200000200000), CONST64(0x0020202000200000), CONST64(0x0020200000200020), CONST64(0x0020202000200020),

725 
CONST64
(0x0020000000202000), CONST64(0x0020002000202000), CONST64(0x0020000000202020), CONST64(0x0020002000202020),

726 
CONST64
(0x0020200000202000), CONST64(0x0020202000202000), CONST64(0x0020200000202020), CONST64(0x0020202000202020),

727 
CONST64
(0x2000000000000000), CONST64(0x2000002000000000), CONST64(0x2000000000000020), CONST64(0x2000002000000020),

728 
CONST64
(0x2000200000000000), CONST64(0x2000202000000000), CONST64(0x2000200000000020), CONST64(0x2000202000000020),

729 
CONST64
(0x2000000000002000), CONST64(0x2000002000002000), CONST64(0x2000000000002020), CONST64(0x2000002000002020),

730 
CONST64
(0x2000200000002000), CONST64(0x2000202000002000), CONST64(0x2000200000002020), CONST64(0x2000202000002020),

731 
CONST64
(0x2020000000000000), CONST64(0x2020002000000000), CONST64(0x2020000000000020), CONST64(0x2020002000000020),

732 
CONST64
(0x2020200000000000), CONST64(0x2020202000000000), CONST64(0x2020200000000020), CONST64(0x2020202000000020),

733 
CONST64
(0x2020000000002000), CONST64(0x2020002000002000), CONST64(0x2020000000002020), CONST64(0x2020002000002020),

734 
CONST64
(0x2020200000002000), CONST64(0x2020202000002000), CONST64(0x2020200000002020), CONST64(0x2020202000002020),

735 
CONST64
(0x2000000000200000), CONST64(0x2000002000200000), CONST64(0x2000000000200020), CONST64(0x2000002000200020),

736 
CONST64
(0x2000200000200000), CONST64(0x2000202000200000), CONST64(0x2000200000200020), CONST64(0x2000202000200020),

737 
CONST64
(0x2000000000202000), CONST64(0x2000002000202000), CONST64(0x2000000000202020), CONST64(0x2000002000202020),

738 
CONST64
(0x2000200000202000), CONST64(0x2000202000202000), CONST64(0x2000200000202020), CONST64(0x2000202000202020),

739 
CONST64
(0x2020000000200000), CONST64(0x2020002000200000), CONST64(0x2020000000200020), CONST64(0x2020002000200020),

740 
CONST64
(0x2020200000200000), CONST64(0x2020202000200000), CONST64(0x2020200000200020), CONST64(0x2020202000200020),

741 
CONST64
(0x2020000000202000), CONST64(0x2020002000202000), CONST64(0x2020000000202020), CONST64(0x2020002000202020),

742 
CONST64
(0x2020200000202000), CONST64(0x2020202000202000), CONST64(0x2020200000202020), CONST64(0x2020202000202020),

743 
CONST64
(0x0000000020000000), CONST64(0x0000002020000000), CONST64(0x0000000020000020), CONST64(0x0000002020000020),

744 
CONST64
(0x0000200020000000), CONST64(0x0000202020000000), CONST64(0x0000200020000020), CONST64(0x0000202020000020),

745 
CONST64
(0x0000000020002000), CONST64(0x0000002020002000), CONST64(0x0000000020002020), CONST64(0x0000002020002020),

746 
CONST64
(0x0000200020002000), CONST64(0x0000202020002000), CONST64(0x0000200020002020), CONST64(0x0000202020002020),

747 
CONST64
(0x0020000020000000), CONST64(0x0020002020000000), CONST64(0x0020000020000020), CONST64(0x0020002020000020),

748 
CONST64
(0x0020200020000000), CONST64(0x0020202020000000), CONST64(0x0020200020000020), CONST64(0x0020202020000020),

749 
CONST64
(0x0020000020002000), CONST64(0x0020002020002000), CONST64(0x0020000020002020), CONST64(0x0020002020002020),

750 
CONST64
(0x0020200020002000), CONST64(0x0020202020002000), CONST64(0x0020200020002020), CONST64(0x0020202020002020),

751 
CONST64
(0x0000000020200000), CONST64(0x0000002020200000), CONST64(0x0000000020200020), CONST64(0x0000002020200020),

752 
CONST64
(0x0000200020200000), CONST64(0x0000202020200000), CONST64(0x0000200020200020), CONST64(0x0000202020200020),

753 
CONST64
(0x0000000020202000), CONST64(0x0000002020202000), CONST64(0x0000000020202020), CONST64(0x0000002020202020),

754 
CONST64
(0x0000200020202000), CONST64(0x0000202020202000), CONST64(0x0000200020202020), CONST64(0x0000202020202020),

755 
CONST64
(0x0020000020200000), CONST64(0x0020002020200000), CONST64(0x0020000020200020), CONST64(0x0020002020200020),

756 
CONST64
(0x0020200020200000), CONST64(0x0020202020200000), CONST64(0x0020200020200020), CONST64(0x0020202020200020),

757 
CONST64
(0x0020000020202000), CONST64(0x0020002020202000), CONST64(0x0020000020202020), CONST64(0x0020002020202020),

758 
CONST64
(0x0020200020202000), CONST64(0x0020202020202000), CONST64(0x0020200020202020), CONST64(0x0020202020202020),

759 
CONST64
(0x2000000020000000), CONST64(0x2000002020000000), CONST64(0x2000000020000020), CONST64(0x2000002020000020),

760 
CONST64
(0x2000200020000000), CONST64(0x2000202020000000), CONST64(0x2000200020000020), CONST64(0x2000202020000020),

761 
CONST64
(0x2000000020002000), CONST64(0x2000002020002000), CONST64(0x2000000020002020), CONST64(0x2000002020002020),

762 
CONST64
(0x2000200020002000), CONST64(0x2000202020002000), CONST64(0x2000200020002020), CONST64(0x2000202020002020),

763 
CONST64
(0x2020000020000000), CONST64(0x2020002020000000), CONST64(0x2020000020000020), CONST64(0x2020002020000020),

764 
CONST64
(0x2020200020000000), CONST64(0x2020202020000000), CONST64(0x2020200020000020), CONST64(0x2020202020000020),

765 
CONST64
(0x2020000020002000), CONST64(0x2020002020002000), CONST64(0x2020000020002020), CONST64(0x2020002020002020),

766 
CONST64
(0x2020200020002000), CONST64(0x2020202020002000), CONST64(0x2020200020002020), CONST64(0x2020202020002020),

767 
CONST64
(0x2000000020200000), CONST64(0x2000002020200000), CONST64(0x2000000020200020), CONST64(0x2000002020200020),

768 
CONST64
(0x2000200020200000), CONST64(0x2000202020200000), CONST64(0x2000200020200020), CONST64(0x2000202020200020),

769 
CONST64
(0x2000000020202000), CONST64(0x2000002020202000), CONST64(0x2000000020202020), CONST64(0x2000002020202020),

770 
CONST64
(0x2000200020202000), CONST64(0x2000202020202000), CONST64(0x2000200020202020), CONST64(0x2000202020202020),

771 
CONST64
(0x2020000020200000), CONST64(0x2020002020200000), CONST64(0x2020000020200020), CONST64(0x2020002020200020),

772 
CONST64
(0x2020200020200000), CONST64(0x2020202020200000), CONST64(0x2020200020200020), CONST64(0x2020202020200020),

773 
CONST64
(0x2020000020202000), CONST64(0x2020002020202000), CONST64(0x2020000020202020), CONST64(0x2020002020202020),

774 
CONST64
(0x2020200020202000), CONST64(0x2020202020202000), CONST64(0x2020200020202020), CONST64(0x2020202020202020)

777 cÚ¡ 
ulÚg64
 
	gdes_å
[8][256] = {

779 { 
CONST64
(0x0000000000000000), CONST64(0x0000008000000000), CONST64(0x0000000002000000), CONST64(0x0000008002000000),

780 
CONST64
(0x0000000000020000), CONST64(0x0000008000020000), CONST64(0x0000000002020000), CONST64(0x0000008002020000),

781 
CONST64
(0x0000000000000200), CONST64(0x0000008000000200), CONST64(0x0000000002000200), CONST64(0x0000008002000200),

782 
CONST64
(0x0000000000020200), CONST64(0x0000008000020200), CONST64(0x0000000002020200), CONST64(0x0000008002020200),

783 
CONST64
(0x0000000000000002), CONST64(0x0000008000000002), CONST64(0x0000000002000002), CONST64(0x0000008002000002),

784 
CONST64
(0x0000000000020002), CONST64(0x0000008000020002), CONST64(0x0000000002020002), CONST64(0x0000008002020002),

785 
CONST64
(0x0000000000000202), CONST64(0x0000008000000202), CONST64(0x0000000002000202), CONST64(0x0000008002000202),

786 
CONST64
(0x0000000000020202), CONST64(0x0000008000020202), CONST64(0x0000000002020202), CONST64(0x0000008002020202),

787 
CONST64
(0x0200000000000000), CONST64(0x0200008000000000), CONST64(0x0200000002000000), CONST64(0x0200008002000000),

788 
CONST64
(0x0200000000020000), CONST64(0x0200008000020000), CONST64(0x0200000002020000), CONST64(0x0200008002020000),

789 
CONST64
(0x0200000000000200), CONST64(0x0200008000000200), CONST64(0x0200000002000200), CONST64(0x0200008002000200),

790 
CONST64
(0x0200000000020200), CONST64(0x0200008000020200), CONST64(0x0200000002020200), CONST64(0x0200008002020200),

791 
CONST64
(0x0200000000000002), CONST64(0x0200008000000002), CONST64(0x0200000002000002), CONST64(0x0200008002000002),

792 
CONST64
(0x0200000000020002), CONST64(0x0200008000020002), CONST64(0x0200000002020002), CONST64(0x0200008002020002),

793 
CONST64
(0x0200000000000202), CONST64(0x0200008000000202), CONST64(0x0200000002000202), CONST64(0x0200008002000202),

794 
CONST64
(0x0200000000020202), CONST64(0x0200008000020202), CONST64(0x0200000002020202), CONST64(0x0200008002020202),

795 
CONST64
(0x0002000000000000), CONST64(0x0002008000000000), CONST64(0x0002000002000000), CONST64(0x0002008002000000),

796 
CONST64
(0x0002000000020000), CONST64(0x0002008000020000), CONST64(0x0002000002020000), CONST64(0x0002008002020000),

797 
CONST64
(0x0002000000000200), CONST64(0x0002008000000200), CONST64(0x0002000002000200), CONST64(0x0002008002000200),

798 
CONST64
(0x0002000000020200), CONST64(0x0002008000020200), CONST64(0x0002000002020200), CONST64(0x0002008002020200),

799 
CONST64
(0x0002000000000002), CONST64(0x0002008000000002), CONST64(0x0002000002000002), CONST64(0x0002008002000002),

800 
CONST64
(0x0002000000020002), CONST64(0x0002008000020002), CONST64(0x0002000002020002), CONST64(0x0002008002020002),

801 
CONST64
(0x0002000000000202), CONST64(0x0002008000000202), CONST64(0x0002000002000202), CONST64(0x0002008002000202),

802 
CONST64
(0x0002000000020202), CONST64(0x0002008000020202), CONST64(0x0002000002020202), CONST64(0x0002008002020202),

803 
CONST64
(0x0202000000000000), CONST64(0x0202008000000000), CONST64(0x0202000002000000), CONST64(0x0202008002000000),

804 
CONST64
(0x0202000000020000), CONST64(0x0202008000020000), CONST64(0x0202000002020000), CONST64(0x0202008002020000),

805 
CONST64
(0x0202000000000200), CONST64(0x0202008000000200), CONST64(0x0202000002000200), CONST64(0x0202008002000200),

806 
CONST64
(0x0202000000020200), CONST64(0x0202008000020200), CONST64(0x0202000002020200), CONST64(0x0202008002020200),

807 
CONST64
(0x0202000000000002), CONST64(0x0202008000000002), CONST64(0x0202000002000002), CONST64(0x0202008002000002),

808 
CONST64
(0x0202000000020002), CONST64(0x0202008000020002), CONST64(0x0202000002020002), CONST64(0x0202008002020002),

809 
CONST64
(0x0202000000000202), CONST64(0x0202008000000202), CONST64(0x0202000002000202), CONST64(0x0202008002000202),

810 
CONST64
(0x0202000000020202), CONST64(0x0202008000020202), CONST64(0x0202000002020202), CONST64(0x0202008002020202),

811 
CONST64
(0x0000020000000000), CONST64(0x0000028000000000), CONST64(0x0000020002000000), CONST64(0x0000028002000000),

812 
CONST64
(0x0000020000020000), CONST64(0x0000028000020000), CONST64(0x0000020002020000), CONST64(0x0000028002020000),

813 
CONST64
(0x0000020000000200), CONST64(0x0000028000000200), CONST64(0x0000020002000200), CONST64(0x0000028002000200),

814 
CONST64
(0x0000020000020200), CONST64(0x0000028000020200), CONST64(0x0000020002020200), CONST64(0x0000028002020200),

815 
CONST64
(0x0000020000000002), CONST64(0x0000028000000002), CONST64(0x0000020002000002), CONST64(0x0000028002000002),

816 
CONST64
(0x0000020000020002), CONST64(0x0000028000020002), CONST64(0x0000020002020002), CONST64(0x0000028002020002),

817 
CONST64
(0x0000020000000202), CONST64(0x0000028000000202), CONST64(0x0000020002000202), CONST64(0x0000028002000202),

818 
CONST64
(0x0000020000020202), CONST64(0x0000028000020202), CONST64(0x0000020002020202), CONST64(0x0000028002020202),

819 
CONST64
(0x0200020000000000), CONST64(0x0200028000000000), CONST64(0x0200020002000000), CONST64(0x0200028002000000),

820 
CONST64
(0x0200020000020000), CONST64(0x0200028000020000), CONST64(0x0200020002020000), CONST64(0x0200028002020000),

821 
CONST64
(0x0200020000000200), CONST64(0x0200028000000200), CONST64(0x0200020002000200), CONST64(0x0200028002000200),

822 
CONST64
(0x0200020000020200), CONST64(0x0200028000020200), CONST64(0x0200020002020200), CONST64(0x0200028002020200),

823 
CONST64
(0x0200020000000002), CONST64(0x0200028000000002), CONST64(0x0200020002000002), CONST64(0x0200028002000002),

824 
CONST64
(0x0200020000020002), CONST64(0x0200028000020002), CONST64(0x0200020002020002), CONST64(0x0200028002020002),

825 
CONST64
(0x0200020000000202), CONST64(0x0200028000000202), CONST64(0x0200020002000202), CONST64(0x0200028002000202),

826 
CONST64
(0x0200020000020202), CONST64(0x0200028000020202), CONST64(0x0200020002020202), CONST64(0x0200028002020202),

827 
CONST64
(0x0002020000000000), CONST64(0x0002028000000000), CONST64(0x0002020002000000), CONST64(0x0002028002000000),

828 
CONST64
(0x0002020000020000), CONST64(0x0002028000020000), CONST64(0x0002020002020000), CONST64(0x0002028002020000),

829 
CONST64
(0x0002020000000200), CONST64(0x0002028000000200), CONST64(0x0002020002000200), CONST64(0x0002028002000200),

830 
CONST64
(0x0002020000020200), CONST64(0x0002028000020200), CONST64(0x0002020002020200), CONST64(0x0002028002020200),

831 
CONST64
(0x0002020000000002), CONST64(0x0002028000000002), CONST64(0x0002020002000002), CONST64(0x0002028002000002),

832 
CONST64
(0x0002020000020002), CONST64(0x0002028000020002), CONST64(0x0002020002020002), CONST64(0x0002028002020002),

833 
CONST64
(0x0002020000000202), CONST64(0x0002028000000202), CONST64(0x0002020002000202), CONST64(0x0002028002000202),

834 
CONST64
(0x0002020000020202), CONST64(0x0002028000020202), CONST64(0x0002020002020202), CONST64(0x0002028002020202),

835 
CONST64
(0x0202020000000000), CONST64(0x0202028000000000), CONST64(0x0202020002000000), CONST64(0x0202028002000000),

836 
CONST64
(0x0202020000020000), CONST64(0x0202028000020000), CONST64(0x0202020002020000), CONST64(0x0202028002020000),

837 
CONST64
(0x0202020000000200), CONST64(0x0202028000000200), CONST64(0x0202020002000200), CONST64(0x0202028002000200),

838 
CONST64
(0x0202020000020200), CONST64(0x0202028000020200), CONST64(0x0202020002020200), CONST64(0x0202028002020200),

839 
CONST64
(0x0202020000000002), CONST64(0x0202028000000002), CONST64(0x0202020002000002), CONST64(0x0202028002000002),

840 
CONST64
(0x0202020000020002), CONST64(0x0202028000020002), CONST64(0x0202020002020002), CONST64(0x0202028002020002),

841 
CONST64
(0x0202020000000202), CONST64(0x0202028000000202), CONST64(0x0202020002000202), CONST64(0x0202028002000202),

842 
CONST64
(0x0202020000020202), CONST64(0x0202028000020202), CONST64(0x0202020002020202), CONST64(0x0202028002020202)

844 { 
CONST64
(0x0000000000000000), CONST64(0x0000000200000000), CONST64(0x0000000008000000), CONST64(0x0000000208000000),

845 
CONST64
(0x0000000000080000), CONST64(0x0000000200080000), CONST64(0x0000000008080000), CONST64(0x0000000208080000),

846 
CONST64
(0x0000000000000800), CONST64(0x0000000200000800), CONST64(0x0000000008000800), CONST64(0x0000000208000800),

847 
CONST64
(0x0000000000080800), CONST64(0x0000000200080800), CONST64(0x0000000008080800), CONST64(0x0000000208080800),

848 
CONST64
(0x0000000000000008), CONST64(0x0000000200000008), CONST64(0x0000000008000008), CONST64(0x0000000208000008),

849 
CONST64
(0x0000000000080008), CONST64(0x0000000200080008), CONST64(0x0000000008080008), CONST64(0x0000000208080008),

850 
CONST64
(0x0000000000000808), CONST64(0x0000000200000808), CONST64(0x0000000008000808), CONST64(0x0000000208000808),

851 
CONST64
(0x0000000000080808), CONST64(0x0000000200080808), CONST64(0x0000000008080808), CONST64(0x0000000208080808),

852 
CONST64
(0x0800000000000000), CONST64(0x0800000200000000), CONST64(0x0800000008000000), CONST64(0x0800000208000000),

853 
CONST64
(0x0800000000080000), CONST64(0x0800000200080000), CONST64(0x0800000008080000), CONST64(0x0800000208080000),

854 
CONST64
(0x0800000000000800), CONST64(0x0800000200000800), CONST64(0x0800000008000800), CONST64(0x0800000208000800),

855 
CONST64
(0x0800000000080800), CONST64(0x0800000200080800), CONST64(0x0800000008080800), CONST64(0x0800000208080800),

856 
CONST64
(0x0800000000000008), CONST64(0x0800000200000008), CONST64(0x0800000008000008), CONST64(0x0800000208000008),

857 
CONST64
(0x0800000000080008), CONST64(0x0800000200080008), CONST64(0x0800000008080008), CONST64(0x0800000208080008),

858 
CONST64
(0x0800000000000808), CONST64(0x0800000200000808), CONST64(0x0800000008000808), CONST64(0x0800000208000808),

859 
CONST64
(0x0800000000080808), CONST64(0x0800000200080808), CONST64(0x0800000008080808), CONST64(0x0800000208080808),

860 
CONST64
(0x0008000000000000), CONST64(0x0008000200000000), CONST64(0x0008000008000000), CONST64(0x0008000208000000),

861 
CONST64
(0x0008000000080000), CONST64(0x0008000200080000), CONST64(0x0008000008080000), CONST64(0x0008000208080000),

862 
CONST64
(0x0008000000000800), CONST64(0x0008000200000800), CONST64(0x0008000008000800), CONST64(0x0008000208000800),

863 
CONST64
(0x0008000000080800), CONST64(0x0008000200080800), CONST64(0x0008000008080800), CONST64(0x0008000208080800),

864 
CONST64
(0x0008000000000008), CONST64(0x0008000200000008), CONST64(0x0008000008000008), CONST64(0x0008000208000008),

865 
CONST64
(0x0008000000080008), CONST64(0x0008000200080008), CONST64(0x0008000008080008), CONST64(0x0008000208080008),

866 
CONST64
(0x0008000000000808), CONST64(0x0008000200000808), CONST64(0x0008000008000808), CONST64(0x0008000208000808),

867 
CONST64
(0x0008000000080808), CONST64(0x0008000200080808), CONST64(0x0008000008080808), CONST64(0x0008000208080808),

868 
CONST64
(0x0808000000000000), CONST64(0x0808000200000000), CONST64(0x0808000008000000), CONST64(0x0808000208000000),

869 
CONST64
(0x0808000000080000), CONST64(0x0808000200080000), CONST64(0x0808000008080000), CONST64(0x0808000208080000),

870 
CONST64
(0x0808000000000800), CONST64(0x0808000200000800), CONST64(0x0808000008000800), CONST64(0x0808000208000800),

871 
CONST64
(0x0808000000080800), CONST64(0x0808000200080800), CONST64(0x0808000008080800), CONST64(0x0808000208080800),

872 
CONST64
(0x0808000000000008), CONST64(0x0808000200000008), CONST64(0x0808000008000008), CONST64(0x0808000208000008),

873 
CONST64
(0x0808000000080008), CONST64(0x0808000200080008), CONST64(0x0808000008080008), CONST64(0x0808000208080008),

874 
CONST64
(0x0808000000000808), CONST64(0x0808000200000808), CONST64(0x0808000008000808), CONST64(0x0808000208000808),

875 
CONST64
(0x0808000000080808), CONST64(0x0808000200080808), CONST64(0x0808000008080808), CONST64(0x0808000208080808),

876 
CONST64
(0x0000080000000000), CONST64(0x0000080200000000), CONST64(0x0000080008000000), CONST64(0x0000080208000000),

877 
CONST64
(0x0000080000080000), CONST64(0x0000080200080000), CONST64(0x0000080008080000), CONST64(0x0000080208080000),

878 
CONST64
(0x0000080000000800), CONST64(0x0000080200000800), CONST64(0x0000080008000800), CONST64(0x0000080208000800),

879 
CONST64
(0x0000080000080800), CONST64(0x0000080200080800), CONST64(0x0000080008080800), CONST64(0x0000080208080800),

880 
CONST64
(0x0000080000000008), CONST64(0x0000080200000008), CONST64(0x0000080008000008), CONST64(0x0000080208000008),

881 
CONST64
(0x0000080000080008), CONST64(0x0000080200080008), CONST64(0x0000080008080008), CONST64(0x0000080208080008),

882 
CONST64
(0x0000080000000808), CONST64(0x0000080200000808), CONST64(0x0000080008000808), CONST64(0x0000080208000808),

883 
CONST64
(0x0000080000080808), CONST64(0x0000080200080808), CONST64(0x0000080008080808), CONST64(0x0000080208080808),

884 
CONST64
(0x0800080000000000), CONST64(0x0800080200000000), CONST64(0x0800080008000000), CONST64(0x0800080208000000),

885 
CONST64
(0x0800080000080000), CONST64(0x0800080200080000), CONST64(0x0800080008080000), CONST64(0x0800080208080000),

886 
CONST64
(0x0800080000000800), CONST64(0x0800080200000800), CONST64(0x0800080008000800), CONST64(0x0800080208000800),

887 
CONST64
(0x0800080000080800), CONST64(0x0800080200080800), CONST64(0x0800080008080800), CONST64(0x0800080208080800),

888 
CONST64
(0x0800080000000008), CONST64(0x0800080200000008), CONST64(0x0800080008000008), CONST64(0x0800080208000008),

889 
CONST64
(0x0800080000080008), CONST64(0x0800080200080008), CONST64(0x0800080008080008), CONST64(0x0800080208080008),

890 
CONST64
(0x0800080000000808), CONST64(0x0800080200000808), CONST64(0x0800080008000808), CONST64(0x0800080208000808),

891 
CONST64
(0x0800080000080808), CONST64(0x0800080200080808), CONST64(0x0800080008080808), CONST64(0x0800080208080808),

892 
CONST64
(0x0008080000000000), CONST64(0x0008080200000000), CONST64(0x0008080008000000), CONST64(0x0008080208000000),

893 
CONST64
(0x0008080000080000), CONST64(0x0008080200080000), CONST64(0x0008080008080000), CONST64(0x0008080208080000),

894 
CONST64
(0x0008080000000800), CONST64(0x0008080200000800), CONST64(0x0008080008000800), CONST64(0x0008080208000800),

895 
CONST64
(0x0008080000080800), CONST64(0x0008080200080800), CONST64(0x0008080008080800), CONST64(0x0008080208080800),

896 
CONST64
(0x0008080000000008), CONST64(0x0008080200000008), CONST64(0x0008080008000008), CONST64(0x0008080208000008),

897 
CONST64
(0x0008080000080008), CONST64(0x0008080200080008), CONST64(0x0008080008080008), CONST64(0x0008080208080008),

898 
CONST64
(0x0008080000000808), CONST64(0x0008080200000808), CONST64(0x0008080008000808), CONST64(0x0008080208000808),

899 
CONST64
(0x0008080000080808), CONST64(0x0008080200080808), CONST64(0x0008080008080808), CONST64(0x0008080208080808),

900 
CONST64
(0x0808080000000000), CONST64(0x0808080200000000), CONST64(0x0808080008000000), CONST64(0x0808080208000000),

901 
CONST64
(0x0808080000080000), CONST64(0x0808080200080000), CONST64(0x0808080008080000), CONST64(0x0808080208080000),

902 
CONST64
(0x0808080000000800), CONST64(0x0808080200000800), CONST64(0x0808080008000800), CONST64(0x0808080208000800),

903 
CONST64
(0x0808080000080800), CONST64(0x0808080200080800), CONST64(0x0808080008080800), CONST64(0x0808080208080800),

904 
CONST64
(0x0808080000000008), CONST64(0x0808080200000008), CONST64(0x0808080008000008), CONST64(0x0808080208000008),

905 
CONST64
(0x0808080000080008), CONST64(0x0808080200080008), CONST64(0x0808080008080008), CONST64(0x0808080208080008),

906 
CONST64
(0x0808080000000808), CONST64(0x0808080200000808), CONST64(0x0808080008000808), CONST64(0x0808080208000808),

907 
CONST64
(0x0808080000080808), CONST64(0x0808080200080808), CONST64(0x0808080008080808), CONST64(0x0808080208080808)

909 { 
CONST64
(0x0000000000000000), CONST64(0x0000000800000000), CONST64(0x0000000020000000), CONST64(0x0000000820000000),

910 
CONST64
(0x0000000000200000), CONST64(0x0000000800200000), CONST64(0x0000000020200000), CONST64(0x0000000820200000),

911 
CONST64
(0x0000000000002000), CONST64(0x0000000800002000), CONST64(0x0000000020002000), CONST64(0x0000000820002000),

912 
CONST64
(0x0000000000202000), CONST64(0x0000000800202000), CONST64(0x0000000020202000), CONST64(0x0000000820202000),

913 
CONST64
(0x0000000000000020), CONST64(0x0000000800000020), CONST64(0x0000000020000020), CONST64(0x0000000820000020),

914 
CONST64
(0x0000000000200020), CONST64(0x0000000800200020), CONST64(0x0000000020200020), CONST64(0x0000000820200020),

915 
CONST64
(0x0000000000002020), CONST64(0x0000000800002020), CONST64(0x0000000020002020), CONST64(0x0000000820002020),

916 
CONST64
(0x0000000000202020), CONST64(0x0000000800202020), CONST64(0x0000000020202020), CONST64(0x0000000820202020),

917 
CONST64
(0x2000000000000000), CONST64(0x2000000800000000), CONST64(0x2000000020000000), CONST64(0x2000000820000000),

918 
CONST64
(0x2000000000200000), CONST64(0x2000000800200000), CONST64(0x2000000020200000), CONST64(0x2000000820200000),

919 
CONST64
(0x2000000000002000), CONST64(0x2000000800002000), CONST64(0x2000000020002000), CONST64(0x2000000820002000),

920 
CONST64
(0x2000000000202000), CONST64(0x2000000800202000), CONST64(0x2000000020202000), CONST64(0x2000000820202000),

921 
CONST64
(0x2000000000000020), CONST64(0x2000000800000020), CONST64(0x2000000020000020), CONST64(0x2000000820000020),

922 
CONST64
(0x2000000000200020), CONST64(0x2000000800200020), CONST64(0x2000000020200020), CONST64(0x2000000820200020),

923 
CONST64
(0x2000000000002020), CONST64(0x2000000800002020), CONST64(0x2000000020002020), CONST64(0x2000000820002020),

924 
CONST64
(0x2000000000202020), CONST64(0x2000000800202020), CONST64(0x2000000020202020), CONST64(0x2000000820202020),

925 
CONST64
(0x0020000000000000), CONST64(0x0020000800000000), CONST64(0x0020000020000000), CONST64(0x0020000820000000),

926 
CONST64
(0x0020000000200000), CONST64(0x0020000800200000), CONST64(0x0020000020200000), CONST64(0x0020000820200000),

927 
CONST64
(0x0020000000002000), CONST64(0x0020000800002000), CONST64(0x0020000020002000), CONST64(0x0020000820002000),

928 
CONST64
(0x0020000000202000), CONST64(0x0020000800202000), CONST64(0x0020000020202000), CONST64(0x0020000820202000),

929 
CONST64
(0x0020000000000020), CONST64(0x0020000800000020), CONST64(0x0020000020000020), CONST64(0x0020000820000020),

930 
CONST64
(0x0020000000200020), CONST64(0x0020000800200020), CONST64(0x0020000020200020), CONST64(0x0020000820200020),

931 
CONST64
(0x0020000000002020), CONST64(0x0020000800002020), CONST64(0x0020000020002020), CONST64(0x0020000820002020),

932 
CONST64
(0x0020000000202020), CONST64(0x0020000800202020), CONST64(0x0020000020202020), CONST64(0x0020000820202020),

933 
CONST64
(0x2020000000000000), CONST64(0x2020000800000000), CONST64(0x2020000020000000), CONST64(0x2020000820000000),

934 
CONST64
(0x2020000000200000), CONST64(0x2020000800200000), CONST64(0x2020000020200000), CONST64(0x2020000820200000),

935 
CONST64
(0x2020000000002000), CONST64(0x2020000800002000), CONST64(0x2020000020002000), CONST64(0x2020000820002000),

936 
CONST64
(0x2020000000202000), CONST64(0x2020000800202000), CONST64(0x2020000020202000), CONST64(0x2020000820202000),

937 
CONST64
(0x2020000000000020), CONST64(0x2020000800000020), CONST64(0x2020000020000020), CONST64(0x2020000820000020),

938 
CONST64
(0x2020000000200020), CONST64(0x2020000800200020), CONST64(0x2020000020200020), CONST64(0x2020000820200020),

939 
CONST64
(0x2020000000002020), CONST64(0x2020000800002020), CONST64(0x2020000020002020), CONST64(0x2020000820002020),

940 
CONST64
(0x2020000000202020), CONST64(0x2020000800202020), CONST64(0x2020000020202020), CONST64(0x2020000820202020),

941 
CONST64
(0x0000200000000000), CONST64(0x0000200800000000), CONST64(0x0000200020000000), CONST64(0x0000200820000000),

942 
CONST64
(0x0000200000200000), CONST64(0x0000200800200000), CONST64(0x0000200020200000), CONST64(0x0000200820200000),

943 
CONST64
(0x0000200000002000), CONST64(0x0000200800002000), CONST64(0x0000200020002000), CONST64(0x0000200820002000),

944 
CONST64
(0x0000200000202000), CONST64(0x0000200800202000), CONST64(0x0000200020202000), CONST64(0x0000200820202000),

945 
CONST64
(0x0000200000000020), CONST64(0x0000200800000020), CONST64(0x0000200020000020), CONST64(0x0000200820000020),

946 
CONST64
(0x0000200000200020), CONST64(0x0000200800200020), CONST64(0x0000200020200020), CONST64(0x0000200820200020),

947 
CONST64
(0x0000200000002020), CONST64(0x0000200800002020), CONST64(0x0000200020002020), CONST64(0x0000200820002020),

948 
CONST64
(0x0000200000202020), CONST64(0x0000200800202020), CONST64(0x0000200020202020), CONST64(0x0000200820202020),

949 
CONST64
(0x2000200000000000), CONST64(0x2000200800000000), CONST64(0x2000200020000000), CONST64(0x2000200820000000),

950 
CONST64
(0x2000200000200000), CONST64(0x2000200800200000), CONST64(0x2000200020200000), CONST64(0x2000200820200000),

951 
CONST64
(0x2000200000002000), CONST64(0x2000200800002000), CONST64(0x2000200020002000), CONST64(0x2000200820002000),

952 
CONST64
(0x2000200000202000), CONST64(0x2000200800202000), CONST64(0x2000200020202000), CONST64(0x2000200820202000),

953 
CONST64
(0x2000200000000020), CONST64(0x2000200800000020), CONST64(0x2000200020000020), CONST64(0x2000200820000020),

954 
CONST64
(0x2000200000200020), CONST64(0x2000200800200020), CONST64(0x2000200020200020), CONST64(0x2000200820200020),

955 
CONST64
(0x2000200000002020), CONST64(0x2000200800002020), CONST64(0x2000200020002020), CONST64(0x2000200820002020),

956 
CONST64
(0x2000200000202020), CONST64(0x2000200800202020), CONST64(0x2000200020202020), CONST64(0x2000200820202020),

957 
CONST64
(0x0020200000000000), CONST64(0x0020200800000000), CONST64(0x0020200020000000), CONST64(0x0020200820000000),

958 
CONST64
(0x0020200000200000), CONST64(0x0020200800200000), CONST64(0x0020200020200000), CONST64(0x0020200820200000),

959 
CONST64
(0x0020200000002000), CONST64(0x0020200800002000), CONST64(0x0020200020002000), CONST64(0x0020200820002000),

960 
CONST64
(0x0020200000202000), CONST64(0x0020200800202000), CONST64(0x0020200020202000), CONST64(0x0020200820202000),

961 
CONST64
(0x0020200000000020), CONST64(0x0020200800000020), CONST64(0x0020200020000020), CONST64(0x0020200820000020),

962 
CONST64
(0x0020200000200020), CONST64(0x0020200800200020), CONST64(0x0020200020200020), CONST64(0x0020200820200020),

963 
CONST64
(0x0020200000002020), CONST64(0x0020200800002020), CONST64(0x0020200020002020), CONST64(0x0020200820002020),

964 
CONST64
(0x0020200000202020), CONST64(0x0020200800202020), CONST64(0x0020200020202020), CONST64(0x0020200820202020),

965 
CONST64
(0x2020200000000000), CONST64(0x2020200800000000), CONST64(0x2020200020000000), CONST64(0x2020200820000000),

966 
CONST64
(0x2020200000200000), CONST64(0x2020200800200000), CONST64(0x2020200020200000), CONST64(0x2020200820200000),

967 
CONST64
(0x2020200000002000), CONST64(0x2020200800002000), CONST64(0x2020200020002000), CONST64(0x2020200820002000),

968 
CONST64
(0x2020200000202000), CONST64(0x2020200800202000), CONST64(0x2020200020202000), CONST64(0x2020200820202000),

969 
CONST64
(0x2020200000000020), CONST64(0x2020200800000020), CONST64(0x2020200020000020), CONST64(0x2020200820000020),

970 
CONST64
(0x2020200000200020), CONST64(0x2020200800200020), CONST64(0x2020200020200020), CONST64(0x2020200820200020),

971 
CONST64
(0x2020200000002020), CONST64(0x2020200800002020), CONST64(0x2020200020002020), CONST64(0x2020200820002020),

972 
CONST64
(0x2020200000202020), CONST64(0x2020200800202020), CONST64(0x2020200020202020), CONST64(0x2020200820202020)

974 { 
CONST64
(0x0000000000000000), CONST64(0x0000002000000000), CONST64(0x0000000080000000), CONST64(0x0000002080000000),

975 
CONST64
(0x0000000000800000), CONST64(0x0000002000800000), CONST64(0x0000000080800000), CONST64(0x0000002080800000),

976 
CONST64
(0x0000000000008000), CONST64(0x0000002000008000), CONST64(0x0000000080008000), CONST64(0x0000002080008000),

977 
CONST64
(0x0000000000808000), CONST64(0x0000002000808000), CONST64(0x0000000080808000), CONST64(0x0000002080808000),

978 
CONST64
(0x0000000000000080), CONST64(0x0000002000000080), CONST64(0x0000000080000080), CONST64(0x0000002080000080),

979 
CONST64
(0x0000000000800080), CONST64(0x0000002000800080), CONST64(0x0000000080800080), CONST64(0x0000002080800080),

980 
CONST64
(0x0000000000008080), CONST64(0x0000002000008080), CONST64(0x0000000080008080), CONST64(0x0000002080008080),

981 
CONST64
(0x0000000000808080), CONST64(0x0000002000808080), CONST64(0x0000000080808080), CONST64(0x0000002080808080),

982 
CONST64
(0x8000000000000000), CONST64(0x8000002000000000), CONST64(0x8000000080000000), CONST64(0x8000002080000000),

983 
CONST64
(0x8000000000800000), CONST64(0x8000002000800000), CONST64(0x8000000080800000), CONST64(0x8000002080800000),

984 
CONST64
(0x8000000000008000), CONST64(0x8000002000008000), CONST64(0x8000000080008000), CONST64(0x8000002080008000),

985 
CONST64
(0x8000000000808000), CONST64(0x8000002000808000), CONST64(0x8000000080808000), CONST64(0x8000002080808000),

986 
CONST64
(0x8000000000000080), CONST64(0x8000002000000080), CONST64(0x8000000080000080), CONST64(0x8000002080000080),

987 
CONST64
(0x8000000000800080), CONST64(0x8000002000800080), CONST64(0x8000000080800080), CONST64(0x8000002080800080),

988 
CONST64
(0x8000000000008080), CONST64(0x8000002000008080), CONST64(0x8000000080008080), CONST64(0x8000002080008080),

989 
CONST64
(0x8000000000808080), CONST64(0x8000002000808080), CONST64(0x8000000080808080), CONST64(0x8000002080808080),

990 
CONST64
(0x0080000000000000), CONST64(0x0080002000000000), CONST64(0x0080000080000000), CONST64(0x0080002080000000),

991 
CONST64
(0x0080000000800000), CONST64(0x0080002000800000), CONST64(0x0080000080800000), CONST64(0x0080002080800000),

992 
CONST64
(0x0080000000008000), CONST64(0x0080002000008000), CONST64(0x0080000080008000), CONST64(0x0080002080008000),

993 
CONST64
(0x0080000000808000), CONST64(0x0080002000808000), CONST64(0x0080000080808000), CONST64(0x0080002080808000),

994 
CONST64
(0x0080000000000080), CONST64(0x0080002000000080), CONST64(0x0080000080000080), CONST64(0x0080002080000080),

995 
CONST64
(0x0080000000800080), CONST64(0x0080002000800080), CONST64(0x0080000080800080), CONST64(0x0080002080800080),

996 
CONST64
(0x0080000000008080), CONST64(0x0080002000008080), CONST64(0x0080000080008080), CONST64(0x0080002080008080),

997 
CONST64
(0x0080000000808080), CONST64(0x0080002000808080), CONST64(0x0080000080808080), CONST64(0x0080002080808080),

998 
CONST64
(0x8080000000000000), CONST64(0x8080002000000000), CONST64(0x8080000080000000), CONST64(0x8080002080000000),

999 
CONST64
(0x8080000000800000), CONST64(0x8080002000800000), CONST64(0x8080000080800000), CONST64(0x8080002080800000),

1000 
CONST64
(0x8080000000008000), CONST64(0x8080002000008000), CONST64(0x8080000080008000), CONST64(0x8080002080008000),

1001 
CONST64
(0x8080000000808000), CONST64(0x8080002000808000), CONST64(0x8080000080808000), CONST64(0x8080002080808000),

1002 
CONST64
(0x8080000000000080), CONST64(0x8080002000000080), CONST64(0x8080000080000080), CONST64(0x8080002080000080),

1003 
CONST64
(0x8080000000800080), CONST64(0x8080002000800080), CONST64(0x8080000080800080), CONST64(0x8080002080800080),

1004 
CONST64
(0x8080000000008080), CONST64(0x8080002000008080), CONST64(0x8080000080008080), CONST64(0x8080002080008080),

1005 
CONST64
(0x8080000000808080), CONST64(0x8080002000808080), CONST64(0x8080000080808080), CONST64(0x8080002080808080),

1006 
CONST64
(0x0000800000000000), CONST64(0x0000802000000000), CONST64(0x0000800080000000), CONST64(0x0000802080000000),

1007 
CONST64
(0x0000800000800000), CONST64(0x0000802000800000), CONST64(0x0000800080800000), CONST64(0x0000802080800000),

1008 
CONST64
(0x0000800000008000), CONST64(0x0000802000008000), CONST64(0x0000800080008000), CONST64(0x0000802080008000),

1009 
CONST64
(0x0000800000808000), CONST64(0x0000802000808000), CONST64(0x0000800080808000), CONST64(0x0000802080808000),

1010 
CONST64
(0x0000800000000080), CONST64(0x0000802000000080), CONST64(0x0000800080000080), CONST64(0x0000802080000080),

1011 
CONST64
(0x0000800000800080), CONST64(0x0000802000800080), CONST64(0x0000800080800080), CONST64(0x0000802080800080),

1012 
CONST64
(0x0000800000008080), CONST64(0x0000802000008080), CONST64(0x0000800080008080), CONST64(0x0000802080008080),

1013 
CONST64
(0x0000800000808080), CONST64(0x0000802000808080), CONST64(0x0000800080808080), CONST64(0x0000802080808080),

1014 
CONST64
(0x8000800000000000), CONST64(0x8000802000000000), CONST64(0x8000800080000000), CONST64(0x8000802080000000),

1015 
CONST64
(0x8000800000800000), CONST64(0x8000802000800000), CONST64(0x8000800080800000), CONST64(0x8000802080800000),

1016 
CONST64
(0x8000800000008000), CONST64(0x8000802000008000), CONST64(0x8000800080008000), CONST64(0x8000802080008000),

1017 
CONST64
(0x8000800000808000), CONST64(0x8000802000808000), CONST64(0x8000800080808000), CONST64(0x8000802080808000),

1018 
CONST64
(0x8000800000000080), CONST64(0x8000802000000080), CONST64(0x8000800080000080), CONST64(0x8000802080000080),

1019 
CONST64
(0x8000800000800080), CONST64(0x8000802000800080), CONST64(0x8000800080800080), CONST64(0x8000802080800080),

1020 
CONST64
(0x8000800000008080), CONST64(0x8000802000008080), CONST64(0x8000800080008080), CONST64(0x8000802080008080),

1021 
CONST64
(0x8000800000808080), CONST64(0x8000802000808080), CONST64(0x8000800080808080), CONST64(0x8000802080808080),

1022 
CONST64
(0x0080800000000000), CONST64(0x0080802000000000), CONST64(0x0080800080000000), CONST64(0x0080802080000000),

1023 
CONST64
(0x0080800000800000), CONST64(0x0080802000800000), CONST64(0x0080800080800000), CONST64(0x0080802080800000),

1024 
CONST64
(0x0080800000008000), CONST64(0x0080802000008000), CONST64(0x0080800080008000), CONST64(0x0080802080008000),

1025 
CONST64
(0x0080800000808000), CONST64(0x0080802000808000), CONST64(0x0080800080808000), CONST64(0x0080802080808000),

1026 
CONST64
(0x0080800000000080), CONST64(0x0080802000000080), CONST64(0x0080800080000080), CONST64(0x0080802080000080),

1027 
CONST64
(0x0080800000800080), CONST64(0x0080802000800080), CONST64(0x0080800080800080), CONST64(0x0080802080800080),

1028 
CONST64
(0x0080800000008080), CONST64(0x0080802000008080), CONST64(0x0080800080008080), CONST64(0x0080802080008080),

1029 
CONST64
(0x0080800000808080), CONST64(0x0080802000808080), CONST64(0x0080800080808080), CONST64(0x0080802080808080),

1030 
CONST64
(0x8080800000000000), CONST64(0x8080802000000000), CONST64(0x8080800080000000), CONST64(0x8080802080000000),

1031 
CONST64
(0x8080800000800000), CONST64(0x8080802000800000), CONST64(0x8080800080800000), CONST64(0x8080802080800000),

1032 
CONST64
(0x8080800000008000), CONST64(0x8080802000008000), CONST64(0x8080800080008000), CONST64(0x8080802080008000),

1033 
CONST64
(0x8080800000808000), CONST64(0x8080802000808000), CONST64(0x8080800080808000), CONST64(0x8080802080808000),

1034 
CONST64
(0x8080800000000080), CONST64(0x8080802000000080), CONST64(0x8080800080000080), CONST64(0x8080802080000080),

1035 
CONST64
(0x8080800000800080), CONST64(0x8080802000800080), CONST64(0x8080800080800080), CONST64(0x8080802080800080),

1036 
CONST64
(0x8080800000008080), CONST64(0x8080802000008080), CONST64(0x8080800080008080), CONST64(0x8080802080008080),

1037 
CONST64
(0x8080800000808080), CONST64(0x8080802000808080), CONST64(0x8080800080808080), CONST64(0x8080802080808080)

1039 { 
CONST64
(0x0000000000000000), CONST64(0x0000004000000000), CONST64(0x0000000001000000), CONST64(0x0000004001000000),

1040 
CONST64
(0x0000000000010000), CONST64(0x0000004000010000), CONST64(0x0000000001010000), CONST64(0x0000004001010000),

1041 
CONST64
(0x0000000000000100), CONST64(0x0000004000000100), CONST64(0x0000000001000100), CONST64(0x0000004001000100),

1042 
CONST64
(0x0000000000010100), CONST64(0x0000004000010100), CONST64(0x0000000001010100), CONST64(0x0000004001010100),

1043 
CONST64
(0x0000000000000001), CONST64(0x0000004000000001), CONST64(0x0000000001000001), CONST64(0x0000004001000001),

1044 
CONST64
(0x0000000000010001), CONST64(0x0000004000010001), CONST64(0x0000000001010001), CONST64(0x0000004001010001),

1045 
CONST64
(0x0000000000000101), CONST64(0x0000004000000101), CONST64(0x0000000001000101), CONST64(0x0000004001000101),

1046 
CONST64
(0x0000000000010101), CONST64(0x0000004000010101), CONST64(0x0000000001010101), CONST64(0x0000004001010101),

1047 
CONST64
(0x0100000000000000), CONST64(0x0100004000000000), CONST64(0x0100000001000000), CONST64(0x0100004001000000),

1048 
CONST64
(0x0100000000010000), CONST64(0x0100004000010000), CONST64(0x0100000001010000), CONST64(0x0100004001010000),

1049 
CONST64
(0x0100000000000100), CONST64(0x0100004000000100), CONST64(0x0100000001000100), CONST64(0x0100004001000100),

1050 
CONST64
(0x0100000000010100), CONST64(0x0100004000010100), CONST64(0x0100000001010100), CONST64(0x0100004001010100),

1051 
CONST64
(0x0100000000000001), CONST64(0x0100004000000001), CONST64(0x0100000001000001), CONST64(0x0100004001000001),

1052 
CONST64
(0x0100000000010001), CONST64(0x0100004000010001), CONST64(0x0100000001010001), CONST64(0x0100004001010001),

1053 
CONST64
(0x0100000000000101), CONST64(0x0100004000000101), CONST64(0x0100000001000101), CONST64(0x0100004001000101),

1054 
CONST64
(0x0100000000010101), CONST64(0x0100004000010101), CONST64(0x0100000001010101), CONST64(0x0100004001010101),

1055 
CONST64
(0x0001000000000000), CONST64(0x0001004000000000), CONST64(0x0001000001000000), CONST64(0x0001004001000000),

1056 
CONST64
(0x0001000000010000), CONST64(0x0001004000010000), CONST64(0x0001000001010000), CONST64(0x0001004001010000),

1057 
CONST64
(0x0001000000000100), CONST64(0x0001004000000100), CONST64(0x0001000001000100), CONST64(0x0001004001000100),

1058 
CONST64
(0x0001000000010100), CONST64(0x0001004000010100), CONST64(0x0001000001010100), CONST64(0x0001004001010100),

1059 
CONST64
(0x0001000000000001), CONST64(0x0001004000000001), CONST64(0x0001000001000001), CONST64(0x0001004001000001),

1060 
CONST64
(0x0001000000010001), CONST64(0x0001004000010001), CONST64(0x0001000001010001), CONST64(0x0001004001010001),

1061 
CONST64
(0x0001000000000101), CONST64(0x0001004000000101), CONST64(0x0001000001000101), CONST64(0x0001004001000101),

1062 
CONST64
(0x0001000000010101), CONST64(0x0001004000010101), CONST64(0x0001000001010101), CONST64(0x0001004001010101),

1063 
CONST64
(0x0101000000000000), CONST64(0x0101004000000000), CONST64(0x0101000001000000), CONST64(0x0101004001000000),

1064 
CONST64
(0x0101000000010000), CONST64(0x0101004000010000), CONST64(0x0101000001010000), CONST64(0x0101004001010000),

1065 
CONST64
(0x0101000000000100), CONST64(0x0101004000000100), CONST64(0x0101000001000100), CONST64(0x0101004001000100),

1066 
CONST64
(0x0101000000010100), CONST64(0x0101004000010100), CONST64(0x0101000001010100), CONST64(0x0101004001010100),

1067 
CONST64
(0x0101000000000001), CONST64(0x0101004000000001), CONST64(0x0101000001000001), CONST64(0x0101004001000001),

1068 
CONST64
(0x0101000000010001), CONST64(0x0101004000010001), CONST64(0x0101000001010001), CONST64(0x0101004001010001),

1069 
CONST64
(0x0101000000000101), CONST64(0x0101004000000101), CONST64(0x0101000001000101), CONST64(0x0101004001000101),

1070 
CONST64
(0x0101000000010101), CONST64(0x0101004000010101), CONST64(0x0101000001010101), CONST64(0x0101004001010101),

1071 
CONST64
(0x0000010000000000), CONST64(0x0000014000000000), CONST64(0x0000010001000000), CONST64(0x0000014001000000),

1072 
CONST64
(0x0000010000010000), CONST64(0x0000014000010000), CONST64(0x0000010001010000), CONST64(0x0000014001010000),

1073 
CONST64
(0x0000010000000100), CONST64(0x0000014000000100), CONST64(0x0000010001000100), CONST64(0x0000014001000100),

1074 
CONST64
(0x0000010000010100), CONST64(0x0000014000010100), CONST64(0x0000010001010100), CONST64(0x0000014001010100),

1075 
CONST64
(0x0000010000000001), CONST64(0x0000014000000001), CONST64(0x0000010001000001), CONST64(0x0000014001000001),

1076 
CONST64
(0x0000010000010001), CONST64(0x0000014000010001), CONST64(0x0000010001010001), CONST64(0x0000014001010001),

1077 
CONST64
(0x0000010000000101), CONST64(0x0000014000000101), CONST64(0x0000010001000101), CONST64(0x0000014001000101),

1078 
CONST64
(0x0000010000010101), CONST64(0x0000014000010101), CONST64(0x0000010001010101), CONST64(0x0000014001010101),

1079 
CONST64
(0x0100010000000000), CONST64(0x0100014000000000), CONST64(0x0100010001000000), CONST64(0x0100014001000000),

1080 
CONST64
(0x0100010000010000), CONST64(0x0100014000010000), CONST64(0x0100010001010000), CONST64(0x0100014001010000),

1081 
CONST64
(0x0100010000000100), CONST64(0x0100014000000100), CONST64(0x0100010001000100), CONST64(0x0100014001000100),

1082 
CONST64
(0x0100010000010100), CONST64(0x0100014000010100), CONST64(0x0100010001010100), CONST64(0x0100014001010100),

1083 
CONST64
(0x0100010000000001), CONST64(0x0100014000000001), CONST64(0x0100010001000001), CONST64(0x0100014001000001),

1084 
CONST64
(0x0100010000010001), CONST64(0x0100014000010001), CONST64(0x0100010001010001), CONST64(0x0100014001010001),

1085 
CONST64
(0x0100010000000101), CONST64(0x0100014000000101), CONST64(0x0100010001000101), CONST64(0x0100014001000101),

1086 
CONST64
(0x0100010000010101), CONST64(0x0100014000010101), CONST64(0x0100010001010101), CONST64(0x0100014001010101),

1087 
CONST64
(0x0001010000000000), CONST64(0x0001014000000000), CONST64(0x0001010001000000), CONST64(0x0001014001000000),

1088 
CONST64
(0x0001010000010000), CONST64(0x0001014000010000), CONST64(0x0001010001010000), CONST64(0x0001014001010000),

1089 
CONST64
(0x0001010000000100), CONST64(0x0001014000000100), CONST64(0x0001010001000100), CONST64(0x0001014001000100),

1090 
CONST64
(0x0001010000010100), CONST64(0x0001014000010100), CONST64(0x0001010001010100), CONST64(0x0001014001010100),

1091 
CONST64
(0x0001010000000001), CONST64(0x0001014000000001), CONST64(0x0001010001000001), CONST64(0x0001014001000001),

1092 
CONST64
(0x0001010000010001), CONST64(0x0001014000010001), CONST64(0x0001010001010001), CONST64(0x0001014001010001),

1093 
CONST64
(0x0001010000000101), CONST64(0x0001014000000101), CONST64(0x0001010001000101), CONST64(0x0001014001000101),

1094 
CONST64
(0x0001010000010101), CONST64(0x0001014000010101), CONST64(0x0001010001010101), CONST64(0x0001014001010101),

1095 
CONST64
(0x0101010000000000), CONST64(0x0101014000000000), CONST64(0x0101010001000000), CONST64(0x0101014001000000),

1096 
CONST64
(0x0101010000010000), CONST64(0x0101014000010000), CONST64(0x0101010001010000), CONST64(0x0101014001010000),

1097 
CONST64
(0x0101010000000100), CONST64(0x0101014000000100), CONST64(0x0101010001000100), CONST64(0x0101014001000100),

1098 
CONST64
(0x0101010000010100), CONST64(0x0101014000010100), CONST64(0x0101010001010100), CONST64(0x0101014001010100),

1099 
CONST64
(0x0101010000000001), CONST64(0x0101014000000001), CONST64(0x0101010001000001), CONST64(0x0101014001000001),

1100 
CONST64
(0x0101010000010001), CONST64(0x0101014000010001), CONST64(0x0101010001010001), CONST64(0x0101014001010001),

1101 
CONST64
(0x0101010000000101), CONST64(0x0101014000000101), CONST64(0x0101010001000101), CONST64(0x0101014001000101),

1102 
CONST64
(0x0101010000010101), CONST64(0x0101014000010101), CONST64(0x0101010001010101), CONST64(0x0101014001010101)

1104 { 
CONST64
(0x0000000000000000), CONST64(0x0000000100000000), CONST64(0x0000000004000000), CONST64(0x0000000104000000),

1105 
CONST64
(0x0000000000040000), CONST64(0x0000000100040000), CONST64(0x0000000004040000), CONST64(0x0000000104040000),

1106 
CONST64
(0x0000000000000400), CONST64(0x0000000100000400), CONST64(0x0000000004000400), CONST64(0x0000000104000400),

1107 
CONST64
(0x0000000000040400), CONST64(0x0000000100040400), CONST64(0x0000000004040400), CONST64(0x0000000104040400),

1108 
CONST64
(0x0000000000000004), CONST64(0x0000000100000004), CONST64(0x0000000004000004), CONST64(0x0000000104000004),

1109 
CONST64
(0x0000000000040004), CONST64(0x0000000100040004), CONST64(0x0000000004040004), CONST64(0x0000000104040004),

1110 
CONST64
(0x0000000000000404), CONST64(0x0000000100000404), CONST64(0x0000000004000404), CONST64(0x0000000104000404),

1111 
CONST64
(0x0000000000040404), CONST64(0x0000000100040404), CONST64(0x0000000004040404), CONST64(0x0000000104040404),

1112 
CONST64
(0x0400000000000000), CONST64(0x0400000100000000), CONST64(0x0400000004000000), CONST64(0x0400000104000000),

1113 
CONST64
(0x0400000000040000), CONST64(0x0400000100040000), CONST64(0x0400000004040000), CONST64(0x0400000104040000),

1114 
CONST64
(0x0400000000000400), CONST64(0x0400000100000400), CONST64(0x0400000004000400), CONST64(0x0400000104000400),

1115 
CONST64
(0x0400000000040400), CONST64(0x0400000100040400), CONST64(0x0400000004040400), CONST64(0x0400000104040400),

1116 
CONST64
(0x0400000000000004), CONST64(0x0400000100000004), CONST64(0x0400000004000004), CONST64(0x0400000104000004),

1117 
CONST64
(0x0400000000040004), CONST64(0x0400000100040004), CONST64(0x0400000004040004), CONST64(0x0400000104040004),

1118 
CONST64
(0x0400000000000404), CONST64(0x0400000100000404), CONST64(0x0400000004000404), CONST64(0x0400000104000404),

1119 
CONST64
(0x0400000000040404), CONST64(0x0400000100040404), CONST64(0x0400000004040404), CONST64(0x0400000104040404),

1120 
CONST64
(0x0004000000000000), CONST64(0x0004000100000000), CONST64(0x0004000004000000), CONST64(0x0004000104000000),

1121 
CONST64
(0x0004000000040000), CONST64(0x0004000100040000), CONST64(0x0004000004040000), CONST64(0x0004000104040000),

1122 
CONST64
(0x0004000000000400), CONST64(0x0004000100000400), CONST64(0x0004000004000400), CONST64(0x0004000104000400),

1123 
CONST64
(0x0004000000040400), CONST64(0x0004000100040400), CONST64(0x0004000004040400), CONST64(0x0004000104040400),

1124 
CONST64
(0x0004000000000004), CONST64(0x0004000100000004), CONST64(0x0004000004000004), CONST64(0x0004000104000004),

1125 
CONST64
(0x0004000000040004), CONST64(0x0004000100040004), CONST64(0x0004000004040004), CONST64(0x0004000104040004),

1126 
CONST64
(0x0004000000000404), CONST64(0x0004000100000404), CONST64(0x0004000004000404), CONST64(0x0004000104000404),

1127 
CONST64
(0x0004000000040404), CONST64(0x0004000100040404), CONST64(0x0004000004040404), CONST64(0x0004000104040404),

1128 
CONST64
(0x0404000000000000), CONST64(0x0404000100000000), CONST64(0x0404000004000000), CONST64(0x0404000104000000),

1129 
CONST64
(0x0404000000040000), CONST64(0x0404000100040000), CONST64(0x0404000004040000), CONST64(0x0404000104040000),

1130 
CONST64
(0x0404000000000400), CONST64(0x0404000100000400), CONST64(0x0404000004000400), CONST64(0x0404000104000400),

1131 
CONST64
(0x0404000000040400), CONST64(0x0404000100040400), CONST64(0x0404000004040400), CONST64(0x0404000104040400),

1132 
CONST64
(0x0404000000000004), CONST64(0x0404000100000004), CONST64(0x0404000004000004), CONST64(0x0404000104000004),

1133 
CONST64
(0x0404000000040004), CONST64(0x0404000100040004), CONST64(0x0404000004040004), CONST64(0x0404000104040004),

1134 
CONST64
(0x0404000000000404), CONST64(0x0404000100000404), CONST64(0x0404000004000404), CONST64(0x0404000104000404),

1135 
CONST64
(0x0404000000040404), CONST64(0x0404000100040404), CONST64(0x0404000004040404), CONST64(0x0404000104040404),

1136 
CONST64
(0x0000040000000000), CONST64(0x0000040100000000), CONST64(0x0000040004000000), CONST64(0x0000040104000000),

1137 
CONST64
(0x0000040000040000), CONST64(0x0000040100040000), CONST64(0x0000040004040000), CONST64(0x0000040104040000),

1138 
CONST64
(0x0000040000000400), CONST64(0x0000040100000400), CONST64(0x0000040004000400), CONST64(0x0000040104000400),

1139 
CONST64
(0x0000040000040400), CONST64(0x0000040100040400), CONST64(0x0000040004040400), CONST64(0x0000040104040400),

1140 
CONST64
(0x0000040000000004), CONST64(0x0000040100000004), CONST64(0x0000040004000004), CONST64(0x0000040104000004),

1141 
CONST64
(0x0000040000040004), CONST64(0x0000040100040004), CONST64(0x0000040004040004), CONST64(0x0000040104040004),

1142 
CONST64
(0x0000040000000404), CONST64(0x0000040100000404), CONST64(0x0000040004000404), CONST64(0x0000040104000404),

1143 
CONST64
(0x0000040000040404), CONST64(0x0000040100040404), CONST64(0x0000040004040404), CONST64(0x0000040104040404),

1144 
CONST64
(0x0400040000000000), CONST64(0x0400040100000000), CONST64(0x0400040004000000), CONST64(0x0400040104000000),

1145 
CONST64
(0x0400040000040000), CONST64(0x0400040100040000), CONST64(0x0400040004040000), CONST64(0x0400040104040000),

1146 
CONST64
(0x0400040000000400), CONST64(0x0400040100000400), CONST64(0x0400040004000400), CONST64(0x0400040104000400),

1147 
CONST64
(0x0400040000040400), CONST64(0x0400040100040400), CONST64(0x0400040004040400), CONST64(0x0400040104040400),

1148 
CONST64
(0x0400040000000004), CONST64(0x0400040100000004), CONST64(0x0400040004000004), CONST64(0x0400040104000004),

1149 
CONST64
(0x0400040000040004), CONST64(0x0400040100040004), CONST64(0x0400040004040004), CONST64(0x0400040104040004),

1150 
CONST64
(0x0400040000000404), CONST64(0x0400040100000404), CONST64(0x0400040004000404), CONST64(0x0400040104000404),

1151 
CONST64
(0x0400040000040404), CONST64(0x0400040100040404), CONST64(0x0400040004040404), CONST64(0x0400040104040404),

1152 
CONST64
(0x0004040000000000), CONST64(0x0004040100000000), CONST64(0x0004040004000000), CONST64(0x0004040104000000),

1153 
CONST64
(0x0004040000040000), CONST64(0x0004040100040000), CONST64(0x0004040004040000), CONST64(0x0004040104040000),

1154 
CONST64
(0x0004040000000400), CONST64(0x0004040100000400), CONST64(0x0004040004000400), CONST64(0x0004040104000400),

1155 
CONST64
(0x0004040000040400), CONST64(0x0004040100040400), CONST64(0x0004040004040400), CONST64(0x0004040104040400),

1156 
CONST64
(0x0004040000000004), CONST64(0x0004040100000004), CONST64(0x0004040004000004), CONST64(0x0004040104000004),

1157 
CONST64
(0x0004040000040004), CONST64(0x0004040100040004), CONST64(0x0004040004040004), CONST64(0x0004040104040004),

1158 
CONST64
(0x0004040000000404), CONST64(0x0004040100000404), CONST64(0x0004040004000404), CONST64(0x0004040104000404),

1159 
CONST64
(0x0004040000040404), CONST64(0x0004040100040404), CONST64(0x0004040004040404), CONST64(0x0004040104040404),

1160 
CONST64
(0x0404040000000000), CONST64(0x0404040100000000), CONST64(0x0404040004000000), CONST64(0x0404040104000000),

1161 
CONST64
(0x0404040000040000), CONST64(0x0404040100040000), CONST64(0x0404040004040000), CONST64(0x0404040104040000),

1162 
CONST64
(0x0404040000000400), CONST64(0x0404040100000400), CONST64(0x0404040004000400), CONST64(0x0404040104000400),

1163 
CONST64
(0x0404040000040400), CONST64(0x0404040100040400), CONST64(0x0404040004040400), CONST64(0x0404040104040400),

1164 
CONST64
(0x0404040000000004), CONST64(0x0404040100000004), CONST64(0x0404040004000004), CONST64(0x0404040104000004),

1165 
CONST64
(0x0404040000040004), CONST64(0x0404040100040004), CONST64(0x0404040004040004), CONST64(0x0404040104040004),

1166 
CONST64
(0x0404040000000404), CONST64(0x0404040100000404), CONST64(0x0404040004000404), CONST64(0x0404040104000404),

1167 
CONST64
(0x0404040000040404), CONST64(0x0404040100040404), CONST64(0x0404040004040404), CONST64(0x0404040104040404)

1169 { 
CONST64
(0x0000000000000000), CONST64(0x0000000400000000), CONST64(0x0000000010000000), CONST64(0x0000000410000000),

1170 
CONST64
(0x0000000000100000), CONST64(0x0000000400100000), CONST64(0x0000000010100000), CONST64(0x0000000410100000),

1171 
CONST64
(0x0000000000001000), CONST64(0x0000000400001000), CONST64(0x0000000010001000), CONST64(0x0000000410001000),

1172 
CONST64
(0x0000000000101000), CONST64(0x0000000400101000), CONST64(0x0000000010101000), CONST64(0x0000000410101000),

1173 
CONST64
(0x0000000000000010), CONST64(0x0000000400000010), CONST64(0x0000000010000010), CONST64(0x0000000410000010),

1174 
CONST64
(0x0000000000100010), CONST64(0x0000000400100010), CONST64(0x0000000010100010), CONST64(0x0000000410100010),

1175 
CONST64
(0x0000000000001010), CONST64(0x0000000400001010), CONST64(0x0000000010001010), CONST64(0x0000000410001010),

1176 
CONST64
(0x0000000000101010), CONST64(0x0000000400101010), CONST64(0x0000000010101010), CONST64(0x0000000410101010),

1177 
CONST64
(0x1000000000000000), CONST64(0x1000000400000000), CONST64(0x1000000010000000), CONST64(0x1000000410000000),

1178 
CONST64
(0x1000000000100000), CONST64(0x1000000400100000), CONST64(0x1000000010100000), CONST64(0x1000000410100000),

1179 
CONST64
(0x1000000000001000), CONST64(0x1000000400001000), CONST64(0x1000000010001000), CONST64(0x1000000410001000),

1180 
CONST64
(0x1000000000101000), CONST64(0x1000000400101000), CONST64(0x1000000010101000), CONST64(0x1000000410101000),

1181 
CONST64
(0x1000000000000010), CONST64(0x1000000400000010), CONST64(0x1000000010000010), CONST64(0x1000000410000010),

1182 
CONST64
(0x1000000000100010), CONST64(0x1000000400100010), CONST64(0x1000000010100010), CONST64(0x1000000410100010),

1183 
CONST64
(0x1000000000001010), CONST64(0x1000000400001010), CONST64(0x1000000010001010), CONST64(0x1000000410001010),

1184 
CONST64
(0x1000000000101010), CONST64(0x1000000400101010), CONST64(0x1000000010101010), CONST64(0x1000000410101010),

1185 
CONST64
(0x0010000000000000), CONST64(0x0010000400000000), CONST64(0x0010000010000000), CONST64(0x0010000410000000),

1186 
CONST64
(0x0010000000100000), CONST64(0x0010000400100000), CONST64(0x0010000010100000), CONST64(0x0010000410100000),

1187 
CONST64
(0x0010000000001000), CONST64(0x0010000400001000), CONST64(0x0010000010001000), CONST64(0x0010000410001000),

1188 
CONST64
(0x0010000000101000), CONST64(0x0010000400101000), CONST64(0x0010000010101000), CONST64(0x0010000410101000),

1189 
CONST64
(0x0010000000000010), CONST64(0x0010000400000010), CONST64(0x0010000010000010), CONST64(0x0010000410000010),

1190 
CONST64
(0x0010000000100010), CONST64(0x0010000400100010), CONST64(0x0010000010100010), CONST64(0x0010000410100010),

1191 
CONST64
(0x0010000000001010), CONST64(0x0010000400001010), CONST64(0x0010000010001010), CONST64(0x0010000410001010),

1192 
CONST64
(0x0010000000101010), CONST64(0x0010000400101010), CONST64(0x0010000010101010), CONST64(0x0010000410101010),

1193 
CONST64
(0x1010000000000000), CONST64(0x1010000400000000), CONST64(0x1010000010000000), CONST64(0x1010000410000000),

1194 
CONST64
(0x1010000000100000), CONST64(0x1010000400100000), CONST64(0x1010000010100000), CONST64(0x1010000410100000),

1195 
CONST64
(0x1010000000001000), CONST64(0x1010000400001000), CONST64(0x1010000010001000), CONST64(0x1010000410001000),

1196 
CONST64
(0x1010000000101000), CONST64(0x1010000400101000), CONST64(0x1010000010101000), CONST64(0x1010000410101000),

1197 
CONST64
(0x1010000000000010), CONST64(0x1010000400000010), CONST64(0x1010000010000010), CONST64(0x1010000410000010),

1198 
CONST64
(0x1010000000100010), CONST64(0x1010000400100010), CONST64(0x1010000010100010), CONST64(0x1010000410100010),

1199 
CONST64
(0x1010000000001010), CONST64(0x1010000400001010), CONST64(0x1010000010001010), CONST64(0x1010000410001010),

1200 
CONST64
(0x1010000000101010), CONST64(0x1010000400101010), CONST64(0x1010000010101010), CONST64(0x1010000410101010),

1201 
CONST64
(0x0000100000000000), CONST64(0x0000100400000000), CONST64(0x0000100010000000), CONST64(0x0000100410000000),

1202 
CONST64
(0x0000100000100000), CONST64(0x0000100400100000), CONST64(0x0000100010100000), CONST64(0x0000100410100000),

1203 
CONST64
(0x0000100000001000), CONST64(0x0000100400001000), CONST64(0x0000100010001000), CONST64(0x0000100410001000),

1204 
CONST64
(0x0000100000101000), CONST64(0x0000100400101000), CONST64(0x0000100010101000), CONST64(0x0000100410101000),

1205 
CONST64
(0x0000100000000010), CONST64(0x0000100400000010), CONST64(0x0000100010000010), CONST64(0x0000100410000010),

1206 
CONST64
(0x0000100000100010), CONST64(0x0000100400100010), CONST64(0x0000100010100010), CONST64(0x0000100410100010),

1207 
CONST64
(0x0000100000001010), CONST64(0x0000100400001010), CONST64(0x0000100010001010), CONST64(0x0000100410001010),

1208 
CONST64
(0x0000100000101010), CONST64(0x0000100400101010), CONST64(0x0000100010101010), CONST64(0x0000100410101010),

1209 
CONST64
(0x1000100000000000), CONST64(0x1000100400000000), CONST64(0x1000100010000000), CONST64(0x1000100410000000),

1210 
CONST64
(0x1000100000100000), CONST64(0x1000100400100000), CONST64(0x1000100010100000), CONST64(0x1000100410100000),

1211 
CONST64
(0x1000100000001000), CONST64(0x1000100400001000), CONST64(0x1000100010001000), CONST64(0x1000100410001000),

1212 
CONST64
(0x1000100000101000), CONST64(0x1000100400101000), CONST64(0x1000100010101000), CONST64(0x1000100410101000),

1213 
CONST64
(0x1000100000000010), CONST64(0x1000100400000010), CONST64(0x1000100010000010), CONST64(0x1000100410000010),

1214 
CONST64
(0x1000100000100010), CONST64(0x1000100400100010), CONST64(0x1000100010100010), CONST64(0x1000100410100010),

1215 
CONST64
(0x1000100000001010), CONST64(0x1000100400001010), CONST64(0x1000100010001010), CONST64(0x1000100410001010),

1216 
CONST64
(0x1000100000101010), CONST64(0x1000100400101010), CONST64(0x1000100010101010), CONST64(0x1000100410101010),

1217 
CONST64
(0x0010100000000000), CONST64(0x0010100400000000), CONST64(0x0010100010000000), CONST64(0x0010100410000000),

1218 
CONST64
(0x0010100000100000), CONST64(0x0010100400100000), CONST64(0x0010100010100000), CONST64(0x0010100410100000),

1219 
CONST64
(0x0010100000001000), CONST64(0x0010100400001000), CONST64(0x0010100010001000), CONST64(0x0010100410001000),

1220 
CONST64
(0x0010100000101000), CONST64(0x0010100400101000), CONST64(0x0010100010101000), CONST64(0x0010100410101000),

1221 
CONST64
(0x0010100000000010), CONST64(0x0010100400000010), CONST64(0x0010100010000010), CONST64(0x0010100410000010),

1222 
CONST64
(0x0010100000100010), CONST64(0x0010100400100010), CONST64(0x0010100010100010), CONST64(0x0010100410100010),

1223 
CONST64
(0x0010100000001010), CONST64(0x0010100400001010), CONST64(0x0010100010001010), CONST64(0x0010100410001010),

1224 
CONST64
(0x0010100000101010), CONST64(0x0010100400101010), CONST64(0x0010100010101010), CONST64(0x0010100410101010),

1225 
CONST64
(0x1010100000000000), CONST64(0x1010100400000000), CONST64(0x1010100010000000), CONST64(0x1010100410000000),

1226 
CONST64
(0x1010100000100000), CONST64(0x1010100400100000), CONST64(0x1010100010100000), CONST64(0x1010100410100000),

1227 
CONST64
(0x1010100000001000), CONST64(0x1010100400001000), CONST64(0x1010100010001000), CONST64(0x1010100410001000),

1228 
CONST64
(0x1010100000101000), CONST64(0x1010100400101000), CONST64(0x1010100010101000), CONST64(0x1010100410101000),

1229 
CONST64
(0x1010100000000010), CONST64(0x1010100400000010), CONST64(0x1010100010000010), CONST64(0x1010100410000010),

1230 
CONST64
(0x1010100000100010), CONST64(0x1010100400100010), CONST64(0x1010100010100010), CONST64(0x1010100410100010),

1231 
CONST64
(0x1010100000001010), CONST64(0x1010100400001010), CONST64(0x1010100010001010), CONST64(0x1010100410001010),

1232 
CONST64
(0x1010100000101010), CONST64(0x1010100400101010), CONST64(0x1010100010101010), CONST64(0x1010100410101010)

1234 { 
CONST64
(0x0000000000000000), CONST64(0x0000001000000000), CONST64(0x0000000040000000), CONST64(0x0000001040000000),

1235 
CONST64
(0x0000000000400000), CONST64(0x0000001000400000), CONST64(0x0000000040400000), CONST64(0x0000001040400000),

1236 
CONST64
(0x0000000000004000), CONST64(0x0000001000004000), CONST64(0x0000000040004000), CONST64(0x0000001040004000),

1237 
CONST64
(0x0000000000404000), CONST64(0x0000001000404000), CONST64(0x0000000040404000), CONST64(0x0000001040404000),

1238 
CONST64
(0x0000000000000040), CONST64(0x0000001000000040), CONST64(0x0000000040000040), CONST64(0x0000001040000040),

1239 
CONST64
(0x0000000000400040), CONST64(0x0000001000400040), CONST64(0x0000000040400040), CONST64(0x0000001040400040),

1240 
CONST64
(0x0000000000004040), CONST64(0x0000001000004040), CONST64(0x0000000040004040), CONST64(0x0000001040004040),

1241 
CONST64
(0x0000000000404040), CONST64(0x0000001000404040), CONST64(0x0000000040404040), CONST64(0x0000001040404040),

1242 
CONST64
(0x4000000000000000), CONST64(0x4000001000000000), CONST64(0x4000000040000000), CONST64(0x4000001040000000),

1243 
CONST64
(0x4000000000400000), CONST64(0x4000001000400000), CONST64(0x4000000040400000), CONST64(0x4000001040400000),

1244 
CONST64
(0x4000000000004000), CONST64(0x4000001000004000), CONST64(0x4000000040004000), CONST64(0x4000001040004000),

1245 
CONST64
(0x4000000000404000), CONST64(0x4000001000404000), CONST64(0x4000000040404000), CONST64(0x4000001040404000),

1246 
CONST64
(0x4000000000000040), CONST64(0x4000001000000040), CONST64(0x4000000040000040), CONST64(0x4000001040000040),

1247 
CONST64
(0x4000000000400040), CONST64(0x4000001000400040), CONST64(0x4000000040400040), CONST64(0x4000001040400040),

1248 
CONST64
(0x4000000000004040), CONST64(0x4000001000004040), CONST64(0x4000000040004040), CONST64(0x4000001040004040),

1249 
CONST64
(0x4000000000404040), CONST64(0x4000001000404040), CONST64(0x4000000040404040), CONST64(0x4000001040404040),

1250 
CONST64
(0x0040000000000000), CONST64(0x0040001000000000), CONST64(0x0040000040000000), CONST64(0x0040001040000000),

1251 
CONST64
(0x0040000000400000), CONST64(0x0040001000400000), CONST64(0x0040000040400000), CONST64(0x0040001040400000),

1252 
CONST64
(0x0040000000004000), CONST64(0x0040001000004000), CONST64(0x0040000040004000), CONST64(0x0040001040004000),

1253 
CONST64
(0x0040000000404000), CONST64(0x0040001000404000), CONST64(0x0040000040404000), CONST64(0x0040001040404000),

1254 
CONST64
(0x0040000000000040), CONST64(0x0040001000000040), CONST64(0x0040000040000040), CONST64(0x0040001040000040),

1255 
CONST64
(0x0040000000400040), CONST64(0x0040001000400040), CONST64(0x0040000040400040), CONST64(0x0040001040400040),

1256 
CONST64
(0x0040000000004040), CONST64(0x0040001000004040), CONST64(0x0040000040004040), CONST64(0x0040001040004040),

1257 
CONST64
(0x0040000000404040), CONST64(0x0040001000404040), CONST64(0x0040000040404040), CONST64(0x0040001040404040),

1258 
CONST64
(0x4040000000000000), CONST64(0x4040001000000000), CONST64(0x4040000040000000), CONST64(0x4040001040000000),

1259 
CONST64
(0x4040000000400000), CONST64(0x4040001000400000), CONST64(0x4040000040400000), CONST64(0x4040001040400000),

1260 
CONST64
(0x4040000000004000), CONST64(0x4040001000004000), CONST64(0x4040000040004000), CONST64(0x4040001040004000),

1261 
CONST64
(0x4040000000404000), CONST64(0x4040001000404000), CONST64(0x4040000040404000), CONST64(0x4040001040404000),

1262 
CONST64
(0x4040000000000040), CONST64(0x4040001000000040), CONST64(0x4040000040000040), CONST64(0x4040001040000040),

1263 
CONST64
(0x4040000000400040), CONST64(0x4040001000400040), CONST64(0x4040000040400040), CONST64(0x4040001040400040),

1264 
CONST64
(0x4040000000004040), CONST64(0x4040001000004040), CONST64(0x4040000040004040), CONST64(0x4040001040004040),

1265 
CONST64
(0x4040000000404040), CONST64(0x4040001000404040), CONST64(0x4040000040404040), CONST64(0x4040001040404040),

1266 
CONST64
(0x0000400000000000), CONST64(0x0000401000000000), CONST64(0x0000400040000000), CONST64(0x0000401040000000),

1267 
CONST64
(0x0000400000400000), CONST64(0x0000401000400000), CONST64(0x0000400040400000), CONST64(0x0000401040400000),

1268 
CONST64
(0x0000400000004000), CONST64(0x0000401000004000), CONST64(0x0000400040004000), CONST64(0x0000401040004000),

1269 
CONST64
(0x0000400000404000), CONST64(0x0000401000404000), CONST64(0x0000400040404000), CONST64(0x0000401040404000),

1270 
CONST64
(0x0000400000000040), CONST64(0x0000401000000040), CONST64(0x0000400040000040), CONST64(0x0000401040000040),

1271 
CONST64
(0x0000400000400040), CONST64(0x0000401000400040), CONST64(0x0000400040400040), CONST64(0x0000401040400040),

1272 
CONST64
(0x0000400000004040), CONST64(0x0000401000004040), CONST64(0x0000400040004040), CONST64(0x0000401040004040),

1273 
CONST64
(0x0000400000404040), CONST64(0x0000401000404040), CONST64(0x0000400040404040), CONST64(0x0000401040404040),

1274 
CONST64
(0x4000400000000000), CONST64(0x4000401000000000), CONST64(0x4000400040000000), CONST64(0x4000401040000000),

1275 
CONST64
(0x4000400000400000), CONST64(0x4000401000400000), CONST64(0x4000400040400000), CONST64(0x4000401040400000),

1276 
CONST64
(0x4000400000004000), CONST64(0x4000401000004000), CONST64(0x4000400040004000), CONST64(0x4000401040004000),

1277 
CONST64
(0x4000400000404000), CONST64(0x4000401000404000), CONST64(0x4000400040404000), CONST64(0x4000401040404000),

1278 
CONST64
(0x4000400000000040), CONST64(0x4000401000000040), CONST64(0x4000400040000040), CONST64(0x4000401040000040),

1279 
CONST64
(0x4000400000400040), CONST64(0x4000401000400040), CONST64(0x4000400040400040), CONST64(0x4000401040400040),

1280 
CONST64
(0x4000400000004040), CONST64(0x4000401000004040), CONST64(0x4000400040004040), CONST64(0x4000401040004040),

1281 
CONST64
(0x4000400000404040), CONST64(0x4000401000404040), CONST64(0x4000400040404040), CONST64(0x4000401040404040),

1282 
CONST64
(0x0040400000000000), CONST64(0x0040401000000000), CONST64(0x0040400040000000), CONST64(0x0040401040000000),

1283 
CONST64
(0x0040400000400000), CONST64(0x0040401000400000), CONST64(0x0040400040400000), CONST64(0x0040401040400000),

1284 
CONST64
(0x0040400000004000), CONST64(0x0040401000004000), CONST64(0x0040400040004000), CONST64(0x0040401040004000),

1285 
CONST64
(0x0040400000404000), CONST64(0x0040401000404000), CONST64(0x0040400040404000), CONST64(0x0040401040404000),

1286 
CONST64
(0x0040400000000040), CONST64(0x0040401000000040), CONST64(0x0040400040000040), CONST64(0x0040401040000040),

1287 
CONST64
(0x0040400000400040), CONST64(0x0040401000400040), CONST64(0x0040400040400040), CONST64(0x0040401040400040),

1288 
CONST64
(0x0040400000004040), CONST64(0x0040401000004040), CONST64(0x0040400040004040), CONST64(0x0040401040004040),

1289 
CONST64
(0x0040400000404040), CONST64(0x0040401000404040), CONST64(0x0040400040404040), CONST64(0x0040401040404040),

1290 
CONST64
(0x4040400000000000), CONST64(0x4040401000000000), CONST64(0x4040400040000000), CONST64(0x4040401040000000),

1291 
CONST64
(0x4040400000400000), CONST64(0x4040401000400000), CONST64(0x4040400040400000), CONST64(0x4040401040400000),

1292 
CONST64
(0x4040400000004000), CONST64(0x4040401000004000), CONST64(0x4040400040004000), CONST64(0x4040401040004000),

1293 
CONST64
(0x4040400000404000), CONST64(0x4040401000404000), CONST64(0x4040400040404000), CONST64(0x4040401040404000),

1294 
CONST64
(0x4040400000000040), CONST64(0x4040401000000040), CONST64(0x4040400040000040), CONST64(0x4040401040000040),

1295 
CONST64
(0x4040400000400040), CONST64(0x4040401000400040), CONST64(0x4040400040400040), CONST64(0x4040401040400040),

1296 
CONST64
(0x4040400000004040), CONST64(0x4040401000004040), CONST64(0x4040400040004040), CONST64(0x4040401040004040),

1297 
CONST64
(0x4040400000404040), CONST64(0x4040401000404040), CONST64(0x4040400040404040), CONST64(0x4040401040404040)

1303 
cookey
(cÚ¡ 
ulÚg32
 *
¿w1
, ulÚg32 *
keyout
);

1305 #ifdeà
LTC_CLEAN_STACK


1306 
	$_deskey
(cÚ¡ *
key
, 
edf
, 
ulÚg32
 *
keyout
)

1308 
	$deskey
(cÚ¡ *
key
, 
edf
, 
ulÚg32
 *
keyout
)

1311 
ulÚg32
 
i
, 
j
, 
l
, 
m
, 
n
, 
kn
[32];

1312 
pc1m
[56], 
pü
[56];

1314 
j
=0; j < 56; j++) {

1315 
l
 = (
ulÚg32
)
pc1
[
j
];

1316 
m
 = 
l
 & 7;

1317 
pc1m
[
j
] = ()((
key
[
l
 >> 3U] & 
by‹b™
[
m
]) == bytebit[m] ? 1 : 0);

1320 
i
=0; i < 16; i++) {

1321 ià(
edf
 =ğ
DE1
) {

1322 
m
 = (15 - 
i
) << 1;

1324 
m
 = 
i
 << 1;

1326 
n
 = 
m
 + 1;

1327 
kn
[
m
] = kn[
n
] = 0L;

1328 
j
=0; j < 28; j++) {

1329 
l
 = 
j
 + (
ulÚg32
)
tÙrÙ
[
i
];

1330 ià(
l
 < 28) {

1331 
pü
[
j
] = 
pc1m
[
l
];

1333 
pü
[
j
] = 
pc1m
[
l
 - 28];

1336  ; 
j
 < 56; j++) {

1337 
l
 = 
j
 + (
ulÚg32
)
tÙrÙ
[
i
];

1338 ià(
l
 < 56) {

1339 
pü
[
j
] = 
pc1m
[
l
];

1341 
pü
[
j
] = 
pc1m
[
l
 - 28];

1344 
j
=0; j < 24; j++) {

1345 ià(()
pü
[()
pc2
[
j
]] != 0) {

1346 
kn
[
m
] |ğ
bigby‹
[
j
];

1348 ià(()
pü
[()
pc2
[
j
+24]] != 0) {

1349 
kn
[
n
] |ğ
bigby‹
[
j
];

1354 
	`cookey
(
kn
, 
keyout
);

1355 
	}
}

1357 #ifdeà
LTC_CLEAN_STACK


1358 
	$deskey
(cÚ¡ *
key
, 
edf
, 
ulÚg32
 *
keyout
)

1360 
	`_deskey
(
key
, 
edf
, 
keyout
);

1361 
	`buº_¡ack
(()*5 + (
ulÚg32
)*32 + ()*112);

1362 
	}
}

1365 #ifdeà
LTC_CLEAN_STACK


1366 
	$_cookey
(cÚ¡ 
ulÚg32
 *
¿w1
, ulÚg32 *
keyout
)

1368 
	$cookey
(cÚ¡ 
ulÚg32
 *
¿w1
, ulÚg32 *
keyout
)

1371 
ulÚg32
 *
cook
;

1372 cÚ¡ 
ulÚg32
 *
¿w0
;

1373 
ulÚg32
 
dough
[32];

1374 
i
;

1376 
cook
 = 
dough
;

1377 
i
=0; i < 16; i++, 
¿w1
++)

1379 
¿w0
 = 
¿w1
++;

1380 *
cook
 = (*
¿w0
 & 0x00fc0000L) << 6;

1381 *
cook
 |ğ(*
¿w0
 & 0x00000fc0L) << 10;

1382 *
cook
 |ğ(*
¿w1
 & 0x00fc0000L) >> 10;

1383 *
cook
++ |ğ(*
¿w1
 & 0x00000fc0L) >> 6;

1384 *
cook
 = (*
¿w0
 & 0x0003f000L) << 12;

1385 *
cook
 |ğ(*
¿w0
 & 0x0000003fL) << 16;

1386 *
cook
 |ğ(*
¿w1
 & 0x0003f000L) >> 4;

1387 *
cook
++ |ğ(*
¿w1
 & 0x0000003fL);

1390 
	`XMEMCPY
(
keyout
, 
dough
,  dough);

1391 
	}
}

1393 #ifdeà
LTC_CLEAN_STACK


1394 
	$cookey
(cÚ¡ 
ulÚg32
 *
¿w1
, ulÚg32 *
keyout
)

1396 
	`_cookey
(
¿w1
, 
keyout
);

1397 
	`buº_¡ack
((
ulÚg32
 *) * 2 + (ulong32)*32 + ());

1398 
	}
}

1401 #iâdeà
LTC_CLEAN_STACK


1402 
	$desfunc
(
ulÚg32
 *
block
, cÚ¡ ulÚg32 *
keys
)

1404 
	$_desfunc
(
ulÚg32
 *
block
, cÚ¡ ulÚg32 *
keys
)

1407 
ulÚg32
 
wÜk
, 
right
, 
Ëát
;

1408 
cur_round
;

1410 
Ëát
 = 
block
[0];

1411 
right
 = 
block
[1];

1413 #ifdeà
LTC_SMALL_CODE


1414 
wÜk
 = ((
Ëát
 >> 4è^ 
right
) & 0x0f0f0f0fL;

1415 
right
 ^ğ
wÜk
;

1416 
Ëát
 ^ğ(
wÜk
 << 4);

1418 
wÜk
 = ((
Ëát
 >> 16è^ 
right
) & 0x0000ffffL;

1419 
right
 ^ğ
wÜk
;

1420 
Ëát
 ^ğ(
wÜk
 << 16);

1422 
wÜk
 = ((
right
 >> 2è^ 
Ëát
) & 0x33333333L;

1423 
Ëát
 ^ğ
wÜk
;

1424 
right
 ^ğ(
wÜk
 << 2);

1426 
wÜk
 = ((
right
 >> 8è^ 
Ëát
) & 0x00ff00ffL;

1427 
Ëát
 ^ğ
wÜk
;

1428 
right
 ^ğ(
wÜk
 << 8);

1430 
right
 = 
	`ROLc
(right, 1);

1431 
wÜk
 = (
Ëát
 ^ 
right
) & 0xaaaaaaaaL;

1433 
Ëát
 ^ğ
wÜk
;

1434 
right
 ^ğ
wÜk
;

1435 
Ëát
 = 
	`ROLc
(leftt, 1);

1438 
ulÚg64
 
tmp
;

1439 
tmp
 = 
des_
[0][
	`by‹
(
Ëát
, 0)] ^

1440 
des_
[1][
	`by‹
(
Ëát
, 1)] ^

1441 
des_
[2][
	`by‹
(
Ëát
, 2)] ^

1442 
des_
[3][
	`by‹
(
Ëát
, 3)] ^

1443 
des_
[4][
	`by‹
(
right
, 0)] ^

1444 
des_
[5][
	`by‹
(
right
, 1)] ^

1445 
des_
[6][
	`by‹
(
right
, 2)] ^

1446 
des_
[7][
	`by‹
(
right
, 3)];

1447 
Ëát
 = (
ulÚg32
)(
tmp
 >> 32);

1448 
right
 = (
ulÚg32
)(
tmp
 & 0xFFFFFFFFUL);

1452 
cur_round
 = 0; cur_round < 8; cur_round++) {

1453 
wÜk
 = 
	`RORc
(
right
, 4è^ *
keys
++;

1454 
Ëát
 ^ğ
SP7
[
wÜk
 & 0x3fL]

1455 ^ 
SP5
[(
wÜk
 >> 8) & 0x3fL]

1456 ^ 
SP3
[(
wÜk
 >> 16) & 0x3fL]

1457 ^ 
SP1
[(
wÜk
 >> 24) & 0x3fL];

1458 
wÜk
 = 
right
 ^ *
keys
++;

1459 
Ëát
 ^ğ
SP8
[ 
wÜk
 & 0x3fL]

1460 ^ 
SP6
[(
wÜk
 >> 8) & 0x3fL]

1461 ^ 
SP4
[(
wÜk
 >> 16) & 0x3fL]

1462 ^ 
SP2
[(
wÜk
 >> 24) & 0x3fL];

1464 
wÜk
 = 
	`RORc
(
Ëát
, 4è^ *
keys
++;

1465 
right
 ^ğ
SP7
[ 
wÜk
 & 0x3fL]

1466 ^ 
SP5
[(
wÜk
 >> 8) & 0x3fL]

1467 ^ 
SP3
[(
wÜk
 >> 16) & 0x3fL]

1468 ^ 
SP1
[(
wÜk
 >> 24) & 0x3fL];

1469 
wÜk
 = 
Ëát
 ^ *
keys
++;

1470 
right
 ^ğ
SP8
[ 
wÜk
 & 0x3fL]

1471 ^ 
SP6
[(
wÜk
 >> 8) & 0x3fL]

1472 ^ 
SP4
[(
wÜk
 >> 16) & 0x3fL]

1473 ^ 
SP2
[(
wÜk
 >> 24) & 0x3fL];

1476 #ifdeà
LTC_SMALL_CODE


1477 
right
 = 
	`RORc
(right, 1);

1478 
wÜk
 = (
Ëát
 ^ 
right
) & 0xaaaaaaaaL;

1479 
Ëát
 ^ğ
wÜk
;

1480 
right
 ^ğ
wÜk
;

1481 
Ëát
 = 
	`RORc
(leftt, 1);

1482 
wÜk
 = ((
Ëát
 >> 8è^ 
right
) & 0x00ff00ffL;

1483 
right
 ^ğ
wÜk
;

1484 
Ëát
 ^ğ(
wÜk
 << 8);

1486 
wÜk
 = ((
Ëát
 >> 2è^ 
right
) & 0x33333333L;

1487 
right
 ^ğ
wÜk
;

1488 
Ëát
 ^ğ(
wÜk
 << 2);

1489 
wÜk
 = ((
right
 >> 16è^ 
Ëát
) & 0x0000ffffL;

1490 
Ëát
 ^ğ
wÜk
;

1491 
right
 ^ğ(
wÜk
 << 16);

1492 
wÜk
 = ((
right
 >> 4è^ 
Ëát
) & 0x0f0f0f0fL;

1493 
Ëát
 ^ğ
wÜk
;

1494 
right
 ^ğ(
wÜk
 << 4);

1497 
ulÚg64
 
tmp
;

1498 
tmp
 = 
des_å
[0][
	`by‹
(
Ëát
, 0)] ^

1499 
des_å
[1][
	`by‹
(
Ëát
, 1)] ^

1500 
des_å
[2][
	`by‹
(
Ëát
, 2)] ^

1501 
des_å
[3][
	`by‹
(
Ëát
, 3)] ^

1502 
des_å
[4][
	`by‹
(
right
, 0)] ^

1503 
des_å
[5][
	`by‹
(
right
, 1)] ^

1504 
des_å
[6][
	`by‹
(
right
, 2)] ^

1505 
des_å
[7][
	`by‹
(
right
, 3)];

1506 
Ëát
 = (
ulÚg32
)(
tmp
 >> 32);

1507 
right
 = (
ulÚg32
)(
tmp
 & 0xFFFFFFFFUL);

1511 
block
[0] = 
right
;

1512 
block
[1] = 
Ëát
;

1513 
	}
}

1515 #ifdeà
LTC_CLEAN_STACK


1516 
	$desfunc
(
ulÚg32
 *
block
, cÚ¡ ulÚg32 *
keys
)

1518 
	`_desfunc
(
block
, 
keys
);

1519 
	`buº_¡ack
((
ulÚg32
) * 4 + ());

1520 
	}
}

1532 
	$des_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

1534 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

1535 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1537 ià(
num_rounds
 != 0 &&‚um_rounds != 16) {

1538  
CRYPT_INVALID_ROUNDS
;

1541 ià(
keyËn
 != 8) {

1542  
CRYPT_INVALID_KEYSIZE
;

1545 
	`deskey
(
key
, 
EN0
, 
skey
->
des
.
ek
);

1546 
	`deskey
(
key
, 
DE1
, 
skey
->
des
.
dk
);

1548  
CRYPT_OK
;

1549 
	}
}

1560 
	$des3_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

1562 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

1563 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1565 if(
num_rounds
 != 0 &&‚um_rounds != 16) {

1566  
CRYPT_INVALID_ROUNDS
;

1569 ià(
keyËn
 != 24) {

1570  
CRYPT_INVALID_KEYSIZE
;

1573 
	`deskey
(
key
, 
EN0
, 
skey
->
des3
.
ek
[0]);

1574 
	`deskey
(
key
+8, 
DE1
, 
skey
->
des3
.
ek
[1]);

1575 
	`deskey
(
key
+16, 
EN0
, 
skey
->
des3
.
ek
[2]);

1577 
	`deskey
(
key
, 
DE1
, 
skey
->
des3
.
dk
[2]);

1578 
	`deskey
(
key
+8, 
EN0
, 
skey
->
des3
.
dk
[1]);

1579 
	`deskey
(
key
+16, 
DE1
, 
skey
->
des3
.
dk
[0]);

1581  
CRYPT_OK
;

1582 
	}
}

1592 
	$des_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

1594 
ulÚg32
 
wÜk
[2];

1595 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

1596 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

1597 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1598 
	`LOAD32H
(
wÜk
[0], 
±
+0);

1599 
	`LOAD32H
(
wÜk
[1], 
±
+4);

1600 
	`desfunc
(
wÜk
, 
skey
->
des
.
ek
);

1601 
	`STORE32H
(
wÜk
[0],
ù
+0);

1602 
	`STORE32H
(
wÜk
[1],
ù
+4);

1603  
CRYPT_OK
;

1604 
	}
}

1613 
	$des_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

1615 
ulÚg32
 
wÜk
[2];

1616 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

1617 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

1618 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1619 
	`LOAD32H
(
wÜk
[0], 
ù
+0);

1620 
	`LOAD32H
(
wÜk
[1], 
ù
+4);

1621 
	`desfunc
(
wÜk
, 
skey
->
des
.
dk
);

1622 
	`STORE32H
(
wÜk
[0],
±
+0);

1623 
	`STORE32H
(
wÜk
[1],
±
+4);

1624  
CRYPT_OK
;

1625 
	}
}

1635 
	$des3_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

1637 
ulÚg32
 
wÜk
[2];

1639 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

1640 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

1641 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1642 
	`LOAD32H
(
wÜk
[0], 
±
+0);

1643 
	`LOAD32H
(
wÜk
[1], 
±
+4);

1644 
	`desfunc
(
wÜk
, 
skey
->
des3
.
ek
[0]);

1645 
	`desfunc
(
wÜk
, 
skey
->
des3
.
ek
[1]);

1646 
	`desfunc
(
wÜk
, 
skey
->
des3
.
ek
[2]);

1647 
	`STORE32H
(
wÜk
[0],
ù
+0);

1648 
	`STORE32H
(
wÜk
[1],
ù
+4);

1649  
CRYPT_OK
;

1650 
	}
}

1659 
	$des3_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

1661 
ulÚg32
 
wÜk
[2];

1662 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

1663 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

1664 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

1665 
	`LOAD32H
(
wÜk
[0], 
ù
+0);

1666 
	`LOAD32H
(
wÜk
[1], 
ù
+4);

1667 
	`desfunc
(
wÜk
, 
skey
->
des3
.
dk
[0]);

1668 
	`desfunc
(
wÜk
, 
skey
->
des3
.
dk
[1]);

1669 
	`desfunc
(
wÜk
, 
skey
->
des3
.
dk
[2]);

1670 
	`STORE32H
(
wÜk
[0],
±
+0);

1671 
	`STORE32H
(
wÜk
[1],
±
+4);

1672  
CRYPT_OK
;

1673 
	}
}

1680 
	$des_‹¡
()

1682 #iâdeà
LTC_TEST


1683  
CRYPT_NOP
;

1685 
”r
;

1686 cÚ¡ 
	sdes_‹¡_ÿ£
 {

1687 
num
, 
mode
;

1688 
key
[8], 
txt
[8], 
out
[8];

1689 } 
ÿ£s
[] = {

1793 
i
, 
y
;

1794 
tmp
[8];

1795 
symm‘ric_key
 
des
;

1797 
i
=0; i < ()((
ÿ£s
)/(cases[0])); i++)

1799 ià((
”r
 = 
	`des_£tup
(
ÿ£s
[
i
].
key
, 8, 0, &
des
)è!ğ
CRYPT_OK
) {

1800  
”r
;

1802 ià(
ÿ£s
[
i
].
mode
 != 0) {

1803 
	`des_ecb_’üy±
(
ÿ£s
[
i
].
txt
, 
tmp
, &
des
);

1805 
	`des_ecb_deüy±
(
ÿ£s
[
i
].
txt
, 
tmp
, &
des
);

1808 ià(
	`XMEMCMP
(
ÿ£s
[
i
].
out
, 
tmp
, (tmp)) != 0) {

1809  
CRYPT_FAIL_TESTVECTOR
;

1813 
y
 = 0; y < 8; y++è
tmp
[y] = 0;

1814 
y
 = 0; y < 1000; y++è
	`des_ecb_’üy±
(
tmp
,mp, &
des
);

1815 
y
 = 0; y < 1000; y++è
	`des_ecb_deüy±
(
tmp
,mp, &
des
);

1816 
y
 = 0; y < 8; y++èià(
tmp
[y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

1819  
CRYPT_OK
;

1821 
	}
}

1824 
	$des3_‹¡
()

1826 #iâdeà
LTC_TEST


1827  
CRYPT_NOP
;

1829 
key
[24], 
±
[8], 
ù
[8], 
tmp
[8];

1830 
symm‘ric_key
 
skey
;

1831 
x
, 
”r
;

1833 ià((
”r
 = 
	`des_‹¡
()è!ğ
CRYPT_OK
) {

1834  
”r
;

1837 
x
 = 0; x < 8; x++) {

1838 
±
[
x
] = x;

1841 
x
 = 0; x < 24; x++) {

1842 
key
[
x
] = x;

1845 ià((
”r
 = 
	`des3_£tup
(
key
, 24, 0, &
skey
)è!ğ
CRYPT_OK
) {

1846  
”r
;

1849 
	`des3_ecb_’üy±
(
±
, 
ù
, &
skey
);

1850 
	`des3_ecb_deüy±
(
ù
, 
tmp
, &
skey
);

1852 ià(
	`XMEMCMP
(
±
, 
tmp
, 8) != 0) {

1853  
CRYPT_FAIL_TESTVECTOR
;

1856  
CRYPT_OK
;

1858 
	}
}

1864 
	$des_dÚe
(
symm‘ric_key
 *
skey
)

1866 
	}
}

1872 
	$des3_dÚe
(
symm‘ric_key
 *
skey
)

1874 
	}
}

1883 
	$des_keysize
(*
keysize
)

1885 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

1886 if(*
keysize
 < 8) {

1887  
CRYPT_INVALID_KEYSIZE
;

1889 *
keysize
 = 8;

1890  
CRYPT_OK
;

1891 
	}
}

1899 
	$des3_keysize
(*
keysize
)

1901 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

1902 if(*
keysize
 < 24) {

1903  
CRYPT_INVALID_KEYSIZE
;

1905 *
keysize
 = 24;

1906  
CRYPT_OK
;

1907 
	}
}

	@libtomcrypt/src/ciphers/kasumi.c

18 
	~"tomüy±.h
"

20 #ifdeà
LTC_KASUMI


22 
	tu16
;

24 
	#ROL16
(
x
, 
y
è((((x)<<(y)è| ((x)>>(16-(y)))è& 0xFFFF)

	)

26 cÚ¡ 
Éc_ch”_desütÜ
 
	gkasumi_desc
 = {

30 &
kasumi_£tup
,

31 &
kasumi_ecb_’üy±
,

32 &
kasumi_ecb_deüy±
,

33 &
kasumi_‹¡
,

34 &
kasumi_dÚe
,

35 &
kasumi_keysize
,

36 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

39 
u16
 
	$FI
Ğ
u16
 
š
, u16 
subkey
 )

41 
u16
 
nše
, 
£v’
;

42 cÚ¡ 
u16
 
S7
[128] = {

51 cÚ¡ 
u16
 
S9
[512] = {

88 
nše
 = (
u16
)(
š
>>7)&0x1FF;

89 
£v’
 = (
u16
)(
š
&0x7F);

92 
nše
 = (
u16
)(
S9
[nše] ^ 
£v’
);

93 
£v’
 = (
u16
)(
S7
[£v’] ^ (
nše
 & 0x7F));

94 
£v’
 ^ğ(
subkey
>>9);

95 
nše
 ^ğ(
subkey
&0x1FF);

96 
nše
 = (
u16
)(
S9
[nše] ^ 
£v’
);

97 
£v’
 = (
u16
)(
S7
[£v’] ^ (
nše
 & 0x7F));

98  (
u16
)(
£v’
<<9è+ 
nše
;

99 
	}
}

101 
ulÚg32
 
	$FO
Ğ
ulÚg32
 
š
, 
round_no
, 
symm‘ric_key
 *
key
)

103 
u16
 
Ëá
, 
right
;

106 
Ëá
 = (
u16
)(
š
>>16);

107 
right
 = (
u16
è
š
&0xFFFF;

110 
Ëá
 ^ğ
key
->
kasumi
.
KOi1
[
round_no
];

111 
Ëá
 = 
	`FI
ĞËá, 
key
->
kasumi
.
KIi1
[
round_no
] );

112 
Ëá
 ^ğ
right
;

114 
right
 ^ğ
key
->
kasumi
.
KOi2
[
round_no
];

115 
right
 = 
	`FI
Ğright, 
key
->
kasumi
.
KIi2
[
round_no
] );

116 
right
 ^ğ
Ëá
;

118 
Ëá
 ^ğ
key
->
kasumi
.
KOi3
[
round_no
];

119 
Ëá
 = 
	`FI
ĞËá, 
key
->
kasumi
.
KIi3
[
round_no
] );

120 
Ëá
 ^ğ
right
;

122  (((
ulÚg32
)
right
)<<16)+
Ëá
;

123 
	}
}

125 
ulÚg32
 
	$FL
Ğ
ulÚg32
 
š
, 
round_no
, 
symm‘ric_key
 *
key
 )

127 
u16
 
l
, 
r
, 
a
, 
b
;

129 
l
 = (
u16
)(
š
>>16);

130 
r
 = (
u16
)(
š
)&0xFFFF;

132 
a
 = (
u16
è(
l
 & 
key
->
kasumi
.
KLi1
[
round_no
]);

133 
r
 ^ğ
	`ROL16
(
a
,1);

134 
b
 = (
u16
)(
r
 | 
key
->
kasumi
.
KLi2
[
round_no
]);

135 
l
 ^ğ
	`ROL16
(
b
,1);

138  (((
ulÚg32
)
l
)<<16è+ 
r
;

139 
	}
}

141 
	$kasumi_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

143 
ulÚg32
 
Ëá
, 
right
, 
‹mp
;

144 
n
;

146 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

147 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

148 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

150 
	`LOAD32H
(
Ëá
, 
±
);

151 
	`LOAD32H
(
right
, 
±
+4);

153 
n
 = 0;‚ <= 7; ) {

154 
‹mp
 = 
	`FL
(
Ëá
, 
n
, 
skey
);

155 
‹mp
 = 
	`FO
Ñemp, 
n
++, 
skey
);

156 
right
 ^ğ
‹mp
;

157 
‹mp
 = 
	`FO
(
right
, 
n
, 
skey
);

158 
‹mp
 = 
	`FL
Ñemp, 
n
++, 
skey
);

159 
Ëá
 ^ğ
‹mp
;

162 
	`STORE32H
(
Ëá
, 
ù
);

163 
	`STORE32H
(
right
, 
ù
+4);

165  
CRYPT_OK
;

166 
	}
}

168 
	$kasumi_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

170 
ulÚg32
 
Ëá
, 
right
, 
‹mp
;

171 
n
;

173 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

174 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

175 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

177 
	`LOAD32H
(
Ëá
, 
ù
);

178 
	`LOAD32H
(
right
, 
ù
+4);

180 
n
 = 7;‚ >= 0; ) {

181 
‹mp
 = 
	`FO
(
right
, 
n
, 
skey
);

182 
‹mp
 = 
	`FL
Ñemp, 
n
--, 
skey
);

183 
Ëá
 ^ğ
‹mp
;

184 
‹mp
 = 
	`FL
(
Ëá
, 
n
, 
skey
);

185 
‹mp
 = 
	`FO
Ñemp, 
n
--, 
skey
);

186 
right
 ^ğ
‹mp
;

189 
	`STORE32H
(
Ëá
, 
±
);

190 
	`STORE32H
(
right
, 
±
+4);

192  
CRYPT_OK
;

193 
	}
}

195 
	$kasumi_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

197 cÚ¡ 
u16
 
C
[8] = { 0x0123,0x4567,0x89AB,0xCDEF, 0xFEDC,0xBA98,0x7654,0x3210 };

198 
u16
 
ukey
[8], 
K´ime
[8];

199 
n
;

201 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

202 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

204 ià(
keyËn
 != 16) {

205  
CRYPT_INVALID_KEYSIZE
;

208 ià(
num_rounds
 != 0 &&‚um_rounds != 8) {

209  
CRYPT_INVALID_ROUNDS
;

213 
n
 = 0;‚ < 8;‚++ ) {

214 
ukey
[
n
] = (((
u16
)
key
[2*n]) << 8) | key[2*n+1];

218 
n
 = 0;‚ < 8;‚++) {

219 
K´ime
[
n
] = 
ukey
[n] ^ 
C
[n];

223 
n
 = 0;‚ < 8;‚++) {

224 
skey
->
kasumi
.
KLi1
[
n
] = 
	`ROL16
(
ukey
[n],1);

225 
skey
->
kasumi
.
KLi2
[
n
] = 
K´ime
[(n+2)&0x7];

226 
skey
->
kasumi
.
KOi1
[
n
] = 
	`ROL16
(
ukey
[(n+1)&0x7],5);

227 
skey
->
kasumi
.
KOi2
[
n
] = 
	`ROL16
(
ukey
[(n+5)&0x7],8);

228 
skey
->
kasumi
.
KOi3
[
n
] = 
	`ROL16
(
ukey
[(n+6)&0x7],13);

229 
skey
->
kasumi
.
KIi1
[
n
] = 
K´ime
[(n+4)&0x7];

230 
skey
->
kasumi
.
KIi2
[
n
] = 
K´ime
[(n+3)&0x7];

231 
skey
->
kasumi
.
KIi3
[
n
] = 
K´ime
[(n+7)&0x7];

234  
CRYPT_OK
;

235 
	}
}

237 
	$kasumi_dÚe
(
symm‘ric_key
 *
skey
)

239 
	}
}

241 
	$kasumi_keysize
(*
keysize
)

243 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

244 ià(*
keysize
 >= 16) {

245 *
keysize
 = 16;

246  
CRYPT_OK
;

248  
CRYPT_INVALID_KEYSIZE
;

250 
	}
}

252 
	$kasumi_‹¡
()

254 #iâdeà
LTC_TEST


255  
CRYPT_NOP
;

258 
key
[16], 
±
[8], 
ù
[8];

259 } 
‹¡s
[] = {

292 
buf
[2][8];

293 
symm‘ric_key
 
key
;

294 
”r
, 
x
;

296 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

297 ià((
”r
 = 
	`kasumi_£tup
(
‹¡s
[
x
].
key
, 16, 0, &key)è!ğ
CRYPT_OK
) {

298  
”r
;

300 ià((
”r
 = 
	`kasumi_ecb_’üy±
(
‹¡s
[
x
].
±
, 
buf
[0], &
key
)è!ğ
CRYPT_OK
) {

301  
”r
;

303 ià((
”r
 = 
	`kasumi_ecb_deüy±
(
‹¡s
[
x
].
ù
, 
buf
[1], &
key
)è!ğ
CRYPT_OK
) {

304  
”r
;

306 ià(
	`XMEMCMP
(
‹¡s
[
x
].
±
, 
buf
[1], 8è|| XMEMCMPÑe¡s[x].
ù
, buf[0], 8)) {

307  
CRYPT_FAIL_TESTVECTOR
;

310  
CRYPT_OK
;

312 
	}
}

	@libtomcrypt/src/ciphers/khazad.c

11 
	~"tomüy±.h
"

19 #ifdeà
KHAZAD


21 cÚ¡ 
Éc_ch”_desütÜ
 
	gkhazad_desc
 = {

25 &
khazad_£tup
,

26 &
khazad_ecb_’üy±
,

27 &
khazad_ecb_deüy±
,

28 &
khazad_‹¡
,

29 &
khazad_dÚe
,

30 &
khazad_keysize
,

31 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

34 
	#R
 8

	)

35 
	#KEYSIZE
 128

	)

36 
	#KEYSIZEB
 (
KEYSIZE
/8)

	)

37 
	#BLOCKSIZE
 64

	)

38 
	#BLOCKSIZEB
 (
BLOCKSIZE
/8)

	)

40 cÚ¡ 
ulÚg64
 
	gT0
[256] = {

41 
CONST64
(0xbad3d268bbb96a01), CONST64(0x54fc4d19e59a66b1), CONST64(0x2f71bc93e26514cd), CONST64(0x749ccdb925871b51),

42 
CONST64
(0x53f55102f7a257a4), CONST64(0xd3686bb8d0d6be03), CONST64(0xd26b6fbdd6deb504), CONST64(0x4dd72964b35285fe),

43 
CONST64
(0x50f05d0dfdba4aad), CONST64(0xace98a26cf09e063), CONST64(0x8d8a0e83091c9684), CONST64(0xbfdcc679a5914d1a),

44 
CONST64
(0x7090ddad3da7374d), CONST64(0x52f65507f1aa5ca3), CONST64(0x9ab352c87ba417e1), CONST64(0x4cd42d61b55a8ef9),

45 
CONST64
(0xea238f65460320ac), CONST64(0xd56273a6c4e68411), CONST64(0x97a466f155cc68c2), CONST64(0xd16e63b2dcc6a80d),

46 
CONST64
(0x3355ccffaa85d099), CONST64(0x51f35908fbb241aa), CONST64(0x5bed712ac7e20f9c), CONST64(0xa6f7a204f359ae55),

47 
CONST64
(0xde7f5f81febec120), CONST64(0x48d83d75ad7aa2e5), CONST64(0xa8e59a32d729cc7f), CONST64(0x99b65ec771bc0ae8),

48 
CONST64
(0xdb704b90e096e63b), CONST64(0x3256c8faac8ddb9e), CONST64(0xb7c4e65195d11522), CONST64(0xfc19d72b32b3aace),

49 
CONST64
(0xe338ab48704b7393), CONST64(0x9ebf42dc63843bfd), CONST64(0x91ae7eef41fc52d0), CONST64(0x9bb056cd7dac1ce6),

50 
CONST64
(0xe23baf4d76437894), CONST64(0xbbd0d66dbdb16106), CONST64(0x41c319589b32f1da), CONST64(0x6eb2a5cb7957e517),

51 
CONST64
(0xa5f2ae0bf941b35c), CONST64(0xcb400bc08016564b), CONST64(0x6bbdb1da677fc20c), CONST64(0x95a26efb59dc7ecc),

52 
CONST64
(0xa1febe1fe1619f40), CONST64(0xf308eb1810cbc3e3), CONST64(0xb1cefe4f81e12f30), CONST64(0x0206080a0c10160e),

53 
CONST64
(0xcc4917db922e675e), CONST64(0xc45137f3a26e3f66), CONST64(0x1d2774694ee8cf53), CONST64(0x143c504478a09c6c),

54 
CONST64
(0xc3582be8b0560e73), CONST64(0x63a591f2573f9a34), CONST64(0xda734f95e69eed3c), CONST64(0x5de76934d3d2358e),

55 
CONST64
(0x5fe1613edfc22380), CONST64(0xdc79578bf2aed72e), CONST64(0x7d87e99413cf486e), CONST64(0xcd4a13de94266c59),

56 
CONST64
(0x7f81e19e1fdf5e60), CONST64(0x5aee752fc1ea049b), CONST64(0x6cb4adc17547f319), CONST64(0x5ce46d31d5da3e89),

57 
CONST64
(0xf704fb0c08ebefff), CONST64(0x266a98bed42d47f2), CONST64(0xff1cdb2438abb7c7), CONST64(0xed2a937e543b11b9),

58 
CONST64
(0xe825876f4a1336a2), CONST64(0x9dba4ed3699c26f4), CONST64(0x6fb1a1ce7f5fee10), CONST64(0x8e8f028c03048b8d),

59 
CONST64
(0x192b647d56c8e34f), CONST64(0xa0fdba1ae7699447), CONST64(0xf00de7171ad3deea), CONST64(0x89861e97113cba98),

60 
CONST64
(0x0f113c332278692d), CONST64(0x07091c1b12383115), CONST64(0xafec8629c511fd6a), CONST64(0xfb10cb30208b9bdb),

61 
CONST64
(0x0818202830405838), CONST64(0x153f54417ea8976b), CONST64(0x0d1734392e687f23), CONST64(0x040c101418202c1c),

62 
CONST64
(0x0103040506080b07), CONST64(0x64ac8de94507ab21), CONST64(0xdf7c5b84f8b6ca27), CONST64(0x769ac5b329970d5f),

63 
CONST64
(0x798bf9800bef6472), CONST64(0xdd7a538ef4a6dc29), CONST64(0x3d47f4c98ef5b2b3), CONST64(0x163a584e74b08a62),

64 
CONST64
(0x3f41fcc382e5a4bd), CONST64(0x3759dcebb2a5fc85), CONST64(0x6db7a9c4734ff81e), CONST64(0x3848e0d890dd95a8),

65 
CONST64
(0xb9d6de67b1a17708), CONST64(0x7395d1a237bf2a44), CONST64(0xe926836a4c1b3da5), CONST64(0x355fd4e1beb5ea8b),

66 
CONST64
(0x55ff491ce3926db6), CONST64(0x7193d9a83baf3c4a), CONST64(0x7b8df18a07ff727c), CONST64(0x8c890a860f149d83),

67 
CONST64
(0x7296d5a731b72143), CONST64(0x88851a921734b19f), CONST64(0xf607ff090ee3e4f8), CONST64(0x2a7ea882fc4d33d6),

68 
CONST64
(0x3e42f8c684edafba), CONST64(0x5ee2653bd9ca2887), CONST64(0x27699cbbd2254cf5), CONST64(0x46ca0543890ac0cf),

69 
CONST64
(0x0c14303c28607424), CONST64(0x65af89ec430fa026), CONST64(0x68b8bdd56d67df05), CONST64(0x61a399f85b2f8c3a),

70 
CONST64
(0x03050c0f0a181d09), CONST64(0xc15e23e2bc46187d), CONST64(0x57f94116ef827bb8), CONST64(0xd6677fa9cefe9918),

71 
CONST64
(0xd976439aec86f035), CONST64(0x58e87d25cdfa1295), CONST64(0xd875479fea8efb32), CONST64(0x66aa85e34917bd2f),

72 
CONST64
(0xd7647bacc8f6921f), CONST64(0x3a4ee8d29ccd83a6), CONST64(0xc84507cf8a0e4b42), CONST64(0x3c44f0cc88fdb9b4),

73 
CONST64
(0xfa13cf35268390dc), CONST64(0x96a762f453c463c5), CONST64(0xa7f4a601f551a552), CONST64(0x98b55ac277b401ef),

74 
CONST64
(0xec29977b52331abe), CONST64(0xb8d5da62b7a97c0f), CONST64(0xc7543bfca876226f), CONST64(0xaeef822cc319f66d),

75 
CONST64
(0x69bbb9d06b6fd402), CONST64(0x4bdd317aa762bfec), CONST64(0xabe0963ddd31d176), CONST64(0xa9e69e37d121c778),

76 
CONST64
(0x67a981e64f1fb628), CONST64(0x0a1e28223c504e36), CONST64(0x47c901468f02cbc8), CONST64(0xf20bef1d16c3c8e4),

77 
CONST64
(0xb5c2ee5b99c1032c), CONST64(0x226688aacc0d6bee), CONST64(0xe532b356647b4981), CONST64(0xee2f9f715e230cb0),

78 
CONST64
(0xbedfc27ca399461d), CONST64(0x2b7dac87fa4538d1), CONST64(0x819e3ebf217ce2a0), CONST64(0x1236485a6c90a67e),

79 
CONST64
(0x839836b52d6cf4ae), CONST64(0x1b2d6c775ad8f541), CONST64(0x0e1238362470622a), CONST64(0x23658cafca0560e9),

80 
CONST64
(0xf502f30604fbf9f1), CONST64(0x45cf094c8312ddc6), CONST64(0x216384a5c61576e7), CONST64(0xce4f1fd19e3e7150),

81 
CONST64
(0x49db3970ab72a9e2), CONST64(0x2c74b09ce87d09c4), CONST64(0xf916c33a2c9b8dd5), CONST64(0xe637bf596e635488),

82 
CONST64
(0xb6c7e25493d91e25), CONST64(0x2878a088f05d25d8), CONST64(0x17395c4b72b88165), CONST64(0x829b32b02b64ffa9),

83 
CONST64
(0x1a2e68725cd0fe46), CONST64(0x8b80169d1d2cac96), CONST64(0xfe1fdf213ea3bcc0), CONST64(0x8a8312981b24a791),

84 
CONST64
(0x091b242d3648533f), CONST64(0xc94603ca8c064045), CONST64(0x879426a1354cd8b2), CONST64(0x4ed2256bb94a98f7),

85 
CONST64
(0xe13ea3427c5b659d), CONST64(0x2e72b896e46d1fca), CONST64(0xe431b75362734286), CONST64(0xe03da7477a536e9a),

86 
CONST64
(0xeb208b60400b2bab), CONST64(0x90ad7aea47f459d7), CONST64(0xa4f1aa0eff49b85b), CONST64(0x1e22786644f0d25a),

87 
CONST64
(0x85922eab395ccebc), CONST64(0x60a09dfd5d27873d), CONST64(0x0000000000000000), CONST64(0x256f94b1de355afb),

88 
CONST64
(0xf401f70302f3f2f6), CONST64(0xf10ee3121cdbd5ed), CONST64(0x94a16afe5fd475cb), CONST64(0x0b1d2c273a584531),

89 
CONST64
(0xe734bb5c686b5f8f), CONST64(0x759fc9bc238f1056), CONST64(0xef2c9b74582b07b7), CONST64(0x345cd0e4b8bde18c),

90 
CONST64
(0x3153c4f5a695c697), CONST64(0xd46177a3c2ee8f16), CONST64(0xd06d67b7dacea30a), CONST64(0x869722a43344d3b5),

91 
CONST64
(0x7e82e59b19d75567), CONST64(0xadea8e23c901eb64), CONST64(0xfd1ad32e34bba1c9), CONST64(0x297ba48df6552edf),

92 
CONST64
(0x3050c0f0a09dcd90), CONST64(0x3b4decd79ac588a1), CONST64(0x9fbc46d9658c30fa), CONST64(0xf815c73f2a9386d2),

93 
CONST64
(0xc6573ff9ae7e2968), CONST64(0x13354c5f6a98ad79), CONST64(0x060a181e14303a12), CONST64(0x050f14111e28271b),

94 
CONST64
(0xc55233f6a4663461), CONST64(0x113344556688bb77), CONST64(0x7799c1b62f9f0658), CONST64(0x7c84ed9115c74369),

95 
CONST64
(0x7a8ef58f01f7797b), CONST64(0x7888fd850de76f75), CONST64(0x365ad8eeb4adf782), CONST64(0x1c24706c48e0c454),

96 
CONST64
(0x394be4dd96d59eaf), CONST64(0x59eb7920cbf21992), CONST64(0x1828607850c0e848), CONST64(0x56fa4513e98a70bf),

97 
CONST64
(0xb3c8f6458df1393e), CONST64(0xb0cdfa4a87e92437), CONST64(0x246c90b4d83d51fc), CONST64(0x206080a0c01d7de0),

98 
CONST64
(0xb2cbf2408bf93239), CONST64(0x92ab72e04be44fd9), CONST64(0xa3f8b615ed71894e), CONST64(0xc05d27e7ba4e137a),

99 
CONST64
(0x44cc0d49851ad6c1), CONST64(0x62a695f751379133), CONST64(0x103040506080b070), CONST64(0xb4c1ea5e9fc9082b),

100 
CONST64
(0x84912aae3f54c5bb), CONST64(0x43c511529722e7d4), CONST64(0x93a876e54dec44de), CONST64(0xc25b2fedb65e0574),

101 
CONST64
(0x4ade357fa16ab4eb), CONST64(0xbddace73a9815b14), CONST64(0x8f8c0689050c808a), CONST64(0x2d77b499ee7502c3),

102 
CONST64
(0xbcd9ca76af895013), CONST64(0x9cb94ad66f942df3), CONST64(0x6abeb5df6177c90b), CONST64(0x40c01d5d9d3afadd),

103 
CONST64
(0xcf4c1bd498367a57), CONST64(0xa2fbb210eb798249), CONST64(0x809d3aba2774e9a7), CONST64(0x4fd1216ebf4293f0),

104 
CONST64
(0x1f217c6342f8d95d), CONST64(0xca430fc5861e5d4c), CONST64(0xaae39238db39da71), CONST64(0x42c61557912aecd3),

107 cÚ¡ 
ulÚg64
 
	gT1
[256] = {

108 
CONST64
(0xd3ba68d2b9bb016a), CONST64(0xfc54194d9ae5b166), CONST64(0x712f93bc65e2cd14), CONST64(0x9c74b9cd8725511b),

109 
CONST64
(0xf5530251a2f7a457), CONST64(0x68d3b86bd6d003be), CONST64(0x6bd2bd6fded604b5), CONST64(0xd74d642952b3fe85),

110 
CONST64
(0xf0500d5dbafdad4a), CONST64(0xe9ac268a09cf63e0), CONST64(0x8a8d830e1c098496), CONST64(0xdcbf79c691a51a4d),

111 
CONST64
(0x9070addda73d4d37), CONST64(0xf6520755aaf1a35c), CONST64(0xb39ac852a47be117), CONST64(0xd44c612d5ab5f98e),

112 
CONST64
(0x23ea658f0346ac20), CONST64(0x62d5a673e6c41184), CONST64(0xa497f166cc55c268), CONST64(0x6ed1b263c6dc0da8),

113 
CONST64
(0x5533ffcc85aa99d0), CONST64(0xf3510859b2fbaa41), CONST64(0xed5b2a71e2c79c0f), CONST64(0xf7a604a259f355ae),

114 
CONST64
(0x7fde815fbefe20c1), CONST64(0xd848753d7aade5a2), CONST64(0xe5a8329a29d77fcc), CONST64(0xb699c75ebc71e80a),

115 
CONST64
(0x70db904b96e03be6), CONST64(0x5632fac88dac9edb), CONST64(0xc4b751e6d1952215), CONST64(0x19fc2bd7b332ceaa),

116 
CONST64
(0x38e348ab4b709373), CONST64(0xbf9edc428463fd3b), CONST64(0xae91ef7efc41d052), CONST64(0xb09bcd56ac7de61c),

117 
CONST64
(0x3be24daf43769478), CONST64(0xd0bb6dd6b1bd0661), CONST64(0xc3415819329bdaf1), CONST64(0xb26ecba5577917e5),

118 
CONST64
(0xf2a50bae41f95cb3), CONST64(0x40cbc00b16804b56), CONST64(0xbd6bdab17f670cc2), CONST64(0xa295fb6edc59cc7e),

119 
CONST64
(0xfea11fbe61e1409f), CONST64(0x08f318ebcb10e3c3), CONST64(0xceb14ffee181302f), CONST64(0x06020a08100c0e16),

120 
CONST64
(0x49ccdb172e925e67), CONST64(0x51c4f3376ea2663f), CONST64(0x271d6974e84e53cf), CONST64(0x3c144450a0786c9c),

121 
CONST64
(0x58c3e82b56b0730e), CONST64(0xa563f2913f57349a), CONST64(0x73da954f9ee63ced), CONST64(0xe75d3469d2d38e35),

122 
CONST64
(0xe15f3e61c2df8023), CONST64(0x79dc8b57aef22ed7), CONST64(0x877d94e9cf136e48), CONST64(0x4acdde132694596c),

123 
CONST64
(0x817f9ee1df1f605e), CONST64(0xee5a2f75eac19b04), CONST64(0xb46cc1ad477519f3), CONST64(0xe45c316ddad5893e),

124 
CONST64
(0x04f70cfbeb08ffef), CONST64(0x6a26be982dd4f247), CONST64(0x1cff24dbab38c7b7), CONST64(0x2aed7e933b54b911),

125 
CONST64
(0x25e86f87134aa236), CONST64(0xba9dd34e9c69f426), CONST64(0xb16fcea15f7f10ee), CONST64(0x8f8e8c0204038d8b),

126 
CONST64
(0x2b197d64c8564fe3), CONST64(0xfda01aba69e74794), CONST64(0x0df017e7d31aeade), CONST64(0x8689971e3c1198ba),

127 
CONST64
(0x110f333c78222d69), CONST64(0x09071b1c38121531), CONST64(0xecaf298611c56afd), CONST64(0x10fb30cb8b20db9b),

128 
CONST64
(0x1808282040303858), CONST64(0x3f154154a87e6b97), CONST64(0x170d3934682e237f), CONST64(0x0c04141020181c2c),

129 
CONST64
(0x030105040806070b), CONST64(0xac64e98d074521ab), CONST64(0x7cdf845bb6f827ca), CONST64(0x9a76b3c597295f0d),

130 
CONST64
(0x8b7980f9ef0b7264), CONST64(0x7add8e53a6f429dc), CONST64(0x473dc9f4f58eb3b2), CONST64(0x3a164e58b074628a),

131 
CONST64
(0x413fc3fce582bda4), CONST64(0x5937ebdca5b285fc), CONST64(0xb76dc4a94f731ef8), CONST64(0x4838d8e0dd90a895),

132 
CONST64
(0xd6b967dea1b10877), CONST64(0x9573a2d1bf37442a), CONST64(0x26e96a831b4ca53d), CONST64(0x5f35e1d4b5be8bea),

133 
CONST64
(0xff551c4992e3b66d), CONST64(0x9371a8d9af3b4a3c), CONST64(0x8d7b8af1ff077c72), CONST64(0x898c860a140f839d),

134 
CONST64
(0x9672a7d5b7314321), CONST64(0x8588921a34179fb1), CONST64(0x07f609ffe30ef8e4), CONST64(0x7e2a82a84dfcd633),

135 
CONST64
(0x423ec6f8ed84baaf), CONST64(0xe25e3b65cad98728), CONST64(0x6927bb9c25d2f54c), CONST64(0xca4643050a89cfc0),

136 
CONST64
(0x140c3c3060282474), CONST64(0xaf65ec890f4326a0), CONST64(0xb868d5bd676d05df), CONST64(0xa361f8992f5b3a8c),

137 
CONST64
(0x05030f0c180a091d), CONST64(0x5ec1e22346bc7d18), CONST64(0xf957164182efb87b), CONST64(0x67d6a97ffece1899),

138 
CONST64
(0x76d99a4386ec35f0), CONST64(0xe858257dfacd9512), CONST64(0x75d89f478eea32fb), CONST64(0xaa66e38517492fbd),

139 
CONST64
(0x64d7ac7bf6c81f92), CONST64(0x4e3ad2e8cd9ca683), CONST64(0x45c8cf070e8a424b), CONST64(0x443cccf0fd88b4b9),

140 
CONST64
(0x13fa35cf8326dc90), CONST64(0xa796f462c453c563), CONST64(0xf4a701a651f552a5), CONST64(0xb598c25ab477ef01),

141 
CONST64
(0x29ec7b973352be1a), CONST64(0xd5b862daa9b70f7c), CONST64(0x54c7fc3b76a86f22), CONST64(0xefae2c8219c36df6),

142 
CONST64
(0xbb69d0b96f6b02d4), CONST64(0xdd4b7a3162a7ecbf), CONST64(0xe0ab3d9631dd76d1), CONST64(0xe6a9379e21d178c7),

143 
CONST64
(0xa967e6811f4f28b6), CONST64(0x1e0a2228503c364e), CONST64(0xc9474601028fc8cb), CONST64(0x0bf21defc316e4c8),

144 
CONST64
(0xc2b55beec1992c03), CONST64(0x6622aa880dccee6b), CONST64(0x32e556b37b648149), CONST64(0x2fee719f235eb00c),

145 
CONST64
(0xdfbe7cc299a31d46), CONST64(0x7d2b87ac45fad138), CONST64(0x9e81bf3e7c21a0e2), CONST64(0x36125a48906c7ea6),

146 
CONST64
(0x9883b5366c2daef4), CONST64(0x2d1b776cd85a41f5), CONST64(0x120e363870242a62), CONST64(0x6523af8c05cae960),

147 
CONST64
(0x02f506f3fb04f1f9), CONST64(0xcf454c091283c6dd), CONST64(0x6321a58415c6e776), CONST64(0x4fced11f3e9e5071),

148 
CONST64
(0xdb49703972abe2a9), CONST64(0x742c9cb07de8c409), CONST64(0x16f93ac39b2cd58d), CONST64(0x37e659bf636e8854),

149 
CONST64
(0xc7b654e2d993251e), CONST64(0x782888a05df0d825), CONST64(0x39174b5cb8726581), CONST64(0x9b82b032642ba9ff),

150 
CONST64
(0x2e1a7268d05c46fe), CONST64(0x808b9d162c1d96ac), CONST64(0x1ffe21dfa33ec0bc), CONST64(0x838a9812241b91a7),

151 
CONST64
(0x1b092d2448363f53), CONST64(0x46c9ca03068c4540), CONST64(0x9487a1264c35b2d8), CONST64(0xd24e6b254ab9f798),

152 
CONST64
(0x3ee142a35b7c9d65), CONST64(0x722e96b86de4ca1f), CONST64(0x31e453b773628642), CONST64(0x3de047a7537a9a6e),

153 
CONST64
(0x20eb608b0b40ab2b), CONST64(0xad90ea7af447d759), CONST64(0xf1a40eaa49ff5bb8), CONST64(0x221e6678f0445ad2),

154 
CONST64
(0x9285ab2e5c39bcce), CONST64(0xa060fd9d275d3d87), CONST64(0x0000000000000000), CONST64(0x6f25b19435defb5a),

155 
CONST64
(0x01f403f7f302f6f2), CONST64(0x0ef112e3db1cedd5), CONST64(0xa194fe6ad45fcb75), CONST64(0x1d0b272c583a3145),

156 
CONST64
(0x34e75cbb6b688f5f), CONST64(0x9f75bcc98f235610), CONST64(0x2cef749b2b58b707), CONST64(0x5c34e4d0bdb88ce1),

157 
CONST64
(0x5331f5c495a697c6), CONST64(0x61d4a377eec2168f), CONST64(0x6dd0b767ceda0aa3), CONST64(0x9786a4224433b5d3),

158 
CONST64
(0x827e9be5d7196755), CONST64(0xeaad238e01c964eb), CONST64(0x1afd2ed3bb34c9a1), CONST64(0x7b298da455f6df2e),

159 
CONST64
(0x5030f0c09da090cd), CONST64(0x4d3bd7ecc59aa188), CONST64(0xbc9fd9468c65fa30), CONST64(0x15f83fc7932ad286),

160 
CONST64
(0x57c6f93f7eae6829), CONST64(0x35135f4c986a79ad), CONST64(0x0a061e183014123a), CONST64(0x0f051114281e1b27),

161 
CONST64
(0x52c5f63366a46134), CONST64(0x33115544886677bb), CONST64(0x9977b6c19f2f5806), CONST64(0x847c91edc7156943),

162 
CONST64
(0x8e7a8ff5f7017b79), CONST64(0x887885fde70d756f), CONST64(0x5a36eed8adb482f7), CONST64(0x241c6c70e04854c4),

163 
CONST64
(0x4b39dde4d596af9e), CONST64(0xeb592079f2cb9219), CONST64(0x28187860c05048e8), CONST64(0xfa5613458ae9bf70),

164 
CONST64
(0xc8b345f6f18d3e39), CONST64(0xcdb04afae9873724), CONST64(0x6c24b4903dd8fc51), CONST64(0x6020a0801dc0e07d),

165 
CONST64
(0xcbb240f2f98b3932), CONST64(0xab92e072e44bd94f), CONST64(0xf8a315b671ed4e89), CONST64(0x5dc0e7274eba7a13),

166 
CONST64
(0xcc44490d1a85c1d6), CONST64(0xa662f79537513391), CONST64(0x30105040806070b0), CONST64(0xc1b45eeac99f2b08),

167 
CONST64
(0x9184ae2a543fbbc5), CONST64(0xc54352112297d4e7), CONST64(0xa893e576ec4dde44), CONST64(0x5bc2ed2f5eb67405),

168 
CONST64
(0xde4a7f356aa1ebb4), CONST64(0xdabd73ce81a9145b), CONST64(0x8c8f89060c058a80), CONST64(0x772d99b475eec302),

169 
CONST64
(0xd9bc76ca89af1350), CONST64(0xb99cd64a946ff32d), CONST64(0xbe6adfb577610bc9), CONST64(0xc0405d1d3a9dddfa),

170 
CONST64
(0x4ccfd41b3698577a), CONST64(0xfba210b279eb4982), CONST64(0x9d80ba3a7427a7e9), CONST64(0xd14f6e2142bff093),

171 
CONST64
(0x211f637cf8425dd9), CONST64(0x43cac50f1e864c5d), CONST64(0xe3aa389239db71da), CONST64(0xc64257152a91d3ec),

174 cÚ¡ 
ulÚg64
 
	gT2
[256] = {

175 
CONST64
(0xd268bad36a01bbb9), CONST64(0x4d1954fc66b1e59a), CONST64(0xbc932f7114cde265), CONST64(0xcdb9749c1b512587),

176 
CONST64
(0x510253f557a4f7a2), CONST64(0x6bb8d368be03d0d6), CONST64(0x6fbdd26bb504d6de), CONST64(0x29644dd785feb352),

177 
CONST64
(0x5d0d50f04aadfdba), CONST64(0x8a26ace9e063cf09), CONST64(0x0e838d8a9684091c), CONST64(0xc679bfdc4d1aa591),

178 
CONST64
(0xddad7090374d3da7), CONST64(0x550752f65ca3f1aa), CONST64(0x52c89ab317e17ba4), CONST64(0x2d614cd48ef9b55a),

179 
CONST64
(0x8f65ea2320ac4603), CONST64(0x73a6d5628411c4e6), CONST64(0x66f197a468c255cc), CONST64(0x63b2d16ea80ddcc6),

180 
CONST64
(0xccff3355d099aa85), CONST64(0x590851f341aafbb2), CONST64(0x712a5bed0f9cc7e2), CONST64(0xa204a6f7ae55f359),

181 
CONST64
(0x5f81de7fc120febe), CONST64(0x3d7548d8a2e5ad7a), CONST64(0x9a32a8e5cc7fd729), CONST64(0x5ec799b60ae871bc),

182 
CONST64
(0x4b90db70e63be096), CONST64(0xc8fa3256db9eac8d), CONST64(0xe651b7c4152295d1), CONST64(0xd72bfc19aace32b3),

183 
CONST64
(0xab48e3387393704b), CONST64(0x42dc9ebf3bfd6384), CONST64(0x7eef91ae52d041fc), CONST64(0x56cd9bb01ce67dac),

184 
CONST64
(0xaf4de23b78947643), CONST64(0xd66dbbd06106bdb1), CONST64(0x195841c3f1da9b32), CONST64(0xa5cb6eb2e5177957),

185 
CONST64
(0xae0ba5f2b35cf941), CONST64(0x0bc0cb40564b8016), CONST64(0xb1da6bbdc20c677f), CONST64(0x6efb95a27ecc59dc),

186 
CONST64
(0xbe1fa1fe9f40e161), CONST64(0xeb18f308c3e310cb), CONST64(0xfe4fb1ce2f3081e1), CONST64(0x080a0206160e0c10),

187 
CONST64
(0x17dbcc49675e922e), CONST64(0x37f3c4513f66a26e), CONST64(0x74691d27cf534ee8), CONST64(0x5044143c9c6c78a0),

188 
CONST64
(0x2be8c3580e73b056), CONST64(0x91f263a59a34573f), CONST64(0x4f95da73ed3ce69e), CONST64(0x69345de7358ed3d2),

189 
CONST64
(0x613e5fe12380dfc2), CONST64(0x578bdc79d72ef2ae), CONST64(0xe9947d87486e13cf), CONST64(0x13decd4a6c599426),

190 
CONST64
(0xe19e7f815e601fdf), CONST64(0x752f5aee049bc1ea), CONST64(0xadc16cb4f3197547), CONST64(0x6d315ce43e89d5da),

191 
CONST64
(0xfb0cf704efff08eb), CONST64(0x98be266a47f2d42d), CONST64(0xdb24ff1cb7c738ab), CONST64(0x937eed2a11b9543b),

192 
CONST64
(0x876fe82536a24a13), CONST64(0x4ed39dba26f4699c), CONST64(0xa1ce6fb1ee107f5f), CONST64(0x028c8e8f8b8d0304),

193 
CONST64
(0x647d192be34f56c8), CONST64(0xba1aa0fd9447e769), CONST64(0xe717f00ddeea1ad3), CONST64(0x1e978986ba98113c),

194 
CONST64
(0x3c330f11692d2278), CONST64(0x1c1b070931151238), CONST64(0x8629afecfd6ac511), CONST64(0xcb30fb109bdb208b),

195 
CONST64
(0x2028081858383040), CONST64(0x5441153f976b7ea8), CONST64(0x34390d177f232e68), CONST64(0x1014040c2c1c1820),

196 
CONST64
(0x040501030b070608), CONST64(0x8de964acab214507), CONST64(0x5b84df7cca27f8b6), CONST64(0xc5b3769a0d5f2997),

197 
CONST64
(0xf980798b64720bef), CONST64(0x538edd7adc29f4a6), CONST64(0xf4c93d47b2b38ef5), CONST64(0x584e163a8a6274b0),

198 
CONST64
(0xfcc33f41a4bd82e5), CONST64(0xdceb3759fc85b2a5), CONST64(0xa9c46db7f81e734f), CONST64(0xe0d8384895a890dd),

199 
CONST64
(0xde67b9d67708b1a1), CONST64(0xd1a273952a4437bf), CONST64(0x836ae9263da54c1b), CONST64(0xd4e1355fea8bbeb5),

200 
CONST64
(0x491c55ff6db6e392), CONST64(0xd9a871933c4a3baf), CONST64(0xf18a7b8d727c07ff), CONST64(0x0a868c899d830f14),

201 
CONST64
(0xd5a77296214331b7), CONST64(0x1a928885b19f1734), CONST64(0xff09f607e4f80ee3), CONST64(0xa8822a7e33d6fc4d),

202 
CONST64
(0xf8c63e42afba84ed), CONST64(0x653b5ee22887d9ca), CONST64(0x9cbb27694cf5d225), CONST64(0x054346cac0cf890a),

203 
CONST64
(0x303c0c1474242860), CONST64(0x89ec65afa026430f), CONST64(0xbdd568b8df056d67), CONST64(0x99f861a38c3a5b2f),

204 
CONST64
(0x0c0f03051d090a18), CONST64(0x23e2c15e187dbc46), CONST64(0x411657f97bb8ef82), CONST64(0x7fa9d6679918cefe),

205 
CONST64
(0x439ad976f035ec86), CONST64(0x7d2558e81295cdfa), CONST64(0x479fd875fb32ea8e), CONST64(0x85e366aabd2f4917),

206 
CONST64
(0x7bacd764921fc8f6), CONST64(0xe8d23a4e83a69ccd), CONST64(0x07cfc8454b428a0e), CONST64(0xf0cc3c44b9b488fd),

207 
CONST64
(0xcf35fa1390dc2683), CONST64(0x62f496a763c553c4), CONST64(0xa601a7f4a552f551), CONST64(0x5ac298b501ef77b4),

208 
CONST64
(0x977bec291abe5233), CONST64(0xda62b8d57c0fb7a9), CONST64(0x3bfcc754226fa876), CONST64(0x822caeeff66dc319),

209 
CONST64
(0xb9d069bbd4026b6f), CONST64(0x317a4bddbfeca762), CONST64(0x963dabe0d176dd31), CONST64(0x9e37a9e6c778d121),

210 
CONST64
(0x81e667a9b6284f1f), CONST64(0x28220a1e4e363c50), CONST64(0x014647c9cbc88f02), CONST64(0xef1df20bc8e416c3),

211 
CONST64
(0xee5bb5c2032c99c1), CONST64(0x88aa22666beecc0d), CONST64(0xb356e5324981647b), CONST64(0x9f71ee2f0cb05e23),

212 
CONST64
(0xc27cbedf461da399), CONST64(0xac872b7d38d1fa45), CONST64(0x3ebf819ee2a0217c), CONST64(0x485a1236a67e6c90),

213 
CONST64
(0x36b58398f4ae2d6c), CONST64(0x6c771b2df5415ad8), CONST64(0x38360e12622a2470), CONST64(0x8caf236560e9ca05),

214 
CONST64
(0xf306f502f9f104fb), CONST64(0x094c45cfddc68312), CONST64(0x84a5216376e7c615), CONST64(0x1fd1ce4f71509e3e),

215 
CONST64
(0x397049dba9e2ab72), CONST64(0xb09c2c7409c4e87d), CONST64(0xc33af9168dd52c9b), CONST64(0xbf59e63754886e63),

216 
CONST64
(0xe254b6c71e2593d9), CONST64(0xa088287825d8f05d), CONST64(0x5c4b1739816572b8), CONST64(0x32b0829bffa92b64),

217 
CONST64
(0x68721a2efe465cd0), CONST64(0x169d8b80ac961d2c), CONST64(0xdf21fe1fbcc03ea3), CONST64(0x12988a83a7911b24),

218 
CONST64
(0x242d091b533f3648), CONST64(0x03cac94640458c06), CONST64(0x26a18794d8b2354c), CONST64(0x256b4ed298f7b94a),

219 
CONST64
(0xa342e13e659d7c5b), CONST64(0xb8962e721fcae46d), CONST64(0xb753e43142866273), CONST64(0xa747e03d6e9a7a53),

220 
CONST64
(0x8b60eb202bab400b), CONST64(0x7aea90ad59d747f4), CONST64(0xaa0ea4f1b85bff49), CONST64(0x78661e22d25a44f0),

221 
CONST64
(0x2eab8592cebc395c), CONST64(0x9dfd60a0873d5d27), CONST64(0x0000000000000000), CONST64(0x94b1256f5afbde35),

222 
CONST64
(0xf703f401f2f602f3), CONST64(0xe312f10ed5ed1cdb), CONST64(0x6afe94a175cb5fd4), CONST64(0x2c270b1d45313a58),

223 
CONST64
(0xbb5ce7345f8f686b), CONST64(0xc9bc759f1056238f), CONST64(0x9b74ef2c07b7582b), CONST64(0xd0e4345ce18cb8bd),

224 
CONST64
(0xc4f53153c697a695), CONST64(0x77a3d4618f16c2ee), CONST64(0x67b7d06da30adace), CONST64(0x22a48697d3b53344),

225 
CONST64
(0xe59b7e82556719d7), CONST64(0x8e23adeaeb64c901), CONST64(0xd32efd1aa1c934bb), CONST64(0xa48d297b2edff655),

226 
CONST64
(0xc0f03050cd90a09d), CONST64(0xecd73b4d88a19ac5), CONST64(0x46d99fbc30fa658c), CONST64(0xc73ff81586d22a93),

227 
CONST64
(0x3ff9c6572968ae7e), CONST64(0x4c5f1335ad796a98), CONST64(0x181e060a3a121430), CONST64(0x1411050f271b1e28),

228 
CONST64
(0x33f6c5523461a466), CONST64(0x44551133bb776688), CONST64(0xc1b6779906582f9f), CONST64(0xed917c84436915c7),

229 
CONST64
(0xf58f7a8e797b01f7), CONST64(0xfd8578886f750de7), CONST64(0xd8ee365af782b4ad), CONST64(0x706c1c24c45448e0),

230 
CONST64
(0xe4dd394b9eaf96d5), CONST64(0x792059eb1992cbf2), CONST64(0x60781828e84850c0), CONST64(0x451356fa70bfe98a),

231 
CONST64
(0xf645b3c8393e8df1), CONST64(0xfa4ab0cd243787e9), CONST64(0x90b4246c51fcd83d), CONST64(0x80a020607de0c01d),

232 
CONST64
(0xf240b2cb32398bf9), CONST64(0x72e092ab4fd94be4), CONST64(0xb615a3f8894eed71), CONST64(0x27e7c05d137aba4e),

233 
CONST64
(0x0d4944ccd6c1851a), CONST64(0x95f762a691335137), CONST64(0x40501030b0706080), CONST64(0xea5eb4c1082b9fc9),

234 
CONST64
(0x2aae8491c5bb3f54), CONST64(0x115243c5e7d49722), CONST64(0x76e593a844de4dec), CONST64(0x2fedc25b0574b65e),

235 
CONST64
(0x357f4adeb4eba16a), CONST64(0xce73bdda5b14a981), CONST64(0x06898f8c808a050c), CONST64(0xb4992d7702c3ee75),

236 
CONST64
(0xca76bcd95013af89), CONST64(0x4ad69cb92df36f94), CONST64(0xb5df6abec90b6177), CONST64(0x1d5d40c0fadd9d3a),

237 
CONST64
(0x1bd4cf4c7a579836), CONST64(0xb210a2fb8249eb79), CONST64(0x3aba809de9a72774), CONST64(0x216e4fd193f0bf42),

238 
CONST64
(0x7c631f21d95d42f8), CONST64(0x0fc5ca435d4c861e), CONST64(0x9238aae3da71db39), CONST64(0x155742c6ecd3912a),

241 cÚ¡ 
ulÚg64
 
	gT3
[256] = {

242 
CONST64
(0x68d2d3ba016ab9bb), CONST64(0x194dfc54b1669ae5), CONST64(0x93bc712fcd1465e2), CONST64(0xb9cd9c74511b8725),

243 
CONST64
(0x0251f553a457a2f7), CONST64(0xb86b68d303bed6d0), CONST64(0xbd6f6bd204b5ded6), CONST64(0x6429d74dfe8552b3),

244 
CONST64
(0x0d5df050ad4abafd), CONST64(0x268ae9ac63e009cf), CONST64(0x830e8a8d84961c09), CONST64(0x79c6dcbf1a4d91a5),

245 
CONST64
(0xaddd90704d37a73d), CONST64(0x0755f652a35caaf1), CONST64(0xc852b39ae117a47b), CONST64(0x612dd44cf98e5ab5),

246 
CONST64
(0x658f23eaac200346), CONST64(0xa67362d51184e6c4), CONST64(0xf166a497c268cc55), CONST64(0xb2636ed10da8c6dc),

247 
CONST64
(0xffcc553399d085aa), CONST64(0x0859f351aa41b2fb), CONST64(0x2a71ed5b9c0fe2c7), CONST64(0x04a2f7a655ae59f3),

248 
CONST64
(0x815f7fde20c1befe), CONST64(0x753dd848e5a27aad), CONST64(0x329ae5a87fcc29d7), CONST64(0xc75eb699e80abc71),

249 
CONST64
(0x904b70db3be696e0), CONST64(0xfac856329edb8dac), CONST64(0x51e6c4b72215d195), CONST64(0x2bd719fcceaab332),

250 
CONST64
(0x48ab38e393734b70), CONST64(0xdc42bf9efd3b8463), CONST64(0xef7eae91d052fc41), CONST64(0xcd56b09be61cac7d),

251 
CONST64
(0x4daf3be294784376), CONST64(0x6dd6d0bb0661b1bd), CONST64(0x5819c341daf1329b), CONST64(0xcba5b26e17e55779),

252 
CONST64
(0x0baef2a55cb341f9), CONST64(0xc00b40cb4b561680), CONST64(0xdab1bd6b0cc27f67), CONST64(0xfb6ea295cc7edc59),

253 
CONST64
(0x1fbefea1409f61e1), CONST64(0x18eb08f3e3c3cb10), CONST64(0x4ffeceb1302fe181), CONST64(0x0a0806020e16100c),

254 
CONST64
(0xdb1749cc5e672e92), CONST64(0xf33751c4663f6ea2), CONST64(0x6974271d53cfe84e), CONST64(0x44503c146c9ca078),

255 
CONST64
(0xe82b58c3730e56b0), CONST64(0xf291a563349a3f57), CONST64(0x954f73da3ced9ee6), CONST64(0x3469e75d8e35d2d3),

256 
CONST64
(0x3e61e15f8023c2df), CONST64(0x8b5779dc2ed7aef2), CONST64(0x94e9877d6e48cf13), CONST64(0xde134acd596c2694),

257 
CONST64
(0x9ee1817f605edf1f), CONST64(0x2f75ee5a9b04eac1), CONST64(0xc1adb46c19f34775), CONST64(0x316de45c893edad5),

258 
CONST64
(0x0cfb04f7ffefeb08), CONST64(0xbe986a26f2472dd4), CONST64(0x24db1cffc7b7ab38), CONST64(0x7e932aedb9113b54),

259 
CONST64
(0x6f8725e8a236134a), CONST64(0xd34eba9df4269c69), CONST64(0xcea1b16f10ee5f7f), CONST64(0x8c028f8e8d8b0403),

260 
CONST64
(0x7d642b194fe3c856), CONST64(0x1abafda0479469e7), CONST64(0x17e70df0eaded31a), CONST64(0x971e868998ba3c11),

261 
CONST64
(0x333c110f2d697822), CONST64(0x1b1c090715313812), CONST64(0x2986ecaf6afd11c5), CONST64(0x30cb10fbdb9b8b20),

262 
CONST64
(0x2820180838584030), CONST64(0x41543f156b97a87e), CONST64(0x3934170d237f682e), CONST64(0x14100c041c2c2018),

263 
CONST64
(0x05040301070b0806), CONST64(0xe98dac6421ab0745), CONST64(0x845b7cdf27cab6f8), CONST64(0xb3c59a765f0d9729),

264 
CONST64
(0x80f98b797264ef0b), CONST64(0x8e537add29dca6f4), CONST64(0xc9f4473db3b2f58e), CONST64(0x4e583a16628ab074),

265 
CONST64
(0xc3fc413fbda4e582), CONST64(0xebdc593785fca5b2), CONST64(0xc4a9b76d1ef84f73), CONST64(0xd8e04838a895dd90),

266 
CONST64
(0x67ded6b90877a1b1), CONST64(0xa2d19573442abf37), CONST64(0x6a8326e9a53d1b4c), CONST64(0xe1d45f358beab5be),

267 
CONST64
(0x1c49ff55b66d92e3), CONST64(0xa8d993714a3caf3b), CONST64(0x8af18d7b7c72ff07), CONST64(0x860a898c839d140f),

268 
CONST64
(0xa7d596724321b731), CONST64(0x921a85889fb13417), CONST64(0x09ff07f6f8e4e30e), CONST64(0x82a87e2ad6334dfc),

269 
CONST64
(0xc6f8423ebaafed84), CONST64(0x3b65e25e8728cad9), CONST64(0xbb9c6927f54c25d2), CONST64(0x4305ca46cfc00a89),

270 
CONST64
(0x3c30140c24746028), CONST64(0xec89af6526a00f43), CONST64(0xd5bdb86805df676d), CONST64(0xf899a3613a8c2f5b),

271 
CONST64
(0x0f0c0503091d180a), CONST64(0xe2235ec17d1846bc), CONST64(0x1641f957b87b82ef), CONST64(0xa97f67d61899fece),

272 
CONST64
(0x9a4376d935f086ec), CONST64(0x257de8589512facd), CONST64(0x9f4775d832fb8eea), CONST64(0xe385aa662fbd1749),

273 
CONST64
(0xac7b64d71f92f6c8), CONST64(0xd2e84e3aa683cd9c), CONST64(0xcf0745c8424b0e8a), CONST64(0xccf0443cb4b9fd88),

274 
CONST64
(0x35cf13fadc908326), CONST64(0xf462a796c563c453), CONST64(0x01a6f4a752a551f5), CONST64(0xc25ab598ef01b477),

275 
CONST64
(0x7b9729ecbe1a3352), CONST64(0x62dad5b80f7ca9b7), CONST64(0xfc3b54c76f2276a8), CONST64(0x2c82efae6df619c3),

276 
CONST64
(0xd0b9bb6902d46f6b), CONST64(0x7a31dd4becbf62a7), CONST64(0x3d96e0ab76d131dd), CONST64(0x379ee6a978c721d1),

277 
CONST64
(0xe681a96728b61f4f), CONST64(0x22281e0a364e503c), CONST64(0x4601c947c8cb028f), CONST64(0x1def0bf2e4c8c316),

278 
CONST64
(0x5beec2b52c03c199), CONST64(0xaa886622ee6b0dcc), CONST64(0x56b332e581497b64), CONST64(0x719f2feeb00c235e),

279 
CONST64
(0x7cc2dfbe1d4699a3), CONST64(0x87ac7d2bd13845fa), CONST64(0xbf3e9e81a0e27c21), CONST64(0x5a4836127ea6906c),

280 
CONST64
(0xb5369883aef46c2d), CONST64(0x776c2d1b41f5d85a), CONST64(0x3638120e2a627024), CONST64(0xaf8c6523e96005ca),

281 
CONST64
(0x06f302f5f1f9fb04), CONST64(0x4c09cf45c6dd1283), CONST64(0xa5846321e77615c6), CONST64(0xd11f4fce50713e9e),

282 
CONST64
(0x7039db49e2a972ab), CONST64(0x9cb0742cc4097de8), CONST64(0x3ac316f9d58d9b2c), CONST64(0x59bf37e68854636e),

283 
CONST64
(0x54e2c7b6251ed993), CONST64(0x88a07828d8255df0), CONST64(0x4b5c39176581b872), CONST64(0xb0329b82a9ff642b),

284 
CONST64
(0x72682e1a46fed05c), CONST64(0x9d16808b96ac2c1d), CONST64(0x21df1ffec0bca33e), CONST64(0x9812838a91a7241b),

285 
CONST64
(0x2d241b093f534836), CONST64(0xca0346c94540068c), CONST64(0xa1269487b2d84c35), CONST64(0x6b25d24ef7984ab9),

286 
CONST64
(0x42a33ee19d655b7c), CONST64(0x96b8722eca1f6de4), CONST64(0x53b731e486427362), CONST64(0x47a73de09a6e537a),

287 
CONST64
(0x608b20ebab2b0b40), CONST64(0xea7aad90d759f447), CONST64(0x0eaaf1a45bb849ff), CONST64(0x6678221e5ad2f044),

288 
CONST64
(0xab2e9285bcce5c39), CONST64(0xfd9da0603d87275d), CONST64(0x0000000000000000), CONST64(0xb1946f25fb5a35de),

289 
CONST64
(0x03f701f4f6f2f302), CONST64(0x12e30ef1edd5db1c), CONST64(0xfe6aa194cb75d45f), CONST64(0x272c1d0b3145583a),

290 
CONST64
(0x5cbb34e78f5f6b68), CONST64(0xbcc99f7556108f23), CONST64(0x749b2cefb7072b58), CONST64(0xe4d05c348ce1bdb8),

291 
CONST64
(0xf5c4533197c695a6), CONST64(0xa37761d4168feec2), CONST64(0xb7676dd00aa3ceda), CONST64(0xa4229786b5d34433),

292 
CONST64
(0x9be5827e6755d719), CONST64(0x238eeaad64eb01c9), CONST64(0x2ed31afdc9a1bb34), CONST64(0x8da47b29df2e55f6),

293 
CONST64
(0xf0c0503090cd9da0), CONST64(0xd7ec4d3ba188c59a), CONST64(0xd946bc9ffa308c65), CONST64(0x3fc715f8d286932a),

294 
CONST64
(0xf93f57c668297eae), CONST64(0x5f4c351379ad986a), CONST64(0x1e180a06123a3014), CONST64(0x11140f051b27281e),

295 
CONST64
(0xf63352c5613466a4), CONST64(0x5544331177bb8866), CONST64(0xb6c1997758069f2f), CONST64(0x91ed847c6943c715),

296 
CONST64
(0x8ff58e7a7b79f701), CONST64(0x85fd8878756fe70d), CONST64(0xeed85a3682f7adb4), CONST64(0x6c70241c54c4e048),

297 
CONST64
(0xdde44b39af9ed596), CONST64(0x2079eb599219f2cb), CONST64(0x7860281848e8c050), CONST64(0x1345fa56bf708ae9),

298 
CONST64
(0x45f6c8b33e39f18d), CONST64(0x4afacdb03724e987), CONST64(0xb4906c24fc513dd8), CONST64(0xa0806020e07d1dc0),

299 
CONST64
(0x40f2cbb23932f98b), CONST64(0xe072ab92d94fe44b), CONST64(0x15b6f8a34e8971ed), CONST64(0xe7275dc07a134eba),

300 
CONST64
(0x490dcc44c1d61a85), CONST64(0xf795a66233913751), CONST64(0x5040301070b08060), CONST64(0x5eeac1b42b08c99f),

301 
CONST64
(0xae2a9184bbc5543f), CONST64(0x5211c543d4e72297), CONST64(0xe576a893de44ec4d), CONST64(0xed2f5bc274055eb6),

302 
CONST64
(0x7f35de4aebb46aa1), CONST64(0x73cedabd145b81a9), CONST64(0x89068c8f8a800c05), CONST64(0x99b4772dc30275ee),

303 
CONST64
(0x76cad9bc135089af), CONST64(0xd64ab99cf32d946f), CONST64(0xdfb5be6a0bc97761), CONST64(0x5d1dc040ddfa3a9d),

304 
CONST64
(0xd41b4ccf577a3698), CONST64(0x10b2fba2498279eb), CONST64(0xba3a9d80a7e97427), CONST64(0x6e21d14ff09342bf),

305 
CONST64
(0x637c211f5dd9f842), CONST64(0xc50f43ca4c5d1e86), CONST64(0x3892e3aa71da39db), CONST64(0x5715c642d3ec2a91),

308 cÚ¡ 
ulÚg64
 
	gT4
[256] = {

309 
CONST64
(0xbbb96a01bad3d268), CONST64(0xe59a66b154fc4d19), CONST64(0xe26514cd2f71bc93), CONST64(0x25871b51749ccdb9),

310 
CONST64
(0xf7a257a453f55102), CONST64(0xd0d6be03d3686bb8), CONST64(0xd6deb504d26b6fbd), CONST64(0xb35285fe4dd72964),

311 
CONST64
(0xfdba4aad50f05d0d), CONST64(0xcf09e063ace98a26), CONST64(0x091c96848d8a0e83), CONST64(0xa5914d1abfdcc679),

312 
CONST64
(0x3da7374d7090ddad), CONST64(0xf1aa5ca352f65507), CONST64(0x7ba417e19ab352c8), CONST64(0xb55a8ef94cd42d61),

313 
CONST64
(0x460320acea238f65), CONST64(0xc4e68411d56273a6), CONST64(0x55cc68c297a466f1), CONST64(0xdcc6a80dd16e63b2),

314 
CONST64
(0xaa85d0993355ccff), CONST64(0xfbb241aa51f35908), CONST64(0xc7e20f9c5bed712a), CONST64(0xf359ae55a6f7a204),

315 
CONST64
(0xfebec120de7f5f81), CONST64(0xad7aa2e548d83d75), CONST64(0xd729cc7fa8e59a32), CONST64(0x71bc0ae899b65ec7),

316 
CONST64
(0xe096e63bdb704b90), CONST64(0xac8ddb9e3256c8fa), CONST64(0x95d11522b7c4e651), CONST64(0x32b3aacefc19d72b),

317 
CONST64
(0x704b7393e338ab48), CONST64(0x63843bfd9ebf42dc), CONST64(0x41fc52d091ae7eef), CONST64(0x7dac1ce69bb056cd),

318 
CONST64
(0x76437894e23baf4d), CONST64(0xbdb16106bbd0d66d), CONST64(0x9b32f1da41c31958), CONST64(0x7957e5176eb2a5cb),

319 
CONST64
(0xf941b35ca5f2ae0b), CONST64(0x8016564bcb400bc0), CONST64(0x677fc20c6bbdb1da), CONST64(0x59dc7ecc95a26efb),

320 
CONST64
(0xe1619f40a1febe1f), CONST64(0x10cbc3e3f308eb18), CONST64(0x81e12f30b1cefe4f), CONST64(0x0c10160e0206080a),

321 
CONST64
(0x922e675ecc4917db), CONST64(0xa26e3f66c45137f3), CONST64(0x4ee8cf531d277469), CONST64(0x78a09c6c143c5044),

322 
CONST64
(0xb0560e73c3582be8), CONST64(0x573f9a3463a591f2), CONST64(0xe69eed3cda734f95), CONST64(0xd3d2358e5de76934),

323 
CONST64
(0xdfc223805fe1613e), CONST64(0xf2aed72edc79578b), CONST64(0x13cf486e7d87e994), CONST64(0x94266c59cd4a13de),

324 
CONST64
(0x1fdf5e607f81e19e), CONST64(0xc1ea049b5aee752f), CONST64(0x7547f3196cb4adc1), CONST64(0xd5da3e895ce46d31),

325 
CONST64
(0x08ebeffff704fb0c), CONST64(0xd42d47f2266a98be), CONST64(0x38abb7c7ff1cdb24), CONST64(0x543b11b9ed2a937e),

326 
CONST64
(0x4a1336a2e825876f), CONST64(0x699c26f49dba4ed3), CONST64(0x7f5fee106fb1a1ce), CONST64(0x03048b8d8e8f028c),

327 
CONST64
(0x56c8e34f192b647d), CONST64(0xe7699447a0fdba1a), CONST64(0x1ad3deeaf00de717), CONST64(0x113cba9889861e97),

328 
CONST64
(0x2278692d0f113c33), CONST64(0x1238311507091c1b), CONST64(0xc511fd6aafec8629), CONST64(0x208b9bdbfb10cb30),

329 
CONST64
(0x3040583808182028), CONST64(0x7ea8976b153f5441), CONST64(0x2e687f230d173439), CONST64(0x18202c1c040c1014),

330 
CONST64
(0x06080b0701030405), CONST64(0x4507ab2164ac8de9), CONST64(0xf8b6ca27df7c5b84), CONST64(0x29970d5f769ac5b3),

331 
CONST64
(0x0bef6472798bf980), CONST64(0xf4a6dc29dd7a538e), CONST64(0x8ef5b2b33d47f4c9), CONST64(0x74b08a62163a584e),

332 
CONST64
(0x82e5a4bd3f41fcc3), CONST64(0xb2a5fc853759dceb), CONST64(0x734ff81e6db7a9c4), CONST64(0x90dd95a83848e0d8),

333 
CONST64
(0xb1a17708b9d6de67), CONST64(0x37bf2a447395d1a2), CONST64(0x4c1b3da5e926836a), CONST64(0xbeb5ea8b355fd4e1),

334 
CONST64
(0xe3926db655ff491c), CONST64(0x3baf3c4a7193d9a8), CONST64(0x07ff727c7b8df18a), CONST64(0x0f149d838c890a86),

335 
CONST64
(0x31b721437296d5a7), CONST64(0x1734b19f88851a92), CONST64(0x0ee3e4f8f607ff09), CONST64(0xfc4d33d62a7ea882),

336 
CONST64
(0x84edafba3e42f8c6), CONST64(0xd9ca28875ee2653b), CONST64(0xd2254cf527699cbb), CONST64(0x890ac0cf46ca0543),

337 
CONST64
(0x286074240c14303c), CONST64(0x430fa02665af89ec), CONST64(0x6d67df0568b8bdd5), CONST64(0x5b2f8c3a61a399f8),

338 
CONST64
(0x0a181d0903050c0f), CONST64(0xbc46187dc15e23e2), CONST64(0xef827bb857f94116), CONST64(0xcefe9918d6677fa9),

339 
CONST64
(0xec86f035d976439a), CONST64(0xcdfa129558e87d25), CONST64(0xea8efb32d875479f), CONST64(0x4917bd2f66aa85e3),

340 
CONST64
(0xc8f6921fd7647bac), CONST64(0x9ccd83a63a4ee8d2), CONST64(0x8a0e4b42c84507cf), CONST64(0x88fdb9b43c44f0cc),

341 
CONST64
(0x268390dcfa13cf35), CONST64(0x53c463c596a762f4), CONST64(0xf551a552a7f4a601), CONST64(0x77b401ef98b55ac2),

342 
CONST64
(0x52331abeec29977b), CONST64(0xb7a97c0fb8d5da62), CONST64(0xa876226fc7543bfc), CONST64(0xc319f66daeef822c),

343 
CONST64
(0x6b6fd40269bbb9d0), CONST64(0xa762bfec4bdd317a), CONST64(0xdd31d176abe0963d), CONST64(0xd121c778a9e69e37),

344 
CONST64
(0x4f1fb62867a981e6), CONST64(0x3c504e360a1e2822), CONST64(0x8f02cbc847c90146), CONST64(0x16c3c8e4f20bef1d),

345 
CONST64
(0x99c1032cb5c2ee5b), CONST64(0xcc0d6bee226688aa), CONST64(0x647b4981e532b356), CONST64(0x5e230cb0ee2f9f71),

346 
CONST64
(0xa399461dbedfc27c), CONST64(0xfa4538d12b7dac87), CONST64(0x217ce2a0819e3ebf), CONST64(0x6c90a67e1236485a),

347 
CONST64
(0x2d6cf4ae839836b5), CONST64(0x5ad8f5411b2d6c77), CONST64(0x2470622a0e123836), CONST64(0xca0560e923658caf),

348 
CONST64
(0x04fbf9f1f502f306), CONST64(0x8312ddc645cf094c), CONST64(0xc61576e7216384a5), CONST64(0x9e3e7150ce4f1fd1),

349 
CONST64
(0xab72a9e249db3970), CONST64(0xe87d09c42c74b09c), CONST64(0x2c9b8dd5f916c33a), CONST64(0x6e635488e637bf59),

350 
CONST64
(0x93d91e25b6c7e254), CONST64(0xf05d25d82878a088), CONST64(0x72b8816517395c4b), CONST64(0x2b64ffa9829b32b0),

351 
CONST64
(0x5cd0fe461a2e6872), CONST64(0x1d2cac968b80169d), CONST64(0x3ea3bcc0fe1fdf21), CONST64(0x1b24a7918a831298),

352 
CONST64
(0x3648533f091b242d), CONST64(0x8c064045c94603ca), CONST64(0x354cd8b2879426a1), CONST64(0xb94a98f74ed2256b),

353 
CONST64
(0x7c5b659de13ea342), CONST64(0xe46d1fca2e72b896), CONST64(0x62734286e431b753), CONST64(0x7a536e9ae03da747),

354 
CONST64
(0x400b2babeb208b60), CONST64(0x47f459d790ad7aea), CONST64(0xff49b85ba4f1aa0e), CONST64(0x44f0d25a1e227866),

355 
CONST64
(0x395ccebc85922eab), CONST64(0x5d27873d60a09dfd), CONST64(0x0000000000000000), CONST64(0xde355afb256f94b1),

356 
CONST64
(0x02f3f2f6f401f703), CONST64(0x1cdbd5edf10ee312), CONST64(0x5fd475cb94a16afe), CONST64(0x3a5845310b1d2c27),

357 
CONST64
(0x686b5f8fe734bb5c), CONST64(0x238f1056759fc9bc), CONST64(0x582b07b7ef2c9b74), CONST64(0xb8bde18c345cd0e4),

358 
CONST64
(0xa695c6973153c4f5), CONST64(0xc2ee8f16d46177a3), CONST64(0xdacea30ad06d67b7), CONST64(0x3344d3b5869722a4),

359 
CONST64
(0x19d755677e82e59b), CONST64(0xc901eb64adea8e23), CONST64(0x34bba1c9fd1ad32e), CONST64(0xf6552edf297ba48d),

360 
CONST64
(0xa09dcd903050c0f0), CONST64(0x9ac588a13b4decd7), CONST64(0x658c30fa9fbc46d9), CONST64(0x2a9386d2f815c73f),

361 
CONST64
(0xae7e2968c6573ff9), CONST64(0x6a98ad7913354c5f), CONST64(0x14303a12060a181e), CONST64(0x1e28271b050f1411),

362 
CONST64
(0xa4663461c55233f6), CONST64(0x6688bb7711334455), CONST64(0x2f9f06587799c1b6), CONST64(0x15c743697c84ed91),

363 
CONST64
(0x01f7797b7a8ef58f), CONST64(0x0de76f757888fd85), CONST64(0xb4adf782365ad8ee), CONST64(0x48e0c4541c24706c),

364 
CONST64
(0x96d59eaf394be4dd), CONST64(0xcbf2199259eb7920), CONST64(0x50c0e84818286078), CONST64(0xe98a70bf56fa4513),

365 
CONST64
(0x8df1393eb3c8f645), CONST64(0x87e92437b0cdfa4a), CONST64(0xd83d51fc246c90b4), CONST64(0xc01d7de0206080a0),

366 
CONST64
(0x8bf93239b2cbf240), CONST64(0x4be44fd992ab72e0), CONST64(0xed71894ea3f8b615), CONST64(0xba4e137ac05d27e7),

367 
CONST64
(0x851ad6c144cc0d49), CONST64(0x5137913362a695f7), CONST64(0x6080b07010304050), CONST64(0x9fc9082bb4c1ea5e),

368 
CONST64
(0x3f54c5bb84912aae), CONST64(0x9722e7d443c51152), CONST64(0x4dec44de93a876e5), CONST64(0xb65e0574c25b2fed),

369 
CONST64
(0xa16ab4eb4ade357f), CONST64(0xa9815b14bddace73), CONST64(0x050c808a8f8c0689), CONST64(0xee7502c32d77b499),

370 
CONST64
(0xaf895013bcd9ca76), CONST64(0x6f942df39cb94ad6), CONST64(0x6177c90b6abeb5df), CONST64(0x9d3afadd40c01d5d),

371 
CONST64
(0x98367a57cf4c1bd4), CONST64(0xeb798249a2fbb210), CONST64(0x2774e9a7809d3aba), CONST64(0xbf4293f04fd1216e),

372 
CONST64
(0x42f8d95d1f217c63), CONST64(0x861e5d4cca430fc5), CONST64(0xdb39da71aae39238), CONST64(0x912aecd342c61557),

375 cÚ¡ 
ulÚg64
 
	gT5
[256] = {

376 
CONST64
(0xb9bb016ad3ba68d2), CONST64(0x9ae5b166fc54194d), CONST64(0x65e2cd14712f93bc), CONST64(0x8725511b9c74b9cd),

377 
CONST64
(0xa2f7a457f5530251), CONST64(0xd6d003be68d3b86b), CONST64(0xded604b56bd2bd6f), CONST64(0x52b3fe85d74d6429),

378 
CONST64
(0xbafdad4af0500d5d), CONST64(0x09cf63e0e9ac268a), CONST64(0x1c0984968a8d830e), CONST64(0x91a51a4ddcbf79c6),

379 
CONST64
(0xa73d4d379070addd), CONST64(0xaaf1a35cf6520755), CONST64(0xa47be117b39ac852), CONST64(0x5ab5f98ed44c612d),

380 
CONST64
(0x0346ac2023ea658f), CONST64(0xe6c4118462d5a673), CONST64(0xcc55c268a497f166), CONST64(0xc6dc0da86ed1b263),

381 
CONST64
(0x85aa99d05533ffcc), CONST64(0xb2fbaa41f3510859), CONST64(0xe2c79c0fed5b2a71), CONST64(0x59f355aef7a604a2),

382 
CONST64
(0xbefe20c17fde815f), CONST64(0x7aade5a2d848753d), CONST64(0x29d77fcce5a8329a), CONST64(0xbc71e80ab699c75e),

383 
CONST64
(0x96e03be670db904b), CONST64(0x8dac9edb5632fac8), CONST64(0xd1952215c4b751e6), CONST64(0xb332ceaa19fc2bd7),

384 
CONST64
(0x4b70937338e348ab), CONST64(0x8463fd3bbf9edc42), CONST64(0xfc41d052ae91ef7e), CONST64(0xac7de61cb09bcd56),

385 
CONST64
(0x437694783be24daf), CONST64(0xb1bd0661d0bb6dd6), CONST64(0x329bdaf1c3415819), CONST64(0x577917e5b26ecba5),

386 
CONST64
(0x41f95cb3f2a50bae), CONST64(0x16804b5640cbc00b), CONST64(0x7f670cc2bd6bdab1), CONST64(0xdc59cc7ea295fb6e),

387 
CONST64
(0x61e1409ffea11fbe), CONST64(0xcb10e3c308f318eb), CONST64(0xe181302fceb14ffe), CONST64(0x100c0e1606020a08),

388 
CONST64
(0x2e925e6749ccdb17), CONST64(0x6ea2663f51c4f337), CONST64(0xe84e53cf271d6974), CONST64(0xa0786c9c3c144450),

389 
CONST64
(0x56b0730e58c3e82b), CONST64(0x3f57349aa563f291), CONST64(0x9ee63ced73da954f), CONST64(0xd2d38e35e75d3469),

390 
CONST64
(0xc2df8023e15f3e61), CONST64(0xaef22ed779dc8b57), CONST64(0xcf136e48877d94e9), CONST64(0x2694596c4acdde13),

391 
CONST64
(0xdf1f605e817f9ee1), CONST64(0xeac19b04ee5a2f75), CONST64(0x477519f3b46cc1ad), CONST64(0xdad5893ee45c316d),

392 
CONST64
(0xeb08ffef04f70cfb), CONST64(0x2dd4f2476a26be98), CONST64(0xab38c7b71cff24db), CONST64(0x3b54b9112aed7e93),

393 
CONST64
(0x134aa23625e86f87), CONST64(0x9c69f426ba9dd34e), CONST64(0x5f7f10eeb16fcea1), CONST64(0x04038d8b8f8e8c02),

394 
CONST64
(0xc8564fe32b197d64), CONST64(0x69e74794fda01aba), CONST64(0xd31aeade0df017e7), CONST64(0x3c1198ba8689971e),

395 
CONST64
(0x78222d69110f333c), CONST64(0x3812153109071b1c), CONST64(0x11c56afdecaf2986), CONST64(0x8b20db9b10fb30cb),

396 
CONST64
(0x4030385818082820), CONST64(0xa87e6b973f154154), CONST64(0x682e237f170d3934), CONST64(0x20181c2c0c041410),

397 
CONST64
(0x0806070b03010504), CONST64(0x074521abac64e98d), CONST64(0xb6f827ca7cdf845b), CONST64(0x97295f0d9a76b3c5),

398 
CONST64
(0xef0b72648b7980f9), CONST64(0xa6f429dc7add8e53), CONST64(0xf58eb3b2473dc9f4), CONST64(0xb074628a3a164e58),

399 
CONST64
(0xe582bda4413fc3fc), CONST64(0xa5b285fc5937ebdc), CONST64(0x4f731ef8b76dc4a9), CONST64(0xdd90a8954838d8e0),

400 
CONST64
(0xa1b10877d6b967de), CONST64(0xbf37442a9573a2d1), CONST64(0x1b4ca53d26e96a83), CONST64(0xb5be8bea5f35e1d4),

401 
CONST64
(0x92e3b66dff551c49), CONST64(0xaf3b4a3c9371a8d9), CONST64(0xff077c728d7b8af1), CONST64(0x140f839d898c860a),

402 
CONST64
(0xb73143219672a7d5), CONST64(0x34179fb18588921a), CONST64(0xe30ef8e407f609ff), CONST64(0x4dfcd6337e2a82a8),

403 
CONST64
(0xed84baaf423ec6f8), CONST64(0xcad98728e25e3b65), CONST64(0x25d2f54c6927bb9c), CONST64(0x0a89cfc0ca464305),

404 
CONST64
(0x60282474140c3c30), CONST64(0x0f4326a0af65ec89), CONST64(0x676d05dfb868d5bd), CONST64(0x2f5b3a8ca361f899),

405 
CONST64
(0x180a091d05030f0c), CONST64(0x46bc7d185ec1e223), CONST64(0x82efb87bf9571641), CONST64(0xfece189967d6a97f),

406 
CONST64
(0x86ec35f076d99a43), CONST64(0xfacd9512e858257d), CONST64(0x8eea32fb75d89f47), CONST64(0x17492fbdaa66e385),

407 
CONST64
(0xf6c81f9264d7ac7b), CONST64(0xcd9ca6834e3ad2e8), CONST64(0x0e8a424b45c8cf07), CONST64(0xfd88b4b9443cccf0),

408 
CONST64
(0x8326dc9013fa35cf), CONST64(0xc453c563a796f462), CONST64(0x51f552a5f4a701a6), CONST64(0xb477ef01b598c25a),

409 
CONST64
(0x3352be1a29ec7b97), CONST64(0xa9b70f7cd5b862da), CONST64(0x76a86f2254c7fc3b), CONST64(0x19c36df6efae2c82),

410 
CONST64
(0x6f6b02d4bb69d0b9), CONST64(0x62a7ecbfdd4b7a31), CONST64(0x31dd76d1e0ab3d96), CONST64(0x21d178c7e6a9379e),

411 
CONST64
(0x1f4f28b6a967e681), CONST64(0x503c364e1e0a2228), CONST64(0x028fc8cbc9474601), CONST64(0xc316e4c80bf21def),

412 
CONST64
(0xc1992c03c2b55bee), CONST64(0x0dccee6b6622aa88), CONST64(0x7b64814932e556b3), CONST64(0x235eb00c2fee719f),

413 
CONST64
(0x99a31d46dfbe7cc2), CONST64(0x45fad1387d2b87ac), CONST64(0x7c21a0e29e81bf3e), CONST64(0x906c7ea636125a48),

414 
CONST64
(0x6c2daef49883b536), CONST64(0xd85a41f52d1b776c), CONST64(0x70242a62120e3638), CONST64(0x05cae9606523af8c),

415 
CONST64
(0xfb04f1f902f506f3), CONST64(0x1283c6ddcf454c09), CONST64(0x15c6e7766321a584), CONST64(0x3e9e50714fced11f),

416 
CONST64
(0x72abe2a9db497039), CONST64(0x7de8c409742c9cb0), CONST64(0x9b2cd58d16f93ac3), CONST64(0x636e885437e659bf),

417 
CONST64
(0xd993251ec7b654e2), CONST64(0x5df0d825782888a0), CONST64(0xb872658139174b5c), CONST64(0x642ba9ff9b82b032),

418 
CONST64
(0xd05c46fe2e1a7268), CONST64(0x2c1d96ac808b9d16), CONST64(0xa33ec0bc1ffe21df), CONST64(0x241b91a7838a9812),

419 
CONST64
(0x48363f531b092d24), CONST64(0x068c454046c9ca03), CONST64(0x4c35b2d89487a126), CONST64(0x4ab9f798d24e6b25),

420 
CONST64
(0x5b7c9d653ee142a3), CONST64(0x6de4ca1f722e96b8), CONST64(0x7362864231e453b7), CONST64(0x537a9a6e3de047a7),

421 
CONST64
(0x0b40ab2b20eb608b), CONST64(0xf447d759ad90ea7a), CONST64(0x49ff5bb8f1a40eaa), CONST64(0xf0445ad2221e6678),

422 
CONST64
(0x5c39bcce9285ab2e), CONST64(0x275d3d87a060fd9d), CONST64(0x0000000000000000), CONST64(0x35defb5a6f25b194),

423 
CONST64
(0xf302f6f201f403f7), CONST64(0xdb1cedd50ef112e3), CONST64(0xd45fcb75a194fe6a), CONST64(0x583a31451d0b272c),

424 
CONST64
(0x6b688f5f34e75cbb), CONST64(0x8f2356109f75bcc9), CONST64(0x2b58b7072cef749b), CONST64(0xbdb88ce15c34e4d0),

425 
CONST64
(0x95a697c65331f5c4), CONST64(0xeec2168f61d4a377), CONST64(0xceda0aa36dd0b767), CONST64(0x4433b5d39786a422),

426 
CONST64
(0xd7196755827e9be5), CONST64(0x01c964ebeaad238e), CONST64(0xbb34c9a11afd2ed3), CONST64(0x55f6df2e7b298da4),

427 
CONST64
(0x9da090cd5030f0c0), CONST64(0xc59aa1884d3bd7ec), CONST64(0x8c65fa30bc9fd946), CONST64(0x932ad28615f83fc7),

428 
CONST64
(0x7eae682957c6f93f), CONST64(0x986a79ad35135f4c), CONST64(0x3014123a0a061e18), CONST64(0x281e1b270f051114),

429 
CONST64
(0x66a4613452c5f633), CONST64(0x886677bb33115544), CONST64(0x9f2f58069977b6c1), CONST64(0xc7156943847c91ed),

430 
CONST64
(0xf7017b798e7a8ff5), CONST64(0xe70d756f887885fd), CONST64(0xadb482f75a36eed8), CONST64(0xe04854c4241c6c70),

431 
CONST64
(0xd596af9e4b39dde4), CONST64(0xf2cb9219eb592079), CONST64(0xc05048e828187860), CONST64(0x8ae9bf70fa561345),

432 
CONST64
(0xf18d3e39c8b345f6), CONST64(0xe9873724cdb04afa), CONST64(0x3dd8fc516c24b490), CONST64(0x1dc0e07d6020a080),

433 
CONST64
(0xf98b3932cbb240f2), CONST64(0xe44bd94fab92e072), CONST64(0x71ed4e89f8a315b6), CONST64(0x4eba7a135dc0e727),

434 
CONST64
(0x1a85c1d6cc44490d), CONST64(0x37513391a662f795), CONST64(0x806070b030105040), CONST64(0xc99f2b08c1b45eea),

435 
CONST64
(0x543fbbc59184ae2a), CONST64(0x2297d4e7c5435211), CONST64(0xec4dde44a893e576), CONST64(0x5eb674055bc2ed2f),

436 
CONST64
(0x6aa1ebb4de4a7f35), CONST64(0x81a9145bdabd73ce), CONST64(0x0c058a808c8f8906), CONST64(0x75eec302772d99b4),

437 
CONST64
(0x89af1350d9bc76ca), CONST64(0x946ff32db99cd64a), CONST64(0x77610bc9be6adfb5), CONST64(0x3a9dddfac0405d1d),

438 
CONST64
(0x3698577a4ccfd41b), CONST64(0x79eb4982fba210b2), CONST64(0x7427a7e99d80ba3a), CONST64(0x42bff093d14f6e21),

439 
CONST64
(0xf8425dd9211f637c), CONST64(0x1e864c5d43cac50f), CONST64(0x39db71dae3aa3892), CONST64(0x2a91d3ecc6425715),

442 cÚ¡ 
ulÚg64
 
	gT6
[256] = {

443 
CONST64
(0x6a01bbb9d268bad3), CONST64(0x66b1e59a4d1954fc), CONST64(0x14cde265bc932f71), CONST64(0x1b512587cdb9749c),

444 
CONST64
(0x57a4f7a2510253f5), CONST64(0xbe03d0d66bb8d368), CONST64(0xb504d6de6fbdd26b), CONST64(0x85feb35229644dd7),

445 
CONST64
(0x4aadfdba5d0d50f0), CONST64(0xe063cf098a26ace9), CONST64(0x9684091c0e838d8a), CONST64(0x4d1aa591c679bfdc),

446 
CONST64
(0x374d3da7ddad7090), CONST64(0x5ca3f1aa550752f6), CONST64(0x17e17ba452c89ab3), CONST64(0x8ef9b55a2d614cd4),

447 
CONST64
(0x20ac46038f65ea23), CONST64(0x8411c4e673a6d562), CONST64(0x68c255cc66f197a4), CONST64(0xa80ddcc663b2d16e),

448 
CONST64
(0xd099aa85ccff3355), CONST64(0x41aafbb2590851f3), CONST64(0x0f9cc7e2712a5bed), CONST64(0xae55f359a204a6f7),

449 
CONST64
(0xc120febe5f81de7f), CONST64(0xa2e5ad7a3d7548d8), CONST64(0xcc7fd7299a32a8e5), CONST64(0x0ae871bc5ec799b6),

450 
CONST64
(0xe63be0964b90db70), CONST64(0xdb9eac8dc8fa3256), CONST64(0x152295d1e651b7c4), CONST64(0xaace32b3d72bfc19),

451 
CONST64
(0x7393704bab48e338), CONST64(0x3bfd638442dc9ebf), CONST64(0x52d041fc7eef91ae), CONST64(0x1ce67dac56cd9bb0),

452 
CONST64
(0x78947643af4de23b), CONST64(0x6106bdb1d66dbbd0), CONST64(0xf1da9b32195841c3), CONST64(0xe5177957a5cb6eb2),

453 
CONST64
(0xb35cf941ae0ba5f2), CONST64(0x564b80160bc0cb40), CONST64(0xc20c677fb1da6bbd), CONST64(0x7ecc59dc6efb95a2),

454 
CONST64
(0x9f40e161be1fa1fe), CONST64(0xc3e310cbeb18f308), CONST64(0x2f3081e1fe4fb1ce), CONST64(0x160e0c10080a0206),

455 
CONST64
(0x675e922e17dbcc49), CONST64(0x3f66a26e37f3c451), CONST64(0xcf534ee874691d27), CONST64(0x9c6c78a05044143c),

456 
CONST64
(0x0e73b0562be8c358), CONST64(0x9a34573f91f263a5), CONST64(0xed3ce69e4f95da73), CONST64(0x358ed3d269345de7),

457 
CONST64
(0x2380dfc2613e5fe1), CONST64(0xd72ef2ae578bdc79), CONST64(0x486e13cfe9947d87), CONST64(0x6c59942613decd4a),

458 
CONST64
(0x5e601fdfe19e7f81), CONST64(0x049bc1ea752f5aee), CONST64(0xf3197547adc16cb4), CONST64(0x3e89d5da6d315ce4),

459 
CONST64
(0xefff08ebfb0cf704), CONST64(0x47f2d42d98be266a), CONST64(0xb7c738abdb24ff1c), CONST64(0x11b9543b937eed2a),

460 
CONST64
(0x36a24a13876fe825), CONST64(0x26f4699c4ed39dba), CONST64(0xee107f5fa1ce6fb1), CONST64(0x8b8d0304028c8e8f),

461 
CONST64
(0xe34f56c8647d192b), CONST64(0x9447e769ba1aa0fd), CONST64(0xdeea1ad3e717f00d), CONST64(0xba98113c1e978986),

462 
CONST64
(0x692d22783c330f11), CONST64(0x311512381c1b0709), CONST64(0xfd6ac5118629afec), CONST64(0x9bdb208bcb30fb10),

463 
CONST64
(0x5838304020280818), CONST64(0x976b7ea85441153f), CONST64(0x7f232e6834390d17), CONST64(0x2c1c18201014040c),

464 
CONST64
(0x0b07060804050103), CONST64(0xab2145078de964ac), CONST64(0xca27f8b65b84df7c), CONST64(0x0d5f2997c5b3769a),

465 
CONST64
(0x64720beff980798b), CONST64(0xdc29f4a6538edd7a), CONST64(0xb2b38ef5f4c93d47), CONST64(0x8a6274b0584e163a),

466 
CONST64
(0xa4bd82e5fcc33f41), CONST64(0xfc85b2a5dceb3759), CONST64(0xf81e734fa9c46db7), CONST64(0x95a890dde0d83848),

467 
CONST64
(0x7708b1a1de67b9d6), CONST64(0x2a4437bfd1a27395), CONST64(0x3da54c1b836ae926), CONST64(0xea8bbeb5d4e1355f),

468 
CONST64
(0x6db6e392491c55ff), CONST64(0x3c4a3bafd9a87193), CONST64(0x727c07fff18a7b8d), CONST64(0x9d830f140a868c89),

469 
CONST64
(0x214331b7d5a77296), CONST64(0xb19f17341a928885), CONST64(0xe4f80ee3ff09f607), CONST64(0x33d6fc4da8822a7e),

470 
CONST64
(0xafba84edf8c63e42), CONST64(0x2887d9ca653b5ee2), CONST64(0x4cf5d2259cbb2769), CONST64(0xc0cf890a054346ca),

471 
CONST64
(0x74242860303c0c14), CONST64(0xa026430f89ec65af), CONST64(0xdf056d67bdd568b8), CONST64(0x8c3a5b2f99f861a3),

472 
CONST64
(0x1d090a180c0f0305), CONST64(0x187dbc4623e2c15e), CONST64(0x7bb8ef82411657f9), CONST64(0x9918cefe7fa9d667),

473 
CONST64
(0xf035ec86439ad976), CONST64(0x1295cdfa7d2558e8), CONST64(0xfb32ea8e479fd875), CONST64(0xbd2f491785e366aa),

474 
CONST64
(0x921fc8f67bacd764), CONST64(0x83a69ccde8d23a4e), CONST64(0x4b428a0e07cfc845), CONST64(0xb9b488fdf0cc3c44),

475 
CONST64
(0x90dc2683cf35fa13), CONST64(0x63c553c462f496a7), CONST64(0xa552f551a601a7f4), CONST64(0x01ef77b45ac298b5),

476 
CONST64
(0x1abe5233977bec29), CONST64(0x7c0fb7a9da62b8d5), CONST64(0x226fa8763bfcc754), CONST64(0xf66dc319822caeef),

477 
CONST64
(0xd4026b6fb9d069bb), CONST64(0xbfeca762317a4bdd), CONST64(0xd176dd31963dabe0), CONST64(0xc778d1219e37a9e6),

478 
CONST64
(0xb6284f1f81e667a9), CONST64(0x4e363c5028220a1e), CONST64(0xcbc88f02014647c9), CONST64(0xc8e416c3ef1df20b),

479 
CONST64
(0x032c99c1ee5bb5c2), CONST64(0x6beecc0d88aa2266), CONST64(0x4981647bb356e532), CONST64(0x0cb05e239f71ee2f),

480 
CONST64
(0x461da399c27cbedf), CONST64(0x38d1fa45ac872b7d), CONST64(0xe2a0217c3ebf819e), CONST64(0xa67e6c90485a1236),

481 
CONST64
(0xf4ae2d6c36b58398), CONST64(0xf5415ad86c771b2d), CONST64(0x622a247038360e12), CONST64(0x60e9ca058caf2365),

482 
CONST64
(0xf9f104fbf306f502), CONST64(0xddc68312094c45cf), CONST64(0x76e7c61584a52163), CONST64(0x71509e3e1fd1ce4f),

483 
CONST64
(0xa9e2ab72397049db), CONST64(0x09c4e87db09c2c74), CONST64(0x8dd52c9bc33af916), CONST64(0x54886e63bf59e637),

484 
CONST64
(0x1e2593d9e254b6c7), CONST64(0x25d8f05da0882878), CONST64(0x816572b85c4b1739), CONST64(0xffa92b6432b0829b),

485 
CONST64
(0xfe465cd068721a2e), CONST64(0xac961d2c169d8b80), CONST64(0xbcc03ea3df21fe1f), CONST64(0xa7911b2412988a83),

486 
CONST64
(0x533f3648242d091b), CONST64(0x40458c0603cac946), CONST64(0xd8b2354c26a18794), CONST64(0x98f7b94a256b4ed2),

487 
CONST64
(0x659d7c5ba342e13e), CONST64(0x1fcae46db8962e72), CONST64(0x42866273b753e431), CONST64(0x6e9a7a53a747e03d),

488 
CONST64
(0x2bab400b8b60eb20), CONST64(0x59d747f47aea90ad), CONST64(0xb85bff49aa0ea4f1), CONST64(0xd25a44f078661e22),

489 
CONST64
(0xcebc395c2eab8592), CONST64(0x873d5d279dfd60a0), CONST64(0x0000000000000000), CONST64(0x5afbde3594b1256f),

490 
CONST64
(0xf2f602f3f703f401), CONST64(0xd5ed1cdbe312f10e), CONST64(0x75cb5fd46afe94a1), CONST64(0x45313a582c270b1d),

491 
CONST64
(0x5f8f686bbb5ce734), CONST64(0x1056238fc9bc759f), CONST64(0x07b7582b9b74ef2c), CONST64(0xe18cb8bdd0e4345c),

492 
CONST64
(0xc697a695c4f53153), CONST64(0x8f16c2ee77a3d461), CONST64(0xa30adace67b7d06d), CONST64(0xd3b5334422a48697),

493 
CONST64
(0x556719d7e59b7e82), CONST64(0xeb64c9018e23adea), CONST64(0xa1c934bbd32efd1a), CONST64(0x2edff655a48d297b),

494 
CONST64
(0xcd90a09dc0f03050), CONST64(0x88a19ac5ecd73b4d), CONST64(0x30fa658c46d99fbc), CONST64(0x86d22a93c73ff815),

495 
CONST64
(0x2968ae7e3ff9c657), CONST64(0xad796a984c5f1335), CONST64(0x3a121430181e060a), CONST64(0x271b1e281411050f),

496 
CONST64
(0x3461a46633f6c552), CONST64(0xbb77668844551133), CONST64(0x06582f9fc1b67799), CONST64(0x436915c7ed917c84),

497 
CONST64
(0x797b01f7f58f7a8e), CONST64(0x6f750de7fd857888), CONST64(0xf782b4add8ee365a), CONST64(0xc45448e0706c1c24),

498 
CONST64
(0x9eaf96d5e4dd394b), CONST64(0x1992cbf2792059eb), CONST64(0xe84850c060781828), CONST64(0x70bfe98a451356fa),

499 
CONST64
(0x393e8df1f645b3c8), CONST64(0x243787e9fa4ab0cd), CONST64(0x51fcd83d90b4246c), CONST64(0x7de0c01d80a02060),

500 
CONST64
(0x32398bf9f240b2cb), CONST64(0x4fd94be472e092ab), CONST64(0x894eed71b615a3f8), CONST64(0x137aba4e27e7c05d),

501 
CONST64
(0xd6c1851a0d4944cc), CONST64(0x9133513795f762a6), CONST64(0xb070608040501030), CONST64(0x082b9fc9ea5eb4c1),

502 
CONST64
(0xc5bb3f542aae8491), CONST64(0xe7d49722115243c5), CONST64(0x44de4dec76e593a8), CONST64(0x0574b65e2fedc25b),

503 
CONST64
(0xb4eba16a357f4ade), CONST64(0x5b14a981ce73bdda), CONST64(0x808a050c06898f8c), CONST64(0x02c3ee75b4992d77),

504 
CONST64
(0x5013af89ca76bcd9), CONST64(0x2df36f944ad69cb9), CONST64(0xc90b6177b5df6abe), CONST64(0xfadd9d3a1d5d40c0),

505 
CONST64
(0x7a5798361bd4cf4c), CONST64(0x8249eb79b210a2fb), CONST64(0xe9a727743aba809d), CONST64(0x93f0bf42216e4fd1),

506 
CONST64
(0xd95d42f87c631f21), CONST64(0x5d4c861e0fc5ca43), CONST64(0xda71db399238aae3), CONST64(0xecd3912a155742c6),

509 cÚ¡ 
ulÚg64
 
	gT7
[256] = {

510 
CONST64
(0x016ab9bb68d2d3ba), CONST64(0xb1669ae5194dfc54), CONST64(0xcd1465e293bc712f), CONST64(0x511b8725b9cd9c74),

511 
CONST64
(0xa457a2f70251f553), CONST64(0x03bed6d0b86b68d3), CONST64(0x04b5ded6bd6f6bd2), CONST64(0xfe8552b36429d74d),

512 
CONST64
(0xad4abafd0d5df050), CONST64(0x63e009cf268ae9ac), CONST64(0x84961c09830e8a8d), CONST64(0x1a4d91a579c6dcbf),

513 
CONST64
(0x4d37a73daddd9070), CONST64(0xa35caaf10755f652), CONST64(0xe117a47bc852b39a), CONST64(0xf98e5ab5612dd44c),

514 
CONST64
(0xac200346658f23ea), CONST64(0x1184e6c4a67362d5), CONST64(0xc268cc55f166a497), CONST64(0x0da8c6dcb2636ed1),

515 
CONST64
(0x99d085aaffcc5533), CONST64(0xaa41b2fb0859f351), CONST64(0x9c0fe2c72a71ed5b), CONST64(0x55ae59f304a2f7a6),

516 
CONST64
(0x20c1befe815f7fde), CONST64(0xe5a27aad753dd848), CONST64(0x7fcc29d7329ae5a8), CONST64(0xe80abc71c75eb699),

517 
CONST64
(0x3be696e0904b70db), CONST64(0x9edb8dacfac85632), CONST64(0x2215d19551e6c4b7), CONST64(0xceaab3322bd719fc),

518 
CONST64
(0x93734b7048ab38e3), CONST64(0xfd3b8463dc42bf9e), CONST64(0xd052fc41ef7eae91), CONST64(0xe61cac7dcd56b09b),

519 
CONST64
(0x947843764daf3be2), CONST64(0x0661b1bd6dd6d0bb), CONST64(0xdaf1329b5819c341), CONST64(0x17e55779cba5b26e),

520 
CONST64
(0x5cb341f90baef2a5), CONST64(0x4b561680c00b40cb), CONST64(0x0cc27f67dab1bd6b), CONST64(0xcc7edc59fb6ea295),

521 
CONST64
(0x409f61e11fbefea1), CONST64(0xe3c3cb1018eb08f3), CONST64(0x302fe1814ffeceb1), CONST64(0x0e16100c0a080602),

522 
CONST64
(0x5e672e92db1749cc), CONST64(0x663f6ea2f33751c4), CONST64(0x53cfe84e6974271d), CONST64(0x6c9ca07844503c14),

523 
CONST64
(0x730e56b0e82b58c3), CONST64(0x349a3f57f291a563), CONST64(0x3ced9ee6954f73da), CONST64(0x8e35d2d33469e75d),

524 
CONST64
(0x8023c2df3e61e15f), CONST64(0x2ed7aef28b5779dc), CONST64(0x6e48cf1394e9877d), CONST64(0x596c2694de134acd),

525 
CONST64
(0x605edf1f9ee1817f), CONST64(0x9b04eac12f75ee5a), CONST64(0x19f34775c1adb46c), CONST64(0x893edad5316de45c),

526 
CONST64
(0xffefeb080cfb04f7), CONST64(0xf2472dd4be986a26), CONST64(0xc7b7ab3824db1cff), CONST64(0xb9113b547e932aed),

527 
CONST64
(0xa236134a6f8725e8), CONST64(0xf4269c69d34eba9d), CONST64(0x10ee5f7fcea1b16f), CONST64(0x8d8b04038c028f8e),

528 
CONST64
(0x4fe3c8567d642b19), CONST64(0x479469e71abafda0), CONST64(0xeaded31a17e70df0), CONST64(0x98ba3c11971e8689),

529 
CONST64
(0x2d697822333c110f), CONST64(0x153138121b1c0907), CONST64(0x6afd11c52986ecaf), CONST64(0xdb9b8b2030cb10fb),

530 
CONST64
(0x3858403028201808), CONST64(0x6b97a87e41543f15), CONST64(0x237f682e3934170d), CONST64(0x1c2c201814100c04),

531 
CONST64
(0x070b080605040301), CONST64(0x21ab0745e98dac64), CONST64(0x27cab6f8845b7cdf), CONST64(0x5f0d9729b3c59a76),

532 
CONST64
(0x7264ef0b80f98b79), CONST64(0x29dca6f48e537add), CONST64(0xb3b2f58ec9f4473d), CONST64(0x628ab0744e583a16),

533 
CONST64
(0xbda4e582c3fc413f), CONST64(0x85fca5b2ebdc5937), CONST64(0x1ef84f73c4a9b76d), CONST64(0xa895dd90d8e04838),

534 
CONST64
(0x0877a1b167ded6b9), CONST64(0x442abf37a2d19573), CONST64(0xa53d1b4c6a8326e9), CONST64(0x8beab5bee1d45f35),

535 
CONST64
(0xb66d92e31c49ff55), CONST64(0x4a3caf3ba8d99371), CONST64(0x7c72ff078af18d7b), CONST64(0x839d140f860a898c),

536 
CONST64
(0x4321b731a7d59672), CONST64(0x9fb13417921a8588), CONST64(0xf8e4e30e09ff07f6), CONST64(0xd6334dfc82a87e2a),

537 
CONST64
(0xbaafed84c6f8423e), CONST64(0x8728cad93b65e25e), CONST64(0xf54c25d2bb9c6927), CONST64(0xcfc00a894305ca46),

538 
CONST64
(0x247460283c30140c), CONST64(0x26a00f43ec89af65), CONST64(0x05df676dd5bdb868), CONST64(0x3a8c2f5bf899a361),

539 
CONST64
(0x091d180a0f0c0503), CONST64(0x7d1846bce2235ec1), CONST64(0xb87b82ef1641f957), CONST64(0x1899fecea97f67d6),

540 
CONST64
(0x35f086ec9a4376d9), CONST64(0x9512facd257de858), CONST64(0x32fb8eea9f4775d8), CONST64(0x2fbd1749e385aa66),

541 
CONST64
(0x1f92f6c8ac7b64d7), CONST64(0xa683cd9cd2e84e3a), CONST64(0x424b0e8acf0745c8), CONST64(0xb4b9fd88ccf0443c),

542 
CONST64
(0xdc90832635cf13fa), CONST64(0xc563c453f462a796), CONST64(0x52a551f501a6f4a7), CONST64(0xef01b477c25ab598),

543 
CONST64
(0xbe1a33527b9729ec), CONST64(0x0f7ca9b762dad5b8), CONST64(0x6f2276a8fc3b54c7), CONST64(0x6df619c32c82efae),

544 
CONST64
(0x02d46f6bd0b9bb69), CONST64(0xecbf62a77a31dd4b), CONST64(0x76d131dd3d96e0ab), CONST64(0x78c721d1379ee6a9),

545 
CONST64
(0x28b61f4fe681a967), CONST64(0x364e503c22281e0a), CONST64(0xc8cb028f4601c947), CONST64(0xe4c8c3161def0bf2),

546 
CONST64
(0x2c03c1995beec2b5), CONST64(0xee6b0dccaa886622), CONST64(0x81497b6456b332e5), CONST64(0xb00c235e719f2fee),

547 
CONST64
(0x1d4699a37cc2dfbe), CONST64(0xd13845fa87ac7d2b), CONST64(0xa0e27c21bf3e9e81), CONST64(0x7ea6906c5a483612),

548 
CONST64
(0xaef46c2db5369883), CONST64(0x41f5d85a776c2d1b), CONST64(0x2a6270243638120e), CONST64(0xe96005caaf8c6523),

549 
CONST64
(0xf1f9fb0406f302f5), CONST64(0xc6dd12834c09cf45), CONST64(0xe77615c6a5846321), CONST64(0x50713e9ed11f4fce),

550 
CONST64
(0xe2a972ab7039db49), CONST64(0xc4097de89cb0742c), CONST64(0xd58d9b2c3ac316f9), CONST64(0x8854636e59bf37e6),

551 
CONST64
(0x251ed99354e2c7b6), CONST64(0xd8255df088a07828), CONST64(0x6581b8724b5c3917), CONST64(0xa9ff642bb0329b82),

552 
CONST64
(0x46fed05c72682e1a), CONST64(0x96ac2c1d9d16808b), CONST64(0xc0bca33e21df1ffe), CONST64(0x91a7241b9812838a),

553 
CONST64
(0x3f5348362d241b09), CONST64(0x4540068cca0346c9), CONST64(0xb2d84c35a1269487), CONST64(0xf7984ab96b25d24e),

554 
CONST64
(0x9d655b7c42a33ee1), CONST64(0xca1f6de496b8722e), CONST64(0x8642736253b731e4), CONST64(0x9a6e537a47a73de0),

555 
CONST64
(0xab2b0b40608b20eb), CONST64(0xd759f447ea7aad90), CONST64(0x5bb849ff0eaaf1a4), CONST64(0x5ad2f0446678221e),

556 
CONST64
(0xbcce5c39ab2e9285), CONST64(0x3d87275dfd9da060), CONST64(0x0000000000000000), CONST64(0xfb5a35deb1946f25),

557 
CONST64
(0xf6f2f30203f701f4), CONST64(0xedd5db1c12e30ef1), CONST64(0xcb75d45ffe6aa194), CONST64(0x3145583a272c1d0b),

558 
CONST64
(0x8f5f6b685cbb34e7), CONST64(0x56108f23bcc99f75), CONST64(0xb7072b58749b2cef), CONST64(0x8ce1bdb8e4d05c34),

559 
CONST64
(0x97c695a6f5c45331), CONST64(0x168feec2a37761d4), CONST64(0x0aa3cedab7676dd0), CONST64(0xb5d34433a4229786),

560 
CONST64
(0x6755d7199be5827e), CONST64(0x64eb01c9238eeaad), CONST64(0xc9a1bb342ed31afd), CONST64(0xdf2e55f68da47b29),

561 
CONST64
(0x90cd9da0f0c05030), CONST64(0xa188c59ad7ec4d3b), CONST64(0xfa308c65d946bc9f), CONST64(0xd286932a3fc715f8),

562 
CONST64
(0x68297eaef93f57c6), CONST64(0x79ad986a5f4c3513), CONST64(0x123a30141e180a06), CONST64(0x1b27281e11140f05),

563 
CONST64
(0x613466a4f63352c5), CONST64(0x77bb886655443311), CONST64(0x58069f2fb6c19977), CONST64(0x6943c71591ed847c),

564 
CONST64
(0x7b79f7018ff58e7a), CONST64(0x756fe70d85fd8878), CONST64(0x82f7adb4eed85a36), CONST64(0x54c4e0486c70241c),

565 
CONST64
(0xaf9ed596dde44b39), CONST64(0x9219f2cb2079eb59), CONST64(0x48e8c05078602818), CONST64(0xbf708ae91345fa56),

566 
CONST64
(0x3e39f18d45f6c8b3), CONST64(0x3724e9874afacdb0), CONST64(0xfc513dd8b4906c24), CONST64(0xe07d1dc0a0806020),

567 
CONST64
(0x3932f98b40f2cbb2), CONST64(0xd94fe44be072ab92), CONST64(0x4e8971ed15b6f8a3), CONST64(0x7a134ebae7275dc0),

568 
CONST64
(0xc1d61a85490dcc44), CONST64(0x33913751f795a662), CONST64(0x70b0806050403010), CONST64(0x2b08c99f5eeac1b4),

569 
CONST64
(0xbbc5543fae2a9184), CONST64(0xd4e722975211c543), CONST64(0xde44ec4de576a893), CONST64(0x74055eb6ed2f5bc2),

570 
CONST64
(0xebb46aa17f35de4a), CONST64(0x145b81a973cedabd), CONST64(0x8a800c0589068c8f), CONST64(0xc30275ee99b4772d),

571 
CONST64
(0x135089af76cad9bc), CONST64(0xf32d946fd64ab99c), CONST64(0x0bc97761dfb5be6a), CONST64(0xddfa3a9d5d1dc040),

572 
CONST64
(0x577a3698d41b4ccf), CONST64(0x498279eb10b2fba2), CONST64(0xa7e97427ba3a9d80), CONST64(0xf09342bf6e21d14f),

573 
CONST64
(0x5dd9f842637c211f), CONST64(0x4c5d1e86c50f43ca), CONST64(0x71da39db3892e3aa), CONST64(0xd3ec2a915715c642),

576 cÚ¡ 
ulÚg64
 
	gc
[
R
 + 1] = {

577 
CONST64
(0xba542f7453d3d24d),

578 
CONST64
(0x50ac8dbf70529a4c),

579 
CONST64
(0xead597d133515ba6),

580 
CONST64
(0xde48a899db32b7fc),

581 
CONST64
(0xe39e919be2bb416e),

582 
CONST64
(0xa5cb6b95a1f3b102),

583 
CONST64
(0xccc41d14c363da5d),

584 
CONST64
(0x5fdc7dcd7f5a6c5c),

585 
CONST64
(0xf726ffede89d6f8e),

596 
	$khazad_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

598 
r
;

599 cÚ¡ 
ulÚg64
 *
S
;

600 
ulÚg64
 
K2
, 
K1
;

602 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

603 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

604 ià(
keyËn
 != 16) {

605  
CRYPT_INVALID_KEYSIZE
;

607 ià(
num_rounds
 != 8 &&‚um_rounds != 0) {

608  
CRYPT_INVALID_ROUNDS
;

612 
S
 = 
T7
;

617 
K2
 =

618 ((
ulÚg64
)
key
[ 0] << 56) ^

619 ((
ulÚg64
)
key
[ 1] << 48) ^

620 ((
ulÚg64
)
key
[ 2] << 40) ^

621 ((
ulÚg64
)
key
[ 3] << 32) ^

622 ((
ulÚg64
)
key
[ 4] << 24) ^

623 ((
ulÚg64
)
key
[ 5] << 16) ^

624 ((
ulÚg64
)
key
[ 6] << 8) ^

625 ((
ulÚg64
)
key
[ 7] );

626 
K1
 =

627 ((
ulÚg64
)
key
[ 8] << 56) ^

628 ((
ulÚg64
)
key
[ 9] << 48) ^

629 ((
ulÚg64
)
key
[10] << 40) ^

630 ((
ulÚg64
)
key
[11] << 32) ^

631 ((
ulÚg64
)
key
[12] << 24) ^

632 ((
ulÚg64
)
key
[13] << 16) ^

633 ((
ulÚg64
)
key
[14] << 8) ^

634 ((
ulÚg64
)
key
[15] );

639 
r
 = 0;„ <ğ
R
;„++) {

643 
skey
->
khazad
.
roundKeyEnc
[
r
] =

644 
T0
[()(
K1
 >> 56) ] ^

645 
T1
[()(
K1
 >> 48) & 0xff] ^

646 
T2
[()(
K1
 >> 40) & 0xff] ^

647 
T3
[()(
K1
 >> 32) & 0xff] ^

648 
T4
[()(
K1
 >> 24) & 0xff] ^

649 
T5
[()(
K1
 >> 16) & 0xff] ^

650 
T6
[()(
K1
 >> 8) & 0xff] ^

651 
T7
[()(
K1
 ) & 0xff] ^

652 
c
[
r
] ^ 
K2
;

653 
K2
 = 
K1
; K1 = 
skey
->
khazad
.
roundKeyEnc
[
r
];

659 
skey
->
khazad
.
roundKeyDec
[0] = skey->khazad.
roundKeyEnc
[
R
];

660 
r
 = 1;„ < 
R
;„++) {

661 
K1
 = 
skey
->
khazad
.
roundKeyEnc
[
R
 - 
r
];

662 
skey
->
khazad
.
roundKeyDec
[
r
] =

663 
T0
[()
S
[()(
K1
 >> 56) ] & 0xff] ^

664 
T1
[()
S
[()(
K1
 >> 48) & 0xff] & 0xff] ^

665 
T2
[()
S
[()(
K1
 >> 40) & 0xff] & 0xff] ^

666 
T3
[()
S
[()(
K1
 >> 32) & 0xff] & 0xff] ^

667 
T4
[()
S
[()(
K1
 >> 24) & 0xff] & 0xff] ^

668 
T5
[()
S
[()(
K1
 >> 16) & 0xff] & 0xff] ^

669 
T6
[()
S
[()(
K1
 >> 8) & 0xff] & 0xff] ^

670 
T7
[()
S
[()(
K1
 ) & 0xff] & 0xff];

672 
skey
->
khazad
.
roundKeyDec
[
R
] = skey->khazad.
roundKeyEnc
[0];

674  
CRYPT_OK
;

675 
	}
}

677 
	$khazad_üy±
(cÚ¡ *
¶aš‹xt
, *
ch”‹xt
,

678 cÚ¡ 
ulÚg64
 *
roundKey
) {

679 
r
;

680 
ulÚg64
 
¡©e
;

685 
¡©e
 =

686 ((
ulÚg64
)
¶aš‹xt
[0] << 56) ^

687 ((
ulÚg64
)
¶aš‹xt
[1] << 48) ^

688 ((
ulÚg64
)
¶aš‹xt
[2] << 40) ^

689 ((
ulÚg64
)
¶aš‹xt
[3] << 32) ^

690 ((
ulÚg64
)
¶aš‹xt
[4] << 24) ^

691 ((
ulÚg64
)
¶aš‹xt
[5] << 16) ^

692 ((
ulÚg64
)
¶aš‹xt
[6] << 8) ^

693 ((
ulÚg64
)
¶aš‹xt
[7] ) ^

694 
roundKey
[0];

699 
r
 = 1;„ < 
R
;„++) {

700 
¡©e
 =

701 
T0
[()(
¡©e
 >> 56) ] ^

702 
T1
[()(
¡©e
 >> 48) & 0xff] ^

703 
T2
[()(
¡©e
 >> 40) & 0xff] ^

704 
T3
[()(
¡©e
 >> 32) & 0xff] ^

705 
T4
[()(
¡©e
 >> 24) & 0xff] ^

706 
T5
[()(
¡©e
 >> 16) & 0xff] ^

707 
T6
[()(
¡©e
 >> 8) & 0xff] ^

708 
T7
[()(
¡©e
 ) & 0xff] ^

709 
roundKey
[
r
];

715 
¡©e
 =

716 (
T0
[()(
¡©e
 >> 56è] & 
	`CONST64
(0xff00000000000000)) ^

717 (
T1
[()(
¡©e
 >> 48è& 0xff] & 
	`CONST64
(0x00ff000000000000)) ^

718 (
T2
[()(
¡©e
 >> 40è& 0xff] & 
	`CONST64
(0x0000ff0000000000)) ^

719 (
T3
[()(
¡©e
 >> 32è& 0xff] & 
	`CONST64
(0x000000ff00000000)) ^

720 (
T4
[()(
¡©e
 >> 24è& 0xff] & 
	`CONST64
(0x00000000ff000000)) ^

721 (
T5
[()(
¡©e
 >> 16è& 0xff] & 
	`CONST64
(0x0000000000ff0000)) ^

722 (
T6
[()(
¡©e
 >> 8è& 0xff] & 
	`CONST64
(0x000000000000ff00)) ^

723 (
T7
[()(
¡©e
 ) & 0xff] & 
	`CONST64
(0x00000000000000ff)) ^

724 
roundKey
[
R
];

729 
ch”‹xt
[0] = ()(
¡©e
 >> 56);

730 
ch”‹xt
[1] = ()(
¡©e
 >> 48);

731 
ch”‹xt
[2] = ()(
¡©e
 >> 40);

732 
ch”‹xt
[3] = ()(
¡©e
 >> 32);

733 
ch”‹xt
[4] = ()(
¡©e
 >> 24);

734 
ch”‹xt
[5] = ()(
¡©e
 >> 16);

735 
ch”‹xt
[6] = ()(
¡©e
 >> 8);

736 
ch”‹xt
[7] = ()(
¡©e
 );

737 
	}
}

746 
	$khazad_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

748 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

749 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

750 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

751 
	`khazad_üy±
(
±
, 
ù
, 
skey
->
khazad
.
roundKeyEnc
);

752  
CRYPT_OK
;

753 
	}
}

762 
	$khazad_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

764 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

765 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

766 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

767 
	`khazad_üy±
(
ù
, 
±
, 
skey
->
khazad
.
roundKeyDec
);

768  
CRYPT_OK
;

769 
	}
}

775 
	$khazad_‹¡
()

777 #iâdeà
LTC_TEST


778  
CRYPT_NOP
;

780 cÚ¡ 
	s‹¡
 {

781 
±
[8], 
ù
[8], 
key
[16];

782 } 
‹¡s
[] = {

805 
x
, 
y
;

806 
buf
[2][8];

807 
symm‘ric_key
 
skey
;

809 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

810 
	`khazad_£tup
(
‹¡s
[
x
].
key
, 16, 0, &
skey
);

811 
	`khazad_ecb_’üy±
(
‹¡s
[
x
].
±
, 
buf
[0], &
skey
);

812 
	`khazad_ecb_deüy±
(
buf
[0], buf[1], &
skey
);

813 ià(
	`XMEMCMP
(
buf
[0], 
‹¡s
[
x
].
ù
, 8è|| XMEMCMP(buf[1],e¡s[x].
±
, 8)) {

814  
CRYPT_FAIL_TESTVECTOR
;

817 
y
 = 0; y < 1000; y++è
	`khazad_ecb_’üy±
(
buf
[0], buf[0], &
skey
);

818 
y
 = 0; y < 1000; y++è
	`khazad_ecb_deüy±
(
buf
[0], buf[0], &
skey
);

819 ià(
	`XMEMCMP
(
buf
[0], 
‹¡s
[
x
].
ù
, 8)) {

820  
CRYPT_FAIL_TESTVECTOR
;

824  
CRYPT_OK
;

826 
	}
}

831 
	$khazad_dÚe
(
symm‘ric_key
 *
skey
)

833 
	}
}

840 
	$khazad_keysize
(*
keysize
)

842 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

843 ià(*
keysize
 >= 16) {

844 *
keysize
 = 16;

845  
CRYPT_OK
;

847  
CRYPT_INVALID_KEYSIZE
;

849 
	}
}

	@libtomcrypt/src/ciphers/kseed.c

18 
	~"tomüy±.h
"

20 #ifdeà
KSEED


22 cÚ¡ 
Éc_ch”_desütÜ
 
	gk£ed_desc
 = {

26 &
k£ed_£tup
,

27 &
k£ed_ecb_’üy±
,

28 &
k£ed_ecb_deüy±
,

29 &
k£ed_‹¡
,

30 &
k£ed_dÚe
,

31 &
k£ed_keysize
,

32 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

35 cÚ¡ 
ulÚg32
 
	gSS0
[256] = {

70 cÚ¡ 
ulÚg32
 
	gSS1
[256] = {

105 cÚ¡ 
ulÚg32
 
	gSS2
[256] = {

140 cÚ¡ 
ulÚg32
 
	gSS3
[256] = {

175 cÚ¡ 
ulÚg32
 
	gKCi
[16] = {

186 
	#G
(
x
è(
SS3
[((x)>>24)&255] ^ 
SS2
[((x)>>16)&255] ^ 
SS1
[((x)>>8)&255] ^ 
SS0
[(x)&255])

	)

188 
	#F
(
L1
, 
L2
, 
R1
, 
R2
, 
K1
, 
K2
) \

189 
T2
 = 
	`G
((
R1
 ^ 
K1
è^ (
R2
 ^ 
K2
)); \

190 
T
 = 
	`G
ĞG(
T2
 + (
R1
 ^ 
K1
)) + T2); \

191 
L2
 ^ğ
T
; \

192 
L1
 ^ğ(
T
 + 
	`G
(
T2
 + (
R1
 ^ 
K1
))); \

193 

	)

202 
	$k£ed_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

204 
i
;

205 
ulÚg32
 
tmp
, 
k1
, 
k2
, 
k3
, 
k4
;

207 ià(
keyËn
 != 16) {

208  
CRYPT_INVALID_KEYSIZE
;

211 ià(
num_rounds
 != 16 &&‚um_rounds != 0) {

212  
CRYPT_INVALID_ROUNDS
;

216 
	`LOAD32H
(
k1
, 
key
);

217 
	`LOAD32H
(
k2
, 
key
+4);

218 
	`LOAD32H
(
k3
, 
key
+8);

219 
	`LOAD32H
(
k4
, 
key
+12);

221 
i
 = 0; i < 16; i++) {

222 
skey
->
k£ed
.
K
[2*
i
+0] = 
	`G
(
k1
 + 
k3
 - 
KCi
[i]);

223 
skey
->
k£ed
.
K
[2*
i
+1] = 
	`G
(
k2
 - 
k4
 + 
KCi
[i]);

224 ià(
i
&1) {

225 
tmp
 = 
k3
;

226 
k3
 = ((k3 << 8è| (
k4
 >> 24)) & 0xFFFFFFFF;

227 
k4
 = ((k4 << 8è| (
tmp
 >> 24)) & 0xFFFFFFFF;

229 
tmp
 = 
k1
;

230 
k1
 = ((k1 >> 8è| (
k2
 << 24)) & 0xFFFFFFFF;

231 
k2
 = ((k2 >> 8è| (
tmp
 << 24)) & 0xFFFFFFFF;

234 
skey
->
k£ed
.
dK
[2*(15-
i
)+0] = skey->k£ed.
K
[2*i+0];

235 
skey
->
k£ed
.
dK
[2*(15-
i
)+1] = skey->k£ed.
K
[2*i+1];

238  
CRYPT_OK
;

239 
	}
}

241 
	$rounds
(
ulÚg32
 *
P
, ulÚg32 *
K
)

243 
ulÚg32
 
T
, 
T2
;

244 
i
;

245 
i
 = 0; i < 16; i += 2) {

246 
	`F
(
P
[0], P[1], P[2], P[3], 
K
[0], K[1]);

247 
	`F
(
P
[2], P[3], P[0], P[1], 
K
[2], K[3]);

248 
K
 += 4;

250 
	}
}

259 
	$k£ed_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

261 
ulÚg32
 
P
[4];

262 
	`LOAD32H
(
P
[0], 
±
);

263 
	`LOAD32H
(
P
[1], 
±
+4);

264 
	`LOAD32H
(
P
[2], 
±
+8);

265 
	`LOAD32H
(
P
[3], 
±
+12);

266 
	`rounds
(
P
, 
skey
->
k£ed
.
K
);

267 
	`STORE32H
(
P
[2], 
ù
);

268 
	`STORE32H
(
P
[3], 
ù
+4);

269 
	`STORE32H
(
P
[0], 
ù
+8);

270 
	`STORE32H
(
P
[1], 
ù
+12);

271  
CRYPT_OK
;

272 
	}
}

281 
	$k£ed_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

283 
ulÚg32
 
P
[4];

284 
	`LOAD32H
(
P
[0], 
ù
);

285 
	`LOAD32H
(
P
[1], 
ù
+4);

286 
	`LOAD32H
(
P
[2], 
ù
+8);

287 
	`LOAD32H
(
P
[3], 
ù
+12);

288 
	`rounds
(
P
, 
skey
->
k£ed
.
dK
);

289 
	`STORE32H
(
P
[2], 
±
);

290 
	`STORE32H
(
P
[3], 
±
+4);

291 
	`STORE32H
(
P
[0], 
±
+8);

292 
	`STORE32H
(
P
[1], 
±
+12);

293  
CRYPT_OK
;

294 
	}
}

299 
	$k£ed_dÚe
(
symm‘ric_key
 *
skey
)

301 
	}
}

307 
	$k£ed_‹¡
()

309 #ià!
	`defšed
(
LTC_TEST
)

310  
CRYPT_NOP
;

312 cÚ¡ 
	s‹¡
 {

313 
±
[16], 
ù
[16], 
key
[16];

314 } 
‹¡s
[] = {

340 
x
;

341 
buf
[2][16];

342 
symm‘ric_key
 
skey
;

344 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

345 
	`k£ed_£tup
(
‹¡s
[
x
].
key
, 16, 0, &
skey
);

346 
	`k£ed_ecb_’üy±
(
‹¡s
[
x
].
±
, 
buf
[0], &
skey
);

347 
	`k£ed_ecb_deüy±
(
buf
[0], buf[1], &
skey
);

348 ià(
	`XMEMCMP
(
buf
[0], 
‹¡s
[
x
].
ù
, 16è|| XMEMCMP(buf[1],e¡s[x].
±
, 16)) {

349  
CRYPT_FAIL_TESTVECTOR
;

352  
CRYPT_OK
;

354 
	}
}

361 
	$k£ed_keysize
(*
keysize
)

363 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

364 ià(*
keysize
 >= 16) {

365 *
keysize
 = 16;

367  
CRYPT_INVALID_KEYSIZE
;

369  
CRYPT_OK
;

370 
	}
}

	@libtomcrypt/src/ciphers/noekeon.c

15 
	~"tomüy±.h
"

17 #ifdeà
NOEKEON


19 cÚ¡ 
Éc_ch”_desütÜ
 
	gnÛkeÚ_desc
 =

24 &
nÛkeÚ_£tup
,

25 &
nÛkeÚ_ecb_’üy±
,

26 &
nÛkeÚ_ecb_deüy±
,

27 &
nÛkeÚ_‹¡
,

28 &
nÛkeÚ_dÚe
,

29 &
nÛkeÚ_keysize
,

30 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

33 cÚ¡ 
ulÚg32
 
	gRC
[] = {

41 
	#kTHETA
(
a
, 
b
, 
c
, 
d
) \

42 
‹mp
 = 
a
^
c
;em°ğ‹m°^ 
	`ROLc
Ñemp, 8è^ 
	`RORc
(temp, 8); \

43 
b
 ^ğ
‹mp
; 
d
 ^=emp; \

44 
‹mp
 = 
b
^
d
;em°ğ‹m°^ 
	`ROLc
Ñemp, 8è^ 
	`RORc
(temp, 8); \

45 
a
 ^ğ
‹mp
; 
c
 ^ğ‹mp;

	)

47 
	#THETA
(
k
, 
a
, 
b
, 
c
, 
d
) \

48 
‹mp
 = 
a
^
c
;em°ğ‹m°^ 
	`ROLc
Ñemp, 8è^ 
	`RORc
(temp, 8); \

49 
b
 ^ğ
‹mp
 ^ 
k
[1]; 
d
 ^=emp ^ k[3]; \

50 
‹mp
 = 
b
^
d
;em°ğ‹m°^ 
	`ROLc
Ñemp, 8è^ 
	`RORc
(temp, 8); \

51 
a
 ^ğ
‹mp
 ^ 
k
[0]; 
c
 ^ğ‹m°^ k[2];

	)

53 
	#GAMMA
(
a
, 
b
, 
c
, 
d
) \

54 
b
 ^ğ~(
d
|
c
); \

55 
a
 ^ğ
c
&
b
; \

56 
‹mp
 = 
d
; d = 
a
;‡ =emp;\

57 
c
 ^ğ
a
 ^ 
b
 ^ 
d
; \

58 
b
 ^ğ~(
d
|
c
); \

59 
a
 ^ğ
c
&
b
;

	)

61 
	#PI1
(
a
, 
b
, 
c
, 
d
) \

62 
a
 = 
	`ROLc
×, 1); 
c
 = ROLc(c, 5); 
d
 = ROLc(d, 2);

	)

64 
	#PI2
(
a
, 
b
, 
c
, 
d
) \

65 
a
 = 
	`RORc
×, 1); 
c
 = RORc(c, 5); 
d
 = RORc(d, 2);

	)

75 
	$nÛkeÚ_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

77 
ulÚg32
 
‹mp
;

79 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

80 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

82 ià(
keyËn
 != 16) {

83  
CRYPT_INVALID_KEYSIZE
;

86 ià(
num_rounds
 != 16 &&‚um_rounds != 0) {

87  
CRYPT_INVALID_ROUNDS
;

90 
	`LOAD32H
(
skey
->
nÛkeÚ
.
K
[0],&
key
[0]);

91 
	`LOAD32H
(
skey
->
nÛkeÚ
.
K
[1],&
key
[4]);

92 
	`LOAD32H
(
skey
->
nÛkeÚ
.
K
[2],&
key
[8]);

93 
	`LOAD32H
(
skey
->
nÛkeÚ
.
K
[3],&
key
[12]);

95 
	`LOAD32H
(
skey
->
nÛkeÚ
.
dK
[0],&
key
[0]);

96 
	`LOAD32H
(
skey
->
nÛkeÚ
.
dK
[1],&
key
[4]);

97 
	`LOAD32H
(
skey
->
nÛkeÚ
.
dK
[2],&
key
[8]);

98 
	`LOAD32H
(
skey
->
nÛkeÚ
.
dK
[3],&
key
[12]);

100 
	`kTHETA
(
skey
->
nÛkeÚ
.
dK
[0], skey->noekeon.dK[1], skey->noekeon.dK[2], skey->noekeon.dK[3]);

102  
CRYPT_OK
;

103 
	}
}

112 #ifdeà
LTC_CLEAN_STACK


113 
	$_nÛkeÚ_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

115 
	$nÛkeÚ_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

118 
ulÚg32
 
a
,
b
,
c
,
d
,
‹mp
;

119 
r
;

121 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

122 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

123 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

125 
	`LOAD32H
(
a
,&
±
[0]); LOAD32H(
b
,&pt[4]);

126 
	`LOAD32H
(
c
,&
±
[8]); LOAD32H(
d
,&pt[12]);

128 
	#ROUND
(
i
) \

129 
a
 ^ğ
RC
[
i
]; \

130 
	`THETA
(
skey
->
nÛkeÚ
.
K
, 
a
,
b
,
c
,
d
); \

131 
	`PI1
(
a
,
b
,
c
,
d
); \

132 
	`GAMMA
(
a
,
b
,
c
,
d
); \

133 
	`PI2
(
a
,
b
,
c
,
d
);

	)

135 
r
 = 0;„ < 16; ++r) {

136 
	`ROUND
(
r
);

139 #undeà
ROUND


141 
a
 ^ğ
RC
[16];

142 
	`THETA
(
skey
->
nÛkeÚ
.
K
, 
a
, 
b
, 
c
, 
d
);

144 
	`STORE32H
(
a
,&
ù
[0]); STORE32H(
b
,&ct[4]);

145 
	`STORE32H
(
c
,&
ù
[8]); STORE32H(
d
,&ct[12]);

147  
CRYPT_OK
;

148 
	}
}

150 #ifdeà
LTC_CLEAN_STACK


151 
	$nÛkeÚ_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

153 
”r
 = 
	`_nÛkeÚ_ecb_’üy±
(
±
, 
ù
, 
skey
);

154 
	`buº_¡ack
((
ulÚg32
) * 5 + ());

155  
CRYPT_OK
;

156 
	}
}

166 #ifdeà
LTC_CLEAN_STACK


167 
	$_nÛkeÚ_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

169 
	$nÛkeÚ_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

172 
ulÚg32
 
a
,
b
,
c
,
d
, 
‹mp
;

173 
r
;

175 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

176 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

177 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

179 
	`LOAD32H
(
a
,&
ù
[0]); LOAD32H(
b
,&ct[4]);

180 
	`LOAD32H
(
c
,&
ù
[8]); LOAD32H(
d
,&ct[12]);

183 
	#ROUND
(
i
) \

184 
	`THETA
(
skey
->
nÛkeÚ
.
dK
, 
a
,
b
,
c
,
d
); \

185 
a
 ^ğ
RC
[
i
]; \

186 
	`PI1
(
a
,
b
,
c
,
d
); \

187 
	`GAMMA
(
a
,
b
,
c
,
d
); \

188 
	`PI2
(
a
,
b
,
c
,
d
);

	)

190 
r
 = 16;„ > 0; --r) {

191 
	`ROUND
(
r
);

194 #undeà
ROUND


196 
	`THETA
(
skey
->
nÛkeÚ
.
dK
, 
a
,
b
,
c
,
d
);

197 
a
 ^ğ
RC
[0];

198 
	`STORE32H
(
a
,&
±
[0]); STORE32H(
b
, &pt[4]);

199 
	`STORE32H
(
c
,&
±
[8]); STORE32H(
d
, &pt[12]);

200  
CRYPT_OK
;

201 
	}
}

203 #ifdeà
LTC_CLEAN_STACK


204 
	$nÛkeÚ_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

206 
”r
 = 
	`_nÛkeÚ_ecb_deüy±
(
ù
, 
±
, 
skey
);

207 
	`buº_¡ack
((
ulÚg32
) * 5 + ());

208  
”r
;

209 
	}
}

216 
	$nÛkeÚ_‹¡
()

218 #iâdeà
LTC_TEST


219  
CRYPT_NOP
;

222 
keyËn
;

223 
key
[16], 
±
[16], 
ù
[16];

224 } 
‹¡s
[] = {

233 
symm‘ric_key
 
key
;

234 
tmp
[2][16];

235 
”r
, 
i
, 
y
;

237 
i
 = 0; i < ()((
‹¡s
)/(tests[0])); i++) {

238 
	`z”omem
(&
key
, (key));

239 ià((
”r
 = 
	`nÛkeÚ_£tup
(
‹¡s
[
i
].
key
,e¡s[i].
keyËn
, 0, &key)è!ğ
CRYPT_OK
) {

240  
”r
;

243 
	`nÛkeÚ_ecb_’üy±
(
‹¡s
[
i
].
±
, 
tmp
[0], &
key
);

244 
	`nÛkeÚ_ecb_deüy±
(
tmp
[0],mp[1], &
key
);

245 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
i
].
ù
, 16è|| XMEMCMPÑmp[1],e¡s[i].
±
, 16)) {

247 
	`´štf
("\n\nTe¡ %d faed\n", 
i
);

248 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
i
].
ù
, 16)) {

249 
	`´štf
("CT: ");

250 
i
 = 0; i < 16; i++) {

251 
	`´štf
("%02x ", 
tmp
[0][
i
]);

253 
	`´štf
("\n");

255 
	`´štf
("PT: ");

256 
i
 = 0; i < 16; i++) {

257 
	`´štf
("%02x ", 
tmp
[1][
i
]);

259 
	`´štf
("\n");

262  
CRYPT_FAIL_TESTVECTOR
;

266 
y
 = 0; y < 16; y++è
tmp
[0][y] = 0;

267 
y
 = 0; y < 1000; y++è
	`nÛkeÚ_ecb_’üy±
(
tmp
[0],mp[0], &
key
);

268 
y
 = 0; y < 1000; y++è
	`nÛkeÚ_ecb_deüy±
(
tmp
[0],mp[0], &
key
);

269 
y
 = 0; y < 16; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

271  
CRYPT_OK
;

273 
	}
}

278 
	$nÛkeÚ_dÚe
(
symm‘ric_key
 *
skey
)

280 
	}
}

287 
	$nÛkeÚ_keysize
(*
keysize
)

289 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

290 ià(*
keysize
 < 16) {

291  
CRYPT_INVALID_KEYSIZE
;

293 *
keysize
 = 16;

294  
CRYPT_OK
;

296 
	}
}

	@libtomcrypt/src/ciphers/rc2.c

21 
	~<tomüy±.h
>

28 #ifdeà
RC2


30 cÚ¡ 
Éc_ch”_desütÜ
 
	grc2_desc
 = {

33 &
rc2_£tup
,

34 &
rc2_ecb_’üy±
,

35 &
rc2_ecb_deüy±
,

36 &
rc2_‹¡
,

37 &
rc2_dÚe
,

38 &
rc2_keysize
,

39 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

43 cÚ¡ 
	g³rmu‹
[256] = {

70 
	$rc2_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

72 *
xkey
 = 
skey
->
rc2
.xkey;

73 
tmp
[128];

74 
T8
, 
TM
;

75 
i
, 
b™s
;

77 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

78 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

80 ià(
keyËn
 < 8 || keylen > 128) {

81  
CRYPT_INVALID_KEYSIZE
;

84 ià(
num_rounds
 != 0 &&‚um_rounds != 16) {

85  
CRYPT_INVALID_ROUNDS
;

88 
i
 = 0; i < 
keyËn
; i++) {

89 
tmp
[
i
] = 
key
[i] & 255;

93 ià(
keyËn
 < 128) {

94 
i
 = 
keyËn
; i < 128; i++) {

95 
tmp
[
i
] = 
³rmu‹
[Ñmp[˜- 1] +mp[˜- 
keyËn
]) & 255];

100 
b™s
 = 
keyËn
<<3;

101 
T8
 = ()(
b™s
+7)>>3;

102 
TM
 = (255 >> ()(7 & -
b™s
));

103 
tmp
[128 - 
T8
] = 
³rmu‹
[tmp[128 - T8] & 
TM
];

104 
i
 = 127 - 
T8
; i >= 0; i--) {

105 
tmp
[
i
] = 
³rmu‹
[tmp[˜+ 1] ^mp[˜+ 
T8
]];

109 
i
 = 0; i < 64; i++) {

110 
xkey
[
i
] = ()
tmp
[2*i] + (()tmp[2*i+1] << 8);

113 #ifdeà
LTC_CLEAN_STACK


114 
	`z”omem
(
tmp
, (tmp));

117  
CRYPT_OK
;

118 
	}
}

130 #ifdeà
LTC_CLEAN_STACK


131 
	$_rc2_ecb_’üy±
ĞcÚ¡ *
±
,

132 *
ù
,

133 
symm‘ric_key
 *
skey
)

135 
	$rc2_ecb_’üy±
ĞcÚ¡ *
±
,

136 *
ù
,

137 
symm‘ric_key
 *
skey
)

140 *
xkey
;

141 
x76
, 
x54
, 
x32
, 
x10
, 
i
;

143 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

144 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

145 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

147 
xkey
 = 
skey
->
rc2
.xkey;

149 
x76
 = (()
±
[7] << 8) + ()pt[6];

150 
x54
 = (()
±
[5] << 8) + ()pt[4];

151 
x32
 = (()
±
[3] << 8) + ()pt[2];

152 
x10
 = (()
±
[1] << 8) + ()pt[0];

154 
i
 = 0; i < 16; i++) {

155 
x10
 = (x10 + (
x32
 & ~
x76
è+ (
x54
 & x76è+ 
xkey
[4*
i
+0]) & 0xFFFF;

156 
x10
 = ((x10 << 1) | (x10 >> 15));

158 
x32
 = (x32 + (
x54
 & ~
x10
è+ (
x76
 & x10è+ 
xkey
[4*
i
+1]) & 0xFFFF;

159 
x32
 = ((x32 << 2) | (x32 >> 14));

161 
x54
 = (x54 + (
x76
 & ~
x32
è+ (
x10
 & x32è+ 
xkey
[4*
i
+2]) & 0xFFFF;

162 
x54
 = ((x54 << 3) | (x54 >> 13));

164 
x76
 = (x76 + (
x10
 & ~
x54
è+ (
x32
 & x54è+ 
xkey
[4*
i
+3]) & 0xFFFF;

165 
x76
 = ((x76 << 5) | (x76 >> 11));

167 ià(
i
 == 4 || i == 10) {

168 
x10
 = (x10 + 
xkey
[
x76
 & 63]) & 0xFFFF;

169 
x32
 = (x32 + 
xkey
[
x10
 & 63]) & 0xFFFF;

170 
x54
 = (x54 + 
xkey
[
x32
 & 63]) & 0xFFFF;

171 
x76
 = (x76 + 
xkey
[
x54
 & 63]) & 0xFFFF;

175 
ù
[0] = ()
x10
;

176 
ù
[1] = ()(
x10
 >> 8);

177 
ù
[2] = ()
x32
;

178 
ù
[3] = ()(
x32
 >> 8);

179 
ù
[4] = ()
x54
;

180 
ù
[5] = ()(
x54
 >> 8);

181 
ù
[6] = ()
x76
;

182 
ù
[7] = ()(
x76
 >> 8);

184  
CRYPT_OK
;

185 
	}
}

187 #ifdeà
LTC_CLEAN_STACK


188 
	$rc2_ecb_’üy±
ĞcÚ¡ *
±
,

189 *
ù
,

190 
symm‘ric_key
 *
skey
)

192 
”r
 = 
	`_rc2_ecb_’üy±
(
±
, 
ù
, 
skey
);

193 
	`buº_¡ack
((*) + () * 5);

194  
”r
;

195 
	}
}

208 #ifdeà
LTC_CLEAN_STACK


209 
	$_rc2_ecb_deüy±
ĞcÚ¡ *
ù
,

210 *
±
,

211 
symm‘ric_key
 *
skey
)

213 
	$rc2_ecb_deüy±
ĞcÚ¡ *
ù
,

214 *
±
,

215 
symm‘ric_key
 *
skey
)

218 
x76
, 
x54
, 
x32
, 
x10
;

219 *
xkey
;

220 
i
;

222 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

223 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

224 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

226 
xkey
 = 
skey
->
rc2
.xkey;

228 
x76
 = (()
ù
[7] << 8) + ()ct[6];

229 
x54
 = (()
ù
[5] << 8) + ()ct[4];

230 
x32
 = (()
ù
[3] << 8) + ()ct[2];

231 
x10
 = (()
ù
[1] << 8) + ()ct[0];

233 
i
 = 15; i >= 0; i--) {

234 ià(
i
 == 4 || i == 10) {

235 
x76
 = (x76 - 
xkey
[
x54
 & 63]) & 0xFFFF;

236 
x54
 = (x54 - 
xkey
[
x32
 & 63]) & 0xFFFF;

237 
x32
 = (x32 - 
xkey
[
x10
 & 63]) & 0xFFFF;

238 
x10
 = (x10 - 
xkey
[
x76
 & 63]) & 0xFFFF;

241 
x76
 = ((x76 << 11) | (x76 >> 5));

242 
x76
 = (x76 - ((
x10
 & ~
x54
è+ (
x32
 & x54è+ 
xkey
[4*
i
+3])) & 0xFFFF;

244 
x54
 = ((x54 << 13) | (x54 >> 3));

245 
x54
 = (x54 - ((
x76
 & ~
x32
è+ (
x10
 & x32è+ 
xkey
[4*
i
+2])) & 0xFFFF;

247 
x32
 = ((x32 << 14) | (x32 >> 2));

248 
x32
 = (x32 - ((
x54
 & ~
x10
è+ (
x76
 & x10è+ 
xkey
[4*
i
+1])) & 0xFFFF;

250 
x10
 = ((x10 << 15) | (x10 >> 1));

251 
x10
 = (x10 - ((
x32
 & ~
x76
è+ (
x54
 & x76è+ 
xkey
[4*
i
+0])) & 0xFFFF;

254 
±
[0] = ()
x10
;

255 
±
[1] = ()(
x10
 >> 8);

256 
±
[2] = ()
x32
;

257 
±
[3] = ()(
x32
 >> 8);

258 
±
[4] = ()
x54
;

259 
±
[5] = ()(
x54
 >> 8);

260 
±
[6] = ()
x76
;

261 
±
[7] = ()(
x76
 >> 8);

263  
CRYPT_OK
;

264 
	}
}

266 #ifdeà
LTC_CLEAN_STACK


267 
	$rc2_ecb_deüy±
ĞcÚ¡ *
ù
,

268 *
±
,

269 
symm‘ric_key
 *
skey
)

271 
”r
 = 
	`_rc2_ecb_deüy±
(
ù
, 
±
, 
skey
);

272 
	`buº_¡ack
((*) + () * 4 + ());

273  
”r
;

274 
	}
}

281 
	$rc2_‹¡
()

283 #iâdeà
LTC_TEST


284  
CRYPT_NOP
;

287 
keyËn
;

288 
key
[16], 
±
[8], 
ù
[8];

289 } 
‹¡s
[] = {

305 
x
, 
y
, 
”r
;

306 
symm‘ric_key
 
skey
;

307 
tmp
[2][8];

309 
x
 = 0; x < ()((
‹¡s
) / (tests[0])); x++) {

310 
	`z”omem
(
tmp
, (tmp));

311 ià((
”r
 = 
	`rc2_£tup
(
‹¡s
[
x
].
key
,e¡s[x].
keyËn
, 0, &
skey
)è!ğ
CRYPT_OK
) {

312  
”r
;

315 
	`rc2_ecb_’üy±
(
‹¡s
[
x
].
±
, 
tmp
[0], &
skey
);

316 
	`rc2_ecb_deüy±
(
tmp
[0],mp[1], &
skey
);

318 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
x
].
ù
, 8è!ğ0 || XMEMCMPÑmp[1],e¡s[x].
±
, 8) != 0) {

319  
CRYPT_FAIL_TESTVECTOR
;

323 
y
 = 0; y < 8; y++è
tmp
[0][y] = 0;

324 
y
 = 0; y < 1000; y++è
	`rc2_ecb_’üy±
(
tmp
[0],mp[0], &
skey
);

325 
y
 = 0; y < 1000; y++è
	`rc2_ecb_deüy±
(
tmp
[0],mp[0], &
skey
);

326 
y
 = 0; y < 8; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

328  
CRYPT_OK
;

330 
	}
}

335 
	$rc2_dÚe
(
symm‘ric_key
 *
skey
)

337 
	}
}

344 
	$rc2_keysize
(*
keysize
)

346 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

347 ià(*
keysize
 < 8) {

348  
CRYPT_INVALID_KEYSIZE
;

349 } ià(*
keysize
 > 128) {

350 *
keysize
 = 128;

352  
CRYPT_OK
;

353 
	}
}

	@libtomcrypt/src/ciphers/rc5.c

17 
	~"tomüy±.h
"

19 #ifdeà
RC5


21 cÚ¡ 
Éc_ch”_desütÜ
 
	grc5_desc
 =

26 &
rc5_£tup
,

27 &
rc5_ecb_’üy±
,

28 &
rc5_ecb_deüy±
,

29 &
rc5_‹¡
,

30 &
rc5_dÚe
,

31 &
rc5_keysize
,

32 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

35 cÚ¡ 
ulÚg32
 
	g¡ab
[50] = {

53 #ifdeà
LTC_CLEAN_STACK


54 
	$_rc5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

56 
	$rc5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

59 
ulÚg32
 
L
[64], *
S
, 
A
, 
B
, 
i
, 
j
, 
v
, 
s
, 
t
, 
l
;

61 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

62 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

65 ià(
num_rounds
 == 0) {

66 
num_rounds
 = 
rc5_desc
.
deçuÉ_rounds
;

69 ià(
num_rounds
 < 12 ||‚um_rounds > 24) {

70  
CRYPT_INVALID_ROUNDS
;

74 ià(
keyËn
 < 8 || keylen > 128) {

75  
CRYPT_INVALID_KEYSIZE
;

78 
skey
->
rc5
.
rounds
 = 
num_rounds
;

79 
S
 = 
skey
->
rc5
.
K
;

82 
A
 = 
i
 = 
j
 = 0; i < (
ulÚg32
)
keyËn
; ) {

83 
A
 = (A << 8è| ((
ulÚg32
)(
key
[
i
++] & 255));

84 ià((
i
 & 3) == 0) {

85 
L
[
j
++] = 
	`BSWAP
(
A
);

86 
A
 = 0;

90 ià((
keyËn
 & 3) != 0) {

91 
A
 <<ğ(
ulÚg32
)((8 * (4 - (
keyËn
&3))));

92 
L
[
j
++] = 
	`BSWAP
(
A
);

96 
t
 = (
ulÚg32
)(2 * (
num_rounds
 + 1));

97 
	`XMEMCPY
(
S
, 
¡ab
, 
t
 * (*S));

100 
s
 = 3 * 
	`MAX
(
t
, 
j
);

101 
l
 = 
j
;

102 
A
 = 
B
 = 
i
 = 
j
 = 
v
 = 0; v < 
s
; v++) {

103 
A
 = 
S
[
i
] = 
	`ROLc
(S[i] + A + 
B
, 3);

104 
B
 = 
L
[
j
] = 
	`ROL
(L[j] + 
A
 + B, (A+B));

105 ià(++
i
 =ğ
t
) { i = 0; }

106 ià(++
j
 =ğ
l
) { j = 0; }

108  
CRYPT_OK
;

109 
	}
}

111 #ifdeà
LTC_CLEAN_STACK


112 
	$rc5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

114 
x
;

115 
x
 = 
	`_rc5_£tup
(
key
, 
keyËn
, 
num_rounds
, 
skey
);

116 
	`buº_¡ack
((
ulÚg32
) * 122 + ());

117  
x
;

118 
	}
}

128 #ifdeà
LTC_CLEAN_STACK


129 
	$_rc5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

131 
	$rc5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

134 
ulÚg32
 
A
, 
B
, *
K
;

135 
r
;

136 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

137 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

138 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

140 
	`LOAD32L
(
A
, &
±
[0]);

141 
	`LOAD32L
(
B
, &
±
[4]);

142 
A
 +ğ
skey
->
rc5
.
K
[0];

143 
B
 +ğ
skey
->
rc5
.
K
[1];

144 
K
 = 
skey
->
rc5
.K + 2;

146 ià((
skey
->
rc5
.
rounds
 & 1) == 0) {

147 
r
 = 0;„ < 
skey
->
rc5
.
rounds
;„ += 2) {

148 
A
 = 
	`ROL
(A ^ 
B
, Bè+ 
K
[0];

149 
B
 = 
	`ROL
(B ^ 
A
, Aè+ 
K
[1];

150 
A
 = 
	`ROL
(A ^ 
B
, Bè+ 
K
[2];

151 
B
 = 
	`ROL
(B ^ 
A
, Aè+ 
K
[3];

152 
K
 += 4;

155 
r
 = 0;„ < 
skey
->
rc5
.
rounds
;„++) {

156 
A
 = 
	`ROL
(A ^ 
B
, Bè+ 
K
[0];

157 
B
 = 
	`ROL
(B ^ 
A
, Aè+ 
K
[1];

158 
K
 += 2;

161 
	`STORE32L
(
A
, &
ù
[0]);

162 
	`STORE32L
(
B
, &
ù
[4]);

164  
CRYPT_OK
;

165 
	}
}

167 #ifdeà
LTC_CLEAN_STACK


168 
	$rc5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

170 
”r
 = 
	`_rc5_ecb_’üy±
(
±
, 
ù
, 
skey
);

171 
	`buº_¡ack
((
ulÚg32
) * 2 + ());

172  
”r
;

173 
	}
}

183 #ifdeà
LTC_CLEAN_STACK


184 
	$_rc5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

186 
	$rc5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

189 
ulÚg32
 
A
, 
B
, *
K
;

190 
r
;

191 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

192 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

193 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

195 
	`LOAD32L
(
A
, &
ù
[0]);

196 
	`LOAD32L
(
B
, &
ù
[4]);

197 
K
 = 
skey
->
rc5
.K + (skey->rc5.
rounds
 << 1);

199 ià((
skey
->
rc5
.
rounds
 & 1) == 0) {

200 
K
 -= 2;

201 
r
 = 
skey
->
rc5
.
rounds
 - 1;„ >= 0;„ -= 2) {

202 
B
 = 
	`ROR
(B - 
K
[3], 
A
) ^ A;

203 
A
 = 
	`ROR
(A - 
K
[2], 
B
) ^ B;

204 
B
 = 
	`ROR
(B - 
K
[1], 
A
) ^ A;

205 
A
 = 
	`ROR
(A - 
K
[0], 
B
) ^ B;

206 
K
 -= 4;

209 
r
 = 
skey
->
rc5
.
rounds
 - 1;„ >= 0;„--) {

210 
B
 = 
	`ROR
(B - 
K
[1], 
A
) ^ A;

211 
A
 = 
	`ROR
(A - 
K
[0], 
B
) ^ B;

212 
K
 -= 2;

215 
A
 -ğ
skey
->
rc5
.
K
[0];

216 
B
 -ğ
skey
->
rc5
.
K
[1];

217 
	`STORE32L
(
A
, &
±
[0]);

218 
	`STORE32L
(
B
, &
±
[4]);

220  
CRYPT_OK
;

221 
	}
}

223 #ifdeà
LTC_CLEAN_STACK


224 
	$rc5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

226 
”r
 = 
	`_rc5_ecb_deüy±
(
ù
, 
±
, 
skey
);

227 
	`buº_¡ack
((
ulÚg32
) * 2 + ());

228  
”r
;

229 
	}
}

236 
	$rc5_‹¡
()

238 #iâdeà
LTC_TEST


239  
CRYPT_NOP
;

242 
key
[16], 
±
[8], 
ù
[8];

243 } 
‹¡s
[] = {

263 
tmp
[2][8];

264 
x
, 
y
, 
”r
;

265 
symm‘ric_key
 
key
;

267 
x
 = 0; x < ()((
‹¡s
) / (tests[0])); x++) {

269 ià((
”r
 = 
	`rc5_£tup
(
‹¡s
[
x
].
key
, 16, 12, &key)è!ğ
CRYPT_OK
) {

270  
”r
;

274 
	`rc5_ecb_’üy±
(
‹¡s
[
x
].
±
, 
tmp
[0], &
key
);

275 
	`rc5_ecb_deüy±
(
tmp
[0],mp[1], &
key
);

278 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
x
].
ù
, 8è!ğ0 || XMEMCMPÑmp[1],e¡s[x].
±
, 8) != 0) {

279  
CRYPT_FAIL_TESTVECTOR
;

283 
y
 = 0; y < 8; y++è
tmp
[0][y] = 0;

284 
y
 = 0; y < 1000; y++è
	`rc5_ecb_’üy±
(
tmp
[0],mp[0], &
key
);

285 
y
 = 0; y < 1000; y++è
	`rc5_ecb_deüy±
(
tmp
[0],mp[0], &
key
);

286 
y
 = 0; y < 8; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

288  
CRYPT_OK
;

290 
	}
}

295 
	$rc5_dÚe
(
symm‘ric_key
 *
skey
)

297 
	}
}

304 
	$rc5_keysize
(*
keysize
)

306 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

307 ià(*
keysize
 < 8) {

308  
CRYPT_INVALID_KEYSIZE
;

309 } ià(*
keysize
 > 128) {

310 *
keysize
 = 128;

312  
CRYPT_OK
;

313 
	}
}

	@libtomcrypt/src/ciphers/rc6.c

16 
	~"tomüy±.h
"

18 #ifdeà
RC6


20 cÚ¡ 
Éc_ch”_desütÜ
 
	grc6_desc
 =

25 &
rc6_£tup
,

26 &
rc6_ecb_’üy±
,

27 &
rc6_ecb_deüy±
,

28 &
rc6_‹¡
,

29 &
rc6_dÚe
,

30 &
rc6_keysize
,

31 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

34 cÚ¡ 
ulÚg32
 
	g¡ab
[44] = {

50 #ifdeà
LTC_CLEAN_STACK


51 
	$_rc6_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

53 
	$rc6_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

56 
ulÚg32
 
L
[64], 
S
[50], 
A
, 
B
, 
i
, 
j
, 
v
, 
s
, 
l
;

58 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

59 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

62 ià(
num_rounds
 != 0 &&‚um_rounds != 20) {

63  
CRYPT_INVALID_ROUNDS
;

67 ià(
keyËn
 < 8 || keylen > 128) {

68  
CRYPT_INVALID_KEYSIZE
;

72 
A
 = 
i
 = 
j
 = 0; i < (
ulÚg32
)
keyËn
; ) {

73 
A
 = (A << 8è| ((
ulÚg32
)(
key
[
i
++] & 255));

74 ià(!(
i
 & 3)) {

75 
L
[
j
++] = 
	`BSWAP
(
A
);

76 
A
 = 0;

81 ià(
keyËn
 & 3) {

82 
A
 <<ğ(8 * (4 - (
keyËn
&3)));

83 
L
[
j
++] = 
	`BSWAP
(
A
);

87 
	`XMEMCPY
(
S
, 
¡ab
, 44 * (stab[0]));

90 
s
 = 3 * 
	`MAX
(44, 
j
);

91 
l
 = 
j
;

92 
A
 = 
B
 = 
i
 = 
j
 = 
v
 = 0; v < 
s
; v++) {

93 
A
 = 
S
[
i
] = 
	`ROLc
(S[i] + A + 
B
, 3);

94 
B
 = 
L
[
j
] = 
	`ROL
(L[j] + 
A
 + B, (A+B));

95 ià(++
i
 == 44) { i = 0; }

96 ià(++
j
 =ğ
l
) { j = 0; }

100 
i
 = 0; i < 44; i++) {

101 
skey
->
rc6
.
K
[
i
] = 
S
[i];

103  
CRYPT_OK
;

104 
	}
}

106 #ifdeà
LTC_CLEAN_STACK


107 
	$rc6_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

109 
x
;

110 
x
 = 
	`_rc6_£tup
(
key
, 
keyËn
, 
num_rounds
, 
skey
);

111 
	`buº_¡ack
((
ulÚg32
) * 122);

112  
x
;

113 
	}
}

122 #ifdeà
LTC_CLEAN_STACK


123 
	$_rc6_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

125 
	$rc6_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

128 
ulÚg32
 
a
,
b
,
c
,
d
,
t
,
u
, *
K
;

129 
r
;

131 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

132 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

133 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

134 
	`LOAD32L
(
a
,&
±
[0]);LOAD32L(
b
,&±[4]);LOAD32L(
c
,&±[8]);LOAD32L(
d
,&pt[12]);

136 
b
 +ğ
skey
->
rc6
.
K
[0];

137 
d
 +ğ
skey
->
rc6
.
K
[1];

139 
	#RND
(
a
,
b
,
c
,
d
) \

140 
t
 = (
b
 * (b + b + 1)); = 
	`ROLc
(t, 5); \

141 
u
 = (
d
 * (d + d + 1)); u = 
	`ROLc
(u, 5); \

142 
a
 = 
	`ROL
×^
t
,
u
è+ 
K
[0]; \

143 
c
 = 
	`ROL
(c^
u
,
t
è+ 
K
[1]; K +ğ2;

	)

145 
K
 = 
skey
->
rc6
.K + 2;

146 
r
 = 0;„ < 20;„ += 4) {

147 
	`RND
(
a
,
b
,
c
,
d
);

148 
	`RND
(
b
,
c
,
d
,
a
);

149 
	`RND
(
c
,
d
,
a
,
b
);

150 
	`RND
(
d
,
a
,
b
,
c
);

153 #undeà
RND


155 
a
 +ğ
skey
->
rc6
.
K
[42];

156 
c
 +ğ
skey
->
rc6
.
K
[43];

157 
	`STORE32L
(
a
,&
ù
[0]);STORE32L(
b
,&ù[4]);STORE32L(
c
,&ù[8]);STORE32L(
d
,&ct[12]);

158  
CRYPT_OK
;

159 
	}
}

161 #ifdeà
LTC_CLEAN_STACK


162 
	$rc6_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

164 
”r
 = 
	`_rc6_ecb_’üy±
(
±
, 
ù
, 
skey
);

165 
	`buº_¡ack
((
ulÚg32
) * 6 + ());

166  
”r
;

167 
	}
}

176 #ifdeà
LTC_CLEAN_STACK


177 
	$_rc6_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

179 
	$rc6_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

182 
ulÚg32
 
a
,
b
,
c
,
d
,
t
,
u
, *
K
;

183 
r
;

185 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

186 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

187 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

189 
	`LOAD32L
(
a
,&
ù
[0]);LOAD32L(
b
,&ù[4]);LOAD32L(
c
,&ù[8]);LOAD32L(
d
,&ct[12]);

190 
a
 -ğ
skey
->
rc6
.
K
[42];

191 
c
 -ğ
skey
->
rc6
.
K
[43];

193 
	#RND
(
a
,
b
,
c
,
d
) \

194 
t
 = (
b
 * (b + b + 1)); = 
	`ROLc
(t, 5); \

195 
u
 = (
d
 * (d + d + 1)); u = 
	`ROLc
(u, 5); \

196 
c
 = 
	`ROR
(ø- 
K
[1], 
t
è^ 
u
; \

197 
a
 = 
	`ROR
× - 
K
[0], 
u
è^ 
t
; K -ğ2;

	)

199 
K
 = 
skey
->
rc6
.K + 40;

201 
r
 = 0;„ < 20;„ += 4) {

202 
	`RND
(
d
,
a
,
b
,
c
);

203 
	`RND
(
c
,
d
,
a
,
b
);

204 
	`RND
(
b
,
c
,
d
,
a
);

205 
	`RND
(
a
,
b
,
c
,
d
);

208 #undeà
RND


210 
b
 -ğ
skey
->
rc6
.
K
[0];

211 
d
 -ğ
skey
->
rc6
.
K
[1];

212 
	`STORE32L
(
a
,&
±
[0]);STORE32L(
b
,&±[4]);STORE32L(
c
,&±[8]);STORE32L(
d
,&pt[12]);

214  
CRYPT_OK
;

215 
	}
}

217 #ifdeà
LTC_CLEAN_STACK


218 
	$rc6_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

220 
”r
 = 
	`_rc6_ecb_deüy±
(
ù
, 
±
, 
skey
);

221 
	`buº_¡ack
((
ulÚg32
) * 6 + ());

222  
”r
;

223 
	}
}

230 
	$rc6_‹¡
()

232 #iâdeà
LTC_TEST


233  
CRYPT_NOP
;

236 
keyËn
;

237 
key
[32], 
±
[16], 
ù
[16];

238 } 
‹¡s
[] = {

273 
tmp
[2][16];

274 
x
, 
y
, 
”r
;

275 
symm‘ric_key
 
key
;

277 
x
 = 0; x < ()((
‹¡s
) / (tests[0])); x++) {

279 ià((
”r
 = 
	`rc6_£tup
(
‹¡s
[
x
].
key
,e¡s[x].
keyËn
, 0, &key)è!ğ
CRYPT_OK
) {

280  
”r
;

284 
	`rc6_ecb_’üy±
(
‹¡s
[
x
].
±
, 
tmp
[0], &
key
);

285 
	`rc6_ecb_deüy±
(
tmp
[0],mp[1], &
key
);

288 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
x
].
ù
, 16è|| XMEMCMPÑmp[1],e¡s[x].
±
, 16)) {

290 
	`´štf
("\n\nFaede¡ %d\n", 
x
);

291 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
x
].
ù
, 16)) {

292 
	`´štf
("Ciphertext: ");

293 
y
 = 0; y < 16; y++è
	`´štf
("%02x ", 
tmp
[0][y]);

294 
	`´štf
("\nExpected : ");

295 
y
 = 0; y < 16; y++è
	`´štf
("%02x ", 
‹¡s
[
x
].
ù
[y]);

296 
	`´štf
("\n");

298 ià(
	`XMEMCMP
(
tmp
[1], 
‹¡s
[
x
].
±
, 16)) {

299 
	`´štf
("Plaintext: ");

300 
y
 = 0; y < 16; y++è
	`´štf
("%02x ", 
tmp
[0][y]);

301 
	`´štf
("\nExpected : ");

302 
y
 = 0; y < 16; y++è
	`´štf
("%02x ", 
‹¡s
[
x
].
±
[y]);

303 
	`´štf
("\n");

306  
CRYPT_FAIL_TESTVECTOR
;

310 
y
 = 0; y < 16; y++è
tmp
[0][y] = 0;

311 
y
 = 0; y < 1000; y++è
	`rc6_ecb_’üy±
(
tmp
[0],mp[0], &
key
);

312 
y
 = 0; y < 1000; y++è
	`rc6_ecb_deüy±
(
tmp
[0],mp[0], &
key
);

313 
y
 = 0; y < 16; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

315  
CRYPT_OK
;

317 
	}
}

322 
	$rc6_dÚe
(
symm‘ric_key
 *
skey
)

324 
	}
}

331 
	$rc6_keysize
(*
keysize
)

333 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

334 ià(*
keysize
 < 8) {

335  
CRYPT_INVALID_KEYSIZE
;

336 } ià(*
keysize
 > 128) {

337 *
keysize
 = 128;

339  
CRYPT_OK
;

340 
	}
}

	@libtomcrypt/src/ciphers/safer/safer.c

31 
	~<tomüy±.h
>

33 #ifdeà
SAFER


35 cÚ¡ 
Éc_ch”_desütÜ


36 
	g§ãr_k64_desc
 = {

38 8, 8, 8, 8, 
SAFER_K64_DEFAULT_NOF_ROUNDS
,

39 &
§ãr_k64_£tup
,

40 &
§ãr_ecb_’üy±
,

41 &
§ãr_ecb_deüy±
,

42 &
§ãr_k64_‹¡
,

43 &
§ãr_dÚe
,

44 &
§ãr_64_keysize
,

45 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

48 
	g§ãr_sk64_desc
 = {

50 9, 8, 8, 8, 
SAFER_SK64_DEFAULT_NOF_ROUNDS
,

51 &
§ãr_sk64_£tup
,

52 &
§ãr_ecb_’üy±
,

53 &
§ãr_ecb_deüy±
,

54 &
§ãr_sk64_‹¡
,

55 &
§ãr_dÚe
,

56 &
§ãr_64_keysize
,

57 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

60 
	g§ãr_k128_desc
 = {

62 10, 16, 16, 8, 
SAFER_K128_DEFAULT_NOF_ROUNDS
,

63 &
§ãr_k128_£tup
,

64 &
§ãr_ecb_’üy±
,

65 &
§ãr_ecb_deüy±
,

66 &
§ãr_sk128_‹¡
,

67 &
§ãr_dÚe
,

68 &
§ãr_128_keysize
,

69 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

72 
	g§ãr_sk128_desc
 = {

74 11, 16, 16, 8, 
SAFER_SK128_DEFAULT_NOF_ROUNDS
,

75 &
§ãr_sk128_£tup
,

76 &
§ãr_ecb_’üy±
,

77 &
§ãr_ecb_deüy±
,

78 &
§ãr_sk128_‹¡
,

79 &
§ãr_dÚe
,

80 &
§ãr_128_keysize
,

81 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

90 
	#ROL8
(
x
, 
n
) (()(()(x) << (n)\

91 |()((
x
è& 0xFFè>> (8 - (
n
))))

	)

92 
	#EXP
(
x
è
§ãr_ebox
[(xè& 0xFF]

	)

93 
	#LOG
(
x
è
§ãr_lbox
[(xè& 0xFF]

	)

94 
	#PHT
(
x
, 
y
è{ y +ğx; x +ğy; }

	)

95 
	#IPHT
(
x
, 
y
è{ x -ğy; y -ğx; }

	)

98 cÚ¡ 
§ãr_ebox
[], 
§ãr_lbox
[];

100 #ifdeà
LTC_CLEAN_STACK


101 
	$_Saãr_Ex·nd_U£rkey
(cÚ¡ *
u£rkey_1
,

102 cÚ¡ *
u£rkey_2
,

103 
nof_rounds
,

104 
¡»ngth’ed
,

105 
§ãr_key_t
 
key
)

107 
	$Saãr_Ex·nd_U£rkey
(cÚ¡ *
u£rkey_1
,

108 cÚ¡ *
u£rkey_2
,

109 
nof_rounds
,

110 
¡»ngth’ed
,

111 
§ãr_key_t
 
key
)

113 { 
i
, 
j
, 
k
;

114 
ka
[
SAFER_BLOCK_LEN
 + 1];

115 
kb
[
SAFER_BLOCK_LEN
 + 1];

117 ià(
SAFER_MAX_NOF_ROUNDS
 < 
nof_rounds
)

118 
nof_rounds
 = 
SAFER_MAX_NOF_ROUNDS
;

119 *
key
++ = ()
nof_rounds
;

120 
ka
[
SAFER_BLOCK_LEN
] = ()0;

121 
kb
[
SAFER_BLOCK_LEN
] = ()0;

122 
k
 = 0;

123 
j
 = 0; j < 
SAFER_BLOCK_LEN
; j++) {

124 
ka
[
j
] = 
	`ROL8
(
u£rkey_1
[j], 5);

125 
ka
[
SAFER_BLOCK_LEN
] ^ğka[
j
];

126 
kb
[
j
] = *
key
++ = 
u£rkey_2
[j];

127 
kb
[
SAFER_BLOCK_LEN
] ^ğkb[
j
];

129 
i
 = 1; i <ğ
nof_rounds
; i++) {

130 
j
 = 0; j < 
SAFER_BLOCK_LEN
 + 1; j++) {

131 
ka
[
j
] = 
	`ROL8
(ka[j], 6);

132 
kb
[
j
] = 
	`ROL8
(kb[j], 6);

134 ià(
¡»ngth’ed
) {

135 
k
 = 2 * 
i
 - 1;

136 
k
 >ğ(
SAFER_BLOCK_LEN
 + 1)) { k -= SAFER_BLOCK_LEN + 1; }

138 
j
 = 0; j < 
SAFER_BLOCK_LEN
; j++) {

139 ià(
¡»ngth’ed
) {

140 *
key
++ = (
ka
[
k
]

141 + 
§ãr_ebox
[()§ãr_ebox[()((18 * 
i
 + 
j
 + 1)&0xFF)]]) & 0xFF;

142 ià(++
k
 =ğ(
SAFER_BLOCK_LEN
 + 1)) { k = 0; }

144 *
key
++ = (
ka
[
j
] + 
§ãr_ebox
[()§ãr_ebox[()((18 * 
i
 + j + 1)&0xFF)]]) & 0xFF;

147 ià(
¡»ngth’ed
) {

148 
k
 = 2 * 
i
;

149 
k
 >ğ(
SAFER_BLOCK_LEN
 + 1)) { k -= SAFER_BLOCK_LEN + 1; }

151 
j
 = 0; j < 
SAFER_BLOCK_LEN
; j++) {

152 ià(
¡»ngth’ed
) {

153 *
key
++ = (
kb
[
k
]

154 + 
§ãr_ebox
[()§ãr_ebox[()((18 * 
i
 + 
j
 + 10)&0xFF)]]) & 0xFF;

155 ià(++
k
 =ğ(
SAFER_BLOCK_LEN
 + 1)) { k = 0; }

157 *
key
++ = (
kb
[
j
] + 
§ãr_ebox
[()§ãr_ebox[()((18 * 
i
 + j + 10)&0xFF)]]) & 0xFF;

162 #ifdeà
LTC_CLEAN_STACK


163 
	`z”omem
(
ka
, (ka));

164 
	`z”omem
(
kb
, (kb));

166 
	}
}

168 #ifdeà
LTC_CLEAN_STACK


169 
	$Saãr_Ex·nd_U£rkey
(cÚ¡ *
u£rkey_1
,

170 cÚ¡ *
u£rkey_2
,

171 
nof_rounds
,

172 
¡»ngth’ed
,

173 
§ãr_key_t
 
key
)

175 
	`_Saãr_Ex·nd_U£rkey
(
u£rkey_1
, 
u£rkey_2
, 
nof_rounds
, 
¡»ngth’ed
, 
key
);

176 
	`buº_¡ack
((è* (2 * (
SAFER_BLOCK_LEN
 + 1)) + ()*2);

177 
	}
}

180 
	$§ãr_k64_£tup
(cÚ¡ *
key
, 
keyËn
, 
numrounds
, 
symm‘ric_key
 *
skey
)

182 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

183 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

185 ià(
numrounds
 !ğ0 && (numround < 6 ||‚umround > 
SAFER_MAX_NOF_ROUNDS
)) {

186  
CRYPT_INVALID_ROUNDS
;

189 ià(
keyËn
 != 8) {

190  
CRYPT_INVALID_KEYSIZE
;

193 
	`Saãr_Ex·nd_U£rkey
(
key
, key, ()(
numrounds
 !ğ0 ?numrounds:
SAFER_K64_DEFAULT_NOF_ROUNDS
), 0, 
skey
->
§ãr
.key);

194  
CRYPT_OK
;

195 
	}
}

197 
	$§ãr_sk64_£tup
(cÚ¡ *
key
, 
keyËn
, 
numrounds
, 
symm‘ric_key
 *
skey
)

199 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

200 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

202 ià(
numrounds
 !ğ0 && (numround < 6 ||‚umround > 
SAFER_MAX_NOF_ROUNDS
)) {

203  
CRYPT_INVALID_ROUNDS
;

206 ià(
keyËn
 != 8) {

207  
CRYPT_INVALID_KEYSIZE
;

210 
	`Saãr_Ex·nd_U£rkey
(
key
, key, ()(
numrounds
 !ğ0 ?numrounds:
SAFER_SK64_DEFAULT_NOF_ROUNDS
), 1, 
skey
->
§ãr
.key);

211  
CRYPT_OK
;

212 
	}
}

214 
	$§ãr_k128_£tup
(cÚ¡ *
key
, 
keyËn
, 
numrounds
, 
symm‘ric_key
 *
skey
)

216 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

217 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

219 ià(
numrounds
 !ğ0 && (numround < 6 ||‚umround > 
SAFER_MAX_NOF_ROUNDS
)) {

220  
CRYPT_INVALID_ROUNDS
;

223 ià(
keyËn
 != 16) {

224  
CRYPT_INVALID_KEYSIZE
;

227 
	`Saãr_Ex·nd_U£rkey
(
key
, key+8, ()(
numrounds
 !ğ0 ?numrounds:
SAFER_K128_DEFAULT_NOF_ROUNDS
), 0, 
skey
->
§ãr
.key);

228  
CRYPT_OK
;

229 
	}
}

231 
	$§ãr_sk128_£tup
(cÚ¡ *
key
, 
keyËn
, 
numrounds
, 
symm‘ric_key
 *
skey
)

233 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

234 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

236 ià(
numrounds
 !ğ0 && (numround < 6 ||‚umround > 
SAFER_MAX_NOF_ROUNDS
)) {

237  
CRYPT_INVALID_ROUNDS
;

240 ià(
keyËn
 != 16) {

241  
CRYPT_INVALID_KEYSIZE
;

244 
	`Saãr_Ex·nd_U£rkey
(
key
, key+8, ()(
numrounds
 !ğ0?numrounds:
SAFER_SK128_DEFAULT_NOF_ROUNDS
), 1, 
skey
->
§ãr
.key);

245  
CRYPT_OK
;

246 
	}
}

248 #ifdeà
LTC_CLEAN_STACK


249 
	$_§ãr_ecb_’üy±
(cÚ¡ *
block_š
,

250 *
block_out
,

251 
symm‘ric_key
 *
skey
)

253 
	$§ãr_ecb_’üy±
(cÚ¡ *
block_š
,

254 *
block_out
,

255 
symm‘ric_key
 *
skey
)

257 { 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
t
;

258 
round
;

259 *
key
;

261 
	`LTC_ARGCHK
(
block_š
 !ğ
NULL
);

262 
	`LTC_ARGCHK
(
block_out
 !ğ
NULL
);

263 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

265 
key
 = 
skey
->
§ãr
.key;

266 
a
 = 
block_š
[0]; 
b
 = block_š[1]; 
c
 = block_š[2]; 
d
 = block_in[3];

267 
e
 = 
block_š
[4]; 
f
 = block_š[5]; 
g
 = block_š[6]; 
h
 = block_in[7];

268 ià(
SAFER_MAX_NOF_ROUNDS
 < (
round
 = *
key
))„ound = SAFER_MAX_NOF_ROUNDS;

269 
round
-- > 0)

271 
a
 ^ğ*++
key
; 
b
 +ğ*++key; 
c
 +ğ*++key; 
d
 ^= *++key;

272 
e
 ^ğ*++
key
; 
f
 +ğ*++key; 
g
 +ğ*++key; 
h
 ^= *++key;

273 
a
 = 
	`EXP
×è+ *++
key
; 
b
 = 
	`LOG
(b) ^ *++key;

274 
c
 = 
	`LOG
(cè^ *++
key
; 
d
 = 
	`EXP
(d) + *++key;

275 
e
 = 
	`EXP
Óè+ *++
key
; 
f
 = 
	`LOG
(f) ^ *++key;

276 
g
 = 
	`LOG
(gè^ *++
key
; 
h
 = 
	`EXP
(h) + *++key;

277 
	`PHT
(
a
, 
b
); PHT(
c
, 
d
); PHT(
e
, 
f
); PHT(
g
, 
h
);

278 
	`PHT
(
a
, 
c
); PHT(
e
, 
g
); PHT(
b
, 
d
); PHT(
f
, 
h
);

279 
	`PHT
(
a
, 
e
); PHT(
b
, 
f
); PHT(
c
, 
g
); PHT(
d
, 
h
);

280 
t
 = 
b
; b = 
e
;ƒ = 
c
; c =; = 
d
; d = 
f
; f = 
g
; g =;

282 
a
 ^ğ*++
key
; 
b
 +ğ*++key; 
c
 +ğ*++key; 
d
 ^= *++key;

283 
e
 ^ğ*++
key
; 
f
 +ğ*++key; 
g
 +ğ*++key; 
h
 ^= *++key;

284 
block_out
[0] = 
a
 & 0xFF; block_out[1] = 
b
 & 0xFF;

285 
block_out
[2] = 
c
 & 0xFF; block_out[3] = 
d
 & 0xFF;

286 
block_out
[4] = 
e
 & 0xFF; block_out[5] = 
f
 & 0xFF;

287 
block_out
[6] = 
g
 & 0xFF; block_out[7] = 
h
 & 0xFF;

288  
CRYPT_OK
;

289 
	}
}

291 #ifdeà
LTC_CLEAN_STACK


292 
	$§ãr_ecb_’üy±
(cÚ¡ *
block_š
,

293 *
block_out
,

294 
symm‘ric_key
 *
skey
)

296 
”r
 = 
	`_§ãr_ecb_’üy±
(
block_š
, 
block_out
, 
skey
);

297 
	`buº_¡ack
(() * 9 + () + (*));

298  
”r
;

299 
	}
}

302 #ifdeà
LTC_CLEAN_STACK


303 
	$_§ãr_ecb_deüy±
(cÚ¡ *
block_š
,

304 *
block_out
,

305 
symm‘ric_key
 *
skey
)

307 
	$§ãr_ecb_deüy±
(cÚ¡ *
block_š
,

308 *
block_out
,

309 
symm‘ric_key
 *
skey
)

311 { 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
t
;

312 
round
;

313 *
key
;

315 
	`LTC_ARGCHK
(
block_š
 !ğ
NULL
);

316 
	`LTC_ARGCHK
(
block_out
 !ğ
NULL
);

317 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

319 
key
 = 
skey
->
§ãr
.key;

320 
a
 = 
block_š
[0]; 
b
 = block_š[1]; 
c
 = block_š[2]; 
d
 = block_in[3];

321 
e
 = 
block_š
[4]; 
f
 = block_š[5]; 
g
 = block_š[6]; 
h
 = block_in[7];

322 ià(
SAFER_MAX_NOF_ROUNDS
 < (
round
 = *
key
))„ound = SAFER_MAX_NOF_ROUNDS;

323 
key
 +ğ
SAFER_BLOCK_LEN
 * (1 + 2 * 
round
);

324 
h
 ^ğ*
key
; 
g
 -ğ*--key; 
f
 -ğ*--key; 
e
 ^= *--key;

325 
d
 ^ğ*--
key
; 
c
 -ğ*--key; 
b
 -ğ*--key; 
a
 ^= *--key;

326 
round
--)

328 
t
 = 
e
;ƒ = 
b
; b = 
c
; c =; = 
f
; f = 
d
; d = 
g
; g =;

329 
	`IPHT
(
a
, 
e
); IPHT(
b
, 
f
); IPHT(
c
, 
g
); IPHT(
d
, 
h
);

330 
	`IPHT
(
a
, 
c
); IPHT(
e
, 
g
); IPHT(
b
, 
d
); IPHT(
f
, 
h
);

331 
	`IPHT
(
a
, 
b
); IPHT(
c
, 
d
); IPHT(
e
, 
f
); IPHT(
g
, 
h
);

332 
h
 -ğ*--
key
; 
g
 ^ğ*--key; 
f
 ^ğ*--key; 
e
 -= *--key;

333 
d
 -ğ*--
key
; 
c
 ^ğ*--key; 
b
 ^ğ*--key; 
a
 -= *--key;

334 
h
 = 
	`LOG
(hè^ *--
key
; 
g
 = 
	`EXP
(g) - *--key;

335 
f
 = 
	`EXP
(fè- *--
key
; 
e
 = 
	`LOG
(e) ^ *--key;

336 
d
 = 
	`LOG
(dè^ *--
key
; 
c
 = 
	`EXP
(c) - *--key;

337 
b
 = 
	`EXP
(bè- *--
key
; 
a
 = 
	`LOG
(a) ^ *--key;

339 
block_out
[0] = 
a
 & 0xFF; block_out[1] = 
b
 & 0xFF;

340 
block_out
[2] = 
c
 & 0xFF; block_out[3] = 
d
 & 0xFF;

341 
block_out
[4] = 
e
 & 0xFF; block_out[5] = 
f
 & 0xFF;

342 
block_out
[6] = 
g
 & 0xFF; block_out[7] = 
h
 & 0xFF;

343  
CRYPT_OK
;

344 
	}
}

346 #ifdeà
LTC_CLEAN_STACK


347 
	$§ãr_ecb_deüy±
(cÚ¡ *
block_š
,

348 *
block_out
,

349 
symm‘ric_key
 *
skey
)

351 
”r
 = 
	`_§ãr_ecb_deüy±
(
block_š
, 
block_out
, 
skey
);

352 
	`buº_¡ack
(() * 9 + () + (*));

353  
”r
;

354 
	}
}

357 
	$§ãr_64_keysize
(*
keysize
)

359 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

360 ià(*
keysize
 < 8) {

361  
CRYPT_INVALID_KEYSIZE
;

363 *
keysize
 = 8;

364  
CRYPT_OK
;

366 
	}
}

368 
	$§ãr_128_keysize
(*
keysize
)

370 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

371 ià(*
keysize
 < 16) {

372  
CRYPT_INVALID_KEYSIZE
;

374 *
keysize
 = 16;

375  
CRYPT_OK
;

377 
	}
}

379 
	$§ãr_k64_‹¡
()

381 #iâdeà
LTC_TEST


382  
CRYPT_NOP
;

384 cÚ¡ 
k64_±
[] = { 1, 2, 3, 4, 5, 6, 7, 8 },

385 
k64_key
[] = { 8, 7, 6, 5, 4, 3, 2, 1 },

386 
k64_ù
[] = { 200, 242, 156, 221, 135, 120, 62, 217 };

388 
symm‘ric_key
 
skey
;

389 
buf
[2][8];

390 
”r
;

393 ià((
”r
 = 
	`§ãr_k64_£tup
(
k64_key
, 8, 6, &
skey
)è!ğ
CRYPT_OK
) {

394  
”r
;

396 
	`§ãr_ecb_’üy±
(
k64_±
, 
buf
[0], &
skey
);

397 
	`§ãr_ecb_deüy±
(
buf
[0], buf[1], &
skey
);

399 ià(
	`XMEMCMP
(
buf
[0], 
k64_ù
, 8è!ğ0 || XMEMCMP(buf[1], 
k64_±
, 8) != 0) {

400  
CRYPT_FAIL_TESTVECTOR
;

403  
CRYPT_OK
;

405 
	}
}

408 
	$§ãr_sk64_‹¡
()

410 #iâdeà
LTC_TEST


411  
CRYPT_NOP
;

413 cÚ¡ 
sk64_±
[] = { 1, 2, 3, 4, 5, 6, 7, 8 },

414 
sk64_key
[] = { 1, 2, 3, 4, 5, 6, 7, 8 },

415 
sk64_ù
[] = { 95, 206, 155, 162, 5, 132, 56, 199 };

417 
symm‘ric_key
 
skey
;

418 
buf
[2][8];

419 
”r
, 
y
;

422 ià((
”r
 = 
	`§ãr_sk64_£tup
(
sk64_key
, 8, 6, &
skey
)è!ğ
CRYPT_OK
) {

423  
”r
;

426 
	`§ãr_ecb_’üy±
(
sk64_±
, 
buf
[0], &
skey
);

427 
	`§ãr_ecb_deüy±
(
buf
[0], buf[1], &
skey
);

429 ià(
	`XMEMCMP
(
buf
[0], 
sk64_ù
, 8è!ğ0 || XMEMCMP(buf[1], 
sk64_±
, 8) != 0) {

430  
CRYPT_FAIL_TESTVECTOR
;

434 
y
 = 0; y < 8; y++è
buf
[0][y] = 0;

435 
y
 = 0; y < 1000; y++è
	`§ãr_ecb_’üy±
(
buf
[0], buf[0], &
skey
);

436 
y
 = 0; y < 1000; y++è
	`§ãr_ecb_deüy±
(
buf
[0], buf[0], &
skey
);

437 
y
 = 0; y < 8; y++èià(
buf
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

439  
CRYPT_OK
;

441 
	}
}

446 
	$§ãr_dÚe
(
symm‘ric_key
 *
skey
)

448 
	}
}

450 
	$§ãr_sk128_‹¡
()

452 #iâdeà
LTC_TEST


453  
CRYPT_NOP
;

455 cÚ¡ 
sk128_±
[] = { 1, 2, 3, 4, 5, 6, 7, 8 },

456 
sk128_key
[] = { 1, 2, 3, 4, 5, 6, 7, 8,

458 
sk128_ù
[] = { 255, 120, 17, 228, 179, 167, 46, 113 };

460 
symm‘ric_key
 
skey
;

461 
buf
[2][8];

462 
”r
, 
y
;

465 ià((
”r
 = 
	`§ãr_sk128_£tup
(
sk128_key
, 16, 0, &
skey
)è!ğ
CRYPT_OK
) {

466  
”r
;

468 
	`§ãr_ecb_’üy±
(
sk128_±
, 
buf
[0], &
skey
);

469 
	`§ãr_ecb_deüy±
(
buf
[0], buf[1], &
skey
);

471 ià(
	`XMEMCMP
(
buf
[0], 
sk128_ù
, 8è!ğ0 || XMEMCMP(buf[1], 
sk128_±
, 8) != 0) {

472  
CRYPT_FAIL_TESTVECTOR
;

476 
y
 = 0; y < 8; y++è
buf
[0][y] = 0;

477 
y
 = 0; y < 1000; y++è
	`§ãr_ecb_’üy±
(
buf
[0], buf[0], &
skey
);

478 
y
 = 0; y < 1000; y++è
	`§ãr_ecb_deüy±
(
buf
[0], buf[0], &
skey
);

479 
y
 = 0; y < 8; y++èià(
buf
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

480  
CRYPT_OK
;

482 
	}
}

	@libtomcrypt/src/ciphers/safer/safer_tab.c

17 
	~"tomüy±.h
"

19 #ià
defšed
(
SAFERP
è|| defšed(
SAFER
)

23 cÚ¡ 
	g§ãr_ebox
[256] = {

43 cÚ¡ 
	g§ãr_lbox
[256] = {

	@libtomcrypt/src/ciphers/safer/saferp.c

16 
	~"tomüy±.h
"

18 #ifdeà
SAFERP


20 cÚ¡ 
Éc_ch”_desütÜ
 
	g§ã½_desc
 =

25 &
§ã½_£tup
,

26 &
§ã½_ecb_’üy±
,

27 &
§ã½_ecb_deüy±
,

28 &
§ã½_‹¡
,

29 &
§ã½_dÚe
,

30 &
§ã½_keysize
,

31 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

45 cÚ¡ 
§ãr_ebox
[], 
§ãr_lbox
[];

47 
	#ROUND
(
b
, 
i
) \

48 
b
[0] = (
§ãr_ebox
[(b[0] ^ 
skey
->
§ã½
.
K
[
i
][0]) & 255] + skey->saferp.K[i+1][0]) & 255; \

49 
b
[1] = 
§ãr_lbox
[(b[1] + 
skey
->
§ã½
.
K
[
i
][1]) & 255] ^ skey->saferp.K[i+1][1]; \

50 
b
[2] = 
§ãr_lbox
[(b[2] + 
skey
->
§ã½
.
K
[
i
][2]) & 255] ^ skey->saferp.K[i+1][2]; \

51 
b
[3] = (
§ãr_ebox
[(b[3] ^ 
skey
->
§ã½
.
K
[
i
][3]) & 255] + skey->saferp.K[i+1][3]) & 255; \

52 
b
[4] = (
§ãr_ebox
[(b[4] ^ 
skey
->
§ã½
.
K
[
i
][4]) & 255] + skey->saferp.K[i+1][4]) & 255; \

53 
b
[5] = 
§ãr_lbox
[(b[5] + 
skey
->
§ã½
.
K
[
i
][5]) & 255] ^ skey->saferp.K[i+1][5]; \

54 
b
[6] = 
§ãr_lbox
[(b[6] + 
skey
->
§ã½
.
K
[
i
][6]) & 255] ^ skey->saferp.K[i+1][6]; \

55 
b
[7] = (
§ãr_ebox
[(b[7] ^ 
skey
->
§ã½
.
K
[
i
][7]) & 255] + skey->saferp.K[i+1][7]) & 255; \

56 
b
[8] = (
§ãr_ebox
[(b[8] ^ 
skey
->
§ã½
.
K
[
i
][8]) & 255] + skey->saferp.K[i+1][8]) & 255; \

57 
b
[9] = 
§ãr_lbox
[(b[9] + 
skey
->
§ã½
.
K
[
i
][9]) & 255] ^ skey->saferp.K[i+1][9]; \

58 
b
[10] = 
§ãr_lbox
[(b[10] + 
skey
->
§ã½
.
K
[
i
][10]) & 255] ^ skey->saferp.K[i+1][10]; \

59 
b
[11] = (
§ãr_ebox
[(b[11] ^ 
skey
->
§ã½
.
K
[
i
][11]) & 255] + skey->saferp.K[i+1][11]) & 255; \

60 
b
[12] = (
§ãr_ebox
[(b[12] ^ 
skey
->
§ã½
.
K
[
i
][12]) & 255] + skey->saferp.K[i+1][12]) & 255; \

61 
b
[13] = 
§ãr_lbox
[(b[13] + 
skey
->
§ã½
.
K
[
i
][13]) & 255] ^ skey->saferp.K[i+1][13]; \

62 
b
[14] = 
§ãr_lbox
[(b[14] + 
skey
->
§ã½
.
K
[
i
][14]) & 255] ^ skey->saferp.K[i+1][14]; \

63 
b
[15] = (
§ãr_ebox
[(b[15] ^ 
skey
->
§ã½
.
K
[
i
][15]è& 255] + skey->§ã½.K[i+1][15]è& 255;

	)

66 
	#iROUND
(
b
, 
i
) \

67 
b
[0] = 
§ãr_lbox
[(b[0] - 
skey
->
§ã½
.
K
[
i
+1][0]) & 255] ^ skey->saferp.K[i][0]; \

68 
b
[1] = (
§ãr_ebox
[(b[1] ^ 
skey
->
§ã½
.
K
[
i
+1][1]) & 255] - skey->saferp.K[i][1]) & 255; \

69 
b
[2] = (
§ãr_ebox
[(b[2] ^ 
skey
->
§ã½
.
K
[
i
+1][2]) & 255] - skey->saferp.K[i][2]) & 255; \

70 
b
[3] = 
§ãr_lbox
[(b[3] - 
skey
->
§ã½
.
K
[
i
+1][3]) & 255] ^ skey->saferp.K[i][3]; \

71 
b
[4] = 
§ãr_lbox
[(b[4] - 
skey
->
§ã½
.
K
[
i
+1][4]) & 255] ^ skey->saferp.K[i][4]; \

72 
b
[5] = (
§ãr_ebox
[(b[5] ^ 
skey
->
§ã½
.
K
[
i
+1][5]) & 255] - skey->saferp.K[i][5]) & 255; \

73 
b
[6] = (
§ãr_ebox
[(b[6] ^ 
skey
->
§ã½
.
K
[
i
+1][6]) & 255] - skey->saferp.K[i][6]) & 255; \

74 
b
[7] = 
§ãr_lbox
[(b[7] - 
skey
->
§ã½
.
K
[
i
+1][7]) & 255] ^ skey->saferp.K[i][7]; \

75 
b
[8] = 
§ãr_lbox
[(b[8] - 
skey
->
§ã½
.
K
[
i
+1][8]) & 255] ^ skey->saferp.K[i][8]; \

76 
b
[9] = (
§ãr_ebox
[(b[9] ^ 
skey
->
§ã½
.
K
[
i
+1][9]) & 255] - skey->saferp.K[i][9]) & 255; \

77 
b
[10] = (
§ãr_ebox
[(b[10] ^ 
skey
->
§ã½
.
K
[
i
+1][10]) & 255] - skey->saferp.K[i][10]) & 255; \

78 
b
[11] = 
§ãr_lbox
[(b[11] - 
skey
->
§ã½
.
K
[
i
+1][11]) & 255] ^ skey->saferp.K[i][11]; \

79 
b
[12] = 
§ãr_lbox
[(b[12] - 
skey
->
§ã½
.
K
[
i
+1][12]) & 255] ^ skey->saferp.K[i][12]; \

80 
b
[13] = (
§ãr_ebox
[(b[13] ^ 
skey
->
§ã½
.
K
[
i
+1][13]) & 255] - skey->saferp.K[i][13]) & 255; \

81 
b
[14] = (
§ãr_ebox
[(b[14] ^ 
skey
->
§ã½
.
K
[
i
+1][14]) & 255] - skey->saferp.K[i][14]) & 255; \

82 
b
[15] = 
§ãr_lbox
[(b[15] - 
skey
->
§ã½
.
K
[
i
+1][15]è& 255] ^ skey->§ã½.K[i][15];

	)

85 
	#PHT
(
b
) \

86 
b
[0] = (b[0] + (b[1] = (b[0] + b[1]) & 255)) & 255; \

87 
b
[2] = (b[2] + (b[3] = (b[3] + b[2]) & 255)) & 255; \

88 
b
[4] = (b[4] + (b[5] = (b[5] + b[4]) & 255)) & 255; \

89 
b
[6] = (b[6] + (b[7] = (b[7] + b[6]) & 255)) & 255; \

90 
b
[8] = (b[8] + (b[9] = (b[9] + b[8]) & 255)) & 255; \

91 
b
[10] = (b[10] + (b[11] = (b[11] + b[10]) & 255)) & 255; \

92 
b
[12] = (b[12] + (b[13] = (b[13] + b[12]) & 255)) & 255; \

93 
b
[14] = (b[14] + (b[15] = (b[15] + b[14]è& 255)è& 255;

	)

96 
	#iPHT
(
b
) \

97 
b
[15] = (b[15] - (b[14] = (b[14] - b[15]) & 255)) & 255; \

98 
b
[13] = (b[13] - (b[12] = (b[12] - b[13]) & 255)) & 255; \

99 
b
[11] = (b[11] - (b[10] = (b[10] - b[11]) & 255)) & 255; \

100 
b
[9] = (b[9] - (b[8] = (b[8] - b[9]) & 255)) & 255; \

101 
b
[7] = (b[7] - (b[6] = (b[6] - b[7]) & 255)) & 255; \

102 
b
[5] = (b[5] - (b[4] = (b[4] - b[5]) & 255)) & 255; \

103 
b
[3] = (b[3] - (b[2] = (b[2] - b[3]) & 255)) & 255; \

104 
b
[1] = (b[1] - (b[0] = (b[0] - b[1]) & 255)) & 255; \

105 

	)

107 
	#SHUF
(
b
, 
b2
) \

108 
b2
[0] = 
b
[8]; b2[1] = b[11]; b2[2] = b[12]; b2[3] = b[15]; \

109 
b2
[4] = 
b
[2]; b2[5] = b[1]; b2[6] = b[6]; b2[7] = b[5]; \

110 
b2
[8] = 
b
[10]; b2[9] = b[9]; b2[10] = b[14]; b2[11] = b[13]; \

111 
b2
[12] = 
b
[0]; b2[13] = b[7]; b2[14] = b[4]; b2[15] = b[3];

	)

114 
	#iSHUF
(
b
, 
b2
) \

115 
b2
[0] = 
b
[12]; b2[1] = b[5]; b2[2] = b[4]; b2[3] = b[15]; \

116 
b2
[4] = 
b
[14]; b2[5] = b[7]; b2[6] = b[6]; b2[7] = b[13]; \

117 
b2
[8] = 
b
[0]; b2[9] = b[9]; b2[10] = b[8]; b2[11] = b[1]; \

118 
b2
[12] = 
b
[2]; b2[13] = b[11]; b2[14] = b[10]; b2[15] = b[3];

	)

124 
	#LT
(
b
, 
b2
) \

125 
	`PHT
(
b
); 
	`SHUF
(b, 
b2
); \

126 
	`PHT
(
b2
); 
	`SHUF
(b2, 
b
); \

127 
	`PHT
(
b
); 
	`SHUF
(b, 
b2
); \

128 
	`PHT
(
b2
);

	)

131 
	#iLT
(
b
, 
b2
) \

132 
	`iPHT
(
b
); \

133 
	`iSHUF
(
b
, 
b2
); 
	`iPHT
(b2); \

134 
	`iSHUF
(
b2
, 
b
); 
	`iPHT
(b); \

135 
	`iSHUF
(
b
, 
b2
); 
	`iPHT
(b2);

	)

137 #ifdeà
LTC_SMALL_CODE


139 
	$_round
(*
b
, 
i
, 
symm‘ric_key
 *
skey
)

141 
	`ROUND
(
b
, 
i
);

142 
	}
}

144 
	$_œound
(*
b
, 
i
, 
symm‘ric_key
 *
skey
)

146 
	`iROUND
(
b
, 
i
);

147 
	}
}

149 
	$_É
(*
b
, *
b2
)

151 
	`LT
(
b
, 
b2
);

152 
	}
}

154 
	$_t
(*
b
, *
b2
)

156 
	`iLT
(
b
, 
b2
);

157 
	}
}

159 #undeà
ROUND


160 
	#ROUND
(
b
, 
i
è
	`_round
(b, i, 
skey
)

	)

162 #undeà
iROUND


163 
	#iROUND
(
b
, 
i
è
	`_œound
(b, i, 
skey
)

	)

165 #undeà
LT


166 
	#LT
(
b
, 
b2
è
	`_É
(b, b2)

	)

168 #undeà
iLT


169 
	#iLT
(
b
, 
b2
è
	`_t
(b, b2)

	)

174 cÚ¡ 
	g§ãr_bŸs
[33][16] = {

216 
	$§ã½_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

218 
x
, 
y
, 
z
;

219 
t
[33];

220 cÚ¡ 
rounds
[3] = { 8, 12, 16 };

222 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

223 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

226 ià(
keyËn
 != 16 && keylen != 24 && keylen != 32) {

227  
CRYPT_INVALID_KEYSIZE
;

233 ià(
num_rounds
 !ğ0 &&‚um_round !ğ
rounds
[(
keyËn
/8)-2]) {

234  
CRYPT_INVALID_ROUNDS
;

238 ià(
keyËn
 == 16) {

240 
x
 = 
y
 = 0; x < 16; x++) {

241 
t
[
x
] = 
key
[x];

242 
y
 ^ğ
key
[
x
];

244 
t
[16] = 
y
;

247 
x
 = 0; x < 16; x++) {

248 
skey
->
§ã½
.
K
[0][
x
] = 
t
[x];

252 
x
 = 1; x < 17; x++) {

254 
y
 = 0; y < 17; y++) {

255 
t
[
y
] = ((t[y]<<3)|(t[y]>>5)) & 255;

259 
z
 = 
x
;

260 
y
 = 0; y < 16; y++) {

261 
skey
->
§ã½
.
K
[
x
][
y
] = (
t
[
z
] + 
§ãr_bŸs
[x-1][y]) & 255;

262 ià(++
z
 == 17) { z = 0; }

265 
skey
->
§ã½
.
rounds
 = 8;

266 } ià(
keyËn
 == 24) {

268 
x
 = 
y
 = 0; x < 24; x++) {

269 
t
[
x
] = 
key
[x];

270 
y
 ^ğ
key
[
x
];

272 
t
[24] = 
y
;

275 
x
 = 0; x < 16; x++) {

276 
skey
->
§ã½
.
K
[0][
x
] = 
t
[x];

279 
x
 = 1; x < 25; x++) {

281 
y
 = 0; y < 25; y++) {

282 
t
[
y
] = ((t[y]<<3)|(t[y]>>5)) & 255;

286 
z
 = 
x
;

287 
y
 = 0; y < 16; y++) {

288 
skey
->
§ã½
.
K
[
x
][
y
] = (
t
[
z
] + 
§ãr_bŸs
[x-1][y]) & 255;

289 ià(++
z
 == 25) { z = 0; }

292 
skey
->
§ã½
.
rounds
 = 12;

295 
x
 = 
y
 = 0; x < 32; x++) {

296 
t
[
x
] = 
key
[x];

297 
y
 ^ğ
key
[
x
];

299 
t
[32] = 
y
;

302 
x
 = 0; x < 16; x++) {

303 
skey
->
§ã½
.
K
[0][
x
] = 
t
[x];

306 
x
 = 1; x < 33; x++) {

308 
y
 = 0; y < 33; y++) {

309 
t
[
y
] = ((t[y]<<3)|(t[y]>>5)) & 255;

313 
z
 = 
x
;

314 
y
 = 0; y < 16; y++) {

315 
skey
->
§ã½
.
K
[
x
][
y
] = (
t
[
z
] + 
§ãr_bŸs
[x-1][y]) & 255;

316 ià(++
z
 == 33) { z = 0; }

319 
skey
->
§ã½
.
rounds
 = 16;

321 #ifdeà
LTC_CLEAN_STACK


322 
	`z”omem
(
t
, (t));

324  
CRYPT_OK
;

325 
	}
}

334 
	$§ã½_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

336 
b
[16];

337 
x
;

339 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

340 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

341 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

344 
x
 = 0; x < 16; x++) {

345 
b
[
x
] = 
±
[x];

347 
	`ROUND
(
b
, 0); 
	`LT
(b, 
ù
);

348 
	`ROUND
(
ù
, 2); 
	`LT
(ù, 
b
);

349 
	`ROUND
(
b
, 4); 
	`LT
(b, 
ù
);

350 
	`ROUND
(
ù
, 6); 
	`LT
(ù, 
b
);

351 
	`ROUND
(
b
, 8); 
	`LT
(b, 
ù
);

352 
	`ROUND
(
ù
, 10); 
	`LT
(ù, 
b
);

353 
	`ROUND
(
b
, 12); 
	`LT
(b, 
ù
);

354 
	`ROUND
(
ù
, 14); 
	`LT
(ù, 
b
);

356 ià(
skey
->
§ã½
.
rounds
 > 8) {

357 
	`ROUND
(
b
, 16); 
	`LT
(b, 
ù
);

358 
	`ROUND
(
ù
, 18); 
	`LT
(ù, 
b
);

359 
	`ROUND
(
b
, 20); 
	`LT
(b, 
ù
);

360 
	`ROUND
(
ù
, 22); 
	`LT
(ù, 
b
);

363 ià(
skey
->
§ã½
.
rounds
 > 12) {

364 
	`ROUND
(
b
, 24); 
	`LT
(b, 
ù
);

365 
	`ROUND
(
ù
, 26); 
	`LT
(ù, 
b
);

366 
	`ROUND
(
b
, 28); 
	`LT
(b, 
ù
);

367 
	`ROUND
(
ù
, 30); 
	`LT
(ù, 
b
);

369 
ù
[0] = 
b
[0] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][0];

370 
ù
[1] = (
b
[1] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][1]) & 255;

371 
ù
[2] = (
b
[2] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][2]) & 255;

372 
ù
[3] = 
b
[3] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][3];

373 
ù
[4] = 
b
[4] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][4];

374 
ù
[5] = (
b
[5] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][5]) & 255;

375 
ù
[6] = (
b
[6] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][6]) & 255;

376 
ù
[7] = 
b
[7] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][7];

377 
ù
[8] = 
b
[8] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][8];

378 
ù
[9] = (
b
[9] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][9]) & 255;

379 
ù
[10] = (
b
[10] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][10]) & 255;

380 
ù
[11] = 
b
[11] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][11];

381 
ù
[12] = 
b
[12] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][12];

382 
ù
[13] = (
b
[13] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][13]) & 255;

383 
ù
[14] = (
b
[14] + 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][14]) & 255;

384 
ù
[15] = 
b
[15] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][15];

385 #ifdeà
LTC_CLEAN_STACK


386 
	`z”omem
(
b
, (b));

388  
CRYPT_OK
;

389 
	}
}

398 
	$§ã½_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

400 
b
[16];

401 
x
;

403 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

404 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

405 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

408 
b
[0] = 
ù
[0] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][0];

409 
b
[1] = (
ù
[1] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][1]) & 255;

410 
b
[2] = (
ù
[2] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][2]) & 255;

411 
b
[3] = 
ù
[3] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][3];

412 
b
[4] = 
ù
[4] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][4];

413 
b
[5] = (
ù
[5] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][5]) & 255;

414 
b
[6] = (
ù
[6] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][6]) & 255;

415 
b
[7] = 
ù
[7] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][7];

416 
b
[8] = 
ù
[8] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][8];

417 
b
[9] = (
ù
[9] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][9]) & 255;

418 
b
[10] = (
ù
[10] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][10]) & 255;

419 
b
[11] = 
ù
[11] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][11];

420 
b
[12] = 
ù
[12] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][12];

421 
b
[13] = (
ù
[13] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][13]) & 255;

422 
b
[14] = (
ù
[14] - 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][14]) & 255;

423 
b
[15] = 
ù
[15] ^ 
skey
->
§ã½
.
K
[skey->§ã½.
rounds
*2][15];

425 ià(
skey
->
§ã½
.
rounds
 > 12) {

426 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt, 30);

427 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 28);

428 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt, 26);

429 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 24);

432 ià(
skey
->
§ã½
.
rounds
 > 8) {

433 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt, 22);

434 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 20);

435 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt, 18);

436 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 16);

438 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt, 14);

439 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 12);

440 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt,10);

441 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 8);

442 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt,6);

443 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 4);

444 
	`iLT
(
b
, 
±
); 
	`iROUND
(pt,2);

445 
	`iLT
(
±
, 
b
); 
	`iROUND
(b, 0);

446 
x
 = 0; x < 16; x++) {

447 
±
[
x
] = 
b
[x];

449 #ifdeà
LTC_CLEAN_STACK


450 
	`z”omem
(
b
, (b));

452  
CRYPT_OK
;

453 
	}
}

459 
	$§ã½_‹¡
()

461 #iâdeà
LTC_TEST


462  
CRYPT_NOP
;

465 
keyËn
;

466 
key
[32], 
±
[16], 
ù
[16];

467 } 
‹¡s
[] = {

498 
tmp
[2][16];

499 
symm‘ric_key
 
skey
;

500 
”r
, 
i
, 
y
;

502 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

503 ià((
”r
 = 
	`§ã½_£tup
(
‹¡s
[
i
].
key
,e¡s[i].
keyËn
, 0, &
skey
)è!ğ
CRYPT_OK
) {

504  
”r
;

506 
	`§ã½_ecb_’üy±
(
‹¡s
[
i
].
±
, 
tmp
[0], &
skey
);

507 
	`§ã½_ecb_deüy±
(
tmp
[0],mp[1], &
skey
);

510 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
i
].
ù
, 16è|| XMEMCMPÑmp[1],e¡s[i].
±
, 16)) {

511  
CRYPT_FAIL_TESTVECTOR
;

515 
y
 = 0; y < 16; y++è
tmp
[0][y] = 0;

516 
y
 = 0; y < 1000; y++è
	`§ã½_ecb_’üy±
(
tmp
[0],mp[0], &
skey
);

517 
y
 = 0; y < 1000; y++è
	`§ã½_ecb_deüy±
(
tmp
[0],mp[0], &
skey
);

518 
y
 = 0; y < 16; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

521  
CRYPT_OK
;

523 
	}
}

528 
	$§ã½_dÚe
(
symm‘ric_key
 *
skey
)

530 
	}
}

537 
	$§ã½_keysize
(*
keysize
)

539 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

541 ià(*
keysize
 < 16)

542  
CRYPT_INVALID_KEYSIZE
;

543 ià(*
keysize
 < 24) {

544 *
keysize
 = 16;

545 } ià(*
keysize
 < 32) {

546 *
keysize
 = 24;

548 *
keysize
 = 32;

550  
CRYPT_OK
;

551 
	}
}

	@libtomcrypt/src/ciphers/skipjack.c

16 
	~"tomüy±.h
"

18 #ifdeà
SKIPJACK


20 cÚ¡ 
Éc_ch”_desütÜ
 
	gskjack_desc
 =

25 &
skjack_£tup
,

26 &
skjack_ecb_’üy±
,

27 &
skjack_ecb_deüy±
,

28 &
skjack_‹¡
,

29 &
skjack_dÚe
,

30 &
skjack_keysize
,

31 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

34 cÚ¡ 
	gsbox
[256] = {

54 cÚ¡ 
	gkey¡•
[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 0 };

57 cÚ¡ 
	gikey¡•
[] = { 9, 0, 1, 2, 3, 4, 5, 6, 7, 8 };

67 
	$skjack_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

69 
x
;

71 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

72 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

74 ià(
keyËn
 != 10) {

75  
CRYPT_INVALID_KEYSIZE
;

78 ià(
num_rounds
 != 32 &&‚um_rounds != 0) {

79  
CRYPT_INVALID_ROUNDS
;

83 
x
 = 0; x < 10; x++) {

84 
skey
->
skjack
.
key
[
x
] = key[x] & 255;

87  
CRYPT_OK
;

88 
	}
}

90 
	#RULE_A
 \

91 
tmp
 = 
	`g_func
(
w1
, &
kp
, 
skey
->
skjack
.
key
); \

92 
w1
 = 
tmp
 ^ 
w4
 ^ 
x
; \

93 
w4
 = 
w3
; w3 = 
w2
; \

94 
w2
 = 
tmp
;

	)

96 
	#RULE_B
 \

97 
tmp
 = 
	`g_func
(
w1
, &
kp
, 
skey
->
skjack
.
key
); \

98 
tmp1
 = 
w4
; w4 = 
w3
; \

99 
w3
 = 
w1
 ^ 
w2
 ^ 
x
; \

100 
w1
 = 
tmp1
; 
w2
 = 
tmp
;

	)

102 
	#RULE_A1
 \

103 
tmp
 = 
w1
 ^ 
w2
 ^ 
x
; \

104 
w1
 = 
	`ig_func
(
w2
, &
kp
, 
skey
->
skjack
.
key
); \

105 
w2
 = 
w3
; w3 = 
w4
; w4 = 
tmp
;

	)

107 
	#RULE_B1
 \

108 
tmp
 = 
	`ig_func
(
w2
, &
kp
, 
skey
->
skjack
.
key
); \

109 
w2
 = 
tmp
 ^ 
w3
 ^ 
x
; \

110 
w3
 = 
w4
; w4 = 
w1
; w1 = 
tmp
;

	)

112 
	$g_func
(
w
, *
kp
, *
key
)

114 
g1
,
g2
;

116 
g1
 = (
w
 >> 8è& 255; 
g2
 = w & 255;

117 
g1
 ^ğ
sbox
[
g2
^
key
[*
kp
]]; *k°ğ
key¡•
[*kp];

118 
g2
 ^ğ
sbox
[
g1
^
key
[*
kp
]]; *k°ğ
key¡•
[*kp];

119 
g1
 ^ğ
sbox
[
g2
^
key
[*
kp
]]; *k°ğ
key¡•
[*kp];

120 
g2
 ^ğ
sbox
[
g1
^
key
[*
kp
]]; *k°ğ
key¡•
[*kp];

121  (()
g1
<<8)|()
g2
;

122 
	}
}

124 
	$ig_func
(
w
, *
kp
, *
key
)

126 
g1
,
g2
;

128 
g1
 = (
w
 >> 8è& 255; 
g2
 = w & 255;

129 *
kp
 = 
ikey¡•
[*kp]; 
g2
 ^ğ
sbox
[
g1
^
key
[*kp]];

130 *
kp
 = 
ikey¡•
[*kp]; 
g1
 ^ğ
sbox
[
g2
^
key
[*kp]];

131 *
kp
 = 
ikey¡•
[*kp]; 
g2
 ^ğ
sbox
[
g1
^
key
[*kp]];

132 *
kp
 = 
ikey¡•
[*kp]; 
g1
 ^ğ
sbox
[
g2
^
key
[*kp]];

133  (()
g1
<<8)|()
g2
;

134 
	}
}

143 #ifdeà
LTC_CLEAN_STACK


144 
	$_skjack_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

146 
	$skjack_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

149 
w1
,
w2
,
w3
,
w4
,
tmp
,
tmp1
;

150 
x
, 
kp
;

152 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

153 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

154 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

157 
w1
 = (()
±
[0]<<8)|pt[1];

158 
w2
 = (()
±
[2]<<8)|pt[3];

159 
w3
 = (()
±
[4]<<8)|pt[5];

160 
w4
 = (()
±
[6]<<8)|pt[7];

163 
x
 = 1, 
kp
 = 0; x < 9; x++) {

164 
RULE_A
;

168 ; 
x
 < 17; x++) {

169 
RULE_B
;

173 ; 
x
 < 25; x++) {

174 
RULE_A
;

178 ; 
x
 < 33; x++) {

179 
RULE_B
;

183 
ù
[0] = (
w1
>>8)&255; ct[1] = w1&255;

184 
ù
[2] = (
w2
>>8)&255; ct[3] = w2&255;

185 
ù
[4] = (
w3
>>8)&255; ct[5] = w3&255;

186 
ù
[6] = (
w4
>>8)&255; ct[7] = w4&255;

188  
CRYPT_OK
;

189 
	}
}

191 #ifdeà
LTC_CLEAN_STACK


192 
	$skjack_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

194 
”r
 = 
	`_skjack_ecb_’üy±
(
±
, 
ù
, 
skey
);

195 
	`buº_¡ack
(() * 8 + () * 2);

196  
”r
;

197 
	}
}

207 #ifdeà
LTC_CLEAN_STACK


208 
	$_skjack_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

210 
	$skjack_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

213 
w1
,
w2
,
w3
,
w4
,
tmp
;

214 
x
, 
kp
;

216 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

217 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

218 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

221 
w1
 = (()
ù
[0]<<8)|ct[1];

222 
w2
 = (()
ù
[2]<<8)|ct[3];

223 
w3
 = (()
ù
[4]<<8)|ct[5];

224 
w4
 = (()
ù
[6]<<8)|ct[7];

230 
x
 = 32, 
kp
 = 8; x > 24; x--) {

231 
RULE_B1
;

235 ; 
x
 > 16; x--) {

236 
RULE_A1
;

241 ; 
x
 > 8; x--) {

242 
RULE_B1
;

246 ; 
x
 > 0; x--) {

247 
RULE_A1
;

251 
±
[0] = (
w1
>>8)&255;…t[1] = w1&255;

252 
±
[2] = (
w2
>>8)&255;…t[3] = w2&255;

253 
±
[4] = (
w3
>>8)&255;…t[5] = w3&255;

254 
±
[6] = (
w4
>>8)&255;…t[7] = w4&255;

256  
CRYPT_OK
;

257 
	}
}

259 #ifdeà
LTC_CLEAN_STACK


260 
	$skjack_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

262 
”r
 = 
	`_skjack_ecb_deüy±
(
ù
, 
±
, 
skey
);

263 
	`buº_¡ack
(() * 7 + () * 2);

264  
”r
;

265 
	}
}

272 
	$skjack_‹¡
()

274 #iâdeà
LTC_TEST


275  
CRYPT_NOP
;

278 
key
[10], 
±
[8], 
ù
[8];

279 } 
‹¡s
[] = {

286 
buf
[2][8];

287 
x
, 
y
, 
”r
;

288 
symm‘ric_key
 
key
;

290 
x
 = 0; x < ()((
‹¡s
) / (tests[0])); x++) {

292 ià((
”r
 = 
	`skjack_£tup
(
‹¡s
[
x
].
key
, 10, 0, &key)è!ğ
CRYPT_OK
) {

293  
”r
;

297 
	`skjack_ecb_’üy±
(
‹¡s
[
x
].
±
, 
buf
[0], &
key
);

298 
	`skjack_ecb_deüy±
(
buf
[0], buf[1], &
key
);

301 ià(
	`XMEMCMP
(
buf
[0], 
‹¡s
[
x
].
ù
, 8è!ğ0 || XMEMCMP(buf[1],e¡s[x].
±
, 8) != 0) {

302  
CRYPT_FAIL_TESTVECTOR
;

306 
y
 = 0; y < 8; y++è
buf
[0][y] = 0;

307 
y
 = 0; y < 1000; y++è
	`skjack_ecb_’üy±
(
buf
[0], buf[0], &
key
);

308 
y
 = 0; y < 1000; y++è
	`skjack_ecb_deüy±
(
buf
[0], buf[0], &
key
);

309 
y
 = 0; y < 8; y++èià(
buf
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

312  
CRYPT_OK
;

314 
	}
}

319 
	$skjack_dÚe
(
symm‘ric_key
 *
skey
)

321 
	}
}

328 
	$skjack_keysize
(*
keysize
)

330 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

331 ià(*
keysize
 < 10) {

332  
CRYPT_INVALID_KEYSIZE
;

333 } ià(*
keysize
 > 10) {

334 *
keysize
 = 10;

336  
CRYPT_OK
;

337 
	}
}

	@libtomcrypt/src/ciphers/twofish/twofish.c

16 
	~"tomüy±.h
"

18 #ifdeà
TWOFISH


21 #ifdeà
TWOFISH_ALL_TABLES


22 #iâdeà
TWOFISH_TABLES


23 
	#TWOFISH_TABLES


	)

27 cÚ¡ 
Éc_ch”_desütÜ
 
	gtwofish_desc
 =

32 &
twofish_£tup
,

33 &
twofish_ecb_’üy±
,

34 &
twofish_ecb_deüy±
,

35 &
twofish_‹¡
,

36 &
twofish_dÚe
,

37 &
twofish_keysize
,

38 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

42 
	#MDS_POLY
 0x169

	)

43 
	#RS_POLY
 0x14D

	)

47 cÚ¡ 
	gMDS
[4][4] = {

56 cÚ¡ 
	gRS
[4][8] = {

64 cÚ¡ 
	gqÜd
[4][5] = {

71 #ifdeà
TWOFISH_TABLES


73 
	~"twofish_b.c
"

75 
	#sbox
(
i
, 
x
è((
ulÚg32
)
SBOX
[i][(x)&255])

	)

80 cÚ¡ 
	gqbox
[2][4][16] = {

96 #ifdeà
LTC_CLEAN_STACK


97 
ulÚg32
 
	$_sbox
(
i
, 
ulÚg32
 
x
)

99 
ulÚg32
 
	$sbox
(
i
, 
ulÚg32
 
x
)

102 
a0
,
b0
,
a1
,
b1
,
a2
,
b2
,
a3
,
b3
,
a4
,
b4
,
y
;

105 
a0
 = ()((
x
>>4)&15);

106 
b0
 = ()((
x
)&15);

109 
a1
 = 
a0
 ^ 
b0
;

112 
b1
 = (
a0
 ^ ((
b0
<<3)|(b0>>1)) ^ (a0<<3)) & 15;

115 
a2
 = 
qbox
[
i
][0][()
a1
];

116 
b2
 = 
qbox
[
i
][1][()
b1
];

119 
a3
 = 
a2
 ^ 
b2
;

122 
b3
 = (
a2
 ^ ((
b2
<<3)|(b2>>1)) ^ (a2<<3)) & 15;

125 
a4
 = 
qbox
[
i
][2][()
a3
];

126 
b4
 = 
qbox
[
i
][3][()
b3
];

129 
y
 = (
b4
 << 4è+ 
a4
;

132  (
ulÚg32
)
y
;

133 
	}
}

135 #ifdeà
LTC_CLEAN_STACK


136 
ulÚg32
 
	$sbox
(
i
, 
ulÚg32
 
x
)

138 
ulÚg32
 
y
;

139 
y
 = 
	`_sbox
(
i
, 
x
);

140 
	`buº_¡ack
(() * 11);

141  
y
;

142 
	}
}

148 
ulÚg32
 
	$gf_muÉ
(
ulÚg32
 
a
, ulÚg32 
b
, ulÚg32 
p
)

150 
ulÚg32
 
»suÉ
, 
B
[2], 
P
[2];

152 
P
[1] = 
p
;

153 
B
[1] = 
b
;

154 
»suÉ
 = 
P
[0] = 
B
[0] = 0;

157 
»suÉ
 ^ğ
B
[
a
&1];‡ >>ğ1; B[1] = 
P
[B[1]>>7] ^ (B[1] << 1);

158 
»suÉ
 ^ğ
B
[
a
&1];‡ >>ğ1; B[1] = 
P
[B[1]>>7] ^ (B[1] << 1);

159 
»suÉ
 ^ğ
B
[
a
&1];‡ >>ğ1; B[1] = 
P
[B[1]>>7] ^ (B[1] << 1);

160 
»suÉ
 ^ğ
B
[
a
&1];‡ >>ğ1; B[1] = 
P
[B[1]>>7] ^ (B[1] << 1);

161 
»suÉ
 ^ğ
B
[
a
&1];‡ >>ğ1; B[1] = 
P
[B[1]>>7] ^ (B[1] << 1);

162 
»suÉ
 ^ğ
B
[
a
&1];‡ >>ğ1; B[1] = 
P
[B[1]>>7] ^ (B[1] << 1);

163 
»suÉ
 ^ğ
B
[
a
&1];‡ >>ğ1; B[1] = 
P
[B[1]>>7] ^ (B[1] << 1);

164 
»suÉ
 ^ğ
B
[
a
&1];

166  
»suÉ
;

167 
	}
}

170 #iâdeà
TWOFISH_TABLES


171 
ulÚg32
 
	$mds_cŞumn_muÉ
(
š
, 
cŞ
)

173 
ulÚg32
 
x01
, 
x5B
, 
xEF
;

175 
x01
 = 
š
;

176 
x5B
 = 
	`gf_muÉ
(
š
, 0x5B, 
MDS_POLY
);

177 
xEF
 = 
	`gf_muÉ
(
š
, 0xEF, 
MDS_POLY
);

179 
cŞ
) {

181  (
x01
 << 0 ) |

182 (
x5B
 << 8 ) |

183 (
xEF
 << 16) |

184 (
xEF
 << 24);

186  (
xEF
 << 0 ) |

187 (
xEF
 << 8 ) |

188 (
x5B
 << 16) |

189 (
x01
 << 24);

191  (
x5B
 << 0 ) |

192 (
xEF
 << 8 ) |

193 (
x01
 << 16) |

194 (
xEF
 << 24);

196  (
x5B
 << 0 ) |

197 (
x01
 << 8 ) |

198 (
xEF
 << 16) |

199 (
x5B
 << 24);

203 
	}
}

207 
	#mds_cŞumn_muÉ
(
x
, 
i
è
mds_b
[i][x]

	)

212 
	$mds_muÉ
(cÚ¡ *
š
, *
out
)

214 
x
;

215 
ulÚg32
 
tmp
;

216 
tmp
 = 
x
 = 0; x < 4; x++) {

217 
tmp
 ^ğ
	`mds_cŞumn_muÉ
(
š
[
x
], x);

219 
	`STORE32L
(
tmp
, 
out
);

220 
	}
}

222 #ifdeà
TWOFISH_ALL_TABLES


224 
	$rs_muÉ
(cÚ¡ *
š
, *
out
)

226 
ulÚg32
 
tmp
;

227 
tmp
 = 
rs_b0
[
š
[0]] ^ 
rs_b1
[š[1]] ^ 
rs_b2
[š[2]] ^ 
rs_b3
[in[3]] ^

228 
rs_b4
[
š
[4]] ^ 
rs_b5
[š[5]] ^ 
rs_b6
[š[6]] ^ 
rs_b7
[in[7]];

229 
	`STORE32L
(
tmp
, 
out
);

230 
	}
}

235 
	$rs_muÉ
(cÚ¡ *
š
, *
out
)

237 
x
, 
y
;

238 
x
 = 0; x < 4; x++) {

239 
out
[
x
] = 0;

240 
y
 = 0; y < 8; y++) {

241 
out
[
x
] ^ğ
	`gf_muÉ
(
š
[
y
], 
RS
[x][y], 
RS_POLY
);

244 
	}
}

249 
	$h_func
(cÚ¡ *
š
, *
out
, *
M
, 
k
, 
off£t
)

251 
x
;

252 
y
[4];

253 
x
 = 0; x < 4; x++) {

254 
y
[
x
] = 
š
[x];

256 
k
) {

258 
y
[0] = ()(
	`sbox
(1, (
ulÚg32
)y[0]è^ 
M
[4 * (6 + 
off£t
) + 0]);

259 
y
[1] = ()(
	`sbox
(0, (
ulÚg32
)y[1]è^ 
M
[4 * (6 + 
off£t
) + 1]);

260 
y
[2] = ()(
	`sbox
(0, (
ulÚg32
)y[2]è^ 
M
[4 * (6 + 
off£t
) + 2]);

261 
y
[3] = ()(
	`sbox
(1, (
ulÚg32
)y[3]è^ 
M
[4 * (6 + 
off£t
) + 3]);

263 
y
[0] = ()(
	`sbox
(1, (
ulÚg32
)y[0]è^ 
M
[4 * (4 + 
off£t
) + 0]);

264 
y
[1] = ()(
	`sbox
(1, (
ulÚg32
)y[1]è^ 
M
[4 * (4 + 
off£t
) + 1]);

265 
y
[2] = ()(
	`sbox
(0, (
ulÚg32
)y[2]è^ 
M
[4 * (4 + 
off£t
) + 2]);

266 
y
[3] = ()(
	`sbox
(0, (
ulÚg32
)y[3]è^ 
M
[4 * (4 + 
off£t
) + 3]);

268 
y
[0] = ()(
	`sbox
(1, sbox(0, sbox(0, (
ulÚg32
)y[0]è^ 
M
[4 * (2 + 
off£t
) + 0]) ^ M[4 * (0 + offset) + 0]));

269 
y
[1] = ()(
	`sbox
(0, sbox(0, sbox(1, (
ulÚg32
)y[1]è^ 
M
[4 * (2 + 
off£t
) + 1]) ^ M[4 * (0 + offset) + 1]));

270 
y
[2] = ()(
	`sbox
(1, sbox(1, sbox(0, (
ulÚg32
)y[2]è^ 
M
[4 * (2 + 
off£t
) + 2]) ^ M[4 * (0 + offset) + 2]));

271 
y
[3] = ()(
	`sbox
(0, sbox(1, sbox(1, (
ulÚg32
)y[3]è^ 
M
[4 * (2 + 
off£t
) + 3]) ^ M[4 * (0 + offset) + 3]));

273 
	`mds_muÉ
(
y
, 
out
);

274 
	}
}

276 #iâdeà
TWOFISH_SMALL


279 #ià
defšed
(
__GNUC__
)

280 
	#S1
 
skey
->
twofish
.
S
[0]

	)

281 
	#S2
 
skey
->
twofish
.
S
[1]

	)

282 
	#S3
 
skey
->
twofish
.
S
[2]

	)

283 
	#S4
 
skey
->
twofish
.
S
[3]

	)

287 
	#g_func
(
x
, 
dum
è(
S1
[
	`by‹
(x,0)] ^ 
S2
[by‹(x,1)] ^ 
S3
[by‹(x,2)] ^ 
S4
[by‹(x,3)])

	)

288 
	#g1_func
(
x
, 
dum
è(
S2
[
	`by‹
(x,0)] ^ 
S3
[by‹(x,1)] ^ 
S4
[by‹(x,2)] ^ 
S1
[by‹(x,3)])

	)

292 #ifdeà
LTC_CLEAN_STACK


293 
ulÚg32
 
	$_g_func
(
ulÚg32
 
x
, 
symm‘ric_key
 *
key
)

295 
ulÚg32
 
	$g_func
(
ulÚg32
 
x
, 
symm‘ric_key
 *
key
)

298 
g
, 
i
, 
y
, 
z
;

299 
ulÚg32
 
»s
;

301 
»s
 = 0;

302 
y
 = 0; y < 4; y++) {

303 
z
 = 
key
->
twofish
.
¡¬t
;

306 
g
 = 
	`sbox
(
qÜd
[
y
][
z
++], (
x
 >> (8*y)) & 255);

309 
i
 = 0;

312 
z
 != 5) {

313 
g
 = g ^ 
key
->
twofish
.
S
[4*
i
++ + 
y
];

314 
g
 = 
	`sbox
(
qÜd
[
y
][
z
++], g);

318 
»s
 ^ğ
	`mds_cŞumn_muÉ
(
g
, 
y
);

320  
»s
;

321 
	}
}

323 
	#g1_func
(
x
, 
key
è
	`g_func
(
	`ROLc
(x, 8), key)

	)

325 #ifdeà
LTC_CLEAN_STACK


326 
ulÚg32
 
	$g_func
(
ulÚg32
 
x
, 
symm‘ric_key
 *
key
)

328 
ulÚg32
 
y
;

329 
y
 = 
	`_g_func
(
x
, 
key
);

330 
	`buº_¡ack
((è* 4 + (
ulÚg32
));

331  
y
;

332 
	}
}

345 #ifdeà
LTC_CLEAN_STACK


346 
	$_twofish_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

348 
	$twofish_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

351 #iâdeà
TWOFISH_SMALL


352 
S
[4*4], 
tmpx0
, 
tmpx1
;

354 
k
, 
x
, 
y
;

355 
tmp
[4], 
tmp2
[4], 
M
[8*4];

356 
ulÚg32
 
A
, 
B
;

358 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

359 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

362 ià(
num_rounds
 != 16 &&‚um_rounds != 0) {

363  
CRYPT_INVALID_ROUNDS
;

366 ià(
keyËn
 != 16 && keylen != 24 && keylen != 32) {

367  
CRYPT_INVALID_KEYSIZE
;

371 
k
 = 
keyËn
 / 8;

374 
x
 = 0; x < 
keyËn
; x++) {

375 
M
[
x
] = 
key
[x] & 255;

379 #iâdeà
TWOFISH_SMALL


380 
x
 = 0; x < 
k
; x++) {

381 
	`rs_muÉ
(
M
+(
x
*8), 
S
+(x*4));

384 
x
 = 0; x < 
k
; x++) {

385 
	`rs_muÉ
(
M
+(
x
*8), 
skey
->
twofish
.
S
+(x*4));

390 
x
 = 0; x < 20; x++) {

392 
y
 = 0; y < 4; y++) {

393 
tmp
[
y
] = 
x
+x;

395 
	`h_func
(
tmp
, 
tmp2
, 
M
, 
k
, 0);

396 
	`LOAD32L
(
A
, 
tmp2
);

399 
y
 = 0; y < 4; y++) {

400 
tmp
[
y
] = ()(
x
+x+1);

402 
	`h_func
(
tmp
, 
tmp2
, 
M
, 
k
, 1);

403 
	`LOAD32L
(
B
, 
tmp2
);

404 
B
 = 
	`ROLc
(B, 8);

407 
skey
->
twofish
.
K
[
x
+x] = (
A
 + 
B
) & 0xFFFFFFFFUL;

410 
skey
->
twofish
.
K
[
x
+x+1] = 
	`ROLc
(
B
 + B + 
A
, 9);

413 #iâdeà
TWOFISH_SMALL


415 ià(
k
 == 2) {

416 
x
 = 0; x < 256; x++) {

417 
tmpx0
 = ()
	`sbox
(0, 
x
);

418 
tmpx1
 = ()
	`sbox
(1, 
x
);

419 
skey
->
twofish
.
S
[0][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(1, (sbox(0, 
tmpx0
 ^ S[0]) ^ S[4])),0);

420 
skey
->
twofish
.
S
[1][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(0, (sbox(0, 
tmpx1
 ^ S[1]) ^ S[5])),1);

421 
skey
->
twofish
.
S
[2][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(1, (sbox(1, 
tmpx0
 ^ S[2]) ^ S[6])),2);

422 
skey
->
twofish
.
S
[3][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(0, (sbox(1, 
tmpx1
 ^ S[3]) ^ S[7])),3);

424 } ià(
k
 == 3) {

425 
x
 = 0; x < 256; x++) {

426 
tmpx0
 = ()
	`sbox
(0, 
x
);

427 
tmpx1
 = ()
	`sbox
(1, 
x
);

428 
skey
->
twofish
.
S
[0][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(1, (sbox(0, sbox(0, 
tmpx1
 ^ S[0]) ^ S[4]) ^ S[8])),0);

429 
skey
->
twofish
.
S
[1][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(0, (sbox(0, sbox(1, 
tmpx1
 ^ S[1]) ^ S[5]) ^ S[9])),1);

430 
skey
->
twofish
.
S
[2][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(1, (sbox(1, sbox(0, 
tmpx0
 ^ S[2]) ^ S[6]) ^ S[10])),2);

431 
skey
->
twofish
.
S
[3][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(0, (sbox(1, sbox(1, 
tmpx0
 ^ S[3]) ^ S[7]) ^ S[11])),3);

434 
x
 = 0; x < 256; x++) {

435 
tmpx0
 = ()
	`sbox
(0, 
x
);

436 
tmpx1
 = ()
	`sbox
(1, 
x
);

437 
skey
->
twofish
.
S
[0][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(1, (sbox(0, sbox(0, sbox(1, 
tmpx1
 ^ S[0]) ^ S[4]) ^ S[8]) ^ S[12])),0);

438 
skey
->
twofish
.
S
[1][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(0, (sbox(0, sbox(1, sbox(1, 
tmpx0
 ^ S[1]) ^ S[5]) ^ S[9]) ^ S[13])),1);

439 
skey
->
twofish
.
S
[2][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(1, (sbox(1, sbox(0, sbox(0, 
tmpx0
 ^ S[2]) ^ S[6]) ^ S[10]) ^ S[14])),2);

440 
skey
->
twofish
.
S
[3][
x
] = 
	`mds_cŞumn_muÉ
(
	`sbox
(0, (sbox(1, sbox(1, sbox(0, 
tmpx1
 ^ S[3]) ^ S[7]) ^ S[11]) ^ S[15])),3);

446 
k
) {

447 4 : 
skey
->
twofish
.
¡¬t
 = 0; ;

448 3 : 
skey
->
twofish
.
¡¬t
 = 1; ;

449 : 
skey
->
twofish
.
¡¬t
 = 2; ;

452  
CRYPT_OK
;

453 
	}
}

455 #ifdeà
LTC_CLEAN_STACK


456 
	$twofish_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

458 
x
;

459 
x
 = 
	`_twofish_£tup
(
key
, 
keyËn
, 
num_rounds
, 
skey
);

460 
	`buº_¡ack
((è* 7 + (è* 56 + (
ulÚg32
) * 2);

461  
x
;

462 
	}
}

472 #ifdeà
LTC_CLEAN_STACK


473 
	$_twofish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

475 
	$twofish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

478 
ulÚg32
 
a
,
b
,
c
,
d
,

,
tb
,
tc
,
td
,
t1
,
t2
, *
k
;

479 
r
;

480 #ià!
	`defšed
(
TWOFISH_SMALL
è&& !defšed(
__GNUC__
)

481 
ulÚg32
 *
S1
, *
S2
, *
S3
, *
S4
;

484 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

485 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

486 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

488 #ià!
	`defšed
(
TWOFISH_SMALL
è&& !defšed(
__GNUC__
)

489 
S1
 = 
skey
->
twofish
.
S
[0];

490 
S2
 = 
skey
->
twofish
.
S
[1];

491 
S3
 = 
skey
->
twofish
.
S
[2];

492 
S4
 = 
skey
->
twofish
.
S
[3];

495 
	`LOAD32L
(
a
,&
±
[0]); LOAD32L(
b
,&pt[4]);

496 
	`LOAD32L
(
c
,&
±
[8]); LOAD32L(
d
,&pt[12]);

497 
a
 ^ğ
skey
->
twofish
.
K
[0];

498 
b
 ^ğ
skey
->
twofish
.
K
[1];

499 
c
 ^ğ
skey
->
twofish
.
K
[2];

500 
d
 ^ğ
skey
->
twofish
.
K
[3];

502 
k
 = 
skey
->
twofish
.
K
 + 8;

503 
r
 = 8;„ != 0; --r) {

504 
t2
 = 
	`g1_func
(
b
, 
skey
);

505 
t1
 = 
	`g_func
(
a
, 
skey
è+ 
t2
;

506 
c
 = 
	`RORc
(ø^ (
t1
 + 
k
[0]), 1);

507 
d
 = 
	`ROLc
(d, 1è^ (
t2
 + 
t1
 + 
k
[1]);

509 
t2
 = 
	`g1_func
(
d
, 
skey
);

510 
t1
 = 
	`g_func
(
c
, 
skey
è+ 
t2
;

511 
a
 = 
	`RORc
× ^ (
t1
 + 
k
[2]), 1);

512 
b
 = 
	`ROLc
(b, 1è^ (
t2
 + 
t1
 + 
k
[3]);

513 
k
 += 4;

517 

 = 
c
 ^ 
skey
->
twofish
.
K
[4];

518 
tb
 = 
d
 ^ 
skey
->
twofish
.
K
[5];

519 
tc
 = 
a
 ^ 
skey
->
twofish
.
K
[6];

520 
td
 = 
b
 ^ 
skey
->
twofish
.
K
[7];

523 
	`STORE32L
(

,&
ù
[0]); STORE32L(
tb
,&ct[4]);

524 
	`STORE32L
(
tc
,&
ù
[8]); STORE32L(
td
,&ct[12]);

526  
CRYPT_OK
;

527 
	}
}

529 #ifdeà
LTC_CLEAN_STACK


530 
	$twofish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

532 
”r
 = 
	`_twofish_ecb_’üy±
(
±
, 
ù
, 
skey
);

533 
	`buº_¡ack
((
ulÚg32
) * 10 + ());

534  
”r
;

535 
	}
}

545 #ifdeà
LTC_CLEAN_STACK


546 
	$_twofish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

548 
	$twofish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

551 
ulÚg32
 
a
,
b
,
c
,
d
,

,
tb
,
tc
,
td
,
t1
,
t2
, *
k
;

552 
r
;

553 #ià!
	`defšed
(
TWOFISH_SMALL
è&& !defšed(
__GNUC__
)

554 
ulÚg32
 *
S1
, *
S2
, *
S3
, *
S4
;

557 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

558 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

559 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

561 #ià!
	`defšed
(
TWOFISH_SMALL
è&& !defšed(
__GNUC__
)

562 
S1
 = 
skey
->
twofish
.
S
[0];

563 
S2
 = 
skey
->
twofish
.
S
[1];

564 
S3
 = 
skey
->
twofish
.
S
[2];

565 
S4
 = 
skey
->
twofish
.
S
[3];

569 
	`LOAD32L
(

,&
ù
[0]); LOAD32L(
tb
,&ct[4]);

570 
	`LOAD32L
(
tc
,&
ù
[8]); LOAD32L(
td
,&ct[12]);

573 
a
 = 
tc
 ^ 
skey
->
twofish
.
K
[6];

574 
b
 = 
td
 ^ 
skey
->
twofish
.
K
[7];

575 
c
 = 

 ^ 
skey
->
twofish
.
K
[4];

576 
d
 = 
tb
 ^ 
skey
->
twofish
.
K
[5];

578 
k
 = 
skey
->
twofish
.
K
 + 36;

579 
r
 = 8;„ != 0; --r) {

580 
t2
 = 
	`g1_func
(
d
, 
skey
);

581 
t1
 = 
	`g_func
(
c
, 
skey
è+ 
t2
;

582 
a
 = 
	`ROLc
×, 1è^ (
t1
 + 
k
[2]);

583 
b
 = 
	`RORc
(b ^ (
t2
 + 
t1
 + 
k
[3]), 1);

585 
t2
 = 
	`g1_func
(
b
, 
skey
);

586 
t1
 = 
	`g_func
(
a
, 
skey
è+ 
t2
;

587 
c
 = 
	`ROLc
(c, 1è^ (
t1
 + 
k
[0]);

588 
d
 = 
	`RORc
(d ^ (
t2
 + 
t1
 + 
k
[1]), 1);

589 
k
 -= 4;

593 
a
 ^ğ
skey
->
twofish
.
K
[0];

594 
b
 ^ğ
skey
->
twofish
.
K
[1];

595 
c
 ^ğ
skey
->
twofish
.
K
[2];

596 
d
 ^ğ
skey
->
twofish
.
K
[3];

599 
	`STORE32L
(
a
, &
±
[0]); STORE32L(
b
, &pt[4]);

600 
	`STORE32L
(
c
, &
±
[8]); STORE32L(
d
, &pt[12]);

601  
CRYPT_OK
;

602 
	}
}

604 #ifdeà
LTC_CLEAN_STACK


605 
	$twofish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

607 
”r
 =
	`_twofish_ecb_deüy±
(
ù
, 
±
, 
skey
);

608 
	`buº_¡ack
((
ulÚg32
) * 10 + ());

609  
”r
;

610 
	}
}

617 
	$twofish_‹¡
()

619 #iâdeà
LTC_TEST


620  
CRYPT_NOP
;

623 
keyËn
;

624 
key
[32], 
±
[16], 
ù
[16];

625 } 
‹¡s
[] = {

656 
symm‘ric_key
 
key
;

657 
tmp
[2][16];

658 
”r
, 
i
, 
y
;

660 
i
 = 0; i < ()((
‹¡s
)/(tests[0])); i++) {

661 ià((
”r
 = 
	`twofish_£tup
(
‹¡s
[
i
].
key
,e¡s[i].
keyËn
, 0, &key)è!ğ
CRYPT_OK
) {

662  
”r
;

664 
	`twofish_ecb_’üy±
(
‹¡s
[
i
].
±
, 
tmp
[0], &
key
);

665 
	`twofish_ecb_deüy±
(
tmp
[0],mp[1], &
key
);

666 ià(
	`XMEMCMP
(
tmp
[0], 
‹¡s
[
i
].
ù
, 16è!ğ0 || XMEMCMPÑmp[1],e¡s[i].
±
, 16) != 0) {

668 
	`´štf
("Twofish faede¡ %d, %d, %d\n", 
i
, 
	`XMEMCMP
(
tmp
[0], 
‹¡s
[i].
ù
, 16), XMEMCMPÑmp[1],e¡s[i].
±
, 16));

670  
CRYPT_FAIL_TESTVECTOR
;

673 
y
 = 0; y < 16; y++è
tmp
[0][y] = 0;

674 
y
 = 0; y < 1000; y++è
	`twofish_ecb_’üy±
(
tmp
[0],mp[0], &
key
);

675 
y
 = 0; y < 1000; y++è
	`twofish_ecb_deüy±
(
tmp
[0],mp[0], &
key
);

676 
y
 = 0; y < 16; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

678  
CRYPT_OK
;

680 
	}
}

685 
	$twofish_dÚe
(
symm‘ric_key
 *
skey
)

687 
	}
}

694 
	$twofish_keysize
(*
keysize
)

696 
	`LTC_ARGCHK
(
keysize
);

697 ià(*
keysize
 < 16)

698  
CRYPT_INVALID_KEYSIZE
;

699 ià(*
keysize
 < 24) {

700 *
keysize
 = 16;

701  
CRYPT_OK
;

702 } ià(*
keysize
 < 32) {

703 *
keysize
 = 24;

704  
CRYPT_OK
;

706 *
keysize
 = 32;

707  
CRYPT_OK
;

709 
	}
}

	@libtomcrypt/src/ciphers/twofish/twofish_tab.c

16 #ifdeà
TWOFISH_TABLES


19 cÚ¡ 
	gSBOX
[2][256] = {

77 cÚ¡ 
ulÚg32
 
	gmds_b
[4][256] = {

215 #ifdeà
TWOFISH_ALL_TABLES


218 cÚ¡ 
ulÚg32
 
	grs_b0
[256] = {

252 cÚ¡ 
ulÚg32
 
	grs_b1
[256] = {

286 cÚ¡ 
ulÚg32
 
	grs_b2
[256] = {

320 cÚ¡ 
ulÚg32
 
	grs_b3
[256] = {

354 cÚ¡ 
ulÚg32
 
	grs_b4
[256] = {

388 cÚ¡ 
ulÚg32
 
	grs_b5
[256] = {

422 cÚ¡ 
ulÚg32
 
	grs_b6
[256] = {

456 cÚ¡ 
ulÚg32
 
	grs_b7
[256] = {

	@libtomcrypt/src/ciphers/xtea.c

16 
	~"tomüy±.h
"

18 #ifdeà
XTEA


20 cÚ¡ 
Éc_ch”_desütÜ
 
	gx‹a_desc
 =

25 &
x‹a_£tup
,

26 &
x‹a_ecb_’üy±
,

27 &
x‹a_ecb_deüy±
,

28 &
x‹a_‹¡
,

29 &
x‹a_dÚe
,

30 &
x‹a_keysize
,

31 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL

34 
	$x‹a_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
)

36 
x
, 
sum
, 
K
[4];

38 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

42 ià(
keyËn
 != 16) {

43  
CRYPT_INVALID_KEYSIZE
;

46 ià(
num_rounds
 != 0 &&‚um_rounds != 32) {

47  
CRYPT_INVALID_ROUNDS
;

51 
	`LOAD32L
(
K
[0], 
key
+0);

52 
	`LOAD32L
(
K
[1], 
key
+4);

53 
	`LOAD32L
(
K
[2], 
key
+8);

54 
	`LOAD32L
(
K
[3], 
key
+12);

56 
x
 = 
sum
 = 0; x < 32; x++) {

57 
skey
->
x‹a
.
A
[
x
] = (
sum
 + 
K
[sum&3]) & 0xFFFFFFFFUL;

58 
sum
 = (sum + 0x9E3779B9UL) & 0xFFFFFFFFUL;

59 
skey
->
x‹a
.
B
[
x
] = (
sum
 + 
K
[(sum>>11)&3]) & 0xFFFFFFFFUL;

62 #ifdeà
LTC_CLEAN_STACK


63 
	`z”omem
(&
K
, (K));

66  
CRYPT_OK
;

67 
	}
}

76 
	$x‹a_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
)

78 
y
, 
z
;

79 
r
;

81 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

82 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

83 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

85 
	`LOAD32L
(
y
, &
±
[0]);

86 
	`LOAD32L
(
z
, &
±
[4]);

87 
r
 = 0;„ < 32;„ += 4) {

88 
y
 = (y + ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
])) & 0xFFFFFFFFUL;

89 
z
 = (z + ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
])) & 0xFFFFFFFFUL;

91 
y
 = (y + ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
+1])) & 0xFFFFFFFFUL;

92 
z
 = (z + ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
+1])) & 0xFFFFFFFFUL;

94 
y
 = (y + ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
+2])) & 0xFFFFFFFFUL;

95 
z
 = (z + ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
+2])) & 0xFFFFFFFFUL;

97 
y
 = (y + ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
+3])) & 0xFFFFFFFFUL;

98 
z
 = (z + ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
+3])) & 0xFFFFFFFFUL;

100 
	`STORE32L
(
y
, &
ù
[0]);

101 
	`STORE32L
(
z
, &
ù
[4]);

102  
CRYPT_OK
;

103 
	}
}

112 
	$x‹a_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
)

114 
y
, 
z
;

115 
r
;

117 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

118 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

119 
	`LTC_ARGCHK
(
skey
 !ğ
NULL
);

121 
	`LOAD32L
(
y
, &
ù
[0]);

122 
	`LOAD32L
(
z
, &
ù
[4]);

123 
r
 = 31;„ >= 0;„ -= 4) {

124 
z
 = (z - ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
])) & 0xFFFFFFFFUL;

125 
y
 = (y - ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
])) & 0xFFFFFFFFUL;

127 
z
 = (z - ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
-1])) & 0xFFFFFFFFUL;

128 
y
 = (y - ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
-1])) & 0xFFFFFFFFUL;

130 
z
 = (z - ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
-2])) & 0xFFFFFFFFUL;

131 
y
 = (y - ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
-2])) & 0xFFFFFFFFUL;

133 
z
 = (z - ((((
y
<<4)^(y>>5)è+ yè^ 
skey
->
x‹a
.
B
[
r
-3])) & 0xFFFFFFFFUL;

134 
y
 = (y - ((((
z
<<4)^(z>>5)è+ zè^ 
skey
->
x‹a
.
A
[
r
-3])) & 0xFFFFFFFFUL;

136 
	`STORE32L
(
y
, &
±
[0]);

137 
	`STORE32L
(
z
, &
±
[4]);

138  
CRYPT_OK
;

139 
	}
}

145 
	$x‹a_‹¡
()

147 #iâdeà
LTC_TEST


148  
CRYPT_NOP
;

150 cÚ¡ 
key
[16] =

153 cÚ¡ 
±
[8] =

155 cÚ¡ 
ù
[8] =

157 
tmp
[2][8];

158 
symm‘ric_key
 
skey
;

159 
”r
, 
y
;

161 ià((
”r
 = 
	`x‹a_£tup
(
key
, 16, 0, &
skey
)è!ğ
CRYPT_OK
) {

162  
”r
;

164 
	`x‹a_ecb_’üy±
(
±
, 
tmp
[0], &
skey
);

165 
	`x‹a_ecb_deüy±
(
tmp
[0],mp[1], &
skey
);

167 ià(
	`XMEMCMP
(
tmp
[0], 
ù
, 8è!ğ0 || XMEMCMPÑmp[1], 
±
, 8) != 0) {

168  
CRYPT_FAIL_TESTVECTOR
;

172 
y
 = 0; y < 8; y++è
tmp
[0][y] = 0;

173 
y
 = 0; y < 1000; y++è
	`x‹a_ecb_’üy±
(
tmp
[0],mp[0], &
skey
);

174 
y
 = 0; y < 1000; y++è
	`x‹a_ecb_deüy±
(
tmp
[0],mp[0], &
skey
);

175 
y
 = 0; y < 8; y++èià(
tmp
[0][y] !ğ0è 
CRYPT_FAIL_TESTVECTOR
;

177  
CRYPT_OK
;

179 
	}
}

184 
	$x‹a_dÚe
(
symm‘ric_key
 *
skey
)

186 
	}
}

193 
	$x‹a_keysize
(*
keysize
)

195 
	`LTC_ARGCHK
(
keysize
 !ğ
NULL
);

196 ià(*
keysize
 < 16) {

197  
CRYPT_INVALID_KEYSIZE
;

199 *
keysize
 = 16;

200  
CRYPT_OK
;

201 
	}
}

	@libtomcrypt/src/encauth/ccm/ccm_memory.c

11 
	~"tomüy±.h
"

18 #ifdeà
CCM_MODE


38 
	$ccm_memÜy
(
ch”
,

39 cÚ¡ *
key
, 
keyËn
,

40 
symm‘ric_key
 *
uskey
,

41 cÚ¡ *
nÚû
, 
nÚûËn
,

42 cÚ¡ *
h—d”
, 
h—d”Ën
,

43 *
±
, 
±Ën
,

44 *
ù
,

45 *
g
, *
gËn
,

46 
dœeùiÚ
)

48 
PAD
[16], 
ùr
[16], 
CTRPAD
[16], 
b
;

49 
symm‘ric_key
 *
skey
;

50 
”r
;

51 
Ën
, 
L
, 
x
, 
y
, 
z
, 
CTRËn
;

53 ià(
uskey
 =ğ
NULL
) {

54 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

56 
	`LTC_ARGCHK
(
nÚû
 !ğ
NULL
);

57 ià(
h—d”Ën
 > 0) {

58 
	`LTC_ARGCHK
(
h—d”
 !ğ
NULL
);

60 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

61 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

62 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

63 
	`LTC_ARGCHK
(
gËn
 !ğ
NULL
);

65 #ifdeà
LTC_FAST


66 ià(16 % (
LTC_FAST_TYPE
)) {

67  
CRYPT_INVALID_ARG
;

72 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

73  
”r
;

75 ià(
ch”_desütÜ
[
ch”
].
block_Ëngth
 != 16) {

76  
CRYPT_INVALID_CIPHER
;

80 *
gËn
 &= ~1;

81 ià(*
gËn
 > 16) {

82 *
gËn
 = 16;

86 ià(*
gËn
 < 4) {

87  
CRYPT_INVALID_ARG
;

91 ià(
ch”_desütÜ
[
ch”
].
acûl_ccm_memÜy
 !ğ
NULL
) {

92  
ch”_desütÜ
[
ch”
].
	`acûl_ccm_memÜy
(

93 
key
, 
keyËn
,

94 
uskey
,

95 
nÚû
, 
nÚûËn
,

96 
h—d”
, 
h—d”Ën
,

97 
±
, 
±Ën
,

98 
ù
,

99 
g
, 
gËn
,

100 
dœeùiÚ
);

104 
Ën
 = 
±Ën
;

105 
L
 = 0;

106 
Ën
) {

107 ++
L
;

108 
Ën
 >>= 8;

110 ià(
L
 <= 1) {

111 
L
 = 2;

115 
nÚûËn
 = (noncelen > 13) ? 13 :‚oncelen;

116 ià((15 - 
nÚûËn
è> 
L
) {

117 
L
 = 15 - 
nÚûËn
;

121 ià((
nÚûËn
 + 
L
) > 15) {

122 
nÚûËn
 = 15 - 
L
;

126 ià(
uskey
 =ğ
NULL
) {

127 
skey
 = 
	`XMALLOC
((*skey));

128 ià(
skey
 =ğ
NULL
) {

129  
CRYPT_MEM
;

133 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 0, 
skey
)è!ğ
CRYPT_OK
) {

134 
	`XFREE
(
skey
);

135  
”r
;

138 
skey
 = 
uskey
;

142 
x
 = 0;

143 
PAD
[
x
++] = ()(((
h—d”Ën
 > 0) ? (1<<6) : 0) |

144 (((*
gËn
 - 2)>>1)<<3) |

145 (
L
-1));

148 
y
 = 0; y < (16 - (
L
 + 1)); y++) {

149 
PAD
[
x
++] = 
nÚû
[
y
];

153 
Ën
 = 
±Ën
;

156 
y
 = 
L
; y < 4; y++) {

157 
Ën
 <<= 8;

161 
y
 = 0; 
L
 > 4 && (L-y)>4; y++) {

162 
PAD
[
x
++] = 0;

164 ; 
y
 < 
L
; y++) {

165 
PAD
[
x
++] = ()((
Ën
 >> 24) & 255);

166 
Ën
 <<= 8;

170 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
PAD
, PAD, 
skey
)è!ğ
CRYPT_OK
) {

171 
”rÜ
;

175 ià(
h—d”Ën
 > 0) {

176 
x
 = 0;

179 ià(
h—d”Ën
 < ((1UL<<16) - (1UL<<8))) {

180 
PAD
[
x
++] ^ğ(
h—d”Ën
>>8) & 255;

181 
PAD
[
x
++] ^ğ
h—d”Ën
 & 255;

183 
PAD
[
x
++] ^= 0xFF;

184 
PAD
[
x
++] ^= 0xFE;

185 
PAD
[
x
++] ^ğ(
h—d”Ën
>>24) & 255;

186 
PAD
[
x
++] ^ğ(
h—d”Ën
>>16) & 255;

187 
PAD
[
x
++] ^ğ(
h—d”Ën
>>8) & 255;

188 
PAD
[
x
++] ^ğ
h—d”Ën
 & 255;

192 
y
 = 0; y < 
h—d”Ën
; y++) {

193 ià(
x
 == 16) {

195 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
PAD
, PAD, 
skey
)è!ğ
CRYPT_OK
) {

196 
”rÜ
;

198 
x
 = 0;

200 
PAD
[
x
++] ^ğ
h—d”
[
y
];

204 ià(
x
 != 0) {

205 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
PAD
, PAD, 
skey
)è!ğ
CRYPT_OK
) {

206 
”rÜ
;

212 
x
 = 0;

215 
ùr
[
x
++] = ()
L
-1;

218 
y
 = 0; y < (16 - (
L
+1)); ++y) {

219 
ùr
[
x
++] = 
nÚû
[
y
];

222 
x
 < 16) {

223 
ùr
[
x
++] = 0;

226 
x
 = 0;

227 
CTRËn
 = 16;

230 ià(
±Ën
 > 0) {

231 
y
 = 0;

232 #ifdeà
LTC_FAST


233 ià(
±Ën
 & ~15) {

234 ià(
dœeùiÚ
 =ğ
CCM_ENCRYPT
) {

235 ; 
y
 < (
±Ën
 & ~15); y += 16) {

237 
z
 = 15; z > 15-
L
; z--) {

238 
ùr
[
z
] = (ctr[z] + 1) & 255;

239 ià(
ùr
[
z
]) ;

241 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
ùr
, 
CTRPAD
, 
skey
)è!ğ
CRYPT_OK
) {

242 
”rÜ
;

246 
z
 = 0; z < 16; z +ğ(
LTC_FAST_TYPE
)) {

247 *((
LTC_FAST_TYPE
*)(&
PAD
[
z
])è^ğ*((LTC_FAST_TYPE*)(&
±
[
y
+z]));

248 *((
LTC_FAST_TYPE
*)(&
ù
[
y
+
z
])èğ*((LTC_FAST_TYPE*)(&
±
[y+z])è^ *((LTC_FAST_TYPE*)(&
CTRPAD
[z]));

250 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
PAD
, PAD, 
skey
)è!ğ
CRYPT_OK
) {

251 
”rÜ
;

255 ; 
y
 < (
±Ën
 & ~15); y += 16) {

257 
z
 = 15; z > 15-
L
; z--) {

258 
ùr
[
z
] = (ctr[z] + 1) & 255;

259 ià(
ùr
[
z
]) ;

261 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
ùr
, 
CTRPAD
, 
skey
)è!ğ
CRYPT_OK
) {

262 
”rÜ
;

266 
z
 = 0; z < 16; z +ğ(
LTC_FAST_TYPE
)) {

267 *((
LTC_FAST_TYPE
*)(&
±
[
y
+
z
])èğ*((LTC_FAST_TYPE*)(&
ù
[y+z])è^ *((LTC_FAST_TYPE*)(&
CTRPAD
[z]));

268 *((
LTC_FAST_TYPE
*)(&
PAD
[
z
])è^ğ*((LTC_FAST_TYPE*)(&
±
[
y
+z]));

270 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
PAD
, PAD, 
skey
)è!ğ
CRYPT_OK
) {

271 
”rÜ
;

278 ; 
y
 < 
±Ën
; y++) {

280 ià(
CTRËn
 == 16) {

281 
z
 = 15; z > 15-
L
; z--) {

282 
ùr
[
z
] = (ctr[z] + 1) & 255;

283 ià(
ùr
[
z
]) ;

285 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
ùr
, 
CTRPAD
, 
skey
)è!ğ
CRYPT_OK
) {

286 
”rÜ
;

288 
CTRËn
 = 0;

292 ià(
dœeùiÚ
 =ğ
CCM_ENCRYPT
) {

293 
b
 = 
±
[
y
];

294 
ù
[
y
] = 
b
 ^ 
CTRPAD
[
CTRËn
++];

296 
b
 = 
ù
[
y
] ^ 
CTRPAD
[
CTRËn
++];

297 
±
[
y
] = 
b
;

300 ià(
x
 == 16) {

301 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
PAD
, PAD, 
skey
)è!ğ
CRYPT_OK
) {

302 
”rÜ
;

304 
x
 = 0;

306 
PAD
[
x
++] ^ğ
b
;

309 ià(
x
 != 0) {

310 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
PAD
, PAD, 
skey
)è!ğ
CRYPT_OK
) {

311 
”rÜ
;

317 
y
 = 15; y > 15 - 
L
; y--) {

318 
ùr
[
y
] = 0x00;

320 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
ùr
, 
CTRPAD
, 
skey
)è!ğ
CRYPT_OK
) {

321 
”rÜ
;

324 ià(
skey
 !ğ
uskey
) {

325 
ch”_desütÜ
[
ch”
].
	`dÚe
(
skey
);

329 
x
 = 0; x < 16 && x < *
gËn
; x++) {

330 
g
[
x
] = 
PAD
[x] ^ 
CTRPAD
[x];

332 *
gËn
 = 
x
;

334 #ifdeà
LTC_CLEAN_STACK


335 
	`z”omem
(
skey
, (*skey));

336 
	`z”omem
(
PAD
, (PAD));

337 
	`z”omem
(
CTRPAD
, (CTRPAD));

339 
”rÜ
:

340 ià(
skey
 !ğ
uskey
) {

341 
	`XFREE
(
skey
);

344  
”r
;

345 
	}
}

	@libtomcrypt/src/encauth/ccm/ccm_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
CCM_MODE


20 
	$ccm_‹¡
()

22 #iâdeà
LTC_TEST


23  
CRYPT_NOP
;

26 
key
[16];

27 
nÚû
[16];

28 
nÚûËn
;

29 
h—d”
[64];

30 
h—d”Ën
;

31 
±
[64];

32 
±Ën
;

33 
ù
[64];

34 
g
[16];

35 
gËn
;

36 } 
‹¡s
[] = {

116 
gËn
, 
x
;

117 
buf
[64], 
buf2
[64], 
g2
[16], 
g
[16];

118 
”r
, 
idx
;

119 
symm‘ric_key
 
skey
;

121 
idx
 = 
	`fšd_ch”
("aes");

122 ià(
idx
 == -1) {

123 
idx
 = 
	`fšd_ch”
("rijndael");

124 ià(
idx
 == -1) {

125  
CRYPT_NOP
;

129 
x
 = 0; x < ((
‹¡s
)/(tests[0])); x++) {

130 
gËn
 = 
‹¡s
[
x
].taglen;

131 ià((
”r
 = 
ch”_desütÜ
[
idx
].
	`£tup
(
‹¡s
[
x
].
key
, 16, 0, &
skey
)è!ğ
CRYPT_OK
) {

132  
”r
;

135 ià((
”r
 = 
	`ccm_memÜy
(
idx
,

136 
‹¡s
[
x
].
key
, 16,

137 &
skey
,

138 
‹¡s
[
x
].
nÚû
,e¡s[x].
nÚûËn
,

139 
‹¡s
[
x
].
h—d”
,e¡s[x].
h—d”Ën
,

140 (*)
‹¡s
[
x
].
±
,e¡s[x].
±Ën
,

141 
buf
,

142 
g
, &
gËn
, 0)è!ğ
CRYPT_OK
) {

143  
”r
;

146 ià(
	`XMEMCMP
(
buf
, 
‹¡s
[
x
].
ù
,e¡s[x].
±Ën
)) {

147  
CRYPT_FAIL_TESTVECTOR
;

149 ià(
	`XMEMCMP
(
g
, 
‹¡s
[
x
].g,e¡s[x].
gËn
)) {

150  
CRYPT_FAIL_TESTVECTOR
;

153 ià((
”r
 = 
	`ccm_memÜy
(
idx
,

154 
‹¡s
[
x
].
key
, 16,

155 
NULL
,

156 
‹¡s
[
x
].
nÚû
,e¡s[x].
nÚûËn
,

157 
‹¡s
[
x
].
h—d”
,e¡s[x].
h—d”Ën
,

158 
buf2
, 
‹¡s
[
x
].
±Ën
,

159 
buf
,

160 
g2
, &
gËn
, 1 )è!ğ
CRYPT_OK
) {

161  
”r
;

164 ià(
	`XMEMCMP
(
buf2
, 
‹¡s
[
x
].
±
,e¡s[x].
±Ën
)) {

165  
CRYPT_FAIL_TESTVECTOR
;

167 ià(
	`XMEMCMP
(
g2
, 
‹¡s
[
x
].
g
,e¡s[x].
gËn
)) {

168  
CRYPT_FAIL_TESTVECTOR
;

170 
ch”_desütÜ
[
idx
].
	`dÚe
(&
skey
);

172  
CRYPT_OK
;

174 
	}
}

	@libtomcrypt/src/encauth/eax/eax_addheader.c

15 
	~"tomüy±.h
"

17 #ifdeà
EAX_MODE


26 
	$—x_addh—d”
(
—x_¡©e
 *
—x
, cÚ¡ *
h—d”
,

27 
Ëngth
)

29 
	`LTC_ARGCHK
(
—x
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
h—d”
 !ğ
NULL
);

31  
	`omac_´oûss
(&
—x
->
h—d”omac
, 
h—d”
, 
Ëngth
);

32 
	}
}

	@libtomcrypt/src/encauth/eax/eax_decrypt.c

16 
	~"tomüy±.h
"

18 #ifdeà
EAX_MODE


28 
	$—x_deüy±
(
—x_¡©e
 *
—x
, cÚ¡ *
ù
, *
±
,

29 
Ëngth
)

31 
”r
;

33 
	`LTC_ARGCHK
(
—x
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

38 ià((
”r
 = 
	`omac_´oûss
(&
—x
->
ùomac
, 
ù
, 
Ëngth
)è!ğ
CRYPT_OK
) {

39  
”r
;

43  
	`ùr_deüy±
(
ù
, 
±
, 
Ëngth
, &
—x
->
ùr
);

44 
	}
}

	@libtomcrypt/src/encauth/eax/eax_decrypt_verify_memory.c

16 
	~"tomüy±.h
"

18 #ifdeà
EAX_MODE


37 
	$—x_deüy±_v”ify_memÜy
(
ch”
,

38 cÚ¡ *
key
, 
keyËn
,

39 cÚ¡ *
nÚû
, 
nÚûËn
,

40 cÚ¡ *
h—d”
, 
h—d”Ën
,

41 cÚ¡ *
ù
, 
ùËn
,

42 *
±
,

43 *
g
, 
gËn
,

44 *
¡©
)

46 
”r
;

47 
—x_¡©e
 *
—x
;

48 *
buf
;

49 
buæ’
;

51 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

52 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

53 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

54 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

55 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

58 *
¡©
 = 0;

61 
buf
 = 
	`XMALLOC
(
gËn
);

62 
—x
 = 
	`XMALLOC
((*eax));

63 ià(
—x
 =ğ
NULL
 || 
buf
 == NULL) {

64 ià(
—x
 !ğ
NULL
) {

65 
	`XFREE
(
—x
);

67 ià(
buf
 !ğ
NULL
) {

68 
	`XFREE
(
buf
);

70  
CRYPT_MEM
;

73 ià((
”r
 = 
	`—x_š™
(
—x
, 
ch”
, 
key
, 
keyËn
, 
nÚû
, 
nÚûËn
, 
h—d”
, 
h—d”Ën
)è!ğ
CRYPT_OK
) {

74 
LBL_ERR
;

77 ià((
”r
 = 
	`—x_deüy±
(
—x
, 
ù
, 
±
, 
ùËn
)è!ğ
CRYPT_OK
) {

78 
LBL_ERR
;

81 
buæ’
 = 
gËn
;

82 ià((
”r
 = 
	`—x_dÚe
(
—x
, 
buf
, &
buæ’
)è!ğ
CRYPT_OK
) {

83 
LBL_ERR
;

87 ià(
buæ’
 >ğ
gËn
 && 
	`XMEMCMP
(
buf
, 
g
,aglen) == 0) {

88 *
¡©
 = 1;

91 
”r
 = 
CRYPT_OK
;

92 
LBL_ERR
:

93 #ifdeà
LTC_CLEAN_STACK


94 
	`z”omem
(
buf
, 
gËn
);

95 
	`z”omem
(
—x
, (*eax));

98 
	`XFREE
(
—x
);

99 
	`XFREE
(
buf
);

101  
”r
;

102 
	}
}

	@libtomcrypt/src/encauth/eax/eax_done.c

16 
	~"tomüy±.h
"

18 #ifdeà
EAX_MODE


27 
	$—x_dÚe
(
—x_¡©e
 *
—x
, *
g
, *
gËn
)

29 
”r
;

30 *
h—d”mac
, *
ùmac
;

31 
x
, 
Ën
;

33 
	`LTC_ARGCHK
(
—x
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
gËn
 !ğ
NULL
);

38 
h—d”mac
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

39 
ùmac
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

41 ià(
h—d”mac
 =ğ
NULL
 || 
ùmac
 == NULL) {

42 ià(
h—d”mac
 !ğ
NULL
) {

43 
	`XFREE
(
h—d”mac
);

45 ià(
ùmac
 !ğ
NULL
) {

46 
	`XFREE
(
ùmac
);

48  
CRYPT_MEM
;

52 
Ën
 = 
MAXBLOCKSIZE
;

53 ià((
”r
 = 
	`omac_dÚe
(&
—x
->
ùomac
, 
ùmac
, &
Ën
)è!ğ
CRYPT_OK
) {

54 
LBL_ERR
;

61 ià((
”r
 = 
	`omac_dÚe
(&
—x
->
h—d”omac
, 
h—d”mac
, &
Ën
)è!ğ
CRYPT_OK
) {

62 
LBL_ERR
;

66 ià((
”r
 = 
	`ùr_dÚe
(&
—x
->
ùr
)è!ğ
CRYPT_OK
) {

67 
LBL_ERR
;

71 
x
 = 0; x < 
Ën
 && x < *
gËn
; x++) {

72 
g
[
x
] = 
—x
->
N
[x] ^ 
h—d”mac
[x] ^ 
ùmac
[x];

74 *
gËn
 = 
x
;

76 
”r
 = 
CRYPT_OK
;

77 
LBL_ERR
:

78 #ifdeà
LTC_CLEAN_STACK


79 
	`z”omem
(
ùmac
, 
MAXBLOCKSIZE
);

80 
	`z”omem
(
h—d”mac
, 
MAXBLOCKSIZE
);

81 
	`z”omem
(
—x
, (*eax));

84 
	`XFREE
(
ùmac
);

85 
	`XFREE
(
h—d”mac
);

87  
”r
;

88 
	}
}

	@libtomcrypt/src/encauth/eax/eax_encrypt.c

16 
	~"tomüy±.h
"

18 #ifdeà
EAX_MODE


28 
	$—x_’üy±
(
—x_¡©e
 *
—x
, cÚ¡ *
±
, *
ù
,

29 
Ëngth
)

31 
”r
;

33 
	`LTC_ARGCHK
(
—x
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

38 ià((
”r
 = 
	`ùr_’üy±
(
±
, 
ù
, 
Ëngth
, &
—x
->
ùr
)è!ğ
CRYPT_OK
) {

39  
”r
;

43  
	`omac_´oûss
(&
—x
->
ùomac
, 
ù
, 
Ëngth
);

44 
	}
}

	@libtomcrypt/src/encauth/eax/eax_encrypt_authenticate_memory.c

16 
	~"tomüy±.h
"

18 #ifdeà
EAX_MODE


36 
	$—x_’üy±_auth’tiÿ‹_memÜy
(
ch”
,

37 cÚ¡ *
key
, 
keyËn
,

38 cÚ¡ *
nÚû
, 
nÚûËn
,

39 cÚ¡ *
h—d”
, 
h—d”Ën
,

40 cÚ¡ *
±
, 
±Ën
,

41 *
ù
,

42 *
g
, *
gËn
)

44 
”r
;

45 
—x_¡©e
 *
—x
;

47 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

49 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

50 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

51 
	`LTC_ARGCHK
(
gËn
 !ğ
NULL
);

53 
—x
 = 
	`XMALLOC
((*eax));

55 ià((
”r
 = 
	`—x_š™
(
—x
, 
ch”
, 
key
, 
keyËn
, 
nÚû
, 
nÚûËn
, 
h—d”
, 
h—d”Ën
)è!ğ
CRYPT_OK
) {

56 
LBL_ERR
;

59 ià((
”r
 = 
	`—x_’üy±
(
—x
, 
±
, 
ù
, 
±Ën
)è!ğ
CRYPT_OK
) {

60 
LBL_ERR
;

63 ià((
”r
 = 
	`—x_dÚe
(
—x
, 
g
, 
gËn
)è!ğ
CRYPT_OK
) {

64 
LBL_ERR
;

67 
”r
 = 
CRYPT_OK
;

68 
LBL_ERR
:

69 #ifdeà
LTC_CLEAN_STACK


70 
	`z”omem
(
—x
, (*eax));

73 
	`XFREE
(
—x
);

75  
”r
;

76 
	}
}

	@libtomcrypt/src/encauth/eax/eax_init.c

16 
	~"tomüy±.h
"

18 #ifdeà
EAX_MODE


32 
	$—x_š™
(
—x_¡©e
 *
—x
, 
ch”
,

33 cÚ¡ *
key
, 
keyËn
,

34 cÚ¡ *
nÚû
, 
nÚûËn
,

35 cÚ¡ *
h—d”
, 
h—d”Ën
)

37 *
buf
;

38 
”r
, 
blkËn
;

39 
omac_¡©e
 *
omac
;

40 
Ën
;

43 
	`LTC_ARGCHK
(
—x
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
nÚû
 !ğ
NULL
);

46 ià(
h—d”Ën
 > 0) {

47 
	`LTC_ARGCHK
(
h—d”
 !ğ
NULL
);

50 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

51  
”r
;

53 
blkËn
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

56 
buf
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

57 
omac
 = 
	`XMALLOC
((*omac));

59 ià(
buf
 =ğ
NULL
 || 
omac
 == NULL) {

60 ià(
buf
 !ğ
NULL
) {

61 
	`XFREE
(
buf
);

63 ià(
omac
 !ğ
NULL
) {

64 
	`XFREE
(
omac
);

66  
CRYPT_MEM
;

70 
	`z”omem
(
buf
, 
MAXBLOCKSIZE
);

71 ià((
”r
 = 
	`omac_š™
(
omac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

72 
LBL_ERR
;

76 ià((
”r
 = 
	`omac_´oûss
(
omac
, 
buf
, 
blkËn
)è!ğ
CRYPT_OK
) {

77 
LBL_ERR
;

80 ià((
”r
 = 
	`omac_´oûss
(
omac
, 
nÚû
, 
nÚûËn
)è!ğ
CRYPT_OK
) {

81 
LBL_ERR
;

84 
Ën
 = (
—x
->
N
);

85 ià((
”r
 = 
	`omac_dÚe
(
omac
, 
—x
->
N
, &
Ën
)è!ğ
CRYPT_OK
) {

86 
LBL_ERR
;

90 
	`z”omem
(
buf
, 
MAXBLOCKSIZE
);

91 
buf
[
blkËn
 - 1] = 1;

93 ià((
”r
 = 
	`omac_š™
(&
—x
->
h—d”omac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

94 
LBL_ERR
;

98 ià((
”r
 = 
	`omac_´oûss
(&
—x
->
h—d”omac
, 
buf
, 
blkËn
)è!ğ
CRYPT_OK
) {

99 
LBL_ERR
;

102 ià(
h—d”Ën
 != 0) {

103 ià((
”r
 = 
	`omac_´oûss
(&
—x
->
h—d”omac
, 
h—d”
, 
h—d”Ën
)è!ğ
CRYPT_OK
) {

104 
LBL_ERR
;

111 ià((
”r
 = 
	`ùr_¡¬t
(
ch”
, 
—x
->
N
, 
key
, 
keyËn
, 0, 
CTR_COUNTER_BIG_ENDIAN
, &—x->
ùr
)è!ğ
CRYPT_OK
) {

112 
LBL_ERR
;

116 ià((
”r
 = 
	`omac_š™
(&
—x
->
ùomac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

117 
LBL_ERR
;

121 
	`z”omem
(
buf
, 
MAXBLOCKSIZE
);

122 
buf
[
blkËn
-1] = 2;

123 ià((
”r
 = 
	`omac_´oûss
(&
—x
->
ùomac
, 
buf
, 
blkËn
)è!ğ
CRYPT_OK
) {

124 
LBL_ERR
;

127 
”r
 = 
CRYPT_OK
;

128 
LBL_ERR
:

129 #ifdeà
LTC_CLEAN_STACK


130 
	`z”omem
(
buf
, 
MAXBLOCKSIZE
);

131 
	`z”omem
(
omac
, (*omac));

134 
	`XFREE
(
omac
);

135 
	`XFREE
(
buf
);

137  
”r
;

138 
	}
}

	@libtomcrypt/src/encauth/eax/eax_test.c

16 
	~"tomüy±.h
"

18 #ifdeà
EAX_MODE


24 
	$—x_‹¡
()

26 #iâdeà
LTC_TEST


27  
CRYPT_NOP
;

30 
keyËn
,

31 
nÚûËn
,

32 
h—d”Ën
,

33 
msgËn
;

35 
key
[
MAXBLOCKSIZE
],

36 
nÚû
[
MAXBLOCKSIZE
],

37 
h—d”
[
MAXBLOCKSIZE
],

38 
¶aš‹xt
[
MAXBLOCKSIZE
],

39 
ch”‹xt
[
MAXBLOCKSIZE
],

40 
g
[
MAXBLOCKSIZE
];

41 } 
‹¡s
[] = {

216 
”r
, 
x
, 
idx
, 
»s
;

217 
Ën
;

218 
outù
[
MAXBLOCKSIZE
], 
ou‰ag
[MAXBLOCKSIZE];

221 ià((
idx
 = 
	`fšd_ch”
("aes")) == -1) {

222 ià((
idx
 = 
	`fšd_ch”
("rijndael")) == -1) {

223  
CRYPT_NOP
;

227 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

228 
Ën
 = (
ou‰ag
);

229 ià((
”r
 = 
	`—x_’üy±_auth’tiÿ‹_memÜy
(
idx
, 
‹¡s
[
x
].
key
,e¡s[x].
keyËn
,

230 
‹¡s
[
x
].
nÚû
,e¡s[x].
nÚûËn
,e¡s[x].
h—d”
,e¡s[x].
h—d”Ën
,

231 
‹¡s
[
x
].
¶aš‹xt
,e¡s[x].
msgËn
, 
outù
, 
ou‰ag
, &
Ën
)è!ğ
CRYPT_OK
) {

232  
”r
;

234 ià(
	`XMEMCMP
(
outù
, 
‹¡s
[
x
].
ch”‹xt
,e¡s[x].
msgËn
è|| XMEMCMP(
ou‰ag
,e¡s[x].
g
, 
Ën
)) {

236 
y
;

237 
	`´štf
("\n\nFailure: \nCT:\n");

238 
y
 = 0; y < ()
‹¡s
[
x
].
msgËn
; ) {

239 
	`´štf
("0x%02x", 
outù
[
y
]);

240 ià(
y
 < ()(
‹¡s
[
x
].
msgËn
-1)è
	`´štf
(", ");

241 ià(!(++
y
 % 8)è
	`´štf
("\n");

243 
	`´štf
("\nTAG:\n");

244 
y
 = 0; y < 
Ën
; ) {

245 
	`´štf
("0x%02x", 
ou‰ag
[
y
]);

246 ià(
y
 < 
Ën
-1è
	`´štf
(", ");

247 ià(!(++
y
 % 8)è
	`´štf
("\n");

250  
CRYPT_FAIL_TESTVECTOR
;

254 ià((
”r
 = 
	`—x_deüy±_v”ify_memÜy
(
idx
, 
‹¡s
[
x
].
key
,e¡s[x].
keyËn
,

255 
‹¡s
[
x
].
nÚû
,e¡s[x].
nÚûËn
,e¡s[x].
h—d”
,e¡s[x].
h—d”Ën
,

256 
outù
, 
‹¡s
[
x
].
msgËn
, outù, 
ou‰ag
, 
Ën
, &
»s
)è!ğ
CRYPT_OK
) {

257  
”r
;

259 ià((
»s
 !ğ1è|| 
	`XMEMCMP
(
outù
, 
‹¡s
[
x
].
¶aš‹xt
,e¡s[x].
msgËn
)) {

261 
y
;

262 
	`´štf
("\n\nFau» (» =ğ%d): \nPT:\n", 
»s
);

263 
y
 = 0; y < ()
‹¡s
[
x
].
msgËn
; ) {

264 
	`´štf
("0x%02x", 
outù
[
y
]);

265 ià(
y
 < ()(
‹¡s
[
x
].
msgËn
-1)è
	`´štf
(", ");

266 ià(!(++
y
 % 8)è
	`´štf
("\n");

268 
	`´štf
("\n\n");

270  
CRYPT_FAIL_TESTVECTOR
;

274  
CRYPT_OK
;

276 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_add_aad.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


27 
	$gcm_add_¯d
(
gcm_¡©e
 *
gcm
,

28 cÚ¡ *
ad©a
, 
ad©®’
)

30 
x
;

31 
”r
;

32 #ifdeà
LTC_FAST


33 
y
;

36 
	`LTC_ARGCHK
(
gcm
 !ğ
NULL
);

37 ià(
ad©®’
 > 0) {

38 
	`LTC_ARGCHK
(
ad©a
 !ğ
NULL
);

41 ià(
gcm
->
buæ’
 > 16 || gcm->buflen < 0) {

42  
CRYPT_INVALID_ARG
;

45 ià((
”r
 = 
	`ch”_is_v®id
(
gcm
->
ch”
)è!ğ
CRYPT_OK
) {

46  
”r
;

50 ià(
gcm
->
mode
 =ğ
GCM_MODE_IV
) {

52 ià(
gcm
->
ivmode
 || gcm->
buæ’
 != 12) {

53 
x
 = 0; x < ()
gcm
->
buæ’
; x++) {

54 
gcm
->
X
[
x
] ^ğgcm->
buf
[x];

56 ià(
gcm
->
buæ’
) {

57 
gcm
->
tÙËn
 +ğgcm->
buæ’
 * 
	`CONST64
(8);

58 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

62 
	`z”omem
(
gcm
->
buf
, 8);

63 
	`STORE64H
(
gcm
->
tÙËn
, gcm->
buf
+8);

64 
x
 = 0; x < 16; x++) {

65 
gcm
->
X
[
x
] ^ğgcm->
buf
[x];

67 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

70 
	`XMEMCPY
(
gcm
->
Y
, gcm->
X
, 16);

71 
	`z”omem
(
gcm
->
X
, 16);

73 
	`XMEMCPY
(
gcm
->
Y
, gcm->
buf
, 12);

74 
gcm
->
Y
[12] = 0;

75 
gcm
->
Y
[13] = 0;

76 
gcm
->
Y
[14] = 0;

77 
gcm
->
Y
[15] = 1;

79 
	`XMEMCPY
(
gcm
->
Y_0
, gcm->
Y
, 16);

80 
	`z”omem
(
gcm
->
buf
, 16);

81 
gcm
->
buæ’
 = 0;

82 
gcm
->
tÙËn
 = 0;

83 
gcm
->
mode
 = 
GCM_MODE_AAD
;

86 ià(
gcm
->
mode
 !ğ
GCM_MODE_AAD
 || gcm->
buæ’
 >= 16) {

87  
CRYPT_INVALID_ARG
;

90 
x
 = 0;

91 #ifdeà
LTC_FAST


92 ià(
gcm
->
buæ’
 == 0) {

93 
x
 = 0; x < (
ad©®’
 & ~15); x += 16) {

94 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

95 *((
LTC_FAST_TYPE
*)(&
gcm
->
X
[
y
])è^ğ*((LTC_FAST_TYPE*)(&
ad©a
[
x
 + y]));

97 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

98 
gcm
->
tÙËn
 += 128;

100 
ad©a
 +ğ
x
;

106 ; 
x
 < 
ad©®’
; x++) {

107 
gcm
->
X
[gcm->
buæ’
++] ^ğ*
ad©a
++;

109 ià(
gcm
->
buæ’
 == 16) {

111 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

112 
gcm
->
buæ’
 = 0;

113 
gcm
->
tÙËn
 += 128;

117  
CRYPT_OK
;

118 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_add_iv.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


27 
	$gcm_add_iv
(
gcm_¡©e
 *
gcm
,

28 cÚ¡ *
IV
, 
IVËn
)

30 
x
, 
y
;

31 
”r
;

33 
	`LTC_ARGCHK
(
gcm
 !ğ
NULL
);

34 ià(
IVËn
 > 0) {

35 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

39 ià(
gcm
->
mode
 !ğ
GCM_MODE_IV
) {

40  
CRYPT_INVALID_ARG
;

43 ià(
gcm
->
buæ’
 >= 16 || gcm->buflen < 0) {

44  
CRYPT_INVALID_ARG
;

47 ià((
”r
 = 
	`ch”_is_v®id
(
gcm
->
ch”
)è!ğ
CRYPT_OK
) {

48  
”r
;

53 ià(
IVËn
 + 
gcm
->
buæ’
 > 12) {

54 
gcm
->
ivmode
 |= 1;

57 
x
 = 0;

58 #ifdeà
LTC_FAST


59 ià(
gcm
->
buæ’
 == 0) {

60 
x
 = 0; x < (
IVËn
 & ~15); x += 16) {

61 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

62 *((
LTC_FAST_TYPE
*)(&
gcm
->
X
[
y
])è^ğ*((LTC_FAST_TYPE*)(&
IV
[
x
 + y]));

64 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

65 
gcm
->
tÙËn
 += 128;

67 
IV
 +ğ
x
;

72 ; 
x
 < 
IVËn
; x++) {

73 
gcm
->
buf
[gcm->
buæ’
++] = *
IV
++;

75 ià(
gcm
->
buæ’
 == 16) {

77 
y
 = 0; y < 16; y++) {

78 
gcm
->
X
[
y
] ^ğgcm->
buf
[y];

80 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

81 
gcm
->
buæ’
 = 0;

82 
gcm
->
tÙËn
 += 128;

86  
CRYPT_OK
;

87 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_done.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


27 
	$gcm_dÚe
(
gcm_¡©e
 *
gcm
,

28 *
g
, *
gËn
)

30 
x
;

31 
”r
;

33 
	`LTC_ARGCHK
(
gcm
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
gËn
 !ğ
NULL
);

37 ià(
gcm
->
buæ’
 > 16 || gcm->buflen < 0) {

38  
CRYPT_INVALID_ARG
;

41 ià((
”r
 = 
	`ch”_is_v®id
(
gcm
->
ch”
)è!ğ
CRYPT_OK
) {

42  
”r
;

46 ià(
gcm
->
mode
 !ğ
GCM_MODE_TEXT
) {

47  
CRYPT_INVALID_ARG
;

51 ià(
gcm
->
buæ’
) {

52 
gcm
->
±tÙËn
 +ğgcm->
buæ’
 * 
	`CONST64
(8);

53 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

57 
	`STORE64H
(
gcm
->
tÙËn
, gcm->
buf
);

58 
	`STORE64H
(
gcm
->
±tÙËn
, gcm->
buf
+8);

59 
x
 = 0; x < 16; x++) {

60 
gcm
->
X
[
x
] ^ğgcm->
buf
[x];

62 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

65 ià((
”r
 = 
ch”_desütÜ
[
gcm
->
ch”
].
	`ecb_’üy±
(gcm->
Y_0
, gcm->
buf
, &gcm->
K
)è!ğ
CRYPT_OK
) {

66  
”r
;

68 
x
 = 0; x < 16 && x < *
gËn
; x++) {

69 
g
[
x
] = 
gcm
->
buf
[x] ^ gcm->
X
[x];

71 *
gËn
 = 
x
;

73 
ch”_desütÜ
[
gcm
->
ch”
].
	`dÚe
(&gcm->
K
);

75  
CRYPT_OK
;

76 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_gf_mult.c

16 
	~"tomüy±.h
"

18 #ià
defšed
(
GCM_TABLES
è|| defšed(
LRW_TABLES
è|| ((defšed(
GCM_MODE
è|| defšed(GCM_MODE)è&& defšed(
LTC_FAST
))

22 cÚ¡ 
	ggcm_shiá_bË
[256*2] = {

59 #ià
defšed
(
GCM_MODE
è|| defšed(
LRW_MODE
)

61 #iâdeà
LTC_FAST


63 
	$gcm_rightshiá
(*
a
)

65 
x
;

66 
x
 = 15; x > 0; x--) {

67 
a
[
x
] = (a[x]>>1) | ((a[x-1]<<7)&0x80);

69 
a
[0] >>= 1;

70 
	}
}

73 cÚ¡ 
	gmask
[] = { 0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01 };

74 cÚ¡ 
	gpŞy
[] = { 0x00, 0xE1 };

83 
	$gcm_gf_muÉ
(cÚ¡ *
a
, cÚ¡ *
b
, *
c
)

85 
Z
[16], 
V
[16];

86 
x
, 
y
, 
z
;

88 
	`z”omem
(
Z
, 16);

89 
	`XMEMCPY
(
V
, 
a
, 16);

90 
x
 = 0; x < 128; x++) {

91 ià(
b
[
x
>>3] & 
mask
[x&7]) {

92 
y
 = 0; y < 16; y++) {

93 
Z
[
y
] ^ğ
V
[y];

96 
z
 = 
V
[15] & 0x01;

97 
	`gcm_rightshiá
(
V
);

98 
V
[0] ^ğ
pŞy
[
z
];

100 
	`XMEMCPY
(
c
, 
Z
, 16);

101 
	}
}

106 
	#M
(
x
èĞ((x&8)>>3è| ((x&4)>>1è| ((x&2)<<1è| ((x&1)<<3è)

	)

108 
	#BPD
 ((
LTC_FAST_TYPE
è* 8)

	)

109 
	#WPV
 (1 + (16 / (
LTC_FAST_TYPE
)))

	)

117 
	$gcm_gf_muÉ
(cÚ¡ *
a
, cÚ¡ *
b
, *
c
)

119 
i
, 
j
, 
k
, 
u
;

120 
LTC_FAST_TYPE
 
B
[16][
WPV
], 
tmp
[32 / (LTC_FAST_TYPE)], 
pB
[16 / (LTC_FAST_TYPE)], 
zz
, 
z
;

121 
pTmp
[32];

124 
	`z”omem
(
B
[0], (B[0]));

125 
	`z”omem
(
B
[
	`M
(1)], (B[M(1)]));

127 #ifdeà
ENDIAN_32BITWORD


128 
i
 = 0; i < 4; i++) {

129 
	`LOAD32H
(
B
[
	`M
(1)][
i
], 
a
 + (i<<2));

130 
	`LOAD32L
(
pB
[
i
], 
b
 + (i<<2));

133 
i
 = 0; i < 2; i++) {

134 
	`LOAD64H
(
B
[
	`M
(1)][
i
], 
a
 + (i<<3));

135 
	`LOAD64L
(
pB
[
i
], 
b
 + (i<<3));

140 
B
[
	`M
(2)][0] = B[M(1)][0] >> 1;

141 
B
[
	`M
(4)][0] = B[M(1)][0] >> 2;

142 
B
[
	`M
(8)][0] = B[M(1)][0] >> 3;

143 
i
 = 1; i < ()
WPV
; i++) {

144 
B
[
	`M
(2)][
i
] = (B[M(1)][i-1] << (
BPD
-1)) | (B[M(1)][i] >> 1);

145 
B
[
	`M
(4)][
i
] = (B[M(1)][i-1] << (
BPD
-2)) | (B[M(1)][i] >> 2);

146 
B
[
	`M
(8)][
i
] = (B[M(1)][i-1] << (
BPD
-3)) | (B[M(1)][i] >> 3);

150 
i
 = 0; i < ()
WPV
; i++) {

151 
B
[
	`M
(3)][
i
] = B[M(1)][i] ^ B[M(2)][i];

152 
B
[
	`M
(5)][
i
] = B[M(1)][i] ^ B[M(4)][i];

153 
B
[
	`M
(6)][
i
] = B[M(2)][i] ^ B[M(4)][i];

154 
B
[
	`M
(9)][
i
] = B[M(1)][i] ^ B[M(8)][i];

155 
B
[
	`M
(10)][
i
] = B[M(2)][i] ^ B[M(8)][i];

156 
B
[
	`M
(12)][
i
] = B[M(8)][i] ^ B[M(4)][i];

159 
B
[
	`M
(7)][
i
] = B[M(3)][i] ^ B[M(4)][i];

160 
B
[
	`M
(11)][
i
] = B[M(3)][i] ^ B[M(8)][i];

161 
B
[
	`M
(13)][
i
] = B[M(1)][i] ^ B[M(12)][i];

162 
B
[
	`M
(14)][
i
] = B[M(6)][i] ^ B[M(8)][i];

163 
B
[
	`M
(15)][
i
] = B[M(7)][i] ^ B[M(8)][i];

166 
	`z”omem
(
tmp
, (tmp));

170 
i
 = (
BPD
/4)-1; i >= 0; i--) {

172 
j
 = 0; j < ()(
WPV
-1); j++) {

174 
u
 = (
pB
[
j
] >> ((
i
^1)<<2)) & 15;

177 
k
 = 0; k < ()
WPV
; k++) {

178 
tmp
[
k
+
j
] ^ğ
B
[
u
][k];

182 ià(
i
 != 0) {

183 
z
 = 
j
 = 0; j < ()(32 / (
LTC_FAST_TYPE
)); j++) {

184 
zz
 = 
tmp
[
j
] << (
BPD
-4);

185 
tmp
[
j
] = (tmp[j] >> 4è| 
z
;

186 
z
 = 
zz
;

192 #ifdeà
ENDIAN_32BITWORD


193 
i
 = 0; i < 8; i++) {

194 
	`STORE32H
(
tmp
[
i
], 
pTmp
 + (i<<2));

197 
i
 = 0; i < 4; i++) {

198 
	`STORE64H
(
tmp
[
i
], 
pTmp
 + (i<<3));

203 
i
 = 31; i >= 16; i--) {

204 
pTmp
[
i
-16] ^ğ
gcm_shiá_bË
[(()pTmp[i]<<1)];

205 
pTmp
[
i
-15] ^ğ
gcm_shiá_bË
[(()pTmp[i]<<1)+1];

208 
i
 = 0; i < 16; i++) {

209 
c
[
i
] = 
pTmp
[i];

212 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_init.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


28 
	$gcm_š™
(
gcm_¡©e
 *
gcm
, 
ch”
,

29 cÚ¡ *
key
, 
keyËn
)

31 
”r
;

32 
B
[16];

33 #ifdeà
GCM_TABLES


34 
x
, 
y
, 
z
, 
t
;

37 
	`LTC_ARGCHK
(
gcm
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

40 #ifdeà
LTC_FAST


41 ià(16 % (
LTC_FAST_TYPE
)) {

42  
CRYPT_INVALID_ARG
;

47 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

48  
”r
;

50 ià(
ch”_desütÜ
[
ch”
].
block_Ëngth
 != 16) {

51  
CRYPT_INVALID_CIPHER
;

55 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 0, &
gcm
->
K
)è!ğ
CRYPT_OK
) {

56  
”r
;

60 
	`z”omem
(
B
, 16);

61 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
B
, 
gcm
->
H
, &gcm->
K
)è!ğ
CRYPT_OK
) {

62  
”r
;

66 
	`z”omem
(
gcm
->
buf
, (gcm->buf));

67 
	`z”omem
(
gcm
->
X
, (gcm->X));

68 
gcm
->
ch”
 = cipher;

69 
gcm
->
mode
 = 
GCM_MODE_IV
;

70 
gcm
->
ivmode
 = 0;

71 
gcm
->
buæ’
 = 0;

72 
gcm
->
tÙËn
 = 0;

73 
gcm
->
±tÙËn
 = 0;

75 #ifdeà
GCM_TABLES


79 
	`z”omem
(
B
, 16);

80 
y
 = 0; y < 256; y++) {

81 
B
[0] = 
y
;

82 
	`gcm_gf_muÉ
(
gcm
->
H
, 
B
, &gcm->
PC
[0][
y
][0]);

86 
x
 = 1; x < 16; x++) {

87 
y
 = 0; y < 256; y++) {

89 
t
 = 
gcm
->
PC
[
x
-1][
y
][15];

90 
z
 = 15; z > 0; z--) {

91 
gcm
->
PC
[
x
][
y
][
z
] = gcm->PC[x-1][y][z-1];

93 
gcm
->
PC
[
x
][
y
][0] = 
gcm_shiá_bË
[
t
<<1];

94 
gcm
->
PC
[
x
][
y
][1] ^ğ
gcm_shiá_bË
[(
t
<<1)+1];

100  
CRYPT_OK
;

101 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_memory.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


37 
	$gcm_memÜy
Ğ
ch”
,

38 cÚ¡ *
key
, 
keyËn
,

39 cÚ¡ *
IV
, 
IVËn
,

40 cÚ¡ *
ad©a
, 
ad©®’
,

41 *
±
, 
±Ën
,

42 *
ù
,

43 *
g
, *
gËn
,

44 
dœeùiÚ
)

46 *
Üig
;

47 
gcm_¡©e
 *
gcm
;

48 
”r
;

50 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

51  
”r
;

54 ià(
ch”_desütÜ
[
ch”
].
acûl_gcm_memÜy
 !ğ
NULL
) {

56 
ch”_desütÜ
[
ch”
].
acûl_gcm_memÜy


57 (
key
, 
keyËn
,

58 
IV
, 
IVËn
,

59 
ad©a
, 
ad©®’
,

60 
±
, 
±Ën
,

61 
ù
,

62 
g
, 
gËn
,

63 
dœeùiÚ
);

68 #iâdeà
GCM_TABLES_SSE2


69 
Üig
 = 
gcm
 = 
	`XMALLOC
((*gcm));

71 
Üig
 = 
gcm
 = 
	`XMALLOC
((*gcm) + 16);

73 ià(
gcm
 =ğ
NULL
) {

74  
CRYPT_MEM
;

81 #ifdeà
GCM_TABLES_SSE2


82 ià(()
gcm
 & 15) {

83 
gcm
 = (
gcm_¡©e
 *)(()gcm + (16 - (()gcm & 15)));

87 ià((
”r
 = 
	`gcm_š™
(
gcm
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

88 
LTC_ERR
;

90 ià((
”r
 = 
	`gcm_add_iv
(
gcm
, 
IV
, 
IVËn
)è!ğ
CRYPT_OK
) {

91 
LTC_ERR
;

93 ià((
”r
 = 
	`gcm_add_¯d
(
gcm
, 
ad©a
, 
ad©®’
)è!ğ
CRYPT_OK
) {

94 
LTC_ERR
;

96 ià((
”r
 = 
	`gcm_´oûss
(
gcm
, 
±
, 
±Ën
, 
ù
, 
dœeùiÚ
)è!ğ
CRYPT_OK
) {

97 
LTC_ERR
;

99 
”r
 = 
	`gcm_dÚe
(
gcm
, 
g
, 
gËn
);

100 
LTC_ERR
:

101 
	`XFREE
(
Üig
);

102  
”r
;

103 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_mult_h.c

16 
	~"tomüy±.h
"

18 #ià
defšed
(
GCM_MODE
)

24 
	$gcm_muÉ_h
(
gcm_¡©e
 *
gcm
, *
I
)

26 
T
[16];

27 #ifdeà
GCM_TABLES


28 
x
, 
y
;

29 #ifdeà
GCM_TABLES_SSE2


30 
	`asm
("movdq¨(%0),%%xmm0"::"r"(&
gcm
->
PC
[0][
I
[0]][0]));

31 
x
 = 1; x < 16; x++) {

32 
	`asm
("pxÜ (%0),%%xmm0"::"r"(&
gcm
->
PC
[
x
][
I
[x]][0]));

34 
	`asm
("movdq¨%%xmm0,(%0)"::"r"(&
T
));

36 
	`XMEMCPY
(
T
, &
gcm
->
PC
[0][
I
[0]][0], 16);

37 
x
 = 1; x < 16; x++) {

38 #ifdeà
LTC_FAST


39 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

40 *((
LTC_FAST_TYPE
 *)(
T
 + 
y
)è^ğ*((LTC_FAST_TYPE *)(&
gcm
->
PC
[
x
][
I
[x]][y]));

43 
y
 = 0; y < 16; y++) {

44 
T
[
y
] ^ğ
gcm
->
PC
[
x
][
I
[x]][y];

50 
	`gcm_gf_muÉ
(
gcm
->
H
, 
I
, 
T
);

52 
	`XMEMCPY
(
I
, 
T
, 16);

53 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_process.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


29 
	$gcm_´oûss
(
gcm_¡©e
 *
gcm
,

30 *
±
, 
±Ën
,

31 *
ù
,

32 
dœeùiÚ
)

34 
x
;

35 
y
, 
”r
;

36 
b
;

38 
	`LTC_ARGCHK
(
gcm
 !ğ
NULL
);

39 ià(
±Ën
 > 0) {

40 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

44 ià(
gcm
->
buæ’
 > 16 || gcm->buflen < 0) {

45  
CRYPT_INVALID_ARG
;

48 ià((
”r
 = 
	`ch”_is_v®id
(
gcm
->
ch”
)è!ğ
CRYPT_OK
) {

49  
”r
;

53 ià(
gcm
->
mode
 =ğ
GCM_MODE_AAD
) {

55 ià(
gcm
->
buæ’
) {

56 
gcm
->
tÙËn
 +ğgcm->
buæ’
 * 
	`CONST64
(8);

57 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

61 
y
 = 15; y >= 12; y--) {

62 ià(++
gcm
->
Y
[
y
] & 255) { ; }

65 ià((
”r
 = 
ch”_desütÜ
[
gcm
->
ch”
].
	`ecb_’üy±
(gcm->
Y
, gcm->
buf
, &gcm->
K
)è!ğ
CRYPT_OK
) {

66  
”r
;

69 
gcm
->
buæ’
 = 0;

70 
gcm
->
mode
 = 
GCM_MODE_TEXT
;

73 ià(
gcm
->
mode
 !ğ
GCM_MODE_TEXT
) {

74  
CRYPT_INVALID_ARG
;

77 
x
 = 0;

78 #ifdeà
LTC_FAST


79 ià(
gcm
->
buæ’
 == 0) {

80 ià(
dœeùiÚ
 =ğ
GCM_ENCRYPT
) {

81 
x
 = 0; x < (
±Ën
 & ~15); x += 16) {

83 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

84 *((
LTC_FAST_TYPE
*)(&
ù
[
x
 + 
y
])èğ*((LTC_FAST_TYPE*)(&
±
[x+y])è^ *((LTC_FAST_TYPE*)(&
gcm
->
buf
[y]));

85 *((
LTC_FAST_TYPE
*)(&
gcm
->
X
[
y
])è^ğ*((LTC_FAST_TYPE*)(&
ù
[
x
+y]));

88 
gcm
->
±tÙËn
 += 128;

89 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

91 
y
 = 15; y >= 12; y--) {

92 ià(++
gcm
->
Y
[
y
] & 255) { ; }

94 ià((
”r
 = 
ch”_desütÜ
[
gcm
->
ch”
].
	`ecb_’üy±
(gcm->
Y
, gcm->
buf
, &gcm->
K
)è!ğ
CRYPT_OK
) {

95  
”r
;

99 
x
 = 0; x < (
±Ën
 & ~15); x += 16) {

101 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

102 *((
LTC_FAST_TYPE
*)(&
gcm
->
X
[
y
])è^ğ*((LTC_FAST_TYPE*)(&
ù
[
x
+y]));

103 *((
LTC_FAST_TYPE
*)(&
±
[
x
 + 
y
])èğ*((LTC_FAST_TYPE*)(&
ù
[x+y])è^ *((LTC_FAST_TYPE*)(&
gcm
->
buf
[y]));

106 
gcm
->
±tÙËn
 += 128;

107 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

109 
y
 = 15; y >= 12; y--) {

110 ià(++
gcm
->
Y
[
y
] & 255) { ; }

112 ià((
”r
 = 
ch”_desütÜ
[
gcm
->
ch”
].
	`ecb_’üy±
(gcm->
Y
, gcm->
buf
, &gcm->
K
)è!ğ
CRYPT_OK
) {

113  
”r
;

121 ; 
x
 < 
±Ën
; x++) {

122 ià(
gcm
->
buæ’
 == 16) {

123 
gcm
->
±tÙËn
 += 128;

124 
	`gcm_muÉ_h
(
gcm
, gcm->
X
);

127 
y
 = 15; y >= 12; y--) {

128 ià(++
gcm
->
Y
[
y
] & 255) { ; }

130 ià((
”r
 = 
ch”_desütÜ
[
gcm
->
ch”
].
	`ecb_’üy±
(gcm->
Y
, gcm->
buf
, &gcm->
K
)è!ğ
CRYPT_OK
) {

131  
”r
;

133 
gcm
->
buæ’
 = 0;

136 ià(
dœeùiÚ
 =ğ
GCM_ENCRYPT
) {

137 
b
 = 
ù
[
x
] = 
±
[x] ^ 
gcm
->
buf
[gcm->
buæ’
];

139 
b
 = 
ù
[
x
];

140 
±
[
x
] = 
ù
[x] ^ 
gcm
->
buf
[gcm->
buæ’
];

142 
gcm
->
X
[gcm->
buæ’
++] ^ğ
b
;

145  
CRYPT_OK
;

146 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_reset.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


25 
	$gcm_»£t
(
gcm_¡©e
 *
gcm
)

27 
	`LTC_ARGCHK
(
gcm
 !ğ
NULL
);

29 
	`z”omem
(
gcm
->
buf
, (gcm->buf));

30 
	`z”omem
(
gcm
->
X
, (gcm->X));

31 
gcm
->
mode
 = 
GCM_MODE_IV
;

32 
gcm
->
ivmode
 = 0;

33 
gcm
->
buæ’
 = 0;

34 
gcm
->
tÙËn
 = 0;

35 
gcm
->
±tÙËn
 = 0;

37  
CRYPT_OK
;

38 
	}
}

	@libtomcrypt/src/encauth/gcm/gcm_test.c

16 
	~"tomüy±.h
"

18 #ifdeà
GCM_MODE


24 
	$gcm_‹¡
()

26 #iâdeà
LTC_TEST


27  
CRYPT_NOP
;

30 
K
[32];

31 
keyËn
;

32 
P
[128];

33 
±Ën
;

34 
A
[128];

35 
®’
;

36 
IV
[128];

37 
IVËn
;

38 
C
[128];

39 
T
[16];

40 } 
‹¡s
[] = {

327 
idx
, 
”r
;

328 
x
, 
y
;

329 
out
[2][128], 
T
[2][16];

332 
idx
 = 
	`fšd_ch”
("aes");

333 ià(
idx
 == -1) {

334 
idx
 = 
	`fšd_ch”
("rijndael");

335 ià(
idx
 == -1) {

336  
CRYPT_NOP
;

340 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

341 
y
 = (
T
[0]);

342 ià((
”r
 = 
	`gcm_memÜy
(
idx
, 
‹¡s
[
x
].
K
,e¡s[x].
keyËn
,

343 
‹¡s
[
x
].
IV
,e¡s[x].
IVËn
,

344 
‹¡s
[
x
].
A
,e¡s[x].
®’
,

345 (*)
‹¡s
[
x
].
P
,e¡s[x].
±Ën
,

346 
out
[0], 
T
[0], &
y
, 
GCM_ENCRYPT
)è!ğ
CRYPT_OK
) {

347  
”r
;

350 ià(
	`XMEMCMP
(
out
[0], 
‹¡s
[
x
].
C
,e¡s[x].
±Ën
)) {

352 
	`´štf
("\nCh”‹xˆwrÚg %lu\n", 
x
);

353 
y
 = 0; y < 
‹¡s
[
x
].
±Ën
; y++) {

354 
	`´štf
("%02x", 
out
[0][
y
] & 255);

356 
	`´štf
("\n");

358  
CRYPT_FAIL_TESTVECTOR
;

361 ià(
	`XMEMCMP
(
T
[0], 
‹¡s
[
x
].T, 16)) {

363 
	`´štf
("\nTag oÀ¶aš‹xˆwrÚg %lu\n", 
x
);

364 
y
 = 0; y < 16; y++) {

365 
	`´štf
("%02x", 
T
[0][
y
] & 255);

367 
	`´štf
("\n");

369  
CRYPT_FAIL_TESTVECTOR
;

372 
y
 = (
T
[1]);

373 ià((
”r
 = 
	`gcm_memÜy
(
idx
, 
‹¡s
[
x
].
K
,e¡s[x].
keyËn
,

374 
‹¡s
[
x
].
IV
,e¡s[x].
IVËn
,

375 
‹¡s
[
x
].
A
,e¡s[x].
®’
,

376 
out
[1], 
‹¡s
[
x
].
±Ën
,

377 
out
[0], 
T
[1], &
y
, 
GCM_DECRYPT
)è!ğ
CRYPT_OK
) {

378  
”r
;

381 ià(
	`XMEMCMP
(
out
[1], 
‹¡s
[
x
].
P
,e¡s[x].
±Ën
)) {

383 
	`´štf
("\ÅÏš‹xˆwrÚg %lu\n", 
x
);

384 
y
 = 0; y < 
‹¡s
[
x
].
±Ën
; y++) {

385 
	`´štf
("%02x", 
out
[0][
y
] & 255);

387 
	`´štf
("\n");

389  
CRYPT_FAIL_TESTVECTOR
;

392 ià(
	`XMEMCMP
(
T
[1], 
‹¡s
[
x
].T, 16)) {

394 
	`´štf
("\nTag oÀch”‹xˆwrÚg %lu\n", 
x
);

395 
y
 = 0; y < 16; y++) {

396 
	`´štf
("%02x", 
T
[1][
y
] & 255);

398 
	`´štf
("\n");

400  
CRYPT_FAIL_TESTVECTOR
;

404  
CRYPT_OK
;

406 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_decrypt.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


27 
	$ocb_deüy±
(
ocb_¡©e
 *
ocb
, cÚ¡ *
ù
, *
±
)

29 
Z
[
MAXBLOCKSIZE
], 
tmp
[MAXBLOCKSIZE];

30 
”r
, 
x
;

32 
	`LTC_ARGCHK
(
ocb
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

37 ià((
”r
 = 
	`ch”_is_v®id
(
ocb
->
ch”
)è!ğ
CRYPT_OK
) {

38  
”r
;

40 
	`LTC_ARGCHK
(
ch”_desütÜ
[
ocb
->
ch”
].
ecb_deüy±
 !ğ
NULL
);

43 ià(
ocb
->
block_Ën
 !ğ
ch”_desütÜ
[ocb->
ch”
].
block_Ëngth
) {

44  
CRYPT_INVALID_ARG
;

48 
	`ocb_shiá_xÜ
(
ocb
, 
Z
);

51 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

52 
tmp
[
x
] = 
ù
[x] ^ 
Z
[x];

54 ià((
”r
 = 
ch”_desütÜ
[
ocb
->
ch”
].
	`ecb_deüy±
(
tmp
, 
±
, &ocb->
key
)è!ğ
CRYPT_OK
) {

55  
”r
;

57 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

58 
±
[
x
] ^ğ
Z
[x];

62 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

63 
ocb
->
checksum
[
x
] ^ğ
±
[x];

67 #ifdeà
LTC_CLEAN_STACK


68 
	`z”omem
(
Z
, (Z));

69 
	`z”omem
(
tmp
, (tmp));

71  
CRYPT_OK
;

72 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_decrypt_verify_memory.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


34 
	$ocb_deüy±_v”ify_memÜy
(
ch”
,

35 cÚ¡ *
key
, 
keyËn
,

36 cÚ¡ *
nÚû
,

37 cÚ¡ *
ù
, 
ùËn
,

38 *
±
,

39 cÚ¡ *
g
, 
gËn
,

40 *
¡©
)

42 
”r
;

43 
ocb_¡©e
 *
ocb
;

45 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
nÚû
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

49 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

50 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

53 
ocb
 = 
	`XMALLOC
((
ocb_¡©e
));

54 ià(
ocb
 =ğ
NULL
) {

55  
CRYPT_MEM
;

58 ià((
”r
 = 
	`ocb_š™
(
ocb
, 
ch”
, 
key
, 
keyËn
, 
nÚû
)è!ğ
CRYPT_OK
) {

59 
LBL_ERR
;

62 
ùËn
 > ()
ocb
->
block_Ën
) {

63 ià((
”r
 = 
	`ocb_deüy±
(
ocb
, 
ù
, 
±
)è!ğ
CRYPT_OK
) {

64 
LBL_ERR
;

66 
ùËn
 -ğ
ocb
->
block_Ën
;

67 
±
 +ğ
ocb
->
block_Ën
;

68 
ù
 +ğ
ocb
->
block_Ën
;

71 
”r
 = 
	`ocb_dÚe_deüy±
(
ocb
, 
ù
, 
ùËn
, 
±
, 
g
, 
gËn
, 
¡©
);

72 
LBL_ERR
:

73 #ifdeà
LTC_CLEAN_STACK


74 
	`z”omem
(
ocb
, (
ocb_¡©e
));

77 
	`XFREE
(
ocb
);

79  
”r
;

80 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_done_decrypt.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


31 
	$ocb_dÚe_deüy±
(
ocb_¡©e
 *
ocb
,

32 cÚ¡ *
ù
, 
ùËn
,

33 *
±
,

34 cÚ¡ *
g
, 
gËn
, *
¡©
)

36 
”r
;

37 *
gbuf
;

38 
gbuæ’
;

40 
	`LTC_ARGCHK
(
ocb
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

47 *
¡©
 = 0;

50 
gbuf
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

51 ià(
gbuf
 =ğ
NULL
) {

52  
CRYPT_MEM
;

55 
gbuæ’
 = 
MAXBLOCKSIZE
;

56 ià((
”r
 = 
	`s_ocb_dÚe
(
ocb
, 
ù
, 
ùËn
, 
±
, 
gbuf
, &
gbuæ’
, 1)è!ğ
CRYPT_OK
) {

57 
LBL_ERR
;

60 ià(
gËn
 <ğ
gbuæ’
 && 
	`XMEMCMP
(
gbuf
, 
g
,aglen) == 0) {

61 *
¡©
 = 1;

64 
”r
 = 
CRYPT_OK
;

65 
LBL_ERR
:

66 #ifdeà
LTC_CLEAN_STACK


67 
	`z”omem
(
gbuf
, 
MAXBLOCKSIZE
);

70 
	`XFREE
(
gbuf
);

72  
”r
;

73 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_done_encrypt.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


30 
	$ocb_dÚe_’üy±
(
ocb_¡©e
 *
ocb
, cÚ¡ *
±
, 
±Ën
,

31 *
ù
, *
g
, *
gËn
)

33 
	`LTC_ARGCHK
(
ocb
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
gËn
 !ğ
NULL
);

38  
	`s_ocb_dÚe
(
ocb
, 
±
, 
±Ën
, 
ù
, 
g
, 
gËn
, 0);

39 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_encrypt.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


27 
	$ocb_’üy±
(
ocb_¡©e
 *
ocb
, cÚ¡ *
±
, *
ù
)

29 
Z
[
MAXBLOCKSIZE
], 
tmp
[MAXBLOCKSIZE];

30 
”r
, 
x
;

32 
	`LTC_ARGCHK
(
ocb
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
ocb
->
ch”
)è!ğ
CRYPT_OK
) {

36  
”r
;

38 ià(
ocb
->
block_Ën
 !ğ
ch”_desütÜ
[ocb->
ch”
].
block_Ëngth
) {

39  
CRYPT_INVALID_ARG
;

43 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

44 
ocb
->
checksum
[
x
] ^ğ
±
[x];

48 
	`ocb_shiá_xÜ
(
ocb
, 
Z
);

51 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

52 
tmp
[
x
] = 
±
[x] ^ 
Z
[x];

54 ià((
”r
 = 
ch”_desütÜ
[
ocb
->
ch”
].
	`ecb_’üy±
(
tmp
, 
ù
, &ocb->
key
)è!ğ
CRYPT_OK
) {

55  
”r
;

57 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

58 
ù
[
x
] ^ğ
Z
[x];

61 #ifdeà
LTC_CLEAN_STACK


62 
	`z”omem
(
Z
, (Z));

63 
	`z”omem
(
tmp
, (tmp));

65  
CRYPT_OK
;

66 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_encrypt_authenticate_memory.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


33 
	$ocb_’üy±_auth’tiÿ‹_memÜy
(
ch”
,

34 cÚ¡ *
key
, 
keyËn
,

35 cÚ¡ *
nÚû
,

36 cÚ¡ *
±
, 
±Ën
,

37 *
ù
,

38 *
g
, *
gËn
)

40 
”r
;

41 
ocb_¡©e
 *
ocb
;

43 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
nÚû
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
gËn
 !ğ
NULL
);

51 
ocb
 = 
	`XMALLOC
((
ocb_¡©e
));

52 ià(
ocb
 =ğ
NULL
) {

53  
CRYPT_MEM
;

56 ià((
”r
 = 
	`ocb_š™
(
ocb
, 
ch”
, 
key
, 
keyËn
, 
nÚû
)è!ğ
CRYPT_OK
) {

57 
LBL_ERR
;

60 
±Ën
 > ()
ocb
->
block_Ën
) {

61 ià((
”r
 = 
	`ocb_’üy±
(
ocb
, 
±
, 
ù
)è!ğ
CRYPT_OK
) {

62 
LBL_ERR
;

64 
±Ën
 -ğ
ocb
->
block_Ën
;

65 
±
 +ğ
ocb
->
block_Ën
;

66 
ù
 +ğ
ocb
->
block_Ën
;

69 
”r
 = 
	`ocb_dÚe_’üy±
(
ocb
, 
±
, 
±Ën
, 
ù
, 
g
, 
gËn
);

70 
LBL_ERR
:

71 #ifdeà
LTC_CLEAN_STACK


72 
	`z”omem
(
ocb
, (
ocb_¡©e
));

75 
	`XFREE
(
ocb
);

77  
”r
;

78 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_init.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


21 
	mËn
;

22 
	mpŞy_div
[
MAXBLOCKSIZE
],

23 
	mpŞy_mul
[
MAXBLOCKSIZE
];

24 } 
	gpŞys
[] = {

47 
	$ocb_š™
(
ocb_¡©e
 *
ocb
, 
ch”
,

48 cÚ¡ *
key
, 
keyËn
, cÚ¡ *
nÚû
)

50 
pŞy
, 
x
, 
y
, 
m
, 
”r
;

52 
	`LTC_ARGCHK
(
ocb
 !ğ
NULL
);

53 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

54 
	`LTC_ARGCHK
(
nÚû
 !ğ
NULL
);

57 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

58  
”r
;

62 
ocb
->
block_Ën
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

63 
pŞy
 = 0;…Şy < ()((
pŞys
)/(polys[0]));…oly++) {

64 ià(
pŞys
[
pŞy
].
Ën
 =ğ
ocb
->
block_Ën
) {

68 ià(
pŞys
[
pŞy
].
Ën
 !ğ
ocb
->
block_Ën
) {

69  
CRYPT_INVALID_ARG
;

73 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 0, &
ocb
->key)è!ğ
CRYPT_OK
) {

74  
”r
;

78 
	`z”omem
(
ocb
->
L
, ocb->
block_Ën
);

79 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
ocb
->
L
, ocb->L, &ocb->
key
)è!ğ
CRYPT_OK
) {

80  
”r
;

84 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

85 
ocb
->
R
[
x
] = ocb->
L
[x] ^ 
nÚû
[x];

87 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
ocb
->
R
, ocb->R, &ocb->
key
)è!ğ
CRYPT_OK
) {

88  
”r
;

92 
	`XMEMCPY
(
ocb
->
Ls
[0], ocb->
L
, ocb->
block_Ën
);

93 
x
 = 1; x < 32; x++) {

94 
m
 = 
ocb
->
Ls
[
x
-1][0] >> 7;

95 
y
 = 0; y < 
ocb
->
block_Ën
-1; y++) {

96 
ocb
->
Ls
[
x
][
y
] = ((ocb->Ls[x-1][y] << 1) | (ocb->Ls[x-1][y+1] >> 7)) & 255;

98 
ocb
->
Ls
[
x
][ocb->
block_Ën
-1] = (ocb->Ls[x-1][ocb->block_len-1] << 1) & 255;

100 ià(
m
 == 1) {

101 
y
 = 0; y < 
ocb
->
block_Ën
; y++) {

102 
ocb
->
Ls
[
x
][
y
] ^ğ
pŞys
[
pŞy
].
pŞy_mul
[y];

108 
m
 = 
ocb
->
L
[ocb->
block_Ën
-1] & 1;

111 
x
 = 
ocb
->
block_Ën
 - 1; x > 0; x--) {

112 
ocb
->
Lr
[
x
] = ((ocb->
L
[x] >> 1) | (ocb->L[x-1] << 7)) & 255;

114 
ocb
->
Lr
[0] = ocb->
L
[0] >> 1;

116 ià(
m
 == 1) {

117 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

118 
ocb
->
Lr
[
x
] ^ğ
pŞys
[
pŞy
].
pŞy_div
[x];

123 
	`z”omem
(
ocb
->
Li
, ocb->
block_Ën
);

124 
	`z”omem
(
ocb
->
checksum
, ocb->
block_Ën
);

127 
ocb
->
block_šdex
 = 1;

128 
ocb
->
ch”
 = cipher;

130  
CRYPT_OK
;

131 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_ntz.c

17 
	~"tomüy±.h
"

19 #ifdeà
OCB_MODE


26 
	$ocb_Áz
(
x
)

28 
c
;

29 
x
 &= 0xFFFFFFFFUL;

30 
c
 = 0;

31 (
x
 & 1) == 0) {

32 ++
c
;

33 
x
 >>= 1;

35  
c
;

36 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_shift_xor.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


25 
	$ocb_shiá_xÜ
(
ocb_¡©e
 *
ocb
, *
Z
)

27 
x
, 
y
;

28 
y
 = 
	`ocb_Áz
(
ocb
->
block_šdex
++);

29 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

30 
ocb
->
Li
[
x
] ^ğocb->
Ls
[
y
][x];

31 
Z
[
x
] = 
ocb
->
Li
[x] ^ ocb->
R
[x];

33 
	}
}

	@libtomcrypt/src/encauth/ocb/ocb_test.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


24 
	$ocb_‹¡
()

26 #iâdeà
LTC_TEST


27  
CRYPT_NOP
;

30 
±Ën
;

31 
key
[16], 
nÚû
[16], 
±
[34], 
ù
[34], 
g
[16];

32 } 
‹¡s
[] = {

167 
”r
, 
x
, 
idx
, 
»s
;

168 
Ën
;

169 
outù
[
MAXBLOCKSIZE
], 
ou‰ag
[MAXBLOCKSIZE];

172 ià((
idx
 = 
	`fšd_ch”
("aes")) == -1) {

173 ià((
idx
 = 
	`fšd_ch”
("rijndael")) == -1) {

174  
CRYPT_NOP
;

178 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

179 
Ën
 = (
ou‰ag
);

180 ià((
”r
 = 
	`ocb_’üy±_auth’tiÿ‹_memÜy
(
idx
, 
‹¡s
[
x
].
key
, 16,

181 
‹¡s
[
x
].
nÚû
,e¡s[x].
±
,e¡s[x].
±Ën
, 
outù
, 
ou‰ag
, &
Ën
)è!ğ
CRYPT_OK
) {

182  
”r
;

185 ià(
	`XMEMCMP
(
ou‰ag
, 
‹¡s
[
x
].
g
, 
Ën
è|| XMEMCMP(
outù
,e¡s[x].
ù
,e¡s[x].
±Ën
)) {

187 
y
;

188 
	`´štf
("\n\nFailure: \nCT:\n");

189 
y
 = 0; y < ()
‹¡s
[
x
].
±Ën
; ) {

190 
	`´štf
("0x%02x", 
outù
[
y
]);

191 ià(
y
 < ()(
‹¡s
[
x
].
±Ën
-1)è
	`´štf
(", ");

192 ià(!(++
y
 % 8)è
	`´štf
("\n");

194 
	`´štf
("\nTAG:\n");

195 
y
 = 0; y < 
Ën
; ) {

196 
	`´štf
("0x%02x", 
ou‰ag
[
y
]);

197 ià(
y
 < 
Ën
-1è
	`´štf
(", ");

198 ià(!(++
y
 % 8)è
	`´štf
("\n");

201  
CRYPT_FAIL_TESTVECTOR
;

204 ià((
”r
 = 
	`ocb_deüy±_v”ify_memÜy
(
idx
, 
‹¡s
[
x
].
key
, 16,e¡s[x].
nÚû
, 
outù
,e¡s[x].
±Ën
,

205 
outù
, 
‹¡s
[
x
].
g
, 
Ën
, &
»s
)è!ğ
CRYPT_OK
) {

206  
”r
;

208 ià((
»s
 !ğ1è|| 
	`XMEMCMP
(
‹¡s
[
x
].
±
, 
outù
,e¡s[x].
±Ën
)) {

210 
y
;

211 
	`´štf
("\n\nFailure-decrypt: \nPT:\n");

212 
y
 = 0; y < ()
‹¡s
[
x
].
±Ën
; ) {

213 
	`´štf
("0x%02x", 
outù
[
y
]);

214 ià(
y
 < ()(
‹¡s
[
x
].
±Ën
-1)è
	`´štf
(", ");

215 ià(!(++
y
 % 8)è
	`´štf
("\n");

217 
	`´štf
("\Äe ğ%d\n\n", 
»s
);

221  
CRYPT_OK
;

223 
	}
}

	@libtomcrypt/src/encauth/ocb/s_ocb_done.c

16 
	~"tomüy±.h
"

18 #ifdeà
OCB_MODE


39 
	$s_ocb_dÚe
(
ocb_¡©e
 *
ocb
, cÚ¡ *
±
, 
±Ën
,

40 *
ù
, *
g
, *
gËn
, 
mode
)

43 *
Z
, *
Y
, *
X
;

44 
”r
, 
x
;

46 
	`LTC_ARGCHK
(
ocb
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

49 
	`LTC_ARGCHK
(
g
 !ğ
NULL
);

50 
	`LTC_ARGCHK
(
gËn
 !ğ
NULL
);

51 ià((
”r
 = 
	`ch”_is_v®id
(
ocb
->
ch”
)è!ğ
CRYPT_OK
) {

52  
”r
;

54 ià(
ocb
->
block_Ën
 !ğ
ch”_desütÜ
[ocb->
ch”
].
block_Ëngth
 ||

55 ()
±Ën
 > 
ocb
->
block_Ën
 || ()ptlen < 0) {

56  
CRYPT_INVALID_ARG
;

60 
Z
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

61 
Y
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

62 
X
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

63 ià(
X
 =ğ
NULL
 || 
Y
 =ğNULL || 
Z
 == NULL) {

64 ià(
X
 !ğ
NULL
) {

65 
	`XFREE
(
X
);

67 ià(
Y
 !ğ
NULL
) {

68 
	`XFREE
(
Y
);

70 ià(
Z
 !ğ
NULL
) {

71 
	`XFREE
(
Z
);

73  
CRYPT_MEM
;

77 
	`ocb_shiá_xÜ
(
ocb
, 
X
);

78 
	`XMEMCPY
(
Z
, 
X
, 
ocb
->
block_Ën
);

80 
X
[
ocb
->
block_Ën
-1] ^ğ(
±Ën
*8)&255;

81 
X
[
ocb
->
block_Ën
-2] ^ğ((
±Ën
*8)>>8)&255;

82 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

83 
X
[
x
] ^ğ
ocb
->
Lr
[x];

87 ià((
”r
 = 
ch”_desütÜ
[
ocb
->
ch”
].
	`ecb_’üy±
(
X
, 
Y
, &ocb->
key
)è!ğ
CRYPT_OK
) {

88 
”rÜ
;

91 ià(
mode
 == 1) {

94 
x
 = 0; x < ()
±Ën
; x++) {

95 
ocb
->
checksum
[
x
] ^ğ
ù
[x];

100 
x
 = 0; x < ()
±Ën
; x++) {

101 
ù
[
x
] = 
±
[x] ^ 
Y
[x];

104 ià(
mode
 == 0) {

107 
x
 = 0; x < ()
±Ën
; x++) {

108 
ocb
->
checksum
[
x
] ^ğ
ù
[x];

113 
x
 = 0; x < 
ocb
->
block_Ën
; x++) {

114 
ocb
->
checksum
[
x
] ^ğ
Y
[x] ^ 
Z
[x];

118 ià((
”r
 = 
ch”_desütÜ
[
ocb
->
ch”
].
	`ecb_’üy±
(ocb->
checksum
, 
X
, &ocb->
key
)è!ğ
CRYPT_OK
) {

119 
”rÜ
;

121 
ch”_desütÜ
[
ocb
->
ch”
].
	`dÚe
(&ocb->
key
);

124 
x
 = 0; x < 
ocb
->
block_Ën
 && x < ()*
gËn
; x++) {

125 
g
[
x
] = 
X
[x];

127 *
gËn
 = 
x
;

129 #ifdeà
LTC_CLEAN_STACK


130 
	`z”omem
(
X
, 
MAXBLOCKSIZE
);

131 
	`z”omem
(
Y
, 
MAXBLOCKSIZE
);

132 
	`z”omem
(
Z
, 
MAXBLOCKSIZE
);

133 
	`z”omem
(
ocb
, (*ocb));

135 
”rÜ
:

136 
	`XFREE
(
X
);

137 
	`XFREE
(
Y
);

138 
	`XFREE
(
Z
);

140  
”r
;

141 
	}
}

	@libtomcrypt/src/hashes/chc/chc.c

12 
	~"tomüy±.h
"

19 #ifdeà
CHC_HASH


21 
	#UNDEFED_HASH
 -17

	)

24 
	gch”_idx
=
UNDEFED_HASH
,

25 
	gch”_blocksize
;

28 cÚ¡ 
Éc_hash_desütÜ
 
	gchc_desc
 = {

30 &
chc_š™
,

31 &
chc_´oûss
,

32 &
chc_dÚe
,

33 &
chc_‹¡
,

34 
NULL


42 
	$chc_»gi¡”
(
ch”
)

44 
”r
, 
kl
, 
idx
;

46 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

47  
”r
;

51 
kl
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

54 ià(
kl
 <= 8) {

55  
CRYPT_INVALID_CIPHER
;

59 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`keysize
(&
kl
)è!ğ
CRYPT_OK
) {

60  
”r
;

63 ià(
kl
 !ğ
ch”_desütÜ
[
ch”
].
block_Ëngth
) {

64  
CRYPT_INVALID_CIPHER
;

68 ià((
”r
 = 
	`hash_is_v®id
(
idx
 = 
	`fšd_hash
("chc_hash"))è!ğ
CRYPT_OK
) {

69  
”r
;

73 
hash_desütÜ
[
idx
].
hashsize
 =

74 
hash_desütÜ
[
idx
].
blocksize
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

77 
ch”_idx
 = 
ch”
;

78 
ch”_blocksize
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

79  
CRYPT_OK
;

80 
	}
}

87 
	$chc_š™
(
hash_¡©e
 *
md
)

89 
symm‘ric_key
 *
key
;

90 
buf
[
MAXBLOCKSIZE
];

91 
”r
;

93 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

96 ià((
”r
 = 
	`ch”_is_v®id
(
ch”_idx
)è!ğ
CRYPT_OK
) {

97  
”r
;

100 ià(
ch”_blocksize
 !ğ
ch”_desütÜ
[
ch”_idx
].
block_Ëngth
) {

101  
CRYPT_INVALID_CIPHER
;

104 ià((
key
 = 
	`XMALLOC
((*key))è=ğ
NULL
) {

105  
CRYPT_MEM
;

109 
	`z”omem
(
buf
, 
ch”_blocksize
);

110 ià((
”r
 = 
ch”_desütÜ
[
ch”_idx
].
	`£tup
(
buf
, 
ch”_blocksize
, 0, 
key
)è!ğ
CRYPT_OK
) {

111 
	`XFREE
(
key
);

112  
”r
;

116 
ch”_desütÜ
[
ch”_idx
].
	`ecb_’üy±
(
buf
, 
md
->
chc
.
¡©e
, 
key
);

119 
md
->
chc
.
Ëngth
 = 0;

120 
md
->
chc
.
cu¾’
 = 0;

121 
	`z”omem
(
md
->
chc
.
buf
, (md->chc.buf));

122 
	`XFREE
(
key
);

123  
CRYPT_OK
;

124 
	}
}

132 
	$chc_com´ess
(
hash_¡©e
 *
md
, *
buf
)

134 
T
[2][
MAXBLOCKSIZE
];

135 
symm‘ric_key
 *
key
;

136 
”r
, 
x
;

138 ià((
key
 = 
	`XMALLOC
((*key))è=ğ
NULL
) {

139  
CRYPT_MEM
;

141 ià((
”r
 = 
ch”_desütÜ
[
ch”_idx
].
	`£tup
(
md
->
chc
.
¡©e
, 
ch”_blocksize
, 0, 
key
)è!ğ
CRYPT_OK
) {

142 
	`XFREE
(
key
);

143  
”r
;

145 
	`XMEMCPY
(
T
[1], 
buf
, 
ch”_blocksize
);

146 
ch”_desütÜ
[
ch”_idx
].
	`ecb_’üy±
(
buf
, 
T
[0], 
key
);

147 
x
 = 0; x < 
ch”_blocksize
; x++) {

148 
md
->
chc
.
¡©e
[
x
] ^ğ
T
[0][x] ^ T[1][x];

150 
	`XFREE
(
key
);

151 #ifdeà
LTC_CLEAN_STACK


152 
	`z”omem
(
T
, (T));

153 
	`z”omem
(&
key
, (key));

155  
CRYPT_OK
;

156 
	}
}

159 
_chc_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
buf
, 
Ën
);

160 
HASH_PROCESS
(
_chc_´oûss
, 
chc_com´ess
, 
chc
, ()
ch”_blocksize
)

169 
	$chc_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
)

171 
”r
;

173 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

174 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

177 ià((
”r
 = 
	`ch”_is_v®id
(
ch”_idx
)è!ğ
CRYPT_OK
) {

178  
”r
;

180 ià(
ch”_blocksize
 !ğ
ch”_desütÜ
[
ch”_idx
].
block_Ëngth
) {

181  
CRYPT_INVALID_CIPHER
;

184  
	`_chc_´oûss
(
md
, 
š
, 
šËn
);

185 
	}
}

193 
	$chc_dÚe
(
hash_¡©e
 *
md
, *
out
)

195 
”r
;

197 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

198 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

201 ià((
”r
 = 
	`ch”_is_v®id
(
ch”_idx
)è!ğ
CRYPT_OK
) {

202  
”r
;

204 ià(
ch”_blocksize
 !ğ
ch”_desütÜ
[
ch”_idx
].
block_Ëngth
) {

205  
CRYPT_INVALID_CIPHER
;

208 ià(
md
->
chc
.
cu¾’
 >ğ(md->chc.
buf
)) {

209  
CRYPT_INVALID_ARG
;

213 
md
->
chc
.
Ëngth
 +ğmd->chc.
cu¾’
 * 8;

216 
md
->
chc
.
buf
[md->chc.
cu¾’
++] = ()0x80;

222 ià(
md
->
chc
.
cu¾’
 > ()(
ch”_blocksize
 - 8)) {

223 
md
->
chc
.
cu¾’
 < ()
ch”_blocksize
) {

224 
md
->
chc
.
buf
[md->chc.
cu¾’
++] = ()0;

226 
	`chc_com´ess
(
md
, md->
chc
.
buf
);

227 
md
->
chc
.
cu¾’
 = 0;

231 
md
->
chc
.
cu¾’
 < ()(
ch”_blocksize
 - 8)) {

232 
md
->
chc
.
buf
[md->chc.
cu¾’
++] = ()0;

236 
	`STORE64L
(
md
->
chc
.
Ëngth
, md->chc.
buf
+(
ch”_blocksize
-8));

237 
	`chc_com´ess
(
md
, md->
chc
.
buf
);

240 
	`XMEMCPY
(
out
, 
md
->
chc
.
¡©e
, 
ch”_blocksize
);

242 #ifdeà
LTC_CLEAN_STACK


243 
	`z”omem
(
md
, (
hash_¡©e
));

245  
CRYPT_OK
;

246 
	}
}

252 
	$chc_‹¡
()

255 *
msg
,

256 
md
[
MAXBLOCKSIZE
];

257 
Ën
;

258 } 
‹¡s
[] = {

266 
x
, 
Şdhashidx
, 
idx
;

267 
out
[
MAXBLOCKSIZE
];

268 
hash_¡©e
 
md
;

271 ià((
idx
 = 
	`fšd_ch”
("aes")) == -1) {

272 ià((
idx
 = 
	`fšd_ch”
("rijndael")) == -1) {

273  
CRYPT_NOP
;

276 
Şdhashidx
 = 
ch”_idx
;

277 
	`chc_»gi¡”
(
idx
);

279 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

280 
	`chc_š™
(&
md
);

281 
	`chc_´oûss
(&
md
, 
‹¡s
[
x
].
msg
, 
	`¡¾’
((*)tests[x].msg));

282 
	`chc_dÚe
(&
md
, 
out
);

283 ià(
	`XMEMCMP
(
out
, 
‹¡s
[
x
].
md
,e¡s[x].
Ën
)) {

284  
CRYPT_FAIL_TESTVECTOR
;

287 ià(
Şdhashidx
 !ğ
UNDEFED_HASH
) {

288 
	`chc_»gi¡”
(
Şdhashidx
);

291  
CRYPT_OK
;

292 
	}
}

	@libtomcrypt/src/hashes/helper/hash_file.c

11 
	~"tomüy±.h
"

25 
	$hash_fe
(
hash
, cÚ¡ *
âame
, *
out
, *
ou’
)

27 #ifdeà
LTC_NO_FILE


28  
CRYPT_NOP
;

30 
FILE
 *
š
;

31 
”r
;

32 
	`LTC_ARGCHK
(
âame
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

36 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

37  
”r
;

40 
š
 = 
	`fİ’
(
âame
, "rb");

41 ià(
š
 =ğ
NULL
) {

42  
CRYPT_FILE_NOTFOUND
;

45 
”r
 = 
	`hash_fehªdË
(
hash
, 
š
, 
out
, 
ou’
);

46 ià(
	`fşo£
(
š
) != 0) {

47  
CRYPT_ERROR
;

50  
”r
;

52 
	}
}

	@libtomcrypt/src/hashes/helper/hash_filehandle.c

11 
	~"tomüy±.h
"

26 
	$hash_fehªdË
(
hash
, 
FILE
 *
š
, *
out
, *
ou’
)

28 #ifdeà
LTC_NO_FILE


29  
CRYPT_NOP
;

31 
hash_¡©e
 
md
;

32 
buf
[512];

33 
size_t
 
x
;

34 
”r
;

36 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

40 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

41  
”r
;

44 ià(*
ou’
 < 
hash_desütÜ
[
hash
].
hashsize
) {

45 *
ou’
 = 
hash_desütÜ
[
hash
].
hashsize
;

46  
CRYPT_BUFFER_OVERFLOW
;

48 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`š™
(&
md
)è!ğ
CRYPT_OK
) {

49  
”r
;

52 *
ou’
 = 
hash_desütÜ
[
hash
].
hashsize
;

54 
x
 = 
	`ä—d
(
buf
, 1, (buf), 
š
);

55 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`´oûss
(&
md
, 
buf
, 
x
)è!ğ
CRYPT_OK
) {

56  
”r
;

58 } 
x
 =ğ(
buf
));

59 
”r
 = 
hash_desütÜ
[
hash
].
	`dÚe
(&
md
, 
out
);

61 #ifdeà
LTC_CLEAN_STACK


62 
	`z”omem
(
buf
, (buf));

64  
”r
;

66 
	}
}

	@libtomcrypt/src/hashes/helper/hash_memory.c

11 
	~"tomüy±.h
"

27 
	$hash_memÜy
(
hash
, cÚ¡ *
š
, 
šËn
, *
out
, *
ou’
)

29 
hash_¡©e
 *
md
;

30 
”r
;

32 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

36 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

37  
”r
;

40 ià(*
ou’
 < 
hash_desütÜ
[
hash
].
hashsize
) {

41 *
ou’
 = 
hash_desütÜ
[
hash
].
hashsize
;

42  
CRYPT_BUFFER_OVERFLOW
;

45 
md
 = 
	`XMALLOC
((
hash_¡©e
));

46 ià(
md
 =ğ
NULL
) {

47  
CRYPT_MEM
;

50 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`š™
(
md
)è!ğ
CRYPT_OK
) {

51 
LBL_ERR
;

53 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`´oûss
(
md
, 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

54 
LBL_ERR
;

56 
”r
 = 
hash_desütÜ
[
hash
].
	`dÚe
(
md
, 
out
);

57 *
ou’
 = 
hash_desütÜ
[
hash
].
hashsize
;

58 
LBL_ERR
:

59 #ifdeà
LTC_CLEAN_STACK


60 
	`z”omem
(
md
, (
hash_¡©e
));

62 
	`XFREE
(
md
);

64  
”r
;

65 
	}
}

	@libtomcrypt/src/hashes/helper/hash_memory_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

28 
	$hash_memÜy_muÉi
(
hash
, *
out
, *
ou’
,

29 cÚ¡ *
š
, 
šËn
, ...)

31 
hash_¡©e
 *
md
;

32 
”r
;

33 
va_li¡
 
¬gs
;

34 cÚ¡ *
cu½Œ
;

35 
cu¾’
;

37 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

41 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

42  
”r
;

45 ià(*
ou’
 < 
hash_desütÜ
[
hash
].
hashsize
) {

46 *
ou’
 = 
hash_desütÜ
[
hash
].
hashsize
;

47  
CRYPT_BUFFER_OVERFLOW
;

50 
md
 = 
	`XMALLOC
((
hash_¡©e
));

51 ià(
md
 =ğ
NULL
) {

52  
CRYPT_MEM
;

55 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`š™
(
md
)è!ğ
CRYPT_OK
) {

56 
LBL_ERR
;

59 
	`va_¡¬t
(
¬gs
, 
šËn
);

60 
cu½Œ
 = 
š
;

61 
cu¾’
 = 
šËn
;

64 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`´oûss
(
md
, 
cu½Œ
, 
cu¾’
)è!ğ
CRYPT_OK
) {

65 
LBL_ERR
;

68 
cu½Œ
 = 
	`va_¬g
(
¬gs
, const *);

69 ià(
cu½Œ
 =ğ
NULL
) {

72 
cu¾’
 = 
	`va_¬g
(
¬gs
, );

74 
”r
 = 
hash_desütÜ
[
hash
].
	`dÚe
(
md
, 
out
);

75 *
ou’
 = 
hash_desütÜ
[
hash
].
hashsize
;

76 
LBL_ERR
:

77 #ifdeà
LTC_CLEAN_STACK


78 
	`z”omem
(
md
, (
hash_¡©e
));

80 
	`XFREE
(
md
);

81 
	`va_’d
(
¬gs
);

82  
”r
;

83 
	}
}

	@libtomcrypt/src/hashes/md2.c

11 
	~"tomüy±.h
"

18 #ifdeà
MD2


20 cÚ¡ 
Éc_hash_desütÜ
 
	gmd2_desc
 =

31 &
md2_š™
,

32 &
md2_´oûss
,

33 &
md2_dÚe
,

34 &
md2_‹¡
,

35 
NULL


38 cÚ¡ 
	gPI_SUBST
[256] = {

60 
	$md2_upd©e_chksum
(
hash_¡©e
 *
md
)

62 
j
;

63 
L
;

64 
L
 = 
md
->
md2
.
chksum
[15];

65 
j
 = 0; j < 16; j++) {

70 
L
 = (
md
->
md2
.
chksum
[
j
] ^ğ
PI_SUBST
[()(md->md2.
buf
[j] ^ L)] & 255);

72 
	}
}

74 
	$md2_com´ess
(
hash_¡©e
 *
md
)

76 
j
, 
k
;

77 
t
;

80 
j
 = 0; j < 16; j++) {

81 
md
->
md2
.
X
[16+
j
] = md->md2.
buf
[j];

82 
md
->
md2
.
X
[32+
j
] = md->md2.X[j] ^ md->md2.X[16+j];

85 
t
 = ()0;

88 
j
 = 0; j < 18; j++) {

89 
k
 = 0; k < 48; k++) {

90 
t
 = (
md
->
md2
.
X
[
k
] ^ğ
PI_SUBST
[()(t & 255)]);

92 
t
 = (ˆ+ ()
j
) & 255;

94 
	}
}

101 
	$md2_š™
(
hash_¡©e
 *
md
)

103 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

106 
	`z”omem
(
md
->
md2
.
X
, (md->md2.X));

107 
	`z”omem
(
md
->
md2
.
chksum
, (md->md2.chksum));

108 
	`z”omem
(
md
->
md2
.
buf
, (md->md2.buf));

109 
md
->
md2
.
cu¾’
 = 0;

110  
CRYPT_OK
;

111 
	}
}

120 
	$md2_´oûss
(
hash_¡©e
 *
md
, cÚ¡ *
š
, 
šËn
)

122 
n
;

123 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

124 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

125 ià(
md
-> 
md2
 .
cu¾’
 > (md-> md2 .
buf
)) {

126  
CRYPT_INVALID_ARG
;

128 
šËn
 > 0) {

129 
n
 = 
	`MIN
(
šËn
, (16 - 
md
->
md2
.
cu¾’
));

130 
	`XMEMCPY
(
md
->
md2
.
buf
 + md->md2.
cu¾’
, 
š
, (
size_t
)
n
);

131 
md
->
md2
.
cu¾’
 +ğ
n
;

132 
š
 +ğ
n
;

133 
šËn
 -ğ
n
;

136 ià(
md
->
md2
.
cu¾’
 == 16) {

137 
	`md2_com´ess
(
md
);

138 
	`md2_upd©e_chksum
(
md
);

139 
md
->
md2
.
cu¾’
 = 0;

142  
CRYPT_OK
;

143 
	}
}

151 
	$md2_dÚe
(
hash_¡©e
 * 
md
, *
out
)

153 
i
, 
k
;

155 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

156 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

158 ià(
md
->
md2
.
cu¾’
 >ğ(md->md2.
buf
)) {

159  
CRYPT_INVALID_ARG
;

164 
k
 = 16 - 
md
->
md2
.
cu¾’
;

165 
i
 = 
md
->
md2
.
cu¾’
; i < 16; i++) {

166 
md
->
md2
.
buf
[
i
] = ()
k
;

170 
	`md2_com´ess
(
md
);

171 
	`md2_upd©e_chksum
(
md
);

174 
	`XMEMCPY
(
md
->
md2
.
buf
, md->md2.
chksum
, 16);

175 
	`md2_com´ess
(
md
);

178 
	`XMEMCPY
(
out
, 
md
->
md2
.
X
, 16);

180 #ifdeà
LTC_CLEAN_STACK


181 
	`z”omem
(
md
, (
hash_¡©e
));

183  
CRYPT_OK
;

184 
	}
}

190 
	$md2_‹¡
()

192 #iâdeà
LTC_TEST


193  
CRYPT_NOP
;

196 *
msg
;

197 
md
[16];

198 } 
‹¡s
[] = {

230 
i
;

231 
hash_¡©e
 
md
;

232 
buf
[16];

234 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

235 
	`md2_š™
(&
md
);

236 
	`md2_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

237 
	`md2_dÚe
(&
md
, 
buf
);

238 ià(
	`XMEMCMP
(
buf
, 
‹¡s
[
i
].
md
, 16) != 0) {

239  
CRYPT_FAIL_TESTVECTOR
;

242  
CRYPT_OK
;

244 
	}
}

	@libtomcrypt/src/hashes/md4.c

11 
	~"tomüy±.h
"

18 #ifdeà
MD4


20 cÚ¡ 
Éc_hash_desütÜ
 
	gmd4_desc
 =

31 &
md4_š™
,

32 &
md4_´oûss
,

33 &
md4_dÚe
,

34 &
md4_‹¡
,

35 
NULL


38 
	#S11
 3

	)

39 
	#S12
 7

	)

40 
	#S13
 11

	)

41 
	#S14
 19

	)

42 
	#S21
 3

	)

43 
	#S22
 5

	)

44 
	#S23
 9

	)

45 
	#S24
 13

	)

46 
	#S31
 3

	)

47 
	#S32
 9

	)

48 
	#S33
 11

	)

49 
	#S34
 15

	)

52 
	#F
(
x
, 
y
, 
z
è(z ^ (x & (y ^ z)))

	)

53 
	#G
(
x
, 
y
, 
z
è((x & yè| (z & (x | y)))

	)

54 
	#H
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

57 
	#ROTATE_LEFT
(
x
, 
n
è
	`ROLc
(x,‚)

	)

62 
	#FF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) { \

63 (
a
è+ğ
	`F
 ((
b
), (
c
), (
d
)è+ (
x
); \

64 (
a
èğ
	`ROTATE_LEFT
 (×), (
s
)); \

65 }

	)

66 
	#GG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) { \

67 (
a
è+ğ
	`G
 ((
b
), (
c
), (
d
)è+ (
x
) + 0x5a827999UL; \

68 (
a
èğ
	`ROTATE_LEFT
 (×), (
s
)); \

69 }

	)

70 
	#HH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) { \

71 (
a
è+ğ
	`H
 ((
b
), (
c
), (
d
)è+ (
x
) + 0x6ed9eba1UL; \

72 (
a
èğ
	`ROTATE_LEFT
 (×), (
s
)); \

73 }

	)

75 #ifdeà
LTC_CLEAN_STACK


76 
	$_md4_com´ess
(
hash_¡©e
 *
md
, *
buf
)

78 
	$md4_com´ess
(
hash_¡©e
 *
md
, *
buf
)

81 
ulÚg32
 
x
[16], 
a
, 
b
, 
c
, 
d
;

82 
i
;

85 
a
 = 
md
->
md4
.
¡©e
[0];

86 
b
 = 
md
->
md4
.
¡©e
[1];

87 
c
 = 
md
->
md4
.
¡©e
[2];

88 
d
 = 
md
->
md4
.
¡©e
[3];

91 
i
 = 0; i < 16; i++) {

92 
	`LOAD32L
(
x
[
i
], 
buf
 + (4*i));

96 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[ 0], 
S11
);

97 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[ 1], 
S12
);

98 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[ 2], 
S13
);

99 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[ 3], 
S14
);

100 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[ 4], 
S11
);

101 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[ 5], 
S12
);

102 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[ 6], 
S13
);

103 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[ 7], 
S14
);

104 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[ 8], 
S11
);

105 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[ 9], 
S12
);

106 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[10], 
S13
);

107 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[11], 
S14
);

108 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[12], 
S11
);

109 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[13], 
S12
);

110 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[14], 
S13
);

111 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[15], 
S14
);

114 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[ 0], 
S21
);

115 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[ 4], 
S22
);

116 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[ 8], 
S23
);

117 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[12], 
S24
);

118 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[ 1], 
S21
);

119 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[ 5], 
S22
);

120 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[ 9], 
S23
);

121 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[13], 
S24
);

122 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[ 2], 
S21
);

123 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[ 6], 
S22
);

124 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[10], 
S23
);

125 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[14], 
S24
);

126 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[ 3], 
S21
);

127 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[ 7], 
S22
);

128 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[11], 
S23
);

129 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[15], 
S24
);

132 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[ 0], 
S31
);

133 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[ 8], 
S32
);

134 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[ 4], 
S33
);

135 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[12], 
S34
);

136 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[ 2], 
S31
);

137 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[10], 
S32
);

138 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[ 6], 
S33
);

139 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[14], 
S34
);

140 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[ 1], 
S31
);

141 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[ 9], 
S32
);

142 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[ 5], 
S33
);

143 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[13], 
S34
);

144 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[ 3], 
S31
);

145 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[11], 
S32
);

146 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[ 7], 
S33
);

147 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[15], 
S34
);

151 
md
->
md4
.
¡©e
[0] = md->md4.¡©e[0] + 
a
;

152 
md
->
md4
.
¡©e
[1] = md->md4.¡©e[1] + 
b
;

153 
md
->
md4
.
¡©e
[2] = md->md4.¡©e[2] + 
c
;

154 
md
->
md4
.
¡©e
[3] = md->md4.¡©e[3] + 
d
;

156  
CRYPT_OK
;

157 
	}
}

159 #ifdeà
LTC_CLEAN_STACK


160 
	$md4_com´ess
(
hash_¡©e
 *
md
, *
buf
)

162 
”r
;

163 
”r
 = 
	`_md4_com´ess
(
md
, 
buf
);

164 
	`buº_¡ack
((
ulÚg32
) * 20 + ());

165  
”r
;

166 
	}
}

174 
	$md4_š™
(
hash_¡©e
 * 
md
)

176 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

177 
md
->
md4
.
¡©e
[0] = 0x67452301UL;

178 
md
->
md4
.
¡©e
[1] = 0xefcdab89UL;

179 
md
->
md4
.
¡©e
[2] = 0x98badcfeUL;

180 
md
->
md4
.
¡©e
[3] = 0x10325476UL;

181 
md
->
md4
.
Ëngth
 = 0;

182 
md
->
md4
.
cu¾’
 = 0;

183  
CRYPT_OK
;

184 
	}
}

193 
	$HASH_PROCESS
(
md4_´oûss
, 
md4_com´ess
, 
md4
, 64)

201 
	$md4_dÚe
(
hash_¡©e
 * 
md
, *
out
)

203 
i
;

205 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

206 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

208 ià(
md
->
md4
.
cu¾’
 >ğ(md->md4.
buf
)) {

209  
CRYPT_INVALID_ARG
;

213 
md
->
md4
.
Ëngth
 +ğmd->md4.
cu¾’
 * 8;

216 
md
->
md4
.
buf
[md->md4.
cu¾’
++] = ()0x80;

222 ià(
md
->
md4
.
cu¾’
 > 56) {

223 
md
->
md4
.
cu¾’
 < 64) {

224 
md
->
md4
.
buf
[md->md4.
cu¾’
++] = ()0;

226 
	`md4_com´ess
(
md
, md->
md4
.
buf
);

227 
md
->
md4
.
cu¾’
 = 0;

231 
md
->
md4
.
cu¾’
 < 56) {

232 
md
->
md4
.
buf
[md->md4.
cu¾’
++] = ()0;

236 
	`STORE64L
(
md
->
md4
.
Ëngth
, md->md4.
buf
+56);

237 
	`md4_com´ess
(
md
, md->
md4
.
buf
);

240 
i
 = 0; i < 4; i++) {

241 
	`STORE32L
(
md
->
md4
.
¡©e
[
i
], 
out
+(4*i));

243 #ifdeà
LTC_CLEAN_STACK


244 
	`z”omem
(
md
, (
hash_¡©e
));

246  
CRYPT_OK
;

247 
	}
}

253 
	$md4_‹¡
()

255 #iâdeà
LTC_TEST


256  
CRYPT_NOP
;

258 cÚ¡ 
	smd4_‹¡_ÿ£
 {

259 *
šput
;

260 
dige¡
[16];

261 } 
ÿ£s
[] = {

284 
i
;

285 
hash_¡©e
 
md
;

286 
dige¡
[16];

288 
i
 = 0; i < ()((
ÿ£s
) / (cases[0])); i++) {

289 
	`md4_š™
(&
md
);

290 
	`md4_´oûss
(&
md
, (*)
ÿ£s
[
i
].
šput
, ()
	`¡¾’
(cases[i].input));

291 
	`md4_dÚe
(&
md
, 
dige¡
);

292 ià(
	`XMEMCMP
(
dige¡
, 
ÿ£s
[
i
].digest, 16) != 0) {

293  
CRYPT_FAIL_TESTVECTOR
;

297  
CRYPT_OK
;

299 
	}
}

	@libtomcrypt/src/hashes/md5.c

11 
	~"tomüy±.h
"

19 #ifdeà
MD5


21 cÚ¡ 
Éc_hash_desütÜ
 
	gmd5_desc
 =

32 &
md5_š™
,

33 &
md5_´oûss
,

34 &
md5_dÚe
,

35 &
md5_‹¡
,

36 
NULL


39 
	#F
(
x
,
y
,
z
è(z ^ (x & (y ^ z)))

	)

40 
	#G
(
x
,
y
,
z
è(y ^ (z & (y ^ x)))

	)

41 
	#H
(
x
,
y
,
z
è(x^y^z)

	)

42 
	#I
(
x
,
y
,
z
è(y^(x|(~z)))

	)

44 #ifdeà
LTC_SMALL_CODE


46 
	#FF
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

47 
a
 = (¨+ 
	`F
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROL
×, 
s
è+ b;

	)

49 
	#GG
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

50 
a
 = (¨+ 
	`G
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROL
×, 
s
è+ b;

	)

52 
	#HH
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

53 
a
 = (¨+ 
	`H
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROL
×, 
s
è+ b;

	)

55 
	#II
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

56 
a
 = (¨+ 
	`I
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROL
×, 
s
è+ b;

	)

58 cÚ¡ 
	gWÜd”
[64] = {

65 cÚ¡ 
	gRÜd”
[64] = {

72 cÚ¡ 
ulÚg32
 
	gKÜd”
[64] = {

85 
	#FF
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

86 
a
 = (¨+ 
	`F
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROLc
×, 
s
è+ b;

	)

88 
	#GG
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

89 
a
 = (¨+ 
	`G
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROLc
×, 
s
è+ b;

	)

91 
	#HH
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

92 
a
 = (¨+ 
	`H
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROLc
×, 
s
è+ b;

	)

94 
	#II
(
a
,
b
,
c
,
d
,
M
,
s
,
t
) \

95 
a
 = (¨+ 
	`I
(
b
,
c
,
d
è+ 
M
 + 
t
);‡ = 
	`ROLc
×, 
s
è+ b;

	)

100 #ifdeà
LTC_CLEAN_STACK


101 
	$_md5_com´ess
(
hash_¡©e
 *
md
, *
buf
)

103 
	$md5_com´ess
(
hash_¡©e
 *
md
, *
buf
)

106 
ulÚg32
 
i
, 
W
[16], 
a
, 
b
, 
c
, 
d
;

107 #ifdeà
LTC_SMALL_CODE


108 
ulÚg32
 
t
;

112 
i
 = 0; i < 16; i++) {

113 
	`LOAD32L
(
W
[
i
], 
buf
 + (4*i));

117 
a
 = 
md
->
md5
.
¡©e
[0];

118 
b
 = 
md
->
md5
.
¡©e
[1];

119 
c
 = 
md
->
md5
.
¡©e
[2];

120 
d
 = 
md
->
md5
.
¡©e
[3];

122 #ifdeà
LTC_SMALL_CODE


123 
i
 = 0; i < 16; ++i) {

124 
	`FF
(
a
,
b
,
c
,
d
,
W
[
WÜd”
[
i
]],
RÜd”
[i],
KÜd”
[i]);

125 
t
 = 
d
; d = 
c
; c = 
b
; b = 
a
;‡ =;

128 ; 
i
 < 32; ++i) {

129 
	`GG
(
a
,
b
,
c
,
d
,
W
[
WÜd”
[
i
]],
RÜd”
[i],
KÜd”
[i]);

130 
t
 = 
d
; d = 
c
; c = 
b
; b = 
a
;‡ =;

133 ; 
i
 < 48; ++i) {

134 
	`HH
(
a
,
b
,
c
,
d
,
W
[
WÜd”
[
i
]],
RÜd”
[i],
KÜd”
[i]);

135 
t
 = 
d
; d = 
c
; c = 
b
; b = 
a
;‡ =;

138 ; 
i
 < 64; ++i) {

139 
	`II
(
a
,
b
,
c
,
d
,
W
[
WÜd”
[
i
]],
RÜd”
[i],
KÜd”
[i]);

140 
t
 = 
d
; d = 
c
; c = 
b
; b = 
a
;‡ =;

144 
	`FF
(
a
,
b
,
c
,
d
,
W
[0],7,0xd76aa478UL)

145 
	`FF
(
d
,
a
,
b
,
c
,
W
[1],12,0xe8c7b756UL)

146 
	`FF
(
c
,
d
,
a
,
b
,
W
[2],17,0x242070dbUL)

147 
	`FF
(
b
,
c
,
d
,
a
,
W
[3],22,0xc1bdceeeUL)

148 
	`FF
(
a
,
b
,
c
,
d
,
W
[4],7,0xf57c0fafUL)

149 
	`FF
(
d
,
a
,
b
,
c
,
W
[5],12,0x4787c62aUL)

150 
	`FF
(
c
,
d
,
a
,
b
,
W
[6],17,0xa8304613UL)

151 
	`FF
(
b
,
c
,
d
,
a
,
W
[7],22,0xfd469501UL)

152 
	`FF
(
a
,
b
,
c
,
d
,
W
[8],7,0x698098d8UL)

153 
	`FF
(
d
,
a
,
b
,
c
,
W
[9],12,0x8b44f7afUL)

154 
	`FF
(
c
,
d
,
a
,
b
,
W
[10],17,0xffff5bb1UL)

155 
	`FF
(
b
,
c
,
d
,
a
,
W
[11],22,0x895cd7beUL)

156 
	`FF
(
a
,
b
,
c
,
d
,
W
[12],7,0x6b901122UL)

157 
	`FF
(
d
,
a
,
b
,
c
,
W
[13],12,0xfd987193UL)

158 
	`FF
(
c
,
d
,
a
,
b
,
W
[14],17,0xa679438eUL)

159 
	`FF
(
b
,
c
,
d
,
a
,
W
[15],22,0x49b40821UL)

160 
	`GG
(
a
,
b
,
c
,
d
,
W
[1],5,0xf61e2562UL)

161 
	`GG
(
d
,
a
,
b
,
c
,
W
[6],9,0xc040b340UL)

162 
	`GG
(
c
,
d
,
a
,
b
,
W
[11],14,0x265e5a51UL)

163 
	`GG
(
b
,
c
,
d
,
a
,
W
[0],20,0xe9b6c7aaUL)

164 
	`GG
(
a
,
b
,
c
,
d
,
W
[5],5,0xd62f105dUL)

165 
	`GG
(
d
,
a
,
b
,
c
,
W
[10],9,0x02441453UL)

166 
	`GG
(
c
,
d
,
a
,
b
,
W
[15],14,0xd8a1e681UL)

167 
	`GG
(
b
,
c
,
d
,
a
,
W
[4],20,0xe7d3fbc8UL)

168 
	`GG
(
a
,
b
,
c
,
d
,
W
[9],5,0x21e1cde6UL)

169 
	`GG
(
d
,
a
,
b
,
c
,
W
[14],9,0xc33707d6UL)

170 
	`GG
(
c
,
d
,
a
,
b
,
W
[3],14,0xf4d50d87UL)

171 
	`GG
(
b
,
c
,
d
,
a
,
W
[8],20,0x455a14edUL)

172 
	`GG
(
a
,
b
,
c
,
d
,
W
[13],5,0xa9e3e905UL)

173 
	`GG
(
d
,
a
,
b
,
c
,
W
[2],9,0xfcefa3f8UL)

174 
	`GG
(
c
,
d
,
a
,
b
,
W
[7],14,0x676f02d9UL)

175 
	`GG
(
b
,
c
,
d
,
a
,
W
[12],20,0x8d2a4c8aUL)

176 
	`HH
(
a
,
b
,
c
,
d
,
W
[5],4,0xfffa3942UL)

177 
	`HH
(
d
,
a
,
b
,
c
,
W
[8],11,0x8771f681UL)

178 
	`HH
(
c
,
d
,
a
,
b
,
W
[11],16,0x6d9d6122UL)

179 
	`HH
(
b
,
c
,
d
,
a
,
W
[14],23,0xfde5380cUL)

180 
	`HH
(
a
,
b
,
c
,
d
,
W
[1],4,0xa4beea44UL)

181 
	`HH
(
d
,
a
,
b
,
c
,
W
[4],11,0x4bdecfa9UL)

182 
	`HH
(
c
,
d
,
a
,
b
,
W
[7],16,0xf6bb4b60UL)

183 
	`HH
(
b
,
c
,
d
,
a
,
W
[10],23,0xbebfbc70UL)

184 
	`HH
(
a
,
b
,
c
,
d
,
W
[13],4,0x289b7ec6UL)

185 
	`HH
(
d
,
a
,
b
,
c
,
W
[0],11,0xeaa127faUL)

186 
	`HH
(
c
,
d
,
a
,
b
,
W
[3],16,0xd4ef3085UL)

187 
	`HH
(
b
,
c
,
d
,
a
,
W
[6],23,0x04881d05UL)

188 
	`HH
(
a
,
b
,
c
,
d
,
W
[9],4,0xd9d4d039UL)

189 
	`HH
(
d
,
a
,
b
,
c
,
W
[12],11,0xe6db99e5UL)

190 
	`HH
(
c
,
d
,
a
,
b
,
W
[15],16,0x1fa27cf8UL)

191 
	`HH
(
b
,
c
,
d
,
a
,
W
[2],23,0xc4ac5665UL)

192 
	`II
(
a
,
b
,
c
,
d
,
W
[0],6,0xf4292244UL)

193 
	`II
(
d
,
a
,
b
,
c
,
W
[7],10,0x432aff97UL)

194 
	`II
(
c
,
d
,
a
,
b
,
W
[14],15,0xab9423a7UL)

195 
	`II
(
b
,
c
,
d
,
a
,
W
[5],21,0xfc93a039UL)

196 
	`II
(
a
,
b
,
c
,
d
,
W
[12],6,0x655b59c3UL)

197 
	`II
(
d
,
a
,
b
,
c
,
W
[3],10,0x8f0ccc92UL)

198 
	`II
(
c
,
d
,
a
,
b
,
W
[10],15,0xffeff47dUL)

199 
	`II
(
b
,
c
,
d
,
a
,
W
[1],21,0x85845dd1UL)

200 
	`II
(
a
,
b
,
c
,
d
,
W
[8],6,0x6fa87e4fUL)

201 
	`II
(
d
,
a
,
b
,
c
,
W
[15],10,0xfe2ce6e0UL)

202 
	`II
(
c
,
d
,
a
,
b
,
W
[6],15,0xa3014314UL)

203 
	`II
(
b
,
c
,
d
,
a
,
W
[13],21,0x4e0811a1UL)

204 
	`II
(
a
,
b
,
c
,
d
,
W
[4],6,0xf7537e82UL)

205 
	`II
(
d
,
a
,
b
,
c
,
W
[11],10,0xbd3af235UL)

206 
	`II
(
c
,
d
,
a
,
b
,
W
[2],15,0x2ad7d2bbUL)

207 
	`II
(
b
,
c
,
d
,
a
,
W
[9],21,0xeb86d391UL)

210 
md
->
md5
.
¡©e
[0] = md->md5.¡©e[0] + 
a
;

211 
md
->
md5
.
¡©e
[1] = md->md5.¡©e[1] + 
b
;

212 
md
->
md5
.
¡©e
[2] = md->md5.¡©e[2] + 
c
;

213 
md
->
md5
.
¡©e
[3] = md->md5.¡©e[3] + 
d
;

215  
CRYPT_OK
;

216 
	}
}

218 #ifdeà
LTC_CLEAN_STACK


219 
	$md5_com´ess
(
hash_¡©e
 *
md
, *
buf
)

221 
”r
;

222 
”r
 = 
	`_md5_com´ess
(
md
, 
buf
);

223 
	`buº_¡ack
((
ulÚg32
) * 21);

224  
”r
;

225 
	}
}

233 
	$md5_š™
(
hash_¡©e
 * 
md
)

235 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

236 
md
->
md5
.
¡©e
[0] = 0x67452301UL;

237 
md
->
md5
.
¡©e
[1] = 0xefcdab89UL;

238 
md
->
md5
.
¡©e
[2] = 0x98badcfeUL;

239 
md
->
md5
.
¡©e
[3] = 0x10325476UL;

240 
md
->
md5
.
cu¾’
 = 0;

241 
md
->
md5
.
Ëngth
 = 0;

242  
CRYPT_OK
;

243 
	}
}

252 
	$HASH_PROCESS
(
md5_´oûss
, 
md5_com´ess
, 
md5
, 64)

260 
	$md5_dÚe
(
hash_¡©e
 * 
md
, *
out
)

262 
i
;

264 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

265 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

267 ià(
md
->
md5
.
cu¾’
 >ğ(md->md5.
buf
)) {

268  
CRYPT_INVALID_ARG
;

273 
md
->
md5
.
Ëngth
 +ğmd->md5.
cu¾’
 * 8;

276 
md
->
md5
.
buf
[md->md5.
cu¾’
++] = ()0x80;

282 ià(
md
->
md5
.
cu¾’
 > 56) {

283 
md
->
md5
.
cu¾’
 < 64) {

284 
md
->
md5
.
buf
[md->md5.
cu¾’
++] = ()0;

286 
	`md5_com´ess
(
md
, md->
md5
.
buf
);

287 
md
->
md5
.
cu¾’
 = 0;

291 
md
->
md5
.
cu¾’
 < 56) {

292 
md
->
md5
.
buf
[md->md5.
cu¾’
++] = ()0;

296 
	`STORE64L
(
md
->
md5
.
Ëngth
, md->md5.
buf
+56);

297 
	`md5_com´ess
(
md
, md->
md5
.
buf
);

300 
i
 = 0; i < 4; i++) {

301 
	`STORE32L
(
md
->
md5
.
¡©e
[
i
], 
out
+(4*i));

303 #ifdeà
LTC_CLEAN_STACK


304 
	`z”omem
(
md
, (
hash_¡©e
));

306  
CRYPT_OK
;

307 
	}
}

313 
	$md5_‹¡
()

315 #iâdeà
LTC_TEST


316  
CRYPT_NOP
;

319 *
msg
;

320 
hash
[16];

321 } 
‹¡s
[] = {

343 { 
NULL
, { 0 } }

346 
i
;

347 
tmp
[16];

348 
hash_¡©e
 
md
;

350 
i
 = 0; 
‹¡s
[i].
msg
 !ğ
NULL
; i++) {

351 
	`md5_š™
(&
md
);

352 
	`md5_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

353 
	`md5_dÚe
(&
md
, 
tmp
);

354 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 16) != 0) {

355  
CRYPT_FAIL_TESTVECTOR
;

358  
CRYPT_OK
;

360 
	}
}

	@libtomcrypt/src/hashes/rmd128.c

11 
	~"tomüy±.h
"

24 #ifdeà
RIPEMD128


26 cÚ¡ 
Éc_hash_desütÜ
 
	grmd128_desc
 =

37 &
rmd128_š™
,

38 &
rmd128_´oûss
,

39 &
rmd128_dÚe
,

40 &
rmd128_‹¡
,

41 
NULL


45 
	#F
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

46 
	#G
(
x
, 
y
, 
z
è(((xè& (y)è| (~(xè& (z)))

	)

47 
	#H
(
x
, 
y
, 
z
è(((xè| ~(y)è^ (z))

	)

48 
	#I
(
x
, 
y
, 
z
è(((xè& (z)è| ((yè& ~(z)))

	)

51 
	#FF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

52 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

53 (
a
èğ
	`ROLc
(×), (
s
));

	)

55 
	#GG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

56 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x5a827999UL;\

57 (
a
èğ
	`ROLc
(×), (
s
));

	)

59 
	#HH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

60 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x6ed9eba1UL;\

61 (
a
èğ
	`ROLc
(×), (
s
));

	)

63 
	#II
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

64 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x8f1bbcdcUL;\

65 (
a
èğ
	`ROLc
(×), (
s
));

	)

67 
	#FFF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

68 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

69 (
a
èğ
	`ROLc
(×), (
s
));

	)

71 
	#GGG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

72 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x6d703ef3UL;\

73 (
a
èğ
	`ROLc
(×), (
s
));

	)

75 
	#HHH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

76 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x5c4dd124UL;\

77 (
a
èğ
	`ROLc
(×), (
s
));

	)

79 
	#III
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

80 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x50a28be6UL;\

81 (
a
èğ
	`ROLc
(×), (
s
));

	)

83 #ifdeà
LTC_CLEAN_STACK


84 
	$_rmd128_com´ess
(
hash_¡©e
 *
md
, *
buf
)

86 
	$rmd128_com´ess
(
hash_¡©e
 *
md
, *
buf
)

89 
ulÚg32
 
¯
,
bb
,
cc
,
dd
,
¯a
,
bbb
,
ccc
,
ddd
,
X
[16];

90 
i
;

93 
i
 = 0; i < 16; i++){

94 
	`LOAD32L
(
X
[
i
], 
buf
 + (4 * i));

98 
¯
 = 
¯a
 = 
md
->
rmd128
.
¡©e
[0];

99 
bb
 = 
bbb
 = 
md
->
rmd128
.
¡©e
[1];

100 
cc
 = 
ccc
 = 
md
->
rmd128
.
¡©e
[2];

101 
dd
 = 
ddd
 = 
md
->
rmd128
.
¡©e
[3];

104 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 0], 11);

105 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 1], 14);

106 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 2], 15);

107 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 3], 12);

108 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 4], 5);

109 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 5], 8);

110 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 6], 7);

111 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 7], 9);

112 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 8], 11);

113 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 9], 13);

114 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[10], 14);

115 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[11], 15);

116 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[12], 6);

117 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[13], 7);

118 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[14], 9);

119 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[15], 8);

122 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 7], 7);

123 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 4], 6);

124 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[13], 8);

125 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 1], 13);

126 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[10], 11);

127 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 6], 9);

128 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[15], 7);

129 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 3], 15);

130 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[12], 7);

131 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 0], 12);

132 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 9], 15);

133 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 5], 9);

134 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 2], 11);

135 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[14], 7);

136 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[11], 13);

137 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 8], 12);

140 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 3], 11);

141 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[10], 13);

142 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[14], 6);

143 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 4], 7);

144 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 9], 14);

145 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[15], 9);

146 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 8], 13);

147 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 1], 15);

148 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 2], 14);

149 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 7], 8);

150 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 0], 13);

151 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 6], 6);

152 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[13], 5);

153 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[11], 12);

154 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 5], 7);

155 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[12], 5);

158 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 1], 11);

159 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 9], 12);

160 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[11], 14);

161 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[10], 15);

162 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 0], 14);

163 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 8], 15);

164 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[12], 9);

165 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 4], 8);

166 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[13], 9);

167 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 3], 14);

168 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 7], 5);

169 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[15], 6);

170 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[14], 8);

171 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 5], 6);

172 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 6], 5);

173 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 2], 12);

176 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 5], 8);

177 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[14], 9);

178 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 7], 9);

179 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 0], 11);

180 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 9], 13);

181 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 2], 15);

182 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[11], 15);

183 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 4], 5);

184 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[13], 7);

185 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 6], 7);

186 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[15], 8);

187 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 8], 11);

188 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 1], 14);

189 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[10], 14);

190 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 3], 12);

191 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[12], 6);

194 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 6], 9);

195 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[11], 13);

196 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 3], 15);

197 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 7], 7);

198 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 0], 12);

199 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[13], 8);

200 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 5], 9);

201 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[10], 11);

202 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[14], 7);

203 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[15], 7);

204 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 8], 12);

205 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[12], 7);

206 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 4], 6);

207 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 9], 15);

208 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 1], 13);

209 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 2], 11);

212 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[15], 9);

213 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 5], 7);

214 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 1], 15);

215 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 3], 11);

216 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7], 8);

217 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[14], 6);

218 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 6], 6);

219 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 9], 14);

220 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[11], 12);

221 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 8], 13);

222 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[12], 5);

223 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 2], 14);

224 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[10], 13);

225 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 0], 13);

226 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 4], 7);

227 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[13], 5);

230 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 15);

231 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 6], 5);

232 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 4], 8);

233 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 1], 11);

234 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 3], 14);

235 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[11], 14);

236 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[15], 6);

237 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 0], 14);

238 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 5], 6);

239 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 9);

240 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 2], 12);

241 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[13], 9);

242 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 9], 12);

243 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 7], 5);

244 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[10], 15);

245 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[14], 8);

248 
ddd
 +ğ
cc
 + 
md
->
rmd128
.
¡©e
[1];

249 
md
->
rmd128
.
¡©e
[1] = md->rmd128.¡©e[2] + 
dd
 + 
¯a
;

250 
md
->
rmd128
.
¡©e
[2] = md->rmd128.¡©e[3] + 
¯
 + 
bbb
;

251 
md
->
rmd128
.
¡©e
[3] = md->rmd128.¡©e[0] + 
bb
 + 
ccc
;

252 
md
->
rmd128
.
¡©e
[0] = 
ddd
;

254  
CRYPT_OK
;

255 
	}
}

257 #ifdeà
LTC_CLEAN_STACK


258 
	$rmd128_com´ess
(
hash_¡©e
 *
md
, *
buf
)

260 
”r
;

261 
”r
 = 
	`_rmd128_com´ess
(
md
, 
buf
);

262 
	`buº_¡ack
((
ulÚg32
) * 24 + ());

263  
”r
;

264 
	}
}

272 
	$rmd128_š™
(
hash_¡©e
 * 
md
)

274 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

275 
md
->
rmd128
.
¡©e
[0] = 0x67452301UL;

276 
md
->
rmd128
.
¡©e
[1] = 0xefcdab89UL;

277 
md
->
rmd128
.
¡©e
[2] = 0x98badcfeUL;

278 
md
->
rmd128
.
¡©e
[3] = 0x10325476UL;

279 
md
->
rmd128
.
cu¾’
 = 0;

280 
md
->
rmd128
.
Ëngth
 = 0;

281  
CRYPT_OK
;

282 
	}
}

291 
	$HASH_PROCESS
(
rmd128_´oûss
, 
rmd128_com´ess
, 
rmd128
, 64)

299 
	$rmd128_dÚe
(
hash_¡©e
 * 
md
, *
out
)

301 
i
;

303 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

304 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

306 ià(
md
->
rmd128
.
cu¾’
 >ğ(md->rmd128.
buf
)) {

307  
CRYPT_INVALID_ARG
;

312 
md
->
rmd128
.
Ëngth
 +ğmd->rmd128.
cu¾’
 * 8;

315 
md
->
rmd128
.
buf
[md->rmd128.
cu¾’
++] = ()0x80;

321 ià(
md
->
rmd128
.
cu¾’
 > 56) {

322 
md
->
rmd128
.
cu¾’
 < 64) {

323 
md
->
rmd128
.
buf
[md->rmd128.
cu¾’
++] = ()0;

325 
	`rmd128_com´ess
(
md
, md->
rmd128
.
buf
);

326 
md
->
rmd128
.
cu¾’
 = 0;

330 
md
->
rmd128
.
cu¾’
 < 56) {

331 
md
->
rmd128
.
buf
[md->rmd128.
cu¾’
++] = ()0;

335 
	`STORE64L
(
md
->
rmd128
.
Ëngth
, md->rmd128.
buf
+56);

336 
	`rmd128_com´ess
(
md
, md->
rmd128
.
buf
);

339 
i
 = 0; i < 4; i++) {

340 
	`STORE32L
(
md
->
rmd128
.
¡©e
[
i
], 
out
+(4*i));

342 #ifdeà
LTC_CLEAN_STACK


343 
	`z”omem
(
md
, (
hash_¡©e
));

345  
CRYPT_OK
;

346 
	}
}

352 
	$rmd128_‹¡
()

354 #iâdeà
LTC_TEST


355  
CRYPT_NOP
;

358 *
msg
;

359 
md
[16];

360 } 
‹¡s
[] = {

386 
x
;

387 
buf
[16];

388 
hash_¡©e
 
md
;

390 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

391 
	`rmd128_š™
(&
md
);

392 
	`rmd128_´oûss
(&
md
, (*)
‹¡s
[
x
].
msg
, 
	`¡¾’
(tests[x].msg));

393 
	`rmd128_dÚe
(&
md
, 
buf
);

394 ià(
	`XMEMCMP
(
buf
, 
‹¡s
[
x
].
md
, 16) != 0) {

396 
	`´štf
("Faede¡ %d\n", 
x
);

398  
CRYPT_FAIL_TESTVECTOR
;

401  
CRYPT_OK
;

403 
	}
}

	@libtomcrypt/src/hashes/rmd160.c

11 
	~"tomüy±.h
"

24 #ifdeà
RIPEMD160


26 cÚ¡ 
Éc_hash_desütÜ
 
	grmd160_desc
 =

37 &
rmd160_š™
,

38 &
rmd160_´oûss
,

39 &
rmd160_dÚe
,

40 &
rmd160_‹¡
,

41 
NULL


45 
	#F
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

46 
	#G
(
x
, 
y
, 
z
è(((xè& (y)è| (~(xè& (z)))

	)

47 
	#H
(
x
, 
y
, 
z
è(((xè| ~(y)è^ (z))

	)

48 
	#I
(
x
, 
y
, 
z
è(((xè& (z)è| ((yè& ~(z)))

	)

49 
	#J
(
x
, 
y
, 
z
è((xè^ ((yè| ~(z)))

	)

52 
	#FF
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

53 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

54 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

55 (
c
èğ
	`ROLc
((c), 10);

	)

57 
	#GG
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

58 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x5a827999UL;\

59 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

60 (
c
èğ
	`ROLc
((c), 10);

	)

62 
	#HH
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

63 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x6ed9eba1UL;\

64 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

65 (
c
èğ
	`ROLc
((c), 10);

	)

67 
	#II
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

68 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x8f1bbcdcUL;\

69 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

70 (
c
èğ
	`ROLc
((c), 10);

	)

72 
	#JJ
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

73 (
a
è+ğ
	`J
((
b
), (
c
), (
d
)è+ (
x
) + 0xa953fd4eUL;\

74 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

75 (
c
èğ
	`ROLc
((c), 10);

	)

77 
	#FFF
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

78 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

79 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

80 (
c
èğ
	`ROLc
((c), 10);

	)

82 
	#GGG
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

83 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x7a6d76e9UL;\

84 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

85 (
c
èğ
	`ROLc
((c), 10);

	)

87 
	#HHH
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

88 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x6d703ef3UL;\

89 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

90 (
c
èğ
	`ROLc
((c), 10);

	)

92 
	#III
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

93 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x5c4dd124UL;\

94 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

95 (
c
èğ
	`ROLc
((c), 10);

	)

97 
	#JJJ
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

98 (
a
è+ğ
	`J
((
b
), (
c
), (
d
)è+ (
x
) + 0x50a28be6UL;\

99 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

100 (
c
èğ
	`ROLc
((c), 10);

	)

103 #ifdeà
LTC_CLEAN_STACK


104 
	$_rmd160_com´ess
(
hash_¡©e
 *
md
, *
buf
)

106 
	$rmd160_com´ess
(
hash_¡©e
 *
md
, *
buf
)

109 
ulÚg32
 
¯
,
bb
,
cc
,
dd
,
“
,
¯a
,
bbb
,
ccc
,
ddd
,
“e
,
X
[16];

110 
i
;

113 
i
 = 0; i < 16; i++){

114 
	`LOAD32L
(
X
[
i
], 
buf
 + (4 * i));

118 
¯
 = 
¯a
 = 
md
->
rmd160
.
¡©e
[0];

119 
bb
 = 
bbb
 = 
md
->
rmd160
.
¡©e
[1];

120 
cc
 = 
ccc
 = 
md
->
rmd160
.
¡©e
[2];

121 
dd
 = 
ddd
 = 
md
->
rmd160
.
¡©e
[3];

122 
“
 = 
“e
 = 
md
->
rmd160
.
¡©e
[4];

125 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 0], 11);

126 
	`FF
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 1], 14);

127 
	`FF
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 2], 15);

128 
	`FF
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 3], 12);

129 
	`FF
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 4], 5);

130 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 5], 8);

131 
	`FF
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 6], 7);

132 
	`FF
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 7], 9);

133 
	`FF
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 8], 11);

134 
	`FF
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 9], 13);

135 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[10], 14);

136 
	`FF
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[11], 15);

137 
	`FF
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[12], 6);

138 
	`FF
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[13], 7);

139 
	`FF
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[14], 9);

140 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[15], 8);

143 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 7], 7);

144 
	`GG
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 4], 6);

145 
	`GG
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[13], 8);

146 
	`GG
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 1], 13);

147 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[10], 11);

148 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 6], 9);

149 
	`GG
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[15], 7);

150 
	`GG
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 3], 15);

151 
	`GG
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[12], 7);

152 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 0], 12);

153 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 9], 15);

154 
	`GG
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 5], 9);

155 
	`GG
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 2], 11);

156 
	`GG
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[14], 7);

157 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[11], 13);

158 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 8], 12);

161 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 3], 11);

162 
	`HH
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[10], 13);

163 
	`HH
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[14], 6);

164 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 4], 7);

165 
	`HH
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 9], 14);

166 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[15], 9);

167 
	`HH
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 8], 13);

168 
	`HH
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 1], 15);

169 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 2], 14);

170 
	`HH
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 7], 8);

171 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 0], 13);

172 
	`HH
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 6], 6);

173 
	`HH
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[13], 5);

174 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[11], 12);

175 
	`HH
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 5], 7);

176 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[12], 5);

179 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 1], 11);

180 
	`II
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 9], 12);

181 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[11], 14);

182 
	`II
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[10], 15);

183 
	`II
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 0], 14);

184 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 8], 15);

185 
	`II
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[12], 9);

186 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 4], 8);

187 
	`II
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[13], 9);

188 
	`II
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 3], 14);

189 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 7], 5);

190 
	`II
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[15], 6);

191 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[14], 8);

192 
	`II
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 5], 6);

193 
	`II
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 6], 5);

194 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 2], 12);

197 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 4], 9);

198 
	`JJ
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 0], 15);

199 
	`JJ
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 5], 5);

200 
	`JJ
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 9], 11);

201 
	`JJ
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 7], 6);

202 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[12], 8);

203 
	`JJ
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 2], 13);

204 
	`JJ
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[10], 12);

205 
	`JJ
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[14], 5);

206 
	`JJ
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 1], 12);

207 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 3], 13);

208 
	`JJ
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 8], 14);

209 
	`JJ
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[11], 11);

210 
	`JJ
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 6], 8);

211 
	`JJ
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[15], 5);

212 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[13], 6);

215 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 5], 8);

216 
	`JJJ
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[14], 9);

217 
	`JJJ
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 7], 9);

218 
	`JJJ
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 0], 11);

219 
	`JJJ
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 9], 13);

220 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 2], 15);

221 
	`JJJ
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[11], 15);

222 
	`JJJ
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 4], 5);

223 
	`JJJ
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[13], 7);

224 
	`JJJ
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 6], 7);

225 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[15], 8);

226 
	`JJJ
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 11);

227 
	`JJJ
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 1], 14);

228 
	`JJJ
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[10], 14);

229 
	`JJJ
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 3], 12);

230 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[12], 6);

233 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 6], 9);

234 
	`III
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[11], 13);

235 
	`III
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 3], 15);

236 
	`III
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 7], 7);

237 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 0], 12);

238 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[13], 8);

239 
	`III
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 5], 9);

240 
	`III
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[10], 11);

241 
	`III
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[14], 7);

242 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[15], 7);

243 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 12);

244 
	`III
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 7);

245 
	`III
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 4], 6);

246 
	`III
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 9], 15);

247 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 1], 13);

248 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 2], 11);

251 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[15], 9);

252 
	`HHH
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 5], 7);

253 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 1], 15);

254 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 3], 11);

255 
	`HHH
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7], 8);

256 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[14], 6);

257 
	`HHH
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 6], 6);

258 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 9], 14);

259 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[11], 12);

260 
	`HHH
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 13);

261 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 5);

262 
	`HHH
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 2], 14);

263 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[10], 13);

264 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 0], 13);

265 
	`HHH
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 4], 7);

266 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[13], 5);

269 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 8], 15);

270 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 6], 5);

271 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 4], 8);

272 
	`GGG
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 1], 11);

273 
	`GGG
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 3], 14);

274 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[11], 14);

275 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[15], 6);

276 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 0], 14);

277 
	`GGG
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 5], 6);

278 
	`GGG
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 9);

279 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 2], 12);

280 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[13], 9);

281 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 9], 12);

282 
	`GGG
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7], 5);

283 
	`GGG
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[10], 15);

284 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[14], 8);

287 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[12] , 8);

288 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[15] , 5);

289 
	`FFF
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[10] , 12);

290 
	`FFF
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 4] , 9);

291 
	`FFF
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 1] , 12);

292 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 5] , 5);

293 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 8] , 14);

294 
	`FFF
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7] , 6);

295 
	`FFF
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 6] , 8);

296 
	`FFF
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 2] , 13);

297 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[13] , 6);

298 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[14] , 5);

299 
	`FFF
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 0] , 15);

300 
	`FFF
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 3] , 13);

301 
	`FFF
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 9] , 11);

302 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[11] , 11);

305 
ddd
 +ğ
cc
 + 
md
->
rmd160
.
¡©e
[1];

306 
md
->
rmd160
.
¡©e
[1] = md->rmd160.¡©e[2] + 
dd
 + 
“e
;

307 
md
->
rmd160
.
¡©e
[2] = md->rmd160.¡©e[3] + 
“
 + 
¯a
;

308 
md
->
rmd160
.
¡©e
[3] = md->rmd160.¡©e[4] + 
¯
 + 
bbb
;

309 
md
->
rmd160
.
¡©e
[4] = md->rmd160.¡©e[0] + 
bb
 + 
ccc
;

310 
md
->
rmd160
.
¡©e
[0] = 
ddd
;

312  
CRYPT_OK
;

313 
	}
}

315 #ifdeà
LTC_CLEAN_STACK


316 
	$rmd160_com´ess
(
hash_¡©e
 *
md
, *
buf
)

318 
”r
;

319 
”r
 = 
	`_rmd160_com´ess
(
md
, 
buf
);

320 
	`buº_¡ack
((
ulÚg32
) * 26 + ());

321  
”r
;

322 
	}
}

330 
	$rmd160_š™
(
hash_¡©e
 * 
md
)

332 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

333 
md
->
rmd160
.
¡©e
[0] = 0x67452301UL;

334 
md
->
rmd160
.
¡©e
[1] = 0xefcdab89UL;

335 
md
->
rmd160
.
¡©e
[2] = 0x98badcfeUL;

336 
md
->
rmd160
.
¡©e
[3] = 0x10325476UL;

337 
md
->
rmd160
.
¡©e
[4] = 0xc3d2e1f0UL;

338 
md
->
rmd160
.
cu¾’
 = 0;

339 
md
->
rmd160
.
Ëngth
 = 0;

340  
CRYPT_OK
;

341 
	}
}

350 
	$HASH_PROCESS
(
rmd160_´oûss
, 
rmd160_com´ess
, 
rmd160
, 64)

358 
	$rmd160_dÚe
(
hash_¡©e
 * 
md
, *
out
)

360 
i
;

362 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

363 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

365 ià(
md
->
rmd160
.
cu¾’
 >ğ(md->rmd160.
buf
)) {

366  
CRYPT_INVALID_ARG
;

371 
md
->
rmd160
.
Ëngth
 +ğmd->rmd160.
cu¾’
 * 8;

374 
md
->
rmd160
.
buf
[md->rmd160.
cu¾’
++] = ()0x80;

380 ià(
md
->
rmd160
.
cu¾’
 > 56) {

381 
md
->
rmd160
.
cu¾’
 < 64) {

382 
md
->
rmd160
.
buf
[md->rmd160.
cu¾’
++] = ()0;

384 
	`rmd160_com´ess
(
md
, md->
rmd160
.
buf
);

385 
md
->
rmd160
.
cu¾’
 = 0;

389 
md
->
rmd160
.
cu¾’
 < 56) {

390 
md
->
rmd160
.
buf
[md->rmd160.
cu¾’
++] = ()0;

394 
	`STORE64L
(
md
->
rmd160
.
Ëngth
, md->rmd160.
buf
+56);

395 
	`rmd160_com´ess
(
md
, md->
rmd160
.
buf
);

398 
i
 = 0; i < 5; i++) {

399 
	`STORE32L
(
md
->
rmd160
.
¡©e
[
i
], 
out
+(4*i));

401 #ifdeà
LTC_CLEAN_STACK


402 
	`z”omem
(
md
, (
hash_¡©e
));

404  
CRYPT_OK
;

405 
	}
}

411 
	$rmd160_‹¡
()

413 #iâdeà
LTC_TEST


414  
CRYPT_NOP
;

417 *
msg
;

418 
md
[20];

419 } 
‹¡s
[] = {

445 
x
;

446 
buf
[20];

447 
hash_¡©e
 
md
;

449 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

450 
	`rmd160_š™
(&
md
);

451 
	`rmd160_´oûss
(&
md
, (*)
‹¡s
[
x
].
msg
, 
	`¡¾’
(tests[x].msg));

452 
	`rmd160_dÚe
(&
md
, 
buf
);

453 ià(
	`XMEMCMP
(
buf
, 
‹¡s
[
x
].
md
, 20) != 0) {

455 
	`´štf
("Faede¡ %d\n", 
x
);

457  
CRYPT_FAIL_TESTVECTOR
;

460  
CRYPT_OK
;

462 
	}
}

	@libtomcrypt/src/hashes/rmd256.c

11 
	~"tomüy±.h
"

18 #ifdeà
RIPEMD256


20 cÚ¡ 
Éc_hash_desütÜ
 
	grmd256_desc
 =

31 &
rmd256_š™
,

32 &
rmd256_´oûss
,

33 &
rmd256_dÚe
,

34 &
rmd256_‹¡
,

35 
NULL


39 
	#F
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

40 
	#G
(
x
, 
y
, 
z
è(((xè& (y)è| (~(xè& (z)))

	)

41 
	#H
(
x
, 
y
, 
z
è(((xè| ~(y)è^ (z))

	)

42 
	#I
(
x
, 
y
, 
z
è(((xè& (z)è| ((yè& ~(z)))

	)

45 
	#FF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

46 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

47 (
a
èğ
	`ROLc
(×), (
s
));

	)

49 
	#GG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

50 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x5a827999UL;\

51 (
a
èğ
	`ROLc
(×), (
s
));

	)

53 
	#HH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

54 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x6ed9eba1UL;\

55 (
a
èğ
	`ROLc
(×), (
s
));

	)

57 
	#II
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

58 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x8f1bbcdcUL;\

59 (
a
èğ
	`ROLc
(×), (
s
));

	)

61 
	#FFF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

62 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

63 (
a
èğ
	`ROLc
(×), (
s
));

	)

65 
	#GGG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

66 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x6d703ef3UL;\

67 (
a
èğ
	`ROLc
(×), (
s
));

	)

69 
	#HHH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

70 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x5c4dd124UL;\

71 (
a
èğ
	`ROLc
(×), (
s
));

	)

73 
	#III
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
) \

74 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x50a28be6UL;\

75 (
a
èğ
	`ROLc
(×), (
s
));

	)

77 #ifdeà
LTC_CLEAN_STACK


78 
	$_rmd256_com´ess
(
hash_¡©e
 *
md
, *
buf
)

80 
	$rmd256_com´ess
(
hash_¡©e
 *
md
, *
buf
)

83 
ulÚg32
 
¯
,
bb
,
cc
,
dd
,
¯a
,
bbb
,
ccc
,
ddd
,
tmp
,
X
[16];

84 
i
;

87 
i
 = 0; i < 16; i++){

88 
	`LOAD32L
(
X
[
i
], 
buf
 + (4 * i));

92 
¯
 = 
md
->
rmd256
.
¡©e
[0];

93 
bb
 = 
md
->
rmd256
.
¡©e
[1];

94 
cc
 = 
md
->
rmd256
.
¡©e
[2];

95 
dd
 = 
md
->
rmd256
.
¡©e
[3];

96 
¯a
 = 
md
->
rmd256
.
¡©e
[4];

97 
bbb
 = 
md
->
rmd256
.
¡©e
[5];

98 
ccc
 = 
md
->
rmd256
.
¡©e
[6];

99 
ddd
 = 
md
->
rmd256
.
¡©e
[7];

102 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 0], 11);

103 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 1], 14);

104 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 2], 15);

105 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 3], 12);

106 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 4], 5);

107 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 5], 8);

108 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 6], 7);

109 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 7], 9);

110 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 8], 11);

111 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 9], 13);

112 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[10], 14);

113 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[11], 15);

114 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[12], 6);

115 
	`FF
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[13], 7);

116 
	`FF
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[14], 9);

117 
	`FF
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[15], 8);

120 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 5], 8);

121 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[14], 9);

122 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 7], 9);

123 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 0], 11);

124 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 9], 13);

125 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 2], 15);

126 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[11], 15);

127 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 4], 5);

128 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[13], 7);

129 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 6], 7);

130 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[15], 8);

131 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 8], 11);

132 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 1], 14);

133 
	`III
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[10], 14);

134 
	`III
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 3], 12);

135 
	`III
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[12], 6);

137 
tmp
 = 
¯
;‡¨ğ
¯a
;‡aa =mp;

140 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 7], 7);

141 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 4], 6);

142 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[13], 8);

143 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 1], 13);

144 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[10], 11);

145 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 6], 9);

146 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[15], 7);

147 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 3], 15);

148 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[12], 7);

149 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 0], 12);

150 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 9], 15);

151 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 5], 9);

152 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 2], 11);

153 
	`GG
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[14], 7);

154 
	`GG
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[11], 13);

155 
	`GG
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 8], 12);

158 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 6], 9);

159 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[11], 13);

160 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 3], 15);

161 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 7], 7);

162 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 0], 12);

163 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[13], 8);

164 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 5], 9);

165 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[10], 11);

166 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[14], 7);

167 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[15], 7);

168 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 8], 12);

169 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[12], 7);

170 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 4], 6);

171 
	`HHH
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 9], 15);

172 
	`HHH
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 1], 13);

173 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 2], 11);

175 
tmp
 = 
bb
; bb = 
bbb
; bbb =mp;

178 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 3], 11);

179 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[10], 13);

180 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[14], 6);

181 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 4], 7);

182 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 9], 14);

183 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[15], 9);

184 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 8], 13);

185 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 1], 15);

186 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 2], 14);

187 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 7], 8);

188 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 0], 13);

189 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 6], 6);

190 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[13], 5);

191 
	`HH
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[11], 12);

192 
	`HH
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 5], 7);

193 
	`HH
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[12], 5);

196 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[15], 9);

197 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 5], 7);

198 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 1], 15);

199 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 3], 11);

200 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7], 8);

201 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[14], 6);

202 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 6], 6);

203 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 9], 14);

204 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[11], 12);

205 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 8], 13);

206 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[12], 5);

207 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 2], 14);

208 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[10], 13);

209 
	`GGG
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 0], 13);

210 
	`GGG
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 4], 7);

211 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[13], 5);

213 
tmp
 = 
cc
; cøğ
ccc
; ccc =mp;

216 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 1], 11);

217 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 9], 12);

218 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[11], 14);

219 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[10], 15);

220 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 0], 14);

221 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 8], 15);

222 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[12], 9);

223 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 4], 8);

224 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[13], 9);

225 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 3], 14);

226 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 7], 5);

227 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[15], 6);

228 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
X
[14], 8);

229 
	`II
(
dd
, 
¯
, 
bb
, 
cc
, 
X
[ 5], 6);

230 
	`II
(
cc
, 
dd
, 
¯
, 
bb
, 
X
[ 6], 5);

231 
	`II
(
bb
, 
cc
, 
dd
, 
¯
, 
X
[ 2], 12);

234 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 15);

235 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 6], 5);

236 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 4], 8);

237 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 1], 11);

238 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 3], 14);

239 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[11], 14);

240 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[15], 6);

241 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[ 0], 14);

242 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 5], 6);

243 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 9);

244 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[ 2], 12);

245 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[13], 9);

246 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 9], 12);

247 
	`FFF
(
ddd
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 7], 5);

248 
	`FFF
(
ccc
, 
ddd
, 
¯a
, 
bbb
, 
X
[10], 15);

249 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
¯a
, 
X
[14], 8);

251 
tmp
 = 
dd
; dd = 
ddd
; ddd =mp;

254 
md
->
rmd256
.
¡©e
[0] +ğ
¯
;

255 
md
->
rmd256
.
¡©e
[1] +ğ
bb
;

256 
md
->
rmd256
.
¡©e
[2] +ğ
cc
;

257 
md
->
rmd256
.
¡©e
[3] +ğ
dd
;

258 
md
->
rmd256
.
¡©e
[4] +ğ
¯a
;

259 
md
->
rmd256
.
¡©e
[5] +ğ
bbb
;

260 
md
->
rmd256
.
¡©e
[6] +ğ
ccc
;

261 
md
->
rmd256
.
¡©e
[7] +ğ
ddd
;

263  
CRYPT_OK
;

264 
	}
}

266 #ifdeà
LTC_CLEAN_STACK


267 
	$rmd256_com´ess
(
hash_¡©e
 *
md
, *
buf
)

269 
”r
;

270 
”r
 = 
	`_rmd256_com´ess
(
md
, 
buf
);

271 
	`buº_¡ack
((
ulÚg32
) * 25 + ());

272  
”r
;

273 
	}
}

281 
	$rmd256_š™
(
hash_¡©e
 * 
md
)

283 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

284 
md
->
rmd256
.
¡©e
[0] = 0x67452301UL;

285 
md
->
rmd256
.
¡©e
[1] = 0xefcdab89UL;

286 
md
->
rmd256
.
¡©e
[2] = 0x98badcfeUL;

287 
md
->
rmd256
.
¡©e
[3] = 0x10325476UL;

288 
md
->
rmd256
.
¡©e
[4] = 0x76543210UL;

289 
md
->
rmd256
.
¡©e
[5] = 0xfedcba98UL;

290 
md
->
rmd256
.
¡©e
[6] = 0x89abcdefUL;

291 
md
->
rmd256
.
¡©e
[7] = 0x01234567UL;

292 
md
->
rmd256
.
cu¾’
 = 0;

293 
md
->
rmd256
.
Ëngth
 = 0;

294  
CRYPT_OK
;

295 
	}
}

304 
	$HASH_PROCESS
(
rmd256_´oûss
, 
rmd256_com´ess
, 
rmd256
, 64)

312 
	$rmd256_dÚe
(
hash_¡©e
 * 
md
, *
out
)

314 
i
;

316 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

317 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

319 ià(
md
->
rmd256
.
cu¾’
 >ğ(md->rmd256.
buf
)) {

320  
CRYPT_INVALID_ARG
;

325 
md
->
rmd256
.
Ëngth
 +ğmd->rmd256.
cu¾’
 * 8;

328 
md
->
rmd256
.
buf
[md->rmd256.
cu¾’
++] = ()0x80;

334 ià(
md
->
rmd256
.
cu¾’
 > 56) {

335 
md
->
rmd256
.
cu¾’
 < 64) {

336 
md
->
rmd256
.
buf
[md->rmd256.
cu¾’
++] = ()0;

338 
	`rmd256_com´ess
(
md
, md->
rmd256
.
buf
);

339 
md
->
rmd256
.
cu¾’
 = 0;

343 
md
->
rmd256
.
cu¾’
 < 56) {

344 
md
->
rmd256
.
buf
[md->rmd256.
cu¾’
++] = ()0;

348 
	`STORE64L
(
md
->
rmd256
.
Ëngth
, md->rmd256.
buf
+56);

349 
	`rmd256_com´ess
(
md
, md->
rmd256
.
buf
);

352 
i
 = 0; i < 8; i++) {

353 
	`STORE32L
(
md
->
rmd256
.
¡©e
[
i
], 
out
+(4*i));

355 #ifdeà
LTC_CLEAN_STACK


356 
	`z”omem
(
md
, (
hash_¡©e
));

358  
CRYPT_OK
;

359 
	}
}

365 
	$rmd256_‹¡
()

367 #iâdeà
LTC_TEST


368  
CRYPT_NOP
;

371 *
msg
;

372 
md
[32];

373 } 
‹¡s
[] = {

411 
x
;

412 
buf
[32];

413 
hash_¡©e
 
md
;

415 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

416 
	`rmd256_š™
(&
md
);

417 
	`rmd256_´oûss
(&
md
, (*)
‹¡s
[
x
].
msg
, 
	`¡¾’
(tests[x].msg));

418 
	`rmd256_dÚe
(&
md
, 
buf
);

419 ià(
	`XMEMCMP
(
buf
, 
‹¡s
[
x
].
md
, 32) != 0) {

421 
	`´štf
("Faede¡ %d\n", 
x
);

423  
CRYPT_FAIL_TESTVECTOR
;

426  
CRYPT_OK
;

428 
	}
}

	@libtomcrypt/src/hashes/rmd320.c

11 
	~"tomüy±.h
"

18 #ifdeà
RIPEMD320


20 cÚ¡ 
Éc_hash_desütÜ
 
	grmd320_desc
 =

31 &
rmd320_š™
,

32 &
rmd320_´oûss
,

33 &
rmd320_dÚe
,

34 &
rmd320_‹¡
,

35 
NULL


39 
	#F
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

40 
	#G
(
x
, 
y
, 
z
è(((xè& (y)è| (~(xè& (z)))

	)

41 
	#H
(
x
, 
y
, 
z
è(((xè| ~(y)è^ (z))

	)

42 
	#I
(
x
, 
y
, 
z
è(((xè& (z)è| ((yè& ~(z)))

	)

43 
	#J
(
x
, 
y
, 
z
è((xè^ ((yè| ~(z)))

	)

46 
	#FF
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

47 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

48 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

49 (
c
èğ
	`ROLc
((c), 10);

	)

51 
	#GG
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

52 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x5a827999UL;\

53 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

54 (
c
èğ
	`ROLc
((c), 10);

	)

56 
	#HH
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

57 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x6ed9eba1UL;\

58 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

59 (
c
èğ
	`ROLc
((c), 10);

	)

61 
	#II
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

62 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x8f1bbcdcUL;\

63 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

64 (
c
èğ
	`ROLc
((c), 10);

	)

66 
	#JJ
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

67 (
a
è+ğ
	`J
((
b
), (
c
), (
d
)è+ (
x
) + 0xa953fd4eUL;\

68 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

69 (
c
èğ
	`ROLc
((c), 10);

	)

71 
	#FFF
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

72 (
a
è+ğ
	`F
((
b
), (
c
), (
d
)è+ (
x
);\

73 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

74 (
c
èğ
	`ROLc
((c), 10);

	)

76 
	#GGG
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

77 (
a
è+ğ
	`G
((
b
), (
c
), (
d
)è+ (
x
) + 0x7a6d76e9UL;\

78 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

79 (
c
èğ
	`ROLc
((c), 10);

	)

81 
	#HHH
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

82 (
a
è+ğ
	`H
((
b
), (
c
), (
d
)è+ (
x
) + 0x6d703ef3UL;\

83 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

84 (
c
èğ
	`ROLc
((c), 10);

	)

86 
	#III
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

87 (
a
è+ğ
	`I
((
b
), (
c
), (
d
)è+ (
x
) + 0x5c4dd124UL;\

88 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

89 (
c
èğ
	`ROLc
((c), 10);

	)

91 
	#JJJ
(
a
, 
b
, 
c
, 
d
, 
e
, 
x
, 
s
) \

92 (
a
è+ğ
	`J
((
b
), (
c
), (
d
)è+ (
x
) + 0x50a28be6UL;\

93 (
a
èğ
	`ROLc
(×), (
s
)è+ (
e
);\

94 (
c
èğ
	`ROLc
((c), 10);

	)

97 #ifdeà
LTC_CLEAN_STACK


98 
	$_rmd320_com´ess
(
hash_¡©e
 *
md
, *
buf
)

100 
	$rmd320_com´ess
(
hash_¡©e
 *
md
, *
buf
)

103 
ulÚg32
 
¯
,
bb
,
cc
,
dd
,
“
,
¯a
,
bbb
,
ccc
,
ddd
,
“e
,
tmp
,
X
[16];

104 
i
;

107 
i
 = 0; i < 16; i++){

108 
	`LOAD32L
(
X
[
i
], 
buf
 + (4 * i));

112 
¯
 = 
md
->
rmd320
.
¡©e
[0];

113 
bb
 = 
md
->
rmd320
.
¡©e
[1];

114 
cc
 = 
md
->
rmd320
.
¡©e
[2];

115 
dd
 = 
md
->
rmd320
.
¡©e
[3];

116 
“
 = 
md
->
rmd320
.
¡©e
[4];

117 
¯a
 = 
md
->
rmd320
.
¡©e
[5];

118 
bbb
 = 
md
->
rmd320
.
¡©e
[6];

119 
ccc
 = 
md
->
rmd320
.
¡©e
[7];

120 
ddd
 = 
md
->
rmd320
.
¡©e
[8];

121 
“e
 = 
md
->
rmd320
.
¡©e
[9];

124 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 0], 11);

125 
	`FF
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 1], 14);

126 
	`FF
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 2], 15);

127 
	`FF
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 3], 12);

128 
	`FF
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 4], 5);

129 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 5], 8);

130 
	`FF
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 6], 7);

131 
	`FF
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 7], 9);

132 
	`FF
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 8], 11);

133 
	`FF
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 9], 13);

134 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[10], 14);

135 
	`FF
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[11], 15);

136 
	`FF
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[12], 6);

137 
	`FF
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[13], 7);

138 
	`FF
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[14], 9);

139 
	`FF
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[15], 8);

142 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 5], 8);

143 
	`JJJ
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[14], 9);

144 
	`JJJ
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 7], 9);

145 
	`JJJ
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 0], 11);

146 
	`JJJ
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 9], 13);

147 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 2], 15);

148 
	`JJJ
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[11], 15);

149 
	`JJJ
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 4], 5);

150 
	`JJJ
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[13], 7);

151 
	`JJJ
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 6], 7);

152 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[15], 8);

153 
	`JJJ
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 11);

154 
	`JJJ
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 1], 14);

155 
	`JJJ
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[10], 14);

156 
	`JJJ
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 3], 12);

157 
	`JJJ
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[12], 6);

159 
tmp
 = 
¯
;‡¨ğ
¯a
;‡aa =mp;

162 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 7], 7);

163 
	`GG
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 4], 6);

164 
	`GG
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[13], 8);

165 
	`GG
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 1], 13);

166 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[10], 11);

167 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 6], 9);

168 
	`GG
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[15], 7);

169 
	`GG
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 3], 15);

170 
	`GG
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[12], 7);

171 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 0], 12);

172 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 9], 15);

173 
	`GG
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 5], 9);

174 
	`GG
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 2], 11);

175 
	`GG
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[14], 7);

176 
	`GG
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[11], 13);

177 
	`GG
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 8], 12);

180 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 6], 9);

181 
	`III
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[11], 13);

182 
	`III
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 3], 15);

183 
	`III
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 7], 7);

184 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 0], 12);

185 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[13], 8);

186 
	`III
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 5], 9);

187 
	`III
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[10], 11);

188 
	`III
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[14], 7);

189 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[15], 7);

190 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 12);

191 
	`III
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 7);

192 
	`III
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 4], 6);

193 
	`III
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 9], 15);

194 
	`III
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 1], 13);

195 
	`III
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 2], 11);

197 
tmp
 = 
bb
; bb = 
bbb
; bbb =mp;

200 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 3], 11);

201 
	`HH
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[10], 13);

202 
	`HH
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[14], 6);

203 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 4], 7);

204 
	`HH
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 9], 14);

205 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[15], 9);

206 
	`HH
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 8], 13);

207 
	`HH
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 1], 15);

208 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 2], 14);

209 
	`HH
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 7], 8);

210 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 0], 13);

211 
	`HH
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 6], 6);

212 
	`HH
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[13], 5);

213 
	`HH
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[11], 12);

214 
	`HH
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 5], 7);

215 
	`HH
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[12], 5);

218 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[15], 9);

219 
	`HHH
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 5], 7);

220 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 1], 15);

221 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 3], 11);

222 
	`HHH
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7], 8);

223 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[14], 6);

224 
	`HHH
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 6], 6);

225 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 9], 14);

226 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[11], 12);

227 
	`HHH
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 8], 13);

228 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 5);

229 
	`HHH
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 2], 14);

230 
	`HHH
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[10], 13);

231 
	`HHH
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 0], 13);

232 
	`HHH
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 4], 7);

233 
	`HHH
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[13], 5);

235 
tmp
 = 
cc
; cøğ
ccc
; ccc =mp;

238 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 1], 11);

239 
	`II
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 9], 12);

240 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[11], 14);

241 
	`II
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[10], 15);

242 
	`II
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 0], 14);

243 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 8], 15);

244 
	`II
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[12], 9);

245 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 4], 8);

246 
	`II
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[13], 9);

247 
	`II
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 3], 14);

248 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 7], 5);

249 
	`II
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[15], 6);

250 
	`II
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[14], 8);

251 
	`II
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 5], 6);

252 
	`II
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 6], 5);

253 
	`II
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 2], 12);

256 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 8], 15);

257 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 6], 5);

258 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 4], 8);

259 
	`GGG
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 1], 11);

260 
	`GGG
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 3], 14);

261 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[11], 14);

262 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[15], 6);

263 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 0], 14);

264 
	`GGG
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 5], 6);

265 
	`GGG
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[12], 9);

266 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 2], 12);

267 
	`GGG
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[13], 9);

268 
	`GGG
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 9], 12);

269 
	`GGG
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7], 5);

270 
	`GGG
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[10], 15);

271 
	`GGG
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[14], 8);

273 
tmp
 = 
dd
; dd = 
ddd
; ddd =mp;

276 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 4], 9);

277 
	`JJ
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 0], 15);

278 
	`JJ
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[ 5], 5);

279 
	`JJ
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 9], 11);

280 
	`JJ
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 7], 6);

281 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[12], 8);

282 
	`JJ
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 2], 13);

283 
	`JJ
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[10], 12);

284 
	`JJ
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[14], 5);

285 
	`JJ
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[ 1], 12);

286 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[ 3], 13);

287 
	`JJ
(
¯
, 
bb
, 
cc
, 
dd
, 
“
, 
X
[ 8], 14);

288 
	`JJ
(
“
, 
¯
, 
bb
, 
cc
, 
dd
, 
X
[11], 11);

289 
	`JJ
(
dd
, 
“
, 
¯
, 
bb
, 
cc
, 
X
[ 6], 8);

290 
	`JJ
(
cc
, 
dd
, 
“
, 
¯
, 
bb
, 
X
[15], 5);

291 
	`JJ
(
bb
, 
cc
, 
dd
, 
“
, 
¯
, 
X
[13], 6);

294 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[12] , 8);

295 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[15] , 5);

296 
	`FFF
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[10] , 12);

297 
	`FFF
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 4] , 9);

298 
	`FFF
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 1] , 12);

299 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[ 5] , 5);

300 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[ 8] , 14);

301 
	`FFF
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 7] , 6);

302 
	`FFF
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 6] , 8);

303 
	`FFF
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 2] , 13);

304 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[13] , 6);

305 
	`FFF
(
¯a
, 
bbb
, 
ccc
, 
ddd
, 
“e
, 
X
[14] , 5);

306 
	`FFF
(
“e
, 
¯a
, 
bbb
, 
ccc
, 
ddd
, 
X
[ 0] , 15);

307 
	`FFF
(
ddd
, 
“e
, 
¯a
, 
bbb
, 
ccc
, 
X
[ 3] , 13);

308 
	`FFF
(
ccc
, 
ddd
, 
“e
, 
¯a
, 
bbb
, 
X
[ 9] , 11);

309 
	`FFF
(
bbb
, 
ccc
, 
ddd
, 
“e
, 
¯a
, 
X
[11] , 11);

311 
tmp
 = 
“
;ƒğ
“e
;ƒee =mp;

314 
md
->
rmd320
.
¡©e
[0] +ğ
¯
;

315 
md
->
rmd320
.
¡©e
[1] +ğ
bb
;

316 
md
->
rmd320
.
¡©e
[2] +ğ
cc
;

317 
md
->
rmd320
.
¡©e
[3] +ğ
dd
;

318 
md
->
rmd320
.
¡©e
[4] +ğ
“
;

319 
md
->
rmd320
.
¡©e
[5] +ğ
¯a
;

320 
md
->
rmd320
.
¡©e
[6] +ğ
bbb
;

321 
md
->
rmd320
.
¡©e
[7] +ğ
ccc
;

322 
md
->
rmd320
.
¡©e
[8] +ğ
ddd
;

323 
md
->
rmd320
.
¡©e
[9] +ğ
“e
;

325  
CRYPT_OK
;

326 
	}
}

328 #ifdeà
LTC_CLEAN_STACK


329 
	$rmd320_com´ess
(
hash_¡©e
 *
md
, *
buf
)

331 
”r
;

332 
”r
 = 
	`_rmd320_com´ess
(
md
, 
buf
);

333 
	`buº_¡ack
((
ulÚg32
) * 27 + ());

334  
”r
;

335 
	}
}

343 
	$rmd320_š™
(
hash_¡©e
 * 
md
)

345 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

346 
md
->
rmd320
.
¡©e
[0] = 0x67452301UL;

347 
md
->
rmd320
.
¡©e
[1] = 0xefcdab89UL;

348 
md
->
rmd320
.
¡©e
[2] = 0x98badcfeUL;

349 
md
->
rmd320
.
¡©e
[3] = 0x10325476UL;

350 
md
->
rmd320
.
¡©e
[4] = 0xc3d2e1f0UL;

351 
md
->
rmd320
.
¡©e
[5] = 0x76543210UL;

352 
md
->
rmd320
.
¡©e
[6] = 0xfedcba98UL;

353 
md
->
rmd320
.
¡©e
[7] = 0x89abcdefUL;

354 
md
->
rmd320
.
¡©e
[8] = 0x01234567UL;

355 
md
->
rmd320
.
¡©e
[9] = 0x3c2d1e0fUL;

356 
md
->
rmd320
.
cu¾’
 = 0;

357 
md
->
rmd320
.
Ëngth
 = 0;

358  
CRYPT_OK
;

359 
	}
}

368 
	$HASH_PROCESS
(
rmd320_´oûss
, 
rmd320_com´ess
, 
rmd320
, 64)

376 
	$rmd320_dÚe
(
hash_¡©e
 * 
md
, *
out
)

378 
i
;

380 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

381 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

383 ià(
md
->
rmd320
.
cu¾’
 >ğ(md->rmd320.
buf
)) {

384  
CRYPT_INVALID_ARG
;

389 
md
->
rmd320
.
Ëngth
 +ğmd->rmd320.
cu¾’
 * 8;

392 
md
->
rmd320
.
buf
[md->rmd320.
cu¾’
++] = ()0x80;

398 ià(
md
->
rmd320
.
cu¾’
 > 56) {

399 
md
->
rmd320
.
cu¾’
 < 64) {

400 
md
->
rmd320
.
buf
[md->rmd320.
cu¾’
++] = ()0;

402 
	`rmd320_com´ess
(
md
, md->
rmd320
.
buf
);

403 
md
->
rmd320
.
cu¾’
 = 0;

407 
md
->
rmd320
.
cu¾’
 < 56) {

408 
md
->
rmd320
.
buf
[md->rmd320.
cu¾’
++] = ()0;

412 
	`STORE64L
(
md
->
rmd320
.
Ëngth
, md->rmd320.
buf
+56);

413 
	`rmd320_com´ess
(
md
, md->
rmd320
.
buf
);

416 
i
 = 0; i < 10; i++) {

417 
	`STORE32L
(
md
->
rmd320
.
¡©e
[
i
], 
out
+(4*i));

419 #ifdeà
LTC_CLEAN_STACK


420 
	`z”omem
(
md
, (
hash_¡©e
));

422  
CRYPT_OK
;

423 
	}
}

429 
	$rmd320_‹¡
()

431 #iâdeà
LTC_TEST


432  
CRYPT_NOP
;

435 *
msg
;

436 
md
[40];

437 } 
‹¡s
[] = {

475 
x
;

476 
buf
[40];

477 
hash_¡©e
 
md
;

479 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

480 
	`rmd320_š™
(&
md
);

481 
	`rmd320_´oûss
(&
md
, (*)
‹¡s
[
x
].
msg
, 
	`¡¾’
(tests[x].msg));

482 
	`rmd320_dÚe
(&
md
, 
buf
);

483 ià(
	`XMEMCMP
(
buf
, 
‹¡s
[
x
].
md
, 40) != 0) {

485 
	`´štf
("Faede¡ %d\n", 
x
);

487  
CRYPT_FAIL_TESTVECTOR
;

490  
CRYPT_OK
;

492 
	}
}

	@libtomcrypt/src/hashes/sha1.c

11 
	~"tomüy±.h
"

19 #ifdeà
SHA1


21 cÚ¡ 
Éc_hash_desütÜ
 
	gsha1_desc
 =

32 &
sha1_š™
,

33 &
sha1_´oûss
,

34 &
sha1_dÚe
,

35 &
sha1_‹¡
,

36 
NULL


39 
	#F0
(
x
,
y
,
z
è(z ^ (x & (y ^ z)))

	)

40 
	#F1
(
x
,
y
,
z
è(x ^ y ^ z)

	)

41 
	#F2
(
x
,
y
,
z
è((x & yè| (z & (x | y)))

	)

42 
	#F3
(
x
,
y
,
z
è(x ^ y ^ z)

	)

44 #ifdeà
LTC_CLEAN_STACK


45 
	$_sha1_com´ess
(
hash_¡©e
 *
md
, *
buf
)

47 
	$sha1_com´ess
(
hash_¡©e
 *
md
, *
buf
)

50 
ulÚg32
 
a
,
b
,
c
,
d
,
e
,
W
[80],
i
;

51 #ifdeà
LTC_SMALL_CODE


52 
ulÚg32
 
t
;

56 
i
 = 0; i < 16; i++) {

57 
	`LOAD32H
(
W
[
i
], 
buf
 + (4*i));

61 
a
 = 
md
->
sha1
.
¡©e
[0];

62 
b
 = 
md
->
sha1
.
¡©e
[1];

63 
c
 = 
md
->
sha1
.
¡©e
[2];

64 
d
 = 
md
->
sha1
.
¡©e
[3];

65 
e
 = 
md
->
sha1
.
¡©e
[4];

68 
i
 = 16; i < 80; i++) {

69 
W
[
i
] = 
	`ROL
(W[i-3] ^ W[i-8] ^ W[i-14] ^ W[i-16], 1);

74 
	#FF0
(
a
,
b
,
c
,
d
,
e
,
i
èğ(
	`ROLc
×, 5è+ 
	`F0
(b,c,dè+ƒ + 
W
[i] + 0x5a827999UL); b = ROLc(b, 30);

	)

75 
	#FF1
(
a
,
b
,
c
,
d
,
e
,
i
èğ(
	`ROLc
×, 5è+ 
	`F1
(b,c,dè+ƒ + 
W
[i] + 0x6ed9eba1UL); b = ROLc(b, 30);

	)

76 
	#FF2
(
a
,
b
,
c
,
d
,
e
,
i
èğ(
	`ROLc
×, 5è+ 
	`F2
(b,c,dè+ƒ + 
W
[i] + 0x8f1bbcdcUL); b = ROLc(b, 30);

	)

77 
	#FF3
(
a
,
b
,
c
,
d
,
e
,
i
èğ(
	`ROLc
×, 5è+ 
	`F3
(b,c,dè+ƒ + 
W
[i] + 0xÿ62c1d6UL); b = ROLc(b, 30);

	)

79 #ifdeà
LTC_SMALL_CODE


81 
i
 = 0; i < 20; ) {

82 
	`FF0
(
a
,
b
,
c
,
d
,
e
,
i
++); 
t
 =ƒ;ƒ = d; d = c; c = b; b =‡;‡ =;

85 ; 
i
 < 40; ) {

86 
	`FF1
(
a
,
b
,
c
,
d
,
e
,
i
++); 
t
 =ƒ;ƒ = d; d = c; c = b; b =‡;‡ =;

89 ; 
i
 < 60; ) {

90 
	`FF2
(
a
,
b
,
c
,
d
,
e
,
i
++); 
t
 =ƒ;ƒ = d; d = c; c = b; b =‡;‡ =;

93 ; 
i
 < 80; ) {

94 
	`FF3
(
a
,
b
,
c
,
d
,
e
,
i
++); 
t
 =ƒ;ƒ = d; d = c; c = b; b =‡;‡ =;

99 
i
 = 0; i < 20; ) {

100 
	`FF0
(
a
,
b
,
c
,
d
,
e
,
i
++);

101 
	`FF0
(
e
,
a
,
b
,
c
,
d
,
i
++);

102 
	`FF0
(
d
,
e
,
a
,
b
,
c
,
i
++);

103 
	`FF0
(
c
,
d
,
e
,
a
,
b
,
i
++);

104 
	`FF0
(
b
,
c
,
d
,
e
,
a
,
i
++);

108 ; 
i
 < 40; ) {

109 
	`FF1
(
a
,
b
,
c
,
d
,
e
,
i
++);

110 
	`FF1
(
e
,
a
,
b
,
c
,
d
,
i
++);

111 
	`FF1
(
d
,
e
,
a
,
b
,
c
,
i
++);

112 
	`FF1
(
c
,
d
,
e
,
a
,
b
,
i
++);

113 
	`FF1
(
b
,
c
,
d
,
e
,
a
,
i
++);

117 ; 
i
 < 60; ) {

118 
	`FF2
(
a
,
b
,
c
,
d
,
e
,
i
++);

119 
	`FF2
(
e
,
a
,
b
,
c
,
d
,
i
++);

120 
	`FF2
(
d
,
e
,
a
,
b
,
c
,
i
++);

121 
	`FF2
(
c
,
d
,
e
,
a
,
b
,
i
++);

122 
	`FF2
(
b
,
c
,
d
,
e
,
a
,
i
++);

126 ; 
i
 < 80; ) {

127 
	`FF3
(
a
,
b
,
c
,
d
,
e
,
i
++);

128 
	`FF3
(
e
,
a
,
b
,
c
,
d
,
i
++);

129 
	`FF3
(
d
,
e
,
a
,
b
,
c
,
i
++);

130 
	`FF3
(
c
,
d
,
e
,
a
,
b
,
i
++);

131 
	`FF3
(
b
,
c
,
d
,
e
,
a
,
i
++);

135 #undeà
FF0


136 #undeà
FF1


137 #undeà
FF2


138 #undeà
FF3


141 
md
->
sha1
.
¡©e
[0] = md->sha1.¡©e[0] + 
a
;

142 
md
->
sha1
.
¡©e
[1] = md->sha1.¡©e[1] + 
b
;

143 
md
->
sha1
.
¡©e
[2] = md->sha1.¡©e[2] + 
c
;

144 
md
->
sha1
.
¡©e
[3] = md->sha1.¡©e[3] + 
d
;

145 
md
->
sha1
.
¡©e
[4] = md->sha1.¡©e[4] + 
e
;

147  
CRYPT_OK
;

148 
	}
}

150 #ifdeà
LTC_CLEAN_STACK


151 
	$sha1_com´ess
(
hash_¡©e
 *
md
, *
buf
)

153 
”r
;

154 
”r
 = 
	`_sha1_com´ess
(
md
, 
buf
);

155 
	`buº_¡ack
((
ulÚg32
) * 87);

156  
”r
;

157 
	}
}

165 
	$sha1_š™
(
hash_¡©e
 * 
md
)

167 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

168 
md
->
sha1
.
¡©e
[0] = 0x67452301UL;

169 
md
->
sha1
.
¡©e
[1] = 0xefcdab89UL;

170 
md
->
sha1
.
¡©e
[2] = 0x98badcfeUL;

171 
md
->
sha1
.
¡©e
[3] = 0x10325476UL;

172 
md
->
sha1
.
¡©e
[4] = 0xc3d2e1f0UL;

173 
md
->
sha1
.
cu¾’
 = 0;

174 
md
->
sha1
.
Ëngth
 = 0;

175  
CRYPT_OK
;

176 
	}
}

185 
	$HASH_PROCESS
(
sha1_´oûss
, 
sha1_com´ess
, 
sha1
, 64)

193 
	$sha1_dÚe
(
hash_¡©e
 * 
md
, *
out
)

195 
i
;

197 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

198 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

200 ià(
md
->
sha1
.
cu¾’
 >ğ(md->sha1.
buf
)) {

201  
CRYPT_INVALID_ARG
;

205 
md
->
sha1
.
Ëngth
 +ğmd->sha1.
cu¾’
 * 8;

208 
md
->
sha1
.
buf
[md->sha1.
cu¾’
++] = ()0x80;

214 ià(
md
->
sha1
.
cu¾’
 > 56) {

215 
md
->
sha1
.
cu¾’
 < 64) {

216 
md
->
sha1
.
buf
[md->sha1.
cu¾’
++] = ()0;

218 
	`sha1_com´ess
(
md
, md->
sha1
.
buf
);

219 
md
->
sha1
.
cu¾’
 = 0;

223 
md
->
sha1
.
cu¾’
 < 56) {

224 
md
->
sha1
.
buf
[md->sha1.
cu¾’
++] = ()0;

228 
	`STORE64H
(
md
->
sha1
.
Ëngth
, md->sha1.
buf
+56);

229 
	`sha1_com´ess
(
md
, md->
sha1
.
buf
);

232 
i
 = 0; i < 5; i++) {

233 
	`STORE32H
(
md
->
sha1
.
¡©e
[
i
], 
out
+(4*i));

235 #ifdeà
LTC_CLEAN_STACK


236 
	`z”omem
(
md
, (
hash_¡©e
));

238  
CRYPT_OK
;

239 
	}
}

245 
	$sha1_‹¡
()

247 #iâdeà
LTC_TEST


248  
CRYPT_NOP
;

251 *
msg
;

252 
hash
[20];

253 } 
‹¡s
[] = {

266 
i
;

267 
tmp
[20];

268 
hash_¡©e
 
md
;

270 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

271 
	`sha1_š™
(&
md
);

272 
	`sha1_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

273 
	`sha1_dÚe
(&
md
, 
tmp
);

274 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 20) != 0) {

275  
CRYPT_FAIL_TESTVECTOR
;

278  
CRYPT_OK
;

280 
	}
}

	@libtomcrypt/src/hashes/sha2/sha224.c

16 cÚ¡ 
Éc_hash_desütÜ
 
	gsha224_desc
 =

27 &
sha224_š™
,

28 &
sha256_´oûss
,

29 &
sha224_dÚe
,

30 &
sha224_‹¡
,

31 
NULL


40 
	$sha224_š™
(
hash_¡©e
 * 
md
)

42 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

44 
md
->
sha256
.
cu¾’
 = 0;

45 
md
->
sha256
.
Ëngth
 = 0;

46 
md
->
sha256
.
¡©e
[0] = 0xc1059ed8UL;

47 
md
->
sha256
.
¡©e
[1] = 0x367cd507UL;

48 
md
->
sha256
.
¡©e
[2] = 0x3070dd17UL;

49 
md
->
sha256
.
¡©e
[3] = 0xf70e5939UL;

50 
md
->
sha256
.
¡©e
[4] = 0xffc00b31UL;

51 
md
->
sha256
.
¡©e
[5] = 0x68581511UL;

52 
md
->
sha256
.
¡©e
[6] = 0x64f98fa7UL;

53 
md
->
sha256
.
¡©e
[7] = 0xbefa4fa4UL;

54  
CRYPT_OK
;

55 
	}
}

63 
	$sha224_dÚe
(
hash_¡©e
 * 
md
, *
out
)

65 
buf
[32];

66 
”r
;

68 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

69 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

71 
”r
 = 
	`sha256_dÚe
(
md
, 
buf
);

72 
	`XMEMCPY
(
out
, 
buf
, 28);

73 #ifdeà
LTC_CLEAN_STACK


74 
	`z”omem
(
buf
, (buf));

76  
”r
;

77 
	}
}

83 
	$sha224_‹¡
()

85 #iâdeà
LTC_TEST


86  
CRYPT_NOP
;

89 *
msg
;

90 
hash
[28];

91 } 
‹¡s
[] = {

106 
i
;

107 
tmp
[28];

108 
hash_¡©e
 
md
;

110 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

111 
	`sha224_š™
(&
md
);

112 
	`sha224_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

113 
	`sha224_dÚe
(&
md
, 
tmp
);

114 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 28) != 0) {

115  
CRYPT_FAIL_TESTVECTOR
;

118  
CRYPT_OK
;

120 
	}
}

	@libtomcrypt/src/hashes/sha2/sha256.c

11 
	~"tomüy±.h
"

18 #ifdeà
SHA256


20 cÚ¡ 
Éc_hash_desütÜ
 
	gsha256_desc
 =

31 &
sha256_š™
,

32 &
sha256_´oûss
,

33 &
sha256_dÚe
,

34 &
sha256_‹¡
,

35 
NULL


38 #ifdeà
LTC_SMALL_CODE


40 cÚ¡ 
ulÚg32
 
	gK
[64] = {

58 
	#Ch
(
x
,
y
,
z
è(z ^ (x & (y ^ z)))

	)

59 
	#Maj
(
x
,
y
,
z
è(((x | yè& zè| (x & y))

	)

60 
	#S
(
x
, 
n
è
	`RORc
((x),Ò))

	)

61 
	#R
(
x
, 
n
è(((x)&0xFFFFFFFFUL)>>Ò))

	)

62 
	#Sigma0
(
x
è(
	`S
(x, 2è^ S(x, 13è^ S(x, 22))

	)

63 
	#Sigma1
(
x
è(
	`S
(x, 6è^ S(x, 11è^ S(x, 25))

	)

64 
	#Gamma0
(
x
è(
	`S
(x, 7è^ S(x, 18è^ 
	`R
(x, 3))

	)

65 
	#Gamma1
(
x
è(
	`S
(x, 17è^ S(x, 19è^ 
	`R
(x, 10))

	)

68 #ifdeà
LTC_CLEAN_STACK


69 
	$_sha256_com´ess
(
hash_¡©e
 * 
md
, *
buf
)

71 
	$sha256_com´ess
(
hash_¡©e
 * 
md
, *
buf
)

74 
ulÚg32
 
S
[8], 
W
[64], 
t0
, 
t1
;

75 #ifdeà
LTC_SMALL_CODE


76 
ulÚg32
 
t
;

78 
i
;

81 
i
 = 0; i < 8; i++) {

82 
S
[
i
] = 
md
->
sha256
.
¡©e
[i];

86 
i
 = 0; i < 16; i++) {

87 
	`LOAD32H
(
W
[
i
], 
buf
 + (4*i));

91 
i
 = 16; i < 64; i++) {

92 
W
[
i
] = 
	`Gamma1
(W[˜- 2]è+ W[˜- 7] + 
	`Gamma0
(W[i - 15]) + W[i - 16];

96 #ifdeà
LTC_SMALL_CODE


97 
	#RND
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
i
) \

98 
t0
 = 
h
 + 
	`Sigma1
(
e
è+ 
	`Ch
Ó, 
f
, 
g
è+ 
K
[
i
] + 
W
[i]; \

99 
t1
 = 
	`Sigma0
(
a
è+ 
	`Maj
×, 
b
, 
c
); \

100 
d
 +ğ
t0
; \

101 
h
 = 
t0
 + 
t1
;

	)

103 
i
 = 0; i < 64; ++i) {

104 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],
i
);

105 
t
 = 
S
[7]; S[7] = S[6]; S[6] = S[5]; S[5] = S[4];

106 
S
[4] = S[3]; S[3] = S[2]; S[2] = S[1]; S[1] = S[0]; S[0] = 
t
;

109 
	#RND
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
i
,
ki
) \

110 
t0
 = 
h
 + 
	`Sigma1
(
e
è+ 
	`Ch
Ó, 
f
, 
g
è+ 
ki
 + 
W
[
i
]; \

111 
t1
 = 
	`Sigma0
(
a
è+ 
	`Maj
×, 
b
, 
c
); \

112 
d
 +ğ
t0
; \

113 
h
 = 
t0
 + 
t1
;

	)

115 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],0,0x428a2f98);

116 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],1,0x71374491);

117 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],2,0xb5c0fbcf);

118 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],3,0xe9b5dba5);

119 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],4,0x3956c25b);

120 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],5,0x59f111f1);

121 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],6,0x923f82a4);

122 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],7,0xab1c5ed5);

123 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],8,0xd807aa98);

124 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],9,0x12835b01);

125 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],10,0x243185be);

126 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],11,0x550c7dc3);

127 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],12,0x72be5d74);

128 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],13,0x80deb1fe);

129 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],14,0x9bdc06a7);

130 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],15,0xc19bf174);

131 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],16,0xe49b69c1);

132 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],17,0xefbe4786);

133 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],18,0x0fc19dc6);

134 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],19,0x240ca1cc);

135 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],20,0x2de92c6f);

136 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],21,0x4a7484aa);

137 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],22,0x5cb0a9dc);

138 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],23,0x76f988da);

139 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],24,0x983e5152);

140 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],25,0xa831c66d);

141 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],26,0xb00327c8);

142 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],27,0xbf597fc7);

143 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],28,0xc6e00bf3);

144 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],29,0xd5a79147);

145 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],30,0x06ca6351);

146 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],31,0x14292967);

147 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],32,0x27b70a85);

148 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],33,0x2e1b2138);

149 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],34,0x4d2c6dfc);

150 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],35,0x53380d13);

151 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],36,0x650a7354);

152 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],37,0x766a0abb);

153 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],38,0x81c2c92e);

154 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],39,0x92722c85);

155 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],40,0xa2bfe8a1);

156 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],41,0xa81a664b);

157 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],42,0xc24b8b70);

158 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],43,0xc76c51a3);

159 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],44,0xd192e819);

160 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],45,0xd6990624);

161 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],46,0xf40e3585);

162 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],47,0x106aa070);

163 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],48,0x19a4c116);

164 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],49,0x1e376c08);

165 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],50,0x2748774c);

166 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],51,0x34b0bcb5);

167 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],52,0x391c0cb3);

168 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],53,0x4ed8aa4a);

169 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],54,0x5b9cca4f);

170 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],55,0x682e6ff3);

171 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],56,0x748f82ee);

172 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],57,0x78a5636f);

173 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],58,0x84c87814);

174 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],59,0x8cc70208);

175 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],60,0x90befffa);

176 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],61,0xa4506ceb);

177 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],62,0xbef9a3f7);

178 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],63,0xc67178f2);

180 #undeà
RND


185 
i
 = 0; i < 8; i++) {

186 
md
->
sha256
.
¡©e
[
i
] = md->sha256.¡©e[i] + 
S
[i];

188  
CRYPT_OK
;

189 
	}
}

191 #ifdeà
LTC_CLEAN_STACK


192 
	$sha256_com´ess
(
hash_¡©e
 * 
md
, *
buf
)

194 
”r
;

195 
”r
 = 
	`_sha256_com´ess
(
md
, 
buf
);

196 
	`buº_¡ack
((
ulÚg32
) * 74);

197  
”r
;

198 
	}
}

206 
	$sha256_š™
(
hash_¡©e
 * 
md
)

208 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

210 
md
->
sha256
.
cu¾’
 = 0;

211 
md
->
sha256
.
Ëngth
 = 0;

212 
md
->
sha256
.
¡©e
[0] = 0x6A09E667UL;

213 
md
->
sha256
.
¡©e
[1] = 0xBB67AE85UL;

214 
md
->
sha256
.
¡©e
[2] = 0x3C6EF372UL;

215 
md
->
sha256
.
¡©e
[3] = 0xA54FF53AUL;

216 
md
->
sha256
.
¡©e
[4] = 0x510E527FUL;

217 
md
->
sha256
.
¡©e
[5] = 0x9B05688CUL;

218 
md
->
sha256
.
¡©e
[6] = 0x1F83D9ABUL;

219 
md
->
sha256
.
¡©e
[7] = 0x5BE0CD19UL;

220  
CRYPT_OK
;

221 
	}
}

230 
	$HASH_PROCESS
(
sha256_´oûss
, 
sha256_com´ess
, 
sha256
, 64)

238 
	$sha256_dÚe
(
hash_¡©e
 * 
md
, *
out
)

240 
i
;

242 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

243 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

245 ià(
md
->
sha256
.
cu¾’
 >ğ(md->sha256.
buf
)) {

246  
CRYPT_INVALID_ARG
;

251 
md
->
sha256
.
Ëngth
 +ğmd->sha256.
cu¾’
 * 8;

254 
md
->
sha256
.
buf
[md->sha256.
cu¾’
++] = ()0x80;

260 ià(
md
->
sha256
.
cu¾’
 > 56) {

261 
md
->
sha256
.
cu¾’
 < 64) {

262 
md
->
sha256
.
buf
[md->sha256.
cu¾’
++] = ()0;

264 
	`sha256_com´ess
(
md
, md->
sha256
.
buf
);

265 
md
->
sha256
.
cu¾’
 = 0;

269 
md
->
sha256
.
cu¾’
 < 56) {

270 
md
->
sha256
.
buf
[md->sha256.
cu¾’
++] = ()0;

274 
	`STORE64H
(
md
->
sha256
.
Ëngth
, md->sha256.
buf
+56);

275 
	`sha256_com´ess
(
md
, md->
sha256
.
buf
);

278 
i
 = 0; i < 8; i++) {

279 
	`STORE32H
(
md
->
sha256
.
¡©e
[
i
], 
out
+(4*i));

281 #ifdeà
LTC_CLEAN_STACK


282 
	`z”omem
(
md
, (
hash_¡©e
));

284  
CRYPT_OK
;

285 
	}
}

291 
	$sha256_‹¡
()

293 #iâdeà
LTC_TEST


294  
CRYPT_NOP
;

297 *
msg
;

298 
hash
[32];

299 } 
‹¡s
[] = {

314 
i
;

315 
tmp
[32];

316 
hash_¡©e
 
md
;

318 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

319 
	`sha256_š™
(&
md
);

320 
	`sha256_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

321 
	`sha256_dÚe
(&
md
, 
tmp
);

322 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 32) != 0) {

323  
CRYPT_FAIL_TESTVECTOR
;

326  
CRYPT_OK
;

328 
	}
}

330 #ifdeà
SHA224


331 
	~"sha224.c
"

	@libtomcrypt/src/hashes/sha2/sha384.c

16 cÚ¡ 
Éc_hash_desütÜ
 
	gsha384_desc
 =

27 &
sha384_š™
,

28 &
sha512_´oûss
,

29 &
sha384_dÚe
,

30 &
sha384_‹¡
,

31 
NULL


39 
	$sha384_š™
(
hash_¡©e
 * 
md
)

41 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

43 
md
->
sha512
.
cu¾’
 = 0;

44 
md
->
sha512
.
Ëngth
 = 0;

45 
md
->
sha512
.
¡©e
[0] = 
	`CONST64
(0xcbbb9d5dc1059ed8);

46 
md
->
sha512
.
¡©e
[1] = 
	`CONST64
(0x629a292a367cd507);

47 
md
->
sha512
.
¡©e
[2] = 
	`CONST64
(0x9159015a3070dd17);

48 
md
->
sha512
.
¡©e
[3] = 
	`CONST64
(0x152fecd8f70e5939);

49 
md
->
sha512
.
¡©e
[4] = 
	`CONST64
(0x67332667ffc00b31);

50 
md
->
sha512
.
¡©e
[5] = 
	`CONST64
(0x8eb44a8768581511);

51 
md
->
sha512
.
¡©e
[6] = 
	`CONST64
(0xdb0c2e0d64f98fa7);

52 
md
->
sha512
.
¡©e
[7] = 
	`CONST64
(0x47b5481dbefa4fa4);

53  
CRYPT_OK
;

54 
	}
}

62 
	$sha384_dÚe
(
hash_¡©e
 * 
md
, *
out
)

64 
buf
[64];

66 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

67 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

69 ià(
md
->
sha512
.
cu¾’
 >ğ(md->sha512.
buf
)) {

70  
CRYPT_INVALID_ARG
;

73 
	`sha512_dÚe
(
md
, 
buf
);

74 
	`XMEMCPY
(
out
, 
buf
, 48);

75 #ifdeà
LTC_CLEAN_STACK


76 
	`z”omem
(
buf
, (buf));

78  
CRYPT_OK
;

79 
	}
}

85 
	$sha384_‹¡
()

87 #iâdeà
LTC_TEST


88  
CRYPT_NOP
;

91 *
msg
;

92 
hash
[48];

93 } 
‹¡s
[] = {

112 
i
;

113 
tmp
[48];

114 
hash_¡©e
 
md
;

116 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

117 
	`sha384_š™
(&
md
);

118 
	`sha384_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

119 
	`sha384_dÚe
(&
md
, 
tmp
);

120 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 48) != 0) {

121  
CRYPT_FAIL_TESTVECTOR
;

124  
CRYPT_OK
;

126 
	}
}

	@libtomcrypt/src/hashes/sha2/sha512.c

11 
	~"tomüy±.h
"

18 #ifdeà
SHA512


20 cÚ¡ 
Éc_hash_desütÜ
 
	gsha512_desc
 =

31 &
sha512_š™
,

32 &
sha512_´oûss
,

33 &
sha512_dÚe
,

34 &
sha512_‹¡
,

35 
NULL


39 cÚ¡ 
ulÚg64
 
	gK
[80] = {

40 
CONST64
(0x428a2f98d728ae22), CONST64(0x7137449123ef65cd),

41 
CONST64
(0xb5c0fbcfec4d3b2f), CONST64(0xe9b5dba58189dbbc),

42 
CONST64
(0x3956c25bf348b538), CONST64(0x59f111f1b605d019),

43 
CONST64
(0x923f82a4af194f9b), CONST64(0xab1c5ed5da6d8118),

44 
CONST64
(0xd807aa98a3030242), CONST64(0x12835b0145706fbe),

45 
CONST64
(0x243185be4ee4b28c), CONST64(0x550c7dc3d5ffb4e2),

46 
CONST64
(0x72be5d74f27b896f), CONST64(0x80deb1fe3b1696b1),

47 
CONST64
(0x9bdc06a725c71235), CONST64(0xc19bf174cf692694),

48 
CONST64
(0xe49b69c19ef14ad2), CONST64(0xefbe4786384f25e3),

49 
CONST64
(0x0fc19dc68b8cd5b5), CONST64(0x240ca1cc77ac9c65),

50 
CONST64
(0x2de92c6f592b0275), CONST64(0x4a7484aa6ea6e483),

51 
CONST64
(0x5cb0a9dcbd41fbd4), CONST64(0x76f988da831153b5),

52 
CONST64
(0x983e5152ee66dfab), CONST64(0xa831c66d2db43210),

53 
CONST64
(0xb00327c898fb213f), CONST64(0xbf597fc7beef0ee4),

54 
CONST64
(0xc6e00bf33da88fc2), CONST64(0xd5a79147930aa725),

55 
CONST64
(0x06ca6351e003826f), CONST64(0x142929670a0e6e70),

56 
CONST64
(0x27b70a8546d22ffc), CONST64(0x2e1b21385c26c926),

57 
CONST64
(0x4d2c6dfc5ac42aed), CONST64(0x53380d139d95b3df),

58 
CONST64
(0x650a73548baf63de), CONST64(0x766a0abb3c77b2a8),

59 
CONST64
(0x81c2c92e47edaee6), CONST64(0x92722c851482353b),

60 
CONST64
(0xa2bfe8a14cf10364), CONST64(0xa81a664bbc423001),

61 
CONST64
(0xc24b8b70d0f89791), CONST64(0xc76c51a30654be30),

62 
CONST64
(0xd192e819d6ef5218), CONST64(0xd69906245565a910),

63 
CONST64
(0xf40e35855771202a), CONST64(0x106aa07032bbd1b8),

64 
CONST64
(0x19a4c116b8d2d0c8), CONST64(0x1e376c085141ab53),

65 
CONST64
(0x2748774cdf8eeb99), CONST64(0x34b0bcb5e19b48a8),

66 
CONST64
(0x391c0cb3c5c95a63), CONST64(0x4ed8aa4ae3418acb),

67 
CONST64
(0x5b9cca4f7763e373), CONST64(0x682e6ff3d6b2b8a3),

68 
CONST64
(0x748f82ee5defb2fc), CONST64(0x78a5636f43172f60),

69 
CONST64
(0x84c87814a1f0ab72), CONST64(0x8cc702081a6439ec),

70 
CONST64
(0x90befffa23631e28), CONST64(0xa4506cebde82bde9),

71 
CONST64
(0xbef9a3f7b2c67915), CONST64(0xc67178f2e372532b),

72 
CONST64
(0xca273eceea26619c), CONST64(0xd186b8c721c0c207),

73 
CONST64
(0xeada7dd6cde0eb1e), CONST64(0xf57d4f7fee6ed178),

74 
CONST64
(0x06f067aa72176fba), CONST64(0x0a637dc5a2c898a6),

75 
CONST64
(0x113f9804bef90dae), CONST64(0x1b710b35131c471b),

76 
CONST64
(0x28db77f523047d84), CONST64(0x32caab7b40c72493),

77 
CONST64
(0x3c9ebe0a15c9bebc), CONST64(0x431d67c49c100d4c),

78 
CONST64
(0x4cc5d4becb3e42b6), CONST64(0x597f299cfc657e2a),

79 
CONST64
(0x5fcb6fab3ad6faec), CONST64(0x6c44198c4a475817)

83 
	#Ch
(
x
,
y
,
z
è(z ^ (x & (y ^ z)))

	)

84 
	#Maj
(
x
,
y
,
z
è(((x | yè& zè| (x & y))

	)

85 
	#S
(
x
, 
n
è
	`ROR64c
(x,‚)

	)

86 
	#R
(
x
, 
n
è(((x)&
	`CONST64
(0xFFFFFFFFFFFFFFFF))>>((
ulÚg64
ê))

	)

87 
	#Sigma0
(
x
è(
	`S
(x, 28è^ S(x, 34è^ S(x, 39))

	)

88 
	#Sigma1
(
x
è(
	`S
(x, 14è^ S(x, 18è^ S(x, 41))

	)

89 
	#Gamma0
(
x
è(
	`S
(x, 1è^ S(x, 8è^ 
	`R
(x, 7))

	)

90 
	#Gamma1
(
x
è(
	`S
(x, 19è^ S(x, 61è^ 
	`R
(x, 6))

	)

93 #ifdeà
LTC_CLEAN_STACK


94 
	$_sha512_com´ess
(
hash_¡©e
 * 
md
, *
buf
)

96 
	$sha512_com´ess
(
hash_¡©e
 * 
md
, *
buf
)

99 
ulÚg64
 
S
[8], 
W
[80], 
t0
, 
t1
;

100 
i
;

103 
i
 = 0; i < 8; i++) {

104 
S
[
i
] = 
md
->
sha512
.
¡©e
[i];

108 
i
 = 0; i < 16; i++) {

109 
	`LOAD64H
(
W
[
i
], 
buf
 + (8*i));

113 
i
 = 16; i < 80; i++) {

114 
W
[
i
] = 
	`Gamma1
(W[˜- 2]è+ W[˜- 7] + 
	`Gamma0
(W[i - 15]) + W[i - 16];

118 #ifdeà
LTC_SMALL_CODE


119 
i
 = 0; i < 80; i++) {

120 
t0
 = 
S
[7] + 
	`Sigma1
(S[4]è+ 
	`Ch
(S[4], S[5], S[6]è+ 
K
[
i
] + 
W
[i];

121 
t1
 = 
	`Sigma0
(
S
[0]è+ 
	`Maj
(S[0], S[1], S[2]);

122 
S
[7] = S[6];

123 
S
[6] = S[5];

124 
S
[5] = S[4];

125 
S
[4] = S[3] + 
t0
;

126 
S
[3] = S[2];

127 
S
[2] = S[1];

128 
S
[1] = S[0];

129 
S
[0] = 
t0
 + 
t1
;

132 
	#RND
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
i
) \

133 
t0
 = 
h
 + 
	`Sigma1
(
e
è+ 
	`Ch
Ó, 
f
, 
g
è+ 
K
[
i
] + 
W
[i]; \

134 
t1
 = 
	`Sigma0
(
a
è+ 
	`Maj
×, 
b
, 
c
); \

135 
d
 +ğ
t0
; \

136 
h
 = 
t0
 + 
t1
;

	)

138 
i
 = 0; i < 80; i += 8) {

139 
	`RND
(
S
[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],
i
+0);

140 
	`RND
(
S
[7],S[0],S[1],S[2],S[3],S[4],S[5],S[6],
i
+1);

141 
	`RND
(
S
[6],S[7],S[0],S[1],S[2],S[3],S[4],S[5],
i
+2);

142 
	`RND
(
S
[5],S[6],S[7],S[0],S[1],S[2],S[3],S[4],
i
+3);

143 
	`RND
(
S
[4],S[5],S[6],S[7],S[0],S[1],S[2],S[3],
i
+4);

144 
	`RND
(
S
[3],S[4],S[5],S[6],S[7],S[0],S[1],S[2],
i
+5);

145 
	`RND
(
S
[2],S[3],S[4],S[5],S[6],S[7],S[0],S[1],
i
+6);

146 
	`RND
(
S
[1],S[2],S[3],S[4],S[5],S[6],S[7],S[0],
i
+7);

152 
i
 = 0; i < 8; i++) {

153 
md
->
sha512
.
¡©e
[
i
] = md->sha512.¡©e[i] + 
S
[i];

156  
CRYPT_OK
;

157 
	}
}

160 #ifdeà
LTC_CLEAN_STACK


161 
	$sha512_com´ess
(
hash_¡©e
 * 
md
, *
buf
)

163 
”r
;

164 
”r
 = 
	`_sha512_com´ess
(
md
, 
buf
);

165 
	`buº_¡ack
((
ulÚg64
) * 90 + ());

166  
”r
;

167 
	}
}

175 
	$sha512_š™
(
hash_¡©e
 * 
md
)

177 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

178 
md
->
sha512
.
cu¾’
 = 0;

179 
md
->
sha512
.
Ëngth
 = 0;

180 
md
->
sha512
.
¡©e
[0] = 
	`CONST64
(0x6a09e667f3bcc908);

181 
md
->
sha512
.
¡©e
[1] = 
	`CONST64
(0xbb67ae8584caa73b);

182 
md
->
sha512
.
¡©e
[2] = 
	`CONST64
(0x3c6ef372fe94f82b);

183 
md
->
sha512
.
¡©e
[3] = 
	`CONST64
(0xa54ff53a5f1d36f1);

184 
md
->
sha512
.
¡©e
[4] = 
	`CONST64
(0x510e527fade682d1);

185 
md
->
sha512
.
¡©e
[5] = 
	`CONST64
(0x9b05688c2b3e6c1f);

186 
md
->
sha512
.
¡©e
[6] = 
	`CONST64
(0x1f83d9abfb41bd6b);

187 
md
->
sha512
.
¡©e
[7] = 
	`CONST64
(0x5be0cd19137e2179);

188  
CRYPT_OK
;

189 
	}
}

198 
	$HASH_PROCESS
(
sha512_´oûss
, 
sha512_com´ess
, 
sha512
, 128)

206 
	$sha512_dÚe
(
hash_¡©e
 * 
md
, *
out
)

208 
i
;

210 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

211 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

213 ià(
md
->
sha512
.
cu¾’
 >ğ(md->sha512.
buf
)) {

214  
CRYPT_INVALID_ARG
;

218 
md
->
sha512
.
Ëngth
 +ğmd->sha512.
cu¾’
 * 
	`CONST64
(8);

221 
md
->
sha512
.
buf
[md->sha512.
cu¾’
++] = ()0x80;

227 ià(
md
->
sha512
.
cu¾’
 > 112) {

228 
md
->
sha512
.
cu¾’
 < 128) {

229 
md
->
sha512
.
buf
[md->sha512.
cu¾’
++] = ()0;

231 
	`sha512_com´ess
(
md
, md->
sha512
.
buf
);

232 
md
->
sha512
.
cu¾’
 = 0;

239 
md
->
sha512
.
cu¾’
 < 120) {

240 
md
->
sha512
.
buf
[md->sha512.
cu¾’
++] = ()0;

244 
	`STORE64H
(
md
->
sha512
.
Ëngth
, md->sha512.
buf
+120);

245 
	`sha512_com´ess
(
md
, md->
sha512
.
buf
);

248 
i
 = 0; i < 8; i++) {

249 
	`STORE64H
(
md
->
sha512
.
¡©e
[
i
], 
out
+(8*i));

251 #ifdeà
LTC_CLEAN_STACK


252 
	`z”omem
(
md
, (
hash_¡©e
));

254  
CRYPT_OK
;

255 
	}
}

261 
	$sha512_‹¡
()

263 #iâdeà
LTC_TEST


264  
CRYPT_NOP
;

267 *
msg
;

268 
hash
[64];

269 } 
‹¡s
[] = {

292 
i
;

293 
tmp
[64];

294 
hash_¡©e
 
md
;

296 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

297 
	`sha512_š™
(&
md
);

298 
	`sha512_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

299 
	`sha512_dÚe
(&
md
, 
tmp
);

300 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 64) != 0) {

301  
CRYPT_FAIL_TESTVECTOR
;

304  
CRYPT_OK
;

306 
	}
}

308 #ifdeà
SHA384


309 
	~"sha384.c
"

	@libtomcrypt/src/hashes/tiger.c

12 
	~"tomüy±.h
"

19 #ifdeà
TIGER


21 cÚ¡ 
Éc_hash_desütÜ
 
	gtig”_desc
 =

32 &
tig”_š™
,

33 &
tig”_´oûss
,

34 &
tig”_dÚe
,

35 &
tig”_‹¡
,

36 
NULL


39 
	#t1
 (
bË
)

	)

40 
	#t2
 (
bË
+256)

	)

41 
	#t3
 (
bË
+256*2)

	)

42 
	#t4
 (
bË
+256*3)

	)

44 cÚ¡ 
ulÚg64
 
	gbË
[4*256] = {

45 
CONST64
(0x02AAB17CF7E90C5E) , CONST64(0xAC424B03E243A8EC) ,

46 
CONST64
(0x72CD5BE30DD5FCD3) , CONST64(0x6D019B93F6F97F3A) ,

47 
CONST64
(0xCD9978FFD21F9193) , CONST64(0x7573A1C9708029E2) ,

48 
CONST64
(0xB164326B922A83C3) , CONST64(0x46883EEE04915870) ,

49 
CONST64
(0xEAACE3057103ECE6) , CONST64(0xC54169B808A3535C) ,

50 
CONST64
(0x4CE754918DDEC47C) , CONST64(0x0AA2F4DFDC0DF40C) ,

51 
CONST64
(0x10B76F18A74DBEFA) , CONST64(0xC6CCB6235AD1AB6A) ,

52 
CONST64
(0x13726121572FE2FF) , CONST64(0x1A488C6F199D921E) ,

53 
CONST64
(0x4BC9F9F4DA0007CA) , CONST64(0x26F5E6F6E85241C7) ,

54 
CONST64
(0x859079DBEA5947B6) , CONST64(0x4F1885C5C99E8C92) ,

55 
CONST64
(0xD78E761EA96F864B) , CONST64(0x8E36428C52B5C17D) ,

56 
CONST64
(0x69CF6827373063C1) , CONST64(0xB607C93D9BB4C56E) ,

57 
CONST64
(0x7D820E760E76B5EA) , CONST64(0x645C9CC6F07FDC42) ,

58 
CONST64
(0xBF38A078243342E0) , CONST64(0x5F6B343C9D2E7D04) ,

59 
CONST64
(0xF2C28AEB600B0EC6) , CONST64(0x6C0ED85F7254BCAC) ,

60 
CONST64
(0x71592281A4DB4FE5) , CONST64(0x1967FA69CE0FED9F) ,

61 
CONST64
(0xFD5293F8B96545DB) , CONST64(0xC879E9D7F2A7600B) ,

62 
CONST64
(0x860248920193194E) , CONST64(0xA4F9533B2D9CC0B3) ,

63 
CONST64
(0x9053836C15957613) , CONST64(0xDB6DCF8AFC357BF1) ,

64 
CONST64
(0x18BEEA7A7A370F57) , CONST64(0x037117CA50B99066) ,

65 
CONST64
(0x6AB30A9774424A35) , CONST64(0xF4E92F02E325249B) ,

66 
CONST64
(0x7739DB07061CCAE1) , CONST64(0xD8F3B49CECA42A05) ,

67 
CONST64
(0xBD56BE3F51382F73) , CONST64(0x45FAED5843B0BB28) ,

68 
CONST64
(0x1C813D5C11BF1F83) , CONST64(0x8AF0E4B6D75FA169) ,

69 
CONST64
(0x33EE18A487AD9999) , CONST64(0x3C26E8EAB1C94410) ,

70 
CONST64
(0xB510102BC0A822F9) , CONST64(0x141EEF310CE6123B) ,

71 
CONST64
(0xFC65B90059DDB154) , CONST64(0xE0158640C5E0E607) ,

72 
CONST64
(0x884E079826C3A3CF) , CONST64(0x930D0D9523C535FD) ,

73 
CONST64
(0x35638D754E9A2B00) , CONST64(0x4085FCCF40469DD5) ,

74 
CONST64
(0xC4B17AD28BE23A4C) , CONST64(0xCAB2F0FC6A3E6A2E) ,

75 
CONST64
(0x2860971A6B943FCD) , CONST64(0x3DDE6EE212E30446) ,

76 
CONST64
(0x6222F32AE01765AE) , CONST64(0x5D550BB5478308FE) ,

77 
CONST64
(0xA9EFA98DA0EDA22A) , CONST64(0xC351A71686C40DA7) ,

78 
CONST64
(0x1105586D9C867C84) , CONST64(0xDCFFEE85FDA22853) ,

79 
CONST64
(0xCCFBD0262C5EEF76) , CONST64(0xBAF294CB8990D201) ,

80 
CONST64
(0xE69464F52AFAD975) , CONST64(0x94B013AFDF133E14) ,

81 
CONST64
(0x06A7D1A32823C958) , CONST64(0x6F95FE5130F61119) ,

82 
CONST64
(0xD92AB34E462C06C0) , CONST64(0xED7BDE33887C71D2) ,

83 
CONST64
(0x79746D6E6518393E) , CONST64(0x5BA419385D713329) ,

84 
CONST64
(0x7C1BA6B948A97564) , CONST64(0x31987C197BFDAC67) ,

85 
CONST64
(0xDE6C23C44B053D02) , CONST64(0x581C49FED002D64D) ,

86 
CONST64
(0xDD474D6338261571) , CONST64(0xAA4546C3E473D062) ,

87 
CONST64
(0x928FCE349455F860) , CONST64(0x48161BBACAAB94D9) ,

88 
CONST64
(0x63912430770E6F68) , CONST64(0x6EC8A5E602C6641C) ,

89 
CONST64
(0x87282515337DDD2B) , CONST64(0x2CDA6B42034B701B) ,

90 
CONST64
(0xB03D37C181CB096D) , CONST64(0xE108438266C71C6F) ,

91 
CONST64
(0x2B3180C7EB51B255) , CONST64(0xDF92B82F96C08BBC) ,

92 
CONST64
(0x5C68C8C0A632F3BA) , CONST64(0x5504CC861C3D0556) ,

93 
CONST64
(0xABBFA4E55FB26B8F) , CONST64(0x41848B0AB3BACEB4) ,

94 
CONST64
(0xB334A273AA445D32) , CONST64(0xBCA696F0A85AD881) ,

95 
CONST64
(0x24F6EC65B528D56C) , CONST64(0x0CE1512E90F4524A) ,

96 
CONST64
(0x4E9DD79D5506D35A) , CONST64(0x258905FAC6CE9779) ,

97 
CONST64
(0x2019295B3E109B33) , CONST64(0xF8A9478B73A054CC) ,

98 
CONST64
(0x2924F2F934417EB0) , CONST64(0x3993357D536D1BC4) ,

99 
CONST64
(0x38A81AC21DB6FF8B) , CONST64(0x47C4FBF17D6016BF) ,

100 
CONST64
(0x1E0FAADD7667E3F5) , CONST64(0x7ABCFF62938BEB96) ,

101 
CONST64
(0xA78DAD948FC179C9) , CONST64(0x8F1F98B72911E50D) ,

102 
CONST64
(0x61E48EAE27121A91) , CONST64(0x4D62F7AD31859808) ,

103 
CONST64
(0xECEBA345EF5CEAEB) , CONST64(0xF5CEB25EBC9684CE) ,

104 
CONST64
(0xF633E20CB7F76221) , CONST64(0xA32CDF06AB8293E4) ,

105 
CONST64
(0x985A202CA5EE2CA4) , CONST64(0xCF0B8447CC8A8FB1) ,

106 
CONST64
(0x9F765244979859A3) , CONST64(0xA8D516B1A1240017) ,

107 
CONST64
(0x0BD7BA3EBB5DC726) , CONST64(0xE54BCA55B86ADB39) ,

108 
CONST64
(0x1D7A3AFD6C478063) , CONST64(0x519EC608E7669EDD) ,

109 
CONST64
(0x0E5715A2D149AA23) , CONST64(0x177D4571848FF194) ,

110 
CONST64
(0xEEB55F3241014C22) , CONST64(0x0F5E5CA13A6E2EC2) ,

111 
CONST64
(0x8029927B75F5C361) , CONST64(0xAD139FABC3D6E436) ,

112 
CONST64
(0x0D5DF1A94CCF402F) , CONST64(0x3E8BD948BEA5DFC8) ,

113 
CONST64
(0xA5A0D357BD3FF77E) , CONST64(0xA2D12E251F74F645) ,

114 
CONST64
(0x66FD9E525E81A082) , CONST64(0x2E0C90CE7F687A49) ,

115 
CONST64
(0xC2E8BCBEBA973BC5) , CONST64(0x000001BCE509745F) ,

116 
CONST64
(0x423777BBE6DAB3D6) , CONST64(0xD1661C7EAEF06EB5) ,

117 
CONST64
(0xA1781F354DAACFD8) , CONST64(0x2D11284A2B16AFFC) ,

118 
CONST64
(0xF1FC4F67FA891D1F) , CONST64(0x73ECC25DCB920ADA) ,

119 
CONST64
(0xAE610C22C2A12651) , CONST64(0x96E0A810D356B78A) ,

120 
CONST64
(0x5A9A381F2FE7870F) , CONST64(0xD5AD62EDE94E5530) ,

121 
CONST64
(0xD225E5E8368D1427) , CONST64(0x65977B70C7AF4631) ,

122 
CONST64
(0x99F889B2DE39D74F) , CONST64(0x233F30BF54E1D143) ,

123 
CONST64
(0x9A9675D3D9A63C97) , CONST64(0x5470554FF334F9A8) ,

124 
CONST64
(0x166ACB744A4F5688) , CONST64(0x70C74CAAB2E4AEAD) ,

125 
CONST64
(0xF0D091646F294D12) , CONST64(0x57B82A89684031D1) ,

126 
CONST64
(0xEFD95A5A61BE0B6B) , CONST64(0x2FBD12E969F2F29A) ,

127 
CONST64
(0x9BD37013FEFF9FE8) , CONST64(0x3F9B0404D6085A06) ,

128 
CONST64
(0x4940C1F3166CFE15) , CONST64(0x09542C4DCDF3DEFB) ,

129 
CONST64
(0xB4C5218385CD5CE3) , CONST64(0xC935B7DC4462A641) ,

130 
CONST64
(0x3417F8A68ED3B63F) , CONST64(0xB80959295B215B40) ,

131 
CONST64
(0xF99CDAEF3B8C8572) , CONST64(0x018C0614F8FCB95D) ,

132 
CONST64
(0x1B14ACCD1A3ACDF3) , CONST64(0x84D471F200BB732D) ,

133 
CONST64
(0xC1A3110E95E8DA16) , CONST64(0x430A7220BF1A82B8) ,

134 
CONST64
(0xB77E090D39DF210E) , CONST64(0x5EF4BD9F3CD05E9D) ,

135 
CONST64
(0x9D4FF6DA7E57A444) , CONST64(0xDA1D60E183D4A5F8) ,

136 
CONST64
(0xB287C38417998E47) , CONST64(0xFE3EDC121BB31886) ,

137 
CONST64
(0xC7FE3CCC980CCBEF) , CONST64(0xE46FB590189BFD03) ,

138 
CONST64
(0x3732FD469A4C57DC) , CONST64(0x7EF700A07CF1AD65) ,

139 
CONST64
(0x59C64468A31D8859) , CONST64(0x762FB0B4D45B61F6) ,

140 
CONST64
(0x155BAED099047718) , CONST64(0x68755E4C3D50BAA6) ,

141 
CONST64
(0xE9214E7F22D8B4DF) , CONST64(0x2ADDBF532EAC95F4) ,

142 
CONST64
(0x32AE3909B4BD0109) , CONST64(0x834DF537B08E3450) ,

143 
CONST64
(0xFA209DA84220728D) , CONST64(0x9E691D9B9EFE23F7) ,

144 
CONST64
(0x0446D288C4AE8D7F) , CONST64(0x7B4CC524E169785B) ,

145 
CONST64
(0x21D87F0135CA1385) , CONST64(0xCEBB400F137B8AA5) ,

146 
CONST64
(0x272E2B66580796BE) , CONST64(0x3612264125C2B0DE) ,

147 
CONST64
(0x057702BDAD1EFBB2) , CONST64(0xD4BABB8EACF84BE9) ,

148 
CONST64
(0x91583139641BC67B) , CONST64(0x8BDC2DE08036E024) ,

149 
CONST64
(0x603C8156F49F68ED) , CONST64(0xF7D236F7DBEF5111) ,

150 
CONST64
(0x9727C4598AD21E80) , CONST64(0xA08A0896670A5FD7) ,

151 
CONST64
(0xCB4A8F4309EBA9CB) , CONST64(0x81AF564B0F7036A1) ,

152 
CONST64
(0xC0B99AA778199ABD) , CONST64(0x959F1EC83FC8E952) ,

153 
CONST64
(0x8C505077794A81B9) , CONST64(0x3ACAAF8F056338F0) ,

154 
CONST64
(0x07B43F50627A6778) , CONST64(0x4A44AB49F5ECCC77) ,

155 
CONST64
(0x3BC3D6E4B679EE98) , CONST64(0x9CC0D4D1CF14108C) ,

156 
CONST64
(0x4406C00B206BC8A0) , CONST64(0x82A18854C8D72D89) ,

157 
CONST64
(0x67E366B35C3C432C) , CONST64(0xB923DD61102B37F2) ,

158 
CONST64
(0x56AB2779D884271D) , CONST64(0xBE83E1B0FF1525AF) ,

159 
CONST64
(0xFB7C65D4217E49A9) , CONST64(0x6BDBE0E76D48E7D4) ,

160 
CONST64
(0x08DF828745D9179E) , CONST64(0x22EA6A9ADD53BD34) ,

161 
CONST64
(0xE36E141C5622200A) , CONST64(0x7F805D1B8CB750EE) ,

162 
CONST64
(0xAFE5C7A59F58E837) , CONST64(0xE27F996A4FB1C23C) ,

163 
CONST64
(0xD3867DFB0775F0D0) , CONST64(0xD0E673DE6E88891A) ,

164 
CONST64
(0x123AEB9EAFB86C25) , CONST64(0x30F1D5D5C145B895) ,

165 
CONST64
(0xBB434A2DEE7269E7) , CONST64(0x78CB67ECF931FA38) ,

166 
CONST64
(0xF33B0372323BBF9C) , CONST64(0x52D66336FB279C74) ,

167 
CONST64
(0x505F33AC0AFB4EAA) , CONST64(0xE8A5CD99A2CCE187) ,

168 
CONST64
(0x534974801E2D30BB) , CONST64(0x8D2D5711D5876D90) ,

169 
CONST64
(0x1F1A412891BC038E) , CONST64(0xD6E2E71D82E56648) ,

170 
CONST64
(0x74036C3A497732B7) , CONST64(0x89B67ED96361F5AB) ,

171 
CONST64
(0xFFED95D8F1EA02A2) , CONST64(0xE72B3BD61464D43D) ,

172 
CONST64
(0xA6300F170BDC4820) , CONST64(0xEBC18760ED78A77A) ,

173 
CONST64
(0xE6A6BE5A05A12138) , CONST64(0xB5A122A5B4F87C98) ,

174 
CONST64
(0x563C6089140B6990) , CONST64(0x4C46CB2E391F5DD5) ,

175 
CONST64
(0xD932ADDBC9B79434) , CONST64(0x08EA70E42015AFF5) ,

176 
CONST64
(0xD765A6673E478CF1) , CONST64(0xC4FB757EAB278D99) ,

177 
CONST64
(0xDF11C6862D6E0692) , CONST64(0xDDEB84F10D7F3B16) ,

178 
CONST64
(0x6F2EF604A665EA04) , CONST64(0x4A8E0F0FF0E0DFB3) ,

179 
CONST64
(0xA5EDEEF83DBCBA51) , CONST64(0xFC4F0A2A0EA4371E) ,

180 
CONST64
(0xE83E1DA85CB38429) , CONST64(0xDC8FF882BA1B1CE2) ,

181 
CONST64
(0xCD45505E8353E80D) , CONST64(0x18D19A00D4DB0717) ,

182 
CONST64
(0x34A0CFEDA5F38101) , CONST64(0x0BE77E518887CAF2) ,

183 
CONST64
(0x1E341438B3C45136) , CONST64(0xE05797F49089CCF9) ,

184 
CONST64
(0xFFD23F9DF2591D14) , CONST64(0x543DDA228595C5CD) ,

185 
CONST64
(0x661F81FD99052A33) , CONST64(0x8736E641DB0F7B76) ,

186 
CONST64
(0x15227725418E5307) , CONST64(0xE25F7F46162EB2FA) ,

187 
CONST64
(0x48A8B2126C13D9FE) , CONST64(0xAFDC541792E76EEA) ,

188 
CONST64
(0x03D912BFC6D1898F) , CONST64(0x31B1AAFA1B83F51B) ,

189 
CONST64
(0xF1AC2796E42AB7D9) , CONST64(0x40A3A7D7FCD2EBAC) ,

190 
CONST64
(0x1056136D0AFBBCC5) , CONST64(0x7889E1DD9A6D0C85) ,

191 
CONST64
(0xD33525782A7974AA) , CONST64(0xA7E25D09078AC09B) ,

192 
CONST64
(0xBD4138B3EAC6EDD0) , CONST64(0x920ABFBE71EB9E70) ,

193 
CONST64
(0xA2A5D0F54FC2625C) , CONST64(0xC054E36B0B1290A3) ,

194 
CONST64
(0xF6DD59FF62FE932B) , CONST64(0x3537354511A8AC7D) ,

195 
CONST64
(0xCA845E9172FADCD4) , CONST64(0x84F82B60329D20DC) ,

196 
CONST64
(0x79C62CE1CD672F18) , CONST64(0x8B09A2ADD124642C) ,

197 
CONST64
(0xD0C1E96A19D9E726) , CONST64(0x5A786A9B4BA9500C) ,

198 
CONST64
(0x0E020336634C43F3) , CONST64(0xC17B474AEB66D822) ,

199 
CONST64
(0x6A731AE3EC9BAAC2) , CONST64(0x8226667AE0840258) ,

200 
CONST64
(0x67D4567691CAECA5) , CONST64(0x1D94155C4875ADB5) ,

201 
CONST64
(0x6D00FD985B813FDF) , CONST64(0x51286EFCB774CD06) ,

202 
CONST64
(0x5E8834471FA744AF) , CONST64(0xF72CA0AEE761AE2E) ,

203 
CONST64
(0xBE40E4CDAEE8E09A) , CONST64(0xE9970BBB5118F665) ,

204 
CONST64
(0x726E4BEB33DF1964) , CONST64(0x703B000729199762) ,

205 
CONST64
(0x4631D816F5EF30A7) , CONST64(0xB880B5B51504A6BE) ,

206 
CONST64
(0x641793C37ED84B6C) , CONST64(0x7B21ED77F6E97D96) ,

207 
CONST64
(0x776306312EF96B73) , CONST64(0xAE528948E86FF3F4) ,

208 
CONST64
(0x53DBD7F286A3F8F8) , CONST64(0x16CADCE74CFC1063) ,

209 
CONST64
(0x005C19BDFA52C6DD) , CONST64(0x68868F5D64D46AD3) ,

210 
CONST64
(0x3A9D512CCF1E186A) , CONST64(0x367E62C2385660AE) ,

211 
CONST64
(0xE359E7EA77DCB1D7) , CONST64(0x526C0773749ABE6E) ,

212 
CONST64
(0x735AE5F9D09F734B) , CONST64(0x493FC7CC8A558BA8) ,

213 
CONST64
(0xB0B9C1533041AB45) , CONST64(0x321958BA470A59BD) ,

214 
CONST64
(0x852DB00B5F46C393) , CONST64(0x91209B2BD336B0E5) ,

215 
CONST64
(0x6E604F7D659EF19F) , CONST64(0xB99A8AE2782CCB24) ,

216 
CONST64
(0xCCF52AB6C814C4C7) , CONST64(0x4727D9AFBE11727B) ,

217 
CONST64
(0x7E950D0C0121B34D) , CONST64(0x756F435670AD471F) ,

218 
CONST64
(0xF5ADD442615A6849) , CONST64(0x4E87E09980B9957A) ,

219 
CONST64
(0x2ACFA1DF50AEE355) , CONST64(0xD898263AFD2FD556) ,

220 
CONST64
(0xC8F4924DD80C8FD6) , CONST64(0xCF99CA3D754A173A) ,

221 
CONST64
(0xFE477BACAF91BF3C) , CONST64(0xED5371F6D690C12D) ,

222 
CONST64
(0x831A5C285E687094) , CONST64(0xC5D3C90A3708A0A4) ,

223 
CONST64
(0x0F7F903717D06580) , CONST64(0x19F9BB13B8FDF27F) ,

224 
CONST64
(0xB1BD6F1B4D502843) , CONST64(0x1C761BA38FFF4012) ,

225 
CONST64
(0x0D1530C4E2E21F3B) , CONST64(0x8943CE69A7372C8A) ,

226 
CONST64
(0xE5184E11FEB5CE66) , CONST64(0x618BDB80BD736621) ,

227 
CONST64
(0x7D29BAD68B574D0B) , CONST64(0x81BB613E25E6FE5B) ,

228 
CONST64
(0x071C9C10BC07913F) , CONST64(0xC7BEEB7909AC2D97) ,

229 
CONST64
(0xC3E58D353BC5D757) , CONST64(0xEB017892F38F61E8) ,

230 
CONST64
(0xD4EFFB9C9B1CC21A) , CONST64(0x99727D26F494F7AB) ,

231 
CONST64
(0xA3E063A2956B3E03) , CONST64(0x9D4A8B9A4AA09C30) ,

232 
CONST64
(0x3F6AB7D500090FB4) , CONST64(0x9CC0F2A057268AC0) ,

233 
CONST64
(0x3DEE9D2DEDBF42D1) , CONST64(0x330F49C87960A972) ,

234 
CONST64
(0xC6B2720287421B41) , CONST64(0x0AC59EC07C00369C) ,

235 
CONST64
(0xEF4EAC49CB353425) , CONST64(0xF450244EEF0129D8) ,

236 
CONST64
(0x8ACC46E5CAF4DEB6) , CONST64(0x2FFEAB63989263F7) ,

237 
CONST64
(0x8F7CB9FE5D7A4578) , CONST64(0x5BD8F7644E634635) ,

238 
CONST64
(0x427A7315BF2DC900) , CONST64(0x17D0C4AA2125261C) ,

239 
CONST64
(0x3992486C93518E50) , CONST64(0xB4CBFEE0A2D7D4C3) ,

240 
CONST64
(0x7C75D6202C5DDD8D) , CONST64(0xDBC295D8E35B6C61) ,

241 
CONST64
(0x60B369D302032B19) , CONST64(0xCE42685FDCE44132) ,

242 
CONST64
(0x06F3DDB9DDF65610) , CONST64(0x8EA4D21DB5E148F0) ,

243 
CONST64
(0x20B0FCE62FCD496F) , CONST64(0x2C1B912358B0EE31) ,

244 
CONST64
(0xB28317B818F5A308) , CONST64(0xA89C1E189CA6D2CF) ,

245 
CONST64
(0x0C6B18576AAADBC8) , CONST64(0xB65DEAA91299FAE3) ,

246 
CONST64
(0xFB2B794B7F1027E7) , CONST64(0x04E4317F443B5BEB) ,

247 
CONST64
(0x4B852D325939D0A6) , CONST64(0xD5AE6BEEFB207FFC) ,

248 
CONST64
(0x309682B281C7D374) , CONST64(0xBAE309A194C3B475) ,

249 
CONST64
(0x8CC3F97B13B49F05) , CONST64(0x98A9422FF8293967) ,

250 
CONST64
(0x244B16B01076FF7C) , CONST64(0xF8BF571C663D67EE) ,

251 
CONST64
(0x1F0D6758EEE30DA1) , CONST64(0xC9B611D97ADEB9B7) ,

252 
CONST64
(0xB7AFD5887B6C57A2) , CONST64(0x6290AE846B984FE1) ,

253 
CONST64
(0x94DF4CDEACC1A5FD) , CONST64(0x058A5BD1C5483AFF) ,

254 
CONST64
(0x63166CC142BA3C37) , CONST64(0x8DB8526EB2F76F40) ,

255 
CONST64
(0xE10880036F0D6D4E) , CONST64(0x9E0523C9971D311D) ,

256 
CONST64
(0x45EC2824CC7CD691) , CONST64(0x575B8359E62382C9) ,

257 
CONST64
(0xFA9E400DC4889995) , CONST64(0xD1823ECB45721568) ,

258 
CONST64
(0xDAFD983B8206082F) , CONST64(0xAA7D29082386A8CB) ,

259 
CONST64
(0x269FCD4403B87588) , CONST64(0x1B91F5F728BDD1E0) ,

260 
CONST64
(0xE4669F39040201F6) , CONST64(0x7A1D7C218CF04ADE) ,

261 
CONST64
(0x65623C29D79CE5CE) , CONST64(0x2368449096C00BB1) ,

262 
CONST64
(0xAB9BF1879DA503BA) , CONST64(0xBC23ECB1A458058E) ,

263 
CONST64
(0x9A58DF01BB401ECC) , CONST64(0xA070E868A85F143D) ,

264 
CONST64
(0x4FF188307DF2239E) , CONST64(0x14D565B41A641183) ,

265 
CONST64
(0xEE13337452701602) , CONST64(0x950E3DCF3F285E09) ,

266 
CONST64
(0x59930254B9C80953) , CONST64(0x3BF299408930DA6D) ,

267 
CONST64
(0xA955943F53691387) , CONST64(0xA15EDECAA9CB8784) ,

268 
CONST64
(0x29142127352BE9A0) , CONST64(0x76F0371FFF4E7AFB) ,

269 
CONST64
(0x0239F450274F2228) , CONST64(0xBB073AF01D5E868B) ,

270 
CONST64
(0xBFC80571C10E96C1) , CONST64(0xD267088568222E23) ,

271 
CONST64
(0x9671A3D48E80B5B0) , CONST64(0x55B5D38AE193BB81) ,

272 
CONST64
(0x693AE2D0A18B04B8) , CONST64(0x5C48B4ECADD5335F) ,

273 
CONST64
(0xFD743B194916A1CA) , CONST64(0x2577018134BE98C4) ,

274 
CONST64
(0xE77987E83C54A4AD) , CONST64(0x28E11014DA33E1B9) ,

275 
CONST64
(0x270CC59E226AA213) , CONST64(0x71495F756D1A5F60) ,

276 
CONST64
(0x9BE853FB60AFEF77) , CONST64(0xADC786A7F7443DBF) ,

277 
CONST64
(0x0904456173B29A82) , CONST64(0x58BC7A66C232BD5E) ,

278 
CONST64
(0xF306558C673AC8B2) , CONST64(0x41F639C6B6C9772A) ,

279 
CONST64
(0x216DEFE99FDA35DA) , CONST64(0x11640CC71C7BE615) ,

280 
CONST64
(0x93C43694565C5527) , CONST64(0xEA038E6246777839) ,

281 
CONST64
(0xF9ABF3CE5A3E2469) , CONST64(0x741E768D0FD312D2) ,

282 
CONST64
(0x0144B883CED652C6) , CONST64(0xC20B5A5BA33F8552) ,

283 
CONST64
(0x1AE69633C3435A9D) , CONST64(0x97A28CA4088CFDEC) ,

284 
CONST64
(0x8824A43C1E96F420) , CONST64(0x37612FA66EEEA746) ,

285 
CONST64
(0x6B4CB165F9CF0E5A) , CONST64(0x43AA1C06A0ABFB4A) ,

286 
CONST64
(0x7F4DC26FF162796B) , CONST64(0x6CBACC8E54ED9B0F) ,

287 
CONST64
(0xA6B7FFEFD2BB253E) , CONST64(0x2E25BC95B0A29D4F) ,

288 
CONST64
(0x86D6A58BDEF1388C) , CONST64(0xDED74AC576B6F054) ,

289 
CONST64
(0x8030BDBC2B45805D) , CONST64(0x3C81AF70E94D9289) ,

290 
CONST64
(0x3EFF6DDA9E3100DB) , CONST64(0xB38DC39FDFCC8847) ,

291 
CONST64
(0x123885528D17B87E) , CONST64(0xF2DA0ED240B1B642) ,

292 
CONST64
(0x44CEFADCD54BF9A9) , CONST64(0x1312200E433C7EE6) ,

293 
CONST64
(0x9FFCC84F3A78C748) , CONST64(0xF0CD1F72248576BB) ,

294 
CONST64
(0xEC6974053638CFE4) , CONST64(0x2BA7B67C0CEC4E4C) ,

295 
CONST64
(0xAC2F4DF3E5CE32ED) , CONST64(0xCB33D14326EA4C11) ,

296 
CONST64
(0xA4E9044CC77E58BC) , CONST64(0x5F513293D934FCEF) ,

297 
CONST64
(0x5DC9645506E55444) , CONST64(0x50DE418F317DE40A) ,

298 
CONST64
(0x388CB31A69DDE259) , CONST64(0x2DB4A83455820A86) ,

299 
CONST64
(0x9010A91E84711AE9) , CONST64(0x4DF7F0B7B1498371) ,

300 
CONST64
(0xD62A2EABC0977179) , CONST64(0x22FAC097AA8D5C0E) ,

301 
CONST64
(0xF49FCC2FF1DAF39B) , CONST64(0x487FD5C66FF29281) ,

302 
CONST64
(0xE8A30667FCDCA83F) , CONST64(0x2C9B4BE3D2FCCE63) ,

303 
CONST64
(0xDA3FF74B93FBBBC2) , CONST64(0x2FA165D2FE70BA66) ,

304 
CONST64
(0xA103E279970E93D4) , CONST64(0xBECDEC77B0E45E71) ,

305 
CONST64
(0xCFB41E723985E497) , CONST64(0xB70AAA025EF75017) ,

306 
CONST64
(0xD42309F03840B8E0) , CONST64(0x8EFC1AD035898579) ,

307 
CONST64
(0x96C6920BE2B2ABC5) , CONST64(0x66AF4163375A9172) ,

308 
CONST64
(0x2174ABDCCA7127FB) , CONST64(0xB33CCEA64A72FF41) ,

309 
CONST64
(0xF04A4933083066A5) , CONST64(0x8D970ACDD7289AF5) ,

310 
CONST64
(0x8F96E8E031C8C25E) , CONST64(0xF3FEC02276875D47) ,

311 
CONST64
(0xEC7BF310056190DD) , CONST64(0xF5ADB0AEBB0F1491) ,

312 
CONST64
(0x9B50F8850FD58892) , CONST64(0x4975488358B74DE8) ,

313 
CONST64
(0xA3354FF691531C61) , CONST64(0x0702BBE481D2C6EE) ,

314 
CONST64
(0x89FB24057DEDED98) , CONST64(0xAC3075138596E902) ,

315 
CONST64
(0x1D2D3580172772ED) , CONST64(0xEB738FC28E6BC30D) ,

316 
CONST64
(0x5854EF8F63044326) , CONST64(0x9E5C52325ADD3BBE) ,

317 
CONST64
(0x90AA53CF325C4623) , CONST64(0xC1D24D51349DD067) ,

318 
CONST64
(0x2051CFEEA69EA624) , CONST64(0x13220F0A862E7E4F) ,

319 
CONST64
(0xCE39399404E04864) , CONST64(0xD9C42CA47086FCB7) ,

320 
CONST64
(0x685AD2238A03E7CC) , CONST64(0x066484B2AB2FF1DB) ,

321 
CONST64
(0xFE9D5D70EFBF79EC) , CONST64(0x5B13B9DD9C481854) ,

322 
CONST64
(0x15F0D475ED1509AD) , CONST64(0x0BEBCD060EC79851) ,

323 
CONST64
(0xD58C6791183AB7F8) , CONST64(0xD1187C5052F3EEE4) ,

324 
CONST64
(0xC95D1192E54E82FF) , CONST64(0x86EEA14CB9AC6CA2) ,

325 
CONST64
(0x3485BEB153677D5D) , CONST64(0xDD191D781F8C492A) ,

326 
CONST64
(0xF60866BAA784EBF9) , CONST64(0x518F643BA2D08C74) ,

327 
CONST64
(0x8852E956E1087C22) , CONST64(0xA768CB8DC410AE8D) ,

328 
CONST64
(0x38047726BFEC8E1A) , CONST64(0xA67738B4CD3B45AA) ,

329 
CONST64
(0xAD16691CEC0DDE19) , CONST64(0xC6D4319380462E07) ,

330 
CONST64
(0xC5A5876D0BA61938) , CONST64(0x16B9FA1FA58FD840) ,

331 
CONST64
(0x188AB1173CA74F18) , CONST64(0xABDA2F98C99C021F) ,

332 
CONST64
(0x3E0580AB134AE816) , CONST64(0x5F3B05B773645ABB) ,

333 
CONST64
(0x2501A2BE5575F2F6) , CONST64(0x1B2F74004E7E8BA9) ,

334 
CONST64
(0x1CD7580371E8D953) , CONST64(0x7F6ED89562764E30) ,

335 
CONST64
(0xB15926FF596F003D) , CONST64(0x9F65293DA8C5D6B9) ,

336 
CONST64
(0x6ECEF04DD690F84C) , CONST64(0x4782275FFF33AF88) ,

337 
CONST64
(0xE41433083F820801) , CONST64(0xFD0DFE409A1AF9B5) ,

338 
CONST64
(0x4325A3342CDB396B) , CONST64(0x8AE77E62B301B252) ,

339 
CONST64
(0xC36F9E9F6655615A) , CONST64(0x85455A2D92D32C09) ,

340 
CONST64
(0xF2C7DEA949477485) , CONST64(0x63CFB4C133A39EBA) ,

341 
CONST64
(0x83B040CC6EBC5462) , CONST64(0x3B9454C8FDB326B0) ,

342 
CONST64
(0x56F56A9E87FFD78C) , CONST64(0x2DC2940D99F42BC6) ,

343 
CONST64
(0x98F7DF096B096E2D) , CONST64(0x19A6E01E3AD852BF) ,

344 
CONST64
(0x42A99CCBDBD4B40B) , CONST64(0xA59998AF45E9C559) ,

345 
CONST64
(0x366295E807D93186) , CONST64(0x6B48181BFAA1F773) ,

346 
CONST64
(0x1FEC57E2157A0A1D) , CONST64(0x4667446AF6201AD5) ,

347 
CONST64
(0xE615EBCACFB0F075) , CONST64(0xB8F31F4F68290778) ,

348 
CONST64
(0x22713ED6CE22D11E) , CONST64(0x3057C1A72EC3C93B) ,

349 
CONST64
(0xCB46ACC37C3F1F2F) , CONST64(0xDBB893FD02AAF50E) ,

350 
CONST64
(0x331FD92E600B9FCF) , CONST64(0xA498F96148EA3AD6) ,

351 
CONST64
(0xA8D8426E8B6A83EA) , CONST64(0xA089B274B7735CDC) ,

352 
CONST64
(0x87F6B3731E524A11) , CONST64(0x118808E5CBC96749) ,

353 
CONST64
(0x9906E4C7B19BD394) , CONST64(0xAFED7F7E9B24A20C) ,

354 
CONST64
(0x6509EADEEB3644A7) , CONST64(0x6C1EF1D3E8EF0EDE) ,

355 
CONST64
(0xB9C97D43E9798FB4) , CONST64(0xA2F2D784740C28A3) ,

356 
CONST64
(0x7B8496476197566F) , CONST64(0x7A5BE3E6B65F069D) ,

357 
CONST64
(0xF96330ED78BE6F10) , CONST64(0xEEE60DE77A076A15) ,

358 
CONST64
(0x2B4BEE4AA08B9BD0) , CONST64(0x6A56A63EC7B8894E) ,

359 
CONST64
(0x02121359BA34FEF4) , CONST64(0x4CBF99F8283703FC) ,

360 
CONST64
(0x398071350CAF30C8) , CONST64(0xD0A77A89F017687A) ,

361 
CONST64
(0xF1C1A9EB9E423569) , CONST64(0x8C7976282DEE8199) ,

362 
CONST64
(0x5D1737A5DD1F7ABD) , CONST64(0x4F53433C09A9FA80) ,

363 
CONST64
(0xFA8B0C53DF7CA1D9) , CONST64(0x3FD9DCBC886CCB77) ,

364 
CONST64
(0xC040917CA91B4720) , CONST64(0x7DD00142F9D1DCDF) ,

365 
CONST64
(0x8476FC1D4F387B58) , CONST64(0x23F8E7C5F3316503) ,

366 
CONST64
(0x032A2244E7E37339) , CONST64(0x5C87A5D750F5A74B) ,

367 
CONST64
(0x082B4CC43698992E) , CONST64(0xDF917BECB858F63C) ,

368 
CONST64
(0x3270B8FC5BF86DDA) , CONST64(0x10AE72BB29B5DD76) ,

369 
CONST64
(0x576AC94E7700362B) , CONST64(0x1AD112DAC61EFB8F) ,

370 
CONST64
(0x691BC30EC5FAA427) , CONST64(0xFF246311CC327143) ,

371 
CONST64
(0x3142368E30E53206) , CONST64(0x71380E31E02CA396) ,

372 
CONST64
(0x958D5C960AAD76F1) , CONST64(0xF8D6F430C16DA536) ,

373 
CONST64
(0xC8FFD13F1BE7E1D2) , CONST64(0x7578AE66004DDBE1) ,

374 
CONST64
(0x05833F01067BE646) , CONST64(0xBB34B5AD3BFE586D) ,

375 
CONST64
(0x095F34C9A12B97F0) , CONST64(0x247AB64525D60CA8) ,

376 
CONST64
(0xDCDBC6F3017477D1) , CONST64(0x4A2E14D4DECAD24D) ,

377 
CONST64
(0xBDB5E6D9BE0A1EEB) , CONST64(0x2A7E70F7794301AB) ,

378 
CONST64
(0xDEF42D8A270540FD) , CONST64(0x01078EC0A34C22C1) ,

379 
CONST64
(0xE5DE511AF4C16387) , CONST64(0x7EBB3A52BD9A330A) ,

380 
CONST64
(0x77697857AA7D6435) , CONST64(0x004E831603AE4C32) ,

381 
CONST64
(0xE7A21020AD78E312) , CONST64(0x9D41A70C6AB420F2) ,

382 
CONST64
(0x28E06C18EA1141E6) , CONST64(0xD2B28CBD984F6B28) ,

383 
CONST64
(0x26B75F6C446E9D83) , CONST64(0xBA47568C4D418D7F) ,

384 
CONST64
(0xD80BADBFE6183D8E) , CONST64(0x0E206D7F5F166044) ,

385 
CONST64
(0xE258A43911CBCA3E) , CONST64(0x723A1746B21DC0BC) ,

386 
CONST64
(0xC7CAA854F5D7CDD3) , CONST64(0x7CAC32883D261D9C) ,

387 
CONST64
(0x7690C26423BA942C) , CONST64(0x17E55524478042B8) ,

388 
CONST64
(0xE0BE477656A2389F) , CONST64(0x4D289B5E67AB2DA0) ,

389 
CONST64
(0x44862B9C8FBBFD31) , CONST64(0xB47CC8049D141365) ,

390 
CONST64
(0x822C1B362B91C793) , CONST64(0x4EB14655FB13DFD8) ,

391 
CONST64
(0x1ECBBA0714E2A97B) , CONST64(0x6143459D5CDE5F14) ,

392 
CONST64
(0x53A8FBF1D5F0AC89) , CONST64(0x97EA04D81C5E5B00) ,

393 
CONST64
(0x622181A8D4FDB3F3) , CONST64(0xE9BCD341572A1208) ,

394 
CONST64
(0x1411258643CCE58A) , CONST64(0x9144C5FEA4C6E0A4) ,

395 
CONST64
(0x0D33D06565CF620F) , CONST64(0x54A48D489F219CA1) ,

396 
CONST64
(0xC43E5EAC6D63C821) , CONST64(0xA9728B3A72770DAF) ,

397 
CONST64
(0xD7934E7B20DF87EF) , CONST64(0xE35503B61A3E86E5) ,

398 
CONST64
(0xCAE321FBC819D504) , CONST64(0x129A50B3AC60BFA6) ,

399 
CONST64
(0xCD5E68EA7E9FB6C3) , CONST64(0xB01C90199483B1C7) ,

400 
CONST64
(0x3DE93CD5C295376C) , CONST64(0xAED52EDF2AB9AD13) ,

401 
CONST64
(0x2E60F512C0A07884) , CONST64(0xBC3D86A3E36210C9) ,

402 
CONST64
(0x35269D9B163951CE) , CONST64(0x0C7D6E2AD0CDB5FA) ,

403 
CONST64
(0x59E86297D87F5733) , CONST64(0x298EF221898DB0E7) ,

404 
CONST64
(0x55000029D1A5AA7E) , CONST64(0x8BC08AE1B5061B45) ,

405 
CONST64
(0xC2C31C2B6C92703A) , CONST64(0x94CC596BAF25EF42) ,

406 
CONST64
(0x0A1D73DB22540456) , CONST64(0x04B6A0F9D9C4179A) ,

407 
CONST64
(0xEFFDAFA2AE3D3C60) , CONST64(0xF7C8075BB49496C4) ,

408 
CONST64
(0x9CC5C7141D1CD4E3) , CONST64(0x78BD1638218E5534) ,

409 
CONST64
(0xB2F11568F850246A) , CONST64(0xEDFABCFA9502BC29) ,

410 
CONST64
(0x796CE5F2DA23051B) , CONST64(0xAAE128B0DC93537C) ,

411 
CONST64
(0x3A493DA0EE4B29AE) , CONST64(0xB5DF6B2C416895D7) ,

412 
CONST64
(0xFCABBD25122D7F37) , CONST64(0x70810B58105DC4B1) ,

413 
CONST64
(0xE10FDD37F7882A90) , CONST64(0x524DCAB5518A3F5C) ,

414 
CONST64
(0x3C9E85878451255B) , CONST64(0x4029828119BD34E2) ,

415 
CONST64
(0x74A05B6F5D3CECCB) , CONST64(0xB610021542E13ECA) ,

416 
CONST64
(0x0FF979D12F59E2AC) , CONST64(0x6037DA27E4F9CC50) ,

417 
CONST64
(0x5E92975A0DF1847D) , CONST64(0xD66DE190D3E623FE) ,

418 
CONST64
(0x5032D6B87B568048) , CONST64(0x9A36B7CE8235216E) ,

419 
CONST64
(0x80272A7A24F64B4A) , CONST64(0x93EFED8B8C6916F7) ,

420 
CONST64
(0x37DDBFF44CCE1555) , CONST64(0x4B95DB5D4B99BD25) ,

421 
CONST64
(0x92D3FDA169812FC0) , CONST64(0xFB1A4A9A90660BB6) ,

422 
CONST64
(0x730C196946A4B9B2) , CONST64(0x81E289AA7F49DA68) ,

423 
CONST64
(0x64669A0F83B1A05F) , CONST64(0x27B3FF7D9644F48B) ,

424 
CONST64
(0xCC6B615C8DB675B3) , CONST64(0x674F20B9BCEBBE95) ,

425 
CONST64
(0x6F31238275655982) , CONST64(0x5AE488713E45CF05) ,

426 
CONST64
(0xBF619F9954C21157) , CONST64(0xEABAC46040A8EAE9) ,

427 
CONST64
(0x454C6FE9F2C0C1CD) , CONST64(0x419CF6496412691C) ,

428 
CONST64
(0xD3DC3BEF265B0F70) , CONST64(0x6D0E60F5C3578A9E) ,

429 
CONST64
(0x5B0E608526323C55) , CONST64(0x1A46C1A9FA1B59F5) ,

430 
CONST64
(0xA9E245A17C4C8FFA) , CONST64(0x65CA5159DB2955D7) ,

431 
CONST64
(0x05DB0A76CE35AFC2) , CONST64(0x81EAC77EA9113D45) ,

432 
CONST64
(0x528EF88AB6AC0A0D) , CONST64(0xA09EA253597BE3FF) ,

433 
CONST64
(0x430DDFB3AC48CD56) , CONST64(0xC4B3A67AF45CE46F) ,

434 
CONST64
(0x4ECECFD8FBE2D05E) , CONST64(0x3EF56F10B39935F0) ,

435 
CONST64
(0x0B22D6829CD619C6) , CONST64(0x17FD460A74DF2069) ,

436 
CONST64
(0x6CF8CC8E8510ED40) , CONST64(0xD6C824BF3A6ECAA7) ,

437 
CONST64
(0x61243D581A817049) , CONST64(0x048BACB6BBC163A2) ,

438 
CONST64
(0xD9A38AC27D44CC32) , CONST64(0x7FDDFF5BAAF410AB) ,

439 
CONST64
(0xAD6D495AA804824B) , CONST64(0xE1A6A74F2D8C9F94) ,

440 
CONST64
(0xD4F7851235DEE8E3) , CONST64(0xFD4B7F886540D893) ,

441 
CONST64
(0x247C20042AA4BFDA) , CONST64(0x096EA1C517D1327C) ,

442 
CONST64
(0xD56966B4361A6685) , CONST64(0x277DA5C31221057D) ,

443 
CONST64
(0x94D59893A43ACFF7) , CONST64(0x64F0C51CCDC02281) ,

444 
CONST64
(0x3D33BCC4FF6189DB) , CONST64(0xE005CB184CE66AF1) ,

445 
CONST64
(0xFF5CCD1D1DB99BEA) , CONST64(0xB0B854A7FE42980F) ,

446 
CONST64
(0x7BD46A6A718D4B9F) , CONST64(0xD10FA8CC22A5FD8C) ,

447 
CONST64
(0xD31484952BE4BD31) , CONST64(0xC7FA975FCB243847) ,

448 
CONST64
(0x4886ED1E5846C407) , CONST64(0x28CDDB791EB70B04) ,

449 
CONST64
(0xC2B00BE2F573417F) , CONST64(0x5C9590452180F877) ,

450 
CONST64
(0x7A6BDDFFF370EB00) , CONST64(0xCE509E38D6D9D6A4) ,

451 
CONST64
(0xEBEB0F00647FA702) , CONST64(0x1DCC06CF76606F06) ,

452 
CONST64
(0xE4D9F28BA286FF0A) , CONST64(0xD85A305DC918C262) ,

453 
CONST64
(0x475B1D8732225F54) , CONST64(0x2D4FB51668CCB5FE) ,

454 
CONST64
(0xA679B9D9D72BBA20) , CONST64(0x53841C0D912D43A5) ,

455 
CONST64
(0x3B7EAA48BF12A4E8) , CONST64(0x781E0E47F22F1DDF) ,

456 
CONST64
(0xEFF20CE60AB50973) , CONST64(0x20D261D19DFFB742) ,

457 
CONST64
(0x16A12B03062A2E39) , CONST64(0x1960EB2239650495) ,

458 
CONST64
(0x251C16FED50EB8B8) , CONST64(0x9AC0C330F826016E) ,

459 
CONST64
(0xED152665953E7671) , CONST64(0x02D63194A6369570) ,

460 
CONST64
(0x5074F08394B1C987) , CONST64(0x70BA598C90B25CE1) ,

461 
CONST64
(0x794A15810B9742F6) , CONST64(0x0D5925E9FCAF8C6C) ,

462 
CONST64
(0x3067716CD868744E) , CONST64(0x910AB077E8D7731B) ,

463 
CONST64
(0x6A61BBDB5AC42F61) , CONST64(0x93513EFBF0851567) ,

464 
CONST64
(0xF494724B9E83E9D5) , CONST64(0xE887E1985C09648D) ,

465 
CONST64
(0x34B1D3C675370CFD) , CONST64(0xDC35E433BC0D255D) ,

466 
CONST64
(0xD0AAB84234131BE0) , CONST64(0x08042A50B48B7EAF) ,

467 
CONST64
(0x9997C4EE44A3AB35) , CONST64(0x829A7B49201799D0) ,

468 
CONST64
(0x263B8307B7C54441) , CONST64(0x752F95F4FD6A6CA6) ,

469 
CONST64
(0x927217402C08C6E5) , CONST64(0x2A8AB754A795D9EE) ,

470 
CONST64
(0xA442F7552F72943D) , CONST64(0x2C31334E19781208) ,

471 
CONST64
(0x4FA98D7CEAEE6291) , CONST64(0x55C3862F665DB309) ,

472 
CONST64
(0xBD0610175D53B1F3) , CONST64(0x46FE6CB840413F27) ,

473 
CONST64
(0x3FE03792DF0CFA59) , CONST64(0xCFE700372EB85E8F) ,

474 
CONST64
(0xA7BE29E7ADBCE118) , CONST64(0xE544EE5CDE8431DD) ,

475 
CONST64
(0x8A781B1B41F1873E) , CONST64(0xA5C94C78A0D2F0E7) ,

476 
CONST64
(0x39412E2877B60728) , CONST64(0xA1265EF3AFC9A62C) ,

477 
CONST64
(0xBCC2770C6A2506C5) , CONST64(0x3AB66DD5DCE1CE12) ,

478 
CONST64
(0xE65499D04A675B37) , CONST64(0x7D8F523481BFD216) ,

479 
CONST64
(0x0F6F64FCEC15F389) , CONST64(0x74EFBE618B5B13C8) ,

480 
CONST64
(0xACDC82B714273E1D) , CONST64(0xDD40BFE003199D17) ,

481 
CONST64
(0x37E99257E7E061F8) , CONST64(0xFA52626904775AAA) ,

482 
CONST64
(0x8BBBF63A463D56F9) , CONST64(0xF0013F1543A26E64) ,

483 
CONST64
(0xA8307E9F879EC898) , CONST64(0xCC4C27A4150177CC) ,

484 
CONST64
(0x1B432F2CCA1D3348) , CONST64(0xDE1D1F8F9F6FA013) ,

485 
CONST64
(0x606602A047A7DDD6) , CONST64(0xD237AB64CC1CB2C7) ,

486 
CONST64
(0x9B938E7225FCD1D3) , CONST64(0xEC4E03708E0FF476) ,

487 
CONST64
(0xFEB2FBDA3D03C12D) , CONST64(0xAE0BCED2EE43889A) ,

488 
CONST64
(0x22CB8923EBFB4F43) , CONST64(0x69360D013CF7396D) ,

489 
CONST64
(0x855E3602D2D4E022) , CONST64(0x073805BAD01F784C) ,

490 
CONST64
(0x33E17A133852F546) , CONST64(0xDF4874058AC7B638) ,

491 
CONST64
(0xBA92B29C678AA14A) , CONST64(0x0CE89FC76CFAADCD) ,

492 
CONST64
(0x5F9D4E0908339E34) , CONST64(0xF1AFE9291F5923B9) ,

493 
CONST64
(0x6E3480F60F4A265F) , CONST64(0xEEBF3A2AB29B841C) ,

494 
CONST64
(0xE21938A88F91B4AD) , CONST64(0x57DFEFF845C6D3C3) ,

495 
CONST64
(0x2F006B0BF62CAAF2) , CONST64(0x62F479EF6F75EE78) ,

496 
CONST64
(0x11A55AD41C8916A9) , CONST64(0xF229D29084FED453) ,

497 
CONST64
(0x42F1C27B16B000E6) , CONST64(0x2B1F76749823C074) ,

498 
CONST64
(0x4B76ECA3C2745360) , CONST64(0x8C98F463B91691BD) ,

499 
CONST64
(0x14BCC93CF1ADE66A) , CONST64(0x8885213E6D458397) ,

500 
CONST64
(0x8E177DF0274D4711) , CONST64(0xB49B73B5503F2951) ,

501 
CONST64
(0x10168168C3F96B6B) , CONST64(0x0E3D963B63CAB0AE) ,

502 
CONST64
(0x8DFC4B5655A1DB14) , CONST64(0xF789F1356E14DE5C) ,

503 
CONST64
(0x683E68AF4E51DAC1) , CONST64(0xC9A84F9D8D4B0FD9) ,

504 
CONST64
(0x3691E03F52A0F9D1) , CONST64(0x5ED86E46E1878E80) ,

505 
CONST64
(0x3C711A0E99D07150) , CONST64(0x5A0865B20C4E9310) ,

506 
CONST64
(0x56FBFC1FE4F0682E) , CONST64(0xEA8D5DE3105EDF9B) ,

507 
CONST64
(0x71ABFDB12379187A) , CONST64(0x2EB99DE1BEE77B9C) ,

508 
CONST64
(0x21ECC0EA33CF4523) , CONST64(0x59A4D7521805C7A1) ,

509 
CONST64
(0x3896F5EB56AE7C72) , CONST64(0xAA638F3DB18F75DC) ,

510 
CONST64
(0x9F39358DABE9808E) , CONST64(0xB7DEFA91C00B72AC) ,

511 
CONST64
(0x6B5541FD62492D92) , CONST64(0x6DC6DEE8F92E4D5B) ,

512 
CONST64
(0x353F57ABC4BEEA7E) , CONST64(0x735769D6DA5690CE) ,

513 
CONST64
(0x0A234AA642391484) , CONST64(0xF6F9508028F80D9D) ,

514 
CONST64
(0xB8E319A27AB3F215) , CONST64(0x31AD9C1151341A4D) ,

515 
CONST64
(0x773C22A57BEF5805) , CONST64(0x45C7561A07968633) ,

516 
CONST64
(0xF913DA9E249DBE36) , CONST64(0xDA652D9B78A64C68) ,

517 
CONST64
(0x4C27A97F3BC334EF) , CONST64(0x76621220E66B17F4) ,

518 
CONST64
(0x967743899ACD7D0B) , CONST64(0xF3EE5BCAE0ED6782) ,

519 
CONST64
(0x409F753600C879FC) , CONST64(0x06D09A39B5926DB6) ,

520 
CONST64
(0x6F83AEB0317AC588) , CONST64(0x01E6CA4A86381F21) ,

521 
CONST64
(0x66FF3462D19F3025) , CONST64(0x72207C24DDFD3BFB) ,

522 
CONST64
(0x4AF6B6D3E2ECE2EB) , CONST64(0x9C994DBEC7EA08DE) ,

523 
CONST64
(0x49ACE597B09A8BC4) , CONST64(0xB38C4766CF0797BA) ,

524 
CONST64
(0x131B9373C57C2A75) , CONST64(0xB1822CCE61931E58) ,

525 
CONST64
(0x9D7555B909BA1C0C) , CONST64(0x127FAFDD937D11D2) ,

526 
CONST64
(0x29DA3BADC66D92E4) , CONST64(0xA2C1D57154C2ECBC) ,

527 
CONST64
(0x58C5134D82F6FE24) , CONST64(0x1C3AE3515B62274F) ,

528 
CONST64
(0xE907C82E01CB8126) , CONST64(0xF8ED091913E37FCB) ,

529 
CONST64
(0x3249D8F9C80046C9) , CONST64(0x80CF9BEDE388FB63) ,

530 
CONST64
(0x1881539A116CF19E) , CONST64(0x5103F3F76BD52457) ,

531 
CONST64
(0x15B7E6F5AE47F7A8) , CONST64(0xDBD7C6DED47E9CCF) ,

532 
CONST64
(0x44E55C410228BB1A) , CONST64(0xB647D4255EDB4E99) ,

533 
CONST64
(0x5D11882BB8AAFC30) , CONST64(0xF5098BBB29D3212A) ,

534 
CONST64
(0x8FB5EA14E90296B3) , CONST64(0x677B942157DD025A) ,

535 
CONST64
(0xFB58E7C0A390ACB5) , CONST64(0x89D3674C83BD4A01) ,

536 
CONST64
(0x9E2DA4DF4BF3B93B) , CONST64(0xFCC41E328CAB4829) ,

537 
CONST64
(0x03F38C96BA582C52) , CONST64(0xCAD1BDBD7FD85DB2) ,

538 
CONST64
(0xBBB442C16082AE83) , CONST64(0xB95FE86BA5DA9AB0) ,

539 
CONST64
(0xB22E04673771A93F) , CONST64(0x845358C9493152D8) ,

540 
CONST64
(0xBE2A488697B4541E) , CONST64(0x95A2DC2DD38E6966) ,

541 
CONST64
(0xC02C11AC923C852B) , CONST64(0x2388B1990DF2A87B) ,

542 
CONST64
(0x7C8008FA1B4F37BE) , CONST64(0x1F70D0C84D54E503) ,

543 
CONST64
(0x5490ADEC7ECE57D4) , CONST64(0x002B3C27D9063A3A) ,

544 
CONST64
(0x7EAEA3848030A2BF) , CONST64(0xC602326DED2003C0) ,

545 
CONST64
(0x83A7287D69A94086) , CONST64(0xC57A5FCB30F57A8A) ,

546 
CONST64
(0xB56844E479EBE779) , CONST64(0xA373B40F05DCBCE9) ,

547 
CONST64
(0xD71A786E88570EE2) , CONST64(0x879CBACDBDE8F6A0) ,

548 
CONST64
(0x976AD1BCC164A32F) , CONST64(0xAB21E25E9666D78B) ,

549 
CONST64
(0x901063AAE5E5C33C) , CONST64(0x9818B34448698D90) ,

550 
CONST64
(0xE36487AE3E1E8ABB) , CONST64(0xAFBDF931893BDCB4) ,

551 
CONST64
(0x6345A0DC5FBBD519) , CONST64(0x8628FE269B9465CA) ,

552 
CONST64
(0x1E5D01603F9C51EC) , CONST64(0x4DE44006A15049B7) ,

553 
CONST64
(0xBF6C70E5F776CBB1) , CONST64(0x411218F2EF552BED) ,

554 
CONST64
(0xCB0C0708705A36A3) , CONST64(0xE74D14754F986044) ,

555 
CONST64
(0xCD56D9430EA8280E) , CONST64(0xC12591D7535F5065) ,

556 
CONST64
(0xC83223F1720AEF96) , CONST64(0xC3A0396F7363A51F) };

558 #ifdeà
_MSC_VER


559 
	#INLINE
 
__šlše


	)

561 
	#INLINE


	)

565 
INLINE
 
	$tig”_round
(
ulÚg64
 *
a
, ulÚg64 *
b
, ulÚg64 *
c
, ulÚg64 
x
, 
mul
)

567 
ulÚg64
 
tmp
;

568 
tmp
 = (*
c
 ^ğ
x
);

569 *
a
 -ğ
t1
[
	`by‹
(
tmp
, 0)] ^ 
t2
[by‹Ñmp, 2)] ^ 
t3
[by‹Ñmp, 4)] ^ 
t4
[byte(tmp, 6)];

570 
tmp
 = (*
b
 +ğ
t4
[
	`by‹
Ñmp, 1)] ^ 
t3
[by‹Ñmp, 3)] ^ 
t2
[by‹Ñmp,5)] ^ 
t1
[byte(tmp,7)]);

571 
mul
) {

572 5: *
b
 = (
tmp
 << 2) +mp; ;

573 7: *
b
 = (
tmp
 << 3) -mp; ;

574 9: *
b
 = (
tmp
 << 3) +mp; ;

576 
	}
}

579 
	$·ss
(
ulÚg64
 *
a
, ulÚg64 *
b
, ulÚg64 *
c
, ulÚg64 *
x
, 
mul
)

581 
	`tig”_round
(
a
,
b
,
c
,
x
[0],
mul
);

582 
	`tig”_round
(
b
,
c
,
a
,
x
[1],
mul
);

583 
	`tig”_round
(
c
,
a
,
b
,
x
[2],
mul
);

584 
	`tig”_round
(
a
,
b
,
c
,
x
[3],
mul
);

585 
	`tig”_round
(
b
,
c
,
a
,
x
[4],
mul
);

586 
	`tig”_round
(
c
,
a
,
b
,
x
[5],
mul
);

587 
	`tig”_round
(
a
,
b
,
c
,
x
[6],
mul
);

588 
	`tig”_round
(
b
,
c
,
a
,
x
[7],
mul
);

589 
	}
}

592 
	$key_scheduË
(
ulÚg64
 *
x
)

594 
x
[0] -ğx[7] ^ 
	`CONST64
(0xA5A5A5A5A5A5A5A5);

595 
x
[1] ^= x[0];

596 
x
[2] += x[1];

597 
x
[3] -= x[2] ^ ((~x[1])<<19);

598 
x
[4] ^= x[3];

599 
x
[5] += x[4];

600 
x
[6] -= x[5] ^ ((~x[4])>>23);

601 
x
[7] ^= x[6];

602 
x
[0] += x[7];

603 
x
[1] -= x[0] ^ ((~x[7])<<19);

604 
x
[2] ^= x[1];

605 
x
[3] += x[2];

606 
x
[4] -= x[3] ^ ((~x[2])>>23);

607 
x
[5] ^= x[4];

608 
x
[6] += x[5];

609 
x
[7] -ğx[6] ^ 
	`CONST64
(0x0123456789ABCDEF);

610 
	}
}

612 #ifdeà
LTC_CLEAN_STACK


613 
	$_tig”_com´ess
(
hash_¡©e
 *
md
, *
buf
)

615 
	$tig”_com´ess
(
hash_¡©e
 *
md
, *
buf
)

618 
ulÚg64
 
a
, 
b
, 
c
, 
x
[8];

619 
i
;

622 
i
 = 0; i < 8; i++) {

623 
	`LOAD64L
(
x
[
i
],&
buf
[8*i]);

625 
a
 = 
md
->
tig”
.
¡©e
[0];

626 
b
 = 
md
->
tig”
.
¡©e
[1];

627 
c
 = 
md
->
tig”
.
¡©e
[2];

629 
	`·ss
(&
a
,&
b
,&
c
,
x
,5);

630 
	`key_scheduË
(
x
);

631 
	`·ss
(&
c
,&
a
,&
b
,
x
,7);

632 
	`key_scheduË
(
x
);

633 
	`·ss
(&
b
,&
c
,&
a
,
x
,9);

636 
md
->
tig”
.
¡©e
[0] = 
a
 ^ md->tiger.state[0];

637 
md
->
tig”
.
¡©e
[1] = 
b
 - md->tiger.state[1];

638 
md
->
tig”
.
¡©e
[2] = 
c
 + md->tiger.state[2];

640  
CRYPT_OK
;

641 
	}
}

643 #ifdeà
LTC_CLEAN_STACK


644 
	$tig”_com´ess
(
hash_¡©e
 *
md
, *
buf
)

646 
”r
;

647 
”r
 = 
	`_tig”_com´ess
(
md
, 
buf
);

648 
	`buº_¡ack
((
ulÚg64
) * 11 + ());

649  
”r
;

650 
	}
}

658 
	$tig”_š™
(
hash_¡©e
 *
md
)

660 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

661 
md
->
tig”
.
¡©e
[0] = 
	`CONST64
(0x0123456789ABCDEF);

662 
md
->
tig”
.
¡©e
[1] = 
	`CONST64
(0xFEDCBA9876543210);

663 
md
->
tig”
.
¡©e
[2] = 
	`CONST64
(0xF096A5B4C3B2E187);

664 
md
->
tig”
.
cu¾’
 = 0;

665 
md
->
tig”
.
Ëngth
 = 0;

666  
CRYPT_OK
;

667 
	}
}

676 
	$HASH_PROCESS
(
tig”_´oûss
, 
tig”_com´ess
, 
tig”
, 64)

684 
	$tig”_dÚe
(
hash_¡©e
 * 
md
, *
out
)

686 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

687 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

689 ià(
md
->
tig”
.
cu¾’
 >ğ(md->tig”.
buf
)) {

690  
CRYPT_INVALID_ARG
;

694 
md
->
tig”
.
Ëngth
 +ğmd->tig”.
cu¾’
 * 8;

697 
md
->
tig”
.
buf
[md->tig”.
cu¾’
++] = ()0x01;

702 ià(
md
->
tig”
.
cu¾’
 > 56) {

703 
md
->
tig”
.
cu¾’
 < 64) {

704 
md
->
tig”
.
buf
[md->tig”.
cu¾’
++] = ()0;

706 
	`tig”_com´ess
(
md
, md->
tig”
.
buf
);

707 
md
->
tig”
.
cu¾’
 = 0;

711 
md
->
tig”
.
cu¾’
 < 56) {

712 
md
->
tig”
.
buf
[md->tig”.
cu¾’
++] = ()0;

716 
	`STORE64L
(
md
->
tig”
.
Ëngth
, md->tig”.
buf
+56);

717 
	`tig”_com´ess
(
md
, md->
tig”
.
buf
);

720 
	`STORE64L
(
md
->
tig”
.
¡©e
[0], &
out
[0]);

721 
	`STORE64L
(
md
->
tig”
.
¡©e
[1], &
out
[8]);

722 
	`STORE64L
(
md
->
tig”
.
¡©e
[2], &
out
[16]);

723 #ifdeà
LTC_CLEAN_STACK


724 
	`z”omem
(
md
, (
hash_¡©e
));

727  
CRYPT_OK
;

728 
	}
}

734 
	$tig”_‹¡
()

736 #iâdeà
LTC_TEST


737  
CRYPT_NOP
;

740 *
msg
;

741 
hash
[24];

742 } 
‹¡s
[] = {

770 
i
;

771 
tmp
[24];

772 
hash_¡©e
 
md
;

774 
i
 = 0; i < ()((
‹¡s
) / (tests[0])); i++) {

775 
	`tig”_š™
(&
md
);

776 
	`tig”_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
, ()
	`¡¾’
(tests[i].msg));

777 
	`tig”_dÚe
(&
md
, 
tmp
);

778 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 24) != 0) {

779  
CRYPT_FAIL_TESTVECTOR
;

782  
CRYPT_OK
;

784 
	}
}

	@libtomcrypt/src/hashes/whirl/whirl.c

17 
	~"tomüy±.h
"

19 #ifdeà
WHIRLPOOL


21 cÚ¡ 
Éc_hash_desütÜ
 
	gwhœÍoŞ_desc
 =

32 &
whœÍoŞ_š™
,

33 &
whœÍoŞ_´oûss
,

34 &
whœÍoŞ_dÚe
,

35 &
whœÍoŞ_‹¡
,

36 
NULL


40 
	~"whœÉab.c
"

43 
	#GB
(
a
,
i
,
j
è(×[(iè& 7] >> (8 * (j))è& 255)

	)

46 
	#th‘a_pi_gamma
(
a
, 
i
) \

47 
	`SB0
(
	`GB
(
a
, 
i
-0, 7)) ^ \

48 
	`SB1
(
	`GB
(
a
, 
i
-1, 6)) ^ \

49 
	`SB2
(
	`GB
(
a
, 
i
-2, 5)) ^ \

50 
	`SB3
(
	`GB
(
a
, 
i
-3, 4)) ^ \

51 
	`SB4
(
	`GB
(
a
, 
i
-4, 3)) ^ \

52 
	`SB5
(
	`GB
(
a
, 
i
-5, 2)) ^ \

53 
	`SB6
(
	`GB
(
a
, 
i
-6, 1)) ^ \

54 
	`SB7
(
	`GB
(
a
, 
i
-7, 0))

	)

56 #ifdeà
LTC_CLEAN_STACK


57 
	$_whœÍoŞ_com´ess
(
hash_¡©e
 *
md
, *
buf
)

59 
	$whœÍoŞ_com´ess
(
hash_¡©e
 *
md
, *
buf
)

62 
ulÚg64
 
K
[2][8], 
T
[3][8];

63 
x
, 
y
;

66 
x
 = 0; x < 8; x++) {

67 
K
[0][
x
] = 
md
->
whœÍoŞ
.
¡©e
[x];

69 
	`LOAD64H
(
T
[0][
x
], 
buf
 + (8 * x));

70 
T
[2][
x
] = T[0][x];

71 
T
[0][
x
] ^ğ
K
[0][x];

75 
x
 = 0; x < 10; x += 2) {

78 
y
 = 0; y < 8; y++) {

79 
K
[1][
y
] = 
	`th‘a_pi_gamma
(K[0], y);

82 
K
[1][0] ^ğ
cÚt
[
x
];

85 
y
 = 0; y < 8; y++) {

86 
T
[1][
y
] = 
	`th‘a_pi_gamma
(T[0], yè^ 
K
[1][y];

91 
y
 = 0; y < 8; y++) {

92 
K
[0][
y
] = 
	`th‘a_pi_gamma
(K[1], y);

95 
K
[0][0] ^ğ
cÚt
[
x
+1];

98 
y
 = 0; y < 8; y++) {

99 
T
[0][
y
] = 
	`th‘a_pi_gamma
(T[1], yè^ 
K
[0][y];

104 
x
 = 0; x < 8; x++) {

105 
md
->
whœÍoŞ
.
¡©e
[
x
] ^ğ
T
[0][x] ^ T[2][x];

108  
CRYPT_OK
;

109 
	}
}

112 #ifdeà
LTC_CLEAN_STACK


113 
	$whœÍoŞ_com´ess
(
hash_¡©e
 *
md
, *
buf
)

115 
”r
;

116 
”r
 = 
	`_whœÍoŞ_com´ess
(
md
, 
buf
);

117 
	`buº_¡ack
((5 * 8 * (
ulÚg64
)) + (2 * ()));

118  
”r
;

119 
	}
}

128 
	$whœÍoŞ_š™
(
hash_¡©e
 * 
md
)

130 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

131 
	`z”omem
(&
md
->
whœÍoŞ
, (md->whirlpool));

132  
CRYPT_OK
;

133 
	}
}

142 
	$HASH_PROCESS
(
whœÍoŞ_´oûss
, 
whœÍoŞ_com´ess
, 
whœÍoŞ
, 64)

150 
	$whœÍoŞ_dÚe
(
hash_¡©e
 * 
md
, *
out
)

152 
i
;

154 
	`LTC_ARGCHK
(
md
 !ğ
NULL
);

155 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

157 ià(
md
->
whœÍoŞ
.
cu¾’
 >ğ(md->whœÍoŞ.
buf
)) {

158  
CRYPT_INVALID_ARG
;

162 
md
->
whœÍoŞ
.
Ëngth
 +ğmd->whœÍoŞ.
cu¾’
 * 8;

165 
md
->
whœÍoŞ
.
buf
[md->whœÍoŞ.
cu¾’
++] = ()0x80;

171 ià(
md
->
whœÍoŞ
.
cu¾’
 > 32) {

172 
md
->
whœÍoŞ
.
cu¾’
 < 64) {

173 
md
->
whœÍoŞ
.
buf
[md->whœÍoŞ.
cu¾’
++] = ()0;

175 
	`whœÍoŞ_com´ess
(
md
, md->
whœÍoŞ
.
buf
);

176 
md
->
whœÍoŞ
.
cu¾’
 = 0;

180 
md
->
whœÍoŞ
.
cu¾’
 < 56) {

181 
md
->
whœÍoŞ
.
buf
[md->whœÍoŞ.
cu¾’
++] = ()0;

185 
	`STORE64H
(
md
->
whœÍoŞ
.
Ëngth
, md->whœÍoŞ.
buf
+56);

186 
	`whœÍoŞ_com´ess
(
md
, md->
whœÍoŞ
.
buf
);

189 
i
 = 0; i < 8; i++) {

190 
	`STORE64H
(
md
->
whœÍoŞ
.
¡©e
[
i
], 
out
+(8*i));

192 #ifdeà
LTC_CLEAN_STACK


193 
	`z”omem
(
md
, (*md));

195  
CRYPT_OK
;

196 
	}
}

202 
	$whœÍoŞ_‹¡
()

204 #iâdeà
LTC_TEST


205  
CRYPT_NOP
;

208 
Ën
;

209 
msg
[128], 
hash
[64];

210 } 
‹¡s
[] = {

285 
i
;

286 
tmp
[64];

287 
hash_¡©e
 
md
;

289 
i
 = 0; i < ()((
‹¡s
)/(tests[0])); i++) {

290 
	`whœÍoŞ_š™
(&
md
);

291 
	`whœÍoŞ_´oûss
(&
md
, (*)
‹¡s
[
i
].
msg
,e¡s[i].
Ën
);

292 
	`whœÍoŞ_dÚe
(&
md
, 
tmp
);

293 ià(
	`XMEMCMP
(
tmp
, 
‹¡s
[
i
].
hash
, 64) != 0) {

295 
	`´štf
("\nFaede¡ %d\n", 
i
);

296 
i
 = 0; i < 64; ) {

297 
	`´štf
("%02x ", 
tmp
[
i
]);

298 ià(!(++
i
 & 15)è
	`´štf
("\n");

301  
CRYPT_FAIL_TESTVECTOR
;

304  
CRYPT_OK
;

306 
	}
}

	@libtomcrypt/src/hashes/whirl/whirltab.c

5 cÚ¡ 
ulÚg64
 
	gsbox0
[] = {

6 
CONST64
(0x18186018c07830d8), CONST64(0x23238c2305af4626), CONST64(0xc6c63fc67ef991b8), CONST64(0xe8e887e8136fcdfb),

7 
CONST64
(0x878726874ca113cb), CONST64(0xb8b8dab8a9626d11), CONST64(0x0101040108050209), CONST64(0x4f4f214f426e9e0d),

8 
CONST64
(0x3636d836adee6c9b), CONST64(0xa6a6a2a6590451ff), CONST64(0xd2d26fd2debdb90c), CONST64(0xf5f5f3f5fb06f70e),

9 
CONST64
(0x7979f979ef80f296), CONST64(0x6f6fa16f5fcede30), CONST64(0x91917e91fcef3f6d), CONST64(0x52525552aa07a4f8),

10 
CONST64
(0x60609d6027fdc047), CONST64(0xbcbccabc89766535), CONST64(0x9b9b569baccd2b37), CONST64(0x8e8e028e048c018a),

11 
CONST64
(0xa3a3b6a371155bd2), CONST64(0x0c0c300c603c186c), CONST64(0x7b7bf17bff8af684), CONST64(0x3535d435b5e16a80),

12 
CONST64
(0x1d1d741de8693af5), CONST64(0xe0e0a7e05347ddb3), CONST64(0xd7d77bd7f6acb321), CONST64(0xc2c22fc25eed999c),

13 
CONST64
(0x2e2eb82e6d965c43), CONST64(0x4b4b314b627a9629), CONST64(0xfefedffea321e15d), CONST64(0x575741578216aed5),

14 
CONST64
(0x15155415a8412abd), CONST64(0x7777c1779fb6eee8), CONST64(0x3737dc37a5eb6e92), CONST64(0xe5e5b3e57b56d79e),

15 
CONST64
(0x9f9f469f8cd92313), CONST64(0xf0f0e7f0d317fd23), CONST64(0x4a4a354a6a7f9420), CONST64(0xdada4fda9e95a944),

16 
CONST64
(0x58587d58fa25b0a2), CONST64(0xc9c903c906ca8fcf), CONST64(0x2929a429558d527c), CONST64(0x0a0a280a5022145a),

17 
CONST64
(0xb1b1feb1e14f7f50), CONST64(0xa0a0baa0691a5dc9), CONST64(0x6b6bb16b7fdad614), CONST64(0x85852e855cab17d9),

18 
CONST64
(0xbdbdcebd8173673c), CONST64(0x5d5d695dd234ba8f), CONST64(0x1010401080502090), CONST64(0xf4f4f7f4f303f507),

19 
CONST64
(0xcbcb0bcb16c08bdd), CONST64(0x3e3ef83eedc67cd3), CONST64(0x0505140528110a2d), CONST64(0x676781671fe6ce78),

20 
CONST64
(0xe4e4b7e47353d597), CONST64(0x27279c2725bb4e02), CONST64(0x4141194132588273), CONST64(0x8b8b168b2c9d0ba7),

21 
CONST64
(0xa7a7a6a7510153f6), CONST64(0x7d7de97dcf94fab2), CONST64(0x95956e95dcfb3749), CONST64(0xd8d847d88e9fad56),

22 
CONST64
(0xfbfbcbfb8b30eb70), CONST64(0xeeee9fee2371c1cd), CONST64(0x7c7ced7cc791f8bb), CONST64(0x6666856617e3cc71),

23 
CONST64
(0xdddd53dda68ea77b), CONST64(0x17175c17b84b2eaf), CONST64(0x4747014702468e45), CONST64(0x9e9e429e84dc211a),

24 
CONST64
(0xcaca0fca1ec589d4), CONST64(0x2d2db42d75995a58), CONST64(0xbfbfc6bf9179632e), CONST64(0x07071c07381b0e3f),

25 
CONST64
(0xadad8ead012347ac), CONST64(0x5a5a755aea2fb4b0), CONST64(0x838336836cb51bef), CONST64(0x3333cc3385ff66b6),

26 
CONST64
(0x636391633ff2c65c), CONST64(0x02020802100a0412), CONST64(0xaaaa92aa39384993), CONST64(0x7171d971afa8e2de),

27 
CONST64
(0xc8c807c80ecf8dc6), CONST64(0x19196419c87d32d1), CONST64(0x494939497270923b), CONST64(0xd9d943d9869aaf5f),

28 
CONST64
(0xf2f2eff2c31df931), CONST64(0xe3e3abe34b48dba8), CONST64(0x5b5b715be22ab6b9), CONST64(0x88881a8834920dbc),

29 
CONST64
(0x9a9a529aa4c8293e), CONST64(0x262698262dbe4c0b), CONST64(0x3232c8328dfa64bf), CONST64(0xb0b0fab0e94a7d59),

30 
CONST64
(0xe9e983e91b6acff2), CONST64(0x0f0f3c0f78331e77), CONST64(0xd5d573d5e6a6b733), CONST64(0x80803a8074ba1df4),

31 
CONST64
(0xbebec2be997c6127), CONST64(0xcdcd13cd26de87eb), CONST64(0x3434d034bde46889), CONST64(0x48483d487a759032),

32 
CONST64
(0xffffdbffab24e354), CONST64(0x7a7af57af78ff48d), CONST64(0x90907a90f4ea3d64), CONST64(0x5f5f615fc23ebe9d),

33 
CONST64
(0x202080201da0403d), CONST64(0x6868bd6867d5d00f), CONST64(0x1a1a681ad07234ca), CONST64(0xaeae82ae192c41b7),

34 
CONST64
(0xb4b4eab4c95e757d), CONST64(0x54544d549a19a8ce), CONST64(0x93937693ece53b7f), CONST64(0x222288220daa442f),

35 
CONST64
(0x64648d6407e9c863), CONST64(0xf1f1e3f1db12ff2a), CONST64(0x7373d173bfa2e6cc), CONST64(0x12124812905a2482),

36 
CONST64
(0x40401d403a5d807a), CONST64(0x0808200840281048), CONST64(0xc3c32bc356e89b95), CONST64(0xecec97ec337bc5df),

37 
CONST64
(0xdbdb4bdb9690ab4d), CONST64(0xa1a1bea1611f5fc0), CONST64(0x8d8d0e8d1c830791), CONST64(0x3d3df43df5c97ac8),

38 
CONST64
(0x97976697ccf1335b), CONST64(0x0000000000000000), CONST64(0xcfcf1bcf36d483f9), CONST64(0x2b2bac2b4587566e),

39 
CONST64
(0x7676c57697b3ece1), CONST64(0x8282328264b019e6), CONST64(0xd6d67fd6fea9b128), CONST64(0x1b1b6c1bd87736c3),

40 
CONST64
(0xb5b5eeb5c15b7774), CONST64(0xafaf86af112943be), CONST64(0x6a6ab56a77dfd41d), CONST64(0x50505d50ba0da0ea),

41 
CONST64
(0x45450945124c8a57), CONST64(0xf3f3ebf3cb18fb38), CONST64(0x3030c0309df060ad), CONST64(0xefef9bef2b74c3c4),

42 
CONST64
(0x3f3ffc3fe5c37eda), CONST64(0x55554955921caac7), CONST64(0xa2a2b2a2791059db), CONST64(0xeaea8fea0365c9e9),

43 
CONST64
(0x656589650fecca6a), CONST64(0xbabad2bab9686903), CONST64(0x2f2fbc2f65935e4a), CONST64(0xc0c027c04ee79d8e),

44 
CONST64
(0xdede5fdebe81a160), CONST64(0x1c1c701ce06c38fc), CONST64(0xfdfdd3fdbb2ee746), CONST64(0x4d4d294d52649a1f),

45 
CONST64
(0x92927292e4e03976), CONST64(0x7575c9758fbceafa), CONST64(0x06061806301e0c36), CONST64(0x8a8a128a249809ae),

46 
CONST64
(0xb2b2f2b2f940794b), CONST64(0xe6e6bfe66359d185), CONST64(0x0e0e380e70361c7e), CONST64(0x1f1f7c1ff8633ee7),

47 
CONST64
(0x6262956237f7c455), CONST64(0xd4d477d4eea3b53a), CONST64(0xa8a89aa829324d81), CONST64(0x96966296c4f43152),

48 
CONST64
(0xf9f9c3f99b3aef62), CONST64(0xc5c533c566f697a3), CONST64(0x2525942535b14a10), CONST64(0x59597959f220b2ab),

49 
CONST64
(0x84842a8454ae15d0), CONST64(0x7272d572b7a7e4c5), CONST64(0x3939e439d5dd72ec), CONST64(0x4c4c2d4c5a619816),

50 
CONST64
(0x5e5e655eca3bbc94), CONST64(0x7878fd78e785f09f), CONST64(0x3838e038ddd870e5), CONST64(0x8c8c0a8c14860598),

51 
CONST64
(0xd1d163d1c6b2bf17), CONST64(0xa5a5aea5410b57e4), CONST64(0xe2e2afe2434dd9a1), CONST64(0x616199612ff8c24e),

52 
CONST64
(0xb3b3f6b3f1457b42), CONST64(0x2121842115a54234), CONST64(0x9c9c4a9c94d62508), CONST64(0x1e1e781ef0663cee),

53 
CONST64
(0x4343114322528661), CONST64(0xc7c73bc776fc93b1), CONST64(0xfcfcd7fcb32be54f), CONST64(0x0404100420140824),

54 
CONST64
(0x51515951b208a2e3), CONST64(0x99995e99bcc72f25), CONST64(0x6d6da96d4fc4da22), CONST64(0x0d0d340d68391a65),

55 
CONST64
(0xfafacffa8335e979), CONST64(0xdfdf5bdfb684a369), CONST64(0x7e7ee57ed79bfca9), CONST64(0x242490243db44819),

56 
CONST64
(0x3b3bec3bc5d776fe), CONST64(0xabab96ab313d4b9a), CONST64(0xcece1fce3ed181f0), CONST64(0x1111441188552299),

57 
CONST64
(0x8f8f068f0c890383), CONST64(0x4e4e254e4a6b9c04), CONST64(0xb7b7e6b7d1517366), CONST64(0xebeb8beb0b60cbe0),

58 
CONST64
(0x3c3cf03cfdcc78c1), CONST64(0x81813e817cbf1ffd), CONST64(0x94946a94d4fe3540), CONST64(0xf7f7fbf7eb0cf31c),

59 
CONST64
(0xb9b9deb9a1676f18), CONST64(0x13134c13985f268b), CONST64(0x2c2cb02c7d9c5851), CONST64(0xd3d36bd3d6b8bb05),

60 
CONST64
(0xe7e7bbe76b5cd38c), CONST64(0x6e6ea56e57cbdc39), CONST64(0xc4c437c46ef395aa), CONST64(0x03030c03180f061b),

61 
CONST64
(0x565645568a13acdc), CONST64(0x44440d441a49885e), CONST64(0x7f7fe17fdf9efea0), CONST64(0xa9a99ea921374f88),

62 
CONST64
(0x2a2aa82a4d825467), CONST64(0xbbbbd6bbb16d6b0a), CONST64(0xc1c123c146e29f87), CONST64(0x53535153a202a6f1),

63 
CONST64
(0xdcdc57dcae8ba572), CONST64(0x0b0b2c0b58271653), CONST64(0x9d9d4e9d9cd32701), CONST64(0x6c6cad6c47c1d82b),

64 
CONST64
(0x3131c43195f562a4), CONST64(0x7474cd7487b9e8f3), CONST64(0xf6f6fff6e309f115), CONST64(0x464605460a438c4c),

65 
CONST64
(0xacac8aac092645a5), CONST64(0x89891e893c970fb5), CONST64(0x14145014a04428b4), CONST64(0xe1e1a3e15b42dfba),

66 
CONST64
(0x16165816b04e2ca6), CONST64(0x3a3ae83acdd274f7), CONST64(0x6969b9696fd0d206), CONST64(0x09092409482d1241),

67 
CONST64
(0x7070dd70a7ade0d7), CONST64(0xb6b6e2b6d954716f), CONST64(0xd0d067d0ceb7bd1e), CONST64(0xeded93ed3b7ec7d6),

68 
CONST64
(0xcccc17cc2edb85e2), CONST64(0x424215422a578468), CONST64(0x98985a98b4c22d2c), CONST64(0xa4a4aaa4490e55ed),

69 
CONST64
(0x2828a0285d885075), CONST64(0x5c5c6d5cda31b886), CONST64(0xf8f8c7f8933fed6b), CONST64(0x8686228644a411c2)

72 #ifdeà
LTC_SMALL_CODE


74 
	#SB0
(
x
è
sbox0
[x]

	)

75 
	#SB1
(
x
è
	`ROR64c
(
sbox0
[x], 8)

	)

76 
	#SB2
(
x
è
	`ROR64c
(
sbox0
[x], 16)

	)

77 
	#SB3
(
x
è
	`ROR64c
(
sbox0
[x], 24)

	)

78 
	#SB4
(
x
è
	`ROR64c
(
sbox0
[x], 32)

	)

79 
	#SB5
(
x
è
	`ROR64c
(
sbox0
[x], 40)

	)

80 
	#SB6
(
x
è
	`ROR64c
(
sbox0
[x], 48)

	)

81 
	#SB7
(
x
è
	`ROR64c
(
sbox0
[x], 56)

	)

85 
	#SB0
(
x
è
sbox0
[x]

	)

86 
	#SB1
(
x
è
sbox1
[x]

	)

87 
	#SB2
(
x
è
sbox2
[x]

	)

88 
	#SB3
(
x
è
sbox3
[x]

	)

89 
	#SB4
(
x
è
sbox4
[x]

	)

90 
	#SB5
(
x
è
sbox5
[x]

	)

91 
	#SB6
(
x
è
sbox6
[x]

	)

92 
	#SB7
(
x
è
sbox7
[x]

	)

95 cÚ¡ 
ulÚg64
 
	gsbox1
[] = {

96 
CONST64
(0xd818186018c07830), CONST64(0x2623238c2305af46), CONST64(0xb8c6c63fc67ef991), CONST64(0xfbe8e887e8136fcd),

97 
CONST64
(0xcb878726874ca113), CONST64(0x11b8b8dab8a9626d), CONST64(0x0901010401080502), CONST64(0x0d4f4f214f426e9e),

98 
CONST64
(0x9b3636d836adee6c), CONST64(0xffa6a6a2a6590451), CONST64(0x0cd2d26fd2debdb9), CONST64(0x0ef5f5f3f5fb06f7),

99 
CONST64
(0x967979f979ef80f2), CONST64(0x306f6fa16f5fcede), CONST64(0x6d91917e91fcef3f), CONST64(0xf852525552aa07a4),

100 
CONST64
(0x4760609d6027fdc0), CONST64(0x35bcbccabc897665), CONST64(0x379b9b569baccd2b), CONST64(0x8a8e8e028e048c01),

101 
CONST64
(0xd2a3a3b6a371155b), CONST64(0x6c0c0c300c603c18), CONST64(0x847b7bf17bff8af6), CONST64(0x803535d435b5e16a),

102 
CONST64
(0xf51d1d741de8693a), CONST64(0xb3e0e0a7e05347dd), CONST64(0x21d7d77bd7f6acb3), CONST64(0x9cc2c22fc25eed99),

103 
CONST64
(0x432e2eb82e6d965c), CONST64(0x294b4b314b627a96), CONST64(0x5dfefedffea321e1), CONST64(0xd5575741578216ae),

104 
CONST64
(0xbd15155415a8412a), CONST64(0xe87777c1779fb6ee), CONST64(0x923737dc37a5eb6e), CONST64(0x9ee5e5b3e57b56d7),

105 
CONST64
(0x139f9f469f8cd923), CONST64(0x23f0f0e7f0d317fd), CONST64(0x204a4a354a6a7f94), CONST64(0x44dada4fda9e95a9),

106 
CONST64
(0xa258587d58fa25b0), CONST64(0xcfc9c903c906ca8f), CONST64(0x7c2929a429558d52), CONST64(0x5a0a0a280a502214),

107 
CONST64
(0x50b1b1feb1e14f7f), CONST64(0xc9a0a0baa0691a5d), CONST64(0x146b6bb16b7fdad6), CONST64(0xd985852e855cab17),

108 
CONST64
(0x3cbdbdcebd817367), CONST64(0x8f5d5d695dd234ba), CONST64(0x9010104010805020), CONST64(0x07f4f4f7f4f303f5),

109 
CONST64
(0xddcbcb0bcb16c08b), CONST64(0xd33e3ef83eedc67c), CONST64(0x2d0505140528110a), CONST64(0x78676781671fe6ce),

110 
CONST64
(0x97e4e4b7e47353d5), CONST64(0x0227279c2725bb4e), CONST64(0x7341411941325882), CONST64(0xa78b8b168b2c9d0b),

111 
CONST64
(0xf6a7a7a6a7510153), CONST64(0xb27d7de97dcf94fa), CONST64(0x4995956e95dcfb37), CONST64(0x56d8d847d88e9fad),

112 
CONST64
(0x70fbfbcbfb8b30eb), CONST64(0xcdeeee9fee2371c1), CONST64(0xbb7c7ced7cc791f8), CONST64(0x716666856617e3cc),

113 
CONST64
(0x7bdddd53dda68ea7), CONST64(0xaf17175c17b84b2e), CONST64(0x454747014702468e), CONST64(0x1a9e9e429e84dc21),

114 
CONST64
(0xd4caca0fca1ec589), CONST64(0x582d2db42d75995a), CONST64(0x2ebfbfc6bf917963), CONST64(0x3f07071c07381b0e),

115 
CONST64
(0xacadad8ead012347), CONST64(0xb05a5a755aea2fb4), CONST64(0xef838336836cb51b), CONST64(0xb63333cc3385ff66),

116 
CONST64
(0x5c636391633ff2c6), CONST64(0x1202020802100a04), CONST64(0x93aaaa92aa393849), CONST64(0xde7171d971afa8e2),

117 
CONST64
(0xc6c8c807c80ecf8d), CONST64(0xd119196419c87d32), CONST64(0x3b49493949727092), CONST64(0x5fd9d943d9869aaf),

118 
CONST64
(0x31f2f2eff2c31df9), CONST64(0xa8e3e3abe34b48db), CONST64(0xb95b5b715be22ab6), CONST64(0xbc88881a8834920d),

119 
CONST64
(0x3e9a9a529aa4c829), CONST64(0x0b262698262dbe4c), CONST64(0xbf3232c8328dfa64), CONST64(0x59b0b0fab0e94a7d),

120 
CONST64
(0xf2e9e983e91b6acf), CONST64(0x770f0f3c0f78331e), CONST64(0x33d5d573d5e6a6b7), CONST64(0xf480803a8074ba1d),

121 
CONST64
(0x27bebec2be997c61), CONST64(0xebcdcd13cd26de87), CONST64(0x893434d034bde468), CONST64(0x3248483d487a7590),

122 
CONST64
(0x54ffffdbffab24e3), CONST64(0x8d7a7af57af78ff4), CONST64(0x6490907a90f4ea3d), CONST64(0x9d5f5f615fc23ebe),

123 
CONST64
(0x3d202080201da040), CONST64(0x0f6868bd6867d5d0), CONST64(0xca1a1a681ad07234), CONST64(0xb7aeae82ae192c41),

124 
CONST64
(0x7db4b4eab4c95e75), CONST64(0xce54544d549a19a8), CONST64(0x7f93937693ece53b), CONST64(0x2f222288220daa44),

125 
CONST64
(0x6364648d6407e9c8), CONST64(0x2af1f1e3f1db12ff), CONST64(0xcc7373d173bfa2e6), CONST64(0x8212124812905a24),

126 
CONST64
(0x7a40401d403a5d80), CONST64(0x4808082008402810), CONST64(0x95c3c32bc356e89b), CONST64(0xdfecec97ec337bc5),

127 
CONST64
(0x4ddbdb4bdb9690ab), CONST64(0xc0a1a1bea1611f5f), CONST64(0x918d8d0e8d1c8307), CONST64(0xc83d3df43df5c97a),

128 
CONST64
(0x5b97976697ccf133), CONST64(0x0000000000000000), CONST64(0xf9cfcf1bcf36d483), CONST64(0x6e2b2bac2b458756),

129 
CONST64
(0xe17676c57697b3ec), CONST64(0xe68282328264b019), CONST64(0x28d6d67fd6fea9b1), CONST64(0xc31b1b6c1bd87736),

130 
CONST64
(0x74b5b5eeb5c15b77), CONST64(0xbeafaf86af112943), CONST64(0x1d6a6ab56a77dfd4), CONST64(0xea50505d50ba0da0),

131 
CONST64
(0x5745450945124c8a), CONST64(0x38f3f3ebf3cb18fb), CONST64(0xad3030c0309df060), CONST64(0xc4efef9bef2b74c3),

132 
CONST64
(0xda3f3ffc3fe5c37e), CONST64(0xc755554955921caa), CONST64(0xdba2a2b2a2791059), CONST64(0xe9eaea8fea0365c9),

133 
CONST64
(0x6a656589650fecca), CONST64(0x03babad2bab96869), CONST64(0x4a2f2fbc2f65935e), CONST64(0x8ec0c027c04ee79d),

134 
CONST64
(0x60dede5fdebe81a1), CONST64(0xfc1c1c701ce06c38), CONST64(0x46fdfdd3fdbb2ee7), CONST64(0x1f4d4d294d52649a),

135 
CONST64
(0x7692927292e4e039), CONST64(0xfa7575c9758fbcea), CONST64(0x3606061806301e0c), CONST64(0xae8a8a128a249809),

136 
CONST64
(0x4bb2b2f2b2f94079), CONST64(0x85e6e6bfe66359d1), CONST64(0x7e0e0e380e70361c), CONST64(0xe71f1f7c1ff8633e),

137 
CONST64
(0x556262956237f7c4), CONST64(0x3ad4d477d4eea3b5), CONST64(0x81a8a89aa829324d), CONST64(0x5296966296c4f431),

138 
CONST64
(0x62f9f9c3f99b3aef), CONST64(0xa3c5c533c566f697), CONST64(0x102525942535b14a), CONST64(0xab59597959f220b2),

139 
CONST64
(0xd084842a8454ae15), CONST64(0xc57272d572b7a7e4), CONST64(0xec3939e439d5dd72), CONST64(0x164c4c2d4c5a6198),

140 
CONST64
(0x945e5e655eca3bbc), CONST64(0x9f7878fd78e785f0), CONST64(0xe53838e038ddd870), CONST64(0x988c8c0a8c148605),

141 
CONST64
(0x17d1d163d1c6b2bf), CONST64(0xe4a5a5aea5410b57), CONST64(0xa1e2e2afe2434dd9), CONST64(0x4e616199612ff8c2),

142 
CONST64
(0x42b3b3f6b3f1457b), CONST64(0x342121842115a542), CONST64(0x089c9c4a9c94d625), CONST64(0xee1e1e781ef0663c),

143 
CONST64
(0x6143431143225286), CONST64(0xb1c7c73bc776fc93), CONST64(0x4ffcfcd7fcb32be5), CONST64(0x2404041004201408),

144 
CONST64
(0xe351515951b208a2), CONST64(0x2599995e99bcc72f), CONST64(0x226d6da96d4fc4da), CONST64(0x650d0d340d68391a),

145 
CONST64
(0x79fafacffa8335e9), CONST64(0x69dfdf5bdfb684a3), CONST64(0xa97e7ee57ed79bfc), CONST64(0x19242490243db448),

146 
CONST64
(0xfe3b3bec3bc5d776), CONST64(0x9aabab96ab313d4b), CONST64(0xf0cece1fce3ed181), CONST64(0x9911114411885522),

147 
CONST64
(0x838f8f068f0c8903), CONST64(0x044e4e254e4a6b9c), CONST64(0x66b7b7e6b7d15173), CONST64(0xe0ebeb8beb0b60cb),

148 
CONST64
(0xc13c3cf03cfdcc78), CONST64(0xfd81813e817cbf1f), CONST64(0x4094946a94d4fe35), CONST64(0x1cf7f7fbf7eb0cf3),

149 
CONST64
(0x18b9b9deb9a1676f), CONST64(0x8b13134c13985f26), CONST64(0x512c2cb02c7d9c58), CONST64(0x05d3d36bd3d6b8bb),

150 
CONST64
(0x8ce7e7bbe76b5cd3), CONST64(0x396e6ea56e57cbdc), CONST64(0xaac4c437c46ef395), CONST64(0x1b03030c03180f06),

151 
CONST64
(0xdc565645568a13ac), CONST64(0x5e44440d441a4988), CONST64(0xa07f7fe17fdf9efe), CONST64(0x88a9a99ea921374f),

152 
CONST64
(0x672a2aa82a4d8254), CONST64(0x0abbbbd6bbb16d6b), CONST64(0x87c1c123c146e29f), CONST64(0xf153535153a202a6),

153 
CONST64
(0x72dcdc57dcae8ba5), CONST64(0x530b0b2c0b582716), CONST64(0x019d9d4e9d9cd327), CONST64(0x2b6c6cad6c47c1d8),

154 
CONST64
(0xa43131c43195f562), CONST64(0xf37474cd7487b9e8), CONST64(0x15f6f6fff6e309f1), CONST64(0x4c464605460a438c),

155 
CONST64
(0xa5acac8aac092645), CONST64(0xb589891e893c970f), CONST64(0xb414145014a04428), CONST64(0xbae1e1a3e15b42df),

156 
CONST64
(0xa616165816b04e2c), CONST64(0xf73a3ae83acdd274), CONST64(0x066969b9696fd0d2), CONST64(0x4109092409482d12),

157 
CONST64
(0xd77070dd70a7ade0), CONST64(0x6fb6b6e2b6d95471), CONST64(0x1ed0d067d0ceb7bd), CONST64(0xd6eded93ed3b7ec7),

158 
CONST64
(0xe2cccc17cc2edb85), CONST64(0x68424215422a5784), CONST64(0x2c98985a98b4c22d), CONST64(0xeda4a4aaa4490e55),

159 
CONST64
(0x752828a0285d8850), CONST64(0x865c5c6d5cda31b8), CONST64(0x6bf8f8c7f8933fed), CONST64(0xc28686228644a411)

162 cÚ¡ 
ulÚg64
 
	gsbox2
[] = {

163 
CONST64
(0x30d818186018c078), CONST64(0x462623238c2305af), CONST64(0x91b8c6c63fc67ef9), CONST64(0xcdfbe8e887e8136f),

164 
CONST64
(0x13cb878726874ca1), CONST64(0x6d11b8b8dab8a962), CONST64(0x0209010104010805), CONST64(0x9e0d4f4f214f426e),

165 
CONST64
(0x6c9b3636d836adee), CONST64(0x51ffa6a6a2a65904), CONST64(0xb90cd2d26fd2debd), CONST64(0xf70ef5f5f3f5fb06),

166 
CONST64
(0xf2967979f979ef80), CONST64(0xde306f6fa16f5fce), CONST64(0x3f6d91917e91fcef), CONST64(0xa4f852525552aa07),

167 
CONST64
(0xc04760609d6027fd), CONST64(0x6535bcbccabc8976), CONST64(0x2b379b9b569baccd), CONST64(0x018a8e8e028e048c),

168 
CONST64
(0x5bd2a3a3b6a37115), CONST64(0x186c0c0c300c603c), CONST64(0xf6847b7bf17bff8a), CONST64(0x6a803535d435b5e1),

169 
CONST64
(0x3af51d1d741de869), CONST64(0xddb3e0e0a7e05347), CONST64(0xb321d7d77bd7f6ac), CONST64(0x999cc2c22fc25eed),

170 
CONST64
(0x5c432e2eb82e6d96), CONST64(0x96294b4b314b627a), CONST64(0xe15dfefedffea321), CONST64(0xaed5575741578216),

171 
CONST64
(0x2abd15155415a841), CONST64(0xeee87777c1779fb6), CONST64(0x6e923737dc37a5eb), CONST64(0xd79ee5e5b3e57b56),

172 
CONST64
(0x23139f9f469f8cd9), CONST64(0xfd23f0f0e7f0d317), CONST64(0x94204a4a354a6a7f), CONST64(0xa944dada4fda9e95),

173 
CONST64
(0xb0a258587d58fa25), CONST64(0x8fcfc9c903c906ca), CONST64(0x527c2929a429558d), CONST64(0x145a0a0a280a5022),

174 
CONST64
(0x7f50b1b1feb1e14f), CONST64(0x5dc9a0a0baa0691a), CONST64(0xd6146b6bb16b7fda), CONST64(0x17d985852e855cab),

175 
CONST64
(0x673cbdbdcebd8173), CONST64(0xba8f5d5d695dd234), CONST64(0x2090101040108050), CONST64(0xf507f4f4f7f4f303),

176 
CONST64
(0x8bddcbcb0bcb16c0), CONST64(0x7cd33e3ef83eedc6), CONST64(0x0a2d050514052811), CONST64(0xce78676781671fe6),

177 
CONST64
(0xd597e4e4b7e47353), CONST64(0x4e0227279c2725bb), CONST64(0x8273414119413258), CONST64(0x0ba78b8b168b2c9d),

178 
CONST64
(0x53f6a7a7a6a75101), CONST64(0xfab27d7de97dcf94), CONST64(0x374995956e95dcfb), CONST64(0xad56d8d847d88e9f),

179 
CONST64
(0xeb70fbfbcbfb8b30), CONST64(0xc1cdeeee9fee2371), CONST64(0xf8bb7c7ced7cc791), CONST64(0xcc716666856617e3),

180 
CONST64
(0xa77bdddd53dda68e), CONST64(0x2eaf17175c17b84b), CONST64(0x8e45474701470246), CONST64(0x211a9e9e429e84dc),

181 
CONST64
(0x89d4caca0fca1ec5), CONST64(0x5a582d2db42d7599), CONST64(0x632ebfbfc6bf9179), CONST64(0x0e3f07071c07381b),

182 
CONST64
(0x47acadad8ead0123), CONST64(0xb4b05a5a755aea2f), CONST64(0x1bef838336836cb5), CONST64(0x66b63333cc3385ff),

183 
CONST64
(0xc65c636391633ff2), CONST64(0x041202020802100a), CONST64(0x4993aaaa92aa3938), CONST64(0xe2de7171d971afa8),

184 
CONST64
(0x8dc6c8c807c80ecf), CONST64(0x32d119196419c87d), CONST64(0x923b494939497270), CONST64(0xaf5fd9d943d9869a),

185 
CONST64
(0xf931f2f2eff2c31d), CONST64(0xdba8e3e3abe34b48), CONST64(0xb6b95b5b715be22a), CONST64(0x0dbc88881a883492),

186 
CONST64
(0x293e9a9a529aa4c8), CONST64(0x4c0b262698262dbe), CONST64(0x64bf3232c8328dfa), CONST64(0x7d59b0b0fab0e94a),

187 
CONST64
(0xcff2e9e983e91b6a), CONST64(0x1e770f0f3c0f7833), CONST64(0xb733d5d573d5e6a6), CONST64(0x1df480803a8074ba),

188 
CONST64
(0x6127bebec2be997c), CONST64(0x87ebcdcd13cd26de), CONST64(0x68893434d034bde4), CONST64(0x903248483d487a75),

189 
CONST64
(0xe354ffffdbffab24), CONST64(0xf48d7a7af57af78f), CONST64(0x3d6490907a90f4ea), CONST64(0xbe9d5f5f615fc23e),

190 
CONST64
(0x403d202080201da0), CONST64(0xd00f6868bd6867d5), CONST64(0x34ca1a1a681ad072), CONST64(0x41b7aeae82ae192c),

191 
CONST64
(0x757db4b4eab4c95e), CONST64(0xa8ce54544d549a19), CONST64(0x3b7f93937693ece5), CONST64(0x442f222288220daa),

192 
CONST64
(0xc86364648d6407e9), CONST64(0xff2af1f1e3f1db12), CONST64(0xe6cc7373d173bfa2), CONST64(0x248212124812905a),

193 
CONST64
(0x807a40401d403a5d), CONST64(0x1048080820084028), CONST64(0x9b95c3c32bc356e8), CONST64(0xc5dfecec97ec337b),

194 
CONST64
(0xab4ddbdb4bdb9690), CONST64(0x5fc0a1a1bea1611f), CONST64(0x07918d8d0e8d1c83), CONST64(0x7ac83d3df43df5c9),

195 
CONST64
(0x335b97976697ccf1), CONST64(0x0000000000000000), CONST64(0x83f9cfcf1bcf36d4), CONST64(0x566e2b2bac2b4587),

196 
CONST64
(0xece17676c57697b3), CONST64(0x19e68282328264b0), CONST64(0xb128d6d67fd6fea9), CONST64(0x36c31b1b6c1bd877),

197 
CONST64
(0x7774b5b5eeb5c15b), CONST64(0x43beafaf86af1129), CONST64(0xd41d6a6ab56a77df), CONST64(0xa0ea50505d50ba0d),

198 
CONST64
(0x8a5745450945124c), CONST64(0xfb38f3f3ebf3cb18), CONST64(0x60ad3030c0309df0), CONST64(0xc3c4efef9bef2b74),

199 
CONST64
(0x7eda3f3ffc3fe5c3), CONST64(0xaac755554955921c), CONST64(0x59dba2a2b2a27910), CONST64(0xc9e9eaea8fea0365),

200 
CONST64
(0xca6a656589650fec), CONST64(0x6903babad2bab968), CONST64(0x5e4a2f2fbc2f6593), CONST64(0x9d8ec0c027c04ee7),

201 
CONST64
(0xa160dede5fdebe81), CONST64(0x38fc1c1c701ce06c), CONST64(0xe746fdfdd3fdbb2e), CONST64(0x9a1f4d4d294d5264),

202 
CONST64
(0x397692927292e4e0), CONST64(0xeafa7575c9758fbc), CONST64(0x0c3606061806301e), CONST64(0x09ae8a8a128a2498),

203 
CONST64
(0x794bb2b2f2b2f940), CONST64(0xd185e6e6bfe66359), CONST64(0x1c7e0e0e380e7036), CONST64(0x3ee71f1f7c1ff863),

204 
CONST64
(0xc4556262956237f7), CONST64(0xb53ad4d477d4eea3), CONST64(0x4d81a8a89aa82932), CONST64(0x315296966296c4f4),

205 
CONST64
(0xef62f9f9c3f99b3a), CONST64(0x97a3c5c533c566f6), CONST64(0x4a102525942535b1), CONST64(0xb2ab59597959f220),

206 
CONST64
(0x15d084842a8454ae), CONST64(0xe4c57272d572b7a7), CONST64(0x72ec3939e439d5dd), CONST64(0x98164c4c2d4c5a61),

207 
CONST64
(0xbc945e5e655eca3b), CONST64(0xf09f7878fd78e785), CONST64(0x70e53838e038ddd8), CONST64(0x05988c8c0a8c1486),

208 
CONST64
(0xbf17d1d163d1c6b2), CONST64(0x57e4a5a5aea5410b), CONST64(0xd9a1e2e2afe2434d), CONST64(0xc24e616199612ff8),

209 
CONST64
(0x7b42b3b3f6b3f145), CONST64(0x42342121842115a5), CONST64(0x25089c9c4a9c94d6), CONST64(0x3cee1e1e781ef066),

210 
CONST64
(0x8661434311432252), CONST64(0x93b1c7c73bc776fc), CONST64(0xe54ffcfcd7fcb32b), CONST64(0x0824040410042014),

211 
CONST64
(0xa2e351515951b208), CONST64(0x2f2599995e99bcc7), CONST64(0xda226d6da96d4fc4), CONST64(0x1a650d0d340d6839),

212 
CONST64
(0xe979fafacffa8335), CONST64(0xa369dfdf5bdfb684), CONST64(0xfca97e7ee57ed79b), CONST64(0x4819242490243db4),

213 
CONST64
(0x76fe3b3bec3bc5d7), CONST64(0x4b9aabab96ab313d), CONST64(0x81f0cece1fce3ed1), CONST64(0x2299111144118855),

214 
CONST64
(0x03838f8f068f0c89), CONST64(0x9c044e4e254e4a6b), CONST64(0x7366b7b7e6b7d151), CONST64(0xcbe0ebeb8beb0b60),

215 
CONST64
(0x78c13c3cf03cfdcc), CONST64(0x1ffd81813e817cbf), CONST64(0x354094946a94d4fe), CONST64(0xf31cf7f7fbf7eb0c),

216 
CONST64
(0x6f18b9b9deb9a167), CONST64(0x268b13134c13985f), CONST64(0x58512c2cb02c7d9c), CONST64(0xbb05d3d36bd3d6b8),

217 
CONST64
(0xd38ce7e7bbe76b5c), CONST64(0xdc396e6ea56e57cb), CONST64(0x95aac4c437c46ef3), CONST64(0x061b03030c03180f),

218 
CONST64
(0xacdc565645568a13), CONST64(0x885e44440d441a49), CONST64(0xfea07f7fe17fdf9e), CONST64(0x4f88a9a99ea92137),

219 
CONST64
(0x54672a2aa82a4d82), CONST64(0x6b0abbbbd6bbb16d), CONST64(0x9f87c1c123c146e2), CONST64(0xa6f153535153a202),

220 
CONST64
(0xa572dcdc57dcae8b), CONST64(0x16530b0b2c0b5827), CONST64(0x27019d9d4e9d9cd3), CONST64(0xd82b6c6cad6c47c1),

221 
CONST64
(0x62a43131c43195f5), CONST64(0xe8f37474cd7487b9), CONST64(0xf115f6f6fff6e309), CONST64(0x8c4c464605460a43),

222 
CONST64
(0x45a5acac8aac0926), CONST64(0x0fb589891e893c97), CONST64(0x28b414145014a044), CONST64(0xdfbae1e1a3e15b42),

223 
CONST64
(0x2ca616165816b04e), CONST64(0x74f73a3ae83acdd2), CONST64(0xd2066969b9696fd0), CONST64(0x124109092409482d),

224 
CONST64
(0xe0d77070dd70a7ad), CONST64(0x716fb6b6e2b6d954), CONST64(0xbd1ed0d067d0ceb7), CONST64(0xc7d6eded93ed3b7e),

225 
CONST64
(0x85e2cccc17cc2edb), CONST64(0x8468424215422a57), CONST64(0x2d2c98985a98b4c2), CONST64(0x55eda4a4aaa4490e),

226 
CONST64
(0x50752828a0285d88), CONST64(0xb8865c5c6d5cda31), CONST64(0xed6bf8f8c7f8933f), CONST64(0x11c28686228644a4)

229 cÚ¡ 
ulÚg64
 
	gsbox3
[] = {

230 
CONST64
(0x7830d818186018c0), CONST64(0xaf462623238c2305), CONST64(0xf991b8c6c63fc67e), CONST64(0x6fcdfbe8e887e813),

231 
CONST64
(0xa113cb878726874c), CONST64(0x626d11b8b8dab8a9), CONST64(0x0502090101040108), CONST64(0x6e9e0d4f4f214f42),

232 
CONST64
(0xee6c9b3636d836ad), CONST64(0x0451ffa6a6a2a659), CONST64(0xbdb90cd2d26fd2de), CONST64(0x06f70ef5f5f3f5fb),

233 
CONST64
(0x80f2967979f979ef), CONST64(0xcede306f6fa16f5f), CONST64(0xef3f6d91917e91fc), CONST64(0x07a4f852525552aa),

234 
CONST64
(0xfdc04760609d6027), CONST64(0x766535bcbccabc89), CONST64(0xcd2b379b9b569bac), CONST64(0x8c018a8e8e028e04),

235 
CONST64
(0x155bd2a3a3b6a371), CONST64(0x3c186c0c0c300c60), CONST64(0x8af6847b7bf17bff), CONST64(0xe16a803535d435b5),

236 
CONST64
(0x693af51d1d741de8), CONST64(0x47ddb3e0e0a7e053), CONST64(0xacb321d7d77bd7f6), CONST64(0xed999cc2c22fc25e),

237 
CONST64
(0x965c432e2eb82e6d), CONST64(0x7a96294b4b314b62), CONST64(0x21e15dfefedffea3), CONST64(0x16aed55757415782),

238 
CONST64
(0x412abd15155415a8), CONST64(0xb6eee87777c1779f), CONST64(0xeb6e923737dc37a5), CONST64(0x56d79ee5e5b3e57b),

239 
CONST64
(0xd923139f9f469f8c), CONST64(0x17fd23f0f0e7f0d3), CONST64(0x7f94204a4a354a6a), CONST64(0x95a944dada4fda9e),

240 
CONST64
(0x25b0a258587d58fa), CONST64(0xca8fcfc9c903c906), CONST64(0x8d527c2929a42955), CONST64(0x22145a0a0a280a50),

241 
CONST64
(0x4f7f50b1b1feb1e1), CONST64(0x1a5dc9a0a0baa069), CONST64(0xdad6146b6bb16b7f), CONST64(0xab17d985852e855c),

242 
CONST64
(0x73673cbdbdcebd81), CONST64(0x34ba8f5d5d695dd2), CONST64(0x5020901010401080), CONST64(0x03f507f4f4f7f4f3),

243 
CONST64
(0xc08bddcbcb0bcb16), CONST64(0xc67cd33e3ef83eed), CONST64(0x110a2d0505140528), CONST64(0xe6ce78676781671f),

244 
CONST64
(0x53d597e4e4b7e473), CONST64(0xbb4e0227279c2725), CONST64(0x5882734141194132), CONST64(0x9d0ba78b8b168b2c),

245 
CONST64
(0x0153f6a7a7a6a751), CONST64(0x94fab27d7de97dcf), CONST64(0xfb374995956e95dc), CONST64(0x9fad56d8d847d88e),

246 
CONST64
(0x30eb70fbfbcbfb8b), CONST64(0x71c1cdeeee9fee23), CONST64(0x91f8bb7c7ced7cc7), CONST64(0xe3cc716666856617),

247 
CONST64
(0x8ea77bdddd53dda6), CONST64(0x4b2eaf17175c17b8), CONST64(0x468e454747014702), CONST64(0xdc211a9e9e429e84),

248 
CONST64
(0xc589d4caca0fca1e), CONST64(0x995a582d2db42d75), CONST64(0x79632ebfbfc6bf91), CONST64(0x1b0e3f07071c0738),

249 
CONST64
(0x2347acadad8ead01), CONST64(0x2fb4b05a5a755aea), CONST64(0xb51bef838336836c), CONST64(0xff66b63333cc3385),

250 
CONST64
(0xf2c65c636391633f), CONST64(0x0a04120202080210), CONST64(0x384993aaaa92aa39), CONST64(0xa8e2de7171d971af),

251 
CONST64
(0xcf8dc6c8c807c80e), CONST64(0x7d32d119196419c8), CONST64(0x70923b4949394972), CONST64(0x9aaf5fd9d943d986),

252 
CONST64
(0x1df931f2f2eff2c3), CONST64(0x48dba8e3e3abe34b), CONST64(0x2ab6b95b5b715be2), CONST64(0x920dbc88881a8834),

253 
CONST64
(0xc8293e9a9a529aa4), CONST64(0xbe4c0b262698262d), CONST64(0xfa64bf3232c8328d), CONST64(0x4a7d59b0b0fab0e9),

254 
CONST64
(0x6acff2e9e983e91b), CONST64(0x331e770f0f3c0f78), CONST64(0xa6b733d5d573d5e6), CONST64(0xba1df480803a8074),

255 
CONST64
(0x7c6127bebec2be99), CONST64(0xde87ebcdcd13cd26), CONST64(0xe468893434d034bd), CONST64(0x75903248483d487a),

256 
CONST64
(0x24e354ffffdbffab), CONST64(0x8ff48d7a7af57af7), CONST64(0xea3d6490907a90f4), CONST64(0x3ebe9d5f5f615fc2),

257 
CONST64
(0xa0403d202080201d), CONST64(0xd5d00f6868bd6867), CONST64(0x7234ca1a1a681ad0), CONST64(0x2c41b7aeae82ae19),

258 
CONST64
(0x5e757db4b4eab4c9), CONST64(0x19a8ce54544d549a), CONST64(0xe53b7f93937693ec), CONST64(0xaa442f222288220d),

259 
CONST64
(0xe9c86364648d6407), CONST64(0x12ff2af1f1e3f1db), CONST64(0xa2e6cc7373d173bf), CONST64(0x5a24821212481290),

260 
CONST64
(0x5d807a40401d403a), CONST64(0x2810480808200840), CONST64(0xe89b95c3c32bc356), CONST64(0x7bc5dfecec97ec33),

261 
CONST64
(0x90ab4ddbdb4bdb96), CONST64(0x1f5fc0a1a1bea161), CONST64(0x8307918d8d0e8d1c), CONST64(0xc97ac83d3df43df5),

262 
CONST64
(0xf1335b97976697cc), CONST64(0x0000000000000000), CONST64(0xd483f9cfcf1bcf36), CONST64(0x87566e2b2bac2b45),

263 
CONST64
(0xb3ece17676c57697), CONST64(0xb019e68282328264), CONST64(0xa9b128d6d67fd6fe), CONST64(0x7736c31b1b6c1bd8),

264 
CONST64
(0x5b7774b5b5eeb5c1), CONST64(0x2943beafaf86af11), CONST64(0xdfd41d6a6ab56a77), CONST64(0x0da0ea50505d50ba),

265 
CONST64
(0x4c8a574545094512), CONST64(0x18fb38f3f3ebf3cb), CONST64(0xf060ad3030c0309d), CONST64(0x74c3c4efef9bef2b),

266 
CONST64
(0xc37eda3f3ffc3fe5), CONST64(0x1caac75555495592), CONST64(0x1059dba2a2b2a279), CONST64(0x65c9e9eaea8fea03),

267 
CONST64
(0xecca6a656589650f), CONST64(0x686903babad2bab9), CONST64(0x935e4a2f2fbc2f65), CONST64(0xe79d8ec0c027c04e),

268 
CONST64
(0x81a160dede5fdebe), CONST64(0x6c38fc1c1c701ce0), CONST64(0x2ee746fdfdd3fdbb), CONST64(0x649a1f4d4d294d52),

269 
CONST64
(0xe0397692927292e4), CONST64(0xbceafa7575c9758f), CONST64(0x1e0c360606180630), CONST64(0x9809ae8a8a128a24),

270 
CONST64
(0x40794bb2b2f2b2f9), CONST64(0x59d185e6e6bfe663), CONST64(0x361c7e0e0e380e70), CONST64(0x633ee71f1f7c1ff8),

271 
CONST64
(0xf7c4556262956237), CONST64(0xa3b53ad4d477d4ee), CONST64(0x324d81a8a89aa829), CONST64(0xf4315296966296c4),

272 
CONST64
(0x3aef62f9f9c3f99b), CONST64(0xf697a3c5c533c566), CONST64(0xb14a102525942535), CONST64(0x20b2ab59597959f2),

273 
CONST64
(0xae15d084842a8454), CONST64(0xa7e4c57272d572b7), CONST64(0xdd72ec3939e439d5), CONST64(0x6198164c4c2d4c5a),

274 
CONST64
(0x3bbc945e5e655eca), CONST64(0x85f09f7878fd78e7), CONST64(0xd870e53838e038dd), CONST64(0x8605988c8c0a8c14),

275 
CONST64
(0xb2bf17d1d163d1c6), CONST64(0x0b57e4a5a5aea541), CONST64(0x4dd9a1e2e2afe243), CONST64(0xf8c24e616199612f),

276 
CONST64
(0x457b42b3b3f6b3f1), CONST64(0xa542342121842115), CONST64(0xd625089c9c4a9c94), CONST64(0x663cee1e1e781ef0),

277 
CONST64
(0x5286614343114322), CONST64(0xfc93b1c7c73bc776), CONST64(0x2be54ffcfcd7fcb3), CONST64(0x1408240404100420),

278 
CONST64
(0x08a2e351515951b2), CONST64(0xc72f2599995e99bc), CONST64(0xc4da226d6da96d4f), CONST64(0x391a650d0d340d68),

279 
CONST64
(0x35e979fafacffa83), CONST64(0x84a369dfdf5bdfb6), CONST64(0x9bfca97e7ee57ed7), CONST64(0xb44819242490243d),

280 
CONST64
(0xd776fe3b3bec3bc5), CONST64(0x3d4b9aabab96ab31), CONST64(0xd181f0cece1fce3e), CONST64(0x5522991111441188),

281 
CONST64
(0x8903838f8f068f0c), CONST64(0x6b9c044e4e254e4a), CONST64(0x517366b7b7e6b7d1), CONST64(0x60cbe0ebeb8beb0b),

282 
CONST64
(0xcc78c13c3cf03cfd), CONST64(0xbf1ffd81813e817c), CONST64(0xfe354094946a94d4), CONST64(0x0cf31cf7f7fbf7eb),

283 
CONST64
(0x676f18b9b9deb9a1), CONST64(0x5f268b13134c1398), CONST64(0x9c58512c2cb02c7d), CONST64(0xb8bb05d3d36bd3d6),

284 
CONST64
(0x5cd38ce7e7bbe76b), CONST64(0xcbdc396e6ea56e57), CONST64(0xf395aac4c437c46e), CONST64(0x0f061b03030c0318),

285 
CONST64
(0x13acdc565645568a), CONST64(0x49885e44440d441a), CONST64(0x9efea07f7fe17fdf), CONST64(0x374f88a9a99ea921),

286 
CONST64
(0x8254672a2aa82a4d), CONST64(0x6d6b0abbbbd6bbb1), CONST64(0xe29f87c1c123c146), CONST64(0x02a6f153535153a2),

287 
CONST64
(0x8ba572dcdc57dcae), CONST64(0x2716530b0b2c0b58), CONST64(0xd327019d9d4e9d9c), CONST64(0xc1d82b6c6cad6c47),

288 
CONST64
(0xf562a43131c43195), CONST64(0xb9e8f37474cd7487), CONST64(0x09f115f6f6fff6e3), CONST64(0x438c4c464605460a),

289 
CONST64
(0x2645a5acac8aac09), CONST64(0x970fb589891e893c), CONST64(0x4428b414145014a0), CONST64(0x42dfbae1e1a3e15b),

290 
CONST64
(0x4e2ca616165816b0), CONST64(0xd274f73a3ae83acd), CONST64(0xd0d2066969b9696f), CONST64(0x2d12410909240948),

291 
CONST64
(0xade0d77070dd70a7), CONST64(0x54716fb6b6e2b6d9), CONST64(0xb7bd1ed0d067d0ce), CONST64(0x7ec7d6eded93ed3b),

292 
CONST64
(0xdb85e2cccc17cc2e), CONST64(0x578468424215422a), CONST64(0xc22d2c98985a98b4), CONST64(0x0e55eda4a4aaa449),

293 
CONST64
(0x8850752828a0285d), CONST64(0x31b8865c5c6d5cda), CONST64(0x3fed6bf8f8c7f893), CONST64(0xa411c28686228644)

296 cÚ¡ 
ulÚg64
 
	gsbox4
[] = {

297 
CONST64
(0xc07830d818186018), CONST64(0x05af462623238c23), CONST64(0x7ef991b8c6c63fc6), CONST64(0x136fcdfbe8e887e8),

298 
CONST64
(0x4ca113cb87872687), CONST64(0xa9626d11b8b8dab8), CONST64(0x0805020901010401), CONST64(0x426e9e0d4f4f214f),

299 
CONST64
(0xadee6c9b3636d836), CONST64(0x590451ffa6a6a2a6), CONST64(0xdebdb90cd2d26fd2), CONST64(0xfb06f70ef5f5f3f5),

300 
CONST64
(0xef80f2967979f979), CONST64(0x5fcede306f6fa16f), CONST64(0xfcef3f6d91917e91), CONST64(0xaa07a4f852525552),

301 
CONST64
(0x27fdc04760609d60), CONST64(0x89766535bcbccabc), CONST64(0xaccd2b379b9b569b), CONST64(0x048c018a8e8e028e),

302 
CONST64
(0x71155bd2a3a3b6a3), CONST64(0x603c186c0c0c300c), CONST64(0xff8af6847b7bf17b), CONST64(0xb5e16a803535d435),

303 
CONST64
(0xe8693af51d1d741d), CONST64(0x5347ddb3e0e0a7e0), CONST64(0xf6acb321d7d77bd7), CONST64(0x5eed999cc2c22fc2),

304 
CONST64
(0x6d965c432e2eb82e), CONST64(0x627a96294b4b314b), CONST64(0xa321e15dfefedffe), CONST64(0x8216aed557574157),

305 
CONST64
(0xa8412abd15155415), CONST64(0x9fb6eee87777c177), CONST64(0xa5eb6e923737dc37), CONST64(0x7b56d79ee5e5b3e5),

306 
CONST64
(0x8cd923139f9f469f), CONST64(0xd317fd23f0f0e7f0), CONST64(0x6a7f94204a4a354a), CONST64(0x9e95a944dada4fda),

307 
CONST64
(0xfa25b0a258587d58), CONST64(0x06ca8fcfc9c903c9), CONST64(0x558d527c2929a429), CONST64(0x5022145a0a0a280a),

308 
CONST64
(0xe14f7f50b1b1feb1), CONST64(0x691a5dc9a0a0baa0), CONST64(0x7fdad6146b6bb16b), CONST64(0x5cab17d985852e85),

309 
CONST64
(0x8173673cbdbdcebd), CONST64(0xd234ba8f5d5d695d), CONST64(0x8050209010104010), CONST64(0xf303f507f4f4f7f4),

310 
CONST64
(0x16c08bddcbcb0bcb), CONST64(0xedc67cd33e3ef83e), CONST64(0x28110a2d05051405), CONST64(0x1fe6ce7867678167),

311 
CONST64
(0x7353d597e4e4b7e4), CONST64(0x25bb4e0227279c27), CONST64(0x3258827341411941), CONST64(0x2c9d0ba78b8b168b),

312 
CONST64
(0x510153f6a7a7a6a7), CONST64(0xcf94fab27d7de97d), CONST64(0xdcfb374995956e95), CONST64(0x8e9fad56d8d847d8),

313 
CONST64
(0x8b30eb70fbfbcbfb), CONST64(0x2371c1cdeeee9fee), CONST64(0xc791f8bb7c7ced7c), CONST64(0x17e3cc7166668566),

314 
CONST64
(0xa68ea77bdddd53dd), CONST64(0xb84b2eaf17175c17), CONST64(0x02468e4547470147), CONST64(0x84dc211a9e9e429e),

315 
CONST64
(0x1ec589d4caca0fca), CONST64(0x75995a582d2db42d), CONST64(0x9179632ebfbfc6bf), CONST64(0x381b0e3f07071c07),

316 
CONST64
(0x012347acadad8ead), CONST64(0xea2fb4b05a5a755a), CONST64(0x6cb51bef83833683), CONST64(0x85ff66b63333cc33),

317 
CONST64
(0x3ff2c65c63639163), CONST64(0x100a041202020802), CONST64(0x39384993aaaa92aa), CONST64(0xafa8e2de7171d971),

318 
CONST64
(0x0ecf8dc6c8c807c8), CONST64(0xc87d32d119196419), CONST64(0x7270923b49493949), CONST64(0x869aaf5fd9d943d9),

319 
CONST64
(0xc31df931f2f2eff2), CONST64(0x4b48dba8e3e3abe3), CONST64(0xe22ab6b95b5b715b), CONST64(0x34920dbc88881a88),

320 
CONST64
(0xa4c8293e9a9a529a), CONST64(0x2dbe4c0b26269826), CONST64(0x8dfa64bf3232c832), CONST64(0xe94a7d59b0b0fab0),

321 
CONST64
(0x1b6acff2e9e983e9), CONST64(0x78331e770f0f3c0f), CONST64(0xe6a6b733d5d573d5), CONST64(0x74ba1df480803a80),

322 
CONST64
(0x997c6127bebec2be), CONST64(0x26de87ebcdcd13cd), CONST64(0xbde468893434d034), CONST64(0x7a75903248483d48),

323 
CONST64
(0xab24e354ffffdbff), CONST64(0xf78ff48d7a7af57a), CONST64(0xf4ea3d6490907a90), CONST64(0xc23ebe9d5f5f615f),

324 
CONST64
(0x1da0403d20208020), CONST64(0x67d5d00f6868bd68), CONST64(0xd07234ca1a1a681a), CONST64(0x192c41b7aeae82ae),

325 
CONST64
(0xc95e757db4b4eab4), CONST64(0x9a19a8ce54544d54), CONST64(0xece53b7f93937693), CONST64(0x0daa442f22228822),

326 
CONST64
(0x07e9c86364648d64), CONST64(0xdb12ff2af1f1e3f1), CONST64(0xbfa2e6cc7373d173), CONST64(0x905a248212124812),

327 
CONST64
(0x3a5d807a40401d40), CONST64(0x4028104808082008), CONST64(0x56e89b95c3c32bc3), CONST64(0x337bc5dfecec97ec),

328 
CONST64
(0x9690ab4ddbdb4bdb), CONST64(0x611f5fc0a1a1bea1), CONST64(0x1c8307918d8d0e8d), CONST64(0xf5c97ac83d3df43d),

329 
CONST64
(0xccf1335b97976697), CONST64(0x0000000000000000), CONST64(0x36d483f9cfcf1bcf), CONST64(0x4587566e2b2bac2b),

330 
CONST64
(0x97b3ece17676c576), CONST64(0x64b019e682823282), CONST64(0xfea9b128d6d67fd6), CONST64(0xd87736c31b1b6c1b),

331 
CONST64
(0xc15b7774b5b5eeb5), CONST64(0x112943beafaf86af), CONST64(0x77dfd41d6a6ab56a), CONST64(0xba0da0ea50505d50),

332 
CONST64
(0x124c8a5745450945), CONST64(0xcb18fb38f3f3ebf3), CONST64(0x9df060ad3030c030), CONST64(0x2b74c3c4efef9bef),

333 
CONST64
(0xe5c37eda3f3ffc3f), CONST64(0x921caac755554955), CONST64(0x791059dba2a2b2a2), CONST64(0x0365c9e9eaea8fea),

334 
CONST64
(0x0fecca6a65658965), CONST64(0xb9686903babad2ba), CONST64(0x65935e4a2f2fbc2f), CONST64(0x4ee79d8ec0c027c0),

335 
CONST64
(0xbe81a160dede5fde), CONST64(0xe06c38fc1c1c701c), CONST64(0xbb2ee746fdfdd3fd), CONST64(0x52649a1f4d4d294d),

336 
CONST64
(0xe4e0397692927292), CONST64(0x8fbceafa7575c975), CONST64(0x301e0c3606061806), CONST64(0x249809ae8a8a128a),

337 
CONST64
(0xf940794bb2b2f2b2), CONST64(0x6359d185e6e6bfe6), CONST64(0x70361c7e0e0e380e), CONST64(0xf8633ee71f1f7c1f),

338 
CONST64
(0x37f7c45562629562), CONST64(0xeea3b53ad4d477d4), CONST64(0x29324d81a8a89aa8), CONST64(0xc4f4315296966296),

339 
CONST64
(0x9b3aef62f9f9c3f9), CONST64(0x66f697a3c5c533c5), CONST64(0x35b14a1025259425), CONST64(0xf220b2ab59597959),

340 
CONST64
(0x54ae15d084842a84), CONST64(0xb7a7e4c57272d572), CONST64(0xd5dd72ec3939e439), CONST64(0x5a6198164c4c2d4c),

341 
CONST64
(0xca3bbc945e5e655e), CONST64(0xe785f09f7878fd78), CONST64(0xddd870e53838e038), CONST64(0x148605988c8c0a8c),

342 
CONST64
(0xc6b2bf17d1d163d1), CONST64(0x410b57e4a5a5aea5), CONST64(0x434dd9a1e2e2afe2), CONST64(0x2ff8c24e61619961),

343 
CONST64
(0xf1457b42b3b3f6b3), CONST64(0x15a5423421218421), CONST64(0x94d625089c9c4a9c), CONST64(0xf0663cee1e1e781e),

344 
CONST64
(0x2252866143431143), CONST64(0x76fc93b1c7c73bc7), CONST64(0xb32be54ffcfcd7fc), CONST64(0x2014082404041004),

345 
CONST64
(0xb208a2e351515951), CONST64(0xbcc72f2599995e99), CONST64(0x4fc4da226d6da96d), CONST64(0x68391a650d0d340d),

346 
CONST64
(0x8335e979fafacffa), CONST64(0xb684a369dfdf5bdf), CONST64(0xd79bfca97e7ee57e), CONST64(0x3db4481924249024),

347 
CONST64
(0xc5d776fe3b3bec3b), CONST64(0x313d4b9aabab96ab), CONST64(0x3ed181f0cece1fce), CONST64(0x8855229911114411),

348 
CONST64
(0x0c8903838f8f068f), CONST64(0x4a6b9c044e4e254e), CONST64(0xd1517366b7b7e6b7), CONST64(0x0b60cbe0ebeb8beb),

349 
CONST64
(0xfdcc78c13c3cf03c), CONST64(0x7cbf1ffd81813e81), CONST64(0xd4fe354094946a94), CONST64(0xeb0cf31cf7f7fbf7),

350 
CONST64
(0xa1676f18b9b9deb9), CONST64(0x985f268b13134c13), CONST64(0x7d9c58512c2cb02c), CONST64(0xd6b8bb05d3d36bd3),

351 
CONST64
(0x6b5cd38ce7e7bbe7), CONST64(0x57cbdc396e6ea56e), CONST64(0x6ef395aac4c437c4), CONST64(0x180f061b03030c03),

352 
CONST64
(0x8a13acdc56564556), CONST64(0x1a49885e44440d44), CONST64(0xdf9efea07f7fe17f), CONST64(0x21374f88a9a99ea9),

353 
CONST64
(0x4d8254672a2aa82a), CONST64(0xb16d6b0abbbbd6bb), CONST64(0x46e29f87c1c123c1), CONST64(0xa202a6f153535153),

354 
CONST64
(0xae8ba572dcdc57dc), CONST64(0x582716530b0b2c0b), CONST64(0x9cd327019d9d4e9d), CONST64(0x47c1d82b6c6cad6c),

355 
CONST64
(0x95f562a43131c431), CONST64(0x87b9e8f37474cd74), CONST64(0xe309f115f6f6fff6), CONST64(0x0a438c4c46460546),

356 
CONST64
(0x092645a5acac8aac), CONST64(0x3c970fb589891e89), CONST64(0xa04428b414145014), CONST64(0x5b42dfbae1e1a3e1),

357 
CONST64
(0xb04e2ca616165816), CONST64(0xcdd274f73a3ae83a), CONST64(0x6fd0d2066969b969), CONST64(0x482d124109092409),

358 
CONST64
(0xa7ade0d77070dd70), CONST64(0xd954716fb6b6e2b6), CONST64(0xceb7bd1ed0d067d0), CONST64(0x3b7ec7d6eded93ed),

359 
CONST64
(0x2edb85e2cccc17cc), CONST64(0x2a57846842421542), CONST64(0xb4c22d2c98985a98), CONST64(0x490e55eda4a4aaa4),

360 
CONST64
(0x5d8850752828a028), CONST64(0xda31b8865c5c6d5c), CONST64(0x933fed6bf8f8c7f8), CONST64(0x44a411c286862286)

363 cÚ¡ 
ulÚg64
 
	gsbox5
[] = {

364 
CONST64
(0x18c07830d8181860), CONST64(0x2305af462623238c), CONST64(0xc67ef991b8c6c63f), CONST64(0xe8136fcdfbe8e887),

365 
CONST64
(0x874ca113cb878726), CONST64(0xb8a9626d11b8b8da), CONST64(0x0108050209010104), CONST64(0x4f426e9e0d4f4f21),

366 
CONST64
(0x36adee6c9b3636d8), CONST64(0xa6590451ffa6a6a2), CONST64(0xd2debdb90cd2d26f), CONST64(0xf5fb06f70ef5f5f3),

367 
CONST64
(0x79ef80f2967979f9), CONST64(0x6f5fcede306f6fa1), CONST64(0x91fcef3f6d91917e), CONST64(0x52aa07a4f8525255),

368 
CONST64
(0x6027fdc04760609d), CONST64(0xbc89766535bcbcca), CONST64(0x9baccd2b379b9b56), CONST64(0x8e048c018a8e8e02),

369 
CONST64
(0xa371155bd2a3a3b6), CONST64(0x0c603c186c0c0c30), CONST64(0x7bff8af6847b7bf1), CONST64(0x35b5e16a803535d4),

370 
CONST64
(0x1de8693af51d1d74), CONST64(0xe05347ddb3e0e0a7), CONST64(0xd7f6acb321d7d77b), CONST64(0xc25eed999cc2c22f),

371 
CONST64
(0x2e6d965c432e2eb8), CONST64(0x4b627a96294b4b31), CONST64(0xfea321e15dfefedf), CONST64(0x578216aed5575741),

372 
CONST64
(0x15a8412abd151554), CONST64(0x779fb6eee87777c1), CONST64(0x37a5eb6e923737dc), CONST64(0xe57b56d79ee5e5b3),

373 
CONST64
(0x9f8cd923139f9f46), CONST64(0xf0d317fd23f0f0e7), CONST64(0x4a6a7f94204a4a35), CONST64(0xda9e95a944dada4f),

374 
CONST64
(0x58fa25b0a258587d), CONST64(0xc906ca8fcfc9c903), CONST64(0x29558d527c2929a4), CONST64(0x0a5022145a0a0a28),

375 
CONST64
(0xb1e14f7f50b1b1fe), CONST64(0xa0691a5dc9a0a0ba), CONST64(0x6b7fdad6146b6bb1), CONST64(0x855cab17d985852e),

376 
CONST64
(0xbd8173673cbdbdce), CONST64(0x5dd234ba8f5d5d69), CONST64(0x1080502090101040), CONST64(0xf4f303f507f4f4f7),

377 
CONST64
(0xcb16c08bddcbcb0b), CONST64(0x3eedc67cd33e3ef8), CONST64(0x0528110a2d050514), CONST64(0x671fe6ce78676781),

378 
CONST64
(0xe47353d597e4e4b7), CONST64(0x2725bb4e0227279c), CONST64(0x4132588273414119), CONST64(0x8b2c9d0ba78b8b16),

379 
CONST64
(0xa7510153f6a7a7a6), CONST64(0x7dcf94fab27d7de9), CONST64(0x95dcfb374995956e), CONST64(0xd88e9fad56d8d847),

380 
CONST64
(0xfb8b30eb70fbfbcb), CONST64(0xee2371c1cdeeee9f), CONST64(0x7cc791f8bb7c7ced), CONST64(0x6617e3cc71666685),

381 
CONST64
(0xdda68ea77bdddd53), CONST64(0x17b84b2eaf17175c), CONST64(0x4702468e45474701), CONST64(0x9e84dc211a9e9e42),

382 
CONST64
(0xca1ec589d4caca0f), CONST64(0x2d75995a582d2db4), CONST64(0xbf9179632ebfbfc6), CONST64(0x07381b0e3f07071c),

383 
CONST64
(0xad012347acadad8e), CONST64(0x5aea2fb4b05a5a75), CONST64(0x836cb51bef838336), CONST64(0x3385ff66b63333cc),

384 
CONST64
(0x633ff2c65c636391), CONST64(0x02100a0412020208), CONST64(0xaa39384993aaaa92), CONST64(0x71afa8e2de7171d9),

385 
CONST64
(0xc80ecf8dc6c8c807), CONST64(0x19c87d32d1191964), CONST64(0x497270923b494939), CONST64(0xd9869aaf5fd9d943),

386 
CONST64
(0xf2c31df931f2f2ef), CONST64(0xe34b48dba8e3e3ab), CONST64(0x5be22ab6b95b5b71), CONST64(0x8834920dbc88881a),

387 
CONST64
(0x9aa4c8293e9a9a52), CONST64(0x262dbe4c0b262698), CONST64(0x328dfa64bf3232c8), CONST64(0xb0e94a7d59b0b0fa),

388 
CONST64
(0xe91b6acff2e9e983), CONST64(0x0f78331e770f0f3c), CONST64(0xd5e6a6b733d5d573), CONST64(0x8074ba1df480803a),

389 
CONST64
(0xbe997c6127bebec2), CONST64(0xcd26de87ebcdcd13), CONST64(0x34bde468893434d0), CONST64(0x487a75903248483d),

390 
CONST64
(0xffab24e354ffffdb), CONST64(0x7af78ff48d7a7af5), CONST64(0x90f4ea3d6490907a), CONST64(0x5fc23ebe9d5f5f61),

391 
CONST64
(0x201da0403d202080), CONST64(0x6867d5d00f6868bd), CONST64(0x1ad07234ca1a1a68), CONST64(0xae192c41b7aeae82),

392 
CONST64
(0xb4c95e757db4b4ea), CONST64(0x549a19a8ce54544d), CONST64(0x93ece53b7f939376), CONST64(0x220daa442f222288),

393 
CONST64
(0x6407e9c86364648d), CONST64(0xf1db12ff2af1f1e3), CONST64(0x73bfa2e6cc7373d1), CONST64(0x12905a2482121248),

394 
CONST64
(0x403a5d807a40401d), CONST64(0x0840281048080820), CONST64(0xc356e89b95c3c32b), CONST64(0xec337bc5dfecec97),

395 
CONST64
(0xdb9690ab4ddbdb4b), CONST64(0xa1611f5fc0a1a1be), CONST64(0x8d1c8307918d8d0e), CONST64(0x3df5c97ac83d3df4),

396 
CONST64
(0x97ccf1335b979766), CONST64(0x0000000000000000), CONST64(0xcf36d483f9cfcf1b), CONST64(0x2b4587566e2b2bac),

397 
CONST64
(0x7697b3ece17676c5), CONST64(0x8264b019e6828232), CONST64(0xd6fea9b128d6d67f), CONST64(0x1bd87736c31b1b6c),

398 
CONST64
(0xb5c15b7774b5b5ee), CONST64(0xaf112943beafaf86), CONST64(0x6a77dfd41d6a6ab5), CONST64(0x50ba0da0ea50505d),

399 
CONST64
(0x45124c8a57454509), CONST64(0xf3cb18fb38f3f3eb), CONST64(0x309df060ad3030c0), CONST64(0xef2b74c3c4efef9b),

400 
CONST64
(0x3fe5c37eda3f3ffc), CONST64(0x55921caac7555549), CONST64(0xa2791059dba2a2b2), CONST64(0xea0365c9e9eaea8f),

401 
CONST64
(0x650fecca6a656589), CONST64(0xbab9686903babad2), CONST64(0x2f65935e4a2f2fbc), CONST64(0xc04ee79d8ec0c027),

402 
CONST64
(0xdebe81a160dede5f), CONST64(0x1ce06c38fc1c1c70), CONST64(0xfdbb2ee746fdfdd3), CONST64(0x4d52649a1f4d4d29),

403 
CONST64
(0x92e4e03976929272), CONST64(0x758fbceafa7575c9), CONST64(0x06301e0c36060618), CONST64(0x8a249809ae8a8a12),

404 
CONST64
(0xb2f940794bb2b2f2), CONST64(0xe66359d185e6e6bf), CONST64(0x0e70361c7e0e0e38), CONST64(0x1ff8633ee71f1f7c),

405 
CONST64
(0x6237f7c455626295), CONST64(0xd4eea3b53ad4d477), CONST64(0xa829324d81a8a89a), CONST64(0x96c4f43152969662),

406 
CONST64
(0xf99b3aef62f9f9c3), CONST64(0xc566f697a3c5c533), CONST64(0x2535b14a10252594), CONST64(0x59f220b2ab595979),

407 
CONST64
(0x8454ae15d084842a), CONST64(0x72b7a7e4c57272d5), CONST64(0x39d5dd72ec3939e4), CONST64(0x4c5a6198164c4c2d),

408 
CONST64
(0x5eca3bbc945e5e65), CONST64(0x78e785f09f7878fd), CONST64(0x38ddd870e53838e0), CONST64(0x8c148605988c8c0a),

409 
CONST64
(0xd1c6b2bf17d1d163), CONST64(0xa5410b57e4a5a5ae), CONST64(0xe2434dd9a1e2e2af), CONST64(0x612ff8c24e616199),

410 
CONST64
(0xb3f1457b42b3b3f6), CONST64(0x2115a54234212184), CONST64(0x9c94d625089c9c4a), CONST64(0x1ef0663cee1e1e78),

411 
CONST64
(0x4322528661434311), CONST64(0xc776fc93b1c7c73b), CONST64(0xfcb32be54ffcfcd7), CONST64(0x0420140824040410),

412 
CONST64
(0x51b208a2e3515159), CONST64(0x99bcc72f2599995e), CONST64(0x6d4fc4da226d6da9), CONST64(0x0d68391a650d0d34),

413 
CONST64
(0xfa8335e979fafacf), CONST64(0xdfb684a369dfdf5b), CONST64(0x7ed79bfca97e7ee5), CONST64(0x243db44819242490),

414 
CONST64
(0x3bc5d776fe3b3bec), CONST64(0xab313d4b9aabab96), CONST64(0xce3ed181f0cece1f), CONST64(0x1188552299111144),

415 
CONST64
(0x8f0c8903838f8f06), CONST64(0x4e4a6b9c044e4e25), CONST64(0xb7d1517366b7b7e6), CONST64(0xeb0b60cbe0ebeb8b),

416 
CONST64
(0x3cfdcc78c13c3cf0), CONST64(0x817cbf1ffd81813e), CONST64(0x94d4fe354094946a), CONST64(0xf7eb0cf31cf7f7fb),

417 
CONST64
(0xb9a1676f18b9b9de), CONST64(0x13985f268b13134c), CONST64(0x2c7d9c58512c2cb0), CONST64(0xd3d6b8bb05d3d36b),

418 
CONST64
(0xe76b5cd38ce7e7bb), CONST64(0x6e57cbdc396e6ea5), CONST64(0xc46ef395aac4c437), CONST64(0x03180f061b03030c),

419 
CONST64
(0x568a13acdc565645), CONST64(0x441a49885e44440d), CONST64(0x7fdf9efea07f7fe1), CONST64(0xa921374f88a9a99e),

420 
CONST64
(0x2a4d8254672a2aa8), CONST64(0xbbb16d6b0abbbbd6), CONST64(0xc146e29f87c1c123), CONST64(0x53a202a6f1535351),

421 
CONST64
(0xdcae8ba572dcdc57), CONST64(0x0b582716530b0b2c), CONST64(0x9d9cd327019d9d4e), CONST64(0x6c47c1d82b6c6cad),

422 
CONST64
(0x3195f562a43131c4), CONST64(0x7487b9e8f37474cd), CONST64(0xf6e309f115f6f6ff), CONST64(0x460a438c4c464605),

423 
CONST64
(0xac092645a5acac8a), CONST64(0x893c970fb589891e), CONST64(0x14a04428b4141450), CONST64(0xe15b42dfbae1e1a3),

424 
CONST64
(0x16b04e2ca6161658), CONST64(0x3acdd274f73a3ae8), CONST64(0x696fd0d2066969b9), CONST64(0x09482d1241090924),

425 
CONST64
(0x70a7ade0d77070dd), CONST64(0xb6d954716fb6b6e2), CONST64(0xd0ceb7bd1ed0d067), CONST64(0xed3b7ec7d6eded93),

426 
CONST64
(0xcc2edb85e2cccc17), CONST64(0x422a578468424215), CONST64(0x98b4c22d2c98985a), CONST64(0xa4490e55eda4a4aa),

427 
CONST64
(0x285d8850752828a0), CONST64(0x5cda31b8865c5c6d), CONST64(0xf8933fed6bf8f8c7), CONST64(0x8644a411c2868622)

430 cÚ¡ 
ulÚg64
 
	gsbox6
[] = {

431 
CONST64
(0x6018c07830d81818), CONST64(0x8c2305af46262323), CONST64(0x3fc67ef991b8c6c6), CONST64(0x87e8136fcdfbe8e8),

432 
CONST64
(0x26874ca113cb8787), CONST64(0xdab8a9626d11b8b8), CONST64(0x0401080502090101), CONST64(0x214f426e9e0d4f4f),

433 
CONST64
(0xd836adee6c9b3636), CONST64(0xa2a6590451ffa6a6), CONST64(0x6fd2debdb90cd2d2), CONST64(0xf3f5fb06f70ef5f5),

434 
CONST64
(0xf979ef80f2967979), CONST64(0xa16f5fcede306f6f), CONST64(0x7e91fcef3f6d9191), CONST64(0x5552aa07a4f85252),

435 
CONST64
(0x9d6027fdc0476060), CONST64(0xcabc89766535bcbc), CONST64(0x569baccd2b379b9b), CONST64(0x028e048c018a8e8e),

436 
CONST64
(0xb6a371155bd2a3a3), CONST64(0x300c603c186c0c0c), CONST64(0xf17bff8af6847b7b), CONST64(0xd435b5e16a803535),

437 
CONST64
(0x741de8693af51d1d), CONST64(0xa7e05347ddb3e0e0), CONST64(0x7bd7f6acb321d7d7), CONST64(0x2fc25eed999cc2c2),

438 
CONST64
(0xb82e6d965c432e2e), CONST64(0x314b627a96294b4b), CONST64(0xdffea321e15dfefe), CONST64(0x41578216aed55757),

439 
CONST64
(0x5415a8412abd1515), CONST64(0xc1779fb6eee87777), CONST64(0xdc37a5eb6e923737), CONST64(0xb3e57b56d79ee5e5),

440 
CONST64
(0x469f8cd923139f9f), CONST64(0xe7f0d317fd23f0f0), CONST64(0x354a6a7f94204a4a), CONST64(0x4fda9e95a944dada),

441 
CONST64
(0x7d58fa25b0a25858), CONST64(0x03c906ca8fcfc9c9), CONST64(0xa429558d527c2929), CONST64(0x280a5022145a0a0a),

442 
CONST64
(0xfeb1e14f7f50b1b1), CONST64(0xbaa0691a5dc9a0a0), CONST64(0xb16b7fdad6146b6b), CONST64(0x2e855cab17d98585),

443 
CONST64
(0xcebd8173673cbdbd), CONST64(0x695dd234ba8f5d5d), CONST64(0x4010805020901010), CONST64(0xf7f4f303f507f4f4),

444 
CONST64
(0x0bcb16c08bddcbcb), CONST64(0xf83eedc67cd33e3e), CONST64(0x140528110a2d0505), CONST64(0x81671fe6ce786767),

445 
CONST64
(0xb7e47353d597e4e4), CONST64(0x9c2725bb4e022727), CONST64(0x1941325882734141), CONST64(0x168b2c9d0ba78b8b),

446 
CONST64
(0xa6a7510153f6a7a7), CONST64(0xe97dcf94fab27d7d), CONST64(0x6e95dcfb37499595), CONST64(0x47d88e9fad56d8d8),

447 
CONST64
(0xcbfb8b30eb70fbfb), CONST64(0x9fee2371c1cdeeee), CONST64(0xed7cc791f8bb7c7c), CONST64(0x856617e3cc716666),

448 
CONST64
(0x53dda68ea77bdddd), CONST64(0x5c17b84b2eaf1717), CONST64(0x014702468e454747), CONST64(0x429e84dc211a9e9e),

449 
CONST64
(0x0fca1ec589d4caca), CONST64(0xb42d75995a582d2d), CONST64(0xc6bf9179632ebfbf), CONST64(0x1c07381b0e3f0707),

450 
CONST64
(0x8ead012347acadad), CONST64(0x755aea2fb4b05a5a), CONST64(0x36836cb51bef8383), CONST64(0xcc3385ff66b63333),

451 
CONST64
(0x91633ff2c65c6363), CONST64(0x0802100a04120202), CONST64(0x92aa39384993aaaa), CONST64(0xd971afa8e2de7171),

452 
CONST64
(0x07c80ecf8dc6c8c8), CONST64(0x6419c87d32d11919), CONST64(0x39497270923b4949), CONST64(0x43d9869aaf5fd9d9),

453 
CONST64
(0xeff2c31df931f2f2), CONST64(0xabe34b48dba8e3e3), CONST64(0x715be22ab6b95b5b), CONST64(0x1a8834920dbc8888),

454 
CONST64
(0x529aa4c8293e9a9a), CONST64(0x98262dbe4c0b2626), CONST64(0xc8328dfa64bf3232), CONST64(0xfab0e94a7d59b0b0),

455 
CONST64
(0x83e91b6acff2e9e9), CONST64(0x3c0f78331e770f0f), CONST64(0x73d5e6a6b733d5d5), CONST64(0x3a8074ba1df48080),

456 
CONST64
(0xc2be997c6127bebe), CONST64(0x13cd26de87ebcdcd), CONST64(0xd034bde468893434), CONST64(0x3d487a7590324848),

457 
CONST64
(0xdbffab24e354ffff), CONST64(0xf57af78ff48d7a7a), CONST64(0x7a90f4ea3d649090), CONST64(0x615fc23ebe9d5f5f),

458 
CONST64
(0x80201da0403d2020), CONST64(0xbd6867d5d00f6868), CONST64(0x681ad07234ca1a1a), CONST64(0x82ae192c41b7aeae),

459 
CONST64
(0xeab4c95e757db4b4), CONST64(0x4d549a19a8ce5454), CONST64(0x7693ece53b7f9393), CONST64(0x88220daa442f2222),

460 
CONST64
(0x8d6407e9c8636464), CONST64(0xe3f1db12ff2af1f1), CONST64(0xd173bfa2e6cc7373), CONST64(0x4812905a24821212),

461 
CONST64
(0x1d403a5d807a4040), CONST64(0x2008402810480808), CONST64(0x2bc356e89b95c3c3), CONST64(0x97ec337bc5dfecec),

462 
CONST64
(0x4bdb9690ab4ddbdb), CONST64(0xbea1611f5fc0a1a1), CONST64(0x0e8d1c8307918d8d), CONST64(0xf43df5c97ac83d3d),

463 
CONST64
(0x6697ccf1335b9797), CONST64(0x0000000000000000), CONST64(0x1bcf36d483f9cfcf), CONST64(0xac2b4587566e2b2b),

464 
CONST64
(0xc57697b3ece17676), CONST64(0x328264b019e68282), CONST64(0x7fd6fea9b128d6d6), CONST64(0x6c1bd87736c31b1b),

465 
CONST64
(0xeeb5c15b7774b5b5), CONST64(0x86af112943beafaf), CONST64(0xb56a77dfd41d6a6a), CONST64(0x5d50ba0da0ea5050),

466 
CONST64
(0x0945124c8a574545), CONST64(0xebf3cb18fb38f3f3), CONST64(0xc0309df060ad3030), CONST64(0x9bef2b74c3c4efef),

467 
CONST64
(0xfc3fe5c37eda3f3f), CONST64(0x4955921caac75555), CONST64(0xb2a2791059dba2a2), CONST64(0x8fea0365c9e9eaea),

468 
CONST64
(0x89650fecca6a6565), CONST64(0xd2bab9686903baba), CONST64(0xbc2f65935e4a2f2f), CONST64(0x27c04ee79d8ec0c0),

469 
CONST64
(0x5fdebe81a160dede), CONST64(0x701ce06c38fc1c1c), CONST64(0xd3fdbb2ee746fdfd), CONST64(0x294d52649a1f4d4d),

470 
CONST64
(0x7292e4e039769292), CONST64(0xc9758fbceafa7575), CONST64(0x1806301e0c360606), CONST64(0x128a249809ae8a8a),

471 
CONST64
(0xf2b2f940794bb2b2), CONST64(0xbfe66359d185e6e6), CONST64(0x380e70361c7e0e0e), CONST64(0x7c1ff8633ee71f1f),

472 
CONST64
(0x956237f7c4556262), CONST64(0x77d4eea3b53ad4d4), CONST64(0x9aa829324d81a8a8), CONST64(0x6296c4f431529696),

473 
CONST64
(0xc3f99b3aef62f9f9), CONST64(0x33c566f697a3c5c5), CONST64(0x942535b14a102525), CONST64(0x7959f220b2ab5959),

474 
CONST64
(0x2a8454ae15d08484), CONST64(0xd572b7a7e4c57272), CONST64(0xe439d5dd72ec3939), CONST64(0x2d4c5a6198164c4c),

475 
CONST64
(0x655eca3bbc945e5e), CONST64(0xfd78e785f09f7878), CONST64(0xe038ddd870e53838), CONST64(0x0a8c148605988c8c),

476 
CONST64
(0x63d1c6b2bf17d1d1), CONST64(0xaea5410b57e4a5a5), CONST64(0xafe2434dd9a1e2e2), CONST64(0x99612ff8c24e6161),

477 
CONST64
(0xf6b3f1457b42b3b3), CONST64(0x842115a542342121), CONST64(0x4a9c94d625089c9c), CONST64(0x781ef0663cee1e1e),

478 
CONST64
(0x1143225286614343), CONST64(0x3bc776fc93b1c7c7), CONST64(0xd7fcb32be54ffcfc), CONST64(0x1004201408240404),

479 
CONST64
(0x5951b208a2e35151), CONST64(0x5e99bcc72f259999), CONST64(0xa96d4fc4da226d6d), CONST64(0x340d68391a650d0d),

480 
CONST64
(0xcffa8335e979fafa), CONST64(0x5bdfb684a369dfdf), CONST64(0xe57ed79bfca97e7e), CONST64(0x90243db448192424),

481 
CONST64
(0xec3bc5d776fe3b3b), CONST64(0x96ab313d4b9aabab), CONST64(0x1fce3ed181f0cece), CONST64(0x4411885522991111),

482 
CONST64
(0x068f0c8903838f8f), CONST64(0x254e4a6b9c044e4e), CONST64(0xe6b7d1517366b7b7), CONST64(0x8beb0b60cbe0ebeb),

483 
CONST64
(0xf03cfdcc78c13c3c), CONST64(0x3e817cbf1ffd8181), CONST64(0x6a94d4fe35409494), CONST64(0xfbf7eb0cf31cf7f7),

484 
CONST64
(0xdeb9a1676f18b9b9), CONST64(0x4c13985f268b1313), CONST64(0xb02c7d9c58512c2c), CONST64(0x6bd3d6b8bb05d3d3),

485 
CONST64
(0xbbe76b5cd38ce7e7), CONST64(0xa56e57cbdc396e6e), CONST64(0x37c46ef395aac4c4), CONST64(0x0c03180f061b0303),

486 
CONST64
(0x45568a13acdc5656), CONST64(0x0d441a49885e4444), CONST64(0xe17fdf9efea07f7f), CONST64(0x9ea921374f88a9a9),

487 
CONST64
(0xa82a4d8254672a2a), CONST64(0xd6bbb16d6b0abbbb), CONST64(0x23c146e29f87c1c1), CONST64(0x5153a202a6f15353),

488 
CONST64
(0x57dcae8ba572dcdc), CONST64(0x2c0b582716530b0b), CONST64(0x4e9d9cd327019d9d), CONST64(0xad6c47c1d82b6c6c),

489 
CONST64
(0xc43195f562a43131), CONST64(0xcd7487b9e8f37474), CONST64(0xfff6e309f115f6f6), CONST64(0x05460a438c4c4646),

490 
CONST64
(0x8aac092645a5acac), CONST64(0x1e893c970fb58989), CONST64(0x5014a04428b41414), CONST64(0xa3e15b42dfbae1e1),

491 
CONST64
(0x5816b04e2ca61616), CONST64(0xe83acdd274f73a3a), CONST64(0xb9696fd0d2066969), CONST64(0x2409482d12410909),

492 
CONST64
(0xdd70a7ade0d77070), CONST64(0xe2b6d954716fb6b6), CONST64(0x67d0ceb7bd1ed0d0), CONST64(0x93ed3b7ec7d6eded),

493 
CONST64
(0x17cc2edb85e2cccc), CONST64(0x15422a5784684242), CONST64(0x5a98b4c22d2c9898), CONST64(0xaaa4490e55eda4a4),

494 
CONST64
(0xa0285d8850752828), CONST64(0x6d5cda31b8865c5c), CONST64(0xc7f8933fed6bf8f8), CONST64(0x228644a411c28686)

497 cÚ¡ 
ulÚg64
 
	gsbox7
[] = {

498 
CONST64
(0x186018c07830d818), CONST64(0x238c2305af462623), CONST64(0xc63fc67ef991b8c6), CONST64(0xe887e8136fcdfbe8),

499 
CONST64
(0x8726874ca113cb87), CONST64(0xb8dab8a9626d11b8), CONST64(0x0104010805020901), CONST64(0x4f214f426e9e0d4f),

500 
CONST64
(0x36d836adee6c9b36), CONST64(0xa6a2a6590451ffa6), CONST64(0xd26fd2debdb90cd2), CONST64(0xf5f3f5fb06f70ef5),

501 
CONST64
(0x79f979ef80f29679), CONST64(0x6fa16f5fcede306f), CONST64(0x917e91fcef3f6d91), CONST64(0x525552aa07a4f852),

502 
CONST64
(0x609d6027fdc04760), CONST64(0xbccabc89766535bc), CONST64(0x9b569baccd2b379b), CONST64(0x8e028e048c018a8e),

503 
CONST64
(0xa3b6a371155bd2a3), CONST64(0x0c300c603c186c0c), CONST64(0x7bf17bff8af6847b), CONST64(0x35d435b5e16a8035),

504 
CONST64
(0x1d741de8693af51d), CONST64(0xe0a7e05347ddb3e0), CONST64(0xd77bd7f6acb321d7), CONST64(0xc22fc25eed999cc2),

505 
CONST64
(0x2eb82e6d965c432e), CONST64(0x4b314b627a96294b), CONST64(0xfedffea321e15dfe), CONST64(0x5741578216aed557),

506 
CONST64
(0x155415a8412abd15), CONST64(0x77c1779fb6eee877), CONST64(0x37dc37a5eb6e9237), CONST64(0xe5b3e57b56d79ee5),

507 
CONST64
(0x9f469f8cd923139f), CONST64(0xf0e7f0d317fd23f0), CONST64(0x4a354a6a7f94204a), CONST64(0xda4fda9e95a944da),

508 
CONST64
(0x587d58fa25b0a258), CONST64(0xc903c906ca8fcfc9), CONST64(0x29a429558d527c29), CONST64(0x0a280a5022145a0a),

509 
CONST64
(0xb1feb1e14f7f50b1), CONST64(0xa0baa0691a5dc9a0), CONST64(0x6bb16b7fdad6146b), CONST64(0x852e855cab17d985),

510 
CONST64
(0xbdcebd8173673cbd), CONST64(0x5d695dd234ba8f5d), CONST64(0x1040108050209010), CONST64(0xf4f7f4f303f507f4),

511 
CONST64
(0xcb0bcb16c08bddcb), CONST64(0x3ef83eedc67cd33e), CONST64(0x05140528110a2d05), CONST64(0x6781671fe6ce7867),

512 
CONST64
(0xe4b7e47353d597e4), CONST64(0x279c2725bb4e0227), CONST64(0x4119413258827341), CONST64(0x8b168b2c9d0ba78b),

513 
CONST64
(0xa7a6a7510153f6a7), CONST64(0x7de97dcf94fab27d), CONST64(0x956e95dcfb374995), CONST64(0xd847d88e9fad56d8),

514 
CONST64
(0xfbcbfb8b30eb70fb), CONST64(0xee9fee2371c1cdee), CONST64(0x7ced7cc791f8bb7c), CONST64(0x66856617e3cc7166),

515 
CONST64
(0xdd53dda68ea77bdd), CONST64(0x175c17b84b2eaf17), CONST64(0x47014702468e4547), CONST64(0x9e429e84dc211a9e),

516 
CONST64
(0xca0fca1ec589d4ca), CONST64(0x2db42d75995a582d), CONST64(0xbfc6bf9179632ebf), CONST64(0x071c07381b0e3f07),

517 
CONST64
(0xad8ead012347acad), CONST64(0x5a755aea2fb4b05a), CONST64(0x8336836cb51bef83), CONST64(0x33cc3385ff66b633),

518 
CONST64
(0x6391633ff2c65c63), CONST64(0x020802100a041202), CONST64(0xaa92aa39384993aa), CONST64(0x71d971afa8e2de71),

519 
CONST64
(0xc807c80ecf8dc6c8), CONST64(0x196419c87d32d119), CONST64(0x4939497270923b49), CONST64(0xd943d9869aaf5fd9),

520 
CONST64
(0xf2eff2c31df931f2), CONST64(0xe3abe34b48dba8e3), CONST64(0x5b715be22ab6b95b), CONST64(0x881a8834920dbc88),

521 
CONST64
(0x9a529aa4c8293e9a), CONST64(0x2698262dbe4c0b26), CONST64(0x32c8328dfa64bf32), CONST64(0xb0fab0e94a7d59b0),

522 
CONST64
(0xe983e91b6acff2e9), CONST64(0x0f3c0f78331e770f), CONST64(0xd573d5e6a6b733d5), CONST64(0x803a8074ba1df480),

523 
CONST64
(0xbec2be997c6127be), CONST64(0xcd13cd26de87ebcd), CONST64(0x34d034bde4688934), CONST64(0x483d487a75903248),

524 
CONST64
(0xffdbffab24e354ff), CONST64(0x7af57af78ff48d7a), CONST64(0x907a90f4ea3d6490), CONST64(0x5f615fc23ebe9d5f),

525 
CONST64
(0x2080201da0403d20), CONST64(0x68bd6867d5d00f68), CONST64(0x1a681ad07234ca1a), CONST64(0xae82ae192c41b7ae),

526 
CONST64
(0xb4eab4c95e757db4), CONST64(0x544d549a19a8ce54), CONST64(0x937693ece53b7f93), CONST64(0x2288220daa442f22),

527 
CONST64
(0x648d6407e9c86364), CONST64(0xf1e3f1db12ff2af1), CONST64(0x73d173bfa2e6cc73), CONST64(0x124812905a248212),

528 
CONST64
(0x401d403a5d807a40), CONST64(0x0820084028104808), CONST64(0xc32bc356e89b95c3), CONST64(0xec97ec337bc5dfec),

529 
CONST64
(0xdb4bdb9690ab4ddb), CONST64(0xa1bea1611f5fc0a1), CONST64(0x8d0e8d1c8307918d), CONST64(0x3df43df5c97ac83d),

530 
CONST64
(0x976697ccf1335b97), CONST64(0x0000000000000000), CONST64(0xcf1bcf36d483f9cf), CONST64(0x2bac2b4587566e2b),

531 
CONST64
(0x76c57697b3ece176), CONST64(0x82328264b019e682), CONST64(0xd67fd6fea9b128d6), CONST64(0x1b6c1bd87736c31b),

532 
CONST64
(0xb5eeb5c15b7774b5), CONST64(0xaf86af112943beaf), CONST64(0x6ab56a77dfd41d6a), CONST64(0x505d50ba0da0ea50),

533 
CONST64
(0x450945124c8a5745), CONST64(0xf3ebf3cb18fb38f3), CONST64(0x30c0309df060ad30), CONST64(0xef9bef2b74c3c4ef),

534 
CONST64
(0x3ffc3fe5c37eda3f), CONST64(0x554955921caac755), CONST64(0xa2b2a2791059dba2), CONST64(0xea8fea0365c9e9ea),

535 
CONST64
(0x6589650fecca6a65), CONST64(0xbad2bab9686903ba), CONST64(0x2fbc2f65935e4a2f), CONST64(0xc027c04ee79d8ec0),

536 
CONST64
(0xde5fdebe81a160de), CONST64(0x1c701ce06c38fc1c), CONST64(0xfdd3fdbb2ee746fd), CONST64(0x4d294d52649a1f4d),

537 
CONST64
(0x927292e4e0397692), CONST64(0x75c9758fbceafa75), CONST64(0x061806301e0c3606), CONST64(0x8a128a249809ae8a),

538 
CONST64
(0xb2f2b2f940794bb2), CONST64(0xe6bfe66359d185e6), CONST64(0x0e380e70361c7e0e), CONST64(0x1f7c1ff8633ee71f),

539 
CONST64
(0x62956237f7c45562), CONST64(0xd477d4eea3b53ad4), CONST64(0xa89aa829324d81a8), CONST64(0x966296c4f4315296),

540 
CONST64
(0xf9c3f99b3aef62f9), CONST64(0xc533c566f697a3c5), CONST64(0x25942535b14a1025), CONST64(0x597959f220b2ab59),

541 
CONST64
(0x842a8454ae15d084), CONST64(0x72d572b7a7e4c572), CONST64(0x39e439d5dd72ec39), CONST64(0x4c2d4c5a6198164c),

542 
CONST64
(0x5e655eca3bbc945e), CONST64(0x78fd78e785f09f78), CONST64(0x38e038ddd870e538), CONST64(0x8c0a8c148605988c),

543 
CONST64
(0xd163d1c6b2bf17d1), CONST64(0xa5aea5410b57e4a5), CONST64(0xe2afe2434dd9a1e2), CONST64(0x6199612ff8c24e61),

544 
CONST64
(0xb3f6b3f1457b42b3), CONST64(0x21842115a5423421), CONST64(0x9c4a9c94d625089c), CONST64(0x1e781ef0663cee1e),

545 
CONST64
(0x4311432252866143), CONST64(0xc73bc776fc93b1c7), CONST64(0xfcd7fcb32be54ffc), CONST64(0x0410042014082404),

546 
CONST64
(0x515951b208a2e351), CONST64(0x995e99bcc72f2599), CONST64(0x6da96d4fc4da226d), CONST64(0x0d340d68391a650d),

547 
CONST64
(0xfacffa8335e979fa), CONST64(0xdf5bdfb684a369df), CONST64(0x7ee57ed79bfca97e), CONST64(0x2490243db4481924),

548 
CONST64
(0x3bec3bc5d776fe3b), CONST64(0xab96ab313d4b9aab), CONST64(0xce1fce3ed181f0ce), CONST64(0x1144118855229911),

549 
CONST64
(0x8f068f0c8903838f), CONST64(0x4e254e4a6b9c044e), CONST64(0xb7e6b7d1517366b7), CONST64(0xeb8beb0b60cbe0eb),

550 
CONST64
(0x3cf03cfdcc78c13c), CONST64(0x813e817cbf1ffd81), CONST64(0x946a94d4fe354094), CONST64(0xf7fbf7eb0cf31cf7),

551 
CONST64
(0xb9deb9a1676f18b9), CONST64(0x134c13985f268b13), CONST64(0x2cb02c7d9c58512c), CONST64(0xd36bd3d6b8bb05d3),

552 
CONST64
(0xe7bbe76b5cd38ce7), CONST64(0x6ea56e57cbdc396e), CONST64(0xc437c46ef395aac4), CONST64(0x030c03180f061b03),

553 
CONST64
(0x5645568a13acdc56), CONST64(0x440d441a49885e44), CONST64(0x7fe17fdf9efea07f), CONST64(0xa99ea921374f88a9),

554 
CONST64
(0x2aa82a4d8254672a), CONST64(0xbbd6bbb16d6b0abb), CONST64(0xc123c146e29f87c1), CONST64(0x535153a202a6f153),

555 
CONST64
(0xdc57dcae8ba572dc), CONST64(0x0b2c0b582716530b), CONST64(0x9d4e9d9cd327019d), CONST64(0x6cad6c47c1d82b6c),

556 
CONST64
(0x31c43195f562a431), CONST64(0x74cd7487b9e8f374), CONST64(0xf6fff6e309f115f6), CONST64(0x4605460a438c4c46),

557 
CONST64
(0xac8aac092645a5ac), CONST64(0x891e893c970fb589), CONST64(0x145014a04428b414), CONST64(0xe1a3e15b42dfbae1),

558 
CONST64
(0x165816b04e2ca616), CONST64(0x3ae83acdd274f73a), CONST64(0x69b9696fd0d20669), CONST64(0x092409482d124109),

559 
CONST64
(0x70dd70a7ade0d770), CONST64(0xb6e2b6d954716fb6), CONST64(0xd067d0ceb7bd1ed0), CONST64(0xed93ed3b7ec7d6ed),

560 
CONST64
(0xcc17cc2edb85e2cc), CONST64(0x4215422a57846842), CONST64(0x985a98b4c22d2c98), CONST64(0xa4aaa4490e55eda4),

561 
CONST64
(0x28a0285d88507528), CONST64(0x5c6d5cda31b8865c), CONST64(0xf8c7f8933fed6bf8), CONST64(0x86228644a411c286)

566 cÚ¡ 
ulÚg64
 
	gcÚt
[] = {

567 
CONST64
(0x1823c6e887b8014f),

568 
CONST64
(0x36a6d2f5796f9152),

569 
CONST64
(0x60bc9b8ea30c7b35),

570 
CONST64
(0x1de0d7c22e4bfe57),

571 
CONST64
(0x157737e59ff04ada),

572 
CONST64
(0x58c9290ab1a06b85),

573 
CONST64
(0xbd5d10f4cb3e0567),

574 
CONST64
(0xe427418ba77d95d8),

575 
CONST64
(0xfbee7c66dd17479e),

576 
CONST64
(0xca2dbf07ad5a8333),

577 
CONST64
(0x6302aa71c81949d9),

	@libtomcrypt/src/headers/tomcrypt.h

1 #iâdeà
TOMCRYPT_H_


2 
	#TOMCRYPT_H_


	)

3 
	~<as£¹.h
>

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~<¡dlib.h
>

7 
	~<time.h
>

8 
	~<ùy³.h
>

9 
	~<lim™s.h
>

12 
	~<tomüy±_cu¡om.h
>

14 #ifdeà
__ılu¥lus


19 
	#CRYPT
 0x0116

	)

20 
	#SCRYPT
 "1.16"

	)

23 
	#MAXBLOCKSIZE
 128

	)

27 
	#TAB_SIZE
 4

	)

31 
CRYPT_OK
=0,

32 
CRYPT_ERROR
,

33 
CRYPT_NOP
,

35 
CRYPT_INVALID_KEYSIZE
,

36 
CRYPT_INVALID_ROUNDS
,

37 
CRYPT_FAIL_TESTVECTOR
,

39 
CRYPT_BUFFER_OVERFLOW
,

40 
CRYPT_INVALID_PACKET
,

42 
CRYPT_INVALID_PRNGSIZE
,

43 
CRYPT_ERROR_READPRNG
,

45 
CRYPT_INVALID_CIPHER
,

46 
CRYPT_INVALID_HASH
,

47 
CRYPT_INVALID_PRNG
,

49 
CRYPT_MEM
,

51 
CRYPT_PK_TYPE_MISMATCH
,

52 
CRYPT_PK_NOT_PRIVATE
,

54 
CRYPT_INVALID_ARG
,

55 
CRYPT_FILE_NOTFOUND
,

57 
CRYPT_PK_INVALID_TYPE
,

58 
CRYPT_PK_INVALID_SYSTEM
,

59 
CRYPT_PK_DUP
,

60 
CRYPT_PK_NOT_FOUND
,

61 
CRYPT_PK_INVALID_SIZE
,

63 
CRYPT_INVALID_PRIME_SIZE
,

64 
CRYPT_PK_INVALID_PADDING


67 
	~<tomüy±_cfg.h
>

68 
	~<tomüy±_maüos.h
>

69 
	~<tomüy±_ch”.h
>

70 
	~<tomüy±_hash.h
>

71 
	~<tomüy±_mac.h
>

72 
	~<tomüy±_´ng.h
>

73 
	~<tomüy±_pk.h
>

74 
	~<tomüy±_m©h.h
>

75 
	~<tomüy±_misc.h
>

76 
	~<tomüy±_¬gchk.h
>

77 
	~<tomüy±_pkcs.h
>

79 #ifdeà
__ılu¥lus


	@libtomcrypt/src/headers/tomcrypt_argchk.h

3 #ià
ARGTYPE
 == 0

5 
	~<sigÇl.h
>

8 
üy±_¬gchk
(*
v
, *
s
, 
d
);

9 
	#LTC_ARGCHK
(
x
èià(!(x)è{ 
	`üy±_¬gchk
(#x, 
__FILE__
, 
__LINE__
); }

	)

10 
	#LTC_ARGCHKVD
(
x
è
	`LTC_ARGCHK
(x)

	)

12 #–ià
ARGTYPE
 == 1

15 
	#LTC_ARGCHK
(
x
è
	`as£¹
((x))

	)

16 
	#LTC_ARGCHKVD
(
x
è
	`LTC_ARGCHK
(x)

	)

18 #–ià
ARGTYPE
 == 2

20 
	#LTC_ARGCHK
(
x
èià(!(x)è{ 
	`årštf
(
¡d”r
, "\nw¬nšg: ARGCHK faed‡ˆ%s:%d\n", 
__FILE__
, 
__LINE__
); }

	)

21 
	#LTC_ARGCHKVD
(
x
è
	`LTC_ARGCHK
(x)

	)

23 #–ià
ARGTYPE
 == 3

25 
	#LTC_ARGCHK
(
x
)

	)

26 
	#LTC_ARGCHKVD
(
x
è
	`LTC_ARGCHK
(x)

	)

28 #–ià
ARGTYPE
 == 4

30 
	#LTC_ARGCHK
(
x
èià(!(x)è 
CRYPT_INVALID_ARG
;

	)

31 
	#LTC_ARGCHKVD
(
x
èià(!(x)è;

	)

	@libtomcrypt/src/headers/tomcrypt_cfg.h

7 #iâdeà
TOMCRYPT_CFG_H


8 
	#TOMCRYPT_CFG_H


	)

10 #ià
defšed
(
_WIN32
è|| defšed(
_MSC_VER
)

11 
	#LTC_CALL
 
__cdeş


	)

13 #iâdeà
LTC_CALL


14 
	#LTC_CALL


	)

18 #iâdeà
LTC_EXPORT


19 
	#LTC_EXPORT


	)

23 #iâdeà
LTC_NO_PROTOTYPES


26 
LTC_EXPORT
 * 
LTC_CALL
 
XMALLOC
(
size_t
 
n
);

27 
LTC_EXPORT
 * 
LTC_CALL
 
XREALLOC
(*
p
, 
size_t
 
n
);

28 
LTC_EXPORT
 * 
LTC_CALL
 
XCALLOC
(
size_t
 
n
, size_ˆ
s
);

29 
LTC_EXPORT
 
LTC_CALL
 
XFREE
(*
p
);

31 
LTC_EXPORT
 
LTC_CALL
 
XQSORT
(*
ba£
, 
size_t
 
nmemb
, size_ˆ
size
, (*
com·r
)(const *, const *));

35 
LTC_EXPORT
 
şock_t
 
LTC_CALL
 
	`XCLOCK
();

38 
LTC_EXPORT
 * 
LTC_CALL
 
	`XMEMCPY
(*
de¡
, cÚ¡ *
¤c
, 
size_t
 
n
);

39 
LTC_EXPORT
 
LTC_CALL
 
	`XMEMCMP
(cÚ¡ *
s1
, cÚ¡ *
s2
, 
size_t
 
n
);

40 
LTC_EXPORT
 * 
LTC_CALL
 
	`XMEMSET
(*
s
, 
c
, 
size_t
 
n
);

42 
LTC_EXPORT
 
LTC_CALL
 
	`XSTRCMP
(cÚ¡ *
s1
, cÚ¡ *
s2
);

47 #iâdeà
ARGTYPE


48 
	#ARGTYPE
 0

	)

59 #ià!
	`defšed
(
__STRICT_ANSI__
è&& (defšed(
INTEL_CC
è|| (defšed(
_MSC_VER
è&& defšed(
WIN32
)è|| (defšed(
__GNUC__
è&& (defšed(
__DJGPP__
è|| defšed(
__CYGWIN__
è|| defšed(
__MINGW32__
è|| defšed(
__i386__
))))

60 
	#ENDIAN_LITTLE


	)

61 
	#ENDIAN_32BITWORD


	)

62 
	#LTC_FAST


	)

63 
	#LTC_FAST_TYPE
 

	)

67 #ià(
	`defšed
(
__R5900
è|| defšed(
R5900
è|| defšed(
__R5900__
)è&& (defšed(
_ms
è|| defšed(
__ms__
è|| defšed(
ms
))

68 
	#ENDIAN_LITTLE


	)

69 
	#ENDIAN_64BITWORD


	)

73 #ià!
	`defšed
(
__STRICT_ANSI__
è&& defšed(
__x86_64__
)

74 
	#ENDIAN_LITTLE


	)

75 
	#ENDIAN_64BITWORD


	)

76 
	#LTC_FAST


	)

77 
	#LTC_FAST_TYPE
 

	)

81 #ià!
	`defšed
(
__STRICT_ANSI__
è&& defšed(
LTC_PPC32
)

82 
	#ENDIAN_BIG


	)

83 
	#ENDIAN_32BITWORD


	)

84 
	#LTC_FAST


	)

85 
	#LTC_FAST_TYPE
 

	)

89 #ià
	`defšed
(
__¥¬c__
)

90 
	#ENDIAN_BIG


	)

91 #ià
	`defšed
(
__¬ch64__
)

92 
	#ENDIAN_64BITWORD


	)

94 
	#ENDIAN_32BITWORD


	)

99 #ifdeà
LTC_NO_FAST


100 #ifdeà
LTC_FAST


101 #undeà
LTC_FAST


106 #ifdeà
LTC_NO_ASM


107 #undeà
ENDIAN_LITTLE


108 #undeà
ENDIAN_BIG


109 #undeà
ENDIAN_32BITWORD


110 #undeà
ENDIAN_64BITWORD


111 #undeà
LTC_FAST


112 #undeà
LTC_FAST_TYPE


113 
	#LTC_NO_ROLC


	)

114 
	#LTC_NO_BSWAP


	)

123 #ià(
	`defšed
(
ENDIAN_BIG
è|| defšed(
ENDIAN_LITTLE
)è&& !(defšed(
ENDIAN_32BITWORD
è|| defšed(
ENDIAN_64BITWORD
))

124 #”rÜ 
You
 
mu¡
 
¥ecify
 
a
 
wÜd
 
size
 
as
 
w–l
‡ 
’dŸÃss
 
š
 
tomüy±_cfg
.
h


127 #ià!(
	`defšed
(
ENDIAN_BIG
è|| defšed(
ENDIAN_LITTLE
))

128 
	#ENDIAN_NEUTRAL


	)

	@libtomcrypt/src/headers/tomcrypt_cipher.h

6 #ifdeà
BLOWFISH


7 
	sblowfish_key
 {

8 
ulÚg32
 
	mS
[4][256];

9 
ulÚg32
 
	mK
[18];

13 #ifdeà
RC5


14 
	src5_key
 {

15 
	mrounds
;

16 
ulÚg32
 
	mK
[50];

20 #ifdeà
RC6


21 
	src6_key
 {

22 
ulÚg32
 
	mK
[44];

26 #ifdeà
SAFERP


27 
	s§ã½_key
 {

28 
	mK
[33][16];

29 
	mrounds
;

33 #ifdeà
RIJNDAEL


34 
	srijnd«l_key
 {

35 
ulÚg32
 
	meK
[60], 
	mdK
[60];

36 
	mNr
;

40 #ifdeà
KSEED


41 
	sk£ed_key
 {

42 
ulÚg32
 
	mK
[32], 
	mdK
[32];

46 #ifdeà
LTC_KASUMI


47 
	skasumi_key
 {

48 
ulÚg32
 
	mKLi1
[8], 
	mKLi2
[8],

49 
	mKOi1
[8], 
	mKOi2
[8], 
	mKOi3
[8],

50 
	mKIi1
[8], 
	mKIi2
[8], 
	mKIi3
[8];

54 #ifdeà
XTEA


55 
	sx‹a_key
 {

56 
	mA
[32], 
	mB
[32];

60 #ifdeà
TWOFISH


61 #iâdeà
TWOFISH_SMALL


62 
	stwofish_key
 {

63 
ulÚg32
 
	mS
[4][256], 
	mK
[40];

66 
	stwofish_key
 {

67 
ulÚg32
 
	mK
[40];

68 
	mS
[32], 
	m¡¬t
;

73 #ifdeà
SAFER


74 
	#SAFER_K64_DEFAULT_NOF_ROUNDS
 6

	)

75 
	#SAFER_K128_DEFAULT_NOF_ROUNDS
 10

	)

76 
	#SAFER_SK64_DEFAULT_NOF_ROUNDS
 8

	)

77 
	#SAFER_SK128_DEFAULT_NOF_ROUNDS
 10

	)

78 
	#SAFER_MAX_NOF_ROUNDS
 13

	)

79 
	#SAFER_BLOCK_LEN
 8

	)

80 
	#SAFER_KEY_LEN
 (1 + 
SAFER_BLOCK_LEN
 * (1 + 2 * 
SAFER_MAX_NOF_ROUNDS
))

	)

81 
	t§ãr_block_t
[
SAFER_BLOCK_LEN
];

82 
	t§ãr_key_t
[
SAFER_KEY_LEN
];

83 
	s§ãr_key
 { 
§ãr_key_t
 
	mkey
; };

86 #ifdeà
RC2


87 
	src2_key
 { 
	mxkey
[64]; };

90 #ifdeà
DES


91 
	sdes_key
 {

92 
ulÚg32
 
	mek
[32], 
	mdk
[32];

95 
	sdes3_key
 {

96 
ulÚg32
 
	mek
[3][32], 
	mdk
[3][32];

100 #ifdeà
CAST5


101 
	sÿ¡5_key
 {

102 
ulÚg32
 
	mK
[32], 
	mkeyËn
;

106 #ifdeà
NOEKEON


107 
	snÛkeÚ_key
 {

108 
ulÚg32
 
	mK
[4], 
	mdK
[4];

112 #ifdeà
SKIPJACK


113 
	sskjack_key
 {

114 
	mkey
[10];

118 #ifdeà
KHAZAD


119 
	skhazad_key
 {

120 
ulÚg64
 
	mroundKeyEnc
[8 + 1];

121 
ulÚg64
 
	mroundKeyDec
[8 + 1];

125 #ifdeà
ANUBIS


126 
	sªubis_key
 {

127 
	mkeyB™s
;

128 
	mR
;

129 
ulÚg32
 
	mroundKeyEnc
[18 + 1][4];

130 
ulÚg32
 
	mroundKeyDec
[18 + 1][4];

134 
	uSymm‘ric_key
 {

135 #ifdeà
DES


136 
des_key
 
	mdes
;

137 
des3_key
 
	mdes3
;

139 #ifdeà
RC2


140 
rc2_key
 
	mrc2
;

142 #ifdeà
SAFER


143 
§ãr_key
 
	m§ãr
;

145 #ifdeà
TWOFISH


146 
twofish_key
 
	mtwofish
;

148 #ifdeà
BLOWFISH


149 
blowfish_key
 
	mblowfish
;

151 #ifdeà
RC5


152 
rc5_key
 
	mrc5
;

154 #ifdeà
RC6


155 
rc6_key
 
	mrc6
;

157 #ifdeà
SAFERP


158 
§ã½_key
 
	m§ã½
;

160 #ifdeà
RIJNDAEL


161 
rijnd«l_key
 
	mrijnd«l
;

163 #ifdeà
XTEA


164 
x‹a_key
 
	mx‹a
;

166 #ifdeà
CAST5


167 
ÿ¡5_key
 
	mÿ¡5
;

169 #ifdeà
NOEKEON


170 
nÛkeÚ_key
 
	mnÛkeÚ
;

172 #ifdeà
SKIPJACK


173 
skjack_key
 
	mskjack
;

175 #ifdeà
KHAZAD


176 
khazad_key
 
	mkhazad
;

178 #ifdeà
ANUBIS


179 
ªubis_key
 
	mªubis
;

181 #ifdeà
KSEED


182 
k£ed_key
 
	mk£ed
;

184 #ifdeà
LTC_KASUMI


185 
kasumi_key
 
	mkasumi
;

187 *
	md©a
;

188 } 
	tsymm‘ric_key
;

190 #ifdeà
LTC_ECB_MODE


194 
	mch”
,

196 
	mblockËn
;

198 
symm‘ric_key
 
	mkey
;

199 } 
	tsymm‘ric_ECB
;

202 #ifdeà
LTC_CFB_MODE


206 
	mch”
,

208 
	mblockËn
,

210 
	m·dËn
;

212 
	mIV
[
MAXBLOCKSIZE
],

214 
	m·d
[
MAXBLOCKSIZE
];

216 
symm‘ric_key
 
	mkey
;

217 } 
	tsymm‘ric_CFB
;

220 #ifdeà
LTC_OFB_MODE


224 
	mch”
,

226 
	mblockËn
,

228 
	m·dËn
;

230 
	mIV
[
MAXBLOCKSIZE
];

232 
symm‘ric_key
 
	mkey
;

233 } 
	tsymm‘ric_OFB
;

236 #ifdeà
LTC_CBC_MODE


240 
	mch”
,

242 
	mblockËn
;

244 
	mIV
[
MAXBLOCKSIZE
];

246 
symm‘ric_key
 
	mkey
;

247 } 
	tsymm‘ric_CBC
;

251 #ifdeà
LTC_CTR_MODE


255 
	mch”
,

257 
	mblockËn
,

259 
	m·dËn
,

261 
	mmode
;

263 
	mùr
[
MAXBLOCKSIZE
],

265 
	m·d
[
MAXBLOCKSIZE
];

267 
symm‘ric_key
 
	mkey
;

268 } 
	tsymm‘ric_CTR
;

272 #ifdeà
LTC_LRW_MODE


276 
	mch”
;

279 
	mIV
[16],

282 
	mtw—k
[16],

285 
	m·d
[16];

288 
symm‘ric_key
 
	mkey
;

290 #ifdeà
LRW_TABLES


292 
	mPC
[16][256][16];

294 } 
	tsymm‘ric_LRW
;

297 #ifdeà
LTC_F8_MODE


301 
	mch”
,

303 
	mblockËn
,

305 
	m·dËn
;

307 
	mIV
[
MAXBLOCKSIZE
],

308 
	mMIV
[
MAXBLOCKSIZE
];

310 
ulÚg32
 
	mblockút
;

312 
symm‘ric_key
 
	mkey
;

313 } 
	tsymm‘ric_F8
;

318 
	sÉc_ch”_desütÜ
 {

320 *
Çme
;

322 
ID
;

324 
mš_key_Ëngth
,

326 
max_key_Ëngth
,

328 
block_Ëngth
,

330 
deçuÉ_rounds
;

338 (*
£tup
)(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

345 (*
ecb_’üy±
)(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

352 (*
ecb_deüy±
)(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

356 (*
‹¡
)();

361 (*
dÚe
)(
symm‘ric_key
 *
skey
);

367 (*
keysize
)(*keysize);

377 (*
acûl_ecb_’üy±
)(cÚ¡ *
±
, *
ù
, 
blocks
, 
symm‘ric_key
 *
skey
);

386 (*
acûl_ecb_deüy±
)(cÚ¡ *
ù
, *
±
, 
blocks
, 
symm‘ric_key
 *
skey
);

396 (*
acûl_cbc_’üy±
)(cÚ¡ *
±
, *
ù
, 
blocks
, *
IV
, 
symm‘ric_key
 *
skey
);

406 (*
acûl_cbc_deüy±
)(cÚ¡ *
ù
, *
±
, 
blocks
, *
IV
, 
symm‘ric_key
 *
skey
);

417 (*
acûl_ùr_’üy±
)(cÚ¡ *
±
, *
ù
, 
blocks
, *
IV
, 
mode
, 
symm‘ric_key
 *
skey
);

428 (*
acûl_Ìw_’üy±
)(cÚ¡ *
±
, *
ù
, 
blocks
, *
IV
, cÚ¡ *
tw—k
, 
symm‘ric_key
 *
skey
);

439 (*
acûl_Ìw_deüy±
)(cÚ¡ *
ù
, *
±
, 
blocks
, *
IV
, cÚ¡ *
tw—k
, 
symm‘ric_key
 *
skey
);

457 (*
acûl_ccm_memÜy
)(

458 cÚ¡ *
key
, 
keyËn
,

459 
symm‘ric_key
 *
uskey
,

460 cÚ¡ *
nÚû
, 
nÚûËn
,

461 cÚ¡ *
h—d”
, 
h—d”Ën
,

462 *
±
, 
±Ën
,

463 *
ù
,

464 *
g
, *
gËn
,

465 
dœeùiÚ
);

482 (*
acûl_gcm_memÜy
)(

483 cÚ¡ *
key
, 
keyËn
,

484 cÚ¡ *
IV
, 
IVËn
,

485 cÚ¡ *
ad©a
, 
ad©®’
,

486 *
±
, 
±Ën
,

487 *
ù
,

488 *
g
, *
gËn
,

489 
dœeùiÚ
);

500 (*
omac_memÜy
)(

501 cÚ¡ *
key
, 
keyËn
,

502 cÚ¡ *
š
, 
šËn
,

503 *
out
, *
ou’
);

514 (*
xcbc_memÜy
)(

515 cÚ¡ *
key
, 
keyËn
,

516 cÚ¡ *
š
, 
šËn
,

517 *
out
, *
ou’
);

529 (*
f9_memÜy
)(

530 cÚ¡ *
key
, 
keyËn
,

531 cÚ¡ *
š
, 
šËn
,

532 *
out
, *
ou’
);

533 } 
ch”_desütÜ
[];

535 #ifdeà
BLOWFISH


536 
blowfish_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

537 
blowfish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

538 
blowfish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

539 
blowfish_‹¡
();

540 
blowfish_dÚe
(
symm‘ric_key
 *
skey
);

541 
blowfish_keysize
(*
keysize
);

542 cÚ¡ 
Éc_ch”_desütÜ
 
blowfish_desc
;

545 #ifdeà
RC5


546 
rc5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

547 
rc5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

548 
rc5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

549 
rc5_‹¡
();

550 
rc5_dÚe
(
symm‘ric_key
 *
skey
);

551 
rc5_keysize
(*
keysize
);

552 cÚ¡ 
Éc_ch”_desütÜ
 
rc5_desc
;

555 #ifdeà
RC6


556 
rc6_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

557 
rc6_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

558 
rc6_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

559 
rc6_‹¡
();

560 
rc6_dÚe
(
symm‘ric_key
 *
skey
);

561 
rc6_keysize
(*
keysize
);

562 cÚ¡ 
Éc_ch”_desütÜ
 
rc6_desc
;

565 #ifdeà
RC2


566 
rc2_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

567 
rc2_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

568 
rc2_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

569 
rc2_‹¡
();

570 
rc2_dÚe
(
symm‘ric_key
 *
skey
);

571 
rc2_keysize
(*
keysize
);

572 cÚ¡ 
Éc_ch”_desütÜ
 
rc2_desc
;

575 #ifdeà
SAFERP


576 
§ã½_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

577 
§ã½_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

578 
§ã½_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

579 
§ã½_‹¡
();

580 
§ã½_dÚe
(
symm‘ric_key
 *
skey
);

581 
§ã½_keysize
(*
keysize
);

582 cÚ¡ 
Éc_ch”_desütÜ
 
§ã½_desc
;

585 #ifdeà
SAFER


586 
§ãr_k64_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

587 
§ãr_sk64_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

588 
§ãr_k128_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

589 
§ãr_sk128_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

590 
§ãr_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
key
);

591 
§ãr_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
key
);

592 
§ãr_k64_‹¡
();

593 
§ãr_sk64_‹¡
();

594 
§ãr_sk128_‹¡
();

595 
§ãr_dÚe
(
symm‘ric_key
 *
skey
);

596 
§ãr_64_keysize
(*
keysize
);

597 
§ãr_128_keysize
(*
keysize
);

598 cÚ¡ 
Éc_ch”_desütÜ
 
§ãr_k64_desc
, 
§ãr_k128_desc
, 
§ãr_sk64_desc
, 
§ãr_sk128_desc
;

601 #ifdeà
RIJNDAEL


604 
	#«s_£tup
 
rijnd«l_£tup


	)

605 
	#«s_ecb_’üy±
 
rijnd«l_ecb_’üy±


	)

606 
	#«s_ecb_deüy±
 
rijnd«l_ecb_deüy±


	)

607 
	#«s_‹¡
 
rijnd«l_‹¡


	)

608 
	#«s_dÚe
 
rijnd«l_dÚe


	)

609 
	#«s_keysize
 
rijnd«l_keysize


	)

611 
	#«s_’c_£tup
 
rijnd«l_’c_£tup


	)

612 
	#«s_’c_ecb_’üy±
 
rijnd«l_’c_ecb_’üy±


	)

613 
	#«s_’c_keysize
 
rijnd«l_’c_keysize


	)

615 
rijnd«l_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

616 
rijnd«l_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

617 
rijnd«l_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

618 
rijnd«l_‹¡
();

619 
rijnd«l_dÚe
(
symm‘ric_key
 *
skey
);

620 
rijnd«l_keysize
(*
keysize
);

621 
rijnd«l_’c_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

622 
rijnd«l_’c_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

623 
rijnd«l_’c_dÚe
(
symm‘ric_key
 *
skey
);

624 
rijnd«l_’c_keysize
(*
keysize
);

625 cÚ¡ 
Éc_ch”_desütÜ
 
rijnd«l_desc
, 
«s_desc
;

626 cÚ¡ 
Éc_ch”_desütÜ
 
rijnd«l_’c_desc
, 
«s_’c_desc
;

629 #ifdeà
XTEA


630 
x‹a_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

631 
x‹a_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

632 
x‹a_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

633 
x‹a_‹¡
();

634 
x‹a_dÚe
(
symm‘ric_key
 *
skey
);

635 
x‹a_keysize
(*
keysize
);

636 cÚ¡ 
Éc_ch”_desütÜ
 
x‹a_desc
;

639 #ifdeà
TWOFISH


640 
twofish_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

641 
twofish_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

642 
twofish_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

643 
twofish_‹¡
();

644 
twofish_dÚe
(
symm‘ric_key
 *
skey
);

645 
twofish_keysize
(*
keysize
);

646 cÚ¡ 
Éc_ch”_desütÜ
 
twofish_desc
;

649 #ifdeà
DES


650 
des_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

651 
des_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

652 
des_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

653 
des_‹¡
();

654 
des_dÚe
(
symm‘ric_key
 *
skey
);

655 
des_keysize
(*
keysize
);

656 
des3_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

657 
des3_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

658 
des3_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

659 
des3_‹¡
();

660 
des3_dÚe
(
symm‘ric_key
 *
skey
);

661 
des3_keysize
(*
keysize
);

662 cÚ¡ 
Éc_ch”_desütÜ
 
des_desc
, 
des3_desc
;

665 #ifdeà
CAST5


666 
ÿ¡5_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

667 
ÿ¡5_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

668 
ÿ¡5_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

669 
ÿ¡5_‹¡
();

670 
ÿ¡5_dÚe
(
symm‘ric_key
 *
skey
);

671 
ÿ¡5_keysize
(*
keysize
);

672 cÚ¡ 
Éc_ch”_desütÜ
 
ÿ¡5_desc
;

675 #ifdeà
NOEKEON


676 
nÛkeÚ_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

677 
nÛkeÚ_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

678 
nÛkeÚ_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

679 
nÛkeÚ_‹¡
();

680 
nÛkeÚ_dÚe
(
symm‘ric_key
 *
skey
);

681 
nÛkeÚ_keysize
(*
keysize
);

682 cÚ¡ 
Éc_ch”_desütÜ
 
nÛkeÚ_desc
;

685 #ifdeà
SKIPJACK


686 
skjack_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

687 
skjack_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

688 
skjack_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

689 
skjack_‹¡
();

690 
skjack_dÚe
(
symm‘ric_key
 *
skey
);

691 
skjack_keysize
(*
keysize
);

692 cÚ¡ 
Éc_ch”_desütÜ
 
skjack_desc
;

695 #ifdeà
KHAZAD


696 
khazad_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

697 
khazad_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

698 
khazad_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

699 
khazad_‹¡
();

700 
khazad_dÚe
(
symm‘ric_key
 *
skey
);

701 
khazad_keysize
(*
keysize
);

702 cÚ¡ 
Éc_ch”_desütÜ
 
khazad_desc
;

705 #ifdeà
ANUBIS


706 
ªubis_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

707 
ªubis_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

708 
ªubis_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

709 
ªubis_‹¡
();

710 
ªubis_dÚe
(
symm‘ric_key
 *
skey
);

711 
ªubis_keysize
(*
keysize
);

712 cÚ¡ 
Éc_ch”_desütÜ
 
ªubis_desc
;

715 #ifdeà
KSEED


716 
k£ed_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

717 
k£ed_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

718 
k£ed_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

719 
k£ed_‹¡
();

720 
k£ed_dÚe
(
symm‘ric_key
 *
skey
);

721 
k£ed_keysize
(*
keysize
);

722 cÚ¡ 
Éc_ch”_desütÜ
 
k£ed_desc
;

725 #ifdeà
LTC_KASUMI


726 
kasumi_£tup
(cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_key
 *
skey
);

727 
kasumi_ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
symm‘ric_key
 *
skey
);

728 
kasumi_ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
symm‘ric_key
 *
skey
);

729 
kasumi_‹¡
();

730 
kasumi_dÚe
(
symm‘ric_key
 *
skey
);

731 
kasumi_keysize
(*
keysize
);

732 cÚ¡ 
Éc_ch”_desütÜ
 
kasumi_desc
;

735 #ifdeà
LTC_ECB_MODE


736 
ecb_¡¬t
(
ch”
, cÚ¡ *
key
,

737 
keyËn
, 
num_rounds
, 
symm‘ric_ECB
 *
ecb
);

738 
ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_ECB
 *
ecb
);

739 
ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_ECB
 *
ecb
);

740 
ecb_dÚe
(
symm‘ric_ECB
 *
ecb
);

743 #ifdeà
LTC_CFB_MODE


744 
cfb_¡¬t
(
ch”
, cÚ¡ *
IV
, cÚ¡ *
key
,

745 
keyËn
, 
num_rounds
, 
symm‘ric_CFB
 *
cfb
);

746 
cfb_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_CFB
 *
cfb
);

747 
cfb_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_CFB
 *
cfb
);

748 
cfb_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_CFB
 *
cfb
);

749 
cfb_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_CFB
 *
cfb
);

750 
cfb_dÚe
(
symm‘ric_CFB
 *
cfb
);

753 #ifdeà
LTC_OFB_MODE


754 
ofb_¡¬t
(
ch”
, cÚ¡ *
IV
, cÚ¡ *
key
,

755 
keyËn
, 
num_rounds
, 
symm‘ric_OFB
 *
ofb
);

756 
ofb_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_OFB
 *
ofb
);

757 
ofb_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_OFB
 *
ofb
);

758 
ofb_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_OFB
 *
ofb
);

759 
ofb_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_OFB
 *
ofb
);

760 
ofb_dÚe
(
symm‘ric_OFB
 *
ofb
);

763 #ifdeà
LTC_CBC_MODE


764 
cbc_¡¬t
(
ch”
, cÚ¡ *
IV
, cÚ¡ *
key
,

765 
keyËn
, 
num_rounds
, 
symm‘ric_CBC
 *
cbc
);

766 
cbc_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_CBC
 *
cbc
);

767 
cbc_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_CBC
 *
cbc
);

768 
cbc_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_CBC
 *
cbc
);

769 
cbc_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_CBC
 *
cbc
);

770 
cbc_dÚe
(
symm‘ric_CBC
 *
cbc
);

773 #ifdeà
LTC_CTR_MODE


775 
	#CTR_COUNTER_LITTLE_ENDIAN
 0

	)

776 
	#CTR_COUNTER_BIG_ENDIAN
 1

	)

777 
	#LTC_CTR_RFC3686
 2

	)

779 
ùr_¡¬t
Ğ
ch”
,

780 cÚ¡ *
IV
,

781 cÚ¡ *
key
, 
keyËn
,

782 
num_rounds
, 
ùr_mode
,

783 
symm‘ric_CTR
 *
ùr
);

784 
ùr_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_CTR
 *
ùr
);

785 
ùr_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_CTR
 *
ùr
);

786 
ùr_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_CTR
 *
ùr
);

787 
ùr_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_CTR
 *
ùr
);

788 
ùr_dÚe
(
symm‘ric_CTR
 *
ùr
);

789 
ùr_‹¡
();

792 #ifdeà
LTC_LRW_MODE


794 
	#LRW_ENCRYPT
 0

	)

795 
	#LRW_DECRYPT
 1

	)

797 
Ìw_¡¬t
Ğ
ch”
,

798 cÚ¡ *
IV
,

799 cÚ¡ *
key
, 
keyËn
,

800 cÚ¡ *
tw—k
,

801 
num_rounds
,

802 
symm‘ric_LRW
 *
Ìw
);

803 
Ìw_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_LRW
 *
Ìw
);

804 
Ìw_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_LRW
 *
Ìw
);

805 
Ìw_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_LRW
 *
Ìw
);

806 
Ìw_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_LRW
 *
Ìw
);

807 
Ìw_dÚe
(
symm‘ric_LRW
 *
Ìw
);

808 
Ìw_‹¡
();

811 
Ìw_´oûss
(cÚ¡ *
±
, *
ù
, 
Ën
, 
mode
, 
symm‘ric_LRW
 *
Ìw
);

814 #ifdeà
LTC_F8_MODE


815 
f8_¡¬t
Ğ
ch”
, cÚ¡ *
IV
,

816 cÚ¡ *
key
, 
keyËn
,

817 cÚ¡ *
§É_key
, 
skeyËn
,

818 
num_rounds
, 
symm‘ric_F8
 *
f8
);

819 
f8_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_F8
 *
f8
);

820 
f8_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_F8
 *
f8
);

821 
f8_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_F8
 *
f8
);

822 
f8_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_F8
 *
f8
);

823 
f8_dÚe
(
symm‘ric_F8
 *
f8
);

824 
f8_‹¡_mode
();

828 
fšd_ch”
(cÚ¡ *
Çme
);

829 
fšd_ch”_ªy
(cÚ¡ *
Çme
, 
blockËn
, 
keyËn
);

830 
fšd_ch”_id
(
ID
);

831 
»gi¡”_ch”
(cÚ¡ 
Éc_ch”_desütÜ
 *
ch”
);

832 
uÄegi¡”_ch”
(cÚ¡ 
Éc_ch”_desütÜ
 *
ch”
);

833 
ch”_is_v®id
(
idx
);

835 
LTC_MUTEX_PROTO
(
Éc_ch”_mu‹x
)

	@libtomcrypt/src/headers/tomcrypt_custom.h

1 #iâdeà
TOMCRYPT_CUSTOM_H_


2 
	#TOMCRYPT_CUSTOM_H_


	)

5 
	~"İtiÚs.h
"

8 #iâdeà
XMALLOC


9 #ifdeà
m®loc


10 
	#LTC_NO_PROTOTYPES


	)

12 
	#XMALLOC
 
m®loc


	)

14 #iâdeà
XREALLOC


15 #ifdeà
»®loc


16 
	#LTC_NO_PROTOTYPES


	)

18 
	#XREALLOC
 
»®loc


	)

20 #iâdeà
XCALLOC


21 #ifdeà
ÿÎoc


22 
	#LTC_NO_PROTOTYPES


	)

24 
	#XCALLOC
 
ÿÎoc


	)

26 #iâdeà
XFREE


27 #ifdeà
ä“


28 
	#LTC_NO_PROTOTYPES


	)

30 
	#XFREE
 
ä“


	)

33 #iâdeà
XMEMSET


34 #ifdeà
mem£t


35 
	#LTC_NO_PROTOTYPES


	)

37 
	#XMEMSET
 
mem£t


	)

39 #iâdeà
XMEMCPY


40 #ifdeà
memıy


41 
	#LTC_NO_PROTOTYPES


	)

43 
	#XMEMCPY
 
memıy


	)

45 #iâdeà
XMEMCMP


46 #ifdeà
memcmp


47 
	#LTC_NO_PROTOTYPES


	)

49 
	#XMEMCMP
 
memcmp


	)

51 #iâdeà
XSTRCMP


52 #ifdeà
¡rcmp


53 
	#LTC_NO_PROTOTYPES


	)

55 
	#XSTRCMP
 
¡rcmp


	)

58 #iâdeà
XCLOCK


59 
	#XCLOCK
 
şock


	)

61 #iâdeà
XCLOCKS_PER_SEC


62 
	#XCLOCKS_PER_SEC
 
CLOCKS_PER_SEC


	)

65 
	#LTC_NO_PRNGS


	)

66 
	#LTC_NO_PK


	)

67 #ifdeà
DROPBEAR_SMALL_CODE


68 
	#LTC_SMALL_CODE


	)

71 
	#LTC_NO_ROLC


	)

93 #ifdeà
DROPBEAR_BLOWFISH


94 
	#BLOWFISH


	)

97 #ifdeà
DROPBEAR_AES


98 
	#RIJNDAEL


	)

101 #ifdeà
DROPBEAR_TWOFISH


102 
	#TWOFISH


	)

107 
	#TWOFISH_SMALL


	)

111 #ifdeà
DROPBEAR_3DES


112 
	#DES


	)

115 
	#LTC_CBC_MODE


	)

117 #ifdeà
DROPBEAR_ENABLE_CTR_MODE


118 
	#LTC_CTR_MODE


	)

121 #ià
defšed
(
DROPBEAR_DSS
è&& defšed(
DSS_PROTOK
)

122 
	#SHA512


	)

125 
	#SHA1


	)

127 #ifdeà
DROPBEAR_MD5_HMAC


128 
	#MD5


	)

131 
	#LTC_HMAC


	)

134 
	#BASE64


	)

137 
	#LTC_MUTEX_GLOBAL
(
x
)

	)

138 
	#LTC_MUTEX_PROTO
(
x
)

	)

139 
	#LTC_MUTEX_TYPE
(
x
)

	)

140 
	#LTC_MUTEX_INIT
(
x
)

	)

141 
	#LTC_MUTEX_LOCK
(
x
)

	)

142 
	#LTC_MUTEX_UNLOCK
(
x
)

	)

143 
	#FORTUNA_POOLS
 0

	)

	@libtomcrypt/src/headers/tomcrypt_hash.h

2 #ifdeà
SHA512


3 
	ssha512_¡©e
 {

4 
ulÚg64
 
	mËngth
, 
	m¡©e
[8];

5 
	mcu¾’
;

6 
	mbuf
[128];

10 #ifdeà
SHA256


11 
	ssha256_¡©e
 {

12 
ulÚg64
 
	mËngth
;

13 
ulÚg32
 
	m¡©e
[8], 
	mcu¾’
;

14 
	mbuf
[64];

18 #ifdeà
SHA1


19 
	ssha1_¡©e
 {

20 
ulÚg64
 
	mËngth
;

21 
ulÚg32
 
	m¡©e
[5], 
	mcu¾’
;

22 
	mbuf
[64];

26 #ifdeà
MD5


27 
	smd5_¡©e
 {

28 
ulÚg64
 
	mËngth
;

29 
ulÚg32
 
	m¡©e
[4], 
	mcu¾’
;

30 
	mbuf
[64];

34 #ifdeà
MD4


35 
	smd4_¡©e
 {

36 
ulÚg64
 
	mËngth
;

37 
ulÚg32
 
	m¡©e
[4], 
	mcu¾’
;

38 
	mbuf
[64];

42 #ifdeà
TIGER


43 
	stig”_¡©e
 {

44 
ulÚg64
 
	m¡©e
[3], 
	mËngth
;

45 
	mcu¾’
;

46 
	mbuf
[64];

50 #ifdeà
MD2


51 
	smd2_¡©e
 {

52 
	mchksum
[16], 
	mX
[48], 
	mbuf
[16];

53 
	mcu¾’
;

57 #ifdeà
RIPEMD128


58 
	srmd128_¡©e
 {

59 
ulÚg64
 
	mËngth
;

60 
	mbuf
[64];

61 
ulÚg32
 
	mcu¾’
, 
	m¡©e
[4];

65 #ifdeà
RIPEMD160


66 
	srmd160_¡©e
 {

67 
ulÚg64
 
	mËngth
;

68 
	mbuf
[64];

69 
ulÚg32
 
	mcu¾’
, 
	m¡©e
[5];

73 #ifdeà
RIPEMD256


74 
	srmd256_¡©e
 {

75 
ulÚg64
 
	mËngth
;

76 
	mbuf
[64];

77 
ulÚg32
 
	mcu¾’
, 
	m¡©e
[8];

81 #ifdeà
RIPEMD320


82 
	srmd320_¡©e
 {

83 
ulÚg64
 
	mËngth
;

84 
	mbuf
[64];

85 
ulÚg32
 
	mcu¾’
, 
	m¡©e
[10];

89 #ifdeà
WHIRLPOOL


90 
	swhœÍoŞ_¡©e
 {

91 
ulÚg64
 
	mËngth
, 
	m¡©e
[8];

92 
	mbuf
[64];

93 
ulÚg32
 
	mcu¾’
;

97 #ifdeà
CHC_HASH


98 
	schc_¡©e
 {

99 
ulÚg64
 
	mËngth
;

100 
	m¡©e
[
MAXBLOCKSIZE
], 
	mbuf
[MAXBLOCKSIZE];

101 
ulÚg32
 
	mcu¾’
;

105 
	uHash_¡©e
 {

106 
	mdummy
[1];

107 #ifdeà
CHC_HASH


108 
chc_¡©e
 
	mchc
;

110 #ifdeà
WHIRLPOOL


111 
whœÍoŞ_¡©e
 
	mwhœÍoŞ
;

113 #ifdeà
SHA512


114 
sha512_¡©e
 
	msha512
;

116 #ifdeà
SHA256


117 
sha256_¡©e
 
	msha256
;

119 #ifdeà
SHA1


120 
sha1_¡©e
 
	msha1
;

122 #ifdeà
MD5


123 
md5_¡©e
 
	mmd5
;

125 #ifdeà
MD4


126 
md4_¡©e
 
	mmd4
;

128 #ifdeà
MD2


129 
md2_¡©e
 
	mmd2
;

131 #ifdeà
TIGER


132 
tig”_¡©e
 
	mtig”
;

134 #ifdeà
RIPEMD128


135 
rmd128_¡©e
 
	mrmd128
;

137 #ifdeà
RIPEMD160


138 
rmd160_¡©e
 
	mrmd160
;

140 #ifdeà
RIPEMD256


141 
rmd256_¡©e
 
	mrmd256
;

143 #ifdeà
RIPEMD320


144 
rmd320_¡©e
 
	mrmd320
;

146 *
	md©a
;

147 } 
	thash_¡©e
;

150 
	sÉc_hash_desütÜ
 {

152 *
Çme
;

154 
ID
;

156 
hashsize
;

158 
blocksize
;

160 
OID
[16];

162 
OIDËn
;

168 (*
š™
)(
hash_¡©e
 *
hash
);

175 (*
´oûss
)(
hash_¡©e
 *
hash
, cÚ¡ *
š
, 
šËn
);

181 (*
dÚe
)(
hash_¡©e
 *
hash
, *
out
);

185 (*
‹¡
)();

188 (*
hmac_block
)(cÚ¡ *
key
, 
keyËn
,

189 cÚ¡ *
š
, 
šËn
,

190 *
out
, *
ou’
);

192 } 
hash_desütÜ
[];

194 #ifdeà
CHC_HASH


195 
chc_»gi¡”
(
ch”
);

196 
chc_š™
(
hash_¡©e
 * 
md
);

197 
chc_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

198 
chc_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

199 
chc_‹¡
();

200 cÚ¡ 
Éc_hash_desütÜ
 
chc_desc
;

203 #ifdeà
WHIRLPOOL


204 
whœÍoŞ_š™
(
hash_¡©e
 * 
md
);

205 
whœÍoŞ_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

206 
whœÍoŞ_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

207 
whœÍoŞ_‹¡
();

208 cÚ¡ 
Éc_hash_desütÜ
 
whœÍoŞ_desc
;

211 #ifdeà
SHA512


212 
sha512_š™
(
hash_¡©e
 * 
md
);

213 
sha512_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

214 
sha512_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

215 
sha512_‹¡
();

216 cÚ¡ 
Éc_hash_desütÜ
 
sha512_desc
;

219 #ifdeà
SHA384


220 #iâdeà
SHA512


221 #”rÜ 
SHA512
 
is
 
»quœed
 
SHA384


223 
sha384_š™
(
hash_¡©e
 * 
md
);

224 
	#sha384_´oûss
 
sha512_´oûss


	)

225 
sha384_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

226 
sha384_‹¡
();

227 cÚ¡ 
Éc_hash_desütÜ
 
sha384_desc
;

230 #ifdeà
SHA256


231 
sha256_š™
(
hash_¡©e
 * 
md
);

232 
sha256_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

233 
sha256_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

234 
sha256_‹¡
();

235 cÚ¡ 
Éc_hash_desütÜ
 
sha256_desc
;

237 #ifdeà
SHA224


238 #iâdeà
SHA256


239 #”rÜ 
SHA256
 
is
 
»quœed
 
SHA224


241 
sha224_š™
(
hash_¡©e
 * 
md
);

242 
	#sha224_´oûss
 
sha256_´oûss


	)

243 
sha224_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

244 
sha224_‹¡
();

245 cÚ¡ 
Éc_hash_desütÜ
 
sha224_desc
;

249 #ifdeà
SHA1


250 
sha1_š™
(
hash_¡©e
 * 
md
);

251 
sha1_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

252 
sha1_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

253 
sha1_‹¡
();

254 cÚ¡ 
Éc_hash_desütÜ
 
sha1_desc
;

257 #ifdeà
MD5


258 
md5_š™
(
hash_¡©e
 * 
md
);

259 
md5_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

260 
md5_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

261 
md5_‹¡
();

262 cÚ¡ 
Éc_hash_desütÜ
 
md5_desc
;

265 #ifdeà
MD4


266 
md4_š™
(
hash_¡©e
 * 
md
);

267 
md4_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

268 
md4_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

269 
md4_‹¡
();

270 cÚ¡ 
Éc_hash_desütÜ
 
md4_desc
;

273 #ifdeà
MD2


274 
md2_š™
(
hash_¡©e
 * 
md
);

275 
md2_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

276 
md2_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

277 
md2_‹¡
();

278 cÚ¡ 
Éc_hash_desütÜ
 
md2_desc
;

281 #ifdeà
TIGER


282 
tig”_š™
(
hash_¡©e
 * 
md
);

283 
tig”_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

284 
tig”_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

285 
tig”_‹¡
();

286 cÚ¡ 
Éc_hash_desütÜ
 
tig”_desc
;

289 #ifdeà
RIPEMD128


290 
rmd128_š™
(
hash_¡©e
 * 
md
);

291 
rmd128_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

292 
rmd128_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

293 
rmd128_‹¡
();

294 cÚ¡ 
Éc_hash_desütÜ
 
rmd128_desc
;

297 #ifdeà
RIPEMD160


298 
rmd160_š™
(
hash_¡©e
 * 
md
);

299 
rmd160_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

300 
rmd160_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

301 
rmd160_‹¡
();

302 cÚ¡ 
Éc_hash_desütÜ
 
rmd160_desc
;

305 #ifdeà
RIPEMD256


306 
rmd256_š™
(
hash_¡©e
 * 
md
);

307 
rmd256_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

308 
rmd256_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

309 
rmd256_‹¡
();

310 cÚ¡ 
Éc_hash_desütÜ
 
rmd256_desc
;

313 #ifdeà
RIPEMD320


314 
rmd320_š™
(
hash_¡©e
 * 
md
);

315 
rmd320_´oûss
(
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
);

316 
rmd320_dÚe
(
hash_¡©e
 * 
md
, *
hash
);

317 
rmd320_‹¡
();

318 cÚ¡ 
Éc_hash_desütÜ
 
rmd320_desc
;

322 
fšd_hash
(cÚ¡ *
Çme
);

323 
fšd_hash_id
(
ID
);

324 
fšd_hash_oid
(cÚ¡ *
ID
, 
IDËn
);

325 
fšd_hash_ªy
(cÚ¡ *
Çme
, 
dige¡Ën
);

326 
»gi¡”_hash
(cÚ¡ 
Éc_hash_desütÜ
 *
hash
);

327 
uÄegi¡”_hash
(cÚ¡ 
Éc_hash_desütÜ
 *
hash
);

328 
hash_is_v®id
(
idx
);

330 
	$LTC_MUTEX_PROTO
(
Éc_hash_mu‹x
)

332 
	`hash_memÜy
(
hash
,

333 cÚ¡ *
š
, 
šËn
,

334 *
out
, *
ou’
);

335 
	`hash_memÜy_muÉi
(
hash
, *
out
, *
ou’
,

336 cÚ¡ *
š
, 
šËn
, ...);

337 
	`hash_fehªdË
(
hash
, 
FILE
 *
š
, *
out
, *
ou’
);

338 
	`hash_fe
(
hash
, cÚ¡ *
âame
, *
out
, *
ou’
);

341 
	#HASH_PROCESS
(
func_Çme
, 
com´ess_Çme
, 
¡©e_v¬
, 
block_size
) \

342 
	`func_Çme
 (
hash_¡©e
 * 
md
, cÚ¡ *
š
, 
šËn
) \

344 
n
; \

345 
”r
; \

346 
	`LTC_ARGCHK
(
md
 !ğ
NULL
); \

347 
	`LTC_ARGCHK
(
š
 !ğ
NULL
); \

348 ià(
md
-> 
¡©e_v¬
 .
cu¾’
 > (md-> s‹_v¬ .
buf
)) { \

349  
CRYPT_INVALID_ARG
; \

351 
šËn
 > 0) { \

352 ià(
md
-> 
¡©e_v¬
 .
cu¾’
 =ğ0 && 
šËn
 >ğ
block_size
) { \

353 ià((
”r
 = 
	`com´ess_Çme
 (
md
, (*)
š
)è!ğ
CRYPT_OK
) { \

354  
”r
; \

356 
md
-> 
¡©e_v¬
 .
Ëngth
 +ğ
block_size
 * 8; \

357 
š
 +ğ
block_size
; \

358 
šËn
 -ğ
block_size
; \

360 
n
 = 
	`MIN
(
šËn
, (
block_size
 - 
md
-> 
¡©e_v¬
 .
cu¾’
)); \

361 
	`memıy
(
md
-> 
¡©e_v¬
 .
buf
 + md-> s‹_v¬.
cu¾’
, 
š
, (
size_t
)
n
); \

362 
md
-> 
¡©e_v¬
 .
cu¾’
 +ğ
n
; \

363 
š
 +ğ
n
; \

364 
šËn
 -ğ
n
; \

365 ià(
md
-> 
¡©e_v¬
 .
cu¾’
 =ğ
block_size
) { \

366 ià((
”r
 = 
	`com´ess_Çme
 (
md
, md-> 
¡©e_v¬
 .
buf
)è!ğ
CRYPT_OK
) { \

367  
”r
; \

369 
md
-> 
¡©e_v¬
 .
Ëngth
 +ğ8*
block_size
; \

370 
md
-> 
¡©e_v¬
 .
cu¾’
 = 0; \

374  
CRYPT_OK
; \

375 
	}

	)
}

	@libtomcrypt/src/headers/tomcrypt_mac.h

1 #ifdeà
LTC_HMAC


2 
	sHmac_¡©e
 {

3 
hash_¡©e
 
	mmd
;

4 
	mhash
;

5 
hash_¡©e
 
	mhash¡©e
;

6 *
	mkey
;

7 } 
	thmac_¡©e
;

9 
hmac_š™
(
hmac_¡©e
 *
hmac
, 
hash
, cÚ¡ *
key
, 
keyËn
);

10 
hmac_´oûss
(
hmac_¡©e
 *
hmac
, cÚ¡ *
š
, 
šËn
);

11 
hmac_dÚe
(
hmac_¡©e
 *
hmac
, *
out
, *
ou’
);

12 
hmac_‹¡
();

13 
hmac_memÜy
(
hash
,

14 cÚ¡ *
key
, 
keyËn
,

15 cÚ¡ *
š
, 
šËn
,

16 *
out
, *
ou’
);

17 
hmac_memÜy_muÉi
(
hash
,

18 cÚ¡ *
key
, 
keyËn
,

19 *
out
, *
ou’
,

20 cÚ¡ *
š
, 
šËn
, ...);

21 
hmac_fe
(
hash
, cÚ¡ *
âame
, cÚ¡ *
key
,

22 
keyËn
,

23 *
d¡
, *
d¡Ën
);

26 #ifdeà
LTC_OMAC


29 
	mch”_idx
,

30 
	mbuæ’
,

31 
	mblkËn
;

32 
	mblock
[
MAXBLOCKSIZE
],

33 
	m´ev
[
MAXBLOCKSIZE
],

34 
	mLu
[2][
MAXBLOCKSIZE
];

35 
symm‘ric_key
 
	mkey
;

36 } 
	tomac_¡©e
;

38 
omac_š™
(
omac_¡©e
 *
omac
, 
ch”
, cÚ¡ *
key
, 
keyËn
);

39 
omac_´oûss
(
omac_¡©e
 *
omac
, cÚ¡ *
š
, 
šËn
);

40 
omac_dÚe
(
omac_¡©e
 *
omac
, *
out
, *
ou’
);

41 
omac_memÜy
(
ch”
,

42 cÚ¡ *
key
, 
keyËn
,

43 cÚ¡ *
š
, 
šËn
,

44 *
out
, *
ou’
);

45 
omac_memÜy_muÉi
(
ch”
,

46 cÚ¡ *
key
, 
keyËn
,

47 *
out
, *
ou’
,

48 cÚ¡ *
š
, 
šËn
, ...);

49 
omac_fe
(
ch”
,

50 cÚ¡ *
key
, 
keyËn
,

51 cÚ¡ *
f’ame
,

52 *
out
, *
ou’
);

53 
omac_‹¡
();

56 #ifdeà
LTC_PMAC


59 
	mLs
[32][
MAXBLOCKSIZE
],

60 
	mLi
[
MAXBLOCKSIZE
],

61 
	mLr
[
MAXBLOCKSIZE
],

62 
	mblock
[
MAXBLOCKSIZE
],

63 
	mchecksum
[
MAXBLOCKSIZE
];

65 
symm‘ric_key
 
	mkey
;

66 
	mblock_šdex
;

67 
	mch”_idx
,

68 
	mblock_Ën
,

69 
	mbuæ’
;

70 } 
	tpmac_¡©e
;

72 
pmac_š™
(
pmac_¡©e
 *
pmac
, 
ch”
, cÚ¡ *
key
, 
keyËn
);

73 
pmac_´oûss
(
pmac_¡©e
 *
pmac
, cÚ¡ *
š
, 
šËn
);

74 
pmac_dÚe
(
pmac_¡©e
 *
pmac
, *
out
, *
ou’
);

76 
pmac_memÜy
(
ch”
,

77 cÚ¡ *
key
, 
keyËn
,

78 cÚ¡ *
msg
, 
msgËn
,

79 *
out
, *
ou’
);

81 
pmac_memÜy_muÉi
(
ch”
,

82 cÚ¡ *
key
, 
keyËn
,

83 *
out
, *
ou’
,

84 cÚ¡ *
š
, 
šËn
, ...);

86 
pmac_fe
(
ch”
,

87 cÚ¡ *
key
, 
keyËn
,

88 cÚ¡ *
f’ame
,

89 *
out
, *
ou’
);

91 
pmac_‹¡
();

94 
pmac_Áz
(
x
);

95 
pmac_shiá_xÜ
(
pmac_¡©e
 *
pmac
);

99 #ifdeà
EAX_MODE


101 #ià!(
defšed
(
LTC_OMAC
è&& defšed(
LTC_CTR_MODE
))

102 #”rÜ 
EAX_MODE
 
»quœes
 
OMAC
 
ªd
 
CTR


106 
	mN
[
MAXBLOCKSIZE
];

107 
symm‘ric_CTR
 
	mùr
;

108 
omac_¡©e
 
	mh—d”omac
, 
	mùomac
;

109 } 
	t—x_¡©e
;

111 
—x_š™
(
—x_¡©e
 *
—x
, 
ch”
, cÚ¡ *
key
, 
keyËn
,

112 cÚ¡ *
nÚû
, 
nÚûËn
,

113 cÚ¡ *
h—d”
, 
h—d”Ën
);

115 
—x_’üy±
(
—x_¡©e
 *
—x
, cÚ¡ *
±
, *
ù
, 
Ëngth
);

116 
—x_deüy±
(
—x_¡©e
 *
—x
, cÚ¡ *
ù
, *
±
, 
Ëngth
);

117 
—x_addh—d”
(
—x_¡©e
 *
—x
, cÚ¡ *
h—d”
, 
Ëngth
);

118 
—x_dÚe
(
—x_¡©e
 *
—x
, *
g
, *
gËn
);

120 
—x_’üy±_auth’tiÿ‹_memÜy
(
ch”
,

121 cÚ¡ *
key
, 
keyËn
,

122 cÚ¡ *
nÚû
, 
nÚûËn
,

123 cÚ¡ *
h—d”
, 
h—d”Ën
,

124 cÚ¡ *
±
, 
±Ën
,

125 *
ù
,

126 *
g
, *
gËn
);

128 
—x_deüy±_v”ify_memÜy
(
ch”
,

129 cÚ¡ *
key
, 
keyËn
,

130 cÚ¡ *
nÚû
, 
nÚûËn
,

131 cÚ¡ *
h—d”
, 
h—d”Ën
,

132 cÚ¡ *
ù
, 
ùËn
,

133 *
±
,

134 *
g
, 
gËn
,

135 *
¡©
);

137 
—x_‹¡
();

140 #ifdeà
OCB_MODE


142 
	mL
[
MAXBLOCKSIZE
],

143 
	mLs
[32][
MAXBLOCKSIZE
],

144 
	mLi
[
MAXBLOCKSIZE
],

145 
	mLr
[
MAXBLOCKSIZE
],

146 
	mR
[
MAXBLOCKSIZE
],

147 
	mchecksum
[
MAXBLOCKSIZE
];

149 
symm‘ric_key
 
	mkey
;

150 
	mblock_šdex
;

151 
	mch”
,

152 
	mblock_Ën
;

153 } 
	tocb_¡©e
;

155 
ocb_š™
(
ocb_¡©e
 *
ocb
, 
ch”
,

156 cÚ¡ *
key
, 
keyËn
, cÚ¡ *
nÚû
);

158 
ocb_’üy±
(
ocb_¡©e
 *
ocb
, cÚ¡ *
±
, *
ù
);

159 
ocb_deüy±
(
ocb_¡©e
 *
ocb
, cÚ¡ *
ù
, *
±
);

161 
ocb_dÚe_’üy±
(
ocb_¡©e
 *
ocb
,

162 cÚ¡ *
±
, 
±Ën
,

163 *
ù
,

164 *
g
, *
gËn
);

166 
ocb_dÚe_deüy±
(
ocb_¡©e
 *
ocb
,

167 cÚ¡ *
ù
, 
ùËn
,

168 *
±
,

169 cÚ¡ *
g
, 
gËn
, *
¡©
);

171 
ocb_’üy±_auth’tiÿ‹_memÜy
(
ch”
,

172 cÚ¡ *
key
, 
keyËn
,

173 cÚ¡ *
nÚû
,

174 cÚ¡ *
±
, 
±Ën
,

175 *
ù
,

176 *
g
, *
gËn
);

178 
ocb_deüy±_v”ify_memÜy
(
ch”
,

179 cÚ¡ *
key
, 
keyËn
,

180 cÚ¡ *
nÚû
,

181 cÚ¡ *
ù
, 
ùËn
,

182 *
±
,

183 cÚ¡ *
g
, 
gËn
,

184 *
¡©
);

186 
ocb_‹¡
();

189 
ocb_shiá_xÜ
(
ocb_¡©e
 *
ocb
, *
Z
);

190 
ocb_Áz
(
x
);

191 
s_ocb_dÚe
(
ocb_¡©e
 *
ocb
, cÚ¡ *
±
, 
±Ën
,

192 *
ù
, *
g
, *
gËn
, 
mode
);

196 #ifdeà
CCM_MODE


198 
	#CCM_ENCRYPT
 0

	)

199 
	#CCM_DECRYPT
 1

	)

201 
ccm_memÜy
(
ch”
,

202 cÚ¡ *
key
, 
keyËn
,

203 
symm‘ric_key
 *
uskey
,

204 cÚ¡ *
nÚû
, 
nÚûËn
,

205 cÚ¡ *
h—d”
, 
h—d”Ën
,

206 *
±
, 
±Ën
,

207 *
ù
,

208 *
g
, *
gËn
,

209 
dœeùiÚ
);

211 
ccm_‹¡
();

215 #ià
defšed
(
LRW_MODE
è|| defšed(
GCM_MODE
)

216 
gcm_gf_muÉ
(cÚ¡ *
a
, cÚ¡ *
b
, *
c
);

221 #ià
defšed
(
GCM_TABLES
è|| defšed(
LRW_TABLES
è|| ((defšed(
GCM_MODE
è|| defšed(GCM_MODE)è&& defšed(
LTC_FAST
))

222 cÚ¡ 
gcm_shiá_bË
[];

225 #ifdeà
GCM_MODE


227 
	#GCM_ENCRYPT
 0

	)

228 
	#GCM_DECRYPT
 1

	)

230 
	#GCM_MODE_IV
 0

	)

231 
	#GCM_MODE_AAD
 1

	)

232 
	#GCM_MODE_TEXT
 2

	)

235 
symm‘ric_key
 
	mK
;

236 
	mH
[16],

237 
	mX
[16],

238 
	mY
[16],

239 
	mY_0
[16],

240 
	mbuf
[16];

242 
	mch”
,

243 
	mivmode
,

244 
	mmode
,

245 
	mbuæ’
;

247 
ulÚg64
 
	mtÙËn
,

248 
	m±tÙËn
;

250 #ifdeà
GCM_TABLES


251 
	mPC
[16][256][16]

252 #ifdeà
GCM_TABLES_SSE2


253 
__©Œibu‹__
 ((
®igÃd
 (16)))

257 } 
	tgcm_¡©e
;

259 
gcm_muÉ_h
(
gcm_¡©e
 *
gcm
, *
I
);

261 
gcm_š™
(
gcm_¡©e
 *
gcm
, 
ch”
,

262 cÚ¡ *
key
, 
keyËn
);

264 
gcm_»£t
(
gcm_¡©e
 *
gcm
);

266 
gcm_add_iv
(
gcm_¡©e
 *
gcm
,

267 cÚ¡ *
IV
, 
IVËn
);

269 
gcm_add_¯d
(
gcm_¡©e
 *
gcm
,

270 cÚ¡ *
ad©a
, 
ad©®’
);

272 
gcm_´oûss
(
gcm_¡©e
 *
gcm
,

273 *
±
, 
±Ën
,

274 *
ù
,

275 
dœeùiÚ
);

277 
gcm_dÚe
(
gcm_¡©e
 *
gcm
,

278 *
g
, *
gËn
);

280 
gcm_memÜy
Ğ
ch”
,

281 cÚ¡ *
key
, 
keyËn
,

282 cÚ¡ *
IV
, 
IVËn
,

283 cÚ¡ *
ad©a
, 
ad©®’
,

284 *
±
, 
±Ën
,

285 *
ù
,

286 *
g
, *
gËn
,

287 
dœeùiÚ
);

288 
gcm_‹¡
();

292 #ifdeà
PELICAN


294 
	s³liÿn_¡©e


296 
symm‘ric_key
 
	mK
;

297 
	m¡©e
[16];

298 
	mbuæ’
;

299 } 
	t³liÿn_¡©e
;

301 
³liÿn_š™
(
³liÿn_¡©e
 *
³lmac
, cÚ¡ *
key
, 
keyËn
);

302 
³liÿn_´oûss
(
³liÿn_¡©e
 *
³lmac
, cÚ¡ *
š
, 
šËn
);

303 
³liÿn_dÚe
(
³liÿn_¡©e
 *
³lmac
, *
out
);

304 
³liÿn_‹¡
();

306 
³liÿn_memÜy
(cÚ¡ *
key
, 
keyËn
,

307 cÚ¡ *
š
, 
šËn
,

308 *
out
);

312 #ifdeà
LTC_XCBC


315 
	mK
[3][
MAXBLOCKSIZE
],

316 
	mIV
[
MAXBLOCKSIZE
];

318 
symm‘ric_key
 
	mkey
;

320 
	mch”
,

321 
	mbuæ’
,

322 
	mblocksize
;

323 } 
	txcbc_¡©e
;

325 
xcbc_š™
(
xcbc_¡©e
 *
xcbc
, 
ch”
, cÚ¡ *
key
, 
keyËn
);

326 
xcbc_´oûss
(
xcbc_¡©e
 *
xcbc
, cÚ¡ *
š
, 
šËn
);

327 
xcbc_dÚe
(
xcbc_¡©e
 *
xcbc
, *
out
, *
ou’
);

328 
xcbc_memÜy
(
ch”
,

329 cÚ¡ *
key
, 
keyËn
,

330 cÚ¡ *
š
, 
šËn
,

331 *
out
, *
ou’
);

332 
xcbc_memÜy_muÉi
(
ch”
,

333 cÚ¡ *
key
, 
keyËn
,

334 *
out
, *
ou’
,

335 cÚ¡ *
š
, 
šËn
, ...);

336 
xcbc_fe
(
ch”
,

337 cÚ¡ *
key
, 
keyËn
,

338 cÚ¡ *
f’ame
,

339 *
out
, *
ou’
);

340 
xcbc_‹¡
();

344 #ifdeà
LTC_F9_MODE


347 
	makey
[
MAXBLOCKSIZE
],

348 
	mACC
[
MAXBLOCKSIZE
],

349 
	mIV
[
MAXBLOCKSIZE
];

351 
symm‘ric_key
 
	mkey
;

353 
	mch”
,

354 
	mbuæ’
,

355 
	mkeyËn
,

356 
	mblocksize
;

357 } 
	tf9_¡©e
;

359 
f9_š™
(
f9_¡©e
 *
f9
, 
ch”
, cÚ¡ *
key
, 
keyËn
);

360 
f9_´oûss
(
f9_¡©e
 *
f9
, cÚ¡ *
š
, 
šËn
);

361 
f9_dÚe
(
f9_¡©e
 *
f9
, *
out
, *
ou’
);

362 
f9_memÜy
(
ch”
,

363 cÚ¡ *
key
, 
keyËn
,

364 cÚ¡ *
š
, 
šËn
,

365 *
out
, *
ou’
);

366 
f9_memÜy_muÉi
(
ch”
,

367 cÚ¡ *
key
, 
keyËn
,

368 *
out
, *
ou’
,

369 cÚ¡ *
š
, 
šËn
, ...);

370 
f9_fe
(
ch”
,

371 cÚ¡ *
key
, 
keyËn
,

372 cÚ¡ *
f’ame
,

373 *
out
, *
ou’
);

374 
f9_‹¡
();

	@libtomcrypt/src/headers/tomcrypt_macros.h

2 #ifdeà
_MSC_VER


3 
	#CONST64
(
n
èÀ## 
ui64


	)

4 
	t__št64
 
	tulÚg64
;

6 
	#CONST64
(
n
èÀ## 
ULL


	)

7 
	tulÚg64
;

13 #ià
defšed
(
__x86_64__
è|| (defšed(
__¥¬c__
è&& defšed(
__¬ch64__
))

14 
	tulÚg32
;

16 
	tulÚg32
;

20 #ifdeà
ENDIAN_NEUTRAL


22 
	#STORE32L
(
x
, 
y
) \

23 { (
y
)[3] = ()(((
x
)>>24)&255); (y)[2] = ()(((x)>>16)&255); \

24 (
y
)[1] = ()(((
x
)>>8)&255); (y)[0] = ()((x)&255); }

	)

26 
	#LOAD32L
(
x
, 
y
) \

27 { 
x
 = (()((
y
)[3] & 255)<<24) | \

28 (()((
y
)[2] & 255)<<16) | \

29 (()((
y
)[1] & 255)<<8) | \

30 (()((
y
)[0] & 255)); }

	)

32 
	#STORE64L
(
x
, 
y
) \

33 { (
y
)[7] = ()(((
x
)>>56)&255); (y)[6] = ()(((x)>>48)&255); \

34 (
y
)[5] = ()(((
x
)>>40)&255); (y)[4] = ()(((x)>>32)&255); \

35 (
y
)[3] = ()(((
x
)>>24)&255); (y)[2] = ()(((x)>>16)&255); \

36 (
y
)[1] = ()(((
x
)>>8)&255); (y)[0] = ()((x)&255); }

	)

38 
	#LOAD64L
(
x
, 
y
) \

39 { 
x
 = (((
ulÚg64
)((
y
)[7] & 255))<<56)|(((ulong64)((y)[6] & 255))<<48)| \

40 (((
ulÚg64
)((
y
)[5] & 255))<<40)|(((ulong64)((y)[4] & 255))<<32)| \

41 (((
ulÚg64
)((
y
)[3] & 255))<<24)|(((ulong64)((y)[2] & 255))<<16)| \

42 (((
ulÚg64
)((
y
)[1] & 255))<<8)|(((ulÚg64)((y)[0] & 255))); }

	)

44 
	#STORE32H
(
x
, 
y
) \

45 { (
y
)[0] = ()(((
x
)>>24)&255); (y)[1] = ()(((x)>>16)&255); \

46 (
y
)[2] = ()(((
x
)>>8)&255); (y)[3] = ()((x)&255); }

	)

48 
	#LOAD32H
(
x
, 
y
) \

49 { 
x
 = (()((
y
)[0] & 255)<<24) | \

50 (()((
y
)[1] & 255)<<16) | \

51 (()((
y
)[2] & 255)<<8) | \

52 (()((
y
)[3] & 255)); }

	)

54 
	#STORE64H
(
x
, 
y
) \

55 { (
y
)[0] = ()(((
x
)>>56)&255); (y)[1] = ()(((x)>>48)&255); \

56 (
y
)[2] = ()(((
x
)>>40)&255); (y)[3] = ()(((x)>>32)&255); \

57 (
y
)[4] = ()(((
x
)>>24)&255); (y)[5] = ()(((x)>>16)&255); \

58 (
y
)[6] = ()(((
x
)>>8)&255); (y)[7] = ()((x)&255); }

	)

60 
	#LOAD64H
(
x
, 
y
) \

61 { 
x
 = (((
ulÚg64
)((
y
)[0] & 255))<<56)|(((ulong64)((y)[1] & 255))<<48) | \

62 (((
ulÚg64
)((
y
)[2] & 255))<<40)|(((ulong64)((y)[3] & 255))<<32) | \

63 (((
ulÚg64
)((
y
)[4] & 255))<<24)|(((ulong64)((y)[5] & 255))<<16) | \

64 (((
ulÚg64
)((
y
)[6] & 255))<<8)|(((ulÚg64)((y)[7] & 255))); }

	)

68 #ifdeà
ENDIAN_LITTLE


70 #ià!
defšed
(
LTC_NO_BSWAP
è&& (defšed(
INTEL_CC
è|| (defšed(
__GNUC__
è&& (defšed(
__DJGPP__
è|| defšed(
__CYGWIN__
è|| defšed(
__MINGW32__
è|| defšed(
__i386__
è|| defšed(
__x86_64__
))))

72 
	#STORE32H
(
x
, 
y
) \

73 
asm
 
	`__vŞ©e__
 ( \

77 ::"r"(
x
), "r"(
y
));

	)

79 
	#LOAD32H
(
x
, 
y
) \

80 
asm
 
	`__vŞ©e__
 ( \

83 :"ô"(
x
): "r"(
y
));

	)

87 
	#STORE32H
(
x
, 
y
) \

88 { (
y
)[0] = ()(((
x
)>>24)&255); (y)[1] = ()(((x)>>16)&255); \

89 (
y
)[2] = ()(((
x
)>>8)&255); (y)[3] = ()((x)&255); }

	)

91 
	#LOAD32H
(
x
, 
y
) \

92 { 
x
 = (()((
y
)[0] & 255)<<24) | \

93 (()((
y
)[1] & 255)<<16) | \

94 (()((
y
)[2] & 255)<<8) | \

95 (()((
y
)[3] & 255)); }

	)

101 #ià!
defšed
(
LTC_NO_BSWAP
è&& (defšed(
__GNUC__
è&& defšed(
__x86_64__
))

103 
	#STORE64H
(
x
, 
y
) \

104 
asm
 
	`__vŞ©e__
 ( \

108 ::"r"(
x
), "r"(
y
));

	)

110 
	#LOAD64H
(
x
, 
y
) \

111 
asm
 
	`__vŞ©e__
 ( \

114 :"ô"(
x
): "r"(
y
));

	)

118 
	#STORE64H
(
x
, 
y
) \

119 { (
y
)[0] = ()(((
x
)>>56)&255); (y)[1] = ()(((x)>>48)&255); \

120 (
y
)[2] = ()(((
x
)>>40)&255); (y)[3] = ()(((x)>>32)&255); \

121 (
y
)[4] = ()(((
x
)>>24)&255); (y)[5] = ()(((x)>>16)&255); \

122 (
y
)[6] = ()(((
x
)>>8)&255); (y)[7] = ()((x)&255); }

	)

124 
	#LOAD64H
(
x
, 
y
) \

125 { 
x
 = (((
ulÚg64
)((
y
)[0] & 255))<<56)|(((ulong64)((y)[1] & 255))<<48) | \

126 (((
ulÚg64
)((
y
)[2] & 255))<<40)|(((ulong64)((y)[3] & 255))<<32) | \

127 (((
ulÚg64
)((
y
)[4] & 255))<<24)|(((ulong64)((y)[5] & 255))<<16) | \

128 (((
ulÚg64
)((
y
)[6] & 255))<<8)|(((ulÚg64)((y)[7] & 255))); }

	)

132 #ifdeà
ENDIAN_32BITWORD


134 
	#STORE32L
(
x
, 
y
) \

135 { 
ulÚg32
 
__t
 = (
x
); 
	`XMEMCPY
(
y
, &__t, 4); }

	)

137 
	#LOAD32L
(
x
, 
y
) \

138 
	`XMEMCPY
(&(
x
), 
y
, 4);

	)

140 
	#STORE64L
(
x
, 
y
) \

141 { (
y
)[7] = ()(((
x
)>>56)&255); (y)[6] = ()(((x)>>48)&255); \

142 (
y
)[5] = ()(((
x
)>>40)&255); (y)[4] = ()(((x)>>32)&255); \

143 (
y
)[3] = ()(((
x
)>>24)&255); (y)[2] = ()(((x)>>16)&255); \

144 (
y
)[1] = ()(((
x
)>>8)&255); (y)[0] = ()((x)&255); }

	)

146 
	#LOAD64L
(
x
, 
y
) \

147 { 
x
 = (((
ulÚg64
)((
y
)[7] & 255))<<56)|(((ulong64)((y)[6] & 255))<<48)| \

148 (((
ulÚg64
)((
y
)[5] & 255))<<40)|(((ulong64)((y)[4] & 255))<<32)| \

149 (((
ulÚg64
)((
y
)[3] & 255))<<24)|(((ulong64)((y)[2] & 255))<<16)| \

150 (((
ulÚg64
)((
y
)[1] & 255))<<8)|(((ulÚg64)((y)[0] & 255))); }

	)

154 
	#STORE32L
(
x
, 
y
) \

155 { 
ulÚg32
 
__t
 = (
x
); 
	`XMEMCPY
(
y
, &__t, 4); }

	)

157 
	#LOAD32L
(
x
, 
y
) \

158 { 
	`XMEMCPY
(&(
x
), 
y
, 4); x &ğ0xFFFFFFFF; }

	)

160 
	#STORE64L
(
x
, 
y
) \

161 { 
ulÚg64
 
__t
 = (
x
); 
	`XMEMCPY
(
y
, &__t, 8); }

	)

163 
	#LOAD64L
(
x
, 
y
) \

164 { 
	`XMEMCPY
(&(
x
), 
y
, 8); }

	)

170 #ifdeà
ENDIAN_BIG


171 
	#STORE32L
(
x
, 
y
) \

172 { (
y
)[3] = ()(((
x
)>>24)&255); (y)[2] = ()(((x)>>16)&255); \

173 (
y
)[1] = ()(((
x
)>>8)&255); (y)[0] = ()((x)&255); }

	)

175 
	#LOAD32L
(
x
, 
y
) \

176 { 
x
 = (()((
y
)[3] & 255)<<24) | \

177 (()((
y
)[2] & 255)<<16) | \

178 (()((
y
)[1] & 255)<<8) | \

179 (()((
y
)[0] & 255)); }

	)

181 
	#STORE64L
(
x
, 
y
) \

182 { (
y
)[7] = ()(((
x
)>>56)&255); (y)[6] = ()(((x)>>48)&255); \

183 (
y
)[5] = ()(((
x
)>>40)&255); (y)[4] = ()(((x)>>32)&255); \

184 (
y
)[3] = ()(((
x
)>>24)&255); (y)[2] = ()(((x)>>16)&255); \

185 (
y
)[1] = ()(((
x
)>>8)&255); (y)[0] = ()((x)&255); }

	)

187 
	#LOAD64L
(
x
, 
y
) \

188 { 
x
 = (((
ulÚg64
)((
y
)[7] & 255))<<56)|(((ulong64)((y)[6] & 255))<<48) | \

189 (((
ulÚg64
)((
y
)[5] & 255))<<40)|(((ulong64)((y)[4] & 255))<<32) | \

190 (((
ulÚg64
)((
y
)[3] & 255))<<24)|(((ulong64)((y)[2] & 255))<<16) | \

191 (((
ulÚg64
)((
y
)[1] & 255))<<8)|(((ulÚg64)((y)[0] & 255))); }

	)

193 #ifdeà
ENDIAN_32BITWORD


195 
	#STORE32H
(
x
, 
y
) \

196 { 
ulÚg32
 
__t
 = (
x
); 
	`XMEMCPY
(
y
, &__t, 4); }

	)

198 
	#LOAD32H
(
x
, 
y
) \

199 
	`XMEMCPY
(&(
x
), 
y
, 4);

	)

201 
	#STORE64H
(
x
, 
y
) \

202 { (
y
)[0] = ()(((
x
)>>56)&255); (y)[1] = ()(((x)>>48)&255); \

203 (
y
)[2] = ()(((
x
)>>40)&255); (y)[3] = ()(((x)>>32)&255); \

204 (
y
)[4] = ()(((
x
)>>24)&255); (y)[5] = ()(((x)>>16)&255); \

205 (
y
)[6] = ()(((
x
)>>8)&255); (y)[7] = ()((x)&255); }

	)

207 
	#LOAD64H
(
x
, 
y
) \

208 { 
x
 = (((
ulÚg64
)((
y
)[0] & 255))<<56)|(((ulong64)((y)[1] & 255))<<48)| \

209 (((
ulÚg64
)((
y
)[2] & 255))<<40)|(((ulong64)((y)[3] & 255))<<32)| \

210 (((
ulÚg64
)((
y
)[4] & 255))<<24)|(((ulong64)((y)[5] & 255))<<16)| \

211 (((
ulÚg64
)((
y
)[6] & 255))<<8)| (((ulÚg64)((y)[7] & 255))); }

	)

215 
	#STORE32H
(
x
, 
y
) \

216 { 
ulÚg32
 
__t
 = (
x
); 
	`XMEMCPY
(
y
, &__t, 4); }

	)

218 
	#LOAD32H
(
x
, 
y
) \

219 { 
	`XMEMCPY
(&(
x
), 
y
, 4); x &ğ0xFFFFFFFF; }

	)

221 
	#STORE64H
(
x
, 
y
) \

222 { 
ulÚg64
 
__t
 = (
x
); 
	`XMEMCPY
(
y
, &__t, 8); }

	)

224 
	#LOAD64H
(
x
, 
y
) \

225 { 
	`XMEMCPY
(&(
x
), 
y
, 8); }

	)

230 
	#BSWAP
(
x
) ( ((x>>24)&0x000000FFUL) | ((x<<24)&0xFF000000UL) | \

231 ((
x
>>8)&0x0000FF00ULè| ((x<<8)&0x00FF0000ULè)

	)

235 #ià
defšed
(
_MSC_VER
)

238 
	~<¡dlib.h
>

239 #´agm¨
šŒšsic
(
_ÌÙr
,
_ÌÙl
)

240 
	#ROR
(
x
,
n
è
	`_ÌÙr
(x,n)

	)

241 
	#ROL
(
x
,
n
è
	`_ÌÙl
(x,n)

	)

242 
	#RORc
(
x
,
n
è
	`_ÌÙr
(x,n)

	)

243 
	#ROLc
(
x
,
n
è
	`_ÌÙl
(x,n)

	)

245 #–ià!
defšed
(
__STRICT_ANSI__
è&& defšed(
__GNUC__
è&& (defšed(
__i386__
è|| defšed(
__x86_64__
)è&& !defšed(
INTEL_CC
è&& !defšed(
LTC_NO_ASM
)

247 
šlše
 
	$ROL
(
wÜd
, 
i
)

249 
	`asm
 ("roll %%cl,%0"

250 :"ô" (
wÜd
)

251 :"0" (
wÜd
),"c" (
i
));

252  
wÜd
;

253 
	}
}

255 
šlše
 
	$ROR
(
wÜd
, 
i
)

257 
	`asm
 ("rorl %%cl,%0"

258 :"ô" (
wÜd
)

259 :"0" (
wÜd
),"c" (
i
));

260  
wÜd
;

261 
	}
}

263 #iâdeà
LTC_NO_ROLC


265 
šlše
 
	$ROLc
(
wÜd
, cÚ¡ 
i
)

267 
	`asm
 ("roll %2,%0"

268 :"ô" (
wÜd
)

269 :"0" (
wÜd
),"I" (
i
));

270  
wÜd
;

271 
	}
}

273 
šlše
 
	$RORc
(
wÜd
, cÚ¡ 
i
)

275 
	`asm
 ("rorl %2,%0"

276 :"ô" (
wÜd
)

277 :"0" (
wÜd
),"I" (
i
));

278  
wÜd
;

279 
	}
}

283 
	#ROLc
 
ROL


	)

284 
	#RORc
 
ROR


	)

288 #–ià!
defšed
(
__STRICT_ANSI__
è&& defšed(
LTC_PPC32
)

290 
šlše
 
	$ROL
(
wÜd
, 
i
)

292 
	`asm
 ("rotlw %0,%0,%2"

293 :"ô" (
wÜd
)

294 :"0" (
wÜd
),"r" (
i
));

295  
wÜd
;

296 
	}
}

298 
šlše
 
	$ROR
(
wÜd
, 
i
)

300 
	`asm
 ("rotlw %0,%0,%2"

301 :"ô" (
wÜd
)

302 :"0" (
wÜd
),"r" (32-
i
));

303  
wÜd
;

304 
	}
}

306 #iâdeà
LTC_NO_ROLC


308 
šlše
 
	$ROLc
(
wÜd
, cÚ¡ 
i
)

310 
	`asm
 ("rotlwi %0,%0,%2"

311 :"ô" (
wÜd
)

312 :"0" (
wÜd
),"I" (
i
));

313  
wÜd
;

314 
	}
}

316 
šlše
 
	$RORc
(
wÜd
, cÚ¡ 
i
)

318 
	`asm
 ("rotrwi %0,%0,%2"

319 :"ô" (
wÜd
)

320 :"0" (
wÜd
),"I" (
i
));

321  
wÜd
;

322 
	}
}

326 
	#ROLc
 
ROL


	)

327 
	#RORc
 
ROR


	)

335 
	#ROL
(
x
, 
y
èĞ((()(x)<<()((y)&31)è| ((()(x)&0xFFFFFFFFUL)>>()(32-((y)&31)))è& 0xFFFFFFFFUL)

	)

336 
	#ROR
(
x
, 
y
èĞ(((()(x)&0xFFFFFFFFUL)>>()((y)&31)è| (()(x)<<()(32-((y)&31)))è& 0xFFFFFFFFUL)

	)

337 
	#ROLc
(
x
, 
y
èĞ((()(x)<<()((y)&31)è| ((()(x)&0xFFFFFFFFUL)>>()(32-((y)&31)))è& 0xFFFFFFFFUL)

	)

338 
	#RORc
(
x
, 
y
èĞ(((()(x)&0xFFFFFFFFUL)>>()((y)&31)è| (()(x)<<()(32-((y)&31)))è& 0xFFFFFFFFUL)

	)

344 #ià!
defšed
(
__STRICT_ANSI__
è&& defšed(
__GNUC__
è&& defšed(
__x86_64__
è&& !defšed(
LTC_NO_ASM
)

346 
šlše
 
	$ROL64
(
wÜd
, 
i
)

348 
	`asm
("rolq %%cl,%0"

349 :"ô" (
wÜd
)

350 :"0" (
wÜd
),"c" (
i
));

351  
wÜd
;

352 
	}
}

354 
šlše
 
	$ROR64
(
wÜd
, 
i
)

356 
	`asm
("rorq %%cl,%0"

357 :"ô" (
wÜd
)

358 :"0" (
wÜd
),"c" (
i
));

359  
wÜd
;

360 
	}
}

362 #iâdeà
LTC_NO_ROLC


364 
šlše
 
	$ROL64c
(
wÜd
, cÚ¡ 
i
)

366 
	`asm
("rolq %2,%0"

367 :"ô" (
wÜd
)

368 :"0" (
wÜd
),"J" (
i
));

369  
wÜd
;

370 
	}
}

372 
šlše
 
	$ROR64c
(
wÜd
, cÚ¡ 
i
)

374 
	`asm
("rorq %2,%0"

375 :"ô" (
wÜd
)

376 :"0" (
wÜd
),"J" (
i
));

377  
wÜd
;

378 
	}
}

382 
	#ROL64c
 
ROL64


	)

383 
	#ROR64c
 
ROR64


	)

389 
	#ROL64
(
x
, 
y
) \

390 Ğ(((
x
)<<((
ulÚg64
)(
y
)&63)) | \

391 (((
x
)&
	`CONST64
(0xFFFFFFFFFFFFFFFF))>>((
ulÚg64
)64-((
y
)&63)))è& CONST64(0xFFFFFFFFFFFFFFFF))

	)

393 
	#ROR64
(
x
, 
y
) \

394 Ğ((((
x
)&
	`CONST64
(0xFFFFFFFFFFFFFFFF))>>((
ulÚg64
)(
y
)&CONST64(63))) | \

395 ((
x
)<<((
ulÚg64
)(64-((
y
)&
	`CONST64
(63)))))è& CONST64(0xFFFFFFFFFFFFFFFF))

	)

397 
	#ROL64c
(
x
, 
y
) \

398 Ğ(((
x
)<<((
ulÚg64
)(
y
)&63)) | \

399 (((
x
)&
	`CONST64
(0xFFFFFFFFFFFFFFFF))>>((
ulÚg64
)64-((
y
)&63)))è& CONST64(0xFFFFFFFFFFFFFFFF))

	)

401 
	#ROR64c
(
x
, 
y
) \

402 Ğ((((
x
)&
	`CONST64
(0xFFFFFFFFFFFFFFFF))>>((
ulÚg64
)(
y
)&CONST64(63))) | \

403 ((
x
)<<((
ulÚg64
)(64-((
y
)&
	`CONST64
(63)))))è& CONST64(0xFFFFFFFFFFFFFFFF))

	)

407 #iâdeà
MAX


408 
	#MAX
(
x
, 
y
èĞ((x)>(y))?(x):(yè)

	)

411 #iâdeà
MIN


412 
	#MIN
(
x
, 
y
èĞ((x)<(y))?(x):(yè)

	)

416 #ifdeà
_MSC_VER


417 
	#by‹
(
x
, 
n
è(()((xè>> (8 * (n))))

	)

419 
	#by‹
(
x
, 
n
è(((xè>> (8 * (n))è& 255)

	)

	@libtomcrypt/src/headers/tomcrypt_math.h

3 
	#LTC_MP_LT
 -1

	)

4 
	#LTC_MP_EQ
 0

	)

5 
	#LTC_MP_GT
 1

	)

7 
	#LTC_MP_NO
 0

	)

8 
	#LTC_MP_YES
 1

	)

10 #iâdeà
MECC


11 
	tecc_pošt
;

16 #iâdeà
MRSA


17 
	tr§_key
;

24 *
	mÇme
;

27 
	mb™s_³r_dig™
;

35 (*
	mš™
)(**
	ma
);

42 (*
	mš™_cİy
)(**
	md¡
, *
	m¤c
);

48 (*
	mdeš™
)(*
	ma
);

57 (*
	mÃg
)(*
	m¤c
, *
	md¡
);

64 (*
	mcİy
)(*
	m¤c
, *
	md¡
);

73 (*
	m£t_št
)(*
	ma
, 
	mn
);

79 (*
	mg‘_št
)(*
	ma
);

86 (*
	mg‘_dig™
)(*
	ma
, 
	mn
);

92 (*
	mg‘_dig™_couÁ
)(*
	ma
);

99 (*
	mcom·»
)(*
	ma
, *
	mb
);

106 (*
	mcom·»_d
)(*
	ma
, 
	mn
);

112 (*
	mcouÁ_b™s
)(* 
	ma
);

118 (*
	mcouÁ_lsb_b™s
)(*
	ma
);

125 (*
	mtwÛx±
)(*
	ma
 , 
	mn
);

135 (*
	m»ad_¿dix
)(*
	ma
, cÚ¡ *
	m¡r
, 
	m¿dix
);

143 (*
	mwr™e_¿dix
)(*
	ma
, *
	m¡r
, 
	m¿dix
);

149 (*
	munsigÃd_size
)(*
	ma
);

156 (*
	munsigÃd_wr™e
)(*
	m¤c
, *
	md¡
);

164 (*
	munsigÃd_»ad
)(*
	md¡
, *
	m¤c
, 
	mËn
);

174 (*
	madd
)(*
	ma
, *
	mb
, *
	mc
);

183 (*
	maddi
)(*
	ma
, 
	mb
, *
	mc
);

191 (*
	msub
)(*
	ma
, *
	mb
, *
	mc
);

199 (*
	msubi
)(*
	ma
, 
	mb
, *
	mc
);

207 (*
	mmul
)(*
	ma
, *
	mb
, *
	mc
);

215 (*
	mmuli
)(*
	ma
, 
	mb
, *
	mc
);

222 (*
	msqr
)(*
	ma
, *
	mb
);

231 (*
	mmpdiv
)(*
	ma
, *
	mb
, *
	mc
, *
	md
);

238 (*
	mdiv_2
)(*
	ma
, *
	mb
);

246 (*
	mmodi
)(*
	ma
, 
	mb
, *
	mc
);

254 (*
	mgcd
)(*
	ma
, *
	mb
, *
	mc
);

262 (*
	mlcm
)(*
	ma
, *
	mb
, *
	mc
);

271 (*
	mmulmod
)(*
	ma
, *
	mb
, *
	mc
, *
	md
);

279 (*
	msqrmod
)(*
	ma
, *
	mb
, *
	mc
);

287 (*
	mšvmod
)(*, *, *);

296 (*
	mmÚtgom”y_£tup
)(*
	ma
, **
	mb
);

303 (*
	mmÚtgom”y_nÜm®iz©iÚ
)(*
	ma
, *
	mb
);

311 (*
	mmÚtgom”y_»duû
)(*
	ma
, *
	mb
, *
	mc
);

317 (*
	mmÚtgom”y_deš™
)(*
	ma
);

328 (*
	mex±mod
)(*
	ma
, *
	mb
, *
	mc
, *
	md
);

335 (*
	mi¥rime
)(*
	ma
, *
	mb
);

347 (*
	mecc_±mul
)(*
	mk
, 
ecc_pošt
 *
	mG
,ƒcc_pošˆ*
	mR
, *
	mmodulus
, 
	mm­
);

357 (*
	mecc_±add
)(
ecc_pošt
 *
	mP
,ƒcc_pošˆ*
	mQ
,ƒcc_pošˆ*
	mR
, *
	mmodulus
, *
	mmp
);

366 (*
	mecc_±dbl
)(
ecc_pošt
 *
	mP
,ƒcc_pošˆ*
	mR
, *
	mmodulus
, *
	mmp
);

376 (*
	mecc_m­
)(
ecc_pošt
 *
	mP
, *
	mmodulus
, *
	mmp
);

387 (*
	mecc_mul2add
)(
ecc_pošt
 *
	mA
, *
	mkA
,

388 
ecc_pošt
 *
	mB
, *
	mkB
,

389 
ecc_pošt
 *
	mC
,

390 *
	mmodulus
);

404 (*
	mr§_keyg’
)(
´ng_¡©e
 *
	m´ng
, 
	mw´ng
, 
	msize
, 
	me
, 
r§_key
 *
	mkey
);

416 (*
	mr§_me
)(cÚ¡ *
	mš
, 
	mšËn
,

417 *
	mout
, *
	mou’
, 
	mwhich
,

418 
r§_key
 *
	mkey
);

420 } 
	tÉc_m©h_desütÜ
;

422 
Éc_m©h_desütÜ
 
Éc_mp
;

424 
Éc_š™_muÉi
(**
a
, ...);

425 
Éc_deš™_muÉi
(*
a
, ...);

427 #ifdeà
LTM_DESC


428 cÚ¡ 
Éc_m©h_desütÜ
 
Ém_desc
;

431 #ifdeà
TFM_DESC


432 cÚ¡ 
Éc_m©h_desütÜ
 
tfm_desc
;

435 #ifdeà
GMP_DESC


436 cÚ¡ 
Éc_m©h_desütÜ
 
gmp_desc
;

439 #ià!
defšed
(
DESC_DEF_ONLY
è&& defšed(
LTC_SOURCE
)

441 
	#MP_DIGIT_BIT
 
Éc_mp
.
b™s_³r_dig™


	)

444 
	#mp_š™
(
a
è
Éc_mp
.
	`š™
×)

	)

445 
	#mp_š™_muÉi
 
Éc_š™_muÉi


	)

446 
	#mp_ş—r
(
a
è
Éc_mp
.
	`deš™
×)

	)

447 
	#mp_ş—r_muÉi
 
Éc_deš™_muÉi


	)

448 
	#mp_š™_cİy
(
a
, 
b
è
Éc_mp
.
	`š™_cİy
×, b)

	)

450 
	#mp_Ãg
(
a
, 
b
è
Éc_mp
.
	`Ãg
×, b)

	)

451 
	#mp_cİy
(
a
, 
b
è
Éc_mp
.
	`cİy
×, b)

	)

453 
	#mp_£t
(
a
, 
b
è
Éc_mp
.
	`£t_št
×, b)

	)

454 
	#mp_£t_št
(
a
, 
b
è
Éc_mp
.
	`£t_št
×, b)

	)

455 
	#mp_g‘_št
(
a
è
Éc_mp
.
	`g‘_št
×)

	)

456 
	#mp_g‘_dig™
(
a
, 
n
è
Éc_mp
.
	`g‘_dig™
×,‚)

	)

457 
	#mp_g‘_dig™_couÁ
(
a
è
Éc_mp
.
	`g‘_dig™_couÁ
×)

	)

458 
	#mp_cmp
(
a
, 
b
è
Éc_mp
.
	`com·»
×, b)

	)

459 
	#mp_cmp_d
(
a
, 
b
è
Éc_mp
.
	`com·»_d
×, b)

	)

460 
	#mp_couÁ_b™s
(
a
è
Éc_mp
.
	`couÁ_b™s
×)

	)

461 
	#mp_út_lsb
(
a
è
Éc_mp
.
	`couÁ_lsb_b™s
×)

	)

462 
	#mp_2ex±
(
a
, 
b
è
Éc_mp
.
	`twÛx±
×, b)

	)

464 
	#mp_»ad_¿dix
(
a
, 
b
, 
c
è
Éc_mp
.
	`»ad_¿dix
×, b, c)

	)

465 
	#mp_tÜadix
(
a
, 
b
, 
c
è
Éc_mp
.
	`wr™e_¿dix
×, b, c)

	)

466 
	#mp_unsigÃd_bš_size
(
a
è
Éc_mp
.
	`unsigÃd_size
×)

	)

467 
	#mp_to_unsigÃd_bš
(
a
, 
b
è
Éc_mp
.
	`unsigÃd_wr™e
×, b)

	)

468 
	#mp_»ad_unsigÃd_bš
(
a
, 
b
, 
c
è
Éc_mp
.
	`unsigÃd_»ad
×, b, c)

	)

470 
	#mp_add
(
a
, 
b
, 
c
è
Éc_mp
.
	`add
×, b, c)

	)

471 
	#mp_add_d
(
a
, 
b
, 
c
è
Éc_mp
.
	`addi
×, b, c)

	)

472 
	#mp_sub
(
a
, 
b
, 
c
è
Éc_mp
.
	`sub
×, b, c)

	)

473 
	#mp_sub_d
(
a
, 
b
, 
c
è
Éc_mp
.
	`subi
×, b, c)

	)

474 
	#mp_mul
(
a
, 
b
, 
c
è
Éc_mp
.
	`mul
×, b, c)

	)

475 
	#mp_mul_d
(
a
, 
b
, 
c
è
Éc_mp
.
	`muli
×, b, c)

	)

476 
	#mp_sqr
(
a
, 
b
è
Éc_mp
.
	`sqr
×, b)

	)

477 
	#mp_div
(
a
, 
b
, 
c
, 
d
è
Éc_mp
.
	`mpdiv
×, b, c, d)

	)

478 
	#mp_div_2
(
a
, 
b
è
Éc_mp
.
	`div_2
×, b)

	)

479 
	#mp_mod
(
a
, 
b
, 
c
è
Éc_mp
.
	`mpdiv
×, b, 
NULL
, c)

	)

480 
	#mp_mod_d
(
a
, 
b
, 
c
è
Éc_mp
.
	`modi
×, b, c)

	)

481 
	#mp_gcd
(
a
, 
b
, 
c
è
Éc_mp
.
	`gcd
×, b, c)

	)

482 
	#mp_lcm
(
a
, 
b
, 
c
è
Éc_mp
.
	`lcm
×, b, c)

	)

484 
	#mp_mulmod
(
a
, 
b
, 
c
, 
d
è
Éc_mp
.
	`mulmod
×, b, c, d)

	)

485 
	#mp_sqrmod
(
a
, 
b
, 
c
è
Éc_mp
.
	`sqrmod
×, b, c)

	)

486 
	#mp_švmod
(
a
, 
b
, 
c
è
Éc_mp
.
	`švmod
×, b, c)

	)

488 
	#mp_mÚtgom”y_£tup
(
a
, 
b
è
Éc_mp
.
	`mÚtgom”y_£tup
×, b)

	)

489 
	#mp_mÚtgom”y_nÜm®iz©iÚ
(
a
, 
b
è
Éc_mp
.
	`mÚtgom”y_nÜm®iz©iÚ
×, b)

	)

490 
	#mp_mÚtgom”y_»duû
(
a
, 
b
, 
c
è
Éc_mp
.
	`mÚtgom”y_»duû
×, b, c)

	)

491 
	#mp_mÚtgom”y_ä“
(
a
è
Éc_mp
.
	`mÚtgom”y_deš™
×)

	)

493 
	#mp_ex±mod
(
a
,
b
,
c
,
d
è
Éc_mp
.
	`ex±mod
×,b,c,d)

	)

494 
	#mp_´ime_is_´ime
(
a
, 
b
, 
c
è
Éc_mp
.
	`i¥rime
×, c)

	)

496 
	#mp_isz”o
(
a
è(
	`mp_cmp_d
×, 0è=ğ
LTC_MP_EQ
 ? 
LTC_MP_YES
 : 
LTC_MP_NO
)

	)

497 
	#mp_isodd
(
a
è(
	`mp_g‘_dig™_couÁ
×è> 0 ? (
	`mp_g‘_dig™
×, 0è& 1 ? 
LTC_MP_YES
 : 
LTC_MP_NO
è: LTC_MP_NO)

	)

498 
	#mp_exch
(
a
, 
b
èdØ{ *
ABC__tmp
 =‡;‡ = b; b = ABC__tmp; } 0);

	)

500 
	#mp_tohex
(
a
, 
b
è
	`mp_tÜadix
×, b, 16)

	)

	@libtomcrypt/src/headers/tomcrypt_misc.h

2 #ifdeà
BASE64


3 
ba£64_’code
(cÚ¡ *
š
, 
Ën
,

4 *
out
, *
ou’
);

6 
ba£64_decode
(cÚ¡ *
š
, 
Ën
,

7 *
out
, *
ou’
);

11 
z”omem
(*
d¡
, 
size_t
 
Ën
);

12 
buº_¡ack
(
Ën
);

14 cÚ¡ *
”rÜ_to_¡ršg
(
”r
);

16 cÚ¡ *
üy±_bud_£‰šgs
;

19 
üy±_f§
(*
mp
, ...);

	@libtomcrypt/src/headers/tomcrypt_pk.h

4 
	mPK_PUBLIC
=0,

5 
	mPK_PRIVATE
=1

8 
¿nd_´ime
(*
N
, 
Ën
, 
´ng_¡©e
 *
´ng
, 
w´ng
);

11 #ifdeà
MRSA


14 
	#MIN_RSA_SIZE
 1024

	)

15 
	#MAX_RSA_SIZE
 4096

	)

18 
	sR§_key
 {

20 
	mty³
;

22 *
	me
;

24 *
	md
;

26 *
	mN
;

28 *
	mp
;

30 *
	mq
;

32 *
	mqP
;

34 *
	mdP
;

36 *
	mdQ
;

37 } 
	tr§_key
;

39 
r§_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
size
, 
e
, 
r§_key
 *
key
);

41 
r§_ex±mod
(cÚ¡ *
š
, 
šËn
,

42 *
out
, *
ou’
, 
which
,

43 
r§_key
 *
key
);

45 
r§_ä“
(
r§_key
 *
key
);

48 
	#r§_’üy±_key
(
_š
, 
_šËn
, 
_out
, 
_ou’
, 
_Í¬am
, 
_Í¬amËn
, 
_´ng
, 
_´ng_idx
, 
_hash_idx
, 
_key
) \

49 
	`r§_’üy±_key_ex
(
_š
, 
_šËn
, 
_out
, 
_ou’
, 
_Í¬am
, 
_Í¬amËn
, 
_´ng
, 
_´ng_idx
, 
_hash_idx
, 
LTC_PKCS_1_OAEP
, 
_key
)

	)

51 
	#r§_deüy±_key
(
_š
, 
_šËn
, 
_out
, 
_ou’
, 
_Í¬am
, 
_Í¬amËn
, 
_hash_idx
, 
_¡©
, 
_key
) \

52 
	`r§_deüy±_key_ex
(
_š
, 
_šËn
, 
_out
, 
_ou’
, 
_Í¬am
, 
_Í¬amËn
, 
_hash_idx
, 
LTC_PKCS_1_OAEP
, 
_¡©
, 
_key
)

	)

54 
	#r§_sign_hash
(
_š
, 
_šËn
, 
_out
, 
_ou’
, 
_´ng
, 
_´ng_idx
, 
_hash_idx
, 
_§ÉËn
, 
_key
) \

55 
	`r§_sign_hash_ex
(
_š
, 
_šËn
, 
_out
, 
_ou’
, 
LTC_PKCS_1_PSS
, 
_´ng
, 
_´ng_idx
, 
_hash_idx
, 
_§ÉËn
, 
_key
)

	)

57 
	#r§_v”ify_hash
(
_sig
, 
_sigËn
, 
_hash
, 
_hashËn
, 
_hash_idx
, 
_§ÉËn
, 
_¡©
, 
_key
) \

58 
	`r§_v”ify_hash_ex
(
_sig
, 
_sigËn
, 
_hash
, 
_hashËn
, 
LTC_PKCS_1_PSS
, 
_hash_idx
, 
_§ÉËn
, 
_¡©
, 
_key
)

	)

61 
r§_’üy±_key_ex
(cÚ¡ *
š
, 
šËn
,

62 *
out
, *
ou’
,

63 cÚ¡ *
Í¬am
, 
Í¬amËn
,

64 
´ng_¡©e
 *
´ng
, 
´ng_idx
, 
hash_idx
, 
·ddšg
, 
r§_key
 *
key
);

66 
r§_deüy±_key_ex
(cÚ¡ *
š
, 
šËn
,

67 *
out
, *
ou’
,

68 cÚ¡ *
Í¬am
, 
Í¬amËn
,

69 
hash_idx
, 
·ddšg
,

70 *
¡©
, 
r§_key
 *
key
);

72 
r§_sign_hash_ex
(cÚ¡ *
š
, 
šËn
,

73 *
out
, *
ou’
,

74 
·ddšg
,

75 
´ng_¡©e
 *
´ng
, 
´ng_idx
,

76 
hash_idx
, 
§ÉËn
,

77 
r§_key
 *
key
);

79 
r§_v”ify_hash_ex
(cÚ¡ *
sig
, 
sigËn
,

80 cÚ¡ *
hash
, 
hashËn
,

81 
·ddšg
,

82 
hash_idx
, 
§ÉËn
,

83 *
¡©
, 
r§_key
 *
key
);

86 
r§_expÜt
(*
out
, *
ou’
, 
ty³
, 
r§_key
 *
key
);

87 
r§_impÜt
(cÚ¡ *
š
, 
šËn
, 
r§_key
 *
key
);

92 #ifdeà
MKAT


95 
	#MIN_KAT_SIZE
 1024

	)

96 
	#MAX_KAT_SIZE
 4096

	)

99 
	sKAT_key
 {

101 
	mty³
;

103 *
	md
;

105 *
	mN
;

107 *
	mp
;

109 *
	mq
;

111 *
	mqP
;

113 *
	mdP
;

115 *
	mdQ
;

117 *
	mpq
;

118 } 
	tk©ja_key
;

120 
k©ja_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
size
, 
k©ja_key
 *
key
);

122 
k©ja_ex±mod
(cÚ¡ *
š
, 
šËn
,

123 *
out
, *
ou’
, 
which
,

124 
k©ja_key
 *
key
);

126 
k©ja_ä“
(
k©ja_key
 *
key
);

129 
k©ja_’üy±_key
(cÚ¡ *
š
, 
šËn
,

130 *
out
, *
ou’
,

131 cÚ¡ *
Í¬am
, 
Í¬amËn
,

132 
´ng_¡©e
 *
´ng
, 
´ng_idx
, 
hash_idx
, 
k©ja_key
 *
key
);

134 
k©ja_deüy±_key
(cÚ¡ *
š
, 
šËn
,

135 *
out
, *
ou’
,

136 cÚ¡ *
Í¬am
, 
Í¬amËn
,

137 
hash_idx
, *
¡©
,

138 
k©ja_key
 *
key
);

141 
k©ja_expÜt
(*
out
, *
ou’
, 
ty³
, 
k©ja_key
 *
key
);

142 
k©ja_impÜt
(cÚ¡ *
š
, 
šËn
, 
k©ja_key
 *
key
);

147 #ifdeà
MECC


150 
	#ECC_BUF_SIZE
 256

	)

153 
	#ECC_MAXSIZE
 66

	)

158 
	msize
;

161 *
	mÇme
;

164 *
	m´ime
;

167 *
	mB
;

170 *
	mÜd”
;

173 *
	mGx
;

176 *
	mGy
;

177 } 
	tÉc_ecc_£t_ty³
;

182 *
	mx
;

185 *
	my
;

188 *
	mz
;

189 } 
	tecc_pošt
;

194 
	mty³
;

197 
	midx
;

200 cÚ¡ 
Éc_ecc_£t_ty³
 *
	mdp
;

203 
ecc_pošt
 
	mpubkey
;

206 *
	mk
;

207 } 
	tecc_key
;

210 cÚ¡ 
Éc_ecc_£t_ty³
 
Éc_ecc_£ts
[];

212 
ecc_‹¡
();

213 
ecc_sizes
(*
low
, *
high
);

214 
ecc_g‘_size
(
ecc_key
 *
key
);

216 
ecc_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
keysize
, 
ecc_key
 *
key
);

217 
ecc_make_key_ex
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
ecc_key
 *
key
, cÚ¡ 
Éc_ecc_£t_ty³
 *
dp
);

218 
ecc_ä“
(
ecc_key
 *
key
);

220 
ecc_expÜt
(*
out
, *
ou’
, 
ty³
, 
ecc_key
 *
key
);

221 
ecc_impÜt
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
);

222 
ecc_impÜt_ex
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
, cÚ¡ 
Éc_ecc_£t_ty³
 *
dp
);

224 
ecc_ªsi_x963_expÜt
(
ecc_key
 *
key
, *
out
, *
ou’
);

225 
ecc_ªsi_x963_impÜt
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
);

226 
ecc_ªsi_x963_impÜt_ex
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
, 
Éc_ecc_£t_ty³
 *
dp
);

228 
ecc_sh¬ed_£ü‘
(
ecc_key
 *
´iv©e_key
,ƒcc_key *
public_key
,

229 *
out
, *
ou’
);

231 
ecc_’üy±_key
(cÚ¡ *
š
, 
šËn
,

232 *
out
, *
ou’
,

233 
´ng_¡©e
 *
´ng
, 
w´ng
, 
hash
,

234 
ecc_key
 *
key
);

236 
ecc_deüy±_key
(cÚ¡ *
š
, 
šËn
,

237 *
out
, *
ou’
,

238 
ecc_key
 *
key
);

240 
ecc_sign_hash
(cÚ¡ *
š
, 
šËn
,

241 *
out
, *
ou’
,

242 
´ng_¡©e
 *
´ng
, 
w´ng
, 
ecc_key
 *
key
);

244 
ecc_v”ify_hash
(cÚ¡ *
sig
, 
sigËn
,

245 cÚ¡ *
hash
, 
hashËn
,

246 *
¡©
, 
ecc_key
 *
key
);

249 
ecc_pošt
 *
Éc_ecc_Ãw_pošt
();

250 
Éc_ecc_d–_pošt
(
ecc_pošt
 *
p
);

251 
Éc_ecc_is_v®id_idx
(
n
);

254 #ià!
defšed
(
MECC_ACCEL
è|| defšed(
LTM_DESC
è|| defšed(
GMP_DESC
)

256 
Éc_ecc_´ojeùive_dbl_pošt
(
ecc_pošt
 *
P
,ƒcc_pošˆ*
R
, *
modulus
, *
mp
);

259 
Éc_ecc_´ojeùive_add_pošt
(
ecc_pošt
 *
P
,ƒcc_pošˆ*
Q
,ƒcc_pošˆ*
R
, *
modulus
, *
mp
);

262 #ià
defšed
(
MECC_FP
)

263 
Éc_ecc_å_mulmod
(*
k
, 
ecc_pošt
 *
G
,ƒcc_pošˆ*
R
, *
modulus
, 
m­
);

264 
Éc_ecc_å_§ve_¡©e
(**
out
, *
ou’
);

265 
Éc_ecc_å_»¡Üe_¡©e
(*
š
, 
šËn
);

266 
Éc_ecc_å_ä“
();

270 
Éc_ecc_mulmod
(*
k
, 
ecc_pošt
 *
G
,ƒcc_pošˆ*
R
, *
modulus
, 
m­
);

272 #ifdeà
LTC_ECC_SHAMIR


274 
Éc_ecc_mul2add
(
ecc_pošt
 *
A
, *
kA
,

275 
ecc_pošt
 *
B
, *
kB
,

276 
ecc_pošt
 *
C
,

277 *
modulus
);

279 #ifdeà
MECC_FP


280 
Éc_ecc_å_mul2add
(
ecc_pošt
 *
A
, *
kA
,

281 
ecc_pošt
 *
B
, *
kB
,

282 
ecc_pošt
 *
C
, *
modulus
);

289 
Éc_ecc_m­
(
ecc_pošt
 *
P
, *
modulus
, *
mp
);

293 #ifdeà
MDSA


296 
	#MDSA_DELTA
 512

	)

299 
	#MDSA_MAX_GROUP
 512

	)

304 
	mty³
;

307 
	mqÜd
;

310 *
	mg
;

313 *
	mq
;

316 *
	mp
;

319 *
	mx
;

322 *
	my
;

323 } 
	td§_key
;

325 
d§_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
group_size
, 
modulus_size
, 
d§_key
 *
key
);

326 
d§_ä“
(
d§_key
 *
key
);

328 
d§_sign_hash_¿w
(cÚ¡ *
š
, 
šËn
,

329 *
r
, *
s
,

330 
´ng_¡©e
 *
´ng
, 
w´ng
, 
d§_key
 *
key
);

332 
d§_sign_hash
(cÚ¡ *
š
, 
šËn
,

333 *
out
, *
ou’
,

334 
´ng_¡©e
 *
´ng
, 
w´ng
, 
d§_key
 *
key
);

336 
d§_v”ify_hash_¿w
Ğ*
r
, *
s
,

337 cÚ¡ *
hash
, 
hashËn
,

338 *
¡©
, 
d§_key
 *
key
);

340 
d§_v”ify_hash
(cÚ¡ *
sig
, 
sigËn
,

341 cÚ¡ *
hash
, 
hashËn
,

342 *
¡©
, 
d§_key
 *
key
);

344 
d§_’üy±_key
(cÚ¡ *
š
, 
šËn
,

345 *
out
, *
ou’
,

346 
´ng_¡©e
 *
´ng
, 
w´ng
, 
hash
,

347 
d§_key
 *
key
);

349 
d§_deüy±_key
(cÚ¡ *
š
, 
šËn
,

350 *
out
, *
ou’
,

351 
d§_key
 *
key
);

353 
d§_impÜt
(cÚ¡ *
š
, 
šËn
, 
d§_key
 *
key
);

354 
d§_expÜt
(*
out
, *
ou’
, 
ty³
, 
d§_key
 *
key
);

355 
d§_v”ify_key
(
d§_key
 *
key
, *
¡©
);

357 
d§_sh¬ed_£ü‘
(*
´iv©e_key
, *
ba£
,

358 
d§_key
 *
public_key
,

359 *
out
, *
ou’
);

362 #ifdeà
LTC_DER


366 
	mLTC_ASN1_EOL
,

367 
	mLTC_ASN1_BOOLEAN
,

368 
	mLTC_ASN1_INTEGER
,

369 
	mLTC_ASN1_SHORT_INTEGER
,

370 
	mLTC_ASN1_BIT_STRING
,

371 
	mLTC_ASN1_OCTET_STRING
,

372 
	mLTC_ASN1_NULL
,

373 
	mLTC_ASN1_OBJECT_IDENTIFIER
,

374 
	mLTC_ASN1_IA5_STRING
,

375 
	mLTC_ASN1_PRINTABLE_STRING
,

376 
	mLTC_ASN1_UTF8_STRING
,

377 
	mLTC_ASN1_UTCTIME
,

378 
	mLTC_ASN1_CHOICE
,

379 
	mLTC_ASN1_SEQUENCE
,

380 
	mLTC_ASN1_SET
,

381 
	mLTC_ASN1_SETOF


385 
	sÉc_a¢1_li¡_
 {

387 
	mty³
;

389 *
	md©a
;

391 
	msize
;

393 
	mu£d
;

395 
Éc_a¢1_li¡_
 *
	m´ev
, *
	mÃxt
, *
	mchd
, *
	m·»Á
;

396 } 
	tÉc_a¢1_li¡
;

398 
	#LTC_SET_ASN1
(
li¡
, 
šdex
, 
Ty³
, 
D©a
, 
Size
) \

400 
LTC_MACRO_‹mp
 = (
šdex
); \

401 
Éc_a¢1_li¡
 *
LTC_MACRO_li¡
 = (
li¡
); \

402 
LTC_MACRO_li¡
[
LTC_MACRO_‹mp
].
ty³
 = (
Ty³
); \

403 
LTC_MACRO_li¡
[
LTC_MACRO_‹mp
].
d©a
 = (*)(
D©a
); \

404 
LTC_MACRO_li¡
[
LTC_MACRO_‹mp
].
size
 = (
Size
); \

405 
LTC_MACRO_li¡
[
LTC_MACRO_‹mp
].
u£d
 = 0; \

406 } 0);

	)

409 
d”_’code_£qu’û_ex
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

410 *
out
, *
ou’
, 
ty³_of
);

412 
	#d”_’code_£qu’û
(
li¡
, 
šËn
, 
out
, 
ou’
è
	`d”_’code_£qu’û_ex
Öi¡, iÆ’, out, ou’, 
LTC_ASN1_SEQUENCE
)

	)

414 
d”_decode_£qu’û_ex
(cÚ¡ *
š
, 
šËn
,

415 
Éc_a¢1_li¡
 *
li¡
, 
ou’
, 
Üd”ed
);

417 
	#d”_decode_£qu’û
(
š
, 
šËn
, 
li¡
, 
ou’
è
	`d”_decode_£qu’û_ex
(š, iÆ’,†i¡, ou’, 1)

	)

419 
d”_Ëngth_£qu’û
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

420 *
ou’
);

423 
	#d”_decode_£t
(
š
, 
šËn
, 
li¡
, 
ou’
è
	`d”_decode_£qu’û_ex
(š, iÆ’,†i¡, ou’, 0)

	)

424 
	#d”_Ëngth_£t
 
d”_Ëngth_£qu’û


	)

425 
d”_’code_£t
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

426 *
out
, *
ou’
);

428 
d”_’code_£tof
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

429 *
out
, *
ou’
);

432 
d”_’code_£qu’û_muÉi
(*
out
, *
ou’
, ...);

433 
d”_decode_£qu’û_muÉi
(cÚ¡ *
š
, 
šËn
, ...);

436 
d”_decode_£qu’û_æexi
(cÚ¡ *
š
, *
šËn
, 
Éc_a¢1_li¡
 **
out
);

437 
d”_ä“_£qu’û_æexi
(
Éc_a¢1_li¡
 *
li¡
);

438 
d”_£qu’û_ä“
(
Éc_a¢1_li¡
 *
š
);

441 
d”_Ëngth_boŞ—n
(*
ou’
);

442 
d”_’code_boŞ—n
(
š
,

443 *
out
, *
ou’
);

444 
d”_decode_boŞ—n
(cÚ¡ *
š
, 
šËn
,

445 *
out
);

447 
d”_’code_š‹g”
(*
num
, *
out
, *
ou’
);

448 
d”_decode_š‹g”
(cÚ¡ *
š
, 
šËn
, *
num
);

449 
d”_Ëngth_š‹g”
(*
num
, *
Ën
);

452 
d”_decode_shÜt_š‹g”
(cÚ¡ *
š
, 
šËn
, *
num
);

453 
d”_’code_shÜt_š‹g”
(
num
, *
out
, *
ou’
);

454 
d”_Ëngth_shÜt_š‹g”
(
num
, *
ou’
);

457 
d”_’code_b™_¡ršg
(cÚ¡ *
š
, 
šËn
,

458 *
out
, *
ou’
);

459 
d”_decode_b™_¡ršg
(cÚ¡ *
š
, 
šËn
,

460 *
out
, *
ou’
);

461 
d”_Ëngth_b™_¡ršg
(
nb™s
, *
ou’
);

464 
d”_’code_où‘_¡ršg
(cÚ¡ *
š
, 
šËn
,

465 *
out
, *
ou’
);

466 
d”_decode_où‘_¡ršg
(cÚ¡ *
š
, 
šËn
,

467 *
out
, *
ou’
);

468 
d”_Ëngth_où‘_¡ršg
(
noù‘s
, *
ou’
);

471 
d”_’code_objeù_id’tif›r
(*
wÜds
, 
nwÜds
,

472 *
out
, *
ou’
);

473 
d”_decode_objeù_id’tif›r
(cÚ¡ *
š
, 
šËn
,

474 *
wÜds
, *
ou’
);

475 
d”_Ëngth_objeù_id’tif›r
(*
wÜds
, 
nwÜds
, *
ou’
);

476 
d”_objeù_id’tif›r_b™s
(
x
);

479 
d”_’code_Ÿ5_¡ršg
(cÚ¡ *
š
, 
šËn
,

480 *
out
, *
ou’
);

481 
d”_decode_Ÿ5_¡ršg
(cÚ¡ *
š
, 
šËn
,

482 *
out
, *
ou’
);

483 
d”_Ëngth_Ÿ5_¡ršg
(cÚ¡ *
où‘s
, 
noù‘s
, *
ou’
);

485 
d”_Ÿ5_ch¬_’code
(
c
);

486 
d”_Ÿ5_v®ue_decode
(
v
);

489 
d”_’code_´šbË_¡ršg
(cÚ¡ *
š
, 
šËn
,

490 *
out
, *
ou’
);

491 
d”_decode_´šbË_¡ršg
(cÚ¡ *
š
, 
šËn
,

492 *
out
, *
ou’
);

493 
d”_Ëngth_´šbË_¡ršg
(cÚ¡ *
où‘s
, 
noù‘s
, *
ou’
);

495 
d”_´šbË_ch¬_’code
(
c
);

496 
d”_´šbË_v®ue_decode
(
v
);

499 #ià(
defšed
(
SIZE_MAX
è|| 
__STDC_VERSION__
 >ğ199901L || defšed(
WCHAR_MAX
è|| defšed(
_WCHAR_T
è|| defšed(
_WCHAR_T_DEFINED
)è&& !defšed(
LTC_NO_WCHAR
)

500 
	~<wch¬.h
>

502 
ulÚg32
 
	twch¬_t
;

505 
d”_’code_utf8_¡ršg
(cÚ¡ 
wch¬_t
 *
š
, 
šËn
,

506 *
out
, *
ou’
);

508 
d”_decode_utf8_¡ršg
(cÚ¡ *
š
, 
šËn
,

509 
wch¬_t
 *
out
, *
ou’
);

510 
d”_utf8_ch¬size
(cÚ¡ 
wch¬_t
 
c
);

511 
d”_Ëngth_utf8_¡ršg
(cÚ¡ 
wch¬_t
 *
š
, 
noù‘s
, *
ou’
);

515 
d”_decode_choiû
(cÚ¡ *
š
, *
šËn
,

516 
Éc_a¢1_li¡
 *
li¡
, 
ou’
);

520 
	mYY
,

521 
	mMM
,

522 
	mDD
,

523 
	mhh
,

524 
	mmm
,

525 
	mss
,

526 
	moff_dœ
,

527 
	moff_hh
,

528 
	moff_mm
;

529 } 
	tÉc_utùime
;

531 
d”_’code_utùime
(
Éc_utùime
 *
utùime
,

532 *
out
, *
ou’
);

534 
d”_decode_utùime
(cÚ¡ *
š
, *
šËn
,

535 
Éc_utùime
 *
out
);

537 
d”_Ëngth_utùime
(
Éc_utùime
 *
utùime
, *
ou’
);

	@libtomcrypt/src/headers/tomcrypt_pkcs.h

4 #ifdeà
PKCS_1


6 
	eÉc_pkcs_1_v1_5_blocks


8 
	mLTC_PKCS_1_EMSA
 = 1,

9 
	mLTC_PKCS_1_EME
 = 2

12 
	eÉc_pkcs_1_·ddšgs


14 
	mLTC_PKCS_1_V1_5
 = 1,

15 
	mLTC_PKCS_1_OAEP
 = 2,

16 
	mLTC_PKCS_1_PSS
 = 3

19 
pkcs_1_mgf1
Ğ
hash_idx
,

20 cÚ¡ *
£ed
, 
£edËn
,

21 *
mask
, 
maskËn
);

23 
pkcs_1_i2o¥
(*
n
, 
modulus_Ën
, *
out
);

24 
pkcs_1_os2
(*
n
, *
š
, 
šËn
);

27 
pkcs_1_v1_5_’code
(cÚ¡ *
msg
,

28 
msgËn
,

29 
block_ty³
,

30 
modulus_b™Ën
,

31 
´ng_¡©e
 *
´ng
,

32 
´ng_idx
,

33 *
out
,

34 *
ou’
);

36 
pkcs_1_v1_5_decode
(cÚ¡ *
msg
,

37 
msgËn
,

38 
block_ty³
,

39 
modulus_b™Ën
,

40 *
out
,

41 *
ou’
,

42 *
is_v®id
);

45 
pkcs_1_ß•_’code
(cÚ¡ *
msg
, 
msgËn
,

46 cÚ¡ *
Í¬am
, 
Í¬amËn
,

47 
modulus_b™Ën
, 
´ng_¡©e
 *
´ng
,

48 
´ng_idx
, 
hash_idx
,

49 *
out
, *
ou’
);

51 
pkcs_1_ß•_decode
(cÚ¡ *
msg
, 
msgËn
,

52 cÚ¡ *
Í¬am
, 
Í¬amËn
,

53 
modulus_b™Ën
, 
hash_idx
,

54 *
out
, *
ou’
,

55 *
»s
);

57 
pkcs_1_pss_’code
(cÚ¡ *
msghash
, 
msghashËn
,

58 
§ÉËn
, 
´ng_¡©e
 *
´ng
,

59 
´ng_idx
, 
hash_idx
,

60 
modulus_b™Ën
,

61 *
out
, *
ou’
);

63 
pkcs_1_pss_decode
(cÚ¡ *
msghash
, 
msghashËn
,

64 cÚ¡ *
sig
, 
sigËn
,

65 
§ÉËn
, 
hash_idx
,

66 
modulus_b™Ën
, *
»s
);

71 #ifdeà
PKCS_5


74 
pkcs_5_®g1
(cÚ¡ *
·sswÜd
, 
·sswÜd_Ën
,

75 cÚ¡ *
§É
,

76 
™”©iÚ_couÁ
, 
hash_idx
,

77 *
out
, *
ou’
);

80 
pkcs_5_®g2
(cÚ¡ *
·sswÜd
, 
·sswÜd_Ën
,

81 cÚ¡ *
§É
, 
§É_Ën
,

82 
™”©iÚ_couÁ
, 
hash_idx
,

83 *
out
, *
ou’
);

	@libtomcrypt/src/headers/tomcrypt_prng.h

2 #ifdeà
YARROW


3 
	sy¬row_´ng
 {

4 
	mch”
, 
	mhash
;

5 
	mpoŞ
[
MAXBLOCKSIZE
];

6 
symm‘ric_CTR
 
	mùr
;

7 
LTC_MUTEX_TYPE
(
´ng_lock
)

11 #ifdeà
RC4


12 
	src4_´ng
 {

13 
	mx
, 
	my
;

14 
	mbuf
[256];

18 #ifdeà
FORTUNA


19 
	sfÜtuÇ_´ng
 {

20 
hash_¡©e
 
	mpoŞ
[
FORTUNA_POOLS
];

22 
symm‘ric_key
 
	mskey
;

24 
	mK
[32],

25 
	mIV
[16];

27 
	mpoŞ_idx
,

28 
	mpoŞ0_Ën
,

29 
	mwd
;

31 
ulÚg64
 
	m»£t_út
;

32 
LTC_MUTEX_TYPE
(
´ng_lock
)

36 #ifdeà
SOBER128


37 
	ssob”128_´ng
 {

38 
ulÚg32
 
	mR
[17],

39 
	mš™R
[17],

40 
	mkÚ¡
,

41 
	msbuf
;

43 
	mnbuf
,

44 
	mæag
,

45 
	m£t
;

50 
	uPºg_¡©e
 {

51 
	mdummy
[1];

52 #ifdeà
YARROW


53 
y¬row_´ng
 
	my¬row
;

55 #ifdeà
RC4


56 
rc4_´ng
 
	mrc4
;

58 #ifdeà
FORTUNA


59 
fÜtuÇ_´ng
 
	mfÜtuÇ
;

61 #ifdeà
SOBER128


62 
sob”128_´ng
 
	msob”128
;

64 } 
	t´ng_¡©e
;

67 
	sÉc_´ng_desütÜ
 {

69 *
Çme
;

71 
expÜt_size
;

76 (*
¡¬t
)(
´ng_¡©e
 *
´ng
);

83 (*
add_’Œİy
)(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

88 (*
»ady
)(
´ng_¡©e
 *
´ng
);

95 (*
»ad
)(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
);

100 (*
dÚe
)(
´ng_¡©e
 *
´ng
);

107 (*
³xpÜt
)(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
);

114 (*
pimpÜt
)(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

118 (*
‹¡
)();

119 } 
´ng_desütÜ
[];

121 #ifdeà
YARROW


122 
y¬row_¡¬t
(
´ng_¡©e
 *
´ng
);

123 
y¬row_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

124 
y¬row_»ady
(
´ng_¡©e
 *
´ng
);

125 
y¬row_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
);

126 
y¬row_dÚe
(
´ng_¡©e
 *
´ng
);

127 
y¬row_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
);

128 
y¬row_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

129 
y¬row_‹¡
();

130 cÚ¡ 
Éc_´ng_desütÜ
 
y¬row_desc
;

133 #ifdeà
FORTUNA


134 
fÜtuÇ_¡¬t
(
´ng_¡©e
 *
´ng
);

135 
fÜtuÇ_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

136 
fÜtuÇ_»ady
(
´ng_¡©e
 *
´ng
);

137 
fÜtuÇ_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
);

138 
fÜtuÇ_dÚe
(
´ng_¡©e
 *
´ng
);

139 
fÜtuÇ_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
);

140 
fÜtuÇ_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

141 
fÜtuÇ_‹¡
();

142 cÚ¡ 
Éc_´ng_desütÜ
 
fÜtuÇ_desc
;

145 #ifdeà
RC4


146 
rc4_¡¬t
(
´ng_¡©e
 *
´ng
);

147 
rc4_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

148 
rc4_»ady
(
´ng_¡©e
 *
´ng
);

149 
rc4_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
);

150 
rc4_dÚe
(
´ng_¡©e
 *
´ng
);

151 
rc4_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
);

152 
rc4_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

153 
rc4_‹¡
();

154 cÚ¡ 
Éc_´ng_desütÜ
 
rc4_desc
;

157 #ifdeà
SPRNG


158 
¥ºg_¡¬t
(
´ng_¡©e
 *
´ng
);

159 
¥ºg_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

160 
¥ºg_»ady
(
´ng_¡©e
 *
´ng
);

161 
¥ºg_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
);

162 
¥ºg_dÚe
(
´ng_¡©e
 *
´ng
);

163 
¥ºg_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
);

164 
¥ºg_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

165 
¥ºg_‹¡
();

166 cÚ¡ 
Éc_´ng_desütÜ
 
¥ºg_desc
;

169 #ifdeà
SOBER128


170 
sob”128_¡¬t
(
´ng_¡©e
 *
´ng
);

171 
sob”128_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

172 
sob”128_»ady
(
´ng_¡©e
 *
´ng
);

173 
sob”128_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
);

174 
sob”128_dÚe
(
´ng_¡©e
 *
´ng
);

175 
sob”128_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
);

176 
sob”128_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
);

177 
sob”128_‹¡
();

178 cÚ¡ 
Éc_´ng_desütÜ
 
sob”128_desc
;

181 
fšd_´ng
(cÚ¡ *
Çme
);

182 
»gi¡”_´ng
(cÚ¡ 
Éc_´ng_desütÜ
 *
´ng
);

183 
uÄegi¡”_´ng
(cÚ¡ 
Éc_´ng_desütÜ
 *
´ng
);

184 
´ng_is_v®id
(
idx
);

185 
	$LTC_MUTEX_PROTO
(
Éc_´ng_mu‹x
)

190 
	`ºg_g‘_by‹s
(*
out
,

191 
ou’
,

192 (*
ÿÎback
)());

194 
	`ºg_make_´ng
(
b™s
, 
w´ng
, 
´ng_¡©e
 *
´ng
, (*
ÿÎback
)());

	@libtomcrypt/src/mac/f9/f9_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F9_MODE


26 
	$f9_dÚe
(
f9_¡©e
 *
f9
, *
out
, *
ou’
)

28 
”r
, 
x
;

29 
	`LTC_ARGCHK
(
f9
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

33 ià((
”r
 = 
	`ch”_is_v®id
(
f9
->
ch”
)è!ğ
CRYPT_OK
) {

34  
”r
;

37 ià((
f9
->
blocksize
 > 
ch”_desütÜ
[f9->
ch”
].
block_Ëngth
) || (f9->blocksize < 0) ||

38 (
f9
->
buæ’
 > f9->
blocksize
) || (f9->buflen < 0)) {

39  
CRYPT_INVALID_ARG
;

42 ià(
f9
->
buæ’
 != 0) {

44 
ch”_desütÜ
[
f9
->
ch”
].
	`ecb_’üy±
(f9->
IV
, f9->IV, &f9->
key
);

45 
f9
->
buæ’
 = 0;

46 
x
 = 0; x < 
f9
->
blocksize
; x++) {

47 
f9
->
ACC
[
x
] ^ğf9->
IV
[x];

52 ià((
”r
 = 
ch”_desütÜ
[
f9
->
ch”
].
	`£tup
(f9->
akey
, f9->
keyËn
, 0, &f9->
key
)è!ğ
CRYPT_OK
) {

53  
”r
;

57 
ch”_desütÜ
[
f9
->
ch”
].
	`ecb_’üy±
(f9->
ACC
, f9->ACC, &f9->
key
);

58 
ch”_desütÜ
[
f9
->
ch”
].
	`dÚe
(&f9->
key
);

61 
x
 = 0; x < 
f9
->
blocksize
 && ()x < *
ou’
; x++) {

62 
out
[
x
] = 
f9
->
ACC
[x];

64 *
ou’
 = 
x
;

66 #ifdeà
LTC_CLEAN_STACK


67 
	`z”omem
(
f9
, (*f9));

69  
CRYPT_OK
;

70 
	}
}

	@libtomcrypt/src/mac/f9/f9_file.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F9_MODE


30 
	$f9_fe
(
ch”
,

31 cÚ¡ *
key
, 
keyËn
,

32 cÚ¡ *
f’ame
,

33 *
out
, *
ou’
)

35 #ifdeà
LTC_NO_FILE


36  
CRYPT_NOP
;

38 
”r
, 
x
;

39 
f9_¡©e
 
f9
;

40 
FILE
 *
š
;

41 
buf
[512];

43 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
f’ame
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 
š
 = 
	`fİ’
(
f’ame
, "rb");

49 ià(
š
 =ğ
NULL
) {

50  
CRYPT_FILE_NOTFOUND
;

53 ià((
”r
 = 
	`f9_š™
(&
f9
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

54 
	`fşo£
(
š
);

55  
”r
;

59 
x
 = 
	`ä—d
(
buf
, 1, (buf), 
š
);

60 ià((
”r
 = 
	`f9_´oûss
(&
f9
, 
buf
, 
x
)è!ğ
CRYPT_OK
) {

61 
	`fşo£
(
š
);

62  
”r
;

64 } 
x
 =ğ(
buf
));

65 
	`fşo£
(
š
);

67 ià((
”r
 = 
	`f9_dÚe
(&
f9
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

68  
”r
;

71 #ifdeà
LTC_CLEAN_STACK


72 
	`z”omem
(
buf
, (buf));

75  
CRYPT_OK
;

77 
	}
}

	@libtomcrypt/src/mac/f9/f9_init.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F9_MODE


27 
	$f9_š™
(
f9_¡©e
 *
f9
, 
ch”
, cÚ¡ *
key
, 
keyËn
)

29 
x
, 
”r
;

31 
	`LTC_ARGCHK
(
f9
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

36  
”r
;

39 #ifdeà
LTC_FAST


40 ià(
ch”_desütÜ
[
ch”
].
block_Ëngth
 % (
LTC_FAST_TYPE
)) {

41  
CRYPT_INVALID_ARG
;

45 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 0, &
f9
->key)è!ğ
CRYPT_OK
) {

46 
dÚe
;

50 
x
 = 0; ()x < 
keyËn
; x++) {

51 
f9
->
akey
[
x
] = 
key
[x] ^ 0xAA;

55 
	`z”omem
(
f9
->
IV
, 
ch”_desütÜ
[
ch”
].
block_Ëngth
);

56 
	`z”omem
(
f9
->
ACC
, 
ch”_desütÜ
[
ch”
].
block_Ëngth
);

57 
f9
->
blocksize
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

58 
f9
->
ch”
 = cipher;

59 
f9
->
buæ’
 = 0;

60 
f9
->
keyËn
 = keylen;

61 
dÚe
:

62  
”r
;

63 
	}
}

	@libtomcrypt/src/mac/f9/f9_memory.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F9_MODE


30 
	$f9_memÜy
(
ch”
,

31 cÚ¡ *
key
, 
keyËn
,

32 cÚ¡ *
š
, 
šËn
,

33 *
out
, *
ou’
)

35 
f9_¡©e
 *
f9
;

36 
”r
;

39 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

40  
”r
;

44 ià(
ch”_desütÜ
[
ch”
].
f9_memÜy
 !ğ
NULL
) {

45  
ch”_desütÜ
[
ch”
].
	`f9_memÜy
(
key
, 
keyËn
, 
š
, 
šËn
, 
out
, 
ou’
);

48 
f9
 = 
	`XCALLOC
(1, (*f9));

49 ià(
f9
 =ğ
NULL
) {

50  
CRYPT_MEM
;

53 ià((
”r
 = 
	`f9_š™
(
f9
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

54 
dÚe
;

57 ià((
”r
 = 
	`f9_´oûss
(
f9
, 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

58 
dÚe
;

61 
”r
 = 
	`f9_dÚe
(
f9
, 
out
, 
ou’
);

62 
dÚe
:

63 
	`XFREE
(
f9
);

64  
”r
;

65 
	}
}

	@libtomcrypt/src/mac/f9/f9_memory_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

19 #ifdeà
LTC_F9_MODE


33 
	$f9_memÜy_muÉi
(
ch”
,

34 cÚ¡ *
key
, 
keyËn
,

35 *
out
, *
ou’
,

36 cÚ¡ *
š
, 
šËn
, ...)

38 
”r
;

39 
f9_¡©e
 *
f9
;

40 
va_li¡
 
¬gs
;

41 cÚ¡ *
cu½Œ
;

42 
cu¾’
;

44 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

50 
f9
 = 
	`XMALLOC
((
f9_¡©e
));

51 ià(
f9
 =ğ
NULL
) {

52  
CRYPT_MEM
;

56 ià((
”r
 = 
	`f9_š™
(
f9
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

57 
LBL_ERR
;

59 
	`va_¡¬t
(
¬gs
, 
šËn
);

60 
cu½Œ
 = 
š
;

61 
cu¾’
 = 
šËn
;

64 ià((
”r
 = 
	`f9_´oûss
(
f9
, 
cu½Œ
, 
cu¾’
)è!ğ
CRYPT_OK
) {

65 
LBL_ERR
;

68 
cu½Œ
 = 
	`va_¬g
(
¬gs
, const *);

69 ià(
cu½Œ
 =ğ
NULL
) {

72 
cu¾’
 = 
	`va_¬g
(
¬gs
, );

74 ià((
”r
 = 
	`f9_dÚe
(
f9
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

75 
LBL_ERR
;

77 
LBL_ERR
:

78 #ifdeà
LTC_CLEAN_STACK


79 
	`z”omem
(
f9
, (
f9_¡©e
));

81 
	`XFREE
(
f9
);

82 
	`va_’d
(
¬gs
);

83  
”r
;

84 
	}
}

	@libtomcrypt/src/mac/f9/f9_process.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F9_MODE


26 
	$f9_´oûss
(
f9_¡©e
 *
f9
, cÚ¡ *
š
, 
šËn
)

28 
”r
, 
x
;

30 
	`LTC_ARGCHK
(
f9
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

34 ià((
”r
 = 
	`ch”_is_v®id
(
f9
->
ch”
)è!ğ
CRYPT_OK
) {

35  
”r
;

38 ià((
f9
->
blocksize
 > 
ch”_desütÜ
[f9->
ch”
].
block_Ëngth
) || (f9->blocksize < 0) ||

39 (
f9
->
buæ’
 > f9->
blocksize
) || (f9->buflen < 0)) {

40  
CRYPT_INVALID_ARG
;

43 #ifdeà
LTC_FAST


44 ià(
f9
->
buæ’
 == 0) {

45 
šËn
 >ğ()
f9
->
blocksize
) {

46 
x
 = 0; x < 
f9
->
blocksize
; x +ğ(
LTC_FAST_TYPE
)) {

47 *((
LTC_FAST_TYPE
*)&(
f9
->
IV
[
x
])è^ğ*((LTC_FAST_TYPE*)&(
š
[x]));

49 
ch”_desütÜ
[
f9
->
ch”
].
	`ecb_’üy±
(f9->
IV
, f9->IV, &f9->
key
);

50 
x
 = 0; x < 
f9
->
blocksize
; x +ğ(
LTC_FAST_TYPE
)) {

51 *((
LTC_FAST_TYPE
*)&(
f9
->
ACC
[
x
])è^ğ*((LTC_FAST_TYPE*)&(f9->
IV
[x]));

53 
š
 +ğ
f9
->
blocksize
;

54 
šËn
 -ğ
f9
->
blocksize
;

59 
šËn
) {

60 ià(
f9
->
buæ’
 =ğf9->
blocksize
) {

61 
ch”_desütÜ
[
f9
->
ch”
].
	`ecb_’üy±
(f9->
IV
, f9->IV, &f9->
key
);

62 
x
 = 0; x < 
f9
->
blocksize
; x++) {

63 
f9
->
ACC
[
x
] ^ğf9->
IV
[x];

65 
f9
->
buæ’
 = 0;

67 
f9
->
IV
[f9->
buæ’
++] ^ğ*
š
++;

68 --
šËn
;

70  
CRYPT_OK
;

71 
	}
}

	@libtomcrypt/src/mac/f9/f9_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F9_MODE


23 
	$f9_‹¡
()

25 #ifdeà
LTC_NO_TEST


26  
CRYPT_NOP
;

29 
msgËn
;

30 
K
[16], 
M
[128], 
T
[4];

31 } 
‹¡s
[] = {

50 
T
[16];

51 
gËn
;

52 
”r
, 
x
, 
idx
;

55 ià((
idx
 = 
	`fšd_ch”
("kasumi")) == -1) {

56  
CRYPT_NOP
;

59 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

60 
gËn
 = 4;

61 ià((
”r
 = 
	`f9_memÜy
(
idx
, 
‹¡s
[
x
].
K
, 16,e¡s[x].
M
,e¡s[x].
msgËn
, 
T
, &
gËn
)è!ğ
CRYPT_OK
) {

62  
”r
;

64 ià(
gËn
 !ğ4 || 
	`XMEMCMP
(
T
, 
‹¡s
[
x
].T, 4)) {

65  
CRYPT_FAIL_TESTVECTOR
;

69  
CRYPT_OK
;

71 
	}
}

	@libtomcrypt/src/mac/hmac/hmac_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_HMAC


20 
	#HMAC_BLOCKSIZE
 
hash_desütÜ
[
hash
].
blocksize


	)

29 
	$hmac_dÚe
(
hmac_¡©e
 *
hmac
, *
out
, *
ou’
)

31 *
buf
, *
isha
;

32 
hashsize
, 
i
;

33 
hash
, 
”r
;

35 
	`LTC_ARGCHK
(
hmac
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

39 
hash
 = 
hmac
->hash;

40 if((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

41  
”r
;

45 
hashsize
 = 
hash_desütÜ
[
hash
].hashsize;

48 
buf
 = 
	`XMALLOC
(
HMAC_BLOCKSIZE
);

49 
isha
 = 
	`XMALLOC
(
hashsize
);

50 ià(
buf
 =ğ
NULL
 || 
isha
 == NULL) {

51 ià(
buf
 !ğ
NULL
) {

52 
	`XFREE
(
buf
);

54 ià(
isha
 !ğ
NULL
) {

55 
	`XFREE
(
isha
);

57  
CRYPT_MEM
;

61 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`dÚe
(&
hmac
->
md
, 
isha
)è!ğ
CRYPT_OK
) {

62 
LBL_ERR
;

66 
i
=0; i < 
HMAC_BLOCKSIZE
; i++) {

67 
buf
[
i
] = 
hmac
->
key
[i] ^ 0x5C;

71 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`š™
(&
hmac
->
md
)è!ğ
CRYPT_OK
) {

72 
LBL_ERR
;

74 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`´oûss
(&
hmac
->
md
, 
buf
, 
HMAC_BLOCKSIZE
)è!ğ
CRYPT_OK
) {

75 
LBL_ERR
;

77 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`´oûss
(&
hmac
->
md
, 
isha
, 
hashsize
)è!ğ
CRYPT_OK
) {

78 
LBL_ERR
;

80 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`dÚe
(&
hmac
->
md
, 
buf
)è!ğ
CRYPT_OK
) {

81 
LBL_ERR
;

85 
i
 = 0; i < 
hashsize
 && i < *
ou’
; i++) {

86 
out
[
i
] = 
buf
[i];

88 *
ou’
 = 
i
;

90 
”r
 = 
CRYPT_OK
;

91 
LBL_ERR
:

92 
	`XFREE
(
hmac
->
key
);

93 #ifdeà
LTC_CLEAN_STACK


94 
	`z”omem
(
isha
, 
hashsize
);

95 
	`z”omem
(
buf
, 
hashsize
);

96 
	`z”omem
(
hmac
, (*hmac));

99 
	`XFREE
(
isha
);

100 
	`XFREE
(
buf
);

102  
”r
;

103 
	}
}

	@libtomcrypt/src/mac/hmac/hmac_file.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_HMAC


30 
	$hmac_fe
(
hash
, cÚ¡ *
âame
,

31 cÚ¡ *
key
, 
keyËn
,

32 *
out
, *
ou’
)

34 #ifdeà
LTC_NO_FILE


35  
CRYPT_NOP
;

37 
hmac_¡©e
 
hmac
;

38 
FILE
 *
š
;

39 
buf
[512];

40 
size_t
 
x
;

41 
”r
;

43 
	`LTC_ARGCHK
(
âame
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 if((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

49  
”r
;

52 ià((
”r
 = 
	`hmac_š™
(&
hmac
, 
hash
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

53  
”r
;

56 
š
 = 
	`fİ’
(
âame
, "rb");

57 ià(
š
 =ğ
NULL
) {

58  
CRYPT_FILE_NOTFOUND
;

63 
x
 = 
	`ä—d
(
buf
, 1, (buf), 
š
);

64 ià((
”r
 = 
	`hmac_´oûss
(&
hmac
, 
buf
, ()
x
)è!ğ
CRYPT_OK
) {

66 
	`fşo£
(
š
);

67  
”r
;

69 } 
x
 =ğ(
buf
));

71 ià(
	`fşo£
(
š
) != 0) {

72  
CRYPT_ERROR
;

76 ià((
”r
 = 
	`hmac_dÚe
(&
hmac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

77  
”r
;

80 #ifdeà
LTC_CLEAN_STACK


82 
	`z”omem
(
buf
, (buf));

84  
CRYPT_OK
;

86 
	}
}

	@libtomcrypt/src/mac/hmac/hmac_init.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_HMAC


20 
	#HMAC_BLOCKSIZE
 
hash_desütÜ
[
hash
].
blocksize


	)

30 
	$hmac_š™
(
hmac_¡©e
 *
hmac
, 
hash
, cÚ¡ *
key
, 
keyËn
)

32 *
buf
;

33 
hashsize
;

34 
i
, 
z
;

35 
”r
;

37 
	`LTC_ARGCHK
(
hmac
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

41 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

42  
”r
;

44 
hmac
->
hash
 = hash;

45 
hashsize
 = 
hash_desütÜ
[
hash
].hashsize;

48 ià(
keyËn
 == 0) {

49  
CRYPT_INVALID_KEYSIZE
;

53 
buf
 = 
	`XMALLOC
(
HMAC_BLOCKSIZE
);

54 ià(
buf
 =ğ
NULL
) {

55  
CRYPT_MEM
;

59 
hmac
->
key
 = 
	`XMALLOC
(
HMAC_BLOCKSIZE
);

60 ià(
hmac
->
key
 =ğ
NULL
) {

61 
	`XFREE
(
buf
);

62  
CRYPT_MEM
;

66 if(
keyËn
 > 
HMAC_BLOCKSIZE
) {

67 
z
 = 
HMAC_BLOCKSIZE
;

68 ià((
”r
 = 
	`hash_memÜy
(
hash
, 
key
, 
keyËn
, 
hmac
->key, &
z
)è!ğ
CRYPT_OK
) {

69 
LBL_ERR
;

71 if(
hashsize
 < 
HMAC_BLOCKSIZE
) {

72 
	`z”omem
((
hmac
->
key
è+ 
hashsize
, (
size_t
)(
HMAC_BLOCKSIZE
 - hashsize));

74 
keyËn
 = 
hashsize
;

76 
	`XMEMCPY
(
hmac
->
key
, key, (
size_t
)
keyËn
);

77 if(
keyËn
 < 
HMAC_BLOCKSIZE
) {

78 
	`z”omem
((
hmac
->
key
è+ 
keyËn
, (
size_t
)(
HMAC_BLOCKSIZE
 - keylen));

83 
i
=0; i < 
HMAC_BLOCKSIZE
; i++) {

84 
buf
[
i
] = 
hmac
->
key
[i] ^ 0x36;

88 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`š™
(&
hmac
->
md
)è!ğ
CRYPT_OK
) {

89 
LBL_ERR
;

92 ià((
”r
 = 
hash_desütÜ
[
hash
].
	`´oûss
(&
hmac
->
md
, 
buf
, 
HMAC_BLOCKSIZE
)è!ğ
CRYPT_OK
) {

93 
LBL_ERR
;

95 
dÚe
;

96 
LBL_ERR
:

98 
	`XFREE
(
hmac
->
key
);

99 
dÚe
:

100 #ifdeà
LTC_CLEAN_STACK


101 
	`z”omem
(
buf
, 
HMAC_BLOCKSIZE
);

104 
	`XFREE
(
buf
);

105  
”r
;

106 
	}
}

	@libtomcrypt/src/mac/hmac/hmac_memory.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_HMAC


31 
	$hmac_memÜy
(
hash
,

32 cÚ¡ *
key
, 
keyËn
,

33 cÚ¡ *
š
, 
šËn
,

34 *
out
, *
ou’
)

36 
hmac_¡©e
 *
hmac
;

37 
”r
;

39 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

45 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

46  
”r
;

50 ià(
hash_desütÜ
[
hash
].
hmac_block
 !ğ
NULL
) {

51  
hash_desütÜ
[
hash
].
	`hmac_block
(
key
, 
keyËn
, 
š
, 
šËn
, 
out
, 
ou’
);

56 
hmac
 = 
	`XMALLOC
((
hmac_¡©e
));

57 ià(
hmac
 =ğ
NULL
) {

58  
CRYPT_MEM
;

61 ià((
”r
 = 
	`hmac_š™
(
hmac
, 
hash
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

62 
LBL_ERR
;

65 ià((
”r
 = 
	`hmac_´oûss
(
hmac
, 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

66 
LBL_ERR
;

69 ià((
”r
 = 
	`hmac_dÚe
(
hmac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

70 
LBL_ERR
;

73 
”r
 = 
CRYPT_OK
;

74 
LBL_ERR
:

75 #ifdeà
LTC_CLEAN_STACK


76 
	`z”omem
(
hmac
, (
hmac_¡©e
));

79 
	`XFREE
(
hmac
);

80  
”r
;

81 
	}
}

	@libtomcrypt/src/mac/hmac/hmac_memory_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

19 #ifdeà
LTC_HMAC


33 
	$hmac_memÜy_muÉi
(
hash
,

34 cÚ¡ *
key
, 
keyËn
,

35 *
out
, *
ou’
,

36 cÚ¡ *
š
, 
šËn
, ...)

39 
hmac_¡©e
 *
hmac
;

40 
”r
;

41 
va_li¡
 
¬gs
;

42 cÚ¡ *
cu½Œ
;

43 
cu¾’
;

45 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

51 
hmac
 = 
	`XMALLOC
((
hmac_¡©e
));

52 ià(
hmac
 =ğ
NULL
) {

53  
CRYPT_MEM
;

56 ià((
”r
 = 
	`hmac_š™
(
hmac
, 
hash
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

57 
LBL_ERR
;

60 
	`va_¡¬t
(
¬gs
, 
šËn
);

61 
cu½Œ
 = 
š
;

62 
cu¾’
 = 
šËn
;

65 ià((
”r
 = 
	`hmac_´oûss
(
hmac
, 
cu½Œ
, 
cu¾’
)è!ğ
CRYPT_OK
) {

66 
LBL_ERR
;

69 
cu½Œ
 = 
	`va_¬g
(
¬gs
, const *);

70 ià(
cu½Œ
 =ğ
NULL
) {

73 
cu¾’
 = 
	`va_¬g
(
¬gs
, );

75 ià((
”r
 = 
	`hmac_dÚe
(
hmac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

76 
LBL_ERR
;

78 
LBL_ERR
:

79 #ifdeà
LTC_CLEAN_STACK


80 
	`z”omem
(
hmac
, (
hmac_¡©e
));

82 
	`XFREE
(
hmac
);

83 
	`va_’d
(
¬gs
);

84  
”r
;

85 
	}
}

	@libtomcrypt/src/mac/hmac/hmac_process.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_HMAC


27 
	$hmac_´oûss
(
hmac_¡©e
 *
hmac
, cÚ¡ *
š
, 
šËn
)

29 
”r
;

30 
	`LTC_ARGCHK
(
hmac
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

32 ià((
”r
 = 
	`hash_is_v®id
(
hmac
->
hash
)è!ğ
CRYPT_OK
) {

33  
”r
;

35  
hash_desütÜ
[
hmac
->
hash
].
	`´oûss
(&hmac->
md
, 
š
, 
šËn
);

36 
	}
}

	@libtomcrypt/src/mac/hmac/hmac_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_HMAC


20 
	#HMAC_BLOCKSIZE
 
hash_desütÜ
[
hash
].
blocksize


	)

37 
	$hmac_‹¡
()

39 #iâdeà
LTC_TEST


40  
CRYPT_NOP
;

42 
dige¡
[
MAXBLOCKSIZE
];

43 
i
;

45 cÚ¡ 
	shmac_‹¡_ÿ£
 {

46 
num
;

47 *
®go
;

48 
key
[128];

49 
keyËn
;

50 
d©a
[128];

51 
d©®’
;

52 
dige¡
[
MAXBLOCKSIZE
];

53 } 
ÿ£s
[] = {

265 
ou’
;

266 
”r
;

267 
‹¡ed
=0,
çed
=0;

268 
i
=0; i < ()((
ÿ£s
) / (cases[0])); i++) {

269 
hash
 = 
	`fšd_hash
(
ÿ£s
[
i
].
®go
);

270 ià(
hash
 == -1) ;

271 ++
‹¡ed
;

272 
ou’
 = (
dige¡
);

273 if((
”r
 = 
	`hmac_memÜy
(
hash
, 
ÿ£s
[
i
].
key
, ca£s[i].
keyËn
, ca£s[i].
d©a
, ca£s[i].
d©®’
, 
dige¡
, &
ou’
)è!ğ
CRYPT_OK
) {

275 
	`´štf
("HMAC-% ‹¡ #%d, %s\n", 
ÿ£s
[
i
].
®go
, ca£s[i].
num
, 
	`”rÜ_to_¡ršg
(
”r
));

277  
”r
;

280 if(
	`XMEMCMP
(
dige¡
, 
ÿ£s
[
i
].dige¡, (
size_t
)
hash_desütÜ
[
hash
].
hashsize
) != 0) {

281 
çed
++;

283 
j
;

284 
	`´štf
("\nHMAC-% ‹¡ #%d:\n", 
ÿ£s
[
i
].
®go
, ca£s[i].
num
);

285 
	`´štf
( "Result: 0x");

286 
j
=0; j < 
hash_desütÜ
[
hash
].
hashsize
; j++) {

287 
	`´štf
("%2x ", 
dige¡
[
j
]);

289 
	`´štf
("\nCorrect: 0x");

290 
j
=0; j < 
hash_desütÜ
[
hash
].
hashsize
; j++) {

291 
	`´štf
("%2x ", 
ÿ£s
[
i
].
dige¡
[
j
]);

293 
	`´štf
("\n");

294  
CRYPT_ERROR
;

301 ià(
çed
 != 0) {

302  
CRYPT_FAIL_TESTVECTOR
;

303 } ià(
‹¡ed
 == 0) {

304  
CRYPT_NOP
;

306  
CRYPT_OK
;

309 
	}
}

	@libtomcrypt/src/mac/omac/omac_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OMAC


27 
	$omac_dÚe
(
omac_¡©e
 *
omac
, *
out
, *
ou’
)

29 
”r
, 
mode
;

30 
x
;

32 
	`LTC_ARGCHK
(
omac
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
omac
->
ch”_idx
)è!ğ
CRYPT_OK
) {

36  
”r
;

39 ià((
omac
->
buæ’
 > ()(omac->
block
)) || (omac->buflen < 0) ||

40 (
omac
->
blkËn
 > ()(omac->
block
)è|| (omac->
buæ’
 > omac->blklen)) {

41  
CRYPT_INVALID_ARG
;

45 ià(
omac
->
buæ’
 !ğomac->
blkËn
) {

47 
omac
->
block
[omac->
buæ’
++] = 0x80;

50 
omac
->
buæ’
 < omac->
blkËn
) {

51 
omac
->
block
[omac->
buæ’
++] = 0x00;

53 
mode
 = 1;

55 
mode
 = 0;

59 
x
 = 0; x < ()
omac
->
blkËn
; x++) {

60 
omac
->
block
[
x
] ^ğomac->
´ev
[x] ^ omac->
Lu
[
mode
][x];

64 ià((
”r
 = 
ch”_desütÜ
[
omac
->
ch”_idx
].
	`ecb_’üy±
(omac->
block
, omac->block, &omac->
key
)è!ğ
CRYPT_OK
) {

65  
”r
;

67 
ch”_desütÜ
[
omac
->
ch”_idx
].
	`dÚe
(&omac->
key
);

70 
x
 = 0; x < ()
omac
->
blkËn
 && x < *
ou’
; x++) {

71 
out
[
x
] = 
omac
->
block
[x];

73 *
ou’
 = 
x
;

75 #ifdeà
LTC_CLEAN_STACK


76 
	`z”omem
(
omac
, (*omac));

78  
CRYPT_OK
;

79 
	}
}

	@libtomcrypt/src/mac/omac/omac_file.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OMAC


30 
	$omac_fe
(
ch”
,

31 cÚ¡ *
key
, 
keyËn
,

32 cÚ¡ *
f’ame
,

33 *
out
, *
ou’
)

35 #ifdeà
LTC_NO_FILE


36  
CRYPT_NOP
;

38 
”r
, 
x
;

39 
omac_¡©e
 
omac
;

40 
FILE
 *
š
;

41 
buf
[512];

43 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
f’ame
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 
š
 = 
	`fİ’
(
f’ame
, "rb");

49 ià(
š
 =ğ
NULL
) {

50  
CRYPT_FILE_NOTFOUND
;

53 ià((
”r
 = 
	`omac_š™
(&
omac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

54 
	`fşo£
(
š
);

55  
”r
;

59 
x
 = 
	`ä—d
(
buf
, 1, (buf), 
š
);

60 ià((
”r
 = 
	`omac_´oûss
(&
omac
, 
buf
, 
x
)è!ğ
CRYPT_OK
) {

61 
	`fşo£
(
š
);

62  
”r
;

64 } 
x
 =ğ(
buf
));

65 
	`fşo£
(
š
);

67 ià((
”r
 = 
	`omac_dÚe
(&
omac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

68  
”r
;

71 #ifdeà
LTC_CLEAN_STACK


72 
	`z”omem
(
buf
, (buf));

75  
CRYPT_OK
;

77 
	}
}

	@libtomcrypt/src/mac/omac/omac_init.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_OMAC


29 
	$omac_š™
(
omac_¡©e
 *
omac
, 
ch”
, cÚ¡ *
key
, 
keyËn
)

31 
”r
, 
x
, 
y
, 
mask
, 
msb
, 
Ën
;

33 
	`LTC_ARGCHK
(
omac
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

37 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

38  
”r
;

41 #ifdeà
LTC_FAST


42 ià(
ch”_desütÜ
[
ch”
].
block_Ëngth
 % (
LTC_FAST_TYPE
)) {

43  
CRYPT_INVALID_ARG
;

48 
ch”_desütÜ
[
ch”
].
block_Ëngth
) {

49 8: 
mask
 = 0x1B;

50 
Ën
 = 8;

52 16: 
mask
 = 0x87;

53 
Ën
 = 16;

55 :  
CRYPT_INVALID_ARG
;

58 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 0, &
omac
->key)è!ğ
CRYPT_OK
) {

59  
”r
;

65 
	`z”omem
(
omac
->
Lu
[0], 
ch”_desütÜ
[
ch”
].
block_Ëngth
);

66 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
omac
->
Lu
[0], omac->Lu[0], &omac->
key
)è!ğ
CRYPT_OK
) {

67  
”r
;

71 
x
 = 0; x < 2; x++) {

73 
msb
 = 
omac
->
Lu
[
x
][0] >> 7;

76 
y
 = 0; y < (
Ën
 - 1); y++) {

77 
omac
->
Lu
[
x
][
y
] = ((omac->Lu[x][y] << 1) | (omac->Lu[x][y+1] >> 7)) & 255;

79 
omac
->
Lu
[
x
][
Ën
 - 1] = ((omac->Lu[x][ËÀ- 1] << 1è^ (
msb
 ? 
mask
 : 0)) & 255;

82 ià(
x
 == 0) {

83 
	`XMEMCPY
(
omac
->
Lu
[1], omac->Lu[0], (omac->Lu[0]));

88 
omac
->
ch”_idx
 = 
ch”
;

89 
omac
->
buæ’
 = 0;

90 
omac
->
blkËn
 = 
Ën
;

91 
	`z”omem
(
omac
->
´ev
, (omac->prev));

92 
	`z”omem
(
omac
->
block
, (omac->block));

94  
CRYPT_OK
;

95 
	}
}

	@libtomcrypt/src/mac/omac/omac_memory.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OMAC


31 
	$omac_memÜy
(
ch”
,

32 cÚ¡ *
key
, 
keyËn
,

33 cÚ¡ *
š
, 
šËn
,

34 *
out
, *
ou’
)

36 
”r
;

37 
omac_¡©e
 *
omac
;

39 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

45 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

46  
”r
;

50 ià(
ch”_desütÜ
[
ch”
].
omac_memÜy
 !ğ
NULL
) {

51  
ch”_desütÜ
[
ch”
].
	`omac_memÜy
(
key
, 
keyËn
, 
š
, 
šËn
, 
out
, 
ou’
);

55 
omac
 = 
	`XMALLOC
((
omac_¡©e
));

56 ià(
omac
 =ğ
NULL
) {

57  
CRYPT_MEM
;

61 ià((
”r
 = 
	`omac_š™
(
omac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

62 
LBL_ERR
;

64 ià((
”r
 = 
	`omac_´oûss
(
omac
, 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

65 
LBL_ERR
;

67 ià((
”r
 = 
	`omac_dÚe
(
omac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

68 
LBL_ERR
;

71 
”r
 = 
CRYPT_OK
;

72 
LBL_ERR
:

73 #ifdeà
LTC_CLEAN_STACK


74 
	`z”omem
(
omac
, (
omac_¡©e
));

77 
	`XFREE
(
omac
);

78  
”r
;

79 
	}
}

	@libtomcrypt/src/mac/omac/omac_memory_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

19 #ifdeà
LTC_OMAC


33 
	$omac_memÜy_muÉi
(
ch”
,

34 cÚ¡ *
key
, 
keyËn
,

35 *
out
, *
ou’
,

36 cÚ¡ *
š
, 
šËn
, ...)

38 
”r
;

39 
omac_¡©e
 *
omac
;

40 
va_li¡
 
¬gs
;

41 cÚ¡ *
cu½Œ
;

42 
cu¾’
;

44 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

50 
omac
 = 
	`XMALLOC
((
omac_¡©e
));

51 ià(
omac
 =ğ
NULL
) {

52  
CRYPT_MEM
;

56 ià((
”r
 = 
	`omac_š™
(
omac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

57 
LBL_ERR
;

59 
	`va_¡¬t
(
¬gs
, 
šËn
);

60 
cu½Œ
 = 
š
;

61 
cu¾’
 = 
šËn
;

64 ià((
”r
 = 
	`omac_´oûss
(
omac
, 
cu½Œ
, 
cu¾’
)è!ğ
CRYPT_OK
) {

65 
LBL_ERR
;

68 
cu½Œ
 = 
	`va_¬g
(
¬gs
, const *);

69 ià(
cu½Œ
 =ğ
NULL
) {

72 
cu¾’
 = 
	`va_¬g
(
¬gs
, );

74 ià((
”r
 = 
	`omac_dÚe
(
omac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

75 
LBL_ERR
;

77 
LBL_ERR
:

78 #ifdeà
LTC_CLEAN_STACK


79 
	`z”omem
(
omac
, (
omac_¡©e
));

81 
	`XFREE
(
omac
);

82 
	`va_’d
(
¬gs
);

83  
”r
;

84 
	}
}

	@libtomcrypt/src/mac/omac/omac_process.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_OMAC


28 
	$omac_´oûss
(
omac_¡©e
 *
omac
, cÚ¡ *
š
, 
šËn
)

30 
n
, 
x
;

31 
”r
;

33 
	`LTC_ARGCHK
(
omac
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
omac
->
ch”_idx
)è!ğ
CRYPT_OK
) {

36  
”r
;

39 ià((
omac
->
buæ’
 > ()(omac->
block
)) || (omac->buflen < 0) ||

40 (
omac
->
blkËn
 > ()(omac->
block
)è|| (omac->
buæ’
 > omac->blklen)) {

41  
CRYPT_INVALID_ARG
;

44 #ifdeà
LTC_FAST


45 ià(
omac
->
buæ’
 =ğ0 && 
šËn
 > 16) {

46 
y
;

47 
x
 = 0; x < (
šËn
 - 16); x += 16) {

48 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

49 *((
LTC_FAST_TYPE
*)(&
omac
->
´ev
[
y
])è^ğ*((LTC_FAST_TYPE*)(&
š
[y]));

51 
š
 += 16;

52 ià((
”r
 = 
ch”_desütÜ
[
omac
->
ch”_idx
].
	`ecb_’üy±
(omac->
´ev
, omac->´ev, &omac->
key
)è!ğ
CRYPT_OK
) {

53  
”r
;

56 
šËn
 -ğ
x
;

60 
šËn
 != 0) {

62 ià(
omac
->
buæ’
 =ğomac->
blkËn
) {

63 
x
 = 0; x < ()
omac
->
blkËn
; x++) {

64 
omac
->
block
[
x
] ^ğomac->
´ev
[x];

66 ià((
”r
 = 
ch”_desütÜ
[
omac
->
ch”_idx
].
	`ecb_’üy±
(omac->
block
, omac->
´ev
, &omac->
key
)è!ğ
CRYPT_OK
) {

67  
”r
;

69 
omac
->
buæ’
 = 0;

73 
n
 = 
	`MIN
(
šËn
, ()(
omac
->
blkËn
 - omac->
buæ’
));

74 
	`XMEMCPY
(
omac
->
block
 + omac->
buæ’
, 
š
, 
n
);

75 
omac
->
buæ’
 +ğ
n
;

76 
šËn
 -ğ
n
;

77 
š
 +ğ
n
;

80  
CRYPT_OK
;

81 
	}
}

	@libtomcrypt/src/mac/omac/omac_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OMAC


24 
	$omac_‹¡
()

26 #ià!
	`defšed
(
LTC_TEST
)

27  
CRYPT_NOP
;

30 
keyËn
, 
msgËn
;

31 
key
[16], 
msg
[64], 
g
[16];

32 } 
‹¡s
[] = {

75 
out
[16];

76 
x
, 
”r
, 
idx
;

77 
Ën
;

81 ià((
idx
 = 
	`fšd_ch”
("aes")) == -1) {

82 ià((
idx
 = 
	`fšd_ch”
("rijndael")) == -1) {

83  
CRYPT_NOP
;

87 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

88 
Ën
 = (
out
);

89 ià((
”r
 = 
	`omac_memÜy
(
idx
, 
‹¡s
[
x
].
key
,e¡s[x].
keyËn
,e¡s[x].
msg
,e¡s[x].
msgËn
, 
out
, &
Ën
)è!ğ
CRYPT_OK
) {

90  
”r
;

93 ià(
	`XMEMCMP
(
out
, 
‹¡s
[
x
].
g
, 16) != 0) {

95 
y
;

96 
	`´štf
("\n\nTag: ");

97 
y
 = 0; y < 16; y++è
	`´štf
("%02x", 
out
[y]);…rintf("\n\n");

99  
CRYPT_FAIL_TESTVECTOR
;

102  
CRYPT_OK
;

104 
	}
}

	@libtomcrypt/src/mac/pelican/pelican.c

11 
	~"tomüy±.h
"

18 #ifdeà
PELICAN


20 
	#ENCRYPT_ONLY


	)

21 
	#PELI_TAB


	)

22 
	~"../../ch”s/«s/«s_b.c
"

31 
	$³liÿn_š™
(
³liÿn_¡©e
 *
³lmac
, cÚ¡ *
key
, 
keyËn
)

33 
”r
;

35 
	`LTC_ARGCHK
(
³lmac
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

38 #ifdeà
LTC_FAST


39 ià(16 % (
LTC_FAST_TYPE
)) {

40  
CRYPT_INVALID_ARG
;

44 ià((
”r
 = 
	`«s_£tup
(
key
, 
keyËn
, 0, &
³lmac
->
K
)è!ğ
CRYPT_OK
) {

45  
”r
;

48 
	`z”omem
(
³lmac
->
¡©e
, 16);

49 
	`«s_ecb_’üy±
(
³lmac
->
¡©e
,…–mac->¡©e, &³lmac->
K
);

50 
³lmac
->
buæ’
 = 0;

52  
CRYPT_OK
;

53 
	}
}

55 
	$four_rounds
(
³liÿn_¡©e
 *
³lmac
)

57 
ulÚg32
 
s0
, 
s1
, 
s2
, 
s3
, 
t0
, 
t1
, 
t2
, 
t3
;

58 
r
;

60 
	`LOAD32H
(
s0
, 
³lmac
->
¡©e
 );

61 
	`LOAD32H
(
s1
, 
³lmac
->
¡©e
 + 4);

62 
	`LOAD32H
(
s2
, 
³lmac
->
¡©e
 + 8);

63 
	`LOAD32H
(
s3
, 
³lmac
->
¡©e
 + 12);

64 
r
 = 0;„ < 4;„++) {

65 
t0
 =

66 
	`Te0
(
	`by‹
(
s0
, 3)) ^

67 
	`Te1
(
	`by‹
(
s1
, 2)) ^

68 
	`Te2
(
	`by‹
(
s2
, 1)) ^

69 
	`Te3
(
	`by‹
(
s3
, 0));

70 
t1
 =

71 
	`Te0
(
	`by‹
(
s1
, 3)) ^

72 
	`Te1
(
	`by‹
(
s2
, 2)) ^

73 
	`Te2
(
	`by‹
(
s3
, 1)) ^

74 
	`Te3
(
	`by‹
(
s0
, 0));

75 
t2
 =

76 
	`Te0
(
	`by‹
(
s2
, 3)) ^

77 
	`Te1
(
	`by‹
(
s3
, 2)) ^

78 
	`Te2
(
	`by‹
(
s0
, 1)) ^

79 
	`Te3
(
	`by‹
(
s1
, 0));

80 
t3
 =

81 
	`Te0
(
	`by‹
(
s3
, 3)) ^

82 
	`Te1
(
	`by‹
(
s0
, 2)) ^

83 
	`Te2
(
	`by‹
(
s1
, 1)) ^

84 
	`Te3
(
	`by‹
(
s2
, 0));

85 
s0
 = 
t0
; 
s1
 = 
t1
; 
s2
 = 
t2
; 
s3
 = 
t3
;

87 
	`STORE32H
(
s0
, 
³lmac
->
¡©e
 );

88 
	`STORE32H
(
s1
, 
³lmac
->
¡©e
 + 4);

89 
	`STORE32H
(
s2
, 
³lmac
->
¡©e
 + 8);

90 
	`STORE32H
(
s3
, 
³lmac
->
¡©e
 + 12);

91 
	}
}

100 
	$³liÿn_´oûss
(
³liÿn_¡©e
 *
³lmac
, cÚ¡ *
š
, 
šËn
)

103 
	`LTC_ARGCHK
(
³lmac
 !ğ
NULL
);

104 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

107 ià(
³lmac
->
buæ’
 < 0 ||…elmac->buflen > 15) {

108  
CRYPT_INVALID_ARG
;

111 #ifdeà
LTC_FAST


112 ià(
³lmac
->
buæ’
 == 0) {

113 
šËn
 & ~15) {

114 
x
;

115 
x
 = 0; x < 16; x +ğ(
LTC_FAST_TYPE
)) {

116 *((
LTC_FAST_TYPE
*)((*)
³lmac
->
¡©e
 + 
x
)è^ğ*((LTC_FAST_TYPE*)((*)
š
 + x));

118 
	`four_rounds
(
³lmac
);

119 
š
 += 16;

120 
šËn
 -= 16;

125 
šËn
--) {

126 
³lmac
->
¡©e
[³lmac->
buæ’
++] ^ğ*
š
++;

127 ià(
³lmac
->
buæ’
 == 16) {

128 
	`four_rounds
(
³lmac
);

129 
³lmac
->
buæ’
 = 0;

132  
CRYPT_OK
;

133 
	}
}

141 
	$³liÿn_dÚe
(
³liÿn_¡©e
 *
³lmac
, *
out
)

143 
	`LTC_ARGCHK
(
³lmac
 !ğ
NULL
);

144 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

147 ià(
³lmac
->
buæ’
 < 0 ||…elmac->buflen > 16) {

148  
CRYPT_INVALID_ARG
;

151 ià(
³lmac
->
buæ’
 == 16) {

152 
	`four_rounds
(
³lmac
);

153 
³lmac
->
buæ’
 = 0;

155 
³lmac
->
¡©e
[³lmac->
buæ’
++] ^= 0x80;

156 
	`«s_ecb_’üy±
(
³lmac
->
¡©e
, 
out
, &³lmac->
K
);

157 
	`«s_dÚe
(&
³lmac
->
K
);

158  
CRYPT_OK
;

159 
	}
}

	@libtomcrypt/src/mac/pelican/pelican_memory.c

11 
	~"tomüy±.h
"

18 #ifdeà
PELICAN


29 
	$³liÿn_memÜy
(cÚ¡ *
key
, 
keyËn
,

30 cÚ¡ *
š
, 
šËn
,

31 *
out
)

33 
³liÿn_¡©e
 *
³l
;

34 
”r
;

36 
³l
 = 
	`XMALLOC
((*pel));

37 ià(
³l
 =ğ
NULL
) {

38  
CRYPT_MEM
;

41 ià((
”r
 = 
	`³liÿn_š™
(
³l
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

42 
	`XFREE
(
³l
);

43  
”r
;

45 ià((
”r
 = 
	`³liÿn_´oûss
(
³l
, 
š
 ,
šËn
)è!ğ
CRYPT_OK
) {

46 
	`XFREE
(
³l
);

47  
”r
;

49 
”r
 = 
	`³liÿn_dÚe
(
³l
, 
out
);

50 
	`XFREE
(
³l
);

51  
”r
;

52 
	}
}

	@libtomcrypt/src/mac/pelican/pelican_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
PELICAN


20 
	$³liÿn_‹¡
()

22 #iâdeà
LTC_TEST


23  
CRYPT_NOP
;

26 
K
[32], 
MSG
[64], 
T
[16];

27 
keyËn
, 
±Ën
;

28 } 
‹¡s
[] = {

87 
x
, 
”r
;

88 
out
[16];

89 
³liÿn_¡©e
 
³l
;

91 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

92 ià((
”r
 = 
	`³liÿn_š™
(&
³l
, 
‹¡s
[
x
].
K
,e¡s[x].
keyËn
)è!ğ
CRYPT_OK
) {

93  
”r
;

95 ià((
”r
 = 
	`³liÿn_´oûss
(&
³l
, 
‹¡s
[
x
].
MSG
,e¡s[x].
±Ën
)è!ğ
CRYPT_OK
) {

96  
”r
;

98 ià((
”r
 = 
	`³liÿn_dÚe
(&
³l
, 
out
)è!ğ
CRYPT_OK
) {

99  
”r
;

102 ià(
	`XMEMCMP
(
out
, 
‹¡s
[
x
].
T
, 16)) {

104 
y
;

105 
	`´štf
("\nFaede¡ %d\n", 
x
);

106 
	`´štf
("{ "); 
y
 = 0; y < 16; ) {…rštf("0x%02x, ", 
out
[y]); if (!(++y & 7))…rintf("\n"); }…rintf(" }\n");

108  
CRYPT_FAIL_TESTVECTOR
;

111  
CRYPT_OK
;

113 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_PMAC


20 
	$pmac_dÚe
(
pmac_¡©e
 *
¡©e
, *
out
, *
ou’
)

22 
”r
, 
x
;

24 
	`LTC_ARGCHK
(
¡©e
 !ğ
NULL
);

25 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

26 ià((
”r
 = 
	`ch”_is_v®id
(
¡©e
->
ch”_idx
)è!ğ
CRYPT_OK
) {

27  
”r
;

30 ià((
¡©e
->
buæ’
 > ()(¡©e->
block
)) || (state->buflen < 0) ||

31 (
¡©e
->
block_Ën
 > ()(¡©e->
block
)è|| (¡©e->
buæ’
 > state->block_len)) {

32  
CRYPT_INVALID_ARG
;

38 ià(
¡©e
->
buæ’
 =ğ¡©e->
block_Ën
) {

40 
x
 = 0; x < 
¡©e
->
block_Ën
; x++) {

41 
¡©e
->
checksum
[
x
] ^ğ¡©e->
block
[x] ^ s‹->
Lr
[x];

45 
x
 = 0; x < 
¡©e
->
buæ’
; x++) {

46 
¡©e
->
checksum
[
x
] ^ğ¡©e->
block
[x];

48 
¡©e
->
checksum
[
x
] ^= 0x80;

52 ià((
”r
 = 
ch”_desütÜ
[
¡©e
->
ch”_idx
].
	`ecb_’üy±
(¡©e->
checksum
, s‹->checksum, &¡©e->
key
)è!ğ
CRYPT_OK
) {

53  
”r
;

55 
ch”_desütÜ
[
¡©e
->
ch”_idx
].
	`dÚe
(&¡©e->
key
);

58 
x
 = 0; x < 
¡©e
->
block_Ën
 && x < ()*
ou’
; x++) {

59 
out
[
x
] = 
¡©e
->
checksum
[x];

61 *
ou’
 = 
x
;

63 #ifdeà
LTC_CLEAN_STACK


64 
	`z”omem
(
¡©e
, (*state));

66  
CRYPT_OK
;

67 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_file.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_PMAC


30 
	$pmac_fe
(
ch”
,

31 cÚ¡ *
key
, 
keyËn
,

32 cÚ¡ *
f’ame
,

33 *
out
, *
ou’
)

35 #ifdeà
LTC_NO_FILE


36  
CRYPT_NOP
;

38 
”r
, 
x
;

39 
pmac_¡©e
 
pmac
;

40 
FILE
 *
š
;

41 
buf
[512];

44 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
f’ame
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

49 
š
 = 
	`fİ’
(
f’ame
, "rb");

50 ià(
š
 =ğ
NULL
) {

51  
CRYPT_FILE_NOTFOUND
;

54 ià((
”r
 = 
	`pmac_š™
(&
pmac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

55 
	`fşo£
(
š
);

56  
”r
;

60 
x
 = 
	`ä—d
(
buf
, 1, (buf), 
š
);

61 ià((
”r
 = 
	`pmac_´oûss
(&
pmac
, 
buf
, 
x
)è!ğ
CRYPT_OK
) {

62 
	`fşo£
(
š
);

63  
”r
;

65 } 
x
 =ğ(
buf
));

66 
	`fşo£
(
š
);

68 ià((
”r
 = 
	`pmac_dÚe
(&
pmac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

69  
”r
;

72 #ifdeà
LTC_CLEAN_STACK


73 
	`z”omem
(
buf
, (buf));

76  
CRYPT_OK
;

78 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_init.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_PMAC


21 
	mËn
;

22 
	mpŞy_div
[
MAXBLOCKSIZE
],

23 
	mpŞy_mul
[
MAXBLOCKSIZE
];

24 } 
	gpŞys
[] = {

46 
	$pmac_š™
(
pmac_¡©e
 *
pmac
, 
ch”
, cÚ¡ *
key
, 
keyËn
)

48 
pŞy
, 
x
, 
y
, 
m
, 
”r
;

49 *
L
;

51 
	`LTC_ARGCHK
(
pmac
 !ğ
NULL
);

52 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

55 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

56  
”r
;

60 
pmac
->
block_Ën
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

61 
pŞy
 = 0;…Şy < ()((
pŞys
)/(polys[0]));…oly++) {

62 ià(
pŞys
[
pŞy
].
Ën
 =ğ
pmac
->
block_Ën
) {

66 ià(
pŞys
[
pŞy
].
Ën
 !ğ
pmac
->
block_Ën
) {

67  
CRYPT_INVALID_ARG
;

70 #ifdeà
LTC_FAST


71 ià(
pmac
->
block_Ën
 % (
LTC_FAST_TYPE
)) {

72  
CRYPT_INVALID_ARG
;

78 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 0, &
pmac
->key)è!ğ
CRYPT_OK
) {

79  
”r
;

83 
L
 = 
	`XMALLOC
(
pmac
->
block_Ën
);

84 ià(
L
 =ğ
NULL
) {

85  
CRYPT_MEM
;

89 
	`z”omem
(
L
, 
pmac
->
block_Ën
);

90 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
L
, L, &
pmac
->
key
)è!ğ
CRYPT_OK
) {

91 
”rÜ
;

95 
	`XMEMCPY
(
pmac
->
Ls
[0], 
L
,…mac->
block_Ën
);

96 
x
 = 1; x < 32; x++) {

97 
m
 = 
pmac
->
Ls
[
x
-1][0] >> 7;

98 
y
 = 0; y < 
pmac
->
block_Ën
-1; y++) {

99 
pmac
->
Ls
[
x
][
y
] = ((pmac->Ls[x-1][y] << 1) | (pmac->Ls[x-1][y+1] >> 7)) & 255;

101 
pmac
->
Ls
[
x
][pmac->
block_Ën
-1] = (pmac->Ls[x-1][pmac->block_len-1] << 1) & 255;

103 ià(
m
 == 1) {

104 
y
 = 0; y < 
pmac
->
block_Ën
; y++) {

105 
pmac
->
Ls
[
x
][
y
] ^ğ
pŞys
[
pŞy
].
pŞy_mul
[y];

111 
m
 = 
L
[
pmac
->
block_Ën
-1] & 1;

114 
x
 = 
pmac
->
block_Ën
 - 1; x > 0; x--) {

115 
pmac
->
Lr
[
x
] = ((
L
[x] >> 1) | (L[x-1] << 7)) & 255;

117 
pmac
->
Lr
[0] = 
L
[0] >> 1;

119 ià(
m
 == 1) {

120 
x
 = 0; x < 
pmac
->
block_Ën
; x++) {

121 
pmac
->
Lr
[
x
] ^ğ
pŞys
[
pŞy
].
pŞy_div
[x];

126 
pmac
->
block_šdex
 = 1;

127 
pmac
->
ch”_idx
 = 
ch”
;

128 
pmac
->
buæ’
 = 0;

129 
	`z”omem
(
pmac
->
block
, (pmac->block));

130 
	`z”omem
(
pmac
->
Li
, (pmac->Li));

131 
	`z”omem
(
pmac
->
checksum
, (pmac->checksum));

132 
”r
 = 
CRYPT_OK
;

133 
”rÜ
:

134 #ifdeà
LTC_CLEAN_STACK


135 
	`z”omem
(
L
, 
pmac
->
block_Ën
);

138 
	`XFREE
(
L
);

140  
”r
;

141 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_memory.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_PMAC


31 
	$pmac_memÜy
(
ch”
,

32 cÚ¡ *
key
, 
keyËn
,

33 cÚ¡ *
š
, 
šËn
,

34 *
out
, *
ou’
)

36 
”r
;

37 
pmac_¡©e
 *
pmac
;

39 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

45 
pmac
 = 
	`XMALLOC
((
pmac_¡©e
));

46 ià(
pmac
 =ğ
NULL
) {

47  
CRYPT_MEM
;

50 ià((
”r
 = 
	`pmac_š™
(
pmac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

51 
LBL_ERR
;

53 ià((
”r
 = 
	`pmac_´oûss
(
pmac
, 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

54 
LBL_ERR
;

56 ià((
”r
 = 
	`pmac_dÚe
(
pmac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

57 
LBL_ERR
;

60 
”r
 = 
CRYPT_OK
;

61 
LBL_ERR
:

62 #ifdeà
LTC_CLEAN_STACK


63 
	`z”omem
(
pmac
, (
pmac_¡©e
));

66 
	`XFREE
(
pmac
);

67  
”r
;

68 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_memory_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

19 #ifdeà
LTC_PMAC


33 
	$pmac_memÜy_muÉi
(
ch”
,

34 cÚ¡ *
key
, 
keyËn
,

35 *
out
, *
ou’
,

36 cÚ¡ *
š
, 
šËn
, ...)

38 
”r
;

39 
pmac_¡©e
 *
pmac
;

40 
va_li¡
 
¬gs
;

41 cÚ¡ *
cu½Œ
;

42 
cu¾’
;

44 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

50 
pmac
 = 
	`XMALLOC
((
pmac_¡©e
));

51 ià(
pmac
 =ğ
NULL
) {

52  
CRYPT_MEM
;

55 ià((
”r
 = 
	`pmac_š™
(
pmac
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

56 
LBL_ERR
;

58 
	`va_¡¬t
(
¬gs
, 
šËn
);

59 
cu½Œ
 = 
š
;

60 
cu¾’
 = 
šËn
;

63 ià((
”r
 = 
	`pmac_´oûss
(
pmac
, 
cu½Œ
, 
cu¾’
)è!ğ
CRYPT_OK
) {

64 
LBL_ERR
;

67 
cu½Œ
 = 
	`va_¬g
(
¬gs
, const *);

68 ià(
cu½Œ
 =ğ
NULL
) {

71 
cu¾’
 = 
	`va_¬g
(
¬gs
, );

73 ià((
”r
 = 
	`pmac_dÚe
(
pmac
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

74 
LBL_ERR
;

76 
LBL_ERR
:

77 #ifdeà
LTC_CLEAN_STACK


78 
	`z”omem
(
pmac
, (
pmac_¡©e
));

80 
	`XFREE
(
pmac
);

81 
	`va_’d
(
¬gs
);

82  
”r
;

83 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_ntz.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_PMAC


23 
	$pmac_Áz
(
x
)

25 
c
;

26 
x
 &= 0xFFFFFFFFUL;

27 
c
 = 0;

28 (
x
 & 1) == 0) {

29 ++
c
;

30 
x
 >>= 1;

32  
c
;

33 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_process.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_PMAC


28 
	$pmac_´oûss
(
pmac_¡©e
 *
pmac
, cÚ¡ *
š
, 
šËn
)

30 
”r
, 
n
;

31 
x
;

32 
Z
[
MAXBLOCKSIZE
];

34 
	`LTC_ARGCHK
(
pmac
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

36 ià((
”r
 = 
	`ch”_is_v®id
(
pmac
->
ch”_idx
)è!ğ
CRYPT_OK
) {

37  
”r
;

40 ià((
pmac
->
buæ’
 > ()Õmac->
block
)) || (pmac->buflen < 0) ||

41 (
pmac
->
block_Ën
 > ()Õmac->
block
)è|| (pmac->
buæ’
 >…mac->block_len)) {

42  
CRYPT_INVALID_ARG
;

45 #ifdeà
LTC_FAST


46 ià(
pmac
->
buæ’
 =ğ0 && 
šËn
 > 16) {

47 
y
;

48 
x
 = 0; x < (
šËn
 - 16); x += 16) {

49 
	`pmac_shiá_xÜ
(
pmac
);

50 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

51 *((
LTC_FAST_TYPE
*)(&
Z
[
y
])èğ*((LTC_FAST_TYPE*)(&
š
[y])è^ *((LTC_FAST_TYPE*)(&
pmac
->
Li
[y]));

53 ià((
”r
 = 
ch”_desütÜ
[
pmac
->
ch”_idx
].
	`ecb_’üy±
(
Z
, Z, &pmac->
key
)è!ğ
CRYPT_OK
) {

54  
”r
;

56 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

57 *((
LTC_FAST_TYPE
*)(&
pmac
->
checksum
[
y
])è^ğ*((LTC_FAST_TYPE*)(&
Z
[y]));

59 
š
 += 16;

61 
šËn
 -ğ
x
;

65 
šËn
 != 0) {

67 ià(
pmac
->
buæ’
 =ğpmac->
block_Ën
) {

68 
	`pmac_shiá_xÜ
(
pmac
);

69 
x
 = 0; x < ()
pmac
->
block_Ën
; x++) {

70 
Z
[
x
] = 
pmac
->
Li
[x] ^…mac->
block
[x];

72 ià((
”r
 = 
ch”_desütÜ
[
pmac
->
ch”_idx
].
	`ecb_’üy±
(
Z
, Z, &pmac->
key
)è!ğ
CRYPT_OK
) {

73  
”r
;

75 
x
 = 0; x < ()
pmac
->
block_Ën
; x++) {

76 
pmac
->
checksum
[
x
] ^ğ
Z
[x];

78 
pmac
->
buæ’
 = 0;

82 
n
 = 
	`MIN
(
šËn
, ()(
pmac
->
block_Ën
 -…mac->
buæ’
));

83 
	`XMEMCPY
(
pmac
->
block
 +…mac->
buæ’
, 
š
, 
n
);

84 
pmac
->
buæ’
 +ğ
n
;

85 
šËn
 -ğ
n
;

86 
š
 +ğ
n
;

89 #ifdeà
LTC_CLEAN_STACK


90 
	`z”omem
(
Z
, (Z));

93  
CRYPT_OK
;

94 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_shift_xor.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_PMAC


24 
	$pmac_shiá_xÜ
(
pmac_¡©e
 *
pmac
)

26 
x
, 
y
;

27 
y
 = 
	`pmac_Áz
(
pmac
->
block_šdex
++);

28 #ifdeà
LTC_FAST


29 
x
 = 0; x < 
pmac
->
block_Ën
; x +ğ(
LTC_FAST_TYPE
)) {

30 *((
LTC_FAST_TYPE
*)((*)
pmac
->
Li
 + 
x
)) ^=

31 *((
LTC_FAST_TYPE
*)((*)
pmac
->
Ls
[
y
] + 
x
));

34 
x
 = 0; x < 
pmac
->
block_Ën
; x++) {

35 
pmac
->
Li
[
x
] ^ğpmac->
Ls
[
y
][x];

38 
	}
}

	@libtomcrypt/src/mac/pmac/pmac_test.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_PMAC


25 
	$pmac_‹¡
()

27 #ià!
	`defšed
(
LTC_TEST
)

28  
CRYPT_NOP
;

31 
msgËn
;

32 
key
[16], 
msg
[34], 
g
[16];

33 } 
‹¡s
[] = {

124 
”r
, 
x
, 
idx
;

125 
Ën
;

126 
ou‰ag
[
MAXBLOCKSIZE
];

129 ià((
idx
 = 
	`fšd_ch”
("aes")) == -1) {

130 ià((
idx
 = 
	`fšd_ch”
("rijndael")) == -1) {

131  
CRYPT_NOP
;

135 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

136 
Ën
 = (
ou‰ag
);

137 ià((
”r
 = 
	`pmac_memÜy
(
idx
, 
‹¡s
[
x
].
key
, 16,e¡s[x].
msg
,e¡s[x].
msgËn
, 
ou‰ag
, &
Ën
)è!ğ
CRYPT_OK
) {

138  
”r
;

141 ià(
	`XMEMCMP
(
ou‰ag
, 
‹¡s
[
x
].
g
, 
Ën
)) {

143 
y
;

144 
	`´štf
("\nTAG:\n");

145 
y
 = 0; y < 
Ën
; ) {

146 
	`´štf
("0x%02x", 
ou‰ag
[
y
]);

147 ià(
y
 < 
Ën
-1è
	`´štf
(", ");

148 ià(!(++
y
 % 8)è
	`´štf
("\n");

151  
CRYPT_FAIL_TESTVECTOR
;

154  
CRYPT_OK
;

156 
	}
}

	@libtomcrypt/src/mac/xcbc/xcbc_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_XCBC


26 
	$xcbc_dÚe
(
xcbc_¡©e
 *
xcbc
, *
out
, *
ou’
)

28 
”r
, 
x
;

29 
	`LTC_ARGCHK
(
xcbc
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

33 ià((
”r
 = 
	`ch”_is_v®id
(
xcbc
->
ch”
)è!ğ
CRYPT_OK
) {

34  
”r
;

37 ià((
xcbc
->
blocksize
 > 
ch”_desütÜ
[xcbc->
ch”
].
block_Ëngth
) || (xcbc->blocksize < 0) ||

38 (
xcbc
->
buæ’
 > xcbc->
blocksize
) || (xcbc->buflen < 0)) {

39  
CRYPT_INVALID_ARG
;

43 ià(
xcbc
->
buæ’
 =ğxcbc->
blocksize
) {

45 
x
 = 0; x < 
xcbc
->
blocksize
; x++) {

46 
xcbc
->
IV
[
x
] ^ğxcbc->
K
[1][x];

49 
xcbc
->
IV
[xcbc->
buæ’
] ^= 0x80;

51 
x
 = 0; x < 
xcbc
->
blocksize
; x++) {

52 
xcbc
->
IV
[
x
] ^ğxcbc->
K
[2][x];

57 
ch”_desütÜ
[
xcbc
->
ch”
].
	`ecb_’üy±
(xcbc->
IV
, xcbc->IV, &xcbc->
key
);

58 
ch”_desütÜ
[
xcbc
->
ch”
].
	`dÚe
(&xcbc->
key
);

61 
x
 = 0; x < 
xcbc
->
blocksize
 && ()x < *
ou’
; x++) {

62 
out
[
x
] = 
xcbc
->
IV
[x];

64 *
ou’
 = 
x
;

66 #ifdeà
LTC_CLEAN_STACK


67 
	`z”omem
(
xcbc
, (*xcbc));

69  
CRYPT_OK
;

70 
	}
}

	@libtomcrypt/src/mac/xcbc/xcbc_file.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_XCBC


30 
	$xcbc_fe
(
ch”
,

31 cÚ¡ *
key
, 
keyËn
,

32 cÚ¡ *
f’ame
,

33 *
out
, *
ou’
)

35 #ifdeà
LTC_NO_FILE


36  
CRYPT_NOP
;

38 
”r
, 
x
;

39 
xcbc_¡©e
 
xcbc
;

40 
FILE
 *
š
;

41 
buf
[512];

43 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
f’ame
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 
š
 = 
	`fİ’
(
f’ame
, "rb");

49 ià(
š
 =ğ
NULL
) {

50  
CRYPT_FILE_NOTFOUND
;

53 ià((
”r
 = 
	`xcbc_š™
(&
xcbc
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

54 
	`fşo£
(
š
);

55  
”r
;

59 
x
 = 
	`ä—d
(
buf
, 1, (buf), 
š
);

60 ià((
”r
 = 
	`xcbc_´oûss
(&
xcbc
, 
buf
, 
x
)è!ğ
CRYPT_OK
) {

61 
	`fşo£
(
š
);

62  
”r
;

64 } 
x
 =ğ(
buf
));

65 
	`fşo£
(
š
);

67 ià((
”r
 = 
	`xcbc_dÚe
(&
xcbc
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

68  
”r
;

71 #ifdeà
LTC_CLEAN_STACK


72 
	`z”omem
(
buf
, (buf));

75  
CRYPT_OK
;

77 
	}
}

	@libtomcrypt/src/mac/xcbc/xcbc_init.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_XCBC


27 
	$xcbc_š™
(
xcbc_¡©e
 *
xcbc
, 
ch”
, cÚ¡ *
key
, 
keyËn
)

29 
x
, 
y
, 
”r
;

30 
symm‘ric_key
 *
skey
;

32 
	`LTC_ARGCHK
(
xcbc
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

36 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

37  
”r
;

40 #ifdeà
LTC_FAST


41 ià(
ch”_desütÜ
[
ch”
].
block_Ëngth
 % (
LTC_FAST_TYPE
)) {

42  
CRYPT_INVALID_ARG
;

47 
skey
 = 
	`XCALLOC
(1, (*skey));

48 ià(
skey
 =ğ
NULL
) {

49  
CRYPT_MEM
;

52 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 0, 
skey
)è!ğ
CRYPT_OK
) {

53 
dÚe
;

57 
y
 = 0; y < 3; y++) {

58 
x
 = 0; x < 
ch”_desütÜ
[
ch”
].
block_Ëngth
; x++) {

59 
xcbc
->
K
[
y
][
x
] = y + 1;

61 
ch”_desütÜ
[
ch”
].
	`ecb_’üy±
(
xcbc
->
K
[
y
], xcbc->K[y], 
skey
);

65 
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
xcbc
->
K
[0], ch”_desütÜ[ch”].
block_Ëngth
, 0, &xcbc->
key
);

68 
	`z”omem
(
xcbc
->
IV
, 
ch”_desütÜ
[
ch”
].
block_Ëngth
);

69 
xcbc
->
blocksize
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

70 
xcbc
->
ch”
 = cipher;

71 
xcbc
->
buæ’
 = 0;

72 
dÚe
:

73 
ch”_desütÜ
[
ch”
].
	`dÚe
(
skey
);

74 #ifdeà
LTC_CLEAN_STACK


75 
	`z”omem
(
skey
, (*skey));

77 
	`XFREE
(
skey
);

78  
”r
;

79 
	}
}

	@libtomcrypt/src/mac/xcbc/xcbc_memory.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_XCBC


30 
	$xcbc_memÜy
(
ch”
,

31 cÚ¡ *
key
, 
keyËn
,

32 cÚ¡ *
š
, 
šËn
,

33 *
out
, *
ou’
)

35 
xcbc_¡©e
 *
xcbc
;

36 
”r
;

39 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

40  
”r
;

44 ià(
ch”_desütÜ
[
ch”
].
xcbc_memÜy
 !ğ
NULL
) {

45  
ch”_desütÜ
[
ch”
].
	`xcbc_memÜy
(
key
, 
keyËn
, 
š
, 
šËn
, 
out
, 
ou’
);

48 
xcbc
 = 
	`XCALLOC
(1, (*xcbc));

49 ià(
xcbc
 =ğ
NULL
) {

50  
CRYPT_MEM
;

53 ià((
”r
 = 
	`xcbc_š™
(
xcbc
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

54 
dÚe
;

57 ià((
”r
 = 
	`xcbc_´oûss
(
xcbc
, 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

58 
dÚe
;

61 
”r
 = 
	`xcbc_dÚe
(
xcbc
, 
out
, 
ou’
);

62 
dÚe
:

63 
	`XFREE
(
xcbc
);

64  
”r
;

65 
	}
}

	@libtomcrypt/src/mac/xcbc/xcbc_memory_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

19 #ifdeà
LTC_XCBC


33 
	$xcbc_memÜy_muÉi
(
ch”
,

34 cÚ¡ *
key
, 
keyËn
,

35 *
out
, *
ou’
,

36 cÚ¡ *
š
, 
šËn
, ...)

38 
”r
;

39 
xcbc_¡©e
 *
xcbc
;

40 
va_li¡
 
¬gs
;

41 cÚ¡ *
cu½Œ
;

42 
cu¾’
;

44 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

50 
xcbc
 = 
	`XMALLOC
((
xcbc_¡©e
));

51 ià(
xcbc
 =ğ
NULL
) {

52  
CRYPT_MEM
;

56 ià((
”r
 = 
	`xcbc_š™
(
xcbc
, 
ch”
, 
key
, 
keyËn
)è!ğ
CRYPT_OK
) {

57 
LBL_ERR
;

59 
	`va_¡¬t
(
¬gs
, 
šËn
);

60 
cu½Œ
 = 
š
;

61 
cu¾’
 = 
šËn
;

64 ià((
”r
 = 
	`xcbc_´oûss
(
xcbc
, 
cu½Œ
, 
cu¾’
)è!ğ
CRYPT_OK
) {

65 
LBL_ERR
;

68 
cu½Œ
 = 
	`va_¬g
(
¬gs
, const *);

69 ià(
cu½Œ
 =ğ
NULL
) {

72 
cu¾’
 = 
	`va_¬g
(
¬gs
, );

74 ià((
”r
 = 
	`xcbc_dÚe
(
xcbc
, 
out
, 
ou’
)è!ğ
CRYPT_OK
) {

75 
LBL_ERR
;

77 
LBL_ERR
:

78 #ifdeà
LTC_CLEAN_STACK


79 
	`z”omem
(
xcbc
, (
xcbc_¡©e
));

81 
	`XFREE
(
xcbc
);

82 
	`va_’d
(
¬gs
);

83  
”r
;

84 
	}
}

	@libtomcrypt/src/mac/xcbc/xcbc_process.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_XCBC


26 
	$xcbc_´oûss
(
xcbc_¡©e
 *
xcbc
, cÚ¡ *
š
, 
šËn
)

28 
”r
;

29 #ifdeà
LTC_FAST


30 
x
;

33 
	`LTC_ARGCHK
(
xcbc
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

37 ià((
”r
 = 
	`ch”_is_v®id
(
xcbc
->
ch”
)è!ğ
CRYPT_OK
) {

38  
”r
;

41 ià((
xcbc
->
blocksize
 > 
ch”_desütÜ
[xcbc->
ch”
].
block_Ëngth
) || (xcbc->blocksize < 0) ||

42 (
xcbc
->
buæ’
 > xcbc->
blocksize
) || (xcbc->buflen < 0)) {

43  
CRYPT_INVALID_ARG
;

46 #ifdeà
LTC_FAST


47 ià(
xcbc
->
buæ’
 == 0) {

48 
šËn
 > ()
xcbc
->
blocksize
) {

49 
x
 = 0; x < 
xcbc
->
blocksize
; x +ğ(
LTC_FAST_TYPE
)) {

50 *((
LTC_FAST_TYPE
*)&(
xcbc
->
IV
[
x
])è^ğ*((LTC_FAST_TYPE*)&(
š
[x]));

52 
ch”_desütÜ
[
xcbc
->
ch”
].
	`ecb_’üy±
(xcbc->
IV
, xcbc->IV, &xcbc->
key
);

53 
š
 +ğ
xcbc
->
blocksize
;

54 
šËn
 -ğ
xcbc
->
blocksize
;

59 
šËn
) {

60 ià(
xcbc
->
buæ’
 =ğxcbc->
blocksize
) {

61 
ch”_desütÜ
[
xcbc
->
ch”
].
	`ecb_’üy±
(xcbc->
IV
, xcbc->IV, &xcbc->
key
);

62 
xcbc
->
buæ’
 = 0;

64 
xcbc
->
IV
[xcbc->
buæ’
++] ^ğ*
š
++;

65 --
šËn
;

67  
CRYPT_OK
;

68 
	}
}

	@libtomcrypt/src/mac/xcbc/xcbc_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_XCBC


23 
	$xcbc_‹¡
()

25 #ifdeà
LTC_NO_TEST


26  
CRYPT_NOP
;

29 
msgËn
;

30 
K
[16], 
M
[34], 
T
[16];

31 } 
‹¡s
[] = {

98 
T
[16];

99 
gËn
;

100 
”r
, 
x
, 
idx
;

103 ià((
idx
 = 
	`fšd_ch”
("aes")) == -1) {

104 ià((
idx
 = 
	`fšd_ch”
("rijndael")) == -1) {

105  
CRYPT_NOP
;

109 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

110 
gËn
 = 16;

111 ià((
”r
 = 
	`xcbc_memÜy
(
idx
, 
‹¡s
[
x
].
K
, 16,e¡s[x].
M
,e¡s[x].
msgËn
, 
T
, &
gËn
)è!ğ
CRYPT_OK
) {

112  
”r
;

114 ià(
gËn
 !ğ16 || 
	`XMEMCMP
(
T
, 
‹¡s
[
x
].T, 16)) {

115  
CRYPT_FAIL_TESTVECTOR
;

119  
CRYPT_OK
;

121 
	}
}

	@libtomcrypt/src/math/fp/ltc_ecc_fp_mulmod.c

11 
	~"tomüy±.h
"

18 #ià
defšed
(
MECC
è&& defšed(
MECC_FP
)

19 
	~<lim™s.h
>

22 #iâdeà
FP_ENTRIES


23 
	#FP_ENTRIES
 16

	)

27 #iâdeà
FP_LUT


28 
	#FP_LUT
 8U

	)

31 #ià(
FP_LUT
 > 12) || (FP_LUT < 2)

32 #”rÜ 
FP_LUT
 
mu¡
 
be
 
b‘w“n
 2 
ªd
 12 
šşusiv–y


37 
ecc_pošt
 *
	mg
,

38 *
	mLUT
[1U<<
FP_LUT
];

39 *
	mmu
;

40 
	mÌu_couÁ
;

41 } 
	gå_ÿche
[
FP_ENTRIES
];

43 
	$LTC_MUTEX_GLOBAL
(
Éc_ecc_å_lock
)

47 
ham
, 
‹rma
, 
‹rmb
;

48 } 
lut_Üd”s
[] = {

57 #ià
FP_LUT
 > 6

66 #ià
FP_LUT
 > 7

83 #ià
FP_LUT
 > 8

116 #ià
FP_LUT
 > 9

181 #ià
FP_LUT
 > 10

310 #ià
FP_LUT
 > 11

573 
	}
};

576 
	$fšd_hŞe
()

578 
x
;

579 
y
, 
z
;

580 
z
 = 0, 
y
 = 
INT_MAX
, 
x
 = 0; x < 
FP_ENTRIES
; x++) {

581 ià(
å_ÿche
[
x
].
Ìu_couÁ
 < 
y
) {

582 
z
 = 
x
;

583 
y
 = 
å_ÿche
[
x
].
Ìu_couÁ
;

588 
x
 = 0; x < 
FP_ENTRIES
; x++) {

589 ià(
å_ÿche
[
x
].
Ìu_couÁ
 > 3) {

590 --(
å_ÿche
[
x
].
Ìu_couÁ
);

595 ià(
å_ÿche
[
z
].
g
) {

596 ià(
å_ÿche
[
z
].
mu
 !ğ
NULL
) {

597 
	`mp_ş—r
(
å_ÿche
[
z
].
mu
);

598 
å_ÿche
[
z
].
mu
 = 
NULL
;

600 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
z
].
g
);

601 
å_ÿche
[
z
].
g
 = 
NULL
;

602 
x
 = 0; x < (1U<<
FP_LUT
); x++) {

603 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
z
].
LUT
[
x
]);

604 
å_ÿche
[
z
].
LUT
[
x
] = 
NULL
;

606 
å_ÿche
[
z
].
Ìu_couÁ
 = 0;

608  
z
;

609 
	}
}

612 
	$fšd_ba£
(
ecc_pošt
 *
g
)

614 
x
;

615 
x
 = 0; x < 
FP_ENTRIES
; x++) {

616 ià(
å_ÿche
[
x
].
g
 !ğ
NULL
 &&

617 
	`mp_cmp
(
å_ÿche
[
x
].
g
->x, g->xè=ğ
LTC_MP_EQ
 &&

618 
	`mp_cmp
(
å_ÿche
[
x
].
g
->
y
, g->yè=ğ
LTC_MP_EQ
 &&

619 
	`mp_cmp
(
å_ÿche
[
x
].
g
->
z
, g->zè=ğ
LTC_MP_EQ
) {

623 ià(
x
 =ğ
FP_ENTRIES
) {

624 
x
 = -1;

626  
x
;

627 
	}
}

630 
	$add_’Œy
(
idx
, 
ecc_pošt
 *
g
)

632 
x
, 
y
;

635 
å_ÿche
[
idx
].
g
 = 
	`Éc_ecc_Ãw_pošt
();

636 ià(
å_ÿche
[
idx
].
g
 =ğ
NULL
) {

637  
CRYPT_MEM
;

641 ià((
	`mp_cİy
(
g
->
x
, 
å_ÿche
[
idx
].g->xè!ğ
CRYPT_OK
) ||

642 (
	`mp_cİy
(
g
->
y
, 
å_ÿche
[
idx
].g->yè!ğ
CRYPT_OK
) ||

643 (
	`mp_cİy
(
g
->
z
, 
å_ÿche
[
idx
].g->zè!ğ
CRYPT_OK
)) {

644 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
idx
].
g
);

645 
å_ÿche
[
idx
].
g
 = 
NULL
;

646  
CRYPT_MEM
;

649 
x
 = 0; x < (1U<<
FP_LUT
); x++) {

650 
å_ÿche
[
idx
].
LUT
[
x
] = 
	`Éc_ecc_Ãw_pošt
();

651 ià(
å_ÿche
[
idx
].
LUT
[
x
] =ğ
NULL
) {

652 
y
 = 0; y < 
x
; y++) {

653 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
idx
].
LUT
[
y
]);

654 
å_ÿche
[
idx
].
LUT
[
y
] = 
NULL
;

656 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
idx
].
g
);

657 
å_ÿche
[
idx
].
g
 = 
NULL
;

658 
å_ÿche
[
idx
].
Ìu_couÁ
 = 0;

659  
CRYPT_MEM
;

663 
å_ÿche
[
idx
].
Ìu_couÁ
 = 0;

664  
CRYPT_OK
;

665 
	}
}

672 
	$bud_lut
(
idx
, *
modulus
, *
mp
, *
mu
)

674 
x
, 
y
, 
”r
, 
b™Ën
, 
lut_g­
;

675 *
tmp
;

677 
tmp
 = 
NULL
;

680 ià(((
lut_Üd”s
è/ Öut_Üd”s[0])è< (1U<<
FP_LUT
)) {

681 
”r
 = 
CRYPT_INVALID_ARG
;

682 
DONE
;

686 
b™Ën
 = 
	`mp_unsigÃd_bš_size
(
modulus
) << 3;

687 
x
 = 
b™Ën
 % 
FP_LUT
;

688 ià(
x
) {

689 
b™Ën
 +ğ
FP_LUT
 - 
x
;

691 
lut_g­
 = 
b™Ën
 / 
FP_LUT
;

694 ià((
”r
 = 
	`mp_š™_cİy
(&
å_ÿche
[
idx
].
mu
, mu)è!ğ
CRYPT_OK
) {

695 
ERR
;

699 ià((
	`mp_mulmod
(
å_ÿche
[
idx
].
g
->
x
, 
mu
, 
modulus
, fp_ÿche[idx].
LUT
[1]->xè!ğ
CRYPT_OK
) ||

700 (
	`mp_mulmod
(
å_ÿche
[
idx
].
g
->
y
, 
mu
, 
modulus
, fp_ÿche[idx].
LUT
[1]->yè!ğ
CRYPT_OK
) ||

701 (
	`mp_mulmod
(
å_ÿche
[
idx
].
g
->
z
, 
mu
, 
modulus
, fp_ÿche[idx].
LUT
[1]->zè!ğ
CRYPT_OK
)è{ 
ERR
; }

704 
x
 = 1; x < 
FP_LUT
; x++) {

705 ià((
	`mp_cİy
(
å_ÿche
[
idx
].
LUT
[1<<(
x
-1)]->x, fp_ÿche[idx].LUT[1<<x]->xè!ğ
CRYPT_OK
) ||

706 (
	`mp_cİy
(
å_ÿche
[
idx
].
LUT
[1<<(
x
-1)]->
y
, fp_ÿche[idx].LUT[1<<x]->yè!ğ
CRYPT_OK
) ||

707 (
	`mp_cİy
(
å_ÿche
[
idx
].
LUT
[1<<(
x
-1)]->
z
, fp_ÿche[idx].LUT[1<<x]->zè!ğ
CRYPT_OK
)è{ 
ERR
; }

710 
y
 = 0; y < 
lut_g­
; y++) {

711 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
å_ÿche
[
idx
].
LUT
[1<<
x
], fp_ÿche[idx].LUT[1<<x], 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

712 
ERR
;

718 
x
 = 2; x <ğ
FP_LUT
; x++) {

719 
y
 = 0; y < (1UL<<
FP_LUT
); y++) {

720 ià(
lut_Üd”s
[
y
].
ham
 !ğ()
x
) ;

723 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
å_ÿche
[
idx
].
LUT
[
lut_Üd”s
[
y
].
‹rma
], fp_ÿche[idx].LUT[lut_Üd”s[y].
‹rmb
],

724 
å_ÿche
[
idx
].
LUT
[
y
], 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

725 
ERR
;

731 ià((
”r
 = 
	`mp_š™
(&
tmp
)è!ğ
CRYPT_OK
è{ 
ERR
; }

732 
x
 = 1; x < (1UL<<
FP_LUT
); x++) {

734 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
å_ÿche
[
idx
].
LUT
[
x
]->
z
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR
; }

737 ià((
”r
 = 
	`mp_švmod
(
å_ÿche
[
idx
].
LUT
[
x
]->
z
, 
modulus
, fp_ÿche[idx].LUT[x]->z)è!ğ
CRYPT_OK
è{ 
ERR
; }

740 ià((
”r
 = 
	`mp_sqrmod
(
å_ÿche
[
idx
].
LUT
[
x
]->
z
, 
modulus
, 
tmp
)è!ğ
CRYPT_OK
è{ 
ERR
; }

743 ià((
”r
 = 
	`mp_mulmod
(
å_ÿche
[
idx
].
LUT
[
x
]->x, 
tmp
, 
modulus
, fp_ÿche[idx].LUT[x]->x)è!ğ
CRYPT_OK
è{ 
ERR
; }

746 ià((
”r
 = 
	`mp_mulmod
(
tmp
, 
å_ÿche
[
idx
].
LUT
[
x
]->
z
, 
modulus
,mp)è!ğ
CRYPT_OK
è{ 
ERR
; }

749 ià((
”r
 = 
	`mp_mulmod
(
å_ÿche
[
idx
].
LUT
[
x
]->
y
, 
tmp
, 
modulus
, fp_ÿche[idx].LUT[x]->y)è!ğ
CRYPT_OK
è{ 
ERR
; }

752 
	`mp_ş—r
(
å_ÿche
[
idx
].
LUT
[
x
]->
z
);

753 
å_ÿche
[
idx
].
LUT
[
x
]->
z
 = 
NULL
;

755 
	`mp_ş—r
(
tmp
);

757  
CRYPT_OK
;

758 
ERR
:

759 
”r
 = 
CRYPT_MEM
;

760 
DONE
:

761 
y
 = 0; y < (1U<<
FP_LUT
); y++) {

762 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
idx
].
LUT
[
y
]);

763 
å_ÿche
[
idx
].
LUT
[
y
] = 
NULL
;

765 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
idx
].
g
);

766 
å_ÿche
[
idx
].
g
 = 
NULL
;

767 
å_ÿche
[
idx
].
Ìu_couÁ
 = 0;

768 ià(
å_ÿche
[
idx
].
mu
 !ğ
NULL
) {

769 
	`mp_ş—r
(
å_ÿche
[
idx
].
mu
);

770 
å_ÿche
[
idx
].
mu
 = 
NULL
;

772 ià(
tmp
 !ğ
NULL
) {

773 
	`mp_ş—r
(
tmp
);

775  
”r
;

776 
	}
}

779 
	$acûl_å_mul
(
idx
, *
k
, 
ecc_pošt
 *
R
, *
modulus
, *
mp
, 
m­
)

781 
kb
[128];

782 
x
;

783 
y
, 
z
, 
”r
, 
b™Ën
, 
b™pos
, 
lut_g­
, 
fœ¡
;

784 *
tk
, *
Üd”
;

787 ià(
	`mp_unsigÃd_bš_size
(
k
è> mp_unsigÃd_bš_size(
modulus
)) {

789 
y
 = 
	`mp_unsigÃd_bš_size
(
modulus
);

790 
x
 = 0; 
Éc_ecc_£ts
[x].
size
; x++) {

791 ià(
y
 <ğ()
Éc_ecc_£ts
[
x
].
size
) ;

795 ià(
y
 =ğ66è--
x
;

797 ià((
”r
 = 
	`mp_š™
(&
Üd”
)è!ğ
CRYPT_OK
) {

798  
”r
;

800 ià((
”r
 = 
	`mp_»ad_¿dix
(
Üd”
, 
Éc_ecc_£ts
[
x
].Üd”, 16)è!ğ
CRYPT_OK
) {

801 
	`mp_ş—r
(&
Üd”
);

802  
”r
;

806 ià(
	`mp_cmp
(
k
, 
Üd”
è!ğ
LTC_MP_LT
) {

807 ià((
”r
 = 
	`mp_š™
(&
tk
)è!ğ
CRYPT_OK
) {

808 
	`mp_ş—r
(
Üd”
);

809  
”r
;

811 ià((
”r
 = 
	`mp_mod
(
k
, 
Üd”
, 
tk
)è!ğ
CRYPT_OK
) {

812 
	`mp_ş—r
(
tk
);

813 
	`mp_ş—r
(
Üd”
);

814  
”r
;

817 
tk
 = 
k
;

819 
	`mp_ş—r
(
Üd”
);

821 
tk
 = 
k
;

825 
b™Ën
 = 
	`mp_unsigÃd_bš_size
(
modulus
) << 3;

826 
x
 = 
b™Ën
 % 
FP_LUT
;

827 ià(
x
) {

828 
b™Ën
 +ğ
FP_LUT
 - 
x
;

830 
lut_g­
 = 
b™Ën
 / 
FP_LUT
;

833 ià(
	`mp_unsigÃd_bš_size
(
tk
è> ((
kb
) - 2)) {

834 ià(
tk
 !ğ
k
) {

835 
	`mp_ş—r
(
tk
);

837  
CRYPT_BUFFER_OVERFLOW
;

841 
	`z”omem
(
kb
, (kb));

842 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
tk
, 
kb
)è!ğ
CRYPT_OK
) {

843 ià(
tk
 !ğ
k
) {

844 
	`mp_ş—r
(
tk
);

846  
”r
;

850 
x
 = 0;

851 
y
 = 
	`mp_unsigÃd_bš_size
(
tk
) - 1;

852 ià(
tk
 !ğ
k
) {

853 
	`mp_ş—r
(
tk
);

855 ()
x
 < 
y
) {

856 
z
 = 
kb
[
x
]; kb[x] = kb[
y
]; kb[y] = z;

857 ++
x
; --
y
;

861 
fœ¡
 = 1;

862 
x
 = 
lut_g­
-1; x >= 0; x--) {

864 
b™pos
 = 
x
;

865 
y
 = 
z
 = 0; y < 
FP_LUT
; y++) {

866 
z
 |ğ((
kb
[
b™pos
>>3] >> (b™pos&7)è& 1è<< 
y
;

867 
b™pos
 +ğ
lut_g­
;

871 ià(!
fœ¡
) {

872 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
R
, R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

873  
”r
;

878 ià(!
fœ¡
 && 
z
) {

879 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
R
, 
å_ÿche
[
idx
].
LUT
[
z
], R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

880  
”r
;

882 } ià(
z
) {

883 ià((
	`mp_cİy
(
å_ÿche
[
idx
].
LUT
[
z
]->
x
, 
R
->xè!ğ
CRYPT_OK
) ||

884 (
	`mp_cİy
(
å_ÿche
[
idx
].
LUT
[
z
]->
y
, 
R
->yè!ğ
CRYPT_OK
) ||

885 (
	`mp_cİy
(
å_ÿche
[
idx
].
mu
, 
R
->
z
è!ğ
CRYPT_OK
)è{  
CRYPT_MEM
; }

886 
fœ¡
 = 0;

889 
z
 = 0;

890 
	`z”omem
(
kb
, (kb));

892 ià(
m­
) {

893 
”r
 = 
	`Éc_ecc_m­
(
R
, 
modulus
, 
mp
);

895 
”r
 = 
CRYPT_OK
;

897  
”r
;

898 
	}
}

900 #ifdeà
LTC_ECC_SHAMIR


902 
	$acûl_å_mul2add
(
idx1
, 
idx2
,

903 *
kA
, *
kB
,

904 
ecc_pošt
 *
R
, *
modulus
, *
mp
)

906 
kb
[2][128];

907 
x
;

908 
y
, 
z
, 
”r
, 
b™Ën
, 
b™pos
, 
lut_g­
, 
fœ¡
, 
zA
, 
zB
;

909 *
tka
, *
tkb
, *
Üd”
;

912 ià(
	`mp_unsigÃd_bš_size
(
kA
è> mp_unsigÃd_bš_size(
modulus
)) {

914 
y
 = 
	`mp_unsigÃd_bš_size
(
modulus
);

915 
x
 = 0; 
Éc_ecc_£ts
[x].
size
; x++) {

916 ià(
y
 <ğ()
Éc_ecc_£ts
[
x
].
size
) ;

920 ià(
y
 =ğ66è--
x
;

922 ià((
”r
 = 
	`mp_š™
(&
Üd”
)è!ğ
CRYPT_OK
) {

923  
”r
;

925 ià((
”r
 = 
	`mp_»ad_¿dix
(
Üd”
, 
Éc_ecc_£ts
[
x
].Üd”, 16)è!ğ
CRYPT_OK
) {

926 
	`mp_ş—r
(&
Üd”
);

927  
”r
;

931 ià(
	`mp_cmp
(
kA
, 
Üd”
è!ğ
LTC_MP_LT
) {

932 ià((
”r
 = 
	`mp_š™
(&
tka
)è!ğ
CRYPT_OK
) {

933 
	`mp_ş—r
(
Üd”
);

934  
”r
;

936 ià((
”r
 = 
	`mp_mod
(
kA
, 
Üd”
, 
tka
)è!ğ
CRYPT_OK
) {

937 
	`mp_ş—r
(
tka
);

938 
	`mp_ş—r
(
Üd”
);

939  
”r
;

942 
tka
 = 
kA
;

944 
	`mp_ş—r
(
Üd”
);

946 
tka
 = 
kA
;

950 ià(
	`mp_unsigÃd_bš_size
(
kB
è> mp_unsigÃd_bš_size(
modulus
)) {

952 
y
 = 
	`mp_unsigÃd_bš_size
(
modulus
);

953 
x
 = 0; 
Éc_ecc_£ts
[x].
size
; x++) {

954 ià(
y
 <ğ()
Éc_ecc_£ts
[
x
].
size
) ;

958 ià(
y
 =ğ66è--
x
;

960 ià((
”r
 = 
	`mp_š™
(&
Üd”
)è!ğ
CRYPT_OK
) {

961  
”r
;

963 ià((
”r
 = 
	`mp_»ad_¿dix
(
Üd”
, 
Éc_ecc_£ts
[
x
].Üd”, 16)è!ğ
CRYPT_OK
) {

964 
	`mp_ş—r
(&
Üd”
);

965  
”r
;

969 ià(
	`mp_cmp
(
kB
, 
Üd”
è!ğ
LTC_MP_LT
) {

970 ià((
”r
 = 
	`mp_š™
(&
tkb
)è!ğ
CRYPT_OK
) {

971 
	`mp_ş—r
(
Üd”
);

972  
”r
;

974 ià((
”r
 = 
	`mp_mod
(
kB
, 
Üd”
, 
tkb
)è!ğ
CRYPT_OK
) {

975 
	`mp_ş—r
(
tkb
);

976 
	`mp_ş—r
(
Üd”
);

977  
”r
;

980 
tkb
 = 
kB
;

982 
	`mp_ş—r
(
Üd”
);

984 
tkb
 = 
kB
;

988 
b™Ën
 = 
	`mp_unsigÃd_bš_size
(
modulus
) << 3;

989 
x
 = 
b™Ën
 % 
FP_LUT
;

990 ià(
x
) {

991 
b™Ën
 +ğ
FP_LUT
 - 
x
;

993 
lut_g­
 = 
b™Ën
 / 
FP_LUT
;

996 ià((
	`mp_unsigÃd_bš_size
(
tka
è> ((
kb
[0]è- 2)è|| (mp_unsigÃd_bš_size(
tkb
) > ((kb[0]) - 2)) ) {

997 ià(
tka
 !ğ
kA
) {

998 
	`mp_ş—r
(
tka
);

1000 ià(
tkb
 !ğ
kB
) {

1001 
	`mp_ş—r
(
tkb
);

1003  
CRYPT_BUFFER_OVERFLOW
;

1007 
	`z”omem
(
kb
, (kb));

1008 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
tka
, 
kb
[0])è!ğ
CRYPT_OK
) {

1009 ià(
tka
 !ğ
kA
) {

1010 
	`mp_ş—r
(
tka
);

1012 ià(
tkb
 !ğ
kB
) {

1013 
	`mp_ş—r
(
tkb
);

1015  
”r
;

1019 
x
 = 0;

1020 
y
 = 
	`mp_unsigÃd_bš_size
(
tka
) - 1;

1021 ià(
tka
 !ğ
kA
) {

1022 
	`mp_ş—r
(
tka
);

1024 ()
x
 < 
y
) {

1025 
z
 = 
kb
[0][
x
]; kb[0][x] = kb[0][
y
]; kb[0][y] = z;

1026 ++
x
; --
y
;

1030 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
tkb
, 
kb
[1])è!ğ
CRYPT_OK
) {

1031 ià(
tkb
 !ğ
kB
) {

1032 
	`mp_ş—r
(
tkb
);

1034  
”r
;

1037 
x
 = 0;

1038 
y
 = 
	`mp_unsigÃd_bš_size
(
tkb
) - 1;

1039 ià(
tkb
 !ğ
kB
) {

1040 
	`mp_ş—r
(
tkb
);

1042 ()
x
 < 
y
) {

1043 
z
 = 
kb
[1][
x
]; kb[1][x] = kb[1][
y
]; kb[1][y] = z;

1044 ++
x
; --
y
;

1048 
fœ¡
 = 1;

1049 
x
 = 
lut_g­
-1; x >= 0; x--) {

1051 
b™pos
 = 
x
;

1052 
y
 = 
zA
 = 
zB
 = 0; y < 
FP_LUT
; y++) {

1053 
zA
 |ğ((
kb
[0][
b™pos
>>3] >> (b™pos&7)è& 1è<< 
y
;

1054 
zB
 |ğ((
kb
[1][
b™pos
>>3] >> (b™pos&7)è& 1è<< 
y
;

1055 
b™pos
 +ğ
lut_g­
;

1059 ià(!
fœ¡
) {

1060 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
R
, R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

1061  
”r
;

1066 ià(!
fœ¡
) {

1067 ià(
zA
) {

1068 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
R
, 
å_ÿche
[
idx1
].
LUT
[
zA
], R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

1069  
”r
;

1072 ià(
zB
) {

1073 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
R
, 
å_ÿche
[
idx2
].
LUT
[
zB
], R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

1074  
”r
;

1078 ià(
zA
) {

1079 ià((
	`mp_cİy
(
å_ÿche
[
idx1
].
LUT
[
zA
]->
x
, 
R
->xè!ğ
CRYPT_OK
) ||

1080 (
	`mp_cİy
(
å_ÿche
[
idx1
].
LUT
[
zA
]->
y
, 
R
->yè!ğ
CRYPT_OK
) ||

1081 (
	`mp_cİy
(
å_ÿche
[
idx1
].
mu
, 
R
->
z
è!ğ
CRYPT_OK
)è{  
CRYPT_MEM
; }

1082 
fœ¡
 = 0;

1084 ià(
zB
 && 
fœ¡
 == 0) {

1085 ià(
zB
) {

1086 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
R
, 
å_ÿche
[
idx2
].
LUT
[
zB
], R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
) {

1087  
”r
;

1090 } ià(
zB
 && 
fœ¡
 == 1) {

1091 ià((
	`mp_cİy
(
å_ÿche
[
idx2
].
LUT
[
zB
]->
x
, 
R
->xè!ğ
CRYPT_OK
) ||

1092 (
	`mp_cİy
(
å_ÿche
[
idx2
].
LUT
[
zB
]->
y
, 
R
->yè!ğ
CRYPT_OK
) ||

1093 (
	`mp_cİy
(
å_ÿche
[
idx2
].
mu
, 
R
->
z
è!ğ
CRYPT_OK
)è{  
CRYPT_MEM
; }

1094 
fœ¡
 = 0;

1098 
	`z”omem
(
kb
, (kb));

1099  
	`Éc_ecc_m­
(
R
, 
modulus
, 
mp
);

1100 
	}
}

1110 
	$Éc_ecc_å_mul2add
(
ecc_pošt
 *
A
, *
kA
,

1111 
ecc_pošt
 *
B
, *
kB
,

1112 
ecc_pošt
 *
C
, *
modulus
)

1114 
idx1
, 
idx2
, 
”r
;

1115 *
mp
, *
mu
;

1117 
mp
 = 
NULL
;

1118 
mu
 = 
NULL
;

1119 
	`LTC_MUTEX_LOCK
(&
Éc_ecc_å_lock
);

1121 
idx1
 = 
	`fšd_ba£
(
A
);

1124 ià(
idx1
 == -1) {

1126 
idx1
 = 
	`fšd_hŞe
();

1128 ià((
”r
 = 
	`add_’Œy
(
idx1
, 
A
)è!ğ
CRYPT_OK
) {

1129 
LBL_ERR
;

1134 ++(
å_ÿche
[
idx1
].
Ìu_couÁ
);

1137 
idx2
 = 
	`fšd_ba£
(
B
);

1140 ià(
idx2
 == -1) {

1142 
idx2
 = 
	`fšd_hŞe
();

1144 ià((
”r
 = 
	`add_’Œy
(
idx2
, 
B
)è!ğ
CRYPT_OK
) {

1145 
LBL_ERR
;

1150 ++(
å_ÿche
[
idx2
].
Ìu_couÁ
);

1153 ià(
å_ÿche
[
idx1
].
Ìu_couÁ
 == 2) {

1155 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
è{ 
LBL_ERR
; }

1158 ià((
”r
 = 
	`mp_š™
(&
mu
)è!ğ
CRYPT_OK
) {

1159 
LBL_ERR
;

1161 ià((
”r
 = 
	`mp_mÚtgom”y_nÜm®iz©iÚ
(
mu
, 
modulus
)è!ğ
CRYPT_OK
) {

1162 
LBL_ERR
;

1166 ià((
”r
 = 
	`bud_lut
(
idx1
, 
modulus
, 
mp
, 
mu
)è!ğ
CRYPT_OK
) {

1167 
LBL_ERR
;;

1172 ià(
å_ÿche
[
idx2
].
Ìu_couÁ
 == 2) {

1173 ià(
mp
 =ğ
NULL
) {

1175 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
è{ 
LBL_ERR
; }

1178 ià((
”r
 = 
	`mp_š™
(&
mu
)è!ğ
CRYPT_OK
) {

1179 
LBL_ERR
;

1181 ià((
”r
 = 
	`mp_mÚtgom”y_nÜm®iz©iÚ
(
mu
, 
modulus
)è!ğ
CRYPT_OK
) {

1182 
LBL_ERR
;

1187 ià((
”r
 = 
	`bud_lut
(
idx2
, 
modulus
, 
mp
, 
mu
)è!ğ
CRYPT_OK
) {

1188 
LBL_ERR
;;

1193 ià(
å_ÿche
[
idx1
].
Ìu_couÁ
 >ğ2 && fp_ÿche[
idx2
].lru_count >= 2) {

1194 ià(
mp
 =ğ
NULL
) {

1196 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
è{ 
LBL_ERR
; }

1198 
”r
 = 
	`acûl_å_mul2add
(
idx1
, 
idx2
, 
kA
, 
kB
, 
C
, 
modulus
, 
mp
);

1200 
”r
 = 
	`Éc_ecc_mul2add
(
A
, 
kA
, 
B
, 
kB
, 
C
, 
modulus
);

1202 
LBL_ERR
:

1203 
	`LTC_MUTEX_UNLOCK
(&
Éc_ecc_å_lock
);

1204 ià(
mp
 !ğ
NULL
) {

1205 
	`mp_mÚtgom”y_ä“
(
mp
);

1207 ià(
mu
 !ğ
NULL
) {

1208 
	`mp_ş—r
(
mu
);

1210  
”r
;

1211 
	}
}

1222 
	$Éc_ecc_å_mulmod
(*
k
, 
ecc_pošt
 *
G
,ƒcc_pošˆ*
R
, *
modulus
, 
m­
)

1224 
idx
, 
”r
;

1225 *
mp
, *
mu
;

1227 
mp
 = 
NULL
;

1228 
mu
 = 
NULL
;

1229 
	`LTC_MUTEX_LOCK
(&
Éc_ecc_å_lock
);

1231 
idx
 = 
	`fšd_ba£
(
G
);

1234 ià(
idx
 == -1) {

1236 
idx
 = 
	`fšd_hŞe
();

1238 ià((
”r
 = 
	`add_’Œy
(
idx
, 
G
)è!ğ
CRYPT_OK
) {

1239 
LBL_ERR
;

1244 ++(
å_ÿche
[
idx
].
Ìu_couÁ
);

1247 ià(
å_ÿche
[
idx
].
Ìu_couÁ
 == 2) {

1249 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
è{ 
LBL_ERR
; }

1252 ià((
”r
 = 
	`mp_š™
(&
mu
)è!ğ
CRYPT_OK
) {

1253 
LBL_ERR
;

1255 ià((
”r
 = 
	`mp_mÚtgom”y_nÜm®iz©iÚ
(
mu
, 
modulus
)è!ğ
CRYPT_OK
) {

1256 
LBL_ERR
;

1260 ià((
”r
 = 
	`bud_lut
(
idx
, 
modulus
, 
mp
, 
mu
)è!ğ
CRYPT_OK
) {

1261 
LBL_ERR
;;

1265 ià(
å_ÿche
[
idx
].
Ìu_couÁ
 >= 2) {

1266 ià(
mp
 =ğ
NULL
) {

1268 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
è{ 
LBL_ERR
; }

1270 
”r
 = 
	`acûl_å_mul
(
idx
, 
k
, 
R
, 
modulus
, 
mp
, 
m­
);

1272 
”r
 = 
	`Éc_ecc_mulmod
(
k
, 
G
, 
R
, 
modulus
, 
m­
);

1274 
LBL_ERR
:

1275 
	`LTC_MUTEX_UNLOCK
(&
Éc_ecc_å_lock
);

1276 ià(
mp
 !ğ
NULL
) {

1277 
	`mp_mÚtgom”y_ä“
(
mp
);

1279 ià(
mu
 !ğ
NULL
) {

1280 
	`mp_ş—r
(
mu
);

1282  
”r
;

1283 
	}
}

1286 
	$Éc_ecc_å_ä“
()

1288 
x
, 
y
;

1289 
	`LTC_MUTEX_LOCK
(&
Éc_ecc_å_lock
);

1290 
x
 = 0; x < 
FP_ENTRIES
; x++) {

1291 ià(
å_ÿche
[
x
].
g
 !ğ
NULL
) {

1292 
y
 = 0; y < (1U<<
FP_LUT
); y++) {

1293 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
x
].
LUT
[
y
]);

1294 
å_ÿche
[
x
].
LUT
[
y
] = 
NULL
;

1296 
	`Éc_ecc_d–_pošt
(
å_ÿche
[
x
].
g
);

1297 
å_ÿche
[
x
].
g
 = 
NULL
;

1298 ià(
å_ÿche
[
x
].
mu
 !ğ
NULL
) {

1299 
	`mp_ş—r
(
å_ÿche
[
x
].
mu
);

1300 
å_ÿche
[
x
].
mu
 = 
NULL
;

1302 
å_ÿche
[
x
].
Ìu_couÁ
 = 0;

1305 
	`LTC_MUTEX_UNLOCK
(&
Éc_ecc_å_lock
);

1306 
	}
}

	@libtomcrypt/src/math/gmp_desc.c

12 
	#DESC_DEF_ONLY


	)

13 
	~"tomüy±.h
"

15 #ifdeà
GMP_DESC


17 
	~<¡dio.h
>

18 
	~<gmp.h
>

20 
	$š™
(**
a
)

22 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

24 *
a
 = 
	`XCALLOC
(1, (
__mpz_¡ruù
));

25 ià(*
a
 =ğ
NULL
) {

26  
CRYPT_MEM
;

28 
	`mpz_š™
(((
__mpz_¡ruù
 *)*
a
));

29  
CRYPT_OK
;

30 
	}
}

32 
	$deš™
(*
a
)

34 
	`LTC_ARGCHKVD
(
a
 !ğ
NULL
);

35 
	`mpz_ş—r
(
a
);

36 
	`XFREE
(
a
);

37 
	}
}

39 
	$Ãg
(*
a
, *
b
)

41 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

43 
	`mpz_Ãg
(
b
, 
a
);

44  
CRYPT_OK
;

45 
	}
}

47 
	$cİy
(*
a
, *
b
)

49 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

50 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

51 
	`mpz_£t
(
b
, 
a
);

52  
CRYPT_OK
;

53 
	}
}

55 
	$š™_cİy
(**
a
, *
b
)

57 ià(
	`š™
(
a
è!ğ
CRYPT_OK
) {

58  
CRYPT_MEM
;

60  
	`cİy
(
b
, *
a
);

61 
	}
}

64 
	$£t_št
(*
a
, 
b
)

66 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

67 
	`mpz_£t_ui
(((
__mpz_¡ruù
 *)
a
), 
b
);

68  
CRYPT_OK
;

69 
	}
}

71 
	$g‘_št
(*
a
)

73 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

74  
	`mpz_g‘_ui
(
a
);

75 
	}
}

77 
	$g‘_dig™
(*
a
, 
n
)

79 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

80  
	`mpz_g‘limbn
(
a
, 
n
);

81 
	}
}

83 
	$g‘_dig™_couÁ
(*
a
)

85 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

86  
	`mpz_size
(
a
);

87 
	}
}

89 
	$com·»
(*
a
, *
b
)

91 
»t
;

92 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

93 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

94 
»t
 = 
	`mpz_cmp
(
a
, 
b
);

95 ià(
»t
 < 0) {

96  
LTC_MP_LT
;

97 } ià(
»t
 > 0) {

98  
LTC_MP_GT
;

100  
LTC_MP_EQ
;

102 
	}
}

104 
	$com·»_d
(*
a
, 
b
)

106 
»t
;

107 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

108 
»t
 = 
	`mpz_cmp_ui
(((
__mpz_¡ruù
 *)
a
), 
b
);

109 ià(
»t
 < 0) {

110  
LTC_MP_LT
;

111 } ià(
»t
 > 0) {

112  
LTC_MP_GT
;

114  
LTC_MP_EQ
;

116 
	}
}

118 
	$couÁ_b™s
(*
a
)

120 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

121  
	`mpz_sizešba£
(
a
, 2);

122 
	}
}

124 
	$couÁ_lsb_b™s
(*
a
)

126 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

127  
	`mpz_sÿn1
(
a
, 0);

128 
	}
}

131 
	$twÛx±
(*
a
, 
n
)

133 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

134 
	`mpz_£t_ui
(
a
, 0);

135 
	`mpz_£tb™
(
a
, 
n
);

136  
CRYPT_OK
;

137 
	}
}

142 
	$»ad_¿dix
(*
a
, cÚ¡ *
b
, 
¿dix
)

144 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

145 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

146 
	`mpz_£t_¡r
(
a
, 
b
, 
¿dix
);

147  
CRYPT_OK
;

148 
	}
}

151 
	$wr™e_¿dix
(*
a
, *
b
, 
¿dix
)

153 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

154 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

155 
	`mpz_g‘_¡r
(
b
, 
¿dix
, 
a
);

156  
CRYPT_OK
;

157 
	}
}

160 
	$unsigÃd_size
(*
a
)

162 
t
;

163 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

164 
t
 = 
	`mpz_sizešba£
(
a
, 2);

165 ià(
	`mpz_cmp_ui
(((
__mpz_¡ruù
 *)
a
), 0) == 0)  0;

166  (
t
>>3) + ((t&7)?1:0);

167 
	}
}

170 
	$unsigÃd_wr™e
(*
a
, *
b
)

172 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

173 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

174 
	`mpz_expÜt
(
b
, 
NULL
, 1, 1, 1, 0, ((
__mpz_¡ruù
*)
a
));

175  
CRYPT_OK
;

176 
	}
}

179 
	$unsigÃd_»ad
(*
a
, *
b
, 
Ën
)

181 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

182 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

183 
	`mpz_impÜt
(
a
, 
Ën
, 1, 1, 1, 0, 
b
);

184  
CRYPT_OK
;

185 
	}
}

188 
	$add
(*
a
, *
b
, *
c
)

190 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

191 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

192 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

193 
	`mpz_add
(
c
, 
a
, 
b
);

194  
CRYPT_OK
;

195 
	}
}

197 
	$addi
(*
a
, 
b
, *
c
)

199 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

200 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

201 
	`mpz_add_ui
(
c
, 
a
, 
b
);

202  
CRYPT_OK
;

203 
	}
}

206 
	$sub
(*
a
, *
b
, *
c
)

208 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

209 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

210 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

211 
	`mpz_sub
(
c
, 
a
, 
b
);

212  
CRYPT_OK
;

213 
	}
}

215 
	$subi
(*
a
, 
b
, *
c
)

217 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

218 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

219 
	`mpz_sub_ui
(
c
, 
a
, 
b
);

220  
CRYPT_OK
;

221 
	}
}

224 
	$mul
(*
a
, *
b
, *
c
)

226 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

227 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

228 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

229 
	`mpz_mul
(
c
, 
a
, 
b
);

230  
CRYPT_OK
;

231 
	}
}

233 
	$muli
(*
a
, 
b
, *
c
)

235 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

236 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

237 
	`mpz_mul_ui
(
c
, 
a
, 
b
);

238  
CRYPT_OK
;

239 
	}
}

242 
	$sqr
(*
a
, *
b
)

244 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

245 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

246 
	`mpz_mul
(
b
, 
a
,‡);

247  
CRYPT_OK
;

248 
	}
}

251 
	$divide
(*
a
, *
b
, *
c
, *
d
)

253 
mpz_t
 
tmp
;

254 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

255 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

256 ià(
c
 !ğ
NULL
) {

257 
	`mpz_š™
(
tmp
);

258 
	`mpz_divexaù
(
tmp
, 
a
, 
b
);

260 ià(
d
 !ğ
NULL
) {

261 
	`mpz_mod
(
d
, 
a
, 
b
);

263 ià(
c
 !ğ
NULL
) {

264 
	`mpz_£t
(
c
, 
tmp
);

265 
	`mpz_ş—r
(
tmp
);

267  
CRYPT_OK
;

268 
	}
}

270 
	$div_2
(*
a
, *
b
)

272 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

273 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

274 
	`mpz_divexaù_ui
(
b
, 
a
, 2);

275  
CRYPT_OK
;

276 
	}
}

279 
	$modi
(*
a
, 
b
, *
c
)

281 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

282 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

284 *
c
 = 
	`mpz_fdiv_ui
(
a
, 
b
);

285  
CRYPT_OK
;

286 
	}
}

289 
	$gcd
(*
a
, *
b
, *
c
)

291 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

292 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

293 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

294 
	`mpz_gcd
(
c
, 
a
, 
b
);

295  
CRYPT_OK
;

296 
	}
}

299 
	$lcm
(*
a
, *
b
, *
c
)

301 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

302 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

303 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

304 
	`mpz_lcm
(
c
, 
a
, 
b
);

305  
CRYPT_OK
;

306 
	}
}

308 
	$mulmod
(*
a
, *
b
, *
c
, *
d
)

310 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

311 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

312 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

313 
	`LTC_ARGCHK
(
d
 !ğ
NULL
);

314 
	`mpz_mul
(
d
, 
a
, 
b
);

315 
	`mpz_mod
(
d
, d, 
c
);

316  
CRYPT_OK
;

317 
	}
}

319 
	$sqrmod
(*
a
, *
b
, *
c
)

321 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

322 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

323 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

324 
	`mpz_mul
(
c
, 
a
,‡);

325 
	`mpz_mod
(
c
, c, 
b
);

326  
CRYPT_OK
;

327 
	}
}

330 
	$švmod
(*
a
, *
b
, *
c
)

332 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

333 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

334 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

335 
	`mpz_šv”t
(
c
, 
a
, 
b
);

336  
CRYPT_OK
;

337 
	}
}

340 
	$mÚtgom”y_£tup
(*
a
, **
b
)

342 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

343 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

344 *
b
 = (*)1;

345  
CRYPT_OK
;

346 
	}
}

349 
	$mÚtgom”y_nÜm®iz©iÚ
(*
a
, *
b
)

351 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

352 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

353 
	`mpz_£t_ui
(
a
, 1);

354  
CRYPT_OK
;

355 
	}
}

358 
	$mÚtgom”y_»duû
(*
a
, *
b
, *
c
)

360 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

361 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

362 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

363 
	`mpz_mod
(
a
,‡, 
b
);

364  
CRYPT_OK
;

365 
	}
}

368 
	$mÚtgom”y_deš™
(*
a
)

370 
	}
}

372 
	$ex±mod
(*
a
, *
b
, *
c
, *
d
)

374 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

375 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

376 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

377 
	`LTC_ARGCHK
(
d
 !ğ
NULL
);

378 
	`mpz_powm
(
d
, 
a
, 
b
, 
c
);

379  
CRYPT_OK
;

380 
	}
}

382 
	$i¥rime
(*
a
, *
b
)

384 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

385 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

386 *
b
 = 
	`mpz_´obab_´ime_p
(
a
, 8è> 0 ? 
LTC_MP_YES
 : 
LTC_MP_NO
;

387  
CRYPT_OK
;

388 
	}
}

390 cÚ¡ 
Éc_m©h_desütÜ
 
	ggmp_desc
 = {

392 (
mp_limb_t
è* 
CHAR_BIT
 - 
GMP_NAIL_BITS
,

394 &
š™
,

395 &
š™_cİy
,

396 &
deš™
,

398 &
Ãg
,

399 &
cİy
,

401 &
£t_št
,

402 &
g‘_št
,

403 &
g‘_dig™
,

404 &
g‘_dig™_couÁ
,

405 &
com·»
,

406 &
com·»_d
,

407 &
couÁ_b™s
,

408 &
couÁ_lsb_b™s
,

409 &
twÛx±
,

411 &
»ad_¿dix
,

412 &
wr™e_¿dix
,

413 &
unsigÃd_size
,

414 &
unsigÃd_wr™e
,

415 &
unsigÃd_»ad
,

417 &
add
,

418 &
addi
,

419 &
sub
,

420 &
subi
,

421 &
mul
,

422 &
muli
,

423 &
sqr
,

424 &
divide
,

425 &
div_2
,

426 &
modi
,

427 &
gcd
,

428 &
lcm
,

430 &
mulmod
,

431 &
sqrmod
,

432 &
švmod
,

434 &
mÚtgom”y_£tup
,

435 &
mÚtgom”y_nÜm®iz©iÚ
,

436 &
mÚtgom”y_»duû
,

437 &
mÚtgom”y_deš™
,

439 &
ex±mod
,

440 &
i¥rime
,

442 #ifdeà
MECC


443 #ifdeà
MECC_FP


444 &
Éc_ecc_å_mulmod
,

446 &
Éc_ecc_mulmod
,

448 &
Éc_ecc_´ojeùive_add_pošt
,

449 &
Éc_ecc_´ojeùive_dbl_pošt
,

450 &
Éc_ecc_m­
,

451 #ifdeà
LTC_ECC_SHAMIR


452 #ifdeà
MECC_FP


453 &
Éc_ecc_å_mul2add
,

455 &
Éc_ecc_mul2add
,

458 
NULL
,

461 
NULL
, NULL, NULL, NULL, NULL

464 #ifdeà
MRSA


465 &
r§_make_key
,

466 &
r§_ex±mod
,

468 
NULL
, NULL

	@libtomcrypt/src/math/ltm_desc.c

12 
	#DESC_DEF_ONLY


	)

13 
	~"tomüy±.h
"

15 #ifdeà
LTM_DESC


17 
	~<tomm©h.h
>

20 
	mmpi_code
, 
	mÉc_code
;

21 } 
	gmpi_to_Éc_codes
[] = {

22 { 
MP_OKAY
 , 
CRYPT_OK
},

23 { 
MP_MEM
 , 
CRYPT_MEM
},

24 { 
MP_VAL
 , 
CRYPT_INVALID_ARG
},

32 
	$mpi_to_Éc_”rÜ
(
”r
)

34 
x
;

36 
x
 = 0; x < ()((
mpi_to_Éc_codes
)/(mpi_to_ltc_codes[0])); x++) {

37 ià(
”r
 =ğ
mpi_to_Éc_codes
[
x
].
mpi_code
) {

38  
mpi_to_Éc_codes
[
x
].
Éc_code
;

41  
CRYPT_ERROR
;

42 
	}
}

44 
	$š™
(**
a
)

46 
”r
;

48 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

50 *
a
 = 
	`XCALLOC
(1, (
mp_št
));

51 ià(*
a
 =ğ
NULL
) {

52  
CRYPT_MEM
;

55 ià((
”r
 = 
	`mpi_to_Éc_”rÜ
(
	`mp_š™
(*
a
))è!ğ
CRYPT_OK
) {

56 
	`XFREE
(*
a
);

58  
”r
;

59 
	}
}

61 
	$deš™
(*
a
)

63 
	`LTC_ARGCHKVD
(
a
 !ğ
NULL
);

64 
	`mp_ş—r
(
a
);

65 
	`XFREE
(
a
);

66 
	}
}

68 
	$Ãg
(*
a
, *
b
)

70 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

71 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

72  
	`mpi_to_Éc_”rÜ
(
	`mp_Ãg
(
a
, 
b
));

73 
	}
}

75 
	$cİy
(*
a
, *
b
)

77 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

78 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

79  
	`mpi_to_Éc_”rÜ
(
	`mp_cİy
(
a
, 
b
));

80 
	}
}

82 
	$š™_cİy
(**
a
, *
b
)

84 ià(
	`š™
(
a
è!ğ
CRYPT_OK
) {

85  
CRYPT_MEM
;

87  
	`cİy
(
b
, *
a
);

88 
	}
}

91 
	$£t_št
(*
a
, 
b
)

93 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

94  
	`mpi_to_Éc_”rÜ
(
	`mp_£t_št
(
a
, 
b
));

95 
	}
}

97 
	$g‘_št
(*
a
)

99 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

100  
	`mp_g‘_št
(
a
);

101 
	}
}

103 
	$g‘_dig™
(*
a
, 
n
)

105 
mp_št
 *
A
;

106 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

107 
A
 = 
a
;

108  (
n
 >ğ
A
->
u£d
 ||‚ < 0è? 0 : A->
dp
[n];

109 
	}
}

111 
	$g‘_dig™_couÁ
(*
a
)

113 
mp_št
 *
A
;

114 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

115 
A
 = 
a
;

116  
A
->
u£d
;

117 
	}
}

119 
	$com·»
(*
a
, *
b
)

121 
»t
;

122 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

123 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

124 
»t
 = 
	`mp_cmp
(
a
, 
b
);

125 
»t
) {

126 
MP_LT
:  
LTC_MP_LT
;

127 
MP_EQ
:  
LTC_MP_EQ
;

128 
MP_GT
:  
LTC_MP_GT
;

131 
	}
}

133 
	$com·»_d
(*
a
, 
b
)

135 
»t
;

136 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

137 
»t
 = 
	`mp_cmp_d
(
a
, 
b
);

138 
»t
) {

139 
MP_LT
:  
LTC_MP_LT
;

140 
MP_EQ
:  
LTC_MP_EQ
;

141 
MP_GT
:  
LTC_MP_GT
;

144 
	}
}

146 
	$couÁ_b™s
(*
a
)

148 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

149  
	`mp_couÁ_b™s
(
a
);

150 
	}
}

152 
	$couÁ_lsb_b™s
(*
a
)

154 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

155  
	`mp_út_lsb
(
a
);

156 
	}
}

159 
	$twÛx±
(*
a
, 
n
)

161 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

162  
	`mpi_to_Éc_”rÜ
(
	`mp_2ex±
(
a
, 
n
));

163 
	}
}

168 
	$»ad_¿dix
(*
a
, cÚ¡ *
b
, 
¿dix
)

170 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

171 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

172  
	`mpi_to_Éc_”rÜ
(
	`mp_»ad_¿dix
(
a
, 
b
, 
¿dix
));

173 
	}
}

176 
	$wr™e_¿dix
(*
a
, *
b
, 
¿dix
)

178 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

179 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

180  
	`mpi_to_Éc_”rÜ
(
	`mp_tÜadix
(
a
, 
b
, 
¿dix
));

181 
	}
}

184 
	$unsigÃd_size
(*
a
)

186 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

187  
	`mp_unsigÃd_bš_size
(
a
);

188 
	}
}

191 
	$unsigÃd_wr™e
(*
a
, *
b
)

193 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

194 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

195  
	`mpi_to_Éc_”rÜ
(
	`mp_to_unsigÃd_bš
(
a
, 
b
));

196 
	}
}

199 
	$unsigÃd_»ad
(*
a
, *
b
, 
Ën
)

201 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

202 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

203  
	`mpi_to_Éc_”rÜ
(
	`mp_»ad_unsigÃd_bš
(
a
, 
b
, 
Ën
));

204 
	}
}

207 
	$add
(*
a
, *
b
, *
c
)

209 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

210 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

211 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

212  
	`mpi_to_Éc_”rÜ
(
	`mp_add
(
a
, 
b
, 
c
));

213 
	}
}

215 
	$addi
(*
a
, 
b
, *
c
)

217 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

218 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

219  
	`mpi_to_Éc_”rÜ
(
	`mp_add_d
(
a
, 
b
, 
c
));

220 
	}
}

223 
	$sub
(*
a
, *
b
, *
c
)

225 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

226 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

227 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

228  
	`mpi_to_Éc_”rÜ
(
	`mp_sub
(
a
, 
b
, 
c
));

229 
	}
}

231 
	$subi
(*
a
, 
b
, *
c
)

233 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

234 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

235  
	`mpi_to_Éc_”rÜ
(
	`mp_sub_d
(
a
, 
b
, 
c
));

236 
	}
}

239 
	$mul
(*
a
, *
b
, *
c
)

241 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

242 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

243 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

244  
	`mpi_to_Éc_”rÜ
(
	`mp_mul
(
a
, 
b
, 
c
));

245 
	}
}

247 
	$muli
(*
a
, 
b
, *
c
)

249 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

250 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

251  
	`mpi_to_Éc_”rÜ
(
	`mp_mul_d
(
a
, 
b
, 
c
));

252 
	}
}

255 
	$sqr
(*
a
, *
b
)

257 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

258 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

259  
	`mpi_to_Éc_”rÜ
(
	`mp_sqr
(
a
, 
b
));

260 
	}
}

263 
	$divide
(*
a
, *
b
, *
c
, *
d
)

265 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

266 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

267  
	`mpi_to_Éc_”rÜ
(
	`mp_div
(
a
, 
b
, 
c
, 
d
));

268 
	}
}

270 
	$div_2
(*
a
, *
b
)

272 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

273 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

274  
	`mpi_to_Éc_”rÜ
(
	`mp_div_2
(
a
, 
b
));

275 
	}
}

278 
	$modi
(*
a
, 
b
, *
c
)

280 
mp_dig™
 
tmp
;

281 
”r
;

283 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

284 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

286 ià((
”r
 = 
	`mpi_to_Éc_”rÜ
(
	`mp_mod_d
(
a
, 
b
, &
tmp
))è!ğ
CRYPT_OK
) {

287  
”r
;

289 *
c
 = 
tmp
;

290  
CRYPT_OK
;

291 
	}
}

294 
	$gcd
(*
a
, *
b
, *
c
)

296 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

297 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

298 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

299  
	`mpi_to_Éc_”rÜ
(
	`mp_gcd
(
a
, 
b
, 
c
));

300 
	}
}

303 
	$lcm
(*
a
, *
b
, *
c
)

305 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

306 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

307 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

308  
	`mpi_to_Éc_”rÜ
(
	`mp_lcm
(
a
, 
b
, 
c
));

309 
	}
}

311 
	$mulmod
(*
a
, *
b
, *
c
, *
d
)

313 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

314 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

315 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

316 
	`LTC_ARGCHK
(
d
 !ğ
NULL
);

317  
	`mpi_to_Éc_”rÜ
(
	`mp_mulmod
(
a
,
b
,
c
,
d
));

318 
	}
}

320 
	$sqrmod
(*
a
, *
b
, *
c
)

322 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

323 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

324 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

325  
	`mpi_to_Éc_”rÜ
(
	`mp_sqrmod
(
a
,
b
,
c
));

326 
	}
}

329 
	$švmod
(*
a
, *
b
, *
c
)

331 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

332 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

333 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

334  
	`mpi_to_Éc_”rÜ
(
	`mp_švmod
(
a
, 
b
, 
c
));

335 
	}
}

338 
	$mÚtgom”y_£tup
(*
a
, **
b
)

340 
”r
;

341 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

342 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

343 *
b
 = 
	`XCALLOC
(1, (
mp_dig™
));

344 ià(*
b
 =ğ
NULL
) {

345  
CRYPT_MEM
;

347 ià((
”r
 = 
	`mpi_to_Éc_”rÜ
(
	`mp_mÚtgom”y_£tup
(
a
, (
mp_dig™
 *)*
b
))è!ğ
CRYPT_OK
) {

348 
	`XFREE
(*
b
);

350  
”r
;

351 
	}
}

354 
	$mÚtgom”y_nÜm®iz©iÚ
(*
a
, *
b
)

356 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

357 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

358  
	`mpi_to_Éc_”rÜ
(
	`mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
(
a
, 
b
));

359 
	}
}

362 
	$mÚtgom”y_»duû
(*
a
, *
b
, *
c
)

364 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

365 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

366 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

367  
	`mpi_to_Éc_”rÜ
(
	`mp_mÚtgom”y_»duû
(
a
, 
b
, *((
mp_dig™
 *)
c
)));

368 
	}
}

371 
	$mÚtgom”y_deš™
(*
a
)

373 
	`XFREE
(
a
);

374 
	}
}

376 
	$ex±mod
(*
a
, *
b
, *
c
, *
d
)

378 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

379 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

380 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

381 
	`LTC_ARGCHK
(
d
 !ğ
NULL
);

382  
	`mpi_to_Éc_”rÜ
(
	`mp_ex±mod
(
a
,
b
,
c
,
d
));

383 
	}
}

385 
	$i¥rime
(*
a
, *
b
)

387 
”r
;

388 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

389 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

390 
”r
 = 
	`mpi_to_Éc_”rÜ
(
	`mp_´ime_is_´ime
(
a
, 8, 
b
));

391 *
b
 = (*b =ğ
MP_YES
è? 
LTC_MP_YES
 : 
LTC_MP_NO
;

392  
”r
;

393 
	}
}

395 cÚ¡ 
Éc_m©h_desütÜ
 
	gÉm_desc
 = {

398 ()
DIGIT_BIT
,

400 &
š™
,

401 &
š™_cİy
,

402 &
deš™
,

404 &
Ãg
,

405 &
cİy
,

407 &
£t_št
,

408 &
g‘_št
,

409 &
g‘_dig™
,

410 &
g‘_dig™_couÁ
,

411 &
com·»
,

412 &
com·»_d
,

413 &
couÁ_b™s
,

414 &
couÁ_lsb_b™s
,

415 &
twÛx±
,

417 &
»ad_¿dix
,

418 &
wr™e_¿dix
,

419 &
unsigÃd_size
,

420 &
unsigÃd_wr™e
,

421 &
unsigÃd_»ad
,

423 &
add
,

424 &
addi
,

425 &
sub
,

426 &
subi
,

427 &
mul
,

428 &
muli
,

429 &
sqr
,

430 &
divide
,

431 &
div_2
,

432 &
modi
,

433 &
gcd
,

434 &
lcm
,

436 &
mulmod
,

437 &
sqrmod
,

438 &
švmod
,

440 &
mÚtgom”y_£tup
,

441 &
mÚtgom”y_nÜm®iz©iÚ
,

442 &
mÚtgom”y_»duû
,

443 &
mÚtgom”y_deš™
,

445 &
ex±mod
,

446 &
i¥rime
,

448 #ifdeà
MECC


449 #ifdeà
MECC_FP


450 &
Éc_ecc_å_mulmod
,

452 &
Éc_ecc_mulmod
,

454 &
Éc_ecc_´ojeùive_add_pošt
,

455 &
Éc_ecc_´ojeùive_dbl_pošt
,

456 &
Éc_ecc_m­
,

457 #ifdeà
LTC_ECC_SHAMIR


458 #ifdeà
MECC_FP


459 &
Éc_ecc_å_mul2add
,

461 &
Éc_ecc_mul2add
,

464 
NULL
,

467 
NULL
, NULL, NULL, NULL, NULL,

470 #ifdeà
MRSA


471 &
r§_make_key
,

472 &
r§_ex±mod
,

474 
NULL
, NULL

	@libtomcrypt/src/math/multi.c

11 
	~"tomüy±.h
"

13 #ifdeà
MPI


14 
	~<¡d¬g.h
>

16 
	$Éc_š™_muÉi
(**
a
, ...)

18 **
cur
 = 
a
;

19 
Å
 = 0;

20 
va_li¡
 
¬gs
;

22 
	`va_¡¬t
(
¬gs
, 
a
);

23 
cur
 !ğ
NULL
) {

24 ià(
	`mp_š™
(
cur
è!ğ
CRYPT_OK
) {

26 
va_li¡
 
ş—n_li¡
;

28 
	`va_¡¬t
(
ş—n_li¡
, 
a
);

29 
cur
 = 
a
;

30 
Å
--) {

31 
	`mp_ş—r
(*
cur
);

32 
cur
 = 
	`va_¬g
(
ş—n_li¡
, **);

34 
	`va_’d
(
ş—n_li¡
);

35  
CRYPT_MEM
;

37 ++
Å
;

38 
cur
 = 
	`va_¬g
(
¬gs
, **);

40 
	`va_’d
(
¬gs
);

41  
CRYPT_OK
;

42 
	}
}

44 
	$Éc_deš™_muÉi
(*
a
, ...)

46 *
cur
 = 
a
;

47 
va_li¡
 
¬gs
;

49 
	`va_¡¬t
(
¬gs
, 
a
);

50 
cur
 !ğ
NULL
) {

51 
	`mp_ş—r
(
cur
);

52 
cur
 = 
	`va_¬g
(
¬gs
, *);

54 
	`va_’d
(
¬gs
);

55 
	}
}

	@libtomcrypt/src/math/rand_prime.c

11 
	~"tomüy±.h
"

18 
	#USE_BBS
 1

	)

20 
	$¿nd_´ime
(*
N
, 
Ën
, 
´ng_¡©e
 *
´ng
, 
w´ng
)

22 
”r
, 
»s
, 
ty³
;

23 *
buf
;

25 
	`LTC_ARGCHK
(
N
 !ğ
NULL
);

28 ià(
Ën
 < 0) {

29 
ty³
 = 
USE_BBS
;

30 
Ën
 = -len;

32 
ty³
 = 0;

36 ià(
Ën
 < 2 ||†en > 512) {

37  
CRYPT_INVALID_PRIME_SIZE
;

41 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

42  
”r
;

46 
buf
 = 
	`XCALLOC
(1, 
Ën
);

47 ià(
buf
 =ğ
NULL
) {

48  
CRYPT_MEM
;

53 ià(
´ng_desütÜ
[
w´ng
].
	`»ad
(
buf
, 
Ën
, 
´ng
) != ()len) {

54 
	`XFREE
(
buf
);

55  
CRYPT_ERROR_READPRNG
;

59 
buf
[0] |= 0x80 | 0x40;

60 
buf
[
Ën
-1] |ğ0x01 | ((
ty³
 & 
USE_BBS
) ? 0x02 : 0x00);

63 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
N
, 
buf
, 
Ën
)è!ğ
CRYPT_OK
) {

64 
	`XFREE
(
buf
);

65  
”r
;

69 ià((
”r
 = 
	`mp_´ime_is_´ime
(
N
, 8, &
»s
)è!ğ
CRYPT_OK
) {

70 
	`XFREE
(
buf
);

71  
”r
;

73 } 
»s
 =ğ
LTC_MP_NO
);

75 #ifdeà
LTC_CLEAN_STACK


76 
	`z”omem
(
buf
, 
Ën
);

79 
	`XFREE
(
buf
);

80  
CRYPT_OK
;

81 
	}
}

	@libtomcrypt/src/math/tfm_desc.c

12 
	#DESC_DEF_ONLY


	)

13 
	~"tomüy±.h
"

15 #ifdeà
TFM_DESC


17 
	~<tfm.h
>

20 
	mtfm_code
, 
	mÉc_code
;

21 } 
	gtfm_to_Éc_codes
[] = {

22 { 
FP_OKAY
 , 
CRYPT_OK
},

23 { 
FP_MEM
 , 
CRYPT_MEM
},

24 { 
FP_VAL
 , 
CRYPT_INVALID_ARG
},

32 
	$tfm_to_Éc_”rÜ
(
”r
)

34 
x
;

36 
x
 = 0; x < ()((
tfm_to_Éc_codes
)/(tfm_to_ltc_codes[0])); x++) {

37 ià(
”r
 =ğ
tfm_to_Éc_codes
[
x
].
tfm_code
) {

38  
tfm_to_Éc_codes
[
x
].
Éc_code
;

41  
CRYPT_ERROR
;

42 
	}
}

44 
	$š™
(**
a
)

46 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

48 *
a
 = 
	`XCALLOC
(1, (
å_št
));

49 ià(*
a
 =ğ
NULL
) {

50  
CRYPT_MEM
;

52 
	`å_š™
(*
a
);

53  
CRYPT_OK
;

54 
	}
}

56 
	$deš™
(*
a
)

58 
	`LTC_ARGCHKVD
(
a
 !ğ
NULL
);

59 
	`XFREE
(
a
);

60 
	}
}

62 
	$Ãg
(*
a
, *
b
)

64 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

65 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

66 
	`å_Ãg
(((
å_št
*)
a
), ((å_št*)
b
));

67  
CRYPT_OK
;

68 
	}
}

70 
	$cİy
(*
a
, *
b
)

72 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

73 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

74 
	`å_cİy
(
a
, 
b
);

75  
CRYPT_OK
;

76 
	}
}

78 
	$š™_cİy
(**
a
, *
b
)

80 ià(
	`š™
(
a
è!ğ
CRYPT_OK
) {

81  
CRYPT_MEM
;

83  
	`cİy
(
b
, *
a
);

84 
	}
}

87 
	$£t_št
(*
a
, 
b
)

89 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

90 
	`å_£t
(
a
, 
b
);

91  
CRYPT_OK
;

92 
	}
}

94 
	$g‘_št
(*
a
)

96 
å_št
 *
A
;

97 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

98 
A
 = 
a
;

99  
A
->
u£d
 > 0 ? A->
dp
[0] : 0;

100 
	}
}

102 
	$g‘_dig™
(*
a
, 
n
)

104 
å_št
 *
A
;

105 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

106 
A
 = 
a
;

107  (
n
 >ğ
A
->
u£d
 ||‚ < 0è? 0 : A->
dp
[n];

108 
	}
}

110 
	$g‘_dig™_couÁ
(*
a
)

112 
å_št
 *
A
;

113 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

114 
A
 = 
a
;

115  
A
->
u£d
;

116 
	}
}

118 
	$com·»
(*
a
, *
b
)

120 
»t
;

121 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

122 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

123 
»t
 = 
	`å_cmp
(
a
, 
b
);

124 
»t
) {

125 
FP_LT
:  
LTC_MP_LT
;

126 
FP_EQ
:  
LTC_MP_EQ
;

127 
FP_GT
:  
LTC_MP_GT
;

130 
	}
}

132 
	$com·»_d
(*
a
, 
b
)

134 
»t
;

135 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

136 
»t
 = 
	`å_cmp_d
(
a
, 
b
);

137 
»t
) {

138 
FP_LT
:  
LTC_MP_LT
;

139 
FP_EQ
:  
LTC_MP_EQ
;

140 
FP_GT
:  
LTC_MP_GT
;

143 
	}
}

145 
	$couÁ_b™s
(*
a
)

147 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

148  
	`å_couÁ_b™s
(
a
);

149 
	}
}

151 
	$couÁ_lsb_b™s
(*
a
)

153 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

154  
	`å_út_lsb
(
a
);

155 
	}
}

157 
	$twÛx±
(*
a
, 
n
)

159 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

160 
	`å_2ex±
(
a
, 
n
);

161  
CRYPT_OK
;

162 
	}
}

167 
	$»ad_¿dix
(*
a
, cÚ¡ *
b
, 
¿dix
)

169 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

170 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

171  
	`tfm_to_Éc_”rÜ
(
	`å_»ad_¿dix
(
a
, (*)
b
, 
¿dix
));

172 
	}
}

175 
	$wr™e_¿dix
(*
a
, *
b
, 
¿dix
)

177 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

178 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

179  
	`tfm_to_Éc_”rÜ
(
	`å_tÜadix
(
a
, 
b
, 
¿dix
));

180 
	}
}

183 
	$unsigÃd_size
(*
a
)

185 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

186  
	`å_unsigÃd_bš_size
(
a
);

187 
	}
}

190 
	$unsigÃd_wr™e
(*
a
, *
b
)

192 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

193 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

194 
	`å_to_unsigÃd_bš
(
a
, 
b
);

195  
CRYPT_OK
;

196 
	}
}

199 
	$unsigÃd_»ad
(*
a
, *
b
, 
Ën
)

201 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

202 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

203 
	`å_»ad_unsigÃd_bš
(
a
, 
b
, 
Ën
);

204  
CRYPT_OK
;

205 
	}
}

208 
	$add
(*
a
, *
b
, *
c
)

210 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

211 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

212 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

213 
	`å_add
(
a
, 
b
, 
c
);

214  
CRYPT_OK
;

215 
	}
}

217 
	$addi
(*
a
, 
b
, *
c
)

219 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

220 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

221 
	`å_add_d
(
a
, 
b
, 
c
);

222  
CRYPT_OK
;

223 
	}
}

226 
	$sub
(*
a
, *
b
, *
c
)

228 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

229 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

230 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

231 
	`å_sub
(
a
, 
b
, 
c
);

232  
CRYPT_OK
;

233 
	}
}

235 
	$subi
(*
a
, 
b
, *
c
)

237 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

238 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

239 
	`å_sub_d
(
a
, 
b
, 
c
);

240  
CRYPT_OK
;

241 
	}
}

244 
	$mul
(*
a
, *
b
, *
c
)

246 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

247 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

248 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

249 
	`å_mul
(
a
, 
b
, 
c
);

250  
CRYPT_OK
;

251 
	}
}

253 
	$muli
(*
a
, 
b
, *
c
)

255 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

256 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

257 
	`å_mul_d
(
a
, 
b
, 
c
);

258  
CRYPT_OK
;

259 
	}
}

262 
	$sqr
(*
a
, *
b
)

264 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

265 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

266 
	`å_sqr
(
a
, 
b
);

267  
CRYPT_OK
;

268 
	}
}

271 
	$divide
(*
a
, *
b
, *
c
, *
d
)

273 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

274 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

275  
	`tfm_to_Éc_”rÜ
(
	`å_div
(
a
, 
b
, 
c
, 
d
));

276 
	}
}

278 
	$div_2
(*
a
, *
b
)

280 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

281 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

282 
	`å_div_2
(
a
, 
b
);

283  
CRYPT_OK
;

284 
	}
}

287 
	$modi
(*
a
, 
b
, *
c
)

289 
å_dig™
 
tmp
;

290 
”r
;

292 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

293 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

295 ià((
”r
 = 
	`tfm_to_Éc_”rÜ
(
	`å_mod_d
(
a
, 
b
, &
tmp
))è!ğ
CRYPT_OK
) {

296  
”r
;

298 *
c
 = 
tmp
;

299  
CRYPT_OK
;

300 
	}
}

303 
	$gcd
(*
a
, *
b
, *
c
)

305 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

306 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

307 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

308 
	`å_gcd
(
a
, 
b
, 
c
);

309  
CRYPT_OK
;

310 
	}
}

313 
	$lcm
(*
a
, *
b
, *
c
)

315 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

316 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

317 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

318 
	`å_lcm
(
a
, 
b
, 
c
);

319  
CRYPT_OK
;

320 
	}
}

322 
	$mulmod
(*
a
, *
b
, *
c
, *
d
)

324 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

325 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

326 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

327 
	`LTC_ARGCHK
(
d
 !ğ
NULL
);

328  
	`tfm_to_Éc_”rÜ
(
	`å_mulmod
(
a
,
b
,
c
,
d
));

329 
	}
}

331 
	$sqrmod
(*
a
, *
b
, *
c
)

333 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

334 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

335 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

336  
	`tfm_to_Éc_”rÜ
(
	`å_sqrmod
(
a
,
b
,
c
));

337 
	}
}

340 
	$švmod
(*
a
, *
b
, *
c
)

342 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

343 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

344 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

345  
	`tfm_to_Éc_”rÜ
(
	`å_švmod
(
a
, 
b
, 
c
));

346 
	}
}

349 
	$mÚtgom”y_£tup
(*
a
, **
b
)

351 
”r
;

352 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

353 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

354 *
b
 = 
	`XCALLOC
(1, (
å_dig™
));

355 ià(*
b
 =ğ
NULL
) {

356  
CRYPT_MEM
;

358 ià((
”r
 = 
	`tfm_to_Éc_”rÜ
(
	`å_mÚtgom”y_£tup
(
a
, (
å_dig™
 *)*
b
))è!ğ
CRYPT_OK
) {

359 
	`XFREE
(*
b
);

361  
”r
;

362 
	}
}

365 
	$mÚtgom”y_nÜm®iz©iÚ
(*
a
, *
b
)

367 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

368 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

369 
	`å_mÚtgom”y_ÿlc_nÜm®iz©iÚ
(
a
, 
b
);

370  
CRYPT_OK
;

371 
	}
}

374 
	$mÚtgom”y_»duû
(*
a
, *
b
, *
c
)

376 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

377 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

378 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

379 
	`å_mÚtgom”y_»duû
(
a
, 
b
, *((
å_dig™
 *)
c
));

380  
CRYPT_OK
;

381 
	}
}

384 
	$mÚtgom”y_deš™
(*
a
)

386 
	`XFREE
(
a
);

387 
	}
}

389 
	$ex±mod
(*
a
, *
b
, *
c
, *
d
)

391 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

392 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

393 
	`LTC_ARGCHK
(
c
 !ğ
NULL
);

394 
	`LTC_ARGCHK
(
d
 !ğ
NULL
);

395  
	`tfm_to_Éc_”rÜ
(
	`å_ex±mod
(
a
,
b
,
c
,
d
));

396 
	}
}

398 
	$i¥rime
(*
a
, *
b
)

400 
	`LTC_ARGCHK
(
a
 !ğ
NULL
);

401 
	`LTC_ARGCHK
(
b
 !ğ
NULL
);

402 *
b
 = (
	`å_i¥rime
(
a
è=ğ
FP_YES
è? 
LTC_MP_YES
 : 
LTC_MP_NO
;

403  
CRYPT_OK
;

404 
	}
}

406 #ià
defšed
(
MECC
è&& defšed(
MECC_ACCEL
)

408 
	$tfm_ecc_´ojeùive_dbl_pošt
(
ecc_pošt
 *
P
,ƒcc_pošˆ*
R
, *
modulus
, *
Mp
)

410 
å_št
 
t1
, 
t2
;

411 
å_dig™
 
mp
;

413 
	`LTC_ARGCHK
(
P
 !ğ
NULL
);

414 
	`LTC_ARGCHK
(
R
 !ğ
NULL
);

415 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

416 
	`LTC_ARGCHK
(
Mp
 !ğ
NULL
);

418 
mp
 = *((
å_dig™
*)
Mp
);

420 
	`å_š™
(&
t1
);

421 
	`å_š™
(&
t2
);

423 ià(
P
 !ğ
R
) {

424 
	`å_cİy
(
P
->
x
, 
R
->x);

425 
	`å_cİy
(
P
->
y
, 
R
->y);

426 
	`å_cİy
(
P
->
z
, 
R
->z);

430 
	`å_sqr
(
R
->
z
, &
t1
);

431 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

433 
	`å_mul
(
R
->
z
, R->
y
, R->z);

434 
	`å_mÚtgom”y_»duû
(
R
->
z
, 
modulus
, 
mp
);

436 
	`å_add
(
R
->
z
, R->z, R->z);

437 ià(
	`å_cmp
(
R
->
z
, 
modulus
è!ğ
FP_LT
) {

438 
	`å_sub
(
R
->
z
, 
modulus
, R->z);

442 
	`å_sub
(
R
->
x
, &
t1
, &
t2
);

443 ià(
	`å_cmp_d
(&
t2
, 0è=ğ
FP_LT
) {

444 
	`å_add
(&
t2
, 
modulus
, &t2);

447 
	`å_add
(&
t1
, 
R
->
x
, &t1);

448 ià(
	`å_cmp
(&
t1
, 
modulus
è!ğ
FP_LT
) {

449 
	`å_sub
(&
t1
, 
modulus
, &t1);

452 
	`å_mul
(&
t1
, &
t2
, &t2);

453 
	`å_mÚtgom”y_»duû
(&
t2
, 
modulus
, 
mp
);

455 
	`å_add
(&
t2
, &t2, &
t1
);

456 ià(
	`å_cmp
(&
t1
, 
modulus
è!ğ
FP_LT
) {

457 
	`å_sub
(&
t1
, 
modulus
, &t1);

460 
	`å_add
(&
t1
, &
t2
, &t1);

461 ià(
	`å_cmp
(&
t1
, 
modulus
è!ğ
FP_LT
) {

462 
	`å_sub
(&
t1
, 
modulus
, &t1);

466 
	`å_add
(
R
->
y
, R->y, R->y);

467 ià(
	`å_cmp
(
R
->
y
, 
modulus
è!ğ
FP_LT
) {

468 
	`å_sub
(
R
->
y
, 
modulus
, R->y);

471 
	`å_sqr
(
R
->
y
, R->y);

472 
	`å_mÚtgom”y_»duû
(
R
->
y
, 
modulus
, 
mp
);

474 
	`å_sqr
(
R
->
y
, &
t2
);

475 
	`å_mÚtgom”y_»duû
(&
t2
, 
modulus
, 
mp
);

477 ià(
	`å_isodd
(&
t2
)) {

478 
	`å_add
(&
t2
, 
modulus
, &t2);

480 
	`å_div_2
(&
t2
, &t2);

482 
	`å_mul
(
R
->
y
, R->
x
, R->y);

483 
	`å_mÚtgom”y_»duû
(
R
->
y
, 
modulus
, 
mp
);

486 
	`å_sqr
(&
t1
, 
R
->
x
);

487 
	`å_mÚtgom”y_»duû
(
R
->
x
, 
modulus
, 
mp
);

489 
	`å_sub
(
R
->
x
, R->
y
, R->x);

490 ià(
	`å_cmp_d
(
R
->
x
, 0è=ğ
FP_LT
) {

491 
	`å_add
(
R
->
x
, 
modulus
, R->x);

494 
	`å_sub
(
R
->
x
, R->
y
, R->x);

495 ià(
	`å_cmp_d
(
R
->
x
, 0è=ğ
FP_LT
) {

496 
	`å_add
(
R
->
x
, 
modulus
, R->x);

500 
	`å_sub
(
R
->
y
, R->
x
, R->y);

501 ià(
	`å_cmp_d
(
R
->
y
, 0è=ğ
FP_LT
) {

502 
	`å_add
(
R
->
y
, 
modulus
, R->y);

505 
	`å_mul
(
R
->
y
, &
t1
, R->y);

506 
	`å_mÚtgom”y_»duû
(
R
->
y
, 
modulus
, 
mp
);

508 
	`å_sub
(
R
->
y
, &
t2
, R->y);

509 ià(
	`å_cmp_d
(
R
->
y
, 0è=ğ
FP_LT
) {

510 
	`å_add
(
R
->
y
, 
modulus
, R->y);

513  
CRYPT_OK
;

514 
	}
}

525 
	$tfm_ecc_´ojeùive_add_pošt
(
ecc_pošt
 *
P
,ƒcc_pošˆ*
Q
,ƒcc_pošˆ*
R
, *
modulus
, *
Mp
)

527 
å_št
 
t1
, 
t2
, 
x
, 
y
, 
z
;

528 
å_dig™
 
mp
;

530 
	`LTC_ARGCHK
(
P
 !ğ
NULL
);

531 
	`LTC_ARGCHK
(
Q
 !ğ
NULL
);

532 
	`LTC_ARGCHK
(
R
 !ğ
NULL
);

533 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

534 
	`LTC_ARGCHK
(
Mp
 !ğ
NULL
);

536 
mp
 = *((
å_dig™
*)
Mp
);

538 
	`å_š™
(&
t1
);

539 
	`å_š™
(&
t2
);

540 
	`å_š™
(&
x
);

541 
	`å_š™
(&
y
);

542 
	`å_š™
(&
z
);

545 
	`å_sub
(
modulus
, 
Q
->
y
, &
t1
);

546 iàĞ(
	`å_cmp
(
P
->
x
, 
Q
->xè=ğ
FP_EQ
) &&

547 (
Q
->
z
 !ğ
NULL
 && 
	`å_cmp
(
P
->z, Q->zè=ğ
FP_EQ
) &&

548 (
	`å_cmp
(
P
->
y
, 
Q
->yè=ğ
FP_EQ
 || fp_cmp(P->y, &
t1
) == FP_EQ)) {

549  
	`tfm_ecc_´ojeùive_dbl_pošt
(
P
, 
R
, 
modulus
, 
Mp
);

552 
	`å_cİy
(
P
->
x
, &x);

553 
	`å_cİy
(
P
->
y
, &y);

554 
	`å_cİy
(
P
->
z
, &z);

557 ià(
Q
->
z
 !ğ
NULL
) {

559 
	`å_sqr
(
Q
->
z
, &
t1
);

560 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

562 
	`å_mul
(&
t1
, &
x
, &x);

563 
	`å_mÚtgom”y_»duû
(&
x
, 
modulus
, 
mp
);

565 
	`å_mul
(
Q
->
z
, &
t1
, &t1);

566 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

568 
	`å_mul
(&
t1
, &
y
, &y);

569 
	`å_mÚtgom”y_»duû
(&
y
, 
modulus
, 
mp
);

573 
	`å_sqr
(&
z
, &
t1
);

574 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

576 
	`å_mul
(
Q
->
x
, &
t1
, &
t2
);

577 
	`å_mÚtgom”y_»duû
(&
t2
, 
modulus
, 
mp
);

579 
	`å_mul
(&
z
, &
t1
, &t1);

580 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

582 
	`å_mul
(
Q
->
y
, &
t1
, &t1);

583 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

586 
	`å_sub
(&
y
, &
t1
, &y);

587 ià(
	`å_cmp_d
(&
y
, 0è=ğ
FP_LT
) {

588 
	`å_add
(&
y
, 
modulus
, &y);

591 
	`å_add
(&
t1
, &t1, &t1);

592 ià(
	`å_cmp
(&
t1
, 
modulus
è!ğ
FP_LT
) {

593 
	`å_sub
(&
t1
, 
modulus
, &t1);

596 
	`å_add
(&
t1
, &
y
, &t1);

597 ià(
	`å_cmp
(&
t1
, 
modulus
è!ğ
FP_LT
) {

598 
	`å_sub
(&
t1
, 
modulus
, &t1);

601 
	`å_sub
(&
x
, &
t2
, &x);

602 ià(
	`å_cmp_d
(&
x
, 0è=ğ
FP_LT
) {

603 
	`å_add
(&
x
, 
modulus
, &x);

606 
	`å_add
(&
t2
, &t2, &t2);

607 ià(
	`å_cmp
(&
t2
, 
modulus
è!ğ
FP_LT
) {

608 
	`å_sub
(&
t2
, 
modulus
, &t2);

611 
	`å_add
(&
t2
, &
x
, &t2);

612 ià(
	`å_cmp
(&
t2
, 
modulus
è!ğ
FP_LT
) {

613 
	`å_sub
(&
t2
, 
modulus
, &t2);

617 ià(
Q
->
z
 !ğ
NULL
) {

619 
	`å_mul
(&
z
, 
Q
->z, &z);

620 
	`å_mÚtgom”y_»duû
(&
z
, 
modulus
, 
mp
);

624 
	`å_mul
(&
z
, &
x
, &z);

625 
	`å_mÚtgom”y_»duû
(&
z
, 
modulus
, 
mp
);

628 
	`å_mul
(&
t1
, &
x
, &t1);

629 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

631 
	`å_sqr
(&
x
, &x);

632 
	`å_mÚtgom”y_»duû
(&
x
, 
modulus
, 
mp
);

634 
	`å_mul
(&
t2
, &
x
, &t2);

635 
	`å_mÚtgom”y_»duû
(&
t2
, 
modulus
, 
mp
);

637 
	`å_mul
(&
t1
, &
x
, &t1);

638 
	`å_mÚtgom”y_»duû
(&
t1
, 
modulus
, 
mp
);

641 
	`å_sqr
(&
y
, &
x
);

642 
	`å_mÚtgom”y_»duû
(&
x
, 
modulus
, 
mp
);

644 
	`å_sub
(&
x
, &
t2
, &x);

645 ià(
	`å_cmp_d
(&
x
, 0è=ğ
FP_LT
) {

646 
	`å_add
(&
x
, 
modulus
, &x);

650 
	`å_sub
(&
t2
, &
x
, &t2);

651 ià(
	`å_cmp_d
(&
t2
, 0è=ğ
FP_LT
) {

652 
	`å_add
(&
t2
, 
modulus
, &t2);

655 
	`å_sub
(&
t2
, &
x
, &t2);

656 ià(
	`å_cmp_d
(&
t2
, 0è=ğ
FP_LT
) {

657 
	`å_add
(&
t2
, 
modulus
, &t2);

660 
	`å_mul
(&
t2
, &
y
, &t2);

661 
	`å_mÚtgom”y_»duû
(&
t2
, 
modulus
, 
mp
);

663 
	`å_sub
(&
t2
, &
t1
, &
y
);

664 ià(
	`å_cmp_d
(&
y
, 0è=ğ
FP_LT
) {

665 
	`å_add
(&
y
, 
modulus
, &y);

668 ià(
	`å_isodd
(&
y
)) {

669 
	`å_add
(&
y
, 
modulus
, &y);

671 
	`å_div_2
(&
y
, &y);

673 
	`å_cİy
(&
x
, 
R
->x);

674 
	`å_cİy
(&
y
, 
R
->y);

675 
	`å_cİy
(&
z
, 
R
->z);

677  
CRYPT_OK
;

678 
	}
}

683 cÚ¡ 
Éc_m©h_desütÜ
 
	gtfm_desc
 = {

686 ()
DIGIT_BIT
,

688 &
š™
,

689 &
š™_cİy
,

690 &
deš™
,

692 &
Ãg
,

693 &
cİy
,

695 &
£t_št
,

696 &
g‘_št
,

697 &
g‘_dig™
,

698 &
g‘_dig™_couÁ
,

699 &
com·»
,

700 &
com·»_d
,

701 &
couÁ_b™s
,

702 &
couÁ_lsb_b™s
,

703 &
twÛx±
,

705 &
»ad_¿dix
,

706 &
wr™e_¿dix
,

707 &
unsigÃd_size
,

708 &
unsigÃd_wr™e
,

709 &
unsigÃd_»ad
,

711 &
add
,

712 &
addi
,

713 &
sub
,

714 &
subi
,

715 &
mul
,

716 &
muli
,

717 &
sqr
,

718 &
divide
,

719 &
div_2
,

720 &
modi
,

721 &
gcd
,

722 &
lcm
,

724 &
mulmod
,

725 &
sqrmod
,

726 &
švmod
,

728 &
mÚtgom”y_£tup
,

729 &
mÚtgom”y_nÜm®iz©iÚ
,

730 &
mÚtgom”y_»duû
,

731 &
mÚtgom”y_deš™
,

733 &
ex±mod
,

734 &
i¥rime
,

736 #ifdeà
MECC


737 #ifdeà
MECC_FP


738 &
Éc_ecc_å_mulmod
,

740 &
Éc_ecc_mulmod
,

742 #ifdeà
MECC_ACCEL


743 &
tfm_ecc_´ojeùive_add_pošt
,

744 &
tfm_ecc_´ojeùive_dbl_pošt
,

746 &
Éc_ecc_´ojeùive_add_pošt
,

747 &
Éc_ecc_´ojeùive_dbl_pošt
,

749 &
Éc_ecc_m­
,

750 #ifdeà
LTC_ECC_SHAMIR


751 #ifdeà
MECC_FP


752 &
Éc_ecc_å_mul2add
,

754 &
Éc_ecc_mul2add
,

757 
NULL
,

760 
NULL
, NULL, NULL, NULL, NULL,

763 #ifdeà
MRSA


764 &
r§_make_key
,

765 &
r§_ex±mod
,

767 
NULL
, NULL

	@libtomcrypt/src/misc/base64/base64_decode.c

11 
	~"tomüy±.h
"

19 #ifdeà
BASE64


21 cÚ¡ 
	gm­
[256] = {

53 
	$ba£64_decode
(cÚ¡ *
š
, 
šËn
,

54 *
out
, *
ou’
)

56 
t
, 
x
, 
y
, 
z
;

57 
c
;

58 
g
;

60 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

61 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

62 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

64 
g
 = 3;

65 
x
 = 
y
 = 
z
 = 
t
 = 0; x < 
šËn
; x++) {

66 
c
 = 
m­
[
š
[
x
]&0xFF];

67 ià(
c
 == 255) ;

69 ià(
c
 == 254) {

70 
c
 = 0;

72 ià(--
g
 < 0) {

73  
CRYPT_INVALID_PACKET
;

75 } ià(
g
 != 3) {

77  
CRYPT_INVALID_PACKET
;

80 
t
 = (t<<6)|
c
;

82 ià(++
y
 == 4) {

83 ià(
z
 + 
g
 > *
ou’
) {

84  
CRYPT_BUFFER_OVERFLOW
;

86 
out
[
z
++] = ()((
t
>>16)&255);

87 ià(
g
 > 1è
out
[
z
++] = ()((
t
>>8)&255);

88 ià(
g
 > 2è
out
[
z
++] = ()(
t
&255);

89 
y
 = 
t
 = 0;

92 ià(
y
 != 0) {

93  
CRYPT_INVALID_PACKET
;

95 *
ou’
 = 
z
;

96  
CRYPT_OK
;

97 
	}
}

	@libtomcrypt/src/misc/base64/base64_encode.c

11 
	~"tomüy±.h
"

19 #ifdeà
BASE64


21 cÚ¡ *
	gcodes
 =

32 
	$ba£64_’code
(cÚ¡ *
š
, 
šËn
,

33 *
out
, *
ou’
)

35 
i
, 
Ën2
, 
Ëv’
;

36 *
p
;

38 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

43 
Ën2
 = 4 * ((
šËn
 + 2) / 3);

44 ià(*
ou’
 < 
Ën2
 + 1) {

45 *
ou’
 = 
Ën2
 + 1;

46  
CRYPT_BUFFER_OVERFLOW
;

48 
p
 = 
out
;

49 
Ëv’
 = 3*(
šËn
 / 3);

50 
i
 = 0; i < 
Ëv’
; i += 3) {

51 *
p
++ = 
codes
[(
š
[0] >> 2) & 0x3F];

52 *
p
++ = 
codes
[(((
š
[0] & 3) << 4) + (in[1] >> 4)) & 0x3F];

53 *
p
++ = 
codes
[(((
š
[1] & 0xf) << 2) + (in[2] >> 6)) & 0x3F];

54 *
p
++ = 
codes
[
š
[2] & 0x3F];

55 
š
 += 3;

58 ià(
i
 < 
šËn
) {

59 
a
 = 
š
[0];

60 
b
 = (
i
+1 < 
šËn
è? 
š
[1] : 0;

62 *
p
++ = 
codes
[(
a
 >> 2) & 0x3F];

63 *
p
++ = 
codes
[(((
a
 & 3è<< 4è+ (
b
 >> 4)) & 0x3F];

64 *
p
++ = (
i
+1 < 
šËn
è? 
codes
[(((
b
 & 0xf) << 2)) & 0x3F] : '=';

65 *
p
++ = '=';

69 *
p
 = '\0';

72 *
ou’
 = 
p
 - 
out
;

73  
CRYPT_OK
;

74 
	}
}

	@libtomcrypt/src/misc/burn_stack.c

11 
	~"tomüy±.h
"

22 
	$buº_¡ack
(
Ën
)

24 
buf
[32];

25 
	`z”omem
(
buf
, (buf));

26 ià(
Ën
 > ()(
buf
))

27 
	`buº_¡ack
(
Ën
 - (
buf
));

28 
	}
}

	@libtomcrypt/src/misc/crypt/crypt.c

11 
	~"tomüy±.h
"

	@libtomcrypt/src/misc/crypt/crypt_argchk.c

11 
	~"tomüy±.h
"

12 
	~<sigÇl.h
>

19 #ià(
ARGTYPE
 == 0)

20 
	$üy±_¬gchk
(*
v
, *
s
, 
d
)

22 
	`årštf
(
¡d”r
, "LTC_ARGCHK '%s' failure on†ine %d of file %s\n",

23 
v
, 
d
, 
s
);

24 ()
	`¿i£
(
SIGABRT
);

25 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_cipher_descriptor.c

11 
	~"tomüy±.h
"

18 
Éc_ch”_desütÜ
 
	gch”_desütÜ
[
TAB_SIZE
] = {

19 { 
NULL
, 0, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL }

22 
LTC_MUTEX_GLOBAL
(
Éc_ch”_mu‹x
)

	@libtomcrypt/src/misc/crypt/crypt_cipher_is_valid.c

11 
	~"tomüy±.h
"

23 
	$ch”_is_v®id
(
idx
)

25 
	`LTC_MUTEX_LOCK
(&
Éc_ch”_mu‹x
);

26 ià(
idx
 < 0 || idx >ğ
TAB_SIZE
 || 
ch”_desütÜ
[idx].
Çme
 =ğ
NULL
) {

27 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

28  
CRYPT_INVALID_CIPHER
;

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

31  
CRYPT_OK
;

32 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_cipher.c

11 
	~"tomüy±.h
"

23 
	$fšd_ch”
(cÚ¡ *
Çme
)

25 
x
;

26 
	`LTC_ARGCHK
(
Çme
 !ğ
NULL
);

27 
	`LTC_MUTEX_LOCK
(&
Éc_ch”_mu‹x
);

28 
x
 = 0; x < 
TAB_SIZE
; x++) {

29 ià(
ch”_desütÜ
[
x
].
Çme
 !ğ
NULL
 && !
	`XSTRCMP
(cipher_descriptor[x].name,‚ame)) {

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

31  
x
;

34 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

36 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_cipher_any.c

11 
	~"tomüy±.h
"

25 
	$fšd_ch”_ªy
(cÚ¡ *
Çme
, 
blockËn
, 
keyËn
)

27 
x
;

29 
	`LTC_ARGCHK
(
Çme
 !ğ
NULL
);

31 
x
 = 
	`fšd_ch”
(
Çme
);

32 ià(
x
 != -1)  x;

34 
	`LTC_MUTEX_LOCK
(&
Éc_ch”_mu‹x
);

35 
x
 = 0; x < 
TAB_SIZE
; x++) {

36 ià(
ch”_desütÜ
[
x
].
Çme
 =ğ
NULL
) {

39 ià(
blockËn
 <ğ()
ch”_desütÜ
[
x
].
block_Ëngth
 && 
keyËn
 <ğ()ch”_desütÜ[x].
max_key_Ëngth
) {

40 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

41  
x
;

44 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

46 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_cipher_id.c

11 
	~"tomüy±.h
"

23 
	$fšd_ch”_id
(
ID
)

25 
x
;

26 
	`LTC_MUTEX_LOCK
(&
Éc_ch”_mu‹x
);

27 
x
 = 0; x < 
TAB_SIZE
; x++) {

28 ià(
ch”_desütÜ
[
x
].
ID
 == ID) {

29 
x
 = (
ch”_desütÜ
[x].
Çme
 =ğ
NULL
) ? -1 : x;

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

31  
x
;

34 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

36 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_hash.c

11 
	~"tomüy±.h
"

23 
	$fšd_hash
(cÚ¡ *
Çme
)

25 
x
;

26 
	`LTC_ARGCHK
(
Çme
 !ğ
NULL
);

27 
	`LTC_MUTEX_LOCK
(&
Éc_hash_mu‹x
);

28 
x
 = 0; x < 
TAB_SIZE
; x++) {

29 ià(
hash_desütÜ
[
x
].
Çme
 !ğ
NULL
 && 
	`XSTRCMP
(hash_descriptor[x].name,‚ame) == 0) {

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

31  
x
;

34 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

36 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_hash_any.c

11 
	~"tomüy±.h
"

23  
	$fšd_hash_ªy
(cÚ¡ *
Çme
, 
dige¡Ën
)

25 
x
, 
y
, 
z
;

26 
	`LTC_ARGCHK
(
Çme
 !ğ
NULL
);

28 
x
 = 
	`fšd_hash
(
Çme
);

29 ià(
x
 != -1)  x;

31 
	`LTC_MUTEX_LOCK
(&
Éc_hash_mu‹x
);

32 
y
 = 
MAXBLOCKSIZE
+1;

33 
z
 = -1;

34 
x
 = 0; x < 
TAB_SIZE
; x++) {

35 ià(
hash_desütÜ
[
x
].
Çme
 =ğ
NULL
) {

38 ià(()
hash_desütÜ
[
x
].
hashsize
 >ğ
dige¡Ën
 && ()hash_desütÜ[x].hashsiz< 
y
) {

39 
z
 = 
x
;

40 
y
 = 
hash_desütÜ
[
x
].
hashsize
;

43 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

44  
z
;

45 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_hash_id.c

11 
	~"tomüy±.h
"

23 
	$fšd_hash_id
(
ID
)

25 
x
;

26 
	`LTC_MUTEX_LOCK
(&
Éc_hash_mu‹x
);

27 
x
 = 0; x < 
TAB_SIZE
; x++) {

28 ià(
hash_desütÜ
[
x
].
ID
 == ID) {

29 
x
 = (
hash_desütÜ
[x].
Çme
 =ğ
NULL
) ? -1 : x;

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

31  
x
;

34 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

36 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_hash_oid.c

11 
	~"tomüy±.h
"

18 
	$fšd_hash_oid
(cÚ¡ *
ID
, 
IDËn
)

20 
x
;

21 
	`LTC_ARGCHK
(
ID
 !ğ
NULL
);

22 
	`LTC_MUTEX_LOCK
(&
Éc_hash_mu‹x
);

23 
x
 = 0; x < 
TAB_SIZE
; x++) {

24 ià(
hash_desütÜ
[
x
].
Çme
 !ğ
NULL
 && hash_desütÜ[x].
OIDËn
 =ğ
IDËn
 && !
	`XMEMCMP
(hash_desütÜ[x].
OID
, 
ID
, () * IDlen)) {

25 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

26  
x
;

29 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

31 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_find_prng.c

11 
	~"tomüy±.h
"

23 
	$fšd_´ng
(cÚ¡ *
Çme
)

25 
x
;

26 
	`LTC_ARGCHK
(
Çme
 !ğ
NULL
);

27 
	`LTC_MUTEX_LOCK
(&
Éc_´ng_mu‹x
);

28 
x
 = 0; x < 
TAB_SIZE
; x++) {

29 ià((
´ng_desütÜ
[
x
].
Çme
 !ğ
NULL
è&& 
	`XSTRCMP
(prng_descriptor[x].name,‚ame) == 0) {

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

31  
x
;

34 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

36 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_fsa.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

20 
	$üy±_f§
(*
mp
, ...)

22 
”r
;

23 
va_li¡
 
¬gs
;

24 *
p
;

26 
	`va_¡¬t
(
¬gs
, 
mp
);

27 ià(
mp
 !ğ
NULL
) {

28 
	`XMEMCPY
(&
Éc_mp
, 
mp
, (ltc_mp));

31 (
p
 = 
	`va_¬g
(
¬gs
, *)è!ğ
NULL
) {

32 ià((
”r
 = 
	`»gi¡”_ch”
(
p
)è!ğ
CRYPT_OK
) {

33 
	`va_’d
(
¬gs
);

34  
”r
;

38 (
p
 = 
	`va_¬g
(
¬gs
, *)è!ğ
NULL
) {

39 ià((
”r
 = 
	`»gi¡”_hash
(
p
)è!ğ
CRYPT_OK
) {

40 
	`va_’d
(
¬gs
);

41  
”r
;

45 (
p
 = 
	`va_¬g
(
¬gs
, *)è!ğ
NULL
) {

46 ià((
”r
 = 
	`»gi¡”_´ng
(
p
)è!ğ
CRYPT_OK
) {

47 
	`va_’d
(
¬gs
);

48  
”r
;

52 
	`va_’d
(
¬gs
);

53  
CRYPT_OK
;

54 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_hash_descriptor.c

11 
	~"tomüy±.h
"

18 
Éc_hash_desütÜ
 
	ghash_desütÜ
[
TAB_SIZE
] = {

19 { 
NULL
, 0, 0, 0, { 0 }, 0, NULL, NULL, NULL, NULL, NULL }

22 
LTC_MUTEX_GLOBAL
(
Éc_hash_mu‹x
)

	@libtomcrypt/src/misc/crypt/crypt_hash_is_valid.c

11 
	~"tomüy±.h
"

23 
	$hash_is_v®id
(
idx
)

25 
	`LTC_MUTEX_LOCK
(&
Éc_hash_mu‹x
);

26 ià(
idx
 < 0 || idx >ğ
TAB_SIZE
 || 
hash_desütÜ
[idx].
Çme
 =ğ
NULL
) {

27 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

28  
CRYPT_INVALID_HASH
;

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

31  
CRYPT_OK
;

32 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_ltc_mp_descriptor.c

11 
	~"tomüy±.h
"

13 
Éc_m©h_desütÜ
 
	gÉc_mp
;

	@libtomcrypt/src/misc/crypt/crypt_prng_descriptor.c

11 
	~"tomüy±.h
"

17 
Éc_´ng_desütÜ
 
	g´ng_desütÜ
[
TAB_SIZE
] = {

18 { 
NULL
, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL }

21 
LTC_MUTEX_GLOBAL
(
Éc_´ng_mu‹x
)

	@libtomcrypt/src/misc/crypt/crypt_prng_is_valid.c

11 
	~"tomüy±.h
"

23 
	$´ng_is_v®id
(
idx
)

25 
	`LTC_MUTEX_LOCK
(&
Éc_´ng_mu‹x
);

26 ià(
idx
 < 0 || idx >ğ
TAB_SIZE
 || 
´ng_desütÜ
[idx].
Çme
 =ğ
NULL
) {

27 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

28  
CRYPT_INVALID_PRNG
;

30 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

31  
CRYPT_OK
;

32 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_register_cipher.c

11 
	~"tomüy±.h
"

23 
	$»gi¡”_ch”
(cÚ¡ 
Éc_ch”_desütÜ
 *
ch”
)

25 
x
;

27 
	`LTC_ARGCHK
(
ch”
 !ğ
NULL
);

30 
	`LTC_MUTEX_LOCK
(&
Éc_ch”_mu‹x
);

31 
x
 = 0; x < 
TAB_SIZE
; x++) {

32 ià(
ch”_desütÜ
[
x
].
Çme
 !ğ
NULL
 && ch”_desütÜ[x].
ID
 =ğ
ch”
->ID) {

33 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

34  
x
;

39 
x
 = 0; x < 
TAB_SIZE
; x++) {

40 ià(
ch”_desütÜ
[
x
].
Çme
 =ğ
NULL
) {

41 
	`XMEMCPY
(&
ch”_desütÜ
[
x
], 
ch”
, (
Éc_ch”_desütÜ
));

42 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

43  
x
;

48 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

50 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_register_hash.c

11 
	~"tomüy±.h
"

23 
	$»gi¡”_hash
(cÚ¡ 
Éc_hash_desütÜ
 *
hash
)

25 
x
;

27 
	`LTC_ARGCHK
(
hash
 !ğ
NULL
);

30 
	`LTC_MUTEX_LOCK
(&
Éc_hash_mu‹x
);

31 
x
 = 0; x < 
TAB_SIZE
; x++) {

32 ià(
	`XMEMCMP
(&
hash_desütÜ
[
x
], 
hash
, (
Éc_hash_desütÜ
)) == 0) {

33 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

34  
x
;

39 
x
 = 0; x < 
TAB_SIZE
; x++) {

40 ià(
hash_desütÜ
[
x
].
Çme
 =ğ
NULL
) {

41 
	`XMEMCPY
(&
hash_desütÜ
[
x
], 
hash
, (
Éc_hash_desütÜ
));

42 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

43  
x
;

48 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

50 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_register_prng.c

11 
	~"tomüy±.h
"

23 
	$»gi¡”_´ng
(cÚ¡ 
Éc_´ng_desütÜ
 *
´ng
)

25 
x
;

27 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

30 
	`LTC_MUTEX_LOCK
(&
Éc_´ng_mu‹x
);

31 
x
 = 0; x < 
TAB_SIZE
; x++) {

32 ià(
	`XMEMCMP
(&
´ng_desütÜ
[
x
], 
´ng
, (
Éc_´ng_desütÜ
)) == 0) {

33 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

34  
x
;

39 
x
 = 0; x < 
TAB_SIZE
; x++) {

40 ià(
´ng_desütÜ
[
x
].
Çme
 =ğ
NULL
) {

41 
	`XMEMCPY
(&
´ng_desütÜ
[
x
], 
´ng
, (
Éc_´ng_desütÜ
));

42 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

43  
x
;

48 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

50 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_unregister_cipher.c

11 
	~"tomüy±.h
"

23 
	$uÄegi¡”_ch”
(cÚ¡ 
Éc_ch”_desütÜ
 *
ch”
)

25 
x
;

27 
	`LTC_ARGCHK
(
ch”
 !ğ
NULL
);

30 
	`LTC_MUTEX_LOCK
(&
Éc_ch”_mu‹x
);

31 
x
 = 0; x < 
TAB_SIZE
; x++) {

32 ià(
	`XMEMCMP
(&
ch”_desütÜ
[
x
], 
ch”
, (
Éc_ch”_desütÜ
)) == 0) {

33 
ch”_desütÜ
[
x
].
Çme
 = 
NULL
;

34 
ch”_desütÜ
[
x
].
ID
 = 255;

35 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

36  
CRYPT_OK
;

39 
	`LTC_MUTEX_UNLOCK
(&
Éc_ch”_mu‹x
);

40  
CRYPT_ERROR
;

41 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_unregister_hash.c

11 
	~"tomüy±.h
"

23 
	$uÄegi¡”_hash
(cÚ¡ 
Éc_hash_desütÜ
 *
hash
)

25 
x
;

27 
	`LTC_ARGCHK
(
hash
 !ğ
NULL
);

30 
	`LTC_MUTEX_LOCK
(&
Éc_hash_mu‹x
);

31 
x
 = 0; x < 
TAB_SIZE
; x++) {

32 ià(
	`XMEMCMP
(&
hash_desütÜ
[
x
], 
hash
, (
Éc_hash_desütÜ
)) == 0) {

33 
hash_desütÜ
[
x
].
Çme
 = 
NULL
;

34 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

35  
CRYPT_OK
;

38 
	`LTC_MUTEX_UNLOCK
(&
Éc_hash_mu‹x
);

39  
CRYPT_ERROR
;

40 
	}
}

	@libtomcrypt/src/misc/crypt/crypt_unregister_prng.c

11 
	~"tomüy±.h
"

23 
	$uÄegi¡”_´ng
(cÚ¡ 
Éc_´ng_desütÜ
 *
´ng
)

25 
x
;

27 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

30 
	`LTC_MUTEX_LOCK
(&
Éc_´ng_mu‹x
);

31 
x
 = 0; x < 
TAB_SIZE
; x++) {

32 ià(
	`XMEMCMP
(&
´ng_desütÜ
[
x
], 
´ng
, (
Éc_´ng_desütÜ
)) != 0) {

33 
´ng_desütÜ
[
x
].
Çme
 = 
NULL
;

34 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

35  
CRYPT_OK
;

38 
	`LTC_MUTEX_UNLOCK
(&
Éc_´ng_mu‹x
);

39  
CRYPT_ERROR
;

40 
	}
}

	@libtomcrypt/src/misc/error_to_string.c

12 
	~"tomüy±.h
"

19 cÚ¡ *
	g”r_2_¡r
[] =

62 cÚ¡ *
	$”rÜ_to_¡ršg
(
”r
)

64 ià(
”r
 < 0 ||ƒ¼ >ğ()((
”r_2_¡r
)/(err_2_str[0]))) {

67  
”r_2_¡r
[
”r
];

69 
	}
}

	@libtomcrypt/src/misc/pkcs5/pkcs_5_1.c

11 
	~<tomüy±.h
>

17 #ifdeà
PKCS_5


29 
	$pkcs_5_®g1
(cÚ¡ *
·sswÜd
, 
·sswÜd_Ën
,

30 cÚ¡ *
§É
,

31 
™”©iÚ_couÁ
, 
hash_idx
,

32 *
out
, *
ou’
)

34 
”r
;

35 
x
;

36 
hash_¡©e
 *
md
;

37 *
buf
;

39 
	`LTC_ARGCHK
(
·sswÜd
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
§É
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

45 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

46  
”r
;

50 
md
 = 
	`XMALLOC
((
hash_¡©e
));

51 
buf
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

52 ià(
md
 =ğ
NULL
 || 
buf
 == NULL) {

53 ià(
md
 !ğ
NULL
) {

54 
	`XFREE
(
md
);

56 ià(
buf
 !ğ
NULL
) {

57 
	`XFREE
(
buf
);

59  
CRYPT_MEM
;

63 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`š™
(
md
)è!ğ
CRYPT_OK
) {

64 
LBL_ERR
;

66 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(
md
, 
·sswÜd
, 
·sswÜd_Ën
)è!ğ
CRYPT_OK
) {

67 
LBL_ERR
;

69 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(
md
, 
§É
, 8)è!ğ
CRYPT_OK
) {

70 
LBL_ERR
;

72 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`dÚe
(
md
, 
buf
)è!ğ
CRYPT_OK
) {

73 
LBL_ERR
;

76 --
™”©iÚ_couÁ
) {

78 
x
 = 
MAXBLOCKSIZE
;

79 ià((
”r
 = 
	`hash_memÜy
(
hash_idx
, 
buf
, 
hash_desütÜ
[hash_idx].
hashsize
, buf, &
x
)è!ğ
CRYPT_OK
) {

80 
LBL_ERR
;

85 
x
 = 0; x < 
hash_desütÜ
[
hash_idx
].
hashsize
 && x < *
ou’
; x++) {

86 
out
[
x
] = 
buf
[x];

88 *
ou’
 = 
x
;

89 
”r
 = 
CRYPT_OK
;

90 
LBL_ERR
:

91 #ifdeà
LTC_CLEAN_STACK


92 
	`z”omem
(
buf
, 
MAXBLOCKSIZE
);

93 
	`z”omem
(
md
, (
hash_¡©e
));

96 
	`XFREE
(
buf
);

97 
	`XFREE
(
md
);

99  
”r
;

100 
	}
}

	@libtomcrypt/src/misc/pkcs5/pkcs_5_2.c

11 
	~<tomüy±.h
>

17 #ifdeà
PKCS_5


31 
	$pkcs_5_®g2
(cÚ¡ *
·sswÜd
, 
·sswÜd_Ën
,

32 cÚ¡ *
§É
, 
§É_Ën
,

33 
™”©iÚ_couÁ
, 
hash_idx
,

34 *
out
, *
ou’
)

36 
”r
, 
™ts
;

37 
ulÚg32
 
blkno
;

38 
¡Üed
, 
Ëá
, 
x
, 
y
;

39 *
buf
[2];

40 
hmac_¡©e
 *
hmac
;

42 
	`LTC_ARGCHK
(
·sswÜd
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
§É
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

49  
”r
;

52 
buf
[0] = 
	`XMALLOC
(
MAXBLOCKSIZE
 * 2);

53 
hmac
 = 
	`XMALLOC
((
hmac_¡©e
));

54 ià(
hmac
 =ğ
NULL
 || 
buf
[0] == NULL) {

55 ià(
hmac
 !ğ
NULL
) {

56 
	`XFREE
(
hmac
);

58 ià(
buf
[0] !ğ
NULL
) {

59 
	`XFREE
(
buf
[0]);

61  
CRYPT_MEM
;

64 
buf
[1] = buf[0] + 
MAXBLOCKSIZE
;

66 
Ëá
 = *
ou’
;

67 
blkno
 = 1;

68 
¡Üed
 = 0;

69 
Ëá
 != 0) {

71 
	`z”omem
(
buf
[0], 
MAXBLOCKSIZE
*2);

74 
	`STORE32H
(
blkno
, 
buf
[1]);

75 ++
blkno
;

78 ià((
”r
 = 
	`hmac_š™
(
hmac
, 
hash_idx
, 
·sswÜd
, 
·sswÜd_Ën
)è!ğ
CRYPT_OK
) {

79 
LBL_ERR
;

81 ià((
”r
 = 
	`hmac_´oûss
(
hmac
, 
§É
, 
§É_Ën
)è!ğ
CRYPT_OK
) {

82 
LBL_ERR
;

84 ià((
”r
 = 
	`hmac_´oûss
(
hmac
, 
buf
[1], 4)è!ğ
CRYPT_OK
) {

85 
LBL_ERR
;

87 
x
 = 
MAXBLOCKSIZE
;

88 ià((
”r
 = 
	`hmac_dÚe
(
hmac
, 
buf
[0], &
x
)è!ğ
CRYPT_OK
) {

89 
LBL_ERR
;

93 
	`XMEMCPY
(
buf
[1], buf[0], 
x
);

94 
™ts
 = 1; i‰ < 
™”©iÚ_couÁ
; ++itts) {

95 ià((
”r
 = 
	`hmac_memÜy
(
hash_idx
, 
·sswÜd
, 
·sswÜd_Ën
, 
buf
[0], 
x
, buf[0], &x)è!ğ
CRYPT_OK
) {

96 
LBL_ERR
;

98 
y
 = 0; y < 
x
; y++) {

99 
buf
[1][
y
] ^= buf[0][y];

104 
y
 = 0; y < 
x
 && 
Ëá
 != 0; ++y) {

105 
out
[
¡Üed
++] = 
buf
[1][
y
];

106 --
Ëá
;

109 *
ou’
 = 
¡Üed
;

111 
”r
 = 
CRYPT_OK
;

112 
LBL_ERR
:

113 #ifdeà
LTC_CLEAN_STACK


114 
	`z”omem
(
buf
[0], 
MAXBLOCKSIZE
*2);

115 
	`z”omem
(
hmac
, (
hmac_¡©e
));

118 
	`XFREE
(
hmac
);

119 
	`XFREE
(
buf
[0]);

121  
”r
;

122 
	}
}

	@libtomcrypt/src/misc/zeromem.c

11 
	~"tomüy±.h
"

23 
	$z”omem
(*
out
, 
size_t
 
ou’
)

25 *
mem
 = 
out
;

26 
	`LTC_ARGCHKVD
(
out
 !ğ
NULL
);

27 
ou’
-- > 0) {

28 *
mem
++ = 0;

30 
	}
}

	@libtomcrypt/src/modes/cbc/cbc_decrypt.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_CBC_MODE


29 
	$cbc_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_CBC
 *
cbc
)

31 
x
, 
”r
;

32 
tmp
[16];

33 #ifdeà
LTC_FAST


34 
LTC_FAST_TYPE
 
tmpy
;

36 
tmpy
;

39 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
cbc
 !ğ
NULL
);

43 ià((
”r
 = 
	`ch”_is_v®id
(
cbc
->
ch”
)è!ğ
CRYPT_OK
) {

44  
”r
;

48 ià(
cbc
->
blockËn
 < 1 || cbc->blockËÀ> ()(cbc->
IV
)) {

49  
CRYPT_INVALID_ARG
;

52 ià(
Ën
 % 
cbc
->
blockËn
) {

53  
CRYPT_INVALID_ARG
;

55 #ifdeà
LTC_FAST


56 ià(
cbc
->
blockËn
 % (
LTC_FAST_TYPE
)) {

57  
CRYPT_INVALID_ARG
;

61 ià(
ch”_desütÜ
[
cbc
->
ch”
].
acûl_cbc_deüy±
 !ğ
NULL
) {

62  
ch”_desütÜ
[
cbc
->
ch”
].
	`acûl_cbc_deüy±
(
ù
, 
±
, 
Ën
 / cbc->
blockËn
, cbc->
IV
, &cbc->
key
);

64 
Ën
) {

66 ià((
”r
 = 
ch”_desütÜ
[
cbc
->
ch”
].
	`ecb_deüy±
(
ù
, 
tmp
, &cbc->
key
)è!ğ
CRYPT_OK
) {

67  
”r
;

71 #ià
	`defšed
(
LTC_FAST
)

72 
x
 = 0; x < 
cbc
->
blockËn
; x +ğ(
LTC_FAST_TYPE
)) {

73 
tmpy
 = *((
LTC_FAST_TYPE
*)((*)
cbc
->
IV
 + 
x
)è^ *((LTC_FAST_TYPE*)((*)
tmp
 + x));

74 *((
LTC_FAST_TYPE
*)((*)
cbc
->
IV
 + 
x
)èğ*((LTC_FAST_TYPE*)((*)
ù
 + x));

75 *((
LTC_FAST_TYPE
*)((*)
±
 + 
x
)èğ
tmpy
;

78 
x
 = 0; x < 
cbc
->
blockËn
; x++) {

79 
tmpy
 = 
tmp
[
x
] ^ 
cbc
->
IV
[x];

80 
cbc
->
IV
[
x
] = 
ù
[x];

81 
±
[
x
] = 
tmpy
;

85 
ù
 +ğ
cbc
->
blockËn
;

86 
±
 +ğ
cbc
->
blockËn
;

87 
Ën
 -ğ
cbc
->
blockËn
;

90  
CRYPT_OK
;

91 
	}
}

	@libtomcrypt/src/modes/cbc/cbc_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CBC_MODE


24 
	$cbc_dÚe
(
symm‘ric_CBC
 *
cbc
)

26 
”r
;

27 
	`LTC_ARGCHK
(
cbc
 !ğ
NULL
);

29 ià((
”r
 = 
	`ch”_is_v®id
(
cbc
->
ch”
)è!ğ
CRYPT_OK
) {

30  
”r
;

32 
ch”_desütÜ
[
cbc
->
ch”
].
	`dÚe
(&cbc->
key
);

33  
CRYPT_OK
;

34 
	}
}

	@libtomcrypt/src/modes/cbc/cbc_encrypt.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_CBC_MODE


29 
	$cbc_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_CBC
 *
cbc
)

31 
x
, 
”r
;

33 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
cbc
 !ğ
NULL
);

37 ià((
”r
 = 
	`ch”_is_v®id
(
cbc
->
ch”
)è!ğ
CRYPT_OK
) {

38  
”r
;

42 ià(
cbc
->
blockËn
 < 1 || cbc->blockËÀ> ()(cbc->
IV
)) {

43  
CRYPT_INVALID_ARG
;

46 ià(
Ën
 % 
cbc
->
blockËn
) {

47  
CRYPT_INVALID_ARG
;

49 #ifdeà
LTC_FAST


50 ià(
cbc
->
blockËn
 % (
LTC_FAST_TYPE
)) {

51  
CRYPT_INVALID_ARG
;

55 ià(
ch”_desütÜ
[
cbc
->
ch”
].
acûl_cbc_’üy±
 !ğ
NULL
) {

56  
ch”_desütÜ
[
cbc
->
ch”
].
	`acûl_cbc_’üy±
(
±
, 
ù
, 
Ën
 / cbc->
blockËn
, cbc->
IV
, &cbc->
key
);

58 
Ën
) {

60 #ià
	`defšed
(
LTC_FAST
)

61 
x
 = 0; x < 
cbc
->
blockËn
; x +ğ(
LTC_FAST_TYPE
)) {

62 *((
LTC_FAST_TYPE
*)((*)
cbc
->
IV
 + 
x
)è^ğ*((LTC_FAST_TYPE*)((*)
±
 + x));

65 
x
 = 0; x < 
cbc
->
blockËn
; x++) {

66 
cbc
->
IV
[
x
] ^ğ
±
[x];

71 ià((
”r
 = 
ch”_desütÜ
[
cbc
->
ch”
].
	`ecb_’üy±
(cbc->
IV
, 
ù
, &cbc->
key
)è!ğ
CRYPT_OK
) {

72  
”r
;

76 #ià
	`defšed
(
LTC_FAST
)

77 
x
 = 0; x < 
cbc
->
blockËn
; x +ğ(
LTC_FAST_TYPE
)) {

78 *((
LTC_FAST_TYPE
*)((*)
cbc
->
IV
 + 
x
)èğ*((LTC_FAST_TYPE*)((*)
ù
 + x));

81 
x
 = 0; x < 
cbc
->
blockËn
; x++) {

82 
cbc
->
IV
[
x
] = 
ù
[x];

86 
ù
 +ğ
cbc
->
blockËn
;

87 
±
 +ğ
cbc
->
blockËn
;

88 
Ën
 -ğ
cbc
->
blockËn
;

91  
CRYPT_OK
;

92 
	}
}

	@libtomcrypt/src/modes/cbc/cbc_getiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CBC_MODE


27 
	$cbc_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_CBC
 *
cbc
)

29 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
Ën
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
cbc
 !ğ
NULL
);

32 ià(()
cbc
->
blockËn
 > *
Ën
) {

33 *
Ën
 = 
cbc
->
blockËn
;

34  
CRYPT_BUFFER_OVERFLOW
;

36 
	`XMEMCPY
(
IV
, 
cbc
->IV, cbc->
blockËn
);

37 *
Ën
 = 
cbc
->
blockËn
;

39  
CRYPT_OK
;

40 
	}
}

	@libtomcrypt/src/modes/cbc/cbc_setiv.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_CBC_MODE


28 
	$cbc_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_CBC
 *
cbc
)

30 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
cbc
 !ğ
NULL
);

32 ià(
Ën
 !ğ()
cbc
->
blockËn
) {

33  
CRYPT_INVALID_ARG
;

35 
	`XMEMCPY
(
cbc
->
IV
, IV, 
Ën
);

36  
CRYPT_OK
;

37 
	}
}

	@libtomcrypt/src/modes/cbc/cbc_start.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CBC_MODE


30 
	$cbc_¡¬t
(
ch”
, cÚ¡ *
IV
, cÚ¡ *
key
,

31 
keyËn
, 
num_rounds
, 
symm‘ric_CBC
 *
cbc
)

33 
x
, 
”r
;

35 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
cbc
 !ğ
NULL
);

40 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

41  
”r
;

45 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 
num_rounds
, &
cbc
->key)è!ğ
CRYPT_OK
) {

46  
”r
;

50 
cbc
->
blockËn
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

51 
cbc
->
ch”
 = cipher;

52 
x
 = 0; x < 
cbc
->
blockËn
; x++) {

53 
cbc
->
IV
[
x
] = IV[x];

55  
CRYPT_OK
;

56 
	}
}

	@libtomcrypt/src/modes/cfb/cfb_decrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CFB_MODE


28 
	$cfb_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_CFB
 *
cfb
)

30 
”r
;

32 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
cfb
 !ğ
NULL
);

36 ià((
”r
 = 
	`ch”_is_v®id
(
cfb
->
ch”
)è!ğ
CRYPT_OK
) {

37  
”r
;

41 ià(
cfb
->
blockËn
 < 0 || cfb->blockËÀ> ()(cfb->
IV
) ||

42 
cfb
->
·dËn
 < 0 || cfb->·dËÀ> ()(cfb->
·d
)) {

43  
CRYPT_INVALID_ARG
;

46 
Ën
-- > 0) {

47 ià(
cfb
->
·dËn
 =ğcfb->
blockËn
) {

48 ià((
”r
 = 
ch”_desütÜ
[
cfb
->
ch”
].
	`ecb_’üy±
(cfb->
·d
, cfb->
IV
, &cfb->
key
)è!ğ
CRYPT_OK
) {

49  
”r
;

51 
cfb
->
·dËn
 = 0;

53 
cfb
->
·d
[cfb->
·dËn
] = *
ù
;

54 *
±
 = *
ù
 ^ 
cfb
->
IV
[cfb->
·dËn
];

55 ++
±
;

56 ++
ù
;

57 ++(
cfb
->
·dËn
);

59  
CRYPT_OK
;

60 
	}
}

	@libtomcrypt/src/modes/cfb/cfb_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CFB_MODE


24 
	$cfb_dÚe
(
symm‘ric_CFB
 *
cfb
)

26 
”r
;

27 
	`LTC_ARGCHK
(
cfb
 !ğ
NULL
);

29 ià((
”r
 = 
	`ch”_is_v®id
(
cfb
->
ch”
)è!ğ
CRYPT_OK
) {

30  
”r
;

32 
ch”_desütÜ
[
cfb
->
ch”
].
	`dÚe
(&cfb->
key
);

33  
CRYPT_OK
;

34 
	}
}

	@libtomcrypt/src/modes/cfb/cfb_encrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CFB_MODE


28 
	$cfb_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_CFB
 *
cfb
)

30 
”r
;

32 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
cfb
 !ğ
NULL
);

36 ià((
”r
 = 
	`ch”_is_v®id
(
cfb
->
ch”
)è!ğ
CRYPT_OK
) {

37  
”r
;

41 ià(
cfb
->
blockËn
 < 0 || cfb->blockËÀ> ()(cfb->
IV
) ||

42 
cfb
->
·dËn
 < 0 || cfb->·dËÀ> ()(cfb->
·d
)) {

43  
CRYPT_INVALID_ARG
;

46 
Ën
-- > 0) {

47 ià(
cfb
->
·dËn
 =ğcfb->
blockËn
) {

48 ià((
”r
 = 
ch”_desütÜ
[
cfb
->
ch”
].
	`ecb_’üy±
(cfb->
·d
, cfb->
IV
, &cfb->
key
)è!ğ
CRYPT_OK
) {

49  
”r
;

51 
cfb
->
·dËn
 = 0;

53 
cfb
->
·d
[cfb->
·dËn
] = (*
ù
 = *
±
 ^ cfb->
IV
[cfb->padlen]);

54 ++
±
;

55 ++
ù
;

56 ++(
cfb
->
·dËn
);

58  
CRYPT_OK
;

59 
	}
}

	@libtomcrypt/src/modes/cfb/cfb_getiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CFB_MODE


27 
	$cfb_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_CFB
 *
cfb
)

29 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
Ën
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
cfb
 !ğ
NULL
);

32 ià(()
cfb
->
blockËn
 > *
Ën
) {

33 *
Ën
 = 
cfb
->
blockËn
;

34  
CRYPT_BUFFER_OVERFLOW
;

36 
	`XMEMCPY
(
IV
, 
cfb
->IV, cfb->
blockËn
);

37 *
Ën
 = 
cfb
->
blockËn
;

39  
CRYPT_OK
;

40 
	}
}

	@libtomcrypt/src/modes/cfb/cfb_setiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CFB_MODE


27 
	$cfb_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_CFB
 *
cfb
)

29 
”r
;

31 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
cfb
 !ğ
NULL
);

34 ià((
”r
 = 
	`ch”_is_v®id
(
cfb
->
ch”
)è!ğ
CRYPT_OK
) {

35  
”r
;

38 ià(
Ën
 !ğ()
cfb
->
blockËn
) {

39  
CRYPT_INVALID_ARG
;

43 
cfb
->
·dËn
 = 0;

44  
ch”_desütÜ
[
cfb
->
ch”
].
	`ecb_’üy±
(
IV
, cfb->IV, &cfb->
key
);

45 
	}
}

	@libtomcrypt/src/modes/cfb/cfb_start.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_CFB_MODE


31 
	$cfb_¡¬t
(
ch”
, cÚ¡ *
IV
, cÚ¡ *
key
,

32 
keyËn
, 
num_rounds
, 
symm‘ric_CFB
 *
cfb
)

34 
x
, 
”r
;

36 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
cfb
 !ğ
NULL
);

40 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

41  
”r
;

46 
cfb
->
ch”
 = cipher;

47 
cfb
->
blockËn
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

48 
x
 = 0; x < 
cfb
->
blockËn
; x++)

49 
cfb
->
IV
[
x
] = IV[x];

52 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 
num_rounds
, &
cfb
->key)è!ğ
CRYPT_OK
) {

53  
”r
;

57 
cfb
->
·dËn
 = 0;

58  
ch”_desütÜ
[
cfb
->
ch”
].
	`ecb_’üy±
(cfb->
IV
, cfb->IV, &cfb->
key
);

59 
	}
}

	@libtomcrypt/src/modes/ctr/ctr_decrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CTR_MODE


28 
	$ùr_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_CTR
 *
ùr
)

30 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ùr
 !ğ
NULL
);

34  
	`ùr_’üy±
(
ù
, 
±
, 
Ën
, 
ùr
);

35 
	}
}

	@libtomcrypt/src/modes/ctr/ctr_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CTR_MODE


24 
	$ùr_dÚe
(
symm‘ric_CTR
 *
ùr
)

26 
”r
;

27 
	`LTC_ARGCHK
(
ùr
 !ğ
NULL
);

29 ià((
”r
 = 
	`ch”_is_v®id
(
ùr
->
ch”
)è!ğ
CRYPT_OK
) {

30  
”r
;

32 
ch”_desütÜ
[
ùr
->
ch”
].
	`dÚe
(&ùr->
key
);

33  
CRYPT_OK
;

34 
	}
}

	@libtomcrypt/src/modes/ctr/ctr_encrypt.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_CTR_MODE


29 
	$ùr_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_CTR
 *
ùr
)

31 
x
, 
”r
;

33 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
ùr
 !ğ
NULL
);

37 ià((
”r
 = 
	`ch”_is_v®id
(
ùr
->
ch”
)è!ğ
CRYPT_OK
) {

38  
”r
;

42 ià(
ùr
->
blockËn
 < 1 || ctr->blocklen > ()(ctr->ctr) ||

43 
ùr
->
·dËn
 < 0 || cŒ->·dËÀ> ()(ùr->
·d
)) {

44  
CRYPT_INVALID_ARG
;

47 #ifdeà
LTC_FAST


48 ià(
ùr
->
blockËn
 % (
LTC_FAST_TYPE
)) {

49  
CRYPT_INVALID_ARG
;

54 ià((
ùr
->
·dËn
 =ğùr->
blockËn
è&& 
ch”_desütÜ
[ùr->
ch”
].
acûl_ùr_’üy±
 !ğ
NULL
 && (
Ën
 >= ()ctr->blocklen)) {

55 ià((
”r
 = 
ch”_desütÜ
[
ùr
->
ch”
].
	`acûl_ùr_’üy±
(
±
, 
ù
, 
Ën
/ùr->
blockËn
, cŒ->ùr, cŒ->
mode
, &ùr->
key
)è!ğ
CRYPT_OK
) {

56  
”r
;

58 
Ën
 %ğ
ùr
->
blockËn
;

61 
Ën
) {

63 ià(
ùr
->
·dËn
 =ğùr->
blockËn
) {

65 ià(
ùr
->
mode
 =ğ
CTR_COUNTER_LITTLE_ENDIAN
) {

67 
x
 = 0; x < 
ùr
->
blockËn
; x++) {

68 
ùr
->ùr[
x
] = (ctr->ctr[x] + ()1) & ()255;

69 ià(
ùr
->ùr[
x
] != ()0) {

75 
x
 = 
ùr
->
blockËn
-1; x >= 0; x--) {

76 
ùr
->ùr[
x
] = (ctr->ctr[x] + ()1) & ()255;

77 ià(
ùr
->ùr[
x
] != ()0) {

84 ià((
”r
 = 
ch”_desütÜ
[
ùr
->
ch”
].
	`ecb_’üy±
(ùr->ùr, cŒ->
·d
, &ùr->
key
)è!ğ
CRYPT_OK
) {

85  
”r
;

87 
ùr
->
·dËn
 = 0;

89 #ifdeà
LTC_FAST


90 ià(
ùr
->
·dËn
 =ğ0 && 
Ën
 >ğ()ùr->
blockËn
) {

91 
x
 = 0; x < 
ùr
->
blockËn
; x +ğ(
LTC_FAST_TYPE
)) {

92 *((
LTC_FAST_TYPE
*)((*)
ù
 + 
x
)èğ*((LTC_FAST_TYPE*)((*)
±
 + x)) ^

93 *((
LTC_FAST_TYPE
*)((*)
ùr
->
·d
 + 
x
));

95 
±
 +ğ
ùr
->
blockËn
;

96 
ù
 +ğ
ùr
->
blockËn
;

97 
Ën
 -ğ
ùr
->
blockËn
;

98 
ùr
->
·dËn
 = cŒ->
blockËn
;

102 *
ù
++ = *
±
++ ^ 
ùr
->
·d
[ùr->
·dËn
++];

103 --
Ën
;

105  
CRYPT_OK
;

106 
	}
}

	@libtomcrypt/src/modes/ctr/ctr_getiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CTR_MODE


27 
	$ùr_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_CTR
 *
ùr
)

29 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
Ën
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
ùr
 !ğ
NULL
);

32 ià(()
ùr
->
blockËn
 > *
Ën
) {

33 *
Ën
 = 
ùr
->
blockËn
;

34  
CRYPT_BUFFER_OVERFLOW
;

36 
	`XMEMCPY
(
IV
, 
ùr
->ùr, cŒ->
blockËn
);

37 *
Ën
 = 
ùr
->
blockËn
;

39  
CRYPT_OK
;

40 
	}
}

	@libtomcrypt/src/modes/ctr/ctr_setiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CTR_MODE


27 
	$ùr_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_CTR
 *
ùr
)

29 
”r
;

31 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ùr
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
ùr
->
ch”
)è!ğ
CRYPT_OK
) {

36  
”r
;

39 ià(
Ën
 !ğ()
ùr
->
blockËn
) {

40  
CRYPT_INVALID_ARG
;

44 
	`XMEMCPY
(
ùr
->ùr, 
IV
, 
Ën
);

47 
ùr
->
·dËn
 = 0;

48  
ch”_desütÜ
[
ùr
->
ch”
].
	`ecb_’üy±
(
IV
, cŒ->
·d
, &ùr->
key
);

49 
	}
}

	@libtomcrypt/src/modes/ctr/ctr_start.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_CTR_MODE


32 
	$ùr_¡¬t
Ğ
ch”
,

33 cÚ¡ *
IV
,

34 cÚ¡ *
key
, 
keyËn
,

35 
num_rounds
, 
ùr_mode
,

36 
symm‘ric_CTR
 *
ùr
)

38 
x
, 
”r
;

40 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
ùr
 !ğ
NULL
);

45 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

46  
”r
;

50 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 
num_rounds
, &
ùr
->key)è!ğ
CRYPT_OK
) {

51  
”r
;

55 
ùr
->
blockËn
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

56 
ùr
->
ch”
 = cipher;

57 
ùr
->
·dËn
 = 0;

58 
ùr
->
mode
 = 
ùr_mode
 & 1;

59 
x
 = 0; x < 
ùr
->
blockËn
; x++) {

60 
ùr
->ùr[
x
] = 
IV
[x];

63 ià(
ùr_mode
 & 
LTC_CTR_RFC3686
) {

65 ià(
ùr
->
mode
 =ğ
CTR_COUNTER_LITTLE_ENDIAN
) {

67 
x
 = 0; x < 
ùr
->
blockËn
; x++) {

68 
ùr
->ùr[
x
] = (ctr->ctr[x] + ()1) & ()255;

69 ià(
ùr
->ùr[
x
] != ()0) {

75 
x
 = 
ùr
->
blockËn
-1; x >= 0; x--) {

76 
ùr
->ùr[
x
] = (ctr->ctr[x] + ()1) & ()255;

77 ià(
ùr
->ùr[
x
] != ()0) {

84  
ch”_desütÜ
[
ùr
->
ch”
].
	`ecb_’üy±
(ùr->ùr, cŒ->
·d
, &ùr->
key
);

85 
	}
}

	@libtomcrypt/src/modes/ctr/ctr_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_CTR_MODE


20 
	$ùr_‹¡
()

22 #ifdeà
LTC_NO_TEST


23  
CRYPT_NOP
;

26 
keyËn
, 
msgËn
;

27 
key
[32], 
IV
[16], 
±
[64], 
ù
[64];

28 } 
‹¡s
[] = {

51 
idx
, 
”r
, 
x
;

52 
buf
[64];

53 
symm‘ric_CTR
 
ùr
;

56 ià((
idx
 = 
	`fšd_ch”
("aes")) == -1) {

57 ià((
idx
 = 
	`fšd_ch”
("rijndael")) == -1) {

58  
CRYPT_NOP
;

62 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

63 ià((
”r
 = 
	`ùr_¡¬t
(
idx
, 
‹¡s
[
x
].
IV
,e¡s[x].
key
,e¡s[x].
keyËn
, 0, 
CTR_COUNTER_BIG_ENDIAN
|
LTC_CTR_RFC3686
, &
ùr
)è!ğ
CRYPT_OK
) {

64  
”r
;

66 ià((
”r
 = 
	`ùr_’üy±
(
‹¡s
[
x
].
±
, 
buf
,e¡s[x].
msgËn
, &
ùr
)è!ğ
CRYPT_OK
) {

67  
”r
;

69 
	`ùr_dÚe
(&
ùr
);

70 ià(
	`XMEMCMP
(
buf
, 
‹¡s
[
x
].
ù
,e¡s[x].
msgËn
)) {

71  
CRYPT_FAIL_TESTVECTOR
;

74  
CRYPT_OK
;

76 
	}
}

	@libtomcrypt/src/modes/ecb/ecb_decrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_ECB_MODE


28 
	$ecb_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_ECB
 *
ecb
)

30 
”r
;

31 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
ecb
 !ğ
NULL
);

34 ià((
”r
 = 
	`ch”_is_v®id
(
ecb
->
ch”
)è!ğ
CRYPT_OK
) {

35  
”r
;

37 ià(
Ën
 % 
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
) {

38  
CRYPT_INVALID_ARG
;

42 ià(
ch”_desütÜ
[
ecb
->
ch”
].
acûl_ecb_deüy±
 !ğ
NULL
) {

43  
ch”_desütÜ
[
ecb
->
ch”
].
	`acûl_ecb_deüy±
(
ù
, 
±
, 
Ën
 / ch”_desütÜ[ecb->ch”].
block_Ëngth
, &ecb->
key
);

45 
Ën
) {

46 ià((
”r
 = 
ch”_desütÜ
[
ecb
->
ch”
].
	`ecb_deüy±
(
ù
, 
±
, &ecb->
key
)è!ğ
CRYPT_OK
) {

47  
”r
;

49 
±
 +ğ
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
;

50 
ù
 +ğ
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
;

51 
Ën
 -ğ
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
;

54  
CRYPT_OK
;

55 
	}
}

	@libtomcrypt/src/modes/ecb/ecb_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_ECB_MODE


24 
	$ecb_dÚe
(
symm‘ric_ECB
 *
ecb
)

26 
”r
;

27 
	`LTC_ARGCHK
(
ecb
 !ğ
NULL
);

29 ià((
”r
 = 
	`ch”_is_v®id
(
ecb
->
ch”
)è!ğ
CRYPT_OK
) {

30  
”r
;

32 
ch”_desütÜ
[
ecb
->
ch”
].
	`dÚe
(&ecb->
key
);

33  
CRYPT_OK
;

34 
	}
}

	@libtomcrypt/src/modes/ecb/ecb_encrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_ECB_MODE


28 
	$ecb_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_ECB
 *
ecb
)

30 
”r
;

31 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
ecb
 !ğ
NULL
);

34 ià((
”r
 = 
	`ch”_is_v®id
(
ecb
->
ch”
)è!ğ
CRYPT_OK
) {

35  
”r
;

37 ià(
Ën
 % 
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
) {

38  
CRYPT_INVALID_ARG
;

42 ià(
ch”_desütÜ
[
ecb
->
ch”
].
acûl_ecb_’üy±
 !ğ
NULL
) {

43  
ch”_desütÜ
[
ecb
->
ch”
].
	`acûl_ecb_’üy±
(
±
, 
ù
, 
Ën
 / ch”_desütÜ[ecb->ch”].
block_Ëngth
, &ecb->
key
);

45 
Ën
) {

46 ià((
”r
 = 
ch”_desütÜ
[
ecb
->
ch”
].
	`ecb_’üy±
(
±
, 
ù
, &ecb->
key
)è!ğ
CRYPT_OK
) {

47  
”r
;

49 
±
 +ğ
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
;

50 
ù
 +ğ
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
;

51 
Ën
 -ğ
ch”_desütÜ
[
ecb
->
ch”
].
block_Ëngth
;

54  
CRYPT_OK
;

55 
	}
}

	@libtomcrypt/src/modes/ecb/ecb_start.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_ECB_MODE


30 
	$ecb_¡¬t
(
ch”
, cÚ¡ *
key
, 
keyËn
, 
num_rounds
, 
symm‘ric_ECB
 *
ecb
)

32 
”r
;

33 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ecb
 !ğ
NULL
);

36 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

37  
”r
;

39 
ecb
->
ch”
 = cipher;

40 
ecb
->
blockËn
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

41  
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 
num_rounds
, &
ecb
->key);

42 
	}
}

	@libtomcrypt/src/modes/f8/f8_decrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F8_MODE


28 
	$f8_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_F8
 *
f8
)

30 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
f8
 !ğ
NULL
);

33  
	`f8_’üy±
(
ù
, 
±
, 
Ën
, 
f8
);

34 
	}
}

	@libtomcrypt/src/modes/f8/f8_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F8_MODE


24 
	$f8_dÚe
(
symm‘ric_F8
 *
f8
)

26 
”r
;

27 
	`LTC_ARGCHK
(
f8
 !ğ
NULL
);

29 ià((
”r
 = 
	`ch”_is_v®id
(
f8
->
ch”
)è!ğ
CRYPT_OK
) {

30  
”r
;

32 
ch”_desütÜ
[
f8
->
ch”
].
	`dÚe
(&f8->
key
);

33  
CRYPT_OK
;

34 
	}
}

	@libtomcrypt/src/modes/f8/f8_encrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F8_MODE


28 
	$f8_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_F8
 *
f8
)

30 
”r
, 
x
;

31 
buf
[
MAXBLOCKSIZE
];

32 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
f8
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
f8
->
ch”
)è!ğ
CRYPT_OK
) {

36  
”r
;

40 ià(
f8
->
blockËn
 < 0 || f8->blockËÀ> ()(f8->
IV
) ||

41 
f8
->
·dËn
 < 0 || f8->·dËÀ> ()(f8->
IV
)) {

42  
CRYPT_INVALID_ARG
;

45 
	`z”omem
(
buf
, (buf));

48 ià(
f8
->
·dËn
 =ğf8->
blockËn
) {

50 
	`STORE32H
(
f8
->
blockút
, (
buf
+(f8->
blockËn
-4)));

51 ++(
f8
->
blockút
);

52 
x
 = 0; x < 
f8
->
blockËn
; x++) {

53 
f8
->
IV
[
x
] ^ğf8->
MIV
[x] ^ 
buf
[x];

55 ià((
”r
 = 
ch”_desütÜ
[
f8
->
ch”
].
	`ecb_’üy±
(f8->
IV
, f8->IV, &f8->
key
)è!ğ
CRYPT_OK
) {

56  
”r
;

58 
f8
->
·dËn
 = 0;

61 #ifdeà
LTC_FAST


62 ià(
f8
->
·dËn
 == 0) {

63 
Ën
 >ğ()
f8
->
blockËn
) {

64 
	`STORE32H
(
f8
->
blockút
, (
buf
+(f8->
blockËn
-4)));

65 ++(
f8
->
blockút
);

66 
x
 = 0; x < 
f8
->
blockËn
; x +ğ(
LTC_FAST_TYPE
)) {

67 *((
LTC_FAST_TYPE
*)(&
ù
[
x
])èğ*((LTC_FAST_TYPE*)(&
±
[x])è^ *((LTC_FAST_TYPE*)(&
f8
->
IV
[x]));

68 *((
LTC_FAST_TYPE
*)(&
f8
->
IV
[
x
])è^ğ*((LTC_FAST_TYPE*)(&f8->
MIV
[x])è^ *((LTC_FAST_TYPE*)(&
buf
[x]));

70 ià((
”r
 = 
ch”_desütÜ
[
f8
->
ch”
].
	`ecb_’üy±
(f8->
IV
, f8->IV, &f8->
key
)è!ğ
CRYPT_OK
) {

71  
”r
;

73 
Ën
 -ğ
x
;

74 
±
 +ğ
x
;

75 
ù
 +ğ
x
;

80 
Ën
 > 0) {

81 ià(
f8
->
·dËn
 =ğf8->
blockËn
) {

83 
	`STORE32H
(
f8
->
blockút
, (
buf
+(f8->
blockËn
-4)));

84 ++(
f8
->
blockút
);

85 
x
 = 0; x < 
f8
->
blockËn
; x++) {

86 
f8
->
IV
[
x
] ^ğf8->
MIV
[x] ^ 
buf
[x];

88 ià((
”r
 = 
ch”_desütÜ
[
f8
->
ch”
].
	`ecb_’üy±
(f8->
IV
, f8->IV, &f8->
key
)è!ğ
CRYPT_OK
) {

89  
”r
;

91 
f8
->
·dËn
 = 0;

93 *
ù
++ = *
±
++ ^ 
f8
->
IV
[f8->
·dËn
++];

94 --
Ën
;

96  
CRYPT_OK
;

97 
	}
}

	@libtomcrypt/src/modes/f8/f8_getiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F8_MODE


27 
	$f8_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_F8
 *
f8
)

29 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
Ën
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
f8
 !ğ
NULL
);

32 ià(()
f8
->
blockËn
 > *
Ën
) {

33 *
Ën
 = 
f8
->
blockËn
;

34  
CRYPT_BUFFER_OVERFLOW
;

36 
	`XMEMCPY
(
IV
, 
f8
->IV, f8->
blockËn
);

37 *
Ën
 = 
f8
->
blockËn
;

39  
CRYPT_OK
;

40 
	}
}

	@libtomcrypt/src/modes/f8/f8_setiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_F8_MODE


27 
	$f8_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_F8
 *
f8
)

29 
”r
;

31 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
f8
 !ğ
NULL
);

34 ià((
”r
 = 
	`ch”_is_v®id
(
f8
->
ch”
)è!ğ
CRYPT_OK
) {

35  
”r
;

38 ià(
Ën
 !ğ()
f8
->
blockËn
) {

39  
CRYPT_INVALID_ARG
;

43 
f8
->
·dËn
 = 0;

44  
ch”_desütÜ
[
f8
->
ch”
].
	`ecb_’üy±
(
IV
, f8->IV, &f8->
key
);

45 
	}
}

	@libtomcrypt/src/modes/f8/f8_start.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_F8_MODE


33 
	$f8_¡¬t
Ğ
ch”
, cÚ¡ *
IV
,

34 cÚ¡ *
key
, 
keyËn
,

35 cÚ¡ *
§É_key
, 
skeyËn
,

36 
num_rounds
, 
symm‘ric_F8
 *
f8
)

38 
x
, 
”r
;

39 
tkey
[
MAXBLOCKSIZE
];

41 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
§É_key
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
f8
 !ğ
NULL
);

46 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

47  
”r
;

50 #ifdeà
LTC_FAST


51 ià(
ch”_desütÜ
[
ch”
].
block_Ëngth
 % (
LTC_FAST_TYPE
)) {

52  
CRYPT_INVALID_ARG
;

57 
f8
->
blockút
 = 0;

58 
f8
->
ch”
 = cipher;

59 
f8
->
blockËn
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

60 
f8
->
·dËn
 = f8->
blockËn
;

63 
	`z”omem
(
tkey
, (tkey));

64 
x
 = 0; x < 
keyËn
 && x < ()(
tkey
); x++) {

65 
tkey
[
x
] = 
key
[x];

67 
x
 = 0; x < 
skeyËn
 && x < ()(
tkey
); x++) {

68 
tkey
[
x
] ^ğ
§É_key
[x];

70 ; 
x
 < 
keyËn
 && x < ()(
tkey
); x++) {

71 
tkey
[
x
] ^= 0x55;

75 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
tkey
, 
keyËn
, 
num_rounds
, &
f8
->
key
)è!ğ
CRYPT_OK
) {

76  
”r
;

80 ià((
”r
 = 
ch”_desütÜ
[
f8
->
ch”
].
	`ecb_’üy±
(
IV
, f8->
MIV
, &f8->
key
)è!ğ
CRYPT_OK
) {

81 
ch”_desütÜ
[
f8
->
ch”
].
	`dÚe
(&f8->
key
);

82  
”r
;

84 
	`z”omem
(
tkey
, (tkey));

85 
	`z”omem
(
f8
->
IV
, (f8->IV));

88 
ch”_desütÜ
[
f8
->
ch”
].
	`dÚe
(&f8->
key
);

91  
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 
num_rounds
, &
f8
->key);

92 
	}
}

	@libtomcrypt/src/modes/f8/f8_test_mode.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_F8_MODE


21 
	$f8_‹¡_mode
()

23 #iâdeà
LTC_TEST


24  
CRYPT_NOP
;

26 cÚ¡ 
key
[16] = { 0x23, 0x48, 0x29, 0x00, 0x84, 0x67, 0xbe, 0x18,

28 cÚ¡ 
§É
[4] = { 0x32, 0xf2, 0x87, 0x0d };

29 cÚ¡ 
IV
[16] = { 0x00, 0x6e, 0x5c, 0xba, 0x50, 0x68, 0x1d, 0xe5,

31 cÚ¡ 
±
[39] = { 0x70, 0x73, 0x65, 0x75, 0x64, 0x6f, 0x72, 0x61,

36 cÚ¡ 
ù
[39] = { 0x01, 0x9c, 0xe7, 0xa2, 0x6e, 0x78, 0x54, 0x01,

41 
buf
[39];

42 
symm‘ric_F8
 
f8
;

43 
”r
, 
idx
;

45 
idx
 = 
	`fšd_ch”
("aes");

46 ià(
idx
 == -1) {

47 
idx
 = 
	`fšd_ch”
("rijndael");

48 ià(
idx
 =ğ-1è 
CRYPT_NOP
;

52 ià((
”r
 = 
	`f8_¡¬t
(
idx
, 
IV
, 
key
, (key), 
§É
, (§É), 0, &
f8
)è!ğ
CRYPT_OK
) {

53  
”r
;

57 ià((
”r
 = 
	`f8_’üy±
(
±
, 
buf
, Õt), &
f8
)è!ğ
CRYPT_OK
) {

58 
	`f8_dÚe
(&
f8
);

59  
”r
;

61 
	`f8_dÚe
(&
f8
);

64 ià(
	`XMEMCMP
(
buf
, 
ù
, (ct))) {

65  
CRYPT_FAIL_TESTVECTOR
;

68  
CRYPT_OK
;

70 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_decrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


27 
	$Ìw_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_LRW
 *
Ìw
)

29 
”r
;

31 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
Ìw
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
Ìw
->
ch”
)è!ğ
CRYPT_OK
) {

36  
”r
;

39 ià(
ch”_desütÜ
[
Ìw
->
ch”
].
acûl_Ìw_deüy±
 !ğ
NULL
) {

40  
ch”_desütÜ
[
Ìw
->
ch”
].
	`acûl_Ìw_deüy±
(
ù
, 
±
, 
Ën
,†rw->
IV
,†rw->
tw—k
, &Ìw->
key
);

43  
	`Ìw_´oûss
(
ù
, 
±
, 
Ën
, 
LRW_DECRYPT
, 
Ìw
);

44 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


25 
	$Ìw_dÚe
(
symm‘ric_LRW
 *
Ìw
)

27 
”r
;

29 
	`LTC_ARGCHK
(
Ìw
 !ğ
NULL
);

31 ià((
”r
 = 
	`ch”_is_v®id
(
Ìw
->
ch”
)è!ğ
CRYPT_OK
) {

32  
”r
;

34 
ch”_desütÜ
[
Ìw
->
ch”
].
	`dÚe
(&Ìw->
key
);

36  
CRYPT_OK
;

37 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_encrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


27 
	$Ìw_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_LRW
 *
Ìw
)

29 
”r
;

31 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
Ìw
 !ğ
NULL
);

35 ià((
”r
 = 
	`ch”_is_v®id
(
Ìw
->
ch”
)è!ğ
CRYPT_OK
) {

36  
”r
;

39 ià(
ch”_desütÜ
[
Ìw
->
ch”
].
acûl_Ìw_’üy±
 !ğ
NULL
) {

40  
ch”_desütÜ
[
Ìw
->
ch”
].
	`acûl_Ìw_’üy±
(
±
, 
ù
, 
Ën
,†rw->
IV
,†rw->
tw—k
, &Ìw->
key
);

43  
	`Ìw_´oûss
(
±
, 
ù
, 
Ën
, 
LRW_ENCRYPT
, 
Ìw
);

44 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_getiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


27 
	$Ìw_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_LRW
 *
Ìw
)

29 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
Ën
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
Ìw
 !ğ
NULL
);

32 ià(*
Ën
 < 16) {

33 *
Ën
 = 16;

34  
CRYPT_BUFFER_OVERFLOW
;

37 
	`XMEMCPY
(
IV
, 
Ìw
->IV, 16);

38 *
Ën
 = 16;

39  
CRYPT_OK
;

40 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_process.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


29 
	$Ìw_´oûss
(cÚ¡ *
±
, *
ù
, 
Ën
, 
mode
, 
symm‘ric_LRW
 *
Ìw
)

31 
´od
[16];

32 
x
, 
”r
;

33 #ifdeà
LRW_TABLES


34 
y
;

37 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
Ìw
 !ğ
NULL
);

41 ià(
Ën
 & 15) {

42  
CRYPT_INVALID_ARG
;

45 
Ën
) {

47 
	`XMEMCPY
(
´od
, 
Ìw
->
·d
, 16);

50 
x
 = 15; x >= 0; x--) {

51 
Ìw
->
IV
[
x
] = (lrw->IV[x] + 1) & 255;

52 ià(
Ìw
->
IV
[
x
]) {

58 #ifdeà
LRW_TABLES


60 ; 
x
 < 16; x++) {

61 #ifdeà
LTC_FAST


62 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

63 *((
LTC_FAST_TYPE
 *)(
Ìw
->
·d
 + 
y
)è^ğ*((LTC_FAST_TYPE *)(&Ìw->
PC
[
x
][Ìw->
IV
[x]][y])) ^ *((LTC_FAST_TYPE *)(&lrw->PC[x][(lrw->IV[x]-1)&255][y]));

66 
y
 = 0; y < 16; y++) {

67 
Ìw
->
·d
[
y
] ^ğÌw->
PC
[
x
][Ìw->
IV
[x]][y] ^†rw->PC[x][(lrw->IV[x]-1)&255][y];

72 
	`gcm_gf_muÉ
(
Ìw
->
tw—k
,†rw->
IV
,†rw->
·d
);

76 #ifdeà
LTC_FAST


77 
x
 = 0; x < 16; x +ğ(
LTC_FAST_TYPE
)) {

78 *((
LTC_FAST_TYPE
 *)(
ù
 + 
x
)èğ*((LTC_FAST_TYPE *)(
±
 + x)è^ *((LTC_FAST_TYPE *)(
´od
 + x));

81 
x
 = 0; x < 16; x++) {

82 
ù
[
x
] = 
±
[x] ^ 
´od
[x];

87 ià(
mode
 =ğ
LRW_ENCRYPT
) {

88 ià((
”r
 = 
ch”_desütÜ
[
Ìw
->
ch”
].
	`ecb_’üy±
(
ù
, ct, &Ìw->
key
)è!ğ
CRYPT_OK
) {

89  
”r
;

92 ià((
”r
 = 
ch”_desütÜ
[
Ìw
->
ch”
].
	`ecb_deüy±
(
ù
, ct, &Ìw->
key
)è!ğ
CRYPT_OK
) {

93  
”r
;

98 #ifdeà
LTC_FAST


99 
x
 = 0; x < 16; x +ğ(
LTC_FAST_TYPE
)) {

100 *((
LTC_FAST_TYPE
 *)(
ù
 + 
x
)èğ*((LTC_FAST_TYPE *)(ù + x)è^ *((LTC_FAST_TYPE *)(
´od
 + x));

103 
x
 = 0; x < 16; x++) {

104 
ù
[
x
] = ct[x] ^ 
´od
[x];

109 
±
 += 16;

110 
ù
 += 16;

111 
Ën
 -= 16;

114  
CRYPT_OK
;

115 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_setiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


27 
	$Ìw_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_LRW
 *
Ìw
)

29 
”r
;

30 #ifdeà
LRW_TABLES


31 
T
[16];

32 
x
, 
y
;

34 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
Ìw
 !ğ
NULL
);

37 ià(
Ën
 != 16) {

38  
CRYPT_INVALID_ARG
;

41 ià((
”r
 = 
	`ch”_is_v®id
(
Ìw
->
ch”
)è!ğ
CRYPT_OK
) {

42  
”r
;

46 
	`XMEMCPY
(
Ìw
->
IV
, IV, 16);

49 ià(
ch”_desütÜ
[
Ìw
->
ch”
].
acûl_Ìw_’üy±
 !ğ
NULL
 && ch”_desütÜ[Ìw->ch”].
acûl_Ìw_deüy±
 != NULL) {

51  
CRYPT_OK
;

54 #ifdeà
LRW_TABLES


55 
	`XMEMCPY
(
T
, &
Ìw
->
PC
[0][
IV
[0]][0], 16);

56 
x
 = 1; x < 16; x++) {

57 #ifdeà
LTC_FAST


58 
y
 = 0; y < 16; y +ğ(
LTC_FAST_TYPE
)) {

59 *((
LTC_FAST_TYPE
 *)(
T
 + 
y
)è^ğ*((LTC_FAST_TYPE *)(&
Ìw
->
PC
[
x
][
IV
[x]][y]));

62 
y
 = 0; y < 16; y++) {

63 
T
[
y
] ^ğ
Ìw
->
PC
[
x
][
IV
[x]][y];

67 
	`XMEMCPY
(
Ìw
->
·d
, 
T
, 16);

69 
	`gcm_gf_muÉ
(
Ìw
->
tw—k
, 
IV
,†rw->
·d
);

72  
CRYPT_OK
;

73 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_start.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


31 
	$Ìw_¡¬t
Ğ
ch”
,

32 cÚ¡ *
IV
,

33 cÚ¡ *
key
, 
keyËn
,

34 cÚ¡ *
tw—k
,

35 
num_rounds
,

36 
symm‘ric_LRW
 *
Ìw
)

38 
”r
;

39 #ifdeà
LRW_TABLES


40 
B
[16];

41 
x
, 
y
, 
z
, 
t
;

44 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
tw—k
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
Ìw
 !ğ
NULL
);

49 #ifdeà
LTC_FAST


50 ià(16 % (
LTC_FAST_TYPE
)) {

51  
CRYPT_INVALID_ARG
;

56 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

57  
”r
;

59 ià(
ch”_desütÜ
[
ch”
].
block_Ëngth
 != 16) {

60  
CRYPT_INVALID_CIPHER
;

64 ià((
”r
 = 
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 
num_rounds
, &
Ìw
->key)è!ğ
CRYPT_OK
) {

65  
”r
;

67 
Ìw
->
ch”
 = cipher;

70 
	`XMEMCPY
(
Ìw
->
tw—k
,weak, 16);

72 #ifdeà
LRW_TABLES


75 
	`z”omem
(
B
, 16);

76 
y
 = 0; y < 256; y++) {

77 
B
[0] = 
y
;

78 
	`gcm_gf_muÉ
(
tw—k
, 
B
, &
Ìw
->
PC
[0][
y
][0]);

82 
x
 = 1; x < 16; x++) {

83 
y
 = 0; y < 256; y++) {

85 
t
 = 
Ìw
->
PC
[
x
-1][
y
][15];

86 
z
 = 15; z > 0; z--) {

87 
Ìw
->
PC
[
x
][
y
][
z
] =†rw->PC[x-1][y][z-1];

89 
Ìw
->
PC
[
x
][
y
][0] = 
gcm_shiá_bË
[
t
<<1];

90 
Ìw
->
PC
[
x
][
y
][1] ^ğ
gcm_shiá_bË
[(
t
<<1)+1];

96  
	`Ìw_£tiv
(
IV
, 16, 
Ìw
);

97 
	}
}

	@libtomcrypt/src/modes/lrw/lrw_test.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_LRW_MODE


24 
	$Ìw_‹¡
()

26 #iâdeà 
LTC_TEST


27  
CRYPT_NOP
;

30 
key
[16], 
tw—k
[16], 
IV
[16], 
P
[16], 
ex³ùed_tw—k
[16], 
C
[16];

31 } 
‹¡s
[] = {

72 
idx
, 
”r
, 
x
;

73 
symm‘ric_LRW
 
Ìw
;

74 
buf
[2][16];

76 
idx
 = 
	`fšd_ch”
("aes");

77 ià(
idx
 == -1) {

78 
idx
 = 
	`fšd_ch”
("rijndael");

79 ià(
idx
 == -1) {

80  
CRYPT_NOP
;

84 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

86 ià((
”r
 = 
	`Ìw_¡¬t
(
idx
, 
‹¡s
[
x
].
IV
,e¡s[x].
key
, 16,e¡s[x].
tw—k
, 0, &
Ìw
)è!ğ
CRYPT_OK
) {

87  
”r
;

91 ià(
	`XMEMCMP
(
‹¡s
[
x
].
ex³ùed_tw—k
, 
Ìw
.
·d
, 16)) {

92 
	`Ìw_dÚe
(&
Ìw
);

93  
CRYPT_FAIL_TESTVECTOR
;

97 ià((
”r
 = 
	`Ìw_’üy±
(
‹¡s
[
x
].
P
, 
buf
[0], 16, &
Ìw
)è!ğ
CRYPT_OK
) {

98 
	`Ìw_dÚe
(&
Ìw
);

99  
”r
;

102 ià(
	`XMEMCMP
(
buf
[0], 
‹¡s
[
x
].
C
, 16)) {

103 
	`Ìw_dÚe
(&
Ìw
);

104  
CRYPT_FAIL_TESTVECTOR
;

108 ià((
”r
 = 
	`Ìw_£tiv
(
‹¡s
[
x
].
IV
, 16, &
Ìw
)è!ğ
CRYPT_OK
) {

109 
	`Ìw_dÚe
(&
Ìw
);

110  
”r
;

113 ià((
”r
 = 
	`Ìw_deüy±
(
buf
[0], buf[1], 16, &
Ìw
)è!ğ
CRYPT_OK
) {

114 
	`Ìw_dÚe
(&
Ìw
);

115  
”r
;

118 ià(
	`XMEMCMP
(
buf
[1], 
‹¡s
[
x
].
P
, 16)) {

119 
	`Ìw_dÚe
(&
Ìw
);

120  
CRYPT_FAIL_TESTVECTOR
;

122 ià((
”r
 = 
	`Ìw_dÚe
(&
Ìw
)è!ğ
CRYPT_OK
) {

123  
”r
;

126  
CRYPT_OK
;

128 
	}
}

	@libtomcrypt/src/modes/ofb/ofb_decrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OFB_MODE


28 
	$ofb_deüy±
(cÚ¡ *
ù
, *
±
, 
Ën
, 
symm‘ric_OFB
 *
ofb
)

30 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ofb
 !ğ
NULL
);

33  
	`ofb_’üy±
(
ù
, 
±
, 
Ën
, 
ofb
);

34 
	}
}

	@libtomcrypt/src/modes/ofb/ofb_done.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OFB_MODE


24 
	$ofb_dÚe
(
symm‘ric_OFB
 *
ofb
)

26 
”r
;

27 
	`LTC_ARGCHK
(
ofb
 !ğ
NULL
);

29 ià((
”r
 = 
	`ch”_is_v®id
(
ofb
->
ch”
)è!ğ
CRYPT_OK
) {

30  
”r
;

32 
ch”_desütÜ
[
ofb
->
ch”
].
	`dÚe
(&ofb->
key
);

33  
CRYPT_OK
;

34 
	}
}

	@libtomcrypt/src/modes/ofb/ofb_encrypt.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OFB_MODE


28 
	$ofb_’üy±
(cÚ¡ *
±
, *
ù
, 
Ën
, 
symm‘ric_OFB
 *
ofb
)

30 
”r
;

31 
	`LTC_ARGCHK
(
±
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ù
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
ofb
 !ğ
NULL
);

34 ià((
”r
 = 
	`ch”_is_v®id
(
ofb
->
ch”
)è!ğ
CRYPT_OK
) {

35  
”r
;

39 ià(
ofb
->
blockËn
 < 0 || ofb->blockËÀ> ()(ofb->
IV
) ||

40 
ofb
->
·dËn
 < 0 || ofb->·dËÀ> ()(ofb->
IV
)) {

41  
CRYPT_INVALID_ARG
;

44 
Ën
-- > 0) {

45 ià(
ofb
->
·dËn
 =ğofb->
blockËn
) {

46 ià((
”r
 = 
ch”_desütÜ
[
ofb
->
ch”
].
	`ecb_’üy±
(ofb->
IV
, ofb->IV, &ofb->
key
)è!ğ
CRYPT_OK
) {

47  
”r
;

49 
ofb
->
·dËn
 = 0;

51 *
ù
++ = *
±
++ ^ 
ofb
->
IV
[(ofb->
·dËn
)++];

53  
CRYPT_OK
;

54 
	}
}

	@libtomcrypt/src/modes/ofb/ofb_getiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OFB_MODE


27 
	$ofb_g‘iv
(*
IV
, *
Ën
, 
symm‘ric_OFB
 *
ofb
)

29 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

30 
	`LTC_ARGCHK
(
Ën
 !ğ
NULL
);

31 
	`LTC_ARGCHK
(
ofb
 !ğ
NULL
);

32 ià(()
ofb
->
blockËn
 > *
Ën
) {

33 *
Ën
 = 
ofb
->
blockËn
;

34  
CRYPT_BUFFER_OVERFLOW
;

36 
	`XMEMCPY
(
IV
, 
ofb
->IV, ofb->
blockËn
);

37 *
Ën
 = 
ofb
->
blockËn
;

39  
CRYPT_OK
;

40 
	}
}

	@libtomcrypt/src/modes/ofb/ofb_setiv.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_OFB_MODE


27 
	$ofb_£tiv
(cÚ¡ *
IV
, 
Ën
, 
symm‘ric_OFB
 *
ofb
)

29 
”r
;

31 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ofb
 !ğ
NULL
);

34 ià((
”r
 = 
	`ch”_is_v®id
(
ofb
->
ch”
)è!ğ
CRYPT_OK
) {

35  
”r
;

38 ià(
Ën
 !ğ()
ofb
->
blockËn
) {

39  
CRYPT_INVALID_ARG
;

43 
ofb
->
·dËn
 = 0;

44  
ch”_desütÜ
[
ofb
->
ch”
].
	`ecb_’üy±
(
IV
, ofb->IV, &ofb->
key
);

45 
	}
}

	@libtomcrypt/src/modes/ofb/ofb_start.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_OFB_MODE


31 
	$ofb_¡¬t
(
ch”
, cÚ¡ *
IV
, cÚ¡ *
key
,

32 
keyËn
, 
num_rounds
, 
symm‘ric_OFB
 *
ofb
)

34 
x
, 
”r
;

36 
	`LTC_ARGCHK
(
IV
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
ofb
 !ğ
NULL
);

40 ià((
”r
 = 
	`ch”_is_v®id
(
ch”
)è!ğ
CRYPT_OK
) {

41  
”r
;

45 
ofb
->
ch”
 = cipher;

46 
ofb
->
blockËn
 = 
ch”_desütÜ
[
ch”
].
block_Ëngth
;

47 
x
 = 0; x < 
ofb
->
blockËn
; x++) {

48 
ofb
->
IV
[
x
] = IV[x];

52 
ofb
->
·dËn
 = ofb->
blockËn
;

53  
ch”_desütÜ
[
ch”
].
	`£tup
(
key
, 
keyËn
, 
num_rounds
, &
ofb
->key);

54 
	}
}

	@libtomcrypt/src/pk/asn1/der/bit/der_decode_bit_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_decode_b™_¡ršg
(cÚ¡ *
š
, 
šËn
,

30 *
out
, *
ou’
)

32 
dËn
, 
bËn
, 
x
, 
y
;

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

39 ià(
šËn
 < 4) {

40  
CRYPT_INVALID_ARG
;

44 ià((
š
[0]&0x1F) != 0x03) {

45  
CRYPT_INVALID_PACKET
;

49 
x
 = 1;

52 ià(
š
[
x
] & 0x80) {

54 
y
 = 
š
[
x
++] & 0x7F;

57 ià(
y
 == 0 || y > 2) {

58  
CRYPT_INVALID_PACKET
;

62 
dËn
 = 0;

63 
y
--) {

64 
dËn
 = (dËÀ<< 8è| ()
š
[
x
++];

68 
dËn
 = 
š
[
x
++] & 0x7F;

72 ià((
dËn
 =ğ0è|| (dËÀ+ 
x
 > 
šËn
)) {

73  
CRYPT_INVALID_PACKET
;

77 
bËn
 = ((
dËn
 - 1è<< 3è- (
š
[
x
++] & 7);

80 ià(
bËn
 > *
ou’
) {

81 *
ou’
 = 
bËn
;

82  
CRYPT_BUFFER_OVERFLOW
;

86 
y
 = 0; y < 
bËn
; y++) {

87 
out
[
y
] = (
š
[
x
] & (1 << (7 - (y & 7)))) ? 1 : 0;

88 ià((
y
 & 7) == 7) {

89 ++
x
;

94 *
ou’
 = 
bËn
;

95  
CRYPT_OK
;

96 
	}
}

	@libtomcrypt/src/pk/asn1/der/bit/der_encode_bit_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_’code_b™_¡ršg
(cÚ¡ *
š
, 
šËn
,

30 *
out
, *
ou’
)

32 
Ën
, 
x
, 
y
;

33 
buf
;

34 
”r
;

36 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

41 ià((
”r
 = 
	`d”_Ëngth_b™_¡ršg
(
šËn
, &
Ën
)è!ğ
CRYPT_OK
) {

42  
”r
;

45 ià(
Ën
 > *
ou’
) {

46 *
ou’
 = 
Ën
;

47  
CRYPT_BUFFER_OVERFLOW
;

51 
x
 = 0;

52 
y
 = (
šËn
 >> 3) + ((inlen&7) ? 1 : 0) + 1;

54 
out
[
x
++] = 0x03;

55 ià(
y
 < 128) {

56 
out
[
x
++] = ()
y
;

57 } ià(
y
 < 256) {

58 
out
[
x
++] = 0x81;

59 
out
[
x
++] = ()
y
;

60 } ià(
y
 < 65536) {

61 
out
[
x
++] = 0x82;

62 
out
[
x
++] = ()((
y
>>8)&255);

63 
out
[
x
++] = ()(
y
&255);

67 
out
[
x
++] = ()((8 - 
šËn
) & 7);

70 
y
 = 
buf
 = 0; y < 
šËn
; y++) {

71 
buf
 |ğ(
š
[
y
] ? 1 : 0) << (7 - (y & 7));

72 ià((
y
 & 7) == 7) {

73 
out
[
x
++] = 
buf
;

74 
buf
 = 0;

78 ià(
šËn
 & 7) {

79 
out
[
x
++] = 
buf
;

81 *
ou’
 = 
x
;

82  
CRYPT_OK
;

83 
	}
}

	@libtomcrypt/src/pk/asn1/der/bit/der_length_bit_string.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


25 
	$d”_Ëngth_b™_¡ršg
(
nb™s
, *
ou’
)

27 
nby‹s
;

28 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

31 
nby‹s
 = (
nb™s
 >> 3) + ((nbits & 7) ? 1 : 0) + 1;

33 ià(
nby‹s
 < 128) {

35 *
ou’
 = 2 + 
nby‹s
;

36 } ià(
nby‹s
 < 256) {

38 *
ou’
 = 3 + 
nby‹s
;

39 } ià(
nby‹s
 < 65536) {

41 *
ou’
 = 4 + 
nby‹s
;

43  
CRYPT_INVALID_ARG
;

46  
CRYPT_OK
;

47 
	}
}

	@libtomcrypt/src/pk/asn1/der/boolean/der_decode_boolean.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


28 
	$d”_decode_boŞ—n
(cÚ¡ *
š
, 
šËn
,

29 *
out
)

31 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

34 ià(
šËn
 !ğ3 || 
š
[0] != 0x01 || in[1] != 0x01 || (in[2] != 0x00 && in[2] != 0xFF)) {

35  
CRYPT_INVALID_ARG
;

38 *
out
 = (
š
[2]==0xFF) ? 1 : 0;

40  
CRYPT_OK
;

41 
	}
}

	@libtomcrypt/src/pk/asn1/der/boolean/der_encode_boolean.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


28 
	$d”_’code_boŞ—n
(
š
,

29 *
out
, *
ou’
)

31 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

34 ià(*
ou’
 < 3) {

35 *
ou’
 = 3;

36  
CRYPT_BUFFER_OVERFLOW
;

39 *
ou’
 = 3;

40 
out
[0] = 0x01;

41 
out
[1] = 0x01;

42 
out
[2] = 
š
 ? 0xFF : 0x00;

44  
CRYPT_OK
;

45 
	}
}

	@libtomcrypt/src/pk/asn1/der/boolean/der_length_boolean.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


24 
	$d”_Ëngth_boŞ—n
(*
ou’
)

26 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

27 *
ou’
 = 3;

28  
CRYPT_OK
;

29 
	}
}

	@libtomcrypt/src/pk/asn1/der/choice/der_decode_choice.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


28 
	$d”_decode_choiû
(cÚ¡ *
š
, *
šËn
,

29 
Éc_a¢1_li¡
 *
li¡
, 
ou’
)

31 
size
, 
x
, 
z
;

32 *
d©a
;

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
šËn
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
li¡
 !ğ
NULL
);

39 ià(*
šËn
 < 2) {

40  
CRYPT_INVALID_PACKET
;

44 
x
 = 0; x < 
ou’
; x++) {

45 
li¡
[
x
].
u£d
 = 0;

49 
x
 = 0; x < 
ou’
; x++) {

50 
size
 = 
li¡
[
x
].size;

51 
d©a
 = 
li¡
[
x
].data;

53 
li¡
[
x
].
ty³
) {

54 
LTC_ASN1_INTEGER
:

55 ià(
	`d”_decode_š‹g”
(
š
, *
šËn
, 
d©a
è=ğ
CRYPT_OK
) {

56 ià(
	`d”_Ëngth_š‹g”
(
d©a
, &
z
è=ğ
CRYPT_OK
) {

57 
li¡
[
x
].
u£d
 = 1;

58 *
šËn
 = 
z
;

59  
CRYPT_OK
;

64 
LTC_ASN1_SHORT_INTEGER
:

65 ià(
	`d”_decode_shÜt_š‹g”
(
š
, *
šËn
, 
d©a
è=ğ
CRYPT_OK
) {

66 ià(
	`d”_Ëngth_shÜt_š‹g”
(
size
, &
z
è=ğ
CRYPT_OK
) {

67 
li¡
[
x
].
u£d
 = 1;

68 *
šËn
 = 
z
;

69  
CRYPT_OK
;

74 
LTC_ASN1_BIT_STRING
:

75 ià(
	`d”_decode_b™_¡ršg
(
š
, *
šËn
, 
d©a
, &
size
è=ğ
CRYPT_OK
) {

76 ià(
	`d”_Ëngth_b™_¡ršg
(
size
, &
z
è=ğ
CRYPT_OK
) {

77 
li¡
[
x
].
u£d
 = 1;

78 
li¡
[
x
].
size
 = size;

79 *
šËn
 = 
z
;

80  
CRYPT_OK
;

85 
LTC_ASN1_OCTET_STRING
:

86 ià(
	`d”_decode_où‘_¡ršg
(
š
, *
šËn
, 
d©a
, &
size
è=ğ
CRYPT_OK
) {

87 ià(
	`d”_Ëngth_où‘_¡ršg
(
size
, &
z
è=ğ
CRYPT_OK
) {

88 
li¡
[
x
].
u£d
 = 1;

89 
li¡
[
x
].
size
 = size;

90 *
šËn
 = 
z
;

91  
CRYPT_OK
;

96 
LTC_ASN1_NULL
:

97 ià(*
šËn
 =ğ2 && 
š
[
x
] == 0x05 && in[x+1] == 0x00) {

98 *
šËn
 = 2;

99 
li¡
[
x
].
u£d
 = 1;

100  
CRYPT_OK
;

104 
LTC_ASN1_OBJECT_IDENTIFIER
:

105 ià(
	`d”_decode_objeù_id’tif›r
(
š
, *
šËn
, 
d©a
, &
size
è=ğ
CRYPT_OK
) {

106 ià(
	`d”_Ëngth_objeù_id’tif›r
(
d©a
, 
size
, &
z
è=ğ
CRYPT_OK
) {

107 
li¡
[
x
].
u£d
 = 1;

108 
li¡
[
x
].
size
 = size;

109 *
šËn
 = 
z
;

110  
CRYPT_OK
;

115 
LTC_ASN1_IA5_STRING
:

116 ià(
	`d”_decode_Ÿ5_¡ršg
(
š
, *
šËn
, 
d©a
, &
size
è=ğ
CRYPT_OK
) {

117 ià(
	`d”_Ëngth_Ÿ5_¡ršg
(
d©a
, 
size
, &
z
è=ğ
CRYPT_OK
) {

118 
li¡
[
x
].
u£d
 = 1;

119 
li¡
[
x
].
size
 = size;

120 *
šËn
 = 
z
;

121  
CRYPT_OK
;

127 
LTC_ASN1_PRINTABLE_STRING
:

128 ià(
	`d”_decode_´šbË_¡ršg
(
š
, *
šËn
, 
d©a
, &
size
è=ğ
CRYPT_OK
) {

129 ià(
	`d”_Ëngth_´šbË_¡ršg
(
d©a
, 
size
, &
z
è=ğ
CRYPT_OK
) {

130 
li¡
[
x
].
u£d
 = 1;

131 
li¡
[
x
].
size
 = size;

132 *
šËn
 = 
z
;

133  
CRYPT_OK
;

138 
LTC_ASN1_UTF8_STRING
:

139 ià(
	`d”_decode_utf8_¡ršg
(
š
, *
šËn
, 
d©a
, &
size
è=ğ
CRYPT_OK
) {

140 ià(
	`d”_Ëngth_utf8_¡ršg
(
d©a
, 
size
, &
z
è=ğ
CRYPT_OK
) {

141 
li¡
[
x
].
u£d
 = 1;

142 
li¡
[
x
].
size
 = size;

143 *
šËn
 = 
z
;

144  
CRYPT_OK
;

149 
LTC_ASN1_UTCTIME
:

150 
z
 = *
šËn
;

151 ià(
	`d”_decode_utùime
(
š
, &
z
, 
d©a
è=ğ
CRYPT_OK
) {

152 
li¡
[
x
].
u£d
 = 1;

153 *
šËn
 = 
z
;

154  
CRYPT_OK
;

158 
LTC_ASN1_SET
:

159 
LTC_ASN1_SETOF
:

160 
LTC_ASN1_SEQUENCE
:

161 ià(
	`d”_decode_£qu’û
(
š
, *
šËn
, 
d©a
, 
size
è=ğ
CRYPT_OK
) {

162 ià(
	`d”_Ëngth_£qu’û
(
d©a
, 
size
, &
z
è=ğ
CRYPT_OK
) {

163 
li¡
[
x
].
u£d
 = 1;

164 *
šËn
 = 
z
;

165  
CRYPT_OK
;

171  
CRYPT_INVALID_ARG
;

175  
CRYPT_INVALID_PACKET
;

176 
	}
}

	@libtomcrypt/src/pk/asn1/der/ia5/der_decode_ia5_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_decode_Ÿ5_¡ršg
(cÚ¡ *
š
, 
šËn
,

30 *
out
, *
ou’
)

32 
x
, 
y
, 
Ën
;

33 
t
;

35 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

40 ià(
šËn
 < 2) {

41  
CRYPT_INVALID_PACKET
;

45 ià((
š
[0] & 0x1F) != 0x16) {

46  
CRYPT_INVALID_PACKET
;

48 
x
 = 1;

51 ià(
š
[
x
] & 0x80) {

53 
y
 = 
š
[
x
] & 0x7F;

54 ià((
y
 =ğ0è|| (y > 3è|| ((
x
 + yè> 
šËn
)) {

55  
CRYPT_INVALID_PACKET
;

59 
Ën
 = 0;

60 ++
x
;

61 
y
--) {

62 
Ën
 = (ËÀ<< 8è| 
š
[
x
++];

65 
Ën
 = 
š
[
x
++] & 0x7F;

69 ià(
Ën
 > *
ou’
) {

70 *
ou’
 = 
Ën
;

71  
CRYPT_BUFFER_OVERFLOW
;

74 ià(
Ën
 + 
x
 > 
šËn
) {

75  
CRYPT_INVALID_PACKET
;

79 
y
 = 0; y < 
Ën
; y++) {

80 
t
 = 
	`d”_Ÿ5_v®ue_decode
(
š
[
x
++]);

81 ià(
t
 == -1) {

82  
CRYPT_INVALID_ARG
;

84 
out
[
y
] = 
t
;

87 *
ou’
 = 
y
;

89  
CRYPT_OK
;

90 
	}
}

	@libtomcrypt/src/pk/asn1/der/ia5/der_encode_ia5_string.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


28 
	$d”_’code_Ÿ5_¡ršg
(cÚ¡ *
š
, 
šËn
,

29 *
out
, *
ou’
)

31 
x
, 
y
, 
Ën
;

32 
”r
;

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

39 ià((
”r
 = 
	`d”_Ëngth_Ÿ5_¡ršg
(
š
, 
šËn
, &
Ën
)è!ğ
CRYPT_OK
) {

40  
”r
;

44 ià(
Ën
 > *
ou’
) {

45 *
ou’
 = 
Ën
;

46  
CRYPT_BUFFER_OVERFLOW
;

50 
x
 = 0;

51 
out
[
x
++] = 0x16;

52 ià(
šËn
 < 128) {

53 
out
[
x
++] = ()
šËn
;

54 } ià(
šËn
 < 256) {

55 
out
[
x
++] = 0x81;

56 
out
[
x
++] = ()
šËn
;

57 } ià(
šËn
 < 65536UL) {

58 
out
[
x
++] = 0x82;

59 
out
[
x
++] = ()((
šËn
>>8)&255);

60 
out
[
x
++] = ()(
šËn
&255);

61 } ià(
šËn
 < 16777216UL) {

62 
out
[
x
++] = 0x83;

63 
out
[
x
++] = ()((
šËn
>>16)&255);

64 
out
[
x
++] = ()((
šËn
>>8)&255);

65 
out
[
x
++] = ()(
šËn
&255);

67  
CRYPT_INVALID_ARG
;

71 
y
 = 0; y < 
šËn
; y++) {

72 
out
[
x
++] = 
	`d”_Ÿ5_ch¬_’code
(
š
[
y
]);

76 *
ou’
 = 
x
;

78  
CRYPT_OK
;

79 
	}
}

	@libtomcrypt/src/pk/asn1/der/ia5/der_length_ia5_string.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


21 
	mcode
, 
	mv®ue
;

22 } 
	gŸ5_bË
[] = {

127 
	$d”_Ÿ5_ch¬_’code
(
c
)

129 
x
;

130 
x
 = 0; x < ()((
Ÿ5_bË
)/(ia5_table[0])); x++) {

131 ià(
Ÿ5_bË
[
x
].
code
 =ğ
c
) {

132  
Ÿ5_bË
[
x
].
v®ue
;

136 
	}
}

138 
	$d”_Ÿ5_v®ue_decode
(
v
)

140 
x
;

141 
x
 = 0; x < ()((
Ÿ5_bË
)/(ia5_table[0])); x++) {

142 ià(
Ÿ5_bË
[
x
].
v®ue
 =ğ
v
) {

143  
Ÿ5_bË
[
x
].
code
;

147 
	}
}

156 
	$d”_Ëngth_Ÿ5_¡ršg
(cÚ¡ *
où‘s
, 
noù‘s
, *
ou’
)

158 
x
;

160 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

161 
	`LTC_ARGCHK
(
où‘s
 !ğ
NULL
);

164 
x
 = 0; x < 
noù‘s
; x++) {

165 ià(
	`d”_Ÿ5_ch¬_’code
(
où‘s
[
x
]) == -1) {

166  
CRYPT_INVALID_ARG
;

170 ià(
noù‘s
 < 128) {

172 *
ou’
 = 2 + 
noù‘s
;

173 } ià(
noù‘s
 < 256) {

175 *
ou’
 = 3 + 
noù‘s
;

176 } ià(
noù‘s
 < 65536UL) {

178 *
ou’
 = 4 + 
noù‘s
;

179 } ià(
noù‘s
 < 16777216UL) {

181 *
ou’
 = 5 + 
noù‘s
;

183  
CRYPT_INVALID_ARG
;

186  
CRYPT_OK
;

187 
	}
}

	@libtomcrypt/src/pk/asn1/der/integer/der_decode_integer.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


28 
	$d”_decode_š‹g”
(cÚ¡ *
š
, 
šËn
, *
num
)

30 
x
, 
y
, 
z
;

31 
”r
;

33 
	`LTC_ARGCHK
(
num
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

37 ià(
šËn
 < (1 + 1 + 1)) {

38  
CRYPT_INVALID_PACKET
;

42 
x
 = 0;

43 ià((
š
[
x
++] & 0x1F) != 0x02) {

44  
CRYPT_INVALID_PACKET
;

48 
z
 = 
š
[
x
++];

50 ià((
z
 & 0x80) == 0x00) {

54 ià(
x
 + 
z
 > 
šËn
) {

55  
CRYPT_INVALID_PACKET
;

59 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
num
, (*)
š
 + 
x
, 
z
)è!ğ
CRYPT_OK
) {

60  
”r
;

64 
z
 &= 0x7F;

67 ià(((
x
 + 
z
è> 
šËn
) || (z > 4) || (z == 0)) {

68  
CRYPT_INVALID_PACKET
;

72 
y
 = 0;

73 
z
--) {

74 
y
 = (()(
š
[
x
++])) | (y << 8);

78 ià((
x
 + 
y
è> 
šËn
) {

79  
CRYPT_INVALID_PACKET
;

83 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
num
, (*)
š
 + 
x
, 
y
)è!ğ
CRYPT_OK
) {

84  
”r
;

89 ià(
š
[
x
] & 0x80) {

90 *
tmp
;

91 ià(
	`mp_š™
(&
tmp
è!ğ
CRYPT_OK
) {

92  
CRYPT_MEM
;

95 ià(
	`mp_2ex±
(
tmp
, 
	`mp_couÁ_b™s
(
num
)è!ğ
CRYPT_OK
 || 
	`mp_sub
(num,mp,‚um) != CRYPT_OK) {

96 
	`mp_ş—r
(
tmp
);

97  
CRYPT_MEM
;

99 
	`mp_ş—r
(
tmp
);

102  
CRYPT_OK
;

104 
	}
}

	@libtomcrypt/src/pk/asn1/der/integer/der_encode_integer.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_’code_š‹g”
(*
num
, *
out
, *
ou’
)

31 
tm¶’
, 
y
;

32 
”r
, 
Ëadšg_z”o
;

34 
	`LTC_ARGCHK
(
num
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

39 ià((
”r
 = 
	`d”_Ëngth_š‹g”
(
num
, &
tm¶’
)è!ğ
CRYPT_OK
) {

40  
”r
;

43 ià(*
ou’
 < 
tm¶’
) {

44 *
ou’
 = 
tm¶’
;

45  
CRYPT_BUFFER_OVERFLOW
;

48 ià(
	`mp_cmp_d
(
num
, 0è!ğ
LTC_MP_LT
) {

50 ià((
	`mp_couÁ_b™s
(
num
è& 7è=ğ0 || 
	`mp_isz”o
Òumè=ğ
LTC_MP_YES
) {

51 
Ëadšg_z”o
 = 1;

53 
Ëadšg_z”o
 = 0;

57 
y
 = 
	`mp_unsigÃd_bš_size
(
num
è+ 
Ëadšg_z”o
;

59 
Ëadšg_z”o
 = 0;

60 
y
 = 
	`mp_couÁ_b™s
(
num
);

61 
y
 = y + (8 - (y & 7));

62 
y
 = y >> 3;

63 ià(((
	`mp_út_lsb
(
num
)+1)==
	`mp_couÁ_b™s
Òum)è&& ((mp_couÁ_b™sÒum)&7)==0)è--
y
;

67 *
out
++ = 0x02;

68 ià(
y
 < 128) {

70 *
out
++ = ()
y
;

71 } ià(
y
 < 256) {

72 *
out
++ = 0x81;

73 *
out
++ = ()
y
;

74 } ià(
y
 < 65536UL) {

75 *
out
++ = 0x82;

76 *
out
++ = ()((
y
>>8)&255);

77 *
out
++ = ()
y
;

78 } ià(
y
 < 16777216UL) {

79 *
out
++ = 0x83;

80 *
out
++ = ()((
y
>>16)&255);

81 *
out
++ = ()((
y
>>8)&255);

82 *
out
++ = ()
y
;

84  
CRYPT_INVALID_ARG
;

88 ià(
Ëadšg_z”o
) {

89 *
out
++ = 0x00;

93 ià(
	`mp_cmp_d
(
num
, 0è=ğ
LTC_MP_GT
) {

95 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
num
, 
out
)è!ğ
CRYPT_OK
) {

96  
”r
;

98 } ià(
	`mp_isz”o
(
num
è!ğ
LTC_MP_YES
) {

99 *
tmp
;

102 ià(
	`mp_š™
(&
tmp
è!ğ
CRYPT_OK
) {

103  
CRYPT_MEM
;

107 
y
 = 
	`mp_couÁ_b™s
(
num
);

108 
y
 = y + (8 - (y & 7));

109 ià(((
	`mp_út_lsb
(
num
)+1)==
	`mp_couÁ_b™s
Òum)è&& ((mp_couÁ_b™sÒum)&7)==0)è
y
 -= 8;

110 ià(
	`mp_2ex±
(
tmp
, 
y
è!ğ
CRYPT_OK
 || 
	`mp_add
Ñmp, 
num
,mp) != CRYPT_OK) {

111 
	`mp_ş—r
(
tmp
);

112  
CRYPT_MEM
;

114 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
tmp
, 
out
)è!ğ
CRYPT_OK
) {

115 
	`mp_ş—r
(
tmp
);

116  
”r
;

118 
	`mp_ş—r
(
tmp
);

122 *
ou’
 = 
tm¶’
;

123  
CRYPT_OK
;

124 
	}
}

	@libtomcrypt/src/pk/asn1/der/integer/der_length_integer.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


26 
	$d”_Ëngth_š‹g”
(*
num
, *
ou’
)

28 
z
, 
Ën
;

29 
Ëadšg_z”o
;

31 
	`LTC_ARGCHK
(
num
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

34 ià(
	`mp_cmp_d
(
num
, 0è!ğ
LTC_MP_LT
) {

38 ià((
	`mp_couÁ_b™s
(
num
è& 7è=ğ0 || 
	`mp_isz”o
Òumè=ğ
LTC_MP_YES
) {

39 
Ëadšg_z”o
 = 1;

41 
Ëadšg_z”o
 = 0;

45 
z
 = 
Ën
 = 
Ëadšg_z”o
 + 
	`mp_unsigÃd_bš_size
(
num
);

49 
Ëadšg_z”o
 = 0;

50 
z
 = 
	`mp_couÁ_b™s
(
num
);

51 
z
 = z + (8 - (z & 7));

52 ià(((
	`mp_út_lsb
(
num
)+1)==
	`mp_couÁ_b™s
Òum)è&& ((mp_couÁ_b™sÒum)&7)==0)è--
z
;

53 
Ën
 = 
z
 = z >> 3;

57 ià(
z
 < 128) {

59 ++
Ën
;

62 ++
Ën
;

64 
z
) {

65 ++
Ën
;

66 
z
 >>= 8;

71 ++
Ën
;

74 *
ou’
 = 
Ën
;

75  
CRYPT_OK
;

76 
	}
}

	@libtomcrypt/src/pk/asn1/der/object_identifier/der_decode_object_identifier.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


27 
	$d”_decode_objeù_id’tif›r
(cÚ¡ *
š
, 
šËn
,

28 *
wÜds
, *
ou’
)

30 
x
, 
y
, 
t
, 
Ën
;

32 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
wÜds
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

37 ià(
šËn
 < 3) {

38  
CRYPT_INVALID_PACKET
;

42 ià(*
ou’
 < 2) {

43  
CRYPT_BUFFER_OVERFLOW
;

47 
x
 = 0;

48 ià((
š
[
x
++] & 0x1F) != 0x06) {

49  
CRYPT_INVALID_PACKET
;

53 ià(
š
[
x
] < 128) {

54 
Ën
 = 
š
[
x
++];

56 ià(
š
[
x
] < 0x81 || in[x] > 0x82) {

57  
CRYPT_INVALID_PACKET
;

59 
y
 = 
š
[
x
++] & 0x7F;

60 
Ën
 = 0;

61 
y
--) {

62 
Ën
 = (ËÀ<< 8è| ()
š
[
x
++];

66 ià(
Ën
 < 1 || (ËÀ+ 
x
è> 
šËn
) {

67  
CRYPT_INVALID_PACKET
;

71 
y
 = 0;

72 
t
 = 0;

73 
Ën
--) {

74 
t
 = (ˆ<< 7è| (
š
[
x
] & 0x7F);

75 ià(!(
š
[
x
++] & 0x80)) {

77 ià(
y
 >ğ*
ou’
) {

78  
CRYPT_BUFFER_OVERFLOW
;

80 ià(
y
 == 0) {

81 
wÜds
[0] = 
t
 / 40;

82 
wÜds
[1] = 
t
 % 40;

83 
y
 = 2;

85 
wÜds
[
y
++] = 
t
;

87 
t
 = 0;

91 *
ou’
 = 
y
;

92  
CRYPT_OK
;

93 
	}
}

	@libtomcrypt/src/pk/asn1/der/object_identifier/der_encode_object_identifier.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


27 
	$d”_’code_objeù_id’tif›r
(*
wÜds
, 
nwÜds
,

28 *
out
, *
ou’
)

30 
i
, 
x
, 
y
, 
z
, 
t
, 
mask
, 
wÜdbuf
;

31 
”r
;

33 
	`LTC_ARGCHK
(
wÜds
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

38 ià((
”r
 = 
	`d”_Ëngth_objeù_id’tif›r
(
wÜds
, 
nwÜds
, &
x
)è!ğ
CRYPT_OK
) {

39  
”r
;

41 ià(
x
 > *
ou’
) {

42 *
ou’
 = 
x
;

43  
CRYPT_BUFFER_OVERFLOW
;

47 
z
 = 0;

48 
wÜdbuf
 = 
wÜds
[0] * 40 + words[1];

49 
y
 = 1; y < 
nwÜds
; y++) {

50 
t
 = 
	`d”_objeù_id’tif›r_b™s
(
wÜdbuf
);

51 
z
 +ğ
t
/7 + (Ñ%7è? 1 : 0è+ (
wÜdbuf
 == 0 ? 1 : 0);

52 ià(
y
 < 
nwÜds
 - 1) {

53 
wÜdbuf
 = 
wÜds
[
y
 + 1];

58 
x
 = 0;

59 
out
[
x
++] = 0x06;

60 ià(
z
 < 128) {

61 
out
[
x
++] = ()
z
;

62 } ià(
z
 < 256) {

63 
out
[
x
++] = 0x81;

64 
out
[
x
++] = ()
z
;

65 } ià(
z
 < 65536UL) {

66 
out
[
x
++] = 0x82;

67 
out
[
x
++] = ()((
z
>>8)&255);

68 
out
[
x
++] = ()(
z
&255);

70  
CRYPT_INVALID_ARG
;

74 
wÜdbuf
 = 
wÜds
[0] * 40 + words[1];

75 
i
 = 1; i < 
nwÜds
; i++) {

77 
t
 = 
wÜdbuf
 & 0xFFFFFFFF;

78 ià(
t
) {

79 
y
 = 
x
;

80 
mask
 = 0;

81 
t
) {

82 
out
[
x
++] = ()((
t
 & 0x7Fè| 
mask
);

83 
t
 >>= 7;

84 
mask
 |= 0x80;

87 
z
 = 
x
 - 1;

88 
y
 < 
z
) {

89 
t
 = 
out
[
y
]; out[y] = out[
z
]; out[z] = ()t;

90 ++
y
;

91 --
z
;

95 
out
[
x
++] = 0x00;

98 ià(
i
 < 
nwÜds
 - 1) {

99 
wÜdbuf
 = 
wÜds
[
i
 + 1];

103 *
ou’
 = 
x
;

104  
CRYPT_OK
;

105 
	}
}

	@libtomcrypt/src/pk/asn1/der/object_identifier/der_length_object_identifier.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


20 
	$d”_objeù_id’tif›r_b™s
(
x
)

22 
c
;

23 
x
 &= 0xFFFFFFFF;

24 
c
 = 0;

25 
x
) {

26 ++
c
;

27 
x
 >>= 1;

29  
c
;

30 
	}
}

40 
	$d”_Ëngth_objeù_id’tif›r
(*
wÜds
, 
nwÜds
, *
ou’
)

42 
y
, 
z
, 
t
, 
wÜdbuf
;

44 
	`LTC_ARGCHK
(
wÜds
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

49 ià(
nwÜds
 < 2) {

50  
CRYPT_INVALID_ARG
;

54 ià(
wÜds
[0] > 3 || (words[0] < 2 && words[1] > 39)) {

55  
CRYPT_INVALID_ARG
;

59 
z
 = 0;

60 
wÜdbuf
 = 
wÜds
[0] * 40 + words[1];

61 
y
 = 1; y < 
nwÜds
; y++) {

62 
t
 = 
	`d”_objeù_id’tif›r_b™s
(
wÜdbuf
);

63 
z
 +ğ
t
/7 + (Ñ%7è? 1 : 0è+ (
wÜdbuf
 == 0 ? 1 : 0);

64 ià(
y
 < 
nwÜds
 - 1) {

66 
wÜdbuf
 = 
wÜds
[
y
+1];

71 ià(
z
 < 128) {

72 
z
 += 2;

73 } ià(
z
 < 256) {

74 
z
 += 3;

75 } ià(
z
 < 65536UL) {

76 
z
 += 4;

78  
CRYPT_INVALID_ARG
;

81 *
ou’
 = 
z
;

82  
CRYPT_OK
;

83 
	}
}

	@libtomcrypt/src/pk/asn1/der/octet/der_decode_octet_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_decode_où‘_¡ršg
(cÚ¡ *
š
, 
šËn
,

30 *
out
, *
ou’
)

32 
x
, 
y
, 
Ën
;

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

39 ià(
šËn
 < 2) {

40  
CRYPT_INVALID_PACKET
;

44 ià((
š
[0] & 0x1F) != 0x04) {

45  
CRYPT_INVALID_PACKET
;

47 
x
 = 1;

50 ià(
š
[
x
] & 0x80) {

52 
y
 = 
š
[
x
] & 0x7F;

53 ià((
y
 =ğ0è|| (y > 3è|| ((
x
 + yè> 
šËn
)) {

54  
CRYPT_INVALID_PACKET
;

58 
Ën
 = 0;

59 ++
x
;

60 
y
--) {

61 
Ën
 = (ËÀ<< 8è| 
š
[
x
++];

64 
Ën
 = 
š
[
x
++] & 0x7F;

68 ià(
Ën
 > *
ou’
) {

69 *
ou’
 = 
Ën
;

70  
CRYPT_BUFFER_OVERFLOW
;

73 ià(
Ën
 + 
x
 > 
šËn
) {

74  
CRYPT_INVALID_PACKET
;

78 
y
 = 0; y < 
Ën
; y++) {

79 
out
[
y
] = 
š
[
x
++];

82 *
ou’
 = 
y
;

84  
CRYPT_OK
;

85 
	}
}

	@libtomcrypt/src/pk/asn1/der/octet/der_encode_octet_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_’code_où‘_¡ršg
(cÚ¡ *
š
, 
šËn
,

30 *
out
, *
ou’
)

32 
x
, 
y
, 
Ën
;

33 
”r
;

35 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

40 ià((
”r
 = 
	`d”_Ëngth_où‘_¡ršg
(
šËn
, &
Ën
)è!ğ
CRYPT_OK
) {

41  
”r
;

45 ià(
Ën
 > *
ou’
) {

46 *
ou’
 = 
Ën
;

47  
CRYPT_BUFFER_OVERFLOW
;

51 
x
 = 0;

52 
out
[
x
++] = 0x04;

53 ià(
šËn
 < 128) {

54 
out
[
x
++] = ()
šËn
;

55 } ià(
šËn
 < 256) {

56 
out
[
x
++] = 0x81;

57 
out
[
x
++] = ()
šËn
;

58 } ià(
šËn
 < 65536UL) {

59 
out
[
x
++] = 0x82;

60 
out
[
x
++] = ()((
šËn
>>8)&255);

61 
out
[
x
++] = ()(
šËn
&255);

62 } ià(
šËn
 < 16777216UL) {

63 
out
[
x
++] = 0x83;

64 
out
[
x
++] = ()((
šËn
>>16)&255);

65 
out
[
x
++] = ()((
šËn
>>8)&255);

66 
out
[
x
++] = ()(
šËn
&255);

68  
CRYPT_INVALID_ARG
;

72 
y
 = 0; y < 
šËn
; y++) {

73 
out
[
x
++] = 
š
[
y
];

77 *
ou’
 = 
x
;

79  
CRYPT_OK
;

80 
	}
}

	@libtomcrypt/src/pk/asn1/der/octet/der_length_octet_string.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


25 
	$d”_Ëngth_où‘_¡ršg
(
noù‘s
, *
ou’
)

27 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

29 ià(
noù‘s
 < 128) {

31 *
ou’
 = 2 + 
noù‘s
;

32 } ià(
noù‘s
 < 256) {

34 *
ou’
 = 3 + 
noù‘s
;

35 } ià(
noù‘s
 < 65536UL) {

37 *
ou’
 = 4 + 
noù‘s
;

38 } ià(
noù‘s
 < 16777216UL) {

40 *
ou’
 = 5 + 
noù‘s
;

42  
CRYPT_INVALID_ARG
;

45  
CRYPT_OK
;

46 
	}
}

	@libtomcrypt/src/pk/asn1/der/printable_string/der_decode_printable_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_decode_´šbË_¡ršg
(cÚ¡ *
š
, 
šËn
,

30 *
out
, *
ou’
)

32 
x
, 
y
, 
Ën
;

33 
t
;

35 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

40 ià(
šËn
 < 2) {

41  
CRYPT_INVALID_PACKET
;

45 ià((
š
[0] & 0x1F) != 0x13) {

46  
CRYPT_INVALID_PACKET
;

48 
x
 = 1;

51 ià(
š
[
x
] & 0x80) {

53 
y
 = 
š
[
x
] & 0x7F;

54 ià((
y
 =ğ0è|| (y > 3è|| ((
x
 + yè> 
šËn
)) {

55  
CRYPT_INVALID_PACKET
;

59 
Ën
 = 0;

60 ++
x
;

61 
y
--) {

62 
Ën
 = (ËÀ<< 8è| 
š
[
x
++];

65 
Ën
 = 
š
[
x
++] & 0x7F;

69 ià(
Ën
 > *
ou’
) {

70 *
ou’
 = 
Ën
;

71  
CRYPT_BUFFER_OVERFLOW
;

74 ià(
Ën
 + 
x
 > 
šËn
) {

75  
CRYPT_INVALID_PACKET
;

79 
y
 = 0; y < 
Ën
; y++) {

80 
t
 = 
	`d”_´šbË_v®ue_decode
(
š
[
x
++]);

81 ià(
t
 == -1) {

82  
CRYPT_INVALID_ARG
;

84 
out
[
y
] = 
t
;

87 *
ou’
 = 
y
;

89  
CRYPT_OK
;

90 
	}
}

	@libtomcrypt/src/pk/asn1/der/printable_string/der_encode_printable_string.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


28 
	$d”_’code_´šbË_¡ršg
(cÚ¡ *
š
, 
šËn
,

29 *
out
, *
ou’
)

31 
x
, 
y
, 
Ën
;

32 
”r
;

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

39 ià((
”r
 = 
	`d”_Ëngth_´šbË_¡ršg
(
š
, 
šËn
, &
Ën
)è!ğ
CRYPT_OK
) {

40  
”r
;

44 ià(
Ën
 > *
ou’
) {

45 *
ou’
 = 
Ën
;

46  
CRYPT_BUFFER_OVERFLOW
;

50 
x
 = 0;

51 
out
[
x
++] = 0x13;

52 ià(
šËn
 < 128) {

53 
out
[
x
++] = ()
šËn
;

54 } ià(
šËn
 < 256) {

55 
out
[
x
++] = 0x81;

56 
out
[
x
++] = ()
šËn
;

57 } ià(
šËn
 < 65536UL) {

58 
out
[
x
++] = 0x82;

59 
out
[
x
++] = ()((
šËn
>>8)&255);

60 
out
[
x
++] = ()(
šËn
&255);

61 } ià(
šËn
 < 16777216UL) {

62 
out
[
x
++] = 0x83;

63 
out
[
x
++] = ()((
šËn
>>16)&255);

64 
out
[
x
++] = ()((
šËn
>>8)&255);

65 
out
[
x
++] = ()(
šËn
&255);

67  
CRYPT_INVALID_ARG
;

71 
y
 = 0; y < 
šËn
; y++) {

72 
out
[
x
++] = 
	`d”_´šbË_ch¬_’code
(
š
[
y
]);

76 *
ou’
 = 
x
;

78  
CRYPT_OK
;

79 
	}
}

	@libtomcrypt/src/pk/asn1/der/printable_string/der_length_printable_string.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


21 
	mcode
, 
	mv®ue
;

22 } 
	g´šbË_bË
[] = {

99 
	$d”_´šbË_ch¬_’code
(
c
)

101 
x
;

102 
x
 = 0; x < ()((
´šbË_bË
)/(printable_table[0])); x++) {

103 ià(
´šbË_bË
[
x
].
code
 =ğ
c
) {

104  
´šbË_bË
[
x
].
v®ue
;

108 
	}
}

110 
	$d”_´šbË_v®ue_decode
(
v
)

112 
x
;

113 
x
 = 0; x < ()((
´šbË_bË
)/(printable_table[0])); x++) {

114 ià(
´šbË_bË
[
x
].
v®ue
 =ğ
v
) {

115  
´šbË_bË
[
x
].
code
;

119 
	}
}

128 
	$d”_Ëngth_´šbË_¡ršg
(cÚ¡ *
où‘s
, 
noù‘s
, *
ou’
)

130 
x
;

132 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

133 
	`LTC_ARGCHK
(
où‘s
 !ğ
NULL
);

136 
x
 = 0; x < 
noù‘s
; x++) {

137 ià(
	`d”_´šbË_ch¬_’code
(
où‘s
[
x
]) == -1) {

138  
CRYPT_INVALID_ARG
;

142 ià(
noù‘s
 < 128) {

144 *
ou’
 = 2 + 
noù‘s
;

145 } ià(
noù‘s
 < 256) {

147 *
ou’
 = 3 + 
noù‘s
;

148 } ià(
noù‘s
 < 65536UL) {

150 *
ou’
 = 4 + 
noù‘s
;

151 } ià(
noù‘s
 < 16777216UL) {

153 *
ou’
 = 5 + 
noù‘s
;

155  
CRYPT_INVALID_ARG
;

158  
CRYPT_OK
;

159 
	}
}

	@libtomcrypt/src/pk/asn1/der/sequence/der_decode_sequence_ex.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

20 #ifdeà
LTC_DER


31 
	$d”_decode_£qu’û_ex
(cÚ¡ *
š
, 
šËn
,

32 
Éc_a¢1_li¡
 *
li¡
, 
ou’
, 
Üd”ed
)

34 
”r
, 
ty³
;

35 
size
, 
x
, 
y
, 
z
, 
i
, 
blksize
;

36 *
d©a
;

38 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
li¡
 !ğ
NULL
);

42 ià(
šËn
 < 2) {

43  
CRYPT_INVALID_PACKET
;

47 
x
 = 0;

48 ià(
š
[
x
] != 0x30 && in[x] != 0x31) {

49  
CRYPT_INVALID_PACKET
;

51 ++
x
;

53 ià(
š
[
x
] < 128) {

54 
blksize
 = 
š
[
x
++];

55 } ià(
š
[
x
] & 0x80) {

56 ià(
š
[
x
] < 0x81 || in[x] > 0x83) {

57  
CRYPT_INVALID_PACKET
;

59 
y
 = 
š
[
x
++] & 0x7F;

62 ià(
x
 + 
y
 > 
šËn
) {

63  
CRYPT_INVALID_PACKET
;

67 
blksize
 = 0;

68 
y
--) {

69 
blksize
 = (blksiz<< 8è| ()
š
[
x
++];

74 ià(
x
 + 
blksize
 > 
šËn
) {

75  
CRYPT_INVALID_PACKET
;

79 
i
 = 0; i < 
ou’
; i++) {

80 
li¡
[
i
].
u£d
 = 0;

84 
šËn
 = 
blksize
;

85 
i
 = 0; i < 
ou’
; i++) {

86 
z
 = 0;

87 
ty³
 = 
li¡
[
i
].type;

88 
size
 = 
li¡
[
i
].size;

89 
d©a
 = 
li¡
[
i
].data;

90 ià(!
Üd”ed
 && 
li¡
[
i
].
u£d
 == 1) { ; }

92 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

96 
ty³
) {

97 
LTC_ASN1_BOOLEAN
:

98 
z
 = 
šËn
;

99 ià((
”r
 = 
	`d”_decode_boŞ—n
(
š
 + 
x
, 
z
, ((*)
d©a
))è!ğ
CRYPT_OK
) {

100 
LBL_ERR
;

102 ià((
”r
 = 
	`d”_Ëngth_boŞ—n
(&
z
)è!ğ
CRYPT_OK
) {

103 
LBL_ERR
;

107 
LTC_ASN1_INTEGER
:

108 
z
 = 
šËn
;

109 ià((
”r
 = 
	`d”_decode_š‹g”
(
š
 + 
x
, 
z
, 
d©a
)è!ğ
CRYPT_OK
) {

110 ià(!
Üd”ed
) { ; }

111 
LBL_ERR
;

113 ià((
”r
 = 
	`d”_Ëngth_š‹g”
(
d©a
, &
z
)è!ğ
CRYPT_OK
) {

114 
LBL_ERR
;

118 
LTC_ASN1_SHORT_INTEGER
:

119 
z
 = 
šËn
;

120 ià((
”r
 = 
	`d”_decode_shÜt_š‹g”
(
š
 + 
x
, 
z
, 
d©a
)è!ğ
CRYPT_OK
) {

121 ià(!
Üd”ed
) { ; }

122 
LBL_ERR
;

124 ià((
”r
 = 
	`d”_Ëngth_shÜt_š‹g”
(((*)
d©a
)[0], &
z
)è!ğ
CRYPT_OK
) {

125 
LBL_ERR
;

130 
LTC_ASN1_BIT_STRING
:

131 
z
 = 
šËn
;

132 ià((
”r
 = 
	`d”_decode_b™_¡ršg
(
š
 + 
x
, 
z
, 
d©a
, &
size
)è!ğ
CRYPT_OK
) {

133 ià(!
Üd”ed
) { ; }

134 
LBL_ERR
;

136 
li¡
[
i
].
size
 = size;

137 ià((
”r
 = 
	`d”_Ëngth_b™_¡ršg
(
size
, &
z
)è!ğ
CRYPT_OK
) {

138 
LBL_ERR
;

142 
LTC_ASN1_OCTET_STRING
:

143 
z
 = 
šËn
;

144 ià((
”r
 = 
	`d”_decode_où‘_¡ršg
(
š
 + 
x
, 
z
, 
d©a
, &
size
)è!ğ
CRYPT_OK
) {

145 ià(!
Üd”ed
) { ; }

146 
LBL_ERR
;

148 
li¡
[
i
].
size
 = size;

149 ià((
”r
 = 
	`d”_Ëngth_où‘_¡ršg
(
size
, &
z
)è!ğ
CRYPT_OK
) {

150 
LBL_ERR
;

154 
LTC_ASN1_NULL
:

155 ià(
šËn
 < 2 || 
š
[
x
] != 0x05 || in[x+1] != 0x00) {

156 ià(!
Üd”ed
) { ; }

157 
”r
 = 
CRYPT_INVALID_PACKET
;

158 
LBL_ERR
;

160 
z
 = 2;

163 
LTC_ASN1_OBJECT_IDENTIFIER
:

164 
z
 = 
šËn
;

165 ià((
”r
 = 
	`d”_decode_objeù_id’tif›r
(
š
 + 
x
, 
z
, 
d©a
, &
size
)è!ğ
CRYPT_OK
) {

166 ià(!
Üd”ed
) { ; }

167 
LBL_ERR
;

169 
li¡
[
i
].
size
 = size;

170 ià((
”r
 = 
	`d”_Ëngth_objeù_id’tif›r
(
d©a
, 
size
, &
z
)è!ğ
CRYPT_OK
) {

171 
LBL_ERR
;

175 
LTC_ASN1_IA5_STRING
:

176 
z
 = 
šËn
;

177 ià((
”r
 = 
	`d”_decode_Ÿ5_¡ršg
(
š
 + 
x
, 
z
, 
d©a
, &
size
)è!ğ
CRYPT_OK
) {

178 ià(!
Üd”ed
) { ; }

179 
LBL_ERR
;

181 
li¡
[
i
].
size
 = size;

182 ià((
”r
 = 
	`d”_Ëngth_Ÿ5_¡ršg
(
d©a
, 
size
, &
z
)è!ğ
CRYPT_OK
) {

183 
LBL_ERR
;

188 
LTC_ASN1_PRINTABLE_STRING
:

189 
z
 = 
šËn
;

190 ià((
”r
 = 
	`d”_decode_´šbË_¡ršg
(
š
 + 
x
, 
z
, 
d©a
, &
size
)è!ğ
CRYPT_OK
) {

191 ià(!
Üd”ed
) { ; }

192 
LBL_ERR
;

194 
li¡
[
i
].
size
 = size;

195 ià((
”r
 = 
	`d”_Ëngth_´šbË_¡ršg
(
d©a
, 
size
, &
z
)è!ğ
CRYPT_OK
) {

196 
LBL_ERR
;

200 
LTC_ASN1_UTF8_STRING
:

201 
z
 = 
šËn
;

202 ià((
”r
 = 
	`d”_decode_utf8_¡ršg
(
š
 + 
x
, 
z
, 
d©a
, &
size
)è!ğ
CRYPT_OK
) {

203 ià(!
Üd”ed
) { ; }

204 
LBL_ERR
;

206 
li¡
[
i
].
size
 = size;

207 ià((
”r
 = 
	`d”_Ëngth_utf8_¡ršg
(
d©a
, 
size
, &
z
)è!ğ
CRYPT_OK
) {

208 
LBL_ERR
;

212 
LTC_ASN1_UTCTIME
:

213 
z
 = 
šËn
;

214 ià((
”r
 = 
	`d”_decode_utùime
(
š
 + 
x
, &
z
, 
d©a
)è!ğ
CRYPT_OK
) {

215 ià(!
Üd”ed
) { ; }

216 
LBL_ERR
;

220 
LTC_ASN1_SET
:

221 
z
 = 
šËn
;

222 ià((
”r
 = 
	`d”_decode_£t
(
š
 + 
x
, 
z
, 
d©a
, 
size
)è!ğ
CRYPT_OK
) {

223 ià(!
Üd”ed
) { ; }

224 
LBL_ERR
;

226 ià((
”r
 = 
	`d”_Ëngth_£qu’û
(
d©a
, 
size
, &
z
)è!ğ
CRYPT_OK
) {

227 
LBL_ERR
;

231 
LTC_ASN1_SETOF
:

232 
LTC_ASN1_SEQUENCE
:

234 ià((
ty³
 =ğ
LTC_ASN1_SETOF
 && (
š
[
x
] & 0x3Fè!ğ0x31è|| (ty³ =ğ
LTC_ASN1_SEQUENCE
 && (in[x] & 0x3F) != 0x30)) {

235 
”r
 = 
CRYPT_INVALID_PACKET
;

236 
LBL_ERR
;

239 
z
 = 
šËn
;

240 ià((
”r
 = 
	`d”_decode_£qu’û
(
š
 + 
x
, 
z
, 
d©a
, 
size
)è!ğ
CRYPT_OK
) {

241 ià(!
Üd”ed
) { ; }

242 
LBL_ERR
;

244 ià((
”r
 = 
	`d”_Ëngth_£qu’û
(
d©a
, 
size
, &
z
)è!ğ
CRYPT_OK
) {

245 
LBL_ERR
;

250 
LTC_ASN1_CHOICE
:

251 
z
 = 
šËn
;

252 ià((
”r
 = 
	`d”_decode_choiû
(
š
 + 
x
, &
z
, 
d©a
, 
size
)è!ğ
CRYPT_OK
) {

253 ià(!
Üd”ed
) { ; }

254 
LBL_ERR
;

259 
”r
 = 
CRYPT_INVALID_ARG
;

260 
LBL_ERR
;

262 
x
 +ğ
z
;

263 
šËn
 -ğ
z
;

264 
li¡
[
i
].
u£d
 = 1;

265 ià(!
Üd”ed
) {

267 
i
 = -1;

271 
i
 = 0; i < 
ou’
; i++) {

272 ià(
li¡
[
i
].
u£d
 == 0) {

273 
”r
 = 
CRYPT_INVALID_PACKET
;

274 
LBL_ERR
;

277 
”r
 = 
CRYPT_OK
;

279 
LBL_ERR
:

280  
”r
;

281 
	}
}

	@libtomcrypt/src/pk/asn1/der/sequence/der_decode_sequence_flexi.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


20 
	$ãtch_Ëngth
(cÚ¡ *
š
, 
šËn
)

22 
x
, 
y
, 
z
;

24 
y
 = 0;

27 ià(
šËn
 < 2) {

30 ++
š
; ++
y
;

33 
x
 = *
š
++; ++
y
;

36 ià(
x
 < 128) {

37  
x
+
y
;

39 
x
 &= 0x7F;

40 
šËn
 -= 2;

43 ià(
x
 =ğ0 || x > 4 || x > 
šËn
) {

47 
y
 +ğ
x
;

48 
z
 = 0;

49 
x
--) {

50 
z
 = (z<<8è| (()*
š
);

51 ++
š
;

53  
z
+
y
;

54 
	}
}

63 
	$d”_decode_£qu’û_æexi
(cÚ¡ *
š
, *
šËn
, 
Éc_a¢1_li¡
 **
out
)

65 
Éc_a¢1_li¡
 *
l
;

66 
”r
, 
ty³
, 
Ën
, 
tÙËn
, 
x
, 
y
;

67 *
»®loc_tmp
;

69 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

70 
	`LTC_ARGCHK
(
šËn
 !ğ
NULL
);

71 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

73 
l
 = 
NULL
;

74 
tÙËn
 = 0;

77 *
šËn
) {

79 
ty³
 = *
š
;

82 
Ën
 = 
	`ãtch_Ëngth
(
š
, *
šËn
);

83 ià(
Ën
 > *
šËn
) {

84 
”r
 = 
CRYPT_INVALID_PACKET
;

85 
”rÜ
;

89 ià(
l
 =ğ
NULL
) {

90 
l
 = 
	`XCALLOC
(1, (*l));

91 ià(
l
 =ğ
NULL
) {

92 
”r
 = 
CRYPT_MEM
;

93 
”rÜ
;

96 
l
->
Ãxt
 = 
	`XCALLOC
(1, (*l));

97 ià(
l
->
Ãxt
 =ğ
NULL
) {

98 
”r
 = 
CRYPT_MEM
;

99 
”rÜ
;

101 
l
->
Ãxt
->
´ev
 =†;

102 
l
 =†->
Ãxt
;

106 
ty³
) {

108 
l
->
ty³
 = 
LTC_ASN1_BOOLEAN
;

109 
l
->
size
 = 1;

110 
l
->
d©a
 = 
	`XCALLOC
(1, ());

112 ià((
”r
 = 
	`d”_decode_boŞ—n
(
š
, *
šËn
, 
l
->
d©a
)è!ğ
CRYPT_OK
) {

113 
”rÜ
;

116 ià((
”r
 = 
	`d”_Ëngth_boŞ—n
(&
Ën
)è!ğ
CRYPT_OK
) {

117 
”rÜ
;

123 
l
->
ty³
 = 
LTC_ASN1_INTEGER
;

124 
l
->
size
 = 1;

125 ià((
”r
 = 
	`mp_š™
(&
l
->
d©a
)è!ğ
CRYPT_OK
) {

126 
”rÜ
;

130 ià((
”r
 = 
	`d”_decode_š‹g”
(
š
, *
šËn
, 
l
->
d©a
)è!ğ
CRYPT_OK
) {

131 
”rÜ
;

135 ià((
”r
 = 
	`d”_Ëngth_š‹g”
(
l
->
d©a
, &
Ën
)è!ğ
CRYPT_OK
) {

136 
”rÜ
;

142 
l
->
ty³
 = 
LTC_ASN1_BIT_STRING
;

143 
l
->
size
 = 
Ën
 * 8;

145 ià((
l
->
d©a
 = 
	`XCALLOC
(1,†->
size
)è=ğ
NULL
) {

146 
”r
 = 
CRYPT_MEM
;

147 
”rÜ
;

150 ià((
”r
 = 
	`d”_decode_b™_¡ršg
(
š
, *
šËn
, 
l
->
d©a
, &l->
size
)è!ğ
CRYPT_OK
) {

151 
”rÜ
;

154 ià((
”r
 = 
	`d”_Ëngth_b™_¡ršg
(
l
->
size
, &
Ën
)è!ğ
CRYPT_OK
) {

155 
”rÜ
;

162 
l
->
ty³
 = 
LTC_ASN1_OCTET_STRING
;

163 
l
->
size
 = 
Ën
;

165 ià((
l
->
d©a
 = 
	`XCALLOC
(1,†->
size
)è=ğ
NULL
) {

166 
”r
 = 
CRYPT_MEM
;

167 
”rÜ
;

170 ià((
”r
 = 
	`d”_decode_où‘_¡ršg
(
š
, *
šËn
, 
l
->
d©a
, &l->
size
)è!ğ
CRYPT_OK
) {

171 
”rÜ
;

174 ià((
”r
 = 
	`d”_Ëngth_où‘_¡ršg
(
l
->
size
, &
Ën
)è!ğ
CRYPT_OK
) {

175 
”rÜ
;

182 ià(
š
[0] != 0x05 || in[1] != 0x00) {

183 
”r
 = 
CRYPT_INVALID_PACKET
;

184 
”rÜ
;

188 
l
->
ty³
 = 
LTC_ASN1_NULL
;

189 
l
->
d©a
 = 
NULL
;

190 
l
->
size
 = 0;

191 
Ën
 = 2;

198 
l
->
ty³
 = 
LTC_ASN1_OBJECT_IDENTIFIER
;

199 
l
->
size
 = 
Ën
;

201 ià((
l
->
d©a
 = 
	`XCALLOC
(
Ën
, ())è=ğ
NULL
) {

202 
”r
 = 
CRYPT_MEM
;

203 
”rÜ
;

206 ià((
”r
 = 
	`d”_decode_objeù_id’tif›r
(
š
, *
šËn
, 
l
->
d©a
, &l->
size
)è!ğ
CRYPT_OK
) {

207 
”rÜ
;

210 ià((
”r
 = 
	`d”_Ëngth_objeù_id’tif›r
(
l
->
d©a
,†->
size
, &
Ën
)è!ğ
CRYPT_OK
) {

211 
”rÜ
;

215 ià((
»®loc_tmp
 = 
	`XREALLOC
(
l
->
d©a
,†->
size
 * ())è=ğ
NULL
) {

219 
l
->
d©a
 = 
»®loc_tmp
;

225 
l
->
ty³
 = 
LTC_ASN1_UTF8_STRING
;

226 
l
->
size
 = 
Ën
;

228 ià((
l
->
d©a
 = 
	`XCALLOC
((
wch¬_t
),†->
size
)è=ğ
NULL
) {

229 
”r
 = 
CRYPT_MEM
;

230 
”rÜ
;

233 ià((
”r
 = 
	`d”_decode_utf8_¡ršg
(
š
, *
šËn
, 
l
->
d©a
, &l->
size
)è!ğ
CRYPT_OK
) {

234 
”rÜ
;

237 ià((
”r
 = 
	`d”_Ëngth_utf8_¡ršg
(
l
->
d©a
,†->
size
, &
Ën
)è!ğ
CRYPT_OK
) {

238 
”rÜ
;

245 
l
->
ty³
 = 
LTC_ASN1_PRINTABLE_STRING
;

246 
l
->
size
 = 
Ën
;

248 ià((
l
->
d©a
 = 
	`XCALLOC
(1,†->
size
)è=ğ
NULL
) {

249 
”r
 = 
CRYPT_MEM
;

250 
”rÜ
;

253 ià((
”r
 = 
	`d”_decode_´šbË_¡ršg
(
š
, *
šËn
, 
l
->
d©a
, &l->
size
)è!ğ
CRYPT_OK
) {

254 
”rÜ
;

257 ià((
”r
 = 
	`d”_Ëngth_´šbË_¡ršg
(
l
->
d©a
,†->
size
, &
Ën
)è!ğ
CRYPT_OK
) {

258 
”rÜ
;

265 
l
->
ty³
 = 
LTC_ASN1_IA5_STRING
;

266 
l
->
size
 = 
Ën
;

268 ià((
l
->
d©a
 = 
	`XCALLOC
(1,†->
size
)è=ğ
NULL
) {

269 
”r
 = 
CRYPT_MEM
;

270 
”rÜ
;

273 ià((
”r
 = 
	`d”_decode_Ÿ5_¡ršg
(
š
, *
šËn
, 
l
->
d©a
, &l->
size
)è!ğ
CRYPT_OK
) {

274 
”rÜ
;

277 ià((
”r
 = 
	`d”_Ëngth_Ÿ5_¡ršg
(
l
->
d©a
,†->
size
, &
Ën
)è!ğ
CRYPT_OK
) {

278 
”rÜ
;

285 
l
->
ty³
 = 
LTC_ASN1_UTCTIME
;

286 
l
->
size
 = 1;

288 ià((
l
->
d©a
 = 
	`XCALLOC
(1, (
Éc_utùime
))è=ğ
NULL
) {

289 
”r
 = 
CRYPT_MEM
;

290 
”rÜ
;

293 
Ën
 = *
šËn
;

294 ià((
”r
 = 
	`d”_decode_utùime
(
š
, &
Ën
, 
l
->
d©a
)è!ğ
CRYPT_OK
) {

295 
”rÜ
;

298 ià((
”r
 = 
	`d”_Ëngth_utùime
(
l
->
d©a
, &
Ën
)è!ğ
CRYPT_OK
) {

299 
”rÜ
;

307 
l
->
ty³
 = (ty³ =ğ0x30è? 
LTC_ASN1_SEQUENCE
 : 
LTC_ASN1_SET
;

312 ++
š
; --(*
šËn
);

315 
x
 = *
š
++; --(*
šËn
);

318 
y
 = 2;

321 ià(
x
 > 128) {

322 
x
 &= 0x7F;

323 
š
 +ğ
x
;

324 *
šËn
 -ğ
x
;

327 
y
 +ğ
x
;

331 
Ën
 =†’ - 
y
;

332 ià((
”r
 = 
	`d”_decode_£qu’û_æexi
(
š
, &
Ën
, &(
l
->
chd
))è!ğ
CRYPT_OK
) {

333 
”rÜ
;

337 
tÙËn
 +ğ
y
;

340 
l
->
chd
->
·»Á
 =†;

346 
l
 =†->
´ev
;

347 
	`XFREE
(
l
->
Ãxt
);

348 
l
->
Ãxt
 = 
NULL
;

349 
outside
;

353 
tÙËn
 +ğ
Ën
;

354 
š
 +ğ
Ën
;

355 *
šËn
 -ğ
Ën
;

358 
outside
:

361 
l
->
´ev
 !ğ
NULL
 ||†->
·»Á
 != NULL) {

362 ià(
l
->
·»Á
 !ğ
NULL
) {

363 
l
 =†->
·»Á
;

365 
l
 =†->
´ev
;

370 *
out
 = 
l
;

371 *
šËn
 = 
tÙËn
;

372  
CRYPT_OK
;

374 
”rÜ
:

376 
	`d”_£qu’û_ä“
(
l
);

378  
”r
;

379 
	}
}

	@libtomcrypt/src/pk/asn1/der/sequence/der_decode_sequence_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

20 #ifdeà
LTC_DER


29 
	$d”_decode_£qu’û_muÉi
(cÚ¡ *
š
, 
šËn
, ...)

31 
”r
, 
ty³
;

32 
size
, 
x
;

33 *
d©a
;

34 
va_li¡
 
¬gs
;

35 
Éc_a¢1_li¡
 *
li¡
;

37 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

40 
	`va_¡¬t
(
¬gs
, 
šËn
);

41 
x
 = 0;

43 
ty³
 = 
	`va_¬g
(
¬gs
, );

44 
size
 = 
	`va_¬g
(
¬gs
, );

45 
d©a
 = 
	`va_¬g
(
¬gs
, *);

47 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

51 
ty³
) {

52 
LTC_ASN1_BOOLEAN
:

53 
LTC_ASN1_INTEGER
:

54 
LTC_ASN1_SHORT_INTEGER
:

55 
LTC_ASN1_BIT_STRING
:

56 
LTC_ASN1_OCTET_STRING
:

57 
LTC_ASN1_NULL
:

58 
LTC_ASN1_OBJECT_IDENTIFIER
:

59 
LTC_ASN1_IA5_STRING
:

60 
LTC_ASN1_PRINTABLE_STRING
:

61 
LTC_ASN1_UTF8_STRING
:

62 
LTC_ASN1_UTCTIME
:

63 
LTC_ASN1_SET
:

64 
LTC_ASN1_SETOF
:

65 
LTC_ASN1_SEQUENCE
:

66 
LTC_ASN1_CHOICE
:

67 ++
x
;

71 
	`va_’d
(
¬gs
);

72  
CRYPT_INVALID_ARG
;

75 
	`va_’d
(
¬gs
);

78 ià(
x
 == 0) {

79  
CRYPT_NOP
;

82 
li¡
 = 
	`XCALLOC
((*li¡), 
x
);

83 ià(
li¡
 =ğ
NULL
) {

84  
CRYPT_MEM
;

88 
	`va_¡¬t
(
¬gs
, 
šËn
);

89 
x
 = 0;

91 
ty³
 = 
	`va_¬g
(
¬gs
, );

92 
size
 = 
	`va_¬g
(
¬gs
, );

93 
d©a
 = 
	`va_¬g
(
¬gs
, *);

95 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

99 
ty³
) {

100 
LTC_ASN1_BOOLEAN
:

101 
LTC_ASN1_INTEGER
:

102 
LTC_ASN1_SHORT_INTEGER
:

103 
LTC_ASN1_BIT_STRING
:

104 
LTC_ASN1_OCTET_STRING
:

105 
LTC_ASN1_NULL
:

106 
LTC_ASN1_OBJECT_IDENTIFIER
:

107 
LTC_ASN1_IA5_STRING
:

108 
LTC_ASN1_PRINTABLE_STRING
:

109 
LTC_ASN1_UTF8_STRING
:

110 
LTC_ASN1_UTCTIME
:

111 
LTC_ASN1_SEQUENCE
:

112 
LTC_ASN1_SET
:

113 
LTC_ASN1_SETOF
:

114 
LTC_ASN1_CHOICE
:

115 
li¡
[
x
].
ty³
 =ype;

116 
li¡
[
x
].
size
 = size;

117 
li¡
[
x
++].
d©a
 = data;

121 
	`va_’d
(
¬gs
);

122 
”r
 = 
CRYPT_INVALID_ARG
;

123 
LBL_ERR
;

126 
	`va_’d
(
¬gs
);

128 
”r
 = 
	`d”_decode_£qu’û
(
š
, 
šËn
, 
li¡
, 
x
);

129 
LBL_ERR
:

130 
	`XFREE
(
li¡
);

131  
”r
;

132 
	}
}

	@libtomcrypt/src/pk/asn1/der/sequence/der_encode_sequence_ex.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

20 #ifdeà
LTC_DER


31 
	$d”_’code_£qu’û_ex
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

32 *
out
, *
ou’
, 
ty³_of
)

34 
”r
, 
ty³
;

35 
size
, 
x
, 
y
, 
z
, 
i
;

36 *
d©a
;

38 
	`LTC_ARGCHK
(
li¡
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

43 
y
 = 0;

44 
i
 = 0; i < 
šËn
; i++) {

45 
ty³
 = 
li¡
[
i
].type;

46 
size
 = 
li¡
[
i
].size;

47 
d©a
 = 
li¡
[
i
].data;

49 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

53 
ty³
) {

54 
LTC_ASN1_BOOLEAN
:

55 ià((
”r
 = 
	`d”_Ëngth_boŞ—n
(&
x
)è!ğ
CRYPT_OK
) {

56 
LBL_ERR
;

58 
y
 +ğ
x
;

61 
LTC_ASN1_INTEGER
:

62 ià((
”r
 = 
	`d”_Ëngth_š‹g”
(
d©a
, &
x
)è!ğ
CRYPT_OK
) {

63 
LBL_ERR
;

65 
y
 +ğ
x
;

68 
LTC_ASN1_SHORT_INTEGER
:

69 ià((
”r
 = 
	`d”_Ëngth_shÜt_š‹g”
(*((*)
d©a
), &
x
)è!ğ
CRYPT_OK
) {

70 
LBL_ERR
;

72 
y
 +ğ
x
;

75 
LTC_ASN1_BIT_STRING
:

76 ià((
”r
 = 
	`d”_Ëngth_b™_¡ršg
(
size
, &
x
)è!ğ
CRYPT_OK
) {

77 
LBL_ERR
;

79 
y
 +ğ
x
;

82 
LTC_ASN1_OCTET_STRING
:

83 ià((
”r
 = 
	`d”_Ëngth_où‘_¡ršg
(
size
, &
x
)è!ğ
CRYPT_OK
) {

84 
LBL_ERR
;

86 
y
 +ğ
x
;

89 
LTC_ASN1_NULL
:

90 
y
 += 2;

93 
LTC_ASN1_OBJECT_IDENTIFIER
:

94 ià((
”r
 = 
	`d”_Ëngth_objeù_id’tif›r
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

95 
LBL_ERR
;

97 
y
 +ğ
x
;

100 
LTC_ASN1_IA5_STRING
:

101 ià((
”r
 = 
	`d”_Ëngth_Ÿ5_¡ršg
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

102 
LBL_ERR
;

104 
y
 +ğ
x
;

107 
LTC_ASN1_PRINTABLE_STRING
:

108 ià((
”r
 = 
	`d”_Ëngth_´šbË_¡ršg
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

109 
LBL_ERR
;

111 
y
 +ğ
x
;

114 
LTC_ASN1_UTF8_STRING
:

115 ià((
”r
 = 
	`d”_Ëngth_utf8_¡ršg
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

116 
LBL_ERR
;

118 
y
 +ğ
x
;

121 
LTC_ASN1_UTCTIME
:

122 ià((
”r
 = 
	`d”_Ëngth_utùime
(
d©a
, &
x
)è!ğ
CRYPT_OK
) {

123 
LBL_ERR
;

125 
y
 +ğ
x
;

128 
LTC_ASN1_SET
:

129 
LTC_ASN1_SETOF
:

130 
LTC_ASN1_SEQUENCE
:

131 ià((
”r
 = 
	`d”_Ëngth_£qu’û
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

132 
LBL_ERR
;

134 
y
 +ğ
x
;

138 
”r
 = 
CRYPT_INVALID_ARG
;

139 
LBL_ERR
;

144 
z
 = 
y
;

145 ià(
y
 < 128) {

146 
y
 += 2;

147 } ià(
y
 < 256) {

149 
y
 += 3;

150 } ià(
y
 < 65536UL) {

152 
y
 += 4;

153 } ià(
y
 < 16777216UL) {

155 
y
 += 5;

157 
”r
 = 
CRYPT_INVALID_ARG
;

158 
LBL_ERR
;

162 ià(*
ou’
 < 
y
) {

163 *
ou’
 = 
y
;

164 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

165 
LBL_ERR
;

169 
x
 = 0;

170 
out
[
x
++] = (
ty³_of
 =ğ
LTC_ASN1_SEQUENCE
) ? 0x30 : 0x31;

172 ià(
z
 < 128) {

173 
out
[
x
++] = ()
z
;

174 } ià(
z
 < 256) {

175 
out
[
x
++] = 0x81;

176 
out
[
x
++] = ()
z
;

177 } ià(
z
 < 65536UL) {

178 
out
[
x
++] = 0x82;

179 
out
[
x
++] = ()((
z
>>8UL)&255);

180 
out
[
x
++] = ()(
z
&255);

181 } ià(
z
 < 16777216UL) {

182 
out
[
x
++] = 0x83;

183 
out
[
x
++] = ()((
z
>>16UL)&255);

184 
out
[
x
++] = ()((
z
>>8UL)&255);

185 
out
[
x
++] = ()(
z
&255);

189 *
ou’
 -ğ
x
;

190 
i
 = 0; i < 
šËn
; i++) {

191 
ty³
 = 
li¡
[
i
].type;

192 
size
 = 
li¡
[
i
].size;

193 
d©a
 = 
li¡
[
i
].data;

195 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

199 
ty³
) {

200 
LTC_ASN1_BOOLEAN
:

201 
z
 = *
ou’
;

202 ià((
”r
 = 
	`d”_’code_boŞ—n
(*((*)
d©a
), 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

203 
LBL_ERR
;

205 
x
 +ğ
z
;

206 *
ou’
 -ğ
z
;

209 
LTC_ASN1_INTEGER
:

210 
z
 = *
ou’
;

211 ià((
”r
 = 
	`d”_’code_š‹g”
(
d©a
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

212 
LBL_ERR
;

214 
x
 +ğ
z
;

215 *
ou’
 -ğ
z
;

218 
LTC_ASN1_SHORT_INTEGER
:

219 
z
 = *
ou’
;

220 ià((
”r
 = 
	`d”_’code_shÜt_š‹g”
(*((*)
d©a
), 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

221 
LBL_ERR
;

223 
x
 +ğ
z
;

224 *
ou’
 -ğ
z
;

227 
LTC_ASN1_BIT_STRING
:

228 
z
 = *
ou’
;

229 ià((
”r
 = 
	`d”_’code_b™_¡ršg
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

230 
LBL_ERR
;

232 
x
 +ğ
z
;

233 *
ou’
 -ğ
z
;

236 
LTC_ASN1_OCTET_STRING
:

237 
z
 = *
ou’
;

238 ià((
”r
 = 
	`d”_’code_où‘_¡ršg
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

239 
LBL_ERR
;

241 
x
 +ğ
z
;

242 *
ou’
 -ğ
z
;

245 
LTC_ASN1_NULL
:

246 
out
[
x
++] = 0x05;

247 
out
[
x
++] = 0x00;

248 *
ou’
 -= 2;

251 
LTC_ASN1_OBJECT_IDENTIFIER
:

252 
z
 = *
ou’
;

253 ià((
”r
 = 
	`d”_’code_objeù_id’tif›r
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

254 
LBL_ERR
;

256 
x
 +ğ
z
;

257 *
ou’
 -ğ
z
;

260 
LTC_ASN1_IA5_STRING
:

261 
z
 = *
ou’
;

262 ià((
”r
 = 
	`d”_’code_Ÿ5_¡ršg
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

263 
LBL_ERR
;

265 
x
 +ğ
z
;

266 *
ou’
 -ğ
z
;

269 
LTC_ASN1_PRINTABLE_STRING
:

270 
z
 = *
ou’
;

271 ià((
”r
 = 
	`d”_’code_´šbË_¡ršg
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

272 
LBL_ERR
;

274 
x
 +ğ
z
;

275 *
ou’
 -ğ
z
;

278 
LTC_ASN1_UTF8_STRING
:

279 
z
 = *
ou’
;

280 ià((
”r
 = 
	`d”_’code_utf8_¡ršg
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

281 
LBL_ERR
;

283 
x
 +ğ
z
;

284 *
ou’
 -ğ
z
;

287 
LTC_ASN1_UTCTIME
:

288 
z
 = *
ou’
;

289 ià((
”r
 = 
	`d”_’code_utùime
(
d©a
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

290 
LBL_ERR
;

292 
x
 +ğ
z
;

293 *
ou’
 -ğ
z
;

296 
LTC_ASN1_SET
:

297 
z
 = *
ou’
;

298 ià((
”r
 = 
	`d”_’code_£t
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

299 
LBL_ERR
;

301 
x
 +ğ
z
;

302 *
ou’
 -ğ
z
;

305 
LTC_ASN1_SETOF
:

306 
z
 = *
ou’
;

307 ià((
”r
 = 
	`d”_’code_£tof
(
d©a
, 
size
, 
out
 + 
x
, &
z
)è!ğ
CRYPT_OK
) {

308 
LBL_ERR
;

310 
x
 +ğ
z
;

311 *
ou’
 -ğ
z
;

314 
LTC_ASN1_SEQUENCE
:

315 
z
 = *
ou’
;

316 ià((
”r
 = 
	`d”_’code_£qu’û_ex
(
d©a
, 
size
, 
out
 + 
x
, &
z
, 
ty³
)è!ğ
CRYPT_OK
) {

317 
LBL_ERR
;

319 
x
 +ğ
z
;

320 *
ou’
 -ğ
z
;

324 
”r
 = 
CRYPT_INVALID_ARG
;

325 
LBL_ERR
;

328 *
ou’
 = 
x
;

329 
”r
 = 
CRYPT_OK
;

331 
LBL_ERR
:

332  
”r
;

333 
	}
}

	@libtomcrypt/src/pk/asn1/der/sequence/der_encode_sequence_multi.c

11 
	~"tomüy±.h
"

12 
	~<¡d¬g.h
>

20 #ifdeà
LTC_DER


29 
	$d”_’code_£qu’û_muÉi
(*
out
, *
ou’
, ...)

31 
”r
, 
ty³
;

32 
size
, 
x
;

33 *
d©a
;

34 
va_li¡
 
¬gs
;

35 
Éc_a¢1_li¡
 *
li¡
;

37 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

41 
	`va_¡¬t
(
¬gs
, 
ou’
);

42 
x
 = 0;

44 
ty³
 = 
	`va_¬g
(
¬gs
, );

45 
size
 = 
	`va_¬g
(
¬gs
, );

46 
d©a
 = 
	`va_¬g
(
¬gs
, *);

48 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

52 
ty³
) {

53 
LTC_ASN1_BOOLEAN
:

54 
LTC_ASN1_INTEGER
:

55 
LTC_ASN1_SHORT_INTEGER
:

56 
LTC_ASN1_BIT_STRING
:

57 
LTC_ASN1_OCTET_STRING
:

58 
LTC_ASN1_NULL
:

59 
LTC_ASN1_OBJECT_IDENTIFIER
:

60 
LTC_ASN1_IA5_STRING
:

61 
LTC_ASN1_PRINTABLE_STRING
:

62 
LTC_ASN1_UTF8_STRING
:

63 
LTC_ASN1_UTCTIME
:

64 
LTC_ASN1_SEQUENCE
:

65 
LTC_ASN1_SET
:

66 
LTC_ASN1_SETOF
:

67 ++
x
;

71 
	`va_’d
(
¬gs
);

72  
CRYPT_INVALID_ARG
;

75 
	`va_’d
(
¬gs
);

78 ià(
x
 == 0) {

79  
CRYPT_NOP
;

82 
li¡
 = 
	`XCALLOC
((*li¡), 
x
);

83 ià(
li¡
 =ğ
NULL
) {

84  
CRYPT_MEM
;

88 
	`va_¡¬t
(
¬gs
, 
ou’
);

89 
x
 = 0;

91 
ty³
 = 
	`va_¬g
(
¬gs
, );

92 
size
 = 
	`va_¬g
(
¬gs
, );

93 
d©a
 = 
	`va_¬g
(
¬gs
, *);

95 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

99 
ty³
) {

100 
LTC_ASN1_BOOLEAN
:

101 
LTC_ASN1_INTEGER
:

102 
LTC_ASN1_SHORT_INTEGER
:

103 
LTC_ASN1_BIT_STRING
:

104 
LTC_ASN1_OCTET_STRING
:

105 
LTC_ASN1_NULL
:

106 
LTC_ASN1_OBJECT_IDENTIFIER
:

107 
LTC_ASN1_IA5_STRING
:

108 
LTC_ASN1_PRINTABLE_STRING
:

109 
LTC_ASN1_UTF8_STRING
:

110 
LTC_ASN1_UTCTIME
:

111 
LTC_ASN1_SEQUENCE
:

112 
LTC_ASN1_SET
:

113 
LTC_ASN1_SETOF
:

114 
li¡
[
x
].
ty³
 =ype;

115 
li¡
[
x
].
size
 = size;

116 
li¡
[
x
++].
d©a
 = data;

120 
	`va_’d
(
¬gs
);

121 
”r
 = 
CRYPT_INVALID_ARG
;

122 
LBL_ERR
;

125 
	`va_’d
(
¬gs
);

127 
”r
 = 
	`d”_’code_£qu’û
(
li¡
, 
x
, 
out
, 
ou’
);

128 
LBL_ERR
:

129 
	`XFREE
(
li¡
);

130  
”r
;

131 
	}
}

	@libtomcrypt/src/pk/asn1/der/sequence/der_length_sequence.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


27 
	$d”_Ëngth_£qu’û
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

28 *
ou’
)

30 
”r
, 
ty³
;

31 
size
, 
x
, 
y
, 
z
, 
i
;

32 *
d©a
;

34 
	`LTC_ARGCHK
(
li¡
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

38 
y
 = 0;

39 
i
 = 0; i < 
šËn
; i++) {

40 
ty³
 = 
li¡
[
i
].type;

41 
size
 = 
li¡
[
i
].size;

42 
d©a
 = 
li¡
[
i
].data;

44 ià(
ty³
 =ğ
LTC_ASN1_EOL
) {

48 
ty³
) {

49 
LTC_ASN1_BOOLEAN
:

50 ià((
”r
 = 
	`d”_Ëngth_boŞ—n
(&
x
)è!ğ
CRYPT_OK
) {

51 
LBL_ERR
;

53 
y
 +ğ
x
;

56 
LTC_ASN1_INTEGER
:

57 ià((
”r
 = 
	`d”_Ëngth_š‹g”
(
d©a
, &
x
)è!ğ
CRYPT_OK
) {

58 
LBL_ERR
;

60 
y
 +ğ
x
;

63 
LTC_ASN1_SHORT_INTEGER
:

64 ià((
”r
 = 
	`d”_Ëngth_shÜt_š‹g”
(*((*)
d©a
), &
x
)è!ğ
CRYPT_OK
) {

65 
LBL_ERR
;

67 
y
 +ğ
x
;

70 
LTC_ASN1_BIT_STRING
:

71 ià((
”r
 = 
	`d”_Ëngth_b™_¡ršg
(
size
, &
x
)è!ğ
CRYPT_OK
) {

72 
LBL_ERR
;

74 
y
 +ğ
x
;

77 
LTC_ASN1_OCTET_STRING
:

78 ià((
”r
 = 
	`d”_Ëngth_où‘_¡ršg
(
size
, &
x
)è!ğ
CRYPT_OK
) {

79 
LBL_ERR
;

81 
y
 +ğ
x
;

84 
LTC_ASN1_NULL
:

85 
y
 += 2;

88 
LTC_ASN1_OBJECT_IDENTIFIER
:

89 ià((
”r
 = 
	`d”_Ëngth_objeù_id’tif›r
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

90 
LBL_ERR
;

92 
y
 +ğ
x
;

95 
LTC_ASN1_IA5_STRING
:

96 ià((
”r
 = 
	`d”_Ëngth_Ÿ5_¡ršg
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

97 
LBL_ERR
;

99 
y
 +ğ
x
;

102 
LTC_ASN1_PRINTABLE_STRING
:

103 ià((
”r
 = 
	`d”_Ëngth_´šbË_¡ršg
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

104 
LBL_ERR
;

106 
y
 +ğ
x
;

109 
LTC_ASN1_UTCTIME
:

110 ià((
”r
 = 
	`d”_Ëngth_utùime
(
d©a
, &
x
)è!ğ
CRYPT_OK
) {

111 
LBL_ERR
;

113 
y
 +ğ
x
;

116 
LTC_ASN1_UTF8_STRING
:

117 ià((
”r
 = 
	`d”_Ëngth_utf8_¡ršg
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

118 
LBL_ERR
;

120 
y
 +ğ
x
;

123 
LTC_ASN1_SET
:

124 
LTC_ASN1_SETOF
:

125 
LTC_ASN1_SEQUENCE
:

126 ià((
”r
 = 
	`d”_Ëngth_£qu’û
(
d©a
, 
size
, &
x
)è!ğ
CRYPT_OK
) {

127 
LBL_ERR
;

129 
y
 +ğ
x
;

134 
”r
 = 
CRYPT_INVALID_ARG
;

135 
LBL_ERR
;

140 
z
 = 
y
;

141 ià(
y
 < 128) {

142 
y
 += 2;

143 } ià(
y
 < 256) {

145 
y
 += 3;

146 } ià(
y
 < 65536UL) {

148 
y
 += 4;

149 } ià(
y
 < 16777216UL) {

151 
y
 += 5;

153 
”r
 = 
CRYPT_INVALID_ARG
;

154 
LBL_ERR
;

158 *
ou’
 = 
y
;

159 
”r
 = 
CRYPT_OK
;

161 
LBL_ERR
:

162  
”r
;

163 
	}
}

	@libtomcrypt/src/pk/asn1/der/sequence/der_sequence_free.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


24 
	$d”_£qu’û_ä“
(
Éc_a¢1_li¡
 *
š
)

26 
Éc_a¢1_li¡
 *
l
;

29 
š
->
´ev
 !ğ
NULL
 || in->
·»Á
 != NULL) {

30 ià(
š
->
·»Á
 !ğ
NULL
) {

31 
š
 = in->
·»Á
;

33 
š
 = in->
´ev
;

38 
š
 !ğ
NULL
) {

40 ià(
š
->
chd
) {

42 
š
->
chd
->
·»Á
 = 
NULL
;

43 
	`d”_£qu’û_ä“
(
š
->
chd
);

46 
š
->
ty³
) {

47 
LTC_ASN1_SET
:

48 
LTC_ASN1_SETOF
:

49 
LTC_ASN1_SEQUENCE
: ;

50 
LTC_ASN1_INTEGER
 : ià(
š
->
d©a
 !ğ
NULL
è{ 
	`mp_ş—r
(in->data); } ;

51  : ià(
š
->
d©a
 !ğ
NULL
è{ 
	`XFREE
(in->data); }

55 
l
 = 
š
->
Ãxt
;

56 
	`ä“
(
š
);

57 
š
 = 
l
;

59 
	}
}

	@libtomcrypt/src/pk/asn1/der/set/der_encode_set.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


21 
	$Éc_to_a¢1
(
v
)

23 
v
) {

24 
LTC_ASN1_BOOLEAN
:  0x01;

25 
LTC_ASN1_INTEGER
:

26 
LTC_ASN1_SHORT_INTEGER
:  0x02;

27 
LTC_ASN1_BIT_STRING
:  0x03;

28 
LTC_ASN1_OCTET_STRING
:  0x04;

29 
LTC_ASN1_NULL
:  0x05;

30 
LTC_ASN1_OBJECT_IDENTIFIER
:  0x06;

31 
LTC_ASN1_UTF8_STRING
:  0x0C;

32 
LTC_ASN1_PRINTABLE_STRING
:  0x13;

33 
LTC_ASN1_IA5_STRING
:  0x16;

34 
LTC_ASN1_UTCTIME
:  0x17;

35 
LTC_ASN1_SEQUENCE
:  0x30;

36 
LTC_ASN1_SET
:

37 
LTC_ASN1_SETOF
:  0x31;

40 
	}
}

43 
	$qsÜt_h–³r
(cÚ¡ *
a
, cÚ¡ *
b
)

45 
Éc_a¢1_li¡
 *
A
 = (Éc_a¢1_li¡ *)
a
, *
B
 = (Éc_a¢1_li¡ *)
b
;

46 
r
;

48 
r
 = 
	`Éc_to_a¢1
(
A
->
ty³
è-†tc_to_a¢1(
B
->type);

51 ià(
r
 == 0) {

53  
A
->
u£d
 - 
B
->used;

55  
r
;

57 
	}
}

67 
	$d”_’code_£t
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

68 *
out
, *
ou’
)

70 
Éc_a¢1_li¡
 *
cİy
;

71 
x
;

72 
”r
;

75 
cİy
 = 
	`XCALLOC
(
šËn
, (*copy));

76 ià(
cİy
 =ğ
NULL
) {

77  
CRYPT_MEM
;

81 
x
 = 0; x < 
šËn
; x++) {

82 
cİy
[
x
] = 
li¡
[x];

83 
cİy
[
x
].
u£d
 = x;

87 
	`XQSORT
(
cİy
, 
šËn
, (*cİy), &
qsÜt_h–³r
);

90 
”r
 = 
	`d”_’code_£qu’û_ex
(
cİy
, 
šËn
, 
out
, 
ou’
, 
LTC_ASN1_SET
);

93 
	`XFREE
(
cİy
);

95  
”r
;

96 
	}
}

	@libtomcrypt/src/pk/asn1/der/set/der_encode_setof.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


20 
	sedge
 {

21 *
	m¡¬t
;

22 
	msize
;

25 
	$qsÜt_h–³r
(cÚ¡ *
a
, cÚ¡ *
b
)

27 
edge
 *
A
 = (edg*)
a
, *
B
 = (edg*)
b
;

28 
r
;

29 
x
;

32 
r
 = 
	`XMEMCMP
(
A
->
¡¬t
, 
B
->¡¬t, 
	`MIN
(A->
size
, B->size));

34 ià(
r
 =ğ0 && 
A
->
size
 !ğ
B
->size) {

35 ià(
A
->
size
 > 
B
->size) {

36 
x
 = 
B
->
size
; x < 
A
->size; x++) {

37 ià(
A
->
¡¬t
[
x
]) {

42 
x
 = 
A
->
size
; x < 
B
->size; x++) {

43 ià(
B
->
¡¬t
[
x
]) {

50  
r
;

51 
	}
}

61 
	$d”_’code_£tof
(
Éc_a¢1_li¡
 *
li¡
, 
šËn
,

62 *
out
, *
ou’
)

64 
x
, 
y
, 
z
, 
hd¾’
;

65 
”r
;

66 
edge
 *
edges
;

67 *
±r
, *
buf
;

70 
x
 = 1; x < 
šËn
; x++) {

71 ià(
li¡
[
x
].
ty³
 !=†ist[x-1].type) {

72  
CRYPT_INVALID_ARG
;

77 
buf
 = 
	`XCALLOC
(1, *
ou’
);

78 ià(
buf
 =ğ
NULL
) {

79  
CRYPT_MEM
;

83 ià((
”r
 = 
	`d”_’code_£qu’û_ex
(
li¡
, 
šËn
, 
buf
, 
ou’
, 
LTC_ASN1_SETOF
)è!ğ
CRYPT_OK
) {

84 
	`XFREE
(
buf
);

85  
”r
;

89 
edges
 = 
	`XCALLOC
(
šËn
, (*edges));

90 ià(
edges
 =ğ
NULL
) {

91 
	`XFREE
(
buf
);

92  
CRYPT_MEM
;

96 
±r
 = 
buf
 + 1;

99 
x
 = *
±r
++;

100 ià(
x
 >= 0x80) {

101 
±r
 +ğ(
x
 & 0x7F);

105 
hd¾’
 = (()
±r
è- (()
buf
);

109 
x
 = 0;

110 
±r
 < (
buf
 + *
ou’
)) {

112 
edges
[
x
].
¡¬t
 = 
±r
;

115 
z
 = 1;

118 
y
 = 
±r
[
z
++];

119 ià(
y
 < 128) {

120 
edges
[
x
].
size
 = 
y
;

122 
y
 &= 0x7F;

123 
edges
[
x
].
size
 = 0;

124 
y
--) {

125 
edges
[
x
].
size
 = (edges[x].siz<< 8è| (()
±r
[
z
++]);

130 
edges
[
x
].
size
 +ğ
z
;

131 
±r
 +ğ
edges
[
x
].
size
;

132 ++
x
;

136 
	`XQSORT
(
edges
, 
šËn
, (*edges), &
qsÜt_h–³r
);

139 
	`XMEMCPY
(
out
, 
buf
, 
hd¾’
);

142 
y
 = 
hd¾’
, 
x
 = 0; x < 
šËn
; x++) {

143 
	`XMEMCPY
(
out
+
y
, 
edges
[
x
].
¡¬t
,ƒdges[x].
size
);

144 
y
 +ğ
edges
[
x
].
size
;

147 #ifdeà
LTC_CLEAN_STACK


148 
	`z”omem
(
buf
, *
ou’
);

152 
	`XFREE
(
edges
);

153 
	`XFREE
(
buf
);

155  
CRYPT_OK
;

156 
	}
}

	@libtomcrypt/src/pk/asn1/der/short_integer/der_decode_short_integer.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


28 
	$d”_decode_shÜt_š‹g”
(cÚ¡ *
š
, 
šËn
, *
num
)

30 
Ën
, 
x
, 
y
;

32 
	`LTC_ARGCHK
(
num
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

36 ià(
šËn
 < 2) {

37  
CRYPT_INVALID_PACKET
;

41 
x
 = 0;

42 ià((
š
[
x
++] & 0x1F) != 0x02) {

43  
CRYPT_INVALID_PACKET
;

47 
Ën
 = 
š
[
x
++];

49 ià(
x
 + 
Ën
 > 
šËn
) {

50  
CRYPT_INVALID_PACKET
;

54 
y
 = 0;

55 
Ën
--) {

56 
y
 = (y<<8è| ()
š
[
x
++];

58 *
num
 = 
y
;

60  
CRYPT_OK
;

62 
	}
}

	@libtomcrypt/src/pk/asn1/der/short_integer/der_encode_short_integer.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


28 
	$d”_’code_shÜt_š‹g”
(
num
, *
out
, *
ou’
)

30 
Ën
, 
x
, 
y
, 
z
;

31 
”r
;

33 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

37 
num
 &= 0xFFFFFFFFUL;

40 ià((
”r
 = 
	`d”_Ëngth_shÜt_š‹g”
(
num
, &
Ën
)è!ğ
CRYPT_OK
) {

41  
”r
;

44 ià(*
ou’
 < 
Ën
) {

45 *
ou’
 = 
Ën
;

46  
CRYPT_BUFFER_OVERFLOW
;

50 
z
 = 0;

51 
y
 = 
num
;

52 
y
) {

53 ++
z
;

54 
y
 >>= 8;

58 ià(
z
 == 0) {

59 
z
 = 1;

63 
z
 +ğ(
num
&(1UL<<((z<<3) - 1))) ? 1 : 0;

66 
x
 = 0; (
z
 <= 4) && (x < (4 - z)); x++) {

67 
num
 <<= 8;

71 
x
 = 0;

72 
out
[
x
++] = 0x02;

73 
out
[
x
++] = ()
z
;

76 ià(
z
 == 5) {

77 
out
[
x
++] = 0;

78 --
z
;

82 
y
 = 0; y < 
z
; y++) {

83 
out
[
x
++] = ()((
num
 >> 24) & 0xFF);

84 
num
 <<= 8;

88 *
ou’
 = 
x
;

90  
CRYPT_OK
;

91 
	}
}

	@libtomcrypt/src/pk/asn1/der/short_integer/der_length_short_integer.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


26 
	$d”_Ëngth_shÜt_š‹g”
(
num
, *
ou’
)

28 
z
, 
y
, 
Ën
;

30 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

33 
num
 &= 0xFFFFFFFFUL;

36 
z
 = 0;

37 
y
 = 
num
;

38 
y
) {

39 ++
z
;

40 
y
 >>= 8;

44 ià(
z
 == 0) {

45 
z
 = 1;

49 
Ën
 = 1;

52 ++
Ën
;

55 
Ën
 +ğ
z
;

58 
Ën
 +ğ(
num
&(1UL<<((
z
<<3) - 1))) ? 1 : 0;

61 *
ou’
 = 
Ën
;

63  
CRYPT_OK
;

64 
	}
}

	@libtomcrypt/src/pk/asn1/der/utctime/der_decode_utctime.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


20 
	$ch¬_to_št
(
x
)

22 
x
) {

35 
	}
}

37 
	#DECODE_V
(
y
, 
max
) \

38 
y
 = 
	`ch¬_to_št
(
buf
[
x
])*10 + char_to_int(buf[x+1]); \

39 ià(
y
 >ğ
max
è 
CRYPT_INVALID_PACKET
; \

40 
x
 +ğ2;

	)

49 
	$d”_decode_utùime
(cÚ¡ *
š
, *
šËn
,

50 
Éc_utùime
 *
out
)

52 
buf
[32];

53 
x
;

54 
y
;

56 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

57 
	`LTC_ARGCHK
(
šËn
 !ğ
NULL
);

58 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

61 ià(*
šËn
 < 2UL || (
š
[1] >ğ(
buf
)) || ((in[1] + 2UL) > *inlen)) {

62  
CRYPT_INVALID_PACKET
;

66 
x
 = 0; x < 
š
[1]; x++) {

67 
y
 = 
	`d”_Ÿ5_v®ue_decode
(
š
[
x
+2]);

68 ià(
y
 == -1) {

69  
CRYPT_INVALID_PACKET
;

71 
buf
[
x
] = 
y
;

73 *
šËn
 = 2 + 
x
;

87 
x
 = 0;

88 
	`DECODE_V
(
out
->
YY
, 100);

89 
	`DECODE_V
(
out
->
MM
, 13);

90 
	`DECODE_V
(
out
->
DD
, 32);

91 
	`DECODE_V
(
out
->
hh
, 24);

92 
	`DECODE_V
(
out
->
mm
, 60);

95 
out
->
off_dœ
 = out->
off_hh
 = out->
off_mm
 = out->
ss
 = 0;

98 ià(
buf
[
x
] == 'Z') {

99  
CRYPT_OK
;

100 } ià(
buf
[
x
] == '+' || buf[x] == '-') {

101 
out
->
off_dœ
 = (
buf
[
x
++] == '+') ? 0 : 1;

102 
	`DECODE_V
(
out
->
off_hh
, 24);

103 
	`DECODE_V
(
out
->
off_mm
, 60);

104  
CRYPT_OK
;

108 
	`DECODE_V
(
out
->
ss
, 60);

111 ià(
buf
[
x
] == 'Z') {

112  
CRYPT_OK
;

113 } ià(
buf
[
x
] == '+' || buf[x] == '-') {

114 
out
->
off_dœ
 = (
buf
[
x
++] == '+') ? 0 : 1;

115 
	`DECODE_V
(
out
->
off_hh
, 24);

116 
	`DECODE_V
(
out
->
off_mm
, 60);

117  
CRYPT_OK
;

119  
CRYPT_INVALID_PACKET
;

121 
	}
}

	@libtomcrypt/src/pk/asn1/der/utctime/der_encode_utctime.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


20 cÚ¡ *
	gba£‹n
 = "0123456789";

22 
	#STORE_V
(
y
) \

23 
out
[
x
++] = 
	`d”_Ÿ5_ch¬_’code
(
ba£‹n
[(
y
/10) % 10]); \

24 
out
[
x
++] = 
	`d”_Ÿ5_ch¬_’code
(
ba£‹n
[
y
 % 10]);

	)

33 
	$d”_’code_utùime
(
Éc_utùime
 *
utùime
,

34 *
out
, *
ou’
)

36 
x
, 
tm¶’
;

37 
”r
;

39 
	`LTC_ARGCHK
(
utùime
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

43 ià((
”r
 = 
	`d”_Ëngth_utùime
(
utùime
, &
tm¶’
)è!ğ
CRYPT_OK
) {

44  
”r
;

46 ià(
tm¶’
 > *
ou’
) {

47 *
ou’
 = 
tm¶’
;

48  
CRYPT_BUFFER_OVERFLOW
;

52 
out
[0] = 0x17;

55 
x
 = 2;

56 
	`STORE_V
(
utùime
->
YY
);

57 
	`STORE_V
(
utùime
->
MM
);

58 
	`STORE_V
(
utùime
->
DD
);

59 
	`STORE_V
(
utùime
->
hh
);

60 
	`STORE_V
(
utùime
->
mm
);

61 
	`STORE_V
(
utùime
->
ss
);

63 ià(
utùime
->
off_mm
 || utùime->
off_hh
) {

64 
out
[
x
++] = 
	`d”_Ÿ5_ch¬_’code
(
utùime
->
off_dœ
 ? '-' : '+');

65 
	`STORE_V
(
utùime
->
off_hh
);

66 
	`STORE_V
(
utùime
->
off_mm
);

68 
out
[
x
++] = 
	`d”_Ÿ5_ch¬_’code
('Z');

72 
out
[1] = ()(
x
 - 2);

75 *
ou’
 = 
x
;

76  
CRYPT_OK
;

77 
	}
}

	@libtomcrypt/src/pk/asn1/der/utctime/der_length_utctime.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


26 
	$d”_Ëngth_utùime
(
Éc_utùime
 *
utùime
, *
ou’
)

28 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

29 
	`LTC_ARGCHK
(
utùime
 !ğ
NULL
);

31 ià(
utùime
->
off_hh
 =ğ0 && utùime->
off_mm
 == 0) {

33 *
ou’
 = 2 + 13;

36 *
ou’
 = 2 + 17;

39  
CRYPT_OK
;

40 
	}
}

	@libtomcrypt/src/pk/asn1/der/utf8/der_decode_utf8_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_decode_utf8_¡ršg
(cÚ¡ *
š
, 
šËn
,

30 
wch¬_t
 *
out
, *
ou’
)

32 
wch¬_t
 
tmp
;

33 
x
, 
y
, 
z
, 
Ën
;

35 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

40 ià(
šËn
 < 2) {

41  
CRYPT_INVALID_PACKET
;

45 ià((
š
[0] & 0x1F) != 0x0C) {

46  
CRYPT_INVALID_PACKET
;

48 
x
 = 1;

51 ià(
š
[
x
] & 0x80) {

53 
y
 = 
š
[
x
] & 0x7F;

54 ià((
y
 =ğ0è|| (y > 3è|| ((
x
 + yè> 
šËn
)) {

55  
CRYPT_INVALID_PACKET
;

59 
Ën
 = 0;

60 ++
x
;

61 
y
--) {

62 
Ën
 = (ËÀ<< 8è| 
š
[
x
++];

65 
Ën
 = 
š
[
x
++] & 0x7F;

68 ià(
Ën
 + 
x
 > 
šËn
) {

69  
CRYPT_INVALID_PACKET
;

73 
y
 = 0; 
x
 < 
šËn
; ) {

75 
tmp
 = 
š
[
x
++];

78 
z
 = 0; (
tmp
 & 0x80) && (z <= 4); z++,mp = (tmp << 1) & 0xFF);

80 ià(
z
 > 4 || (
x
 + (z - 1è> 
šËn
)) {

81  
CRYPT_INVALID_PACKET
;

85 
tmp
 >>ğ
z
;

88 ià(
z
 > 1) { --z; }

89 
z
-- != 0) {

90 ià((
š
[
x
] & 0xC0) != 0x80) {

91  
CRYPT_INVALID_PACKET
;

93 
tmp
 = (tm°<< 6è| ((
wch¬_t
)
š
[
x
++] & 0x3F);

96 ià(
y
 > *
ou’
) {

97 *
ou’
 = 
y
;

98  
CRYPT_BUFFER_OVERFLOW
;

100 
out
[
y
++] = 
tmp
;

102 *
ou’
 = 
y
;

104  
CRYPT_OK
;

105 
	}
}

	@libtomcrypt/src/pk/asn1/der/utf8/der_encode_utf8_string.c

11 
	~"tomüy±.h
"

19 #ifdeà
LTC_DER


29 
	$d”_’code_utf8_¡ršg
(cÚ¡ 
wch¬_t
 *
š
, 
šËn
,

30 *
out
, *
ou’
)

32 
x
, 
y
, 
Ën
;

34 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

39 
x
 = 
Ën
 = 0; x < 
šËn
; x++) {

40 ià(
š
[
x
] < 0 || in[x] > 0x1FFFF) {

41  
CRYPT_INVALID_ARG
;

43 
Ën
 +ğ
	`d”_utf8_ch¬size
(
š
[
x
]);

46 ià(
Ën
 < 128) {

47 
y
 = 2 + 
Ën
;

48 } ià(
Ën
 < 256) {

49 
y
 = 3 + 
Ën
;

50 } ià(
Ën
 < 65536UL) {

51 
y
 = 4 + 
Ën
;

52 } ià(
Ën
 < 16777216UL) {

53 
y
 = 5 + 
Ën
;

55  
CRYPT_INVALID_ARG
;

59 ià(
y
 > *
ou’
) {

60 *
ou’
 = 
Ën
;

61  
CRYPT_BUFFER_OVERFLOW
;

65 
x
 = 0;

66 
out
[
x
++] = 0x0C;

67 ià(
Ën
 < 128) {

68 
out
[
x
++] = 
Ën
;

69 } ià(
Ën
 < 256) {

70 
out
[
x
++] = 0x81;

71 
out
[
x
++] = 
Ën
;

72 } ià(
Ën
 < 65536UL) {

73 
out
[
x
++] = 0x82;

74 
out
[
x
++] = (
Ën
>>8)&255;

75 
out
[
x
++] = 
Ën
&255;

76 } ià(
Ën
 < 16777216UL) {

77 
out
[
x
++] = 0x83;

78 
out
[
x
++] = (
Ën
>>16)&255;

79 
out
[
x
++] = (
Ën
>>8)&255;

80 
out
[
x
++] = 
Ën
&255;

82  
CRYPT_INVALID_ARG
;

86 
y
 = 0; y < 
šËn
; y++) {

87 
	`d”_utf8_ch¬size
(
š
[
y
])) {

88 1: 
out
[
x
++] = 
š
[
y
]; ;

89 2: 
out
[
x
++] = 0xC0 | ((
š
[
y
] >> 6) & 0x1F); out[x++] = 0x80 | (in[y] & 0x3F); ;

90 3: 
out
[
x
++] = 0xE0 | ((
š
[
y
] >> 12) & 0x0F); out[x++] = 0x80 | ((in[y] >> 6) & 0x3F); out[x++] = 0x80 | (in[y] & 0x3F); ;

91 4: 
out
[
x
++] = 0xF0 | ((
š
[
y
] >> 18) & 0x07); out[x++] = 0x80 | ((in[y] >> 12) & 0x3F); out[x++] = 0x80 | ((in[y] >> 6) & 0x3F); out[x++] = 0x80 | (in[y] & 0x3F); ;

96 *
ou’
 = 
x
;

98  
CRYPT_OK
;

99 
	}
}

	@libtomcrypt/src/pk/asn1/der/utf8/der_length_utf8_string.c

11 
	~"tomüy±.h
"

18 #ifdeà
LTC_DER


24 
	$d”_utf8_ch¬size
(cÚ¡ 
wch¬_t
 
c
)

26 ià(
c
 <= 0x7F) {

28 } ià(
c
 <= 0x7FF) {

30 } ià(
c
 <= 0xFFFF) {

35 
	}
}

44 
	$d”_Ëngth_utf8_¡ršg
(cÚ¡ 
wch¬_t
 *
š
, 
noù‘s
, *
ou’
)

46 
x
, 
Ën
;

48 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

49 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

51 
Ën
 = 0;

52 
x
 = 0; x < 
noù‘s
; x++) {

53 ià(
š
[
x
] < 0 || in[x] > 0x10FFFF) {

54  
CRYPT_INVALID_ARG
;

56 
Ën
 +ğ
	`d”_utf8_ch¬size
(
š
[
x
]);

59 ià(
Ën
 < 128) {

61 *
ou’
 = 2 + 
Ën
;

62 } ià(
Ën
 < 256) {

64 *
ou’
 = 3 + 
Ën
;

65 } ià(
Ën
 < 65536UL) {

67 *
ou’
 = 4 + 
Ën
;

68 } ià(
Ën
 < 16777216UL) {

70 *
ou’
 = 5 + 
Ën
;

72  
CRYPT_INVALID_ARG
;

75  
CRYPT_OK
;

76 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_decrypt_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


29 
	$d§_deüy±_key
(cÚ¡ *
š
, 
šËn
,

30 *
out
, *
ou’
,

31 
d§_key
 *
key
)

33 *
skey
, *
ex±
;

34 *
g_pub
;

35 
x
, 
y
, 
hashOID
[32];

36 
hash
, 
”r
;

37 
Éc_a¢1_li¡
 
decode
[3];

39 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 ià(
key
->
ty³
 !ğ
PK_PRIVATE
) {

46  
CRYPT_PK_NOT_PRIVATE
;

50 
	`LTC_SET_ASN1
(
decode
, 0, 
LTC_ASN1_OBJECT_IDENTIFIER
, 
hashOID
, (hashOID)/(hashOID[0]));

52 ià((
”r
 = 
	`d”_decode_£qu’û
(
š
, 
šËn
, 
decode
, 1)è!ğ
CRYPT_OK
) {

53  
”r
;

56 
hash
 = 
	`fšd_hash_oid
(
hashOID
, 
decode
[0].
size
);

57 ià(
	`hash_is_v®id
(
hash
è!ğ
CRYPT_OK
) {

58  
CRYPT_INVALID_PACKET
;

63 ià((
”r
 = 
	`mp_š™
(&
g_pub
)è!ğ
CRYPT_OK
) {

64  
”r
;

68 
ex±
 = 
	`XMALLOC
(
	`mp_unsigÃd_bš_size
(
key
->
p
) + 1);

69 
skey
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

70 ià(
ex±
 =ğ
NULL
 || 
skey
 == NULL) {

71 ià(
ex±
 !ğ
NULL
) {

72 
	`XFREE
(
ex±
);

74 ià(
skey
 !ğ
NULL
) {

75 
	`XFREE
(
skey
);

77 
	`mp_ş—r
(
g_pub
);

78  
CRYPT_MEM
;

81 
	`LTC_SET_ASN1
(
decode
, 1, 
LTC_ASN1_INTEGER
, 
g_pub
, 1UL);

82 
	`LTC_SET_ASN1
(
decode
, 2, 
LTC_ASN1_OCTET_STRING
, 
skey
, 
MAXBLOCKSIZE
);

85 ià((
”r
 = 
	`d”_decode_£qu’û
(
š
, 
šËn
, 
decode
, 3)è!ğ
CRYPT_OK
) {

86 
LBL_ERR
;

90 
x
 = 
	`mp_unsigÃd_bš_size
(
key
->
p
) + 1;

91 ià((
”r
 = 
	`d§_sh¬ed_£ü‘
(
key
->
x
, 
g_pub
, key, 
ex±
, &x)è!ğ
CRYPT_OK
) {

92 
LBL_ERR
;

95 
y
 = 
	`MIN
(
	`mp_unsigÃd_bš_size
(
key
->
p
è+ 1, 
MAXBLOCKSIZE
);

96 ià((
”r
 = 
	`hash_memÜy
(
hash
, 
ex±
, 
x
,ƒx±, &
y
)è!ğ
CRYPT_OK
) {

97 
LBL_ERR
;

101 ià(
decode
[2].
size
 > 
y
) {

102 
”r
 = 
CRYPT_INVALID_PACKET
;

103 
LBL_ERR
;

107 ià(*
ou’
 < 
decode
[2].
size
) {

108 *
ou’
 = 
decode
[2].
size
;

109 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

110 
LBL_ERR
;

114 
x
 = 0; x < 
decode
[2].
size
; x++) {

115 
out
[
x
] = 
ex±
[x] ^ 
skey
[x];

117 *
ou’
 = 
x
;

119 
”r
 = 
CRYPT_OK
;

120 
LBL_ERR
:

121 #ifdeà
LTC_CLEAN_STACK


122 
	`z”omem
(
ex±
, 
	`mp_unsigÃd_bš_size
(
key
->
p
) + 1);

123 
	`z”omem
(
skey
, 
MAXBLOCKSIZE
);

126 
	`XFREE
(
ex±
);

127 
	`XFREE
(
skey
);

129 
	`mp_ş—r
(
g_pub
);

131  
”r
;

132 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_encrypt_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


32 
	$d§_’üy±_key
(cÚ¡ *
š
, 
šËn
,

33 *
out
, *
ou’
,

34 
´ng_¡©e
 *
´ng
, 
w´ng
, 
hash
,

35 
d§_key
 *
key
)

37 *
ex±
, *
skey
;

38 *
g_pub
, *
g_´iv
;

39 
x
, 
y
;

40 
”r
;

42 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

48 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

49  
”r
;

52 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

53  
”r
;

56 ià(
šËn
 > 
hash_desütÜ
[
hash
].
hashsize
) {

57  
CRYPT_INVALID_HASH
;

61 ià((
”r
 = 
	`mp_š™_muÉi
(&
g_pub
, &
g_´iv
, 
NULL
)è!ğ
CRYPT_OK
) {

62  
”r
;

65 
ex±
 = 
	`XMALLOC
(
	`mp_unsigÃd_bš_size
(
key
->
p
) + 1);

66 
skey
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

67 ià(
ex±
 =ğ
NULL
 || 
skey
 == NULL) {

68 ià(
ex±
 !ğ
NULL
) {

69 
	`XFREE
(
ex±
);

71 ià(
skey
 !ğ
NULL
) {

72 
	`XFREE
(
skey
);

74 
	`mp_ş—r_muÉi
(
g_pub
, 
g_´iv
, 
NULL
);

75  
CRYPT_MEM
;

79 
x
 = 
	`mp_unsigÃd_bš_size
(
key
->
q
);

80 ià(
´ng_desütÜ
[
w´ng
].
	`»ad
(
ex±
, 
x
, 
´ng
) != x) {

81 
”r
 = 
CRYPT_ERROR_READPRNG
;

82 
LBL_ERR
;

86 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
g_´iv
, 
ex±
, 
x
)è!ğ
CRYPT_OK
) {

87 
LBL_ERR
;

91 ià((
”r
 = 
	`mp_ex±mod
(
key
->
g
, 
g_´iv
, key->
p
, 
g_pub
)è!ğ
CRYPT_OK
) {

92 
LBL_ERR
;

96 
x
 = 
	`mp_unsigÃd_bš_size
(
key
->
p
) + 1;

97 ià((
”r
 = 
	`d§_sh¬ed_£ü‘
(
g_´iv
, 
key
->
y
, key, 
ex±
, &
x
)è!ğ
CRYPT_OK
) {

98 
LBL_ERR
;

101 
y
 = 
MAXBLOCKSIZE
;

102 ià((
”r
 = 
	`hash_memÜy
(
hash
, 
ex±
, 
x
, 
skey
, &
y
)è!ğ
CRYPT_OK
) {

103 
LBL_ERR
;

107 
x
 = 0; x < 
šËn
; x++) {

108 
skey
[
x
] ^ğ
š
[x];

111 
”r
 = 
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

112 
LTC_ASN1_OBJECT_IDENTIFIER
, 
hash_desütÜ
[
hash
].
OIDËn
, hash_desütÜ[hash].
OID
,

113 
LTC_ASN1_INTEGER
, 1UL, 
g_pub
,

114 
LTC_ASN1_OCTET_STRING
, 
šËn
, 
skey
,

115 
LTC_ASN1_EOL
, 0UL, 
NULL
);

117 
LBL_ERR
:

118 #ifdeà
LTC_CLEAN_STACK


120 
	`z”omem
(
ex±
, 
	`mp_unsigÃd_bš_size
(
key
->
p
) + 1);

121 
	`z”omem
(
skey
, 
MAXBLOCKSIZE
);

124 
	`XFREE
(
skey
);

125 
	`XFREE
(
ex±
);

127 
	`mp_ş—r_muÉi
(
g_pub
, 
g_´iv
, 
NULL
);

128  
”r
;

129 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_export.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


28 
	$d§_expÜt
(*
out
, *
ou’
, 
ty³
, 
d§_key
 *
key
)

30 
æags
[1];

32 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

37 ià(
ty³
 =ğ
PK_PRIVATE
 && 
key
->type != PK_PRIVATE) {

38  
CRYPT_PK_TYPE_MISMATCH
;

41 ià(
ty³
 !ğ
PK_PUBLIC
 &&y³ !ğ
PK_PRIVATE
) {

42  
CRYPT_INVALID_ARG
;

45 
æags
[0] = (
ty³
 !ğ
PK_PUBLIC
) ? 1 : 0;

47 ià(
ty³
 =ğ
PK_PRIVATE
) {

48  
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

49 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

50 
LTC_ASN1_INTEGER
, 1UL, 
key
->
g
,

51 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

52 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

53 
LTC_ASN1_INTEGER
, 1UL, 
key
->
y
,

54 
LTC_ASN1_INTEGER
, 1UL, 
key
->
x
,

55 
LTC_ASN1_EOL
, 0UL, 
NULL
);

57  
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

58 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

59 
LTC_ASN1_INTEGER
, 1UL, 
key
->
g
,

60 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

61 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

62 
LTC_ASN1_INTEGER
, 1UL, 
key
->
y
,

63 
LTC_ASN1_EOL
, 0UL, 
NULL
);

65 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_free.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


24 
	$d§_ä“
(
d§_key
 *
key
)

26 
	`LTC_ARGCHKVD
(
key
 !ğ
NULL
);

27 
	`mp_ş—r_muÉi
(
key
->
g
, key->
q
, key->
p
, key->
x
, key->
y
, 
NULL
);

28 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_import.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


27 
	$d§_impÜt
(cÚ¡ *
š
, 
šËn
, 
d§_key
 *
key
)

29 
æags
[1];

30 
”r
;

32 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

37 ià(
	`mp_š™_muÉi
(&
key
->
p
, &key->
g
, &key->
q
, &key->
x
, &key->
y
, 
NULL
è!ğ
CRYPT_OK
) {

38  
CRYPT_MEM
;

42 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

43 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

44 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

45 
”rÜ
;

48 ià(
æags
[0] == 1) {

49 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

50 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

51 
LTC_ASN1_INTEGER
, 1UL, 
key
->
g
,

52 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

53 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

54 
LTC_ASN1_INTEGER
, 1UL, 
key
->
y
,

55 
LTC_ASN1_INTEGER
, 1UL, 
key
->
x
,

56 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

57 
”rÜ
;

59 
key
->
ty³
 = 
PK_PRIVATE
;

61 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

62 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

63 
LTC_ASN1_INTEGER
, 1UL, 
key
->
g
,

64 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

65 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

66 
LTC_ASN1_INTEGER
, 1UL, 
key
->
y
,

67 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

68 
”rÜ
;

70 
key
->
ty³
 = 
PK_PUBLIC
;

72 
key
->
qÜd
 = 
	`mp_unsigÃd_bš_size
(key->
q
);

74 ià(
key
->
qÜd
 >ğ
MDSA_MAX_GROUP
 || key->qord <= 15 ||

75 ()
key
->
qÜd
 >ğ
	`mp_unsigÃd_bš_size
(key->
p
è|| (mp_unsigÃd_bš_size(key->pè- key->qÜdè>ğ
MDSA_DELTA
) {

76 
”r
 = 
CRYPT_INVALID_PACKET
;

77 
”rÜ
;

80  
CRYPT_OK
;

81 
”rÜ
:

82 
	`mp_ş—r_muÉi
(
key
->
p
, key->
g
, key->
q
, key->
x
, key->
y
, 
NULL
);

83  
”r
;

84 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_make_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


29 
	$d§_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
group_size
, 
modulus_size
, 
d§_key
 *
key
)

31 *
tmp
, *
tmp2
;

32 
”r
, 
»s
;

33 *
buf
;

35 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

36 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

39 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

40  
”r
;

44 ià(
group_size
 >ğ
MDSA_MAX_GROUP
 || group_size <= 15 ||

45 
group_size
 >ğ
modulus_size
 || (modulus_siz- group_sizeè>ğ
MDSA_DELTA
) {

46  
CRYPT_INVALID_ARG
;

50 
buf
 = 
	`XMALLOC
(
MDSA_DELTA
);

51 ià(
buf
 =ğ
NULL
) {

52  
CRYPT_MEM
;

56 ià((
”r
 = 
	`mp_š™_muÉi
(&
tmp
, &
tmp2
, &
key
->
g
, &key->
q
, &key->
p
, &key->
x
, &key->
y
, 
NULL
)è!ğ
CRYPT_OK
) {

57 
	`XFREE
(
buf
);

58  
”r
;

62 ià((
”r
 = 
	`¿nd_´ime
(
key
->
q
, 
group_size
, 
´ng
, 
w´ng
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

65 ià((
”r
 = 
	`mp_add
(
key
->
q
, key->q, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

68 ià(
´ng_desütÜ
[
w´ng
].
	`»ad
(
buf
+1, 
modulus_size
 - 
group_size
, 
´ng
) != ()(modulus_size - group_size)) {

69 
”r
 = 
CRYPT_ERROR_READPRNG
;

70 
”rÜ
;

74 
buf
[0] |= 0xC0;

77 
buf
[
modulus_size
 - 
group_size
 - 1] &= ~1;

79 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
tmp2
, 
buf
, 
modulus_size
 - 
group_size
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

80 ià((
”r
 = 
	`mp_mul
(
key
->
q
, 
tmp2
, key->
p
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

81 ià((
”r
 = 
	`mp_add_d
(
key
->
p
, 1, key->p)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

85 ià((
”r
 = 
	`mp_´ime_is_´ime
(
key
->
p
, 8, &
»s
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

86 ià(
»s
 =ğ
LTC_MP_YES
) ;

89 ià((
”r
 = 
	`mp_add
(
tmp
, 
key
->
p
, key->p)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

90 ià((
”r
 = 
	`mp_add_d
(
tmp2
, 2,mp2)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

94 
	`mp_£t
(
key
->
g
, 1);

97 ià((
”r
 = 
	`mp_add_d
(
key
->
g
, 1, key->g)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

98 ià((
”r
 = 
	`mp_ex±mod
(
key
->
g
, 
tmp2
, key->
p
, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

99 } 
	`mp_cmp_d
(
tmp
, 1è=ğ
LTC_MP_EQ
);

102 
	`mp_exch
(
tmp
, 
key
->
g
);

108 ià(
´ng_desütÜ
[
w´ng
].
	`»ad
(
buf
, 
group_size
, 
´ng
) != ()group_size) {

109 
”r
 = 
CRYPT_ERROR_READPRNG
;

110 
”rÜ
;

112 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
key
->
x
, 
buf
, 
group_size
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

113 } 
	`mp_cmp_d
(
key
->
x
, 1è!ğ
LTC_MP_GT
);

114 ià((
”r
 = 
	`mp_ex±mod
(
key
->
g
, key->
x
, key->
p
, key->
y
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

116 
key
->
ty³
 = 
PK_PRIVATE
;

117 
key
->
qÜd
 = 
group_size
;

119 #ifdeà
LTC_CLEAN_STACK


120 
	`z”omem
(
buf
, 
MDSA_DELTA
);

123 
”r
 = 
CRYPT_OK
;

124 
dÚe
;

125 
”rÜ
:

126 
	`mp_ş—r_muÉi
(
key
->
g
, key->
q
, key->
p
, key->
x
, key->
y
, 
NULL
);

127 
dÚe
:

128 
	`mp_ş—r_muÉi
(
tmp
, 
tmp2
, 
NULL
);

129 
	`XFREE
(
buf
);

130  
”r
;

131 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_shared_secret.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


29 
	$d§_sh¬ed_£ü‘
(*
´iv©e_key
, *
ba£
,

30 
d§_key
 *
public_key
,

31 *
out
, *
ou’
)

33 
x
;

34 *
»s
;

35 
”r
;

37 
	`LTC_ARGCHK
(
´iv©e_key
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
public_key
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

43 ià((
”r
 = 
	`mp_š™
(&
»s
)è!ğ
CRYPT_OK
) {

44  
”r
;

47 ià((
”r
 = 
	`mp_ex±mod
(
ba£
, 
´iv©e_key
, 
public_key
->
p
, 
»s
)è!ğ
CRYPT_OK
) {

48 
	`mp_ş—r
(
»s
);

49  
”r
;

52 
x
 = ()
	`mp_unsigÃd_bš_size
(
»s
);

53 ià(*
ou’
 < 
x
) {

54 *
ou’
 = 
x
;

55 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

56 
dÚe
;

58 
	`z”omem
(
out
, 
x
);

59 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
»s
, 
out
 + (
x
 - 
	`mp_unsigÃd_bš_size
Ôes)))è!ğ
CRYPT_OK
è{ 
dÚe
; }

61 
”r
 = 
CRYPT_OK
;

62 *
ou’
 = 
x
;

63 
dÚe
:

64 
	`mp_ş—r
(
»s
);

65  
”r
;

66 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_sign_hash.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


31 
	$d§_sign_hash_¿w
(cÚ¡ *
š
, 
šËn
,

32 *
r
, *
s
,

33 
´ng_¡©e
 *
´ng
, 
w´ng
, 
d§_key
 *
key
)

35 *
k
, *
kšv
, *
tmp
;

36 *
buf
;

37 
”r
;

39 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
r
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
s
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

45  
”r
;

47 ià(
key
->
ty³
 !ğ
PK_PRIVATE
) {

48  
CRYPT_PK_NOT_PRIVATE
;

52 ià(
key
->
qÜd
 >ğ
MDSA_MAX_GROUP
) {

53  
CRYPT_INVALID_ARG
;

56 
buf
 = 
	`XMALLOC
(
MDSA_MAX_GROUP
);

57 ià(
buf
 =ğ
NULL
) {

58  
CRYPT_MEM
;

62 ià((
”r
 = 
	`mp_š™_muÉi
(&
k
, &
kšv
, &
tmp
, 
NULL
)è!ğ
CRYPT_OK
è{ 
ERRBUF
; }

64 
»Œy
:

68 ià(
´ng_desütÜ
[
w´ng
].
	`»ad
(
buf
, 
key
->
qÜd
, 
´ng
) != ()key->qord) {

69 
”r
 = 
CRYPT_ERROR_READPRNG
;

70 
”rÜ
;

74 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
k
, 
buf
, 
key
->
qÜd
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

77 ià(
	`mp_cmp_d
(
k
, 1è!ğ
LTC_MP_GT
è{ 
»Œy
; }

80 ià((
”r
 = 
	`mp_gcd
(
k
, 
key
->
q
, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

81 } 
	`mp_cmp_d
(
tmp
, 1è!ğ
LTC_MP_EQ
);

84 ià((
”r
 = 
	`mp_švmod
(
k
, 
key
->
q
, 
kšv
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

87 ià((
”r
 = 
	`mp_ex±mod
(
key
->
g
, 
k
, key->
p
, 
r
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

88 ià((
”r
 = 
	`mp_mod
(
r
, 
key
->
q
,„)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

90 ià(
	`mp_isz”o
(
r
è=ğ
LTC_MP_YES
è{ 
»Œy
; }

93 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
tmp
, (*)
š
, 
šËn
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

94 ià((
”r
 = 
	`mp_mul
(
key
->
x
, 
r
, 
s
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

95 ià((
”r
 = 
	`mp_add
(
s
, 
tmp
, s)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

96 ià((
”r
 = 
	`mp_mulmod
(
s
, 
kšv
, 
key
->
q
, s)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

98 ià(
	`mp_isz”o
(
s
è=ğ
LTC_MP_YES
è{ 
»Œy
; }

100 
”r
 = 
CRYPT_OK
;

101 
”rÜ
:

102 
	`mp_ş—r_muÉi
(
k
, 
kšv
, 
tmp
, 
NULL
);

103 
ERRBUF
:

104 #ifdeà
LTC_CLEAN_STACK


105 
	`z”omem
(
buf
, 
MDSA_MAX_GROUP
);

107 
	`XFREE
(
buf
);

108  
”r
;

109 
	}
}

122 
	$d§_sign_hash
(cÚ¡ *
š
, 
šËn
,

123 *
out
, *
ou’
,

124 
´ng_¡©e
 *
´ng
, 
w´ng
, 
d§_key
 *
key
)

126 *
r
, *
s
;

127 
”r
;

129 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

130 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

131 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

132 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

134 ià(
	`mp_š™_muÉi
(&
r
, &
s
, 
NULL
è!ğ
CRYPT_OK
) {

135  
CRYPT_MEM
;

138 ià((
”r
 = 
	`d§_sign_hash_¿w
(
š
, 
šËn
, 
r
, 
s
, 
´ng
, 
w´ng
, 
key
)è!ğ
CRYPT_OK
) {

139 
”rÜ
;

142 
”r
 = 
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

143 
LTC_ASN1_INTEGER
, 1UL, 
r
,

144 
LTC_ASN1_INTEGER
, 1UL, 
s
,

145 
LTC_ASN1_EOL
, 0UL, 
NULL
);

147 
”rÜ
:

148 
	`mp_ş—r_muÉi
(
r
, 
s
, 
NULL
);

149  
”r
;

150 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_verify_hash.c

11 
	~"tomüy±.h
"

19 #ifdeà
MDSA


31 
	$d§_v”ify_hash_¿w
Ğ*
r
, *
s
,

32 cÚ¡ *
hash
, 
hashËn
,

33 *
¡©
, 
d§_key
 *
key
)

35 *
w
, *
v
, *
u1
, *
u2
;

36 
”r
;

38 
	`LTC_ARGCHK
(
r
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
s
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 *
¡©
 = 0;

47 ià((
”r
 = 
	`mp_š™_muÉi
(&
w
, &
v
, &
u1
, &
u2
, 
NULL
)è!ğ
CRYPT_OK
) {

48  
”r
;

52 ià(
	`mp_isz”o
(
r
è=ğ
LTC_MP_YES
 || mp_isz”o(
s
è=ğLTC_MP_YES || 
	`mp_cmp
Ô, 
key
->
q
è!ğ
LTC_MP_LT
 || mp_cmp(s, key->q) != LTC_MP_LT) {

53 
”r
 = 
CRYPT_INVALID_PACKET
;

54 
”rÜ
;

58 ià((
”r
 = 
	`mp_švmod
(
s
, 
key
->
q
, 
w
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

61 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
u1
, (*)
hash
, 
hashËn
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

62 ià((
”r
 = 
	`mp_mulmod
(
u1
, 
w
, 
key
->
q
, u1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

65 ià((
”r
 = 
	`mp_mulmod
(
r
, 
w
, 
key
->
q
, 
u2
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

68 ià((
”r
 = 
	`mp_ex±mod
(
key
->
g
, 
u1
, key->
p
, u1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

69 ià((
”r
 = 
	`mp_ex±mod
(
key
->
y
, 
u2
, key->
p
, u2)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

70 ià((
”r
 = 
	`mp_mulmod
(
u1
, 
u2
, 
key
->
p
, 
v
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

71 ià((
”r
 = 
	`mp_mod
(
v
, 
key
->
q
, v)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

74 ià(
	`mp_cmp
(
r
, 
v
è=ğ
LTC_MP_EQ
) {

75 *
¡©
 = 1;

78 
”r
 = 
CRYPT_OK
;

79 
”rÜ
:

80 
	`mp_ş—r_muÉi
(
w
, 
v
, 
u1
, 
u2
, 
NULL
);

81  
”r
;

82 
	}
}

94 
	$d§_v”ify_hash
(cÚ¡ *
sig
, 
sigËn
,

95 cÚ¡ *
hash
, 
hashËn
,

96 *
¡©
, 
d§_key
 *
key
)

98 
”r
;

99 *
r
, *
s
;

101 ià((
”r
 = 
	`mp_š™_muÉi
(&
r
, &
s
, 
NULL
)è!ğ
CRYPT_OK
) {

102  
CRYPT_MEM
;

106 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
sig
, 
sigËn
,

107 
LTC_ASN1_INTEGER
, 1UL, 
r
,

108 
LTC_ASN1_INTEGER
, 1UL, 
s
,

109 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

110 
LBL_ERR
;

114 
”r
 = 
	`d§_v”ify_hash_¿w
(
r
, 
s
, 
hash
, 
hashËn
, 
¡©
, 
key
);

116 
LBL_ERR
:

117 
	`mp_ş—r_muÉi
(
r
, 
s
, 
NULL
);

118  
”r
;

119 
	}
}

	@libtomcrypt/src/pk/dsa/dsa_verify_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MDSA


26 
	$d§_v”ify_key
(
d§_key
 *
key
, *
¡©
)

28 *
tmp
, *
tmp2
;

29 
»s
, 
”r
;

31 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

35 *
¡©
 = 0;

38 ià((
”r
 = 
	`mp_´ime_is_´ime
(
key
->
q
, 8, &
»s
)è!ğ
CRYPT_OK
) {

39  
”r
;

41 ià(
»s
 == 0) {

42  
CRYPT_OK
;

45 ià((
”r
 = 
	`mp_´ime_is_´ime
(
key
->
p
, 8, &
»s
)è!ğ
CRYPT_OK
) {

46  
”r
;

48 ià(
»s
 == 0) {

49  
CRYPT_OK
;

53 ià(
	`mp_cmp_d
(
key
->
g
, 0è=ğ
LTC_MP_EQ
 || mp_cmp_d(key->g, 1) == LTC_MP_EQ) {

54  
CRYPT_OK
;

56 ià((
”r
 = 
	`mp_š™_muÉi
(&
tmp
, &
tmp2
, 
NULL
)è!ğ
CRYPT_OK
) { ƒrr; }

57 ià((
”r
 = 
	`mp_sub_d
(
key
->
p
, 1, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

58 ià(
	`mp_cmp
(
tmp
, 
key
->
g
è=ğ
LTC_MP_EQ
 || mp_cmp(key->g, key->
p
è!ğ
LTC_MP_LT
) {

59 
”r
 = 
CRYPT_OK
;

60 
”rÜ
;

64 ià(!(
	`mp_cmp_d
(
key
->
y
, 1è=ğ
LTC_MP_GT
 && 
	`mp_cmp
(key->y, 
tmp
è=ğ
LTC_MP_LT
)) {

65 
”r
 = 
CRYPT_OK
;

66 
”rÜ
;

70 ià((
”r
 = 
	`mp_div
(
tmp
, 
key
->
q
,mp, 
tmp2
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

71 ià(
	`mp_isz”o
(
tmp2
è!ğ
LTC_MP_YES
) {

72 
”r
 = 
CRYPT_OK
;

73 
”rÜ
;

76 ià((
”r
 = 
	`mp_ex±mod
(
key
->
g
, key->
q
, key->
p
, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

77 ià(
	`mp_cmp_d
(
tmp
, 1è!ğ
LTC_MP_EQ
) {

78 
”r
 = 
CRYPT_OK
;

79 
”rÜ
;

83 ià((
”r
 = 
	`mp_ex±mod
(
key
->
y
, key->
q
, key->
p
, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

84 ià(
	`mp_cmp_d
(
tmp
, 1è!ğ
LTC_MP_EQ
) {

85 
”r
 = 
CRYPT_OK
;

86 
”rÜ
;

90 
”r
 = 
CRYPT_OK
;

91 *
¡©
 = 1;

92 
”rÜ
:

93 
	`mp_ş—r_muÉi
(
tmp
, 
tmp2
, 
NULL
);

94  
”r
;

95 
	}
}

	@libtomcrypt/src/pk/ecc/ecc.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


27 cÚ¡ 
Éc_ecc_£t_ty³
 
	gÉc_ecc_£ts
[] = {

28 #ifdeà
ECC112


39 #ifdeà
ECC128


50 #ifdeà
ECC160


61 #ifdeà
ECC192


72 #ifdeà
ECC224


83 #ifdeà
ECC256


94 #ifdeà
ECC384


105 #ifdeà
ECC521


118 
NULL
, NULL, NULL, NULL, NULL, NULL

	@libtomcrypt/src/pk/ecc/ecc_ansi_x963_export.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


32 
	$ecc_ªsi_x963_expÜt
(
ecc_key
 *
key
, *
out
, *
ou’
)

34 
buf
[
ECC_BUF_SIZE
];

35 
numËn
;

37 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

41 ià(
	`Éc_ecc_is_v®id_idx
(
key
->
idx
) == 0) {

42  
CRYPT_INVALID_ARG
;

44 
numËn
 = 
key
->
dp
->
size
;

46 ià(*
ou’
 < (1 + 2*
numËn
)) {

47 *
ou’
 = 1 + 2*
numËn
;

48  
CRYPT_BUFFER_OVERFLOW
;

52 
out
[0] = 0x04;

55 
	`z”omem
(
buf
, (buf));

56 
	`mp_to_unsigÃd_bš
(
key
->
pubkey
.
x
, 
buf
 + (
numËn
 - 
	`mp_unsigÃd_bš_size
(key->pubkey.x)));

57 
	`XMEMCPY
(
out
+1, 
buf
, 
numËn
);

60 
	`z”omem
(
buf
, (buf));

61 
	`mp_to_unsigÃd_bš
(
key
->
pubkey
.
y
, 
buf
 + (
numËn
 - 
	`mp_unsigÃd_bš_size
(key->pubkey.y)));

62 
	`XMEMCPY
(
out
+1+
numËn
, 
buf
,‚umlen);

64 *
ou’
 = 1 + 2*
numËn
;

65  
CRYPT_OK
;

66 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_ansi_x963_import.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


31 
	$ecc_ªsi_x963_impÜt
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
)

33  
	`ecc_ªsi_x963_impÜt_ex
(
š
, 
šËn
, 
key
, 
NULL
);

34 
	}
}

36 
	$ecc_ªsi_x963_impÜt_ex
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
, 
Éc_ecc_£t_ty³
 *
dp
)

38 
x
, 
”r
;

40 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 ià((
šËn
 & 1) == 0) {

45  
CRYPT_INVALID_ARG
;

49 ià(
	`mp_š™_muÉi
(&
key
->
pubkey
.
x
, &key->pubkey.
y
, &key->pubkey.
z
, &key->
k
, 
NULL
è!ğ
CRYPT_OK
) {

50  
CRYPT_MEM
;

54 ià(
š
[0] != 4 && in[0] != 6 && in[0] != 7) {

55 
”r
 = 
CRYPT_INVALID_PACKET
;

56 
”rÜ
;

60 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
key
->
pubkey
.
x
, (*)
š
+1, (
šËn
-1)>>1)è!ğ
CRYPT_OK
) {

61 
”rÜ
;

64 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
key
->
pubkey
.
y
, (*)
š
+1+((
šËn
-1)>>1), (šËn-1)>>1)è!ğ
CRYPT_OK
) {

65 
”rÜ
;

67 ià((
”r
 = 
	`mp_£t
(
key
->
pubkey
.
z
, 1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

69 ià(
dp
 =ğ
NULL
) {

71 
x
 = 0; 
Éc_ecc_£ts
[x].
size
 != 0; x++) {

72 ià(()
Éc_ecc_£ts
[
x
].
size
 >ğ((
šËn
-1)>>1)) {

76 ià(
Éc_ecc_£ts
[
x
].
size
 == 0) {

77 
”r
 = 
CRYPT_INVALID_PACKET
;

78 
”rÜ
;

81 
key
->
idx
 = 
x
;

82 
key
->
dp
 = &
Éc_ecc_£ts
[
x
];

84 ià(((
šËn
-1)>>1è!ğ(è
dp
->
size
) {

85 
”r
 = 
CRYPT_INVALID_PACKET
;

86 
”rÜ
;

88 
key
->
idx
 = -1;

89 
key
->
dp
 = dp;

91 
key
->
ty³
 = 
PK_PUBLIC
;

94  
CRYPT_OK
;

95 
”rÜ
:

96 
	`mp_ş—r_muÉi
(
key
->
pubkey
.
x
, key->pubkey.
y
, key->pubkey.
z
, key->
k
, 
NULL
);

97  
”r
;

98 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_decrypt_key.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


35 
	$ecc_deüy±_key
(cÚ¡ *
š
, 
šËn
,

36 *
out
, *
ou’
,

37 
ecc_key
 *
key
)

39 *
ecc_sh¬ed
, *
skey
, *
pub_ex±
;

40 
x
, 
y
, 
hashOID
[32];

41 
hash
, 
”r
;

42 
ecc_key
 
pubkey
;

43 
Éc_a¢1_li¡
 
decode
[3];

45 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

51 ià(
key
->
ty³
 !ğ
PK_PRIVATE
) {

52  
CRYPT_PK_NOT_PRIVATE
;

56 
	`LTC_SET_ASN1
(
decode
, 0, 
LTC_ASN1_OBJECT_IDENTIFIER
, 
hashOID
, (hashOID)/(hashOID[0]));

58 ià((
”r
 = 
	`d”_decode_£qu’û
(
š
, 
šËn
, 
decode
, 1)è!ğ
CRYPT_OK
) {

59  
”r
;

62 
hash
 = 
	`fšd_hash_oid
(
hashOID
, 
decode
[0].
size
);

63 ià(
	`hash_is_v®id
(
hash
è!ğ
CRYPT_OK
) {

64  
CRYPT_INVALID_PACKET
;

70 
pub_ex±
 = 
	`XMALLOC
(
ECC_BUF_SIZE
);

71 
ecc_sh¬ed
 = 
	`XMALLOC
(
ECC_BUF_SIZE
);

72 
skey
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

73 ià(
pub_ex±
 =ğ
NULL
 || 
ecc_sh¬ed
 =ğNULL || 
skey
 == NULL) {

74 ià(
pub_ex±
 !ğ
NULL
) {

75 
	`XFREE
(
pub_ex±
);

77 ià(
ecc_sh¬ed
 !ğ
NULL
) {

78 
	`XFREE
(
ecc_sh¬ed
);

80 ià(
skey
 !ğ
NULL
) {

81 
	`XFREE
(
skey
);

83  
CRYPT_MEM
;

85 
	`LTC_SET_ASN1
(
decode
, 1, 
LTC_ASN1_OCTET_STRING
, 
pub_ex±
, 
ECC_BUF_SIZE
);

86 
	`LTC_SET_ASN1
(
decode
, 2, 
LTC_ASN1_OCTET_STRING
, 
skey
, 
MAXBLOCKSIZE
);

89 ià((
”r
 = 
	`d”_decode_£qu’û
(
š
, 
šËn
, 
decode
, 3)è!ğ
CRYPT_OK
) {

90 
LBL_ERR
;

94 ià((
”r
 = 
	`ecc_impÜt
(
decode
[1].
d©a
, decode[1].
size
, &
pubkey
)è!ğ
CRYPT_OK
) {

95 
LBL_ERR
;

99 
x
 = 
ECC_BUF_SIZE
;

100 ià((
”r
 = 
	`ecc_sh¬ed_£ü‘
(
key
, &
pubkey
, 
ecc_sh¬ed
, &
x
)è!ğ
CRYPT_OK
) {

101 
	`ecc_ä“
(&
pubkey
);

102 
LBL_ERR
;

104 
	`ecc_ä“
(&
pubkey
);

106 
y
 = 
	`MIN
(
ECC_BUF_SIZE
, 
MAXBLOCKSIZE
);

107 ià((
”r
 = 
	`hash_memÜy
(
hash
, 
ecc_sh¬ed
, 
x
,ƒcc_sh¬ed, &
y
)è!ğ
CRYPT_OK
) {

108 
LBL_ERR
;

112 ià(
decode
[2].
size
 > 
y
) {

113 
”r
 = 
CRYPT_INVALID_PACKET
;

114 
LBL_ERR
;

118 ià(*
ou’
 < 
decode
[2].
size
) {

119 *
ou’
 = 
decode
[2].
size
;

120 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

121 
LBL_ERR
;

125 
x
 = 0; x < 
decode
[2].
size
; x++) {

126 
out
[
x
] = 
skey
[x] ^ 
ecc_sh¬ed
[x];

128 *
ou’
 = 
x
;

130 
”r
 = 
CRYPT_OK
;

131 
LBL_ERR
:

132 #ifdeà
LTC_CLEAN_STACK


133 
	`z”omem
(
pub_ex±
, 
ECC_BUF_SIZE
);

134 
	`z”omem
(
ecc_sh¬ed
, 
ECC_BUF_SIZE
);

135 
	`z”omem
(
skey
, 
MAXBLOCKSIZE
);

138 
	`XFREE
(
pub_ex±
);

139 
	`XFREE
(
ecc_sh¬ed
);

140 
	`XFREE
(
skey
);

142  
”r
;

143 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_encrypt_key.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


38 
	$ecc_’üy±_key
(cÚ¡ *
š
, 
šËn
,

39 *
out
, *
ou’
,

40 
´ng_¡©e
 *
´ng
, 
w´ng
, 
hash
,

41 
ecc_key
 *
key
)

43 *
pub_ex±
, *
ecc_sh¬ed
, *
skey
;

44 
ecc_key
 
pubkey
;

45 
x
, 
y
, 
pubkeysize
;

46 
”r
;

48 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

49 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

50 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

51 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

54 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

55  
”r
;

58 ià((
”r
 = 
	`hash_is_v®id
(
hash
)è!ğ
CRYPT_OK
) {

59  
”r
;

62 ià(
šËn
 > 
hash_desütÜ
[
hash
].
hashsize
) {

63  
CRYPT_INVALID_HASH
;

67 ià((
”r
 = 
	`ecc_make_key_ex
(
´ng
, 
w´ng
, &
pubkey
, 
key
->
dp
)è!ğ
CRYPT_OK
) {

68  
”r
;

71 
pub_ex±
 = 
	`XMALLOC
(
ECC_BUF_SIZE
);

72 
ecc_sh¬ed
 = 
	`XMALLOC
(
ECC_BUF_SIZE
);

73 
skey
 = 
	`XMALLOC
(
MAXBLOCKSIZE
);

74 ià(
pub_ex±
 =ğ
NULL
 || 
ecc_sh¬ed
 =ğNULL || 
skey
 == NULL) {

75 ià(
pub_ex±
 !ğ
NULL
) {

76 
	`XFREE
(
pub_ex±
);

78 ià(
ecc_sh¬ed
 !ğ
NULL
) {

79 
	`XFREE
(
ecc_sh¬ed
);

81 ià(
skey
 !ğ
NULL
) {

82 
	`XFREE
(
skey
);

84 
	`ecc_ä“
(&
pubkey
);

85  
CRYPT_MEM
;

88 
pubkeysize
 = 
ECC_BUF_SIZE
;

89 ià((
”r
 = 
	`ecc_expÜt
(
pub_ex±
, &
pubkeysize
, 
PK_PUBLIC
, &
pubkey
)è!ğ
CRYPT_OK
) {

90 
	`ecc_ä“
(&
pubkey
);

91 
LBL_ERR
;

95 
x
 = 
ECC_BUF_SIZE
;

96 ià((
”r
 = 
	`ecc_sh¬ed_£ü‘
(&
pubkey
, 
key
, 
ecc_sh¬ed
, &
x
)è!ğ
CRYPT_OK
) {

97 
	`ecc_ä“
(&
pubkey
);

98 
LBL_ERR
;

100 
	`ecc_ä“
(&
pubkey
);

101 
y
 = 
MAXBLOCKSIZE
;

102 ià((
”r
 = 
	`hash_memÜy
(
hash
, 
ecc_sh¬ed
, 
x
, 
skey
, &
y
)è!ğ
CRYPT_OK
) {

103 
LBL_ERR
;

107 
x
 = 0; x < 
šËn
; x++) {

108 
skey
[
x
] ^ğ
š
[x];

111 
”r
 = 
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

112 
LTC_ASN1_OBJECT_IDENTIFIER
, 
hash_desütÜ
[
hash
].
OIDËn
, hash_desütÜ[hash].
OID
,

113 
LTC_ASN1_OCTET_STRING
, 
pubkeysize
, 
pub_ex±
,

114 
LTC_ASN1_OCTET_STRING
, 
šËn
, 
skey
,

115 
LTC_ASN1_EOL
, 0UL, 
NULL
);

117 
LBL_ERR
:

118 #ifdeà
LTC_CLEAN_STACK


120 
	`z”omem
(
pub_ex±
, 
ECC_BUF_SIZE
);

121 
	`z”omem
(
ecc_sh¬ed
, 
ECC_BUF_SIZE
);

122 
	`z”omem
(
skey
, 
MAXBLOCKSIZE
);

125 
	`XFREE
(
skey
);

126 
	`XFREE
(
ecc_sh¬ed
);

127 
	`XFREE
(
pub_ex±
);

129  
”r
;

130 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_export.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


34 
	$ecc_expÜt
(*
out
, *
ou’
, 
ty³
, 
ecc_key
 *
key
)

36 
”r
;

37 
æags
[1];

38 
key_size
;

40 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

45 ià(
key
->
ty³
 !ğ
PK_PRIVATE
 &&ype == PK_PRIVATE) {

46  
CRYPT_PK_TYPE_MISMATCH
;

49 ià(
	`Éc_ecc_is_v®id_idx
(
key
->
idx
) == 0) {

50  
CRYPT_INVALID_ARG
;

54 
key_size
 = 
key
->
dp
->
size
;

56 ià(
ty³
 =ğ
PK_PRIVATE
) {

57 
æags
[0] = 1;

58 
”r
 = 
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

59 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

60 
LTC_ASN1_SHORT_INTEGER
, 1UL, &
key_size
,

61 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
x
,

62 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
y
,

63 
LTC_ASN1_INTEGER
, 1UL, 
key
->
k
,

64 
LTC_ASN1_EOL
, 0UL, 
NULL
);

66 
æags
[0] = 0;

67 
”r
 = 
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

68 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

69 
LTC_ASN1_SHORT_INTEGER
, 1UL, &
key_size
,

70 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
x
,

71 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
y
,

72 
LTC_ASN1_EOL
, 0UL, 
NULL
);

75  
”r
;

76 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_free.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


30 
	$ecc_ä“
(
ecc_key
 *
key
)

32 
	`LTC_ARGCHKVD
(
key
 !ğ
NULL
);

33 
	`mp_ş—r_muÉi
(
key
->
pubkey
.
x
, key->pubkey.
y
, key->pubkey.
z
, key->
k
, 
NULL
);

34 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_get_size.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


31 
	$ecc_g‘_size
(
ecc_key
 *
key
)

33 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

34 ià(
	`Éc_ecc_is_v®id_idx
(
key
->
idx
))

35  
key
->
dp
->
size
;

37  
INT_MAX
;

38 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_import.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


26 
	$is_pošt
(
ecc_key
 *
key
)

28 *
´ime
, *
b
, *
t1
, *
t2
;

29 
”r
;

31 ià((
”r
 = 
	`mp_š™_muÉi
(&
´ime
, &
b
, &
t1
, &
t2
, 
NULL
)è!ğ
CRYPT_OK
) {

32  
”r
;

36 ià((
”r
 = 
	`mp_»ad_¿dix
(
´ime
, 
key
->
dp
->´ime, 16)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

37 ià((
”r
 = 
	`mp_»ad_¿dix
(
b
, 
key
->
dp
->
B
, 16)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

40 ià((
”r
 = 
	`mp_sqr
(
key
->
pubkey
.
y
, 
t1
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

43 ià((
”r
 = 
	`mp_sqr
(
key
->
pubkey
.
x
, 
t2
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

44 ià((
”r
 = 
	`mp_mod
(
t2
, 
´ime
,2)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

45 ià((
”r
 = 
	`mp_mul
(
key
->
pubkey
.
x
, 
t2
,2)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

48 ià((
”r
 = 
	`mp_sub
(
t1
, 
t2
,1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

51 ià((
”r
 = 
	`mp_add
(
t1
, 
key
->
pubkey
.
x
,1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

52 ià((
”r
 = 
	`mp_add
(
t1
, 
key
->
pubkey
.
x
,1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

53 ià((
”r
 = 
	`mp_add
(
t1
, 
key
->
pubkey
.
x
,1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

54 ià((
”r
 = 
	`mp_mod
(
t1
, 
´ime
,1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

55 
	`mp_cmp_d
(
t1
, 0è=ğ
LTC_MP_LT
) {

56 ià((
”r
 = 
	`mp_add
(
t1
, 
´ime
,1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

58 
	`mp_cmp
(
t1
, 
´ime
è!ğ
LTC_MP_LT
) {

59 ià((
”r
 = 
	`mp_sub
(
t1
, 
´ime
,1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

63 ià(
	`mp_cmp
(
t1
, 
b
è!ğ
LTC_MP_EQ
) {

64 
”r
 = 
CRYPT_INVALID_PACKET
;

66 
”r
 = 
CRYPT_OK
;

69 
”rÜ
:

70 
	`mp_ş—r_muÉi
(
´ime
, 
b
, 
t1
, 
t2
, 
NULL
);

71  
”r
;

72 
	}
}

81 
	$ecc_impÜt
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
)

83  
	`ecc_impÜt_ex
(
š
, 
šËn
, 
key
, 
NULL
);

84 
	}
}

94 
	$ecc_impÜt_ex
(cÚ¡ *
š
, 
šËn
, 
ecc_key
 *
key
, cÚ¡ 
Éc_ecc_£t_ty³
 *
dp
)

96 
key_size
;

97 
æags
[1];

98 
”r
;

100 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

101 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

102 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

105 ià(
	`mp_š™_muÉi
(&
key
->
pubkey
.
x
, &key->pubkey.
y
, &key->pubkey.
z
, &key->
k
, 
NULL
è!ğ
CRYPT_OK
) {

106  
CRYPT_MEM
;

110 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

111 
LTC_ASN1_BIT_STRING
, 1UL, &
æags
,

112 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

113 
dÚe
;

117 ià(
æags
[0] == 1) {

119 
key
->
ty³
 = 
PK_PRIVATE
;

120 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

121 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

122 
LTC_ASN1_SHORT_INTEGER
, 1UL, &
key_size
,

123 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
x
,

124 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
y
,

125 
LTC_ASN1_INTEGER
, 1UL, 
key
->
k
,

126 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

127 
dÚe
;

131 
key
->
ty³
 = 
PK_PUBLIC
;

132 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

133 
LTC_ASN1_BIT_STRING
, 1UL, 
æags
,

134 
LTC_ASN1_SHORT_INTEGER
, 1UL, &
key_size
,

135 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
x
,

136 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pubkey
.
y
,

137 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

138 
dÚe
;

142 ià(
dp
 =ğ
NULL
) {

144 
key
->
idx
 = 0; 
Éc_ecc_£ts
[key->idx].
size
 && (îtc_ecc_£ts[key->idx].siz!ğ
key_size
; ++key->idx);

145 ià(
Éc_ecc_£ts
[
key
->
idx
].
size
 == 0) {

146 
”r
 = 
CRYPT_INVALID_PACKET
;

147 
dÚe
;

149 
key
->
dp
 = &
Éc_ecc_£ts
[key->
idx
];

151 
key
->
idx
 = -1;

152 
key
->
dp
 = dp;

155 ià((
”r
 = 
	`mp_£t
(
key
->
pubkey
.
z
, 1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

158 ià((
”r
 = 
	`is_pošt
(
key
)è!ğ
CRYPT_OK
) {

159 
dÚe
;

163  
CRYPT_OK
;

164 
dÚe
:

165 
	`mp_ş—r_muÉi
(
key
->
pubkey
.
x
, key->pubkey.
y
, key->pubkey.
z
, key->
k
, 
NULL
);

166  
”r
;

167 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_make_key.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


34 
	$ecc_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
keysize
, 
ecc_key
 *
key
)

36 
x
, 
”r
;

39 
x
 = 0; (
keysize
 > 
Éc_ecc_£ts
[x].
size
) && (ltc_ecc_sets[x].size != 0); x++);

40 
keysize
 = 
Éc_ecc_£ts
[
x
].
size
;

42 ià(
keysize
 > 
ECC_MAXSIZE
 || 
Éc_ecc_£ts
[
x
].
size
 == 0) {

43  
CRYPT_INVALID_KEYSIZE
;

45 
”r
 = 
	`ecc_make_key_ex
(
´ng
, 
w´ng
, 
key
, &
Éc_ecc_£ts
[
x
]);

46 
key
->
idx
 = 
x
;

47  
”r
;

48 
	}
}

50 
	$ecc_make_key_ex
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
ecc_key
 *
key
, cÚ¡ 
Éc_ecc_£t_ty³
 *
dp
)

52 
”r
;

53 
ecc_pošt
 *
ba£
;

54 *
´ime
;

55 *
buf
;

56 
keysize
;

58 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

59 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

60 
	`LTC_ARGCHK
(
dp
 !ğ
NULL
);

63 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

64  
”r
;

67 
key
->
idx
 = -1;

68 
key
->
dp
 = dp;

69 
keysize
 = 
dp
->
size
;

72 
ba£
 = 
NULL
;

73 
buf
 = 
	`XMALLOC
(
ECC_MAXSIZE
);

74 ià(
buf
 =ğ
NULL
) {

75  
CRYPT_MEM
;

79 ià(
´ng_desütÜ
[
w´ng
].
	`»ad
(
buf
, ()
keysize
, 
´ng
) != ()keysize) {

80 
”r
 = 
CRYPT_ERROR_READPRNG
;

81 
ERR_BUF
;

85 ià((
”r
 = 
	`mp_š™_muÉi
(&
key
->
pubkey
.
x
, &key->pubkey.
y
, &key->pubkey.
z
, &key->
k
, &
´ime
, 
NULL
)è!ğ
CRYPT_OK
) {

86 
ERR_BUF
;

88 
ba£
 = 
	`Éc_ecc_Ãw_pošt
();

89 ià(
ba£
 =ğ
NULL
) {

90 
”r
 = 
CRYPT_MEM
;

91 
”rkey
;

95 ià((
”r
 = 
	`mp_»ad_¿dix
(
´ime
, (*)
key
->
dp
->´ime, 16)è!ğ
CRYPT_OK
è{ 
”rkey
; }

96 ià((
”r
 = 
	`mp_»ad_¿dix
(
ba£
->
x
, (*)
key
->
dp
->
Gx
, 16)è!ğ
CRYPT_OK
è{ 
”rkey
; }

97 ià((
”r
 = 
	`mp_»ad_¿dix
(
ba£
->
y
, (*)
key
->
dp
->
Gy
, 16)è!ğ
CRYPT_OK
è{ 
”rkey
; }

98 ià((
”r
 = 
	`mp_£t
(
ba£
->
z
, 1)è!ğ
CRYPT_OK
è{ 
”rkey
; }

99 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
key
->
k
, (*)
buf
, 
keysize
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

102 ià((
”r
 = 
Éc_mp
.
	`ecc_±mul
(
key
->
k
, 
ba£
, &key->
pubkey
, 
´ime
, 1)è!ğ
CRYPT_OK
è{ 
”rkey
; }

103 
key
->
ty³
 = 
PK_PRIVATE
;

106 
”r
 = 
CRYPT_OK
;

107 
ş—nup
;

108 
”rkey
:

109 
	`mp_ş—r_muÉi
(
key
->
pubkey
.
x
, key->pubkey.
y
, key->pubkey.
z
, key->
k
, 
NULL
);

110 
ş—nup
:

111 
	`Éc_ecc_d–_pošt
(
ba£
);

112 
	`mp_ş—r
(
´ime
);

113 
ERR_BUF
:

114 #ifdeà
LTC_CLEAN_STACK


115 
	`z”omem
(
buf
, 
ECC_MAXSIZE
);

117 
	`XFREE
(
buf
);

118  
”r
;

119 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_shared_secret.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


34 
	$ecc_sh¬ed_£ü‘
(
ecc_key
 *
´iv©e_key
,ƒcc_key *
public_key
,

35 *
out
, *
ou’
)

37 
x
;

38 
ecc_pošt
 *
»suÉ
;

39 *
´ime
;

40 
”r
;

42 
	`LTC_ARGCHK
(
´iv©e_key
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
public_key
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 ià(
´iv©e_key
->
ty³
 !ğ
PK_PRIVATE
) {

49  
CRYPT_PK_NOT_PRIVATE
;

52 ià(
	`Éc_ecc_is_v®id_idx
(
´iv©e_key
->
idx
è=ğ0 ||†tc_ecc_is_v®id_idx(
public_key
->idx) == 0) {

53  
CRYPT_INVALID_ARG
;

56 ià(
	`XSTRCMP
(
´iv©e_key
->
dp
->
Çme
, 
public_key
->dp->name) != 0) {

57  
CRYPT_PK_TYPE_MISMATCH
;

61 
»suÉ
 = 
	`Éc_ecc_Ãw_pošt
();

62 ià(
»suÉ
 =ğ
NULL
) {

63  
CRYPT_MEM
;

66 ià((
”r
 = 
	`mp_š™
(&
´ime
)è!ğ
CRYPT_OK
) {

67 
	`Éc_ecc_d–_pošt
(
»suÉ
);

68  
”r
;

71 ià((
”r
 = 
	`mp_»ad_¿dix
(
´ime
, (*)
´iv©e_key
->
dp
->´ime, 16)è!ğ
CRYPT_OK
è{ 
dÚe
; }

72 ià((
”r
 = 
Éc_mp
.
	`ecc_±mul
(
´iv©e_key
->
k
, &
public_key
->
pubkey
, 
»suÉ
, 
´ime
, 1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

74 
x
 = ()
	`mp_unsigÃd_bš_size
(
´ime
);

75 ià(*
ou’
 < 
x
) {

76 *
ou’
 = 
x
;

77 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

78 
dÚe
;

80 
	`z”omem
(
out
, 
x
);

81 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
»suÉ
->
x
, 
out
 + (x - 
	`mp_unsigÃd_bš_size
ÔesuÉ->x)))è!ğ
CRYPT_OK
è{ 
dÚe
; }

83 
”r
 = 
CRYPT_OK
;

84 *
ou’
 = 
x
;

85 
dÚe
:

86 
	`mp_ş—r
(
´ime
);

87 
	`Éc_ecc_d–_pošt
(
»suÉ
);

88  
”r
;

89 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_sign_hash.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


37 
	$ecc_sign_hash
(cÚ¡ *
š
, 
šËn
,

38 *
out
, *
ou’
,

39 
´ng_¡©e
 *
´ng
, 
w´ng
, 
ecc_key
 *
key
)

41 
ecc_key
 
pubkey
;

42 *
r
, *
s
, *
e
, *
p
;

43 
”r
;

45 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

51 ià(
key
->
ty³
 !ğ
PK_PRIVATE
) {

52  
CRYPT_PK_NOT_PRIVATE
;

56 ià(
	`Éc_ecc_is_v®id_idx
(
key
->
idx
) != 1) {

57  
CRYPT_PK_INVALID_TYPE
;

60 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

61  
”r
;

66 ià((
”r
 = 
	`mp_š™_muÉi
(&
r
, &
s
, &
p
, &
e
, 
NULL
)è!ğ
CRYPT_OK
) {

67  
”r
;

69 ià((
”r
 = 
	`mp_»ad_¿dix
(
p
, (*)
key
->
dp
->
Üd”
, 16)è!ğ
CRYPT_OK
è{ 
”ºokey
; }

70 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
e
, (*)
š
, ()
šËn
)è!ğ
CRYPT_OK
è{ 
”ºokey
; }

74 ià((
”r
 = 
	`ecc_make_key_ex
(
´ng
, 
w´ng
, &
pubkey
, 
key
->
dp
)è!ğ
CRYPT_OK
) {

75 
”ºokey
;

79 ià((
”r
 = 
	`mp_mod
(
pubkey
.pubkey.
x
, 
p
, 
r
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

81 ià(
	`mp_isz”o
(
r
è=ğ
LTC_MP_YES
) {

82 
	`ecc_ä“
(&
pubkey
);

85 ià((
”r
 = 
	`mp_švmod
(
pubkey
.
k
, 
p
,…ubkey.k)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

86 ià((
”r
 = 
	`mp_mulmod
(
key
->
k
, 
r
, 
p
, 
s
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

87 ià((
”r
 = 
	`mp_add
(
e
, 
s
, s)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

88 ià((
”r
 = 
	`mp_mod
(
s
, 
p
, s)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

89 ià((
”r
 = 
	`mp_mulmod
(
s
, 
pubkey
.
k
, 
p
, s)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

90 
	`ecc_ä“
(&
pubkey
);

91 ià(
	`mp_isz”o
(
s
è=ğ
LTC_MP_NO
) {

98 
”r
 = 
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

99 
LTC_ASN1_INTEGER
, 1UL, 
r
,

100 
LTC_ASN1_INTEGER
, 1UL, 
s
,

101 
LTC_ASN1_EOL
, 0UL, 
NULL
);

102 
”ºokey
;

103 
”rÜ
:

104 
	`ecc_ä“
(&
pubkey
);

105 
”ºokey
:

106 
	`mp_ş—r_muÉi
(
r
, 
s
, 
p
, 
e
, 
NULL
);

107  
”r
;

108 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_sizes.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


26 
	$ecc_sizes
(*
low
, *
high
)

28 
i
;

29 
	`LTC_ARGCHKVD
(
low
 !ğ
NULL
);

30 
	`LTC_ARGCHKVD
(
high
 !ğ
NULL
);

32 *
low
 = 
INT_MAX
;

33 *
high
 = 0;

34 
i
 = 0; 
Éc_ecc_£ts
[i].
size
 != 0; i++) {

35 ià(
Éc_ecc_£ts
[
i
].
size
 < *
low
) {

36 *
low
 = 
Éc_ecc_£ts
[
i
].
size
;

38 ià(
Éc_ecc_£ts
[
i
].
size
 > *
high
) {

39 *
high
 = 
Éc_ecc_£ts
[
i
].
size
;

42 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_test.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


30 
	$ecc_‹¡
()

32 *
modulus
, *
Üd”
;

33 
ecc_pošt
 *
G
, *
GG
;

34 
i
, 
”r
, 
´im®™y
;

36 ià((
”r
 = 
	`mp_š™_muÉi
(&
modulus
, &
Üd”
, 
NULL
)è!ğ
CRYPT_OK
) {

37  
”r
;

40 
G
 = 
	`Éc_ecc_Ãw_pošt
();

41 
GG
 = 
	`Éc_ecc_Ãw_pošt
();

42 ià(
G
 =ğ
NULL
 || 
GG
 == NULL) {

43 
	`mp_ş—r_muÉi
(
modulus
, 
Üd”
, 
NULL
);

44 
	`Éc_ecc_d–_pošt
(
G
);

45 
	`Éc_ecc_d–_pošt
(
GG
);

46  
CRYPT_MEM
;

49 
i
 = 0; 
Éc_ecc_£ts
[i].
size
; i++) {

51 
	`´štf
("Te¡šg %d\n", 
Éc_ecc_£ts
[
i
].
size
);

53 ià((
”r
 = 
	`mp_»ad_¿dix
(
modulus
, (*)
Éc_ecc_£ts
[
i
].
´ime
, 16)è!ğ
CRYPT_OK
è{ 
dÚe
; }

54 ià((
”r
 = 
	`mp_»ad_¿dix
(
Üd”
, (*)
Éc_ecc_£ts
[
i
].Üd”, 16)è!ğ
CRYPT_OK
è{ 
dÚe
; }

57 ià((
”r
 = 
	`mp_´ime_is_´ime
(
modulus
, 8, &
´im®™y
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

58 ià(
´im®™y
 == 0) {

59 
”r
 = 
CRYPT_FAIL_TESTVECTOR
;

60 
dÚe
;

64 ià((
”r
 = 
	`mp_´ime_is_´ime
(
Üd”
, 8, &
´im®™y
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

65 ià(
´im®™y
 == 0) {

66 
”r
 = 
CRYPT_FAIL_TESTVECTOR
;

67 
dÚe
;

70 ià((
”r
 = 
	`mp_»ad_¿dix
(
G
->
x
, (*)
Éc_ecc_£ts
[
i
].
Gx
, 16)è!ğ
CRYPT_OK
è{ 
dÚe
; }

71 ià((
”r
 = 
	`mp_»ad_¿dix
(
G
->
y
, (*)
Éc_ecc_£ts
[
i
].
Gy
, 16)è!ğ
CRYPT_OK
è{ 
dÚe
; }

72 
	`mp_£t
(
G
->
z
, 1);

75 ià((
”r
 = 
	`mp_add_d
(
Üd”
, 1, ord”)è!ğ
CRYPT_OK
è{ 
dÚe
; }

76 ià((
”r
 = 
Éc_mp
.
	`ecc_±mul
(
Üd”
, 
G
, 
GG
, 
modulus
, 1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

77 ià(
	`mp_cmp
(
G
->
x
, 
GG
->xè!ğ
LTC_MP_EQ
 || mp_cmp(G->
y
, GG->y) != LTC_MP_EQ) {

78 
”r
 = 
CRYPT_FAIL_TESTVECTOR
;

79 
dÚe
;

82 
”r
 = 
CRYPT_OK
;

83 
dÚe
:

84 
	`Éc_ecc_d–_pošt
(
GG
);

85 
	`Éc_ecc_d–_pošt
(
G
);

86 
	`mp_ş—r_muÉi
(
Üd”
, 
modulus
, 
NULL
);

87  
”r
;

88 
	}
}

	@libtomcrypt/src/pk/ecc/ecc_verify_hash.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


46 
	$ecc_v”ify_hash
(cÚ¡ *
sig
, 
sigËn
,

47 cÚ¡ *
hash
, 
hashËn
,

48 *
¡©
, 
ecc_key
 *
key
)

50 
ecc_pošt
 *
mG
, *
mQ
;

51 *
r
, *
s
, *
v
, *
w
, *
u1
, *
u2
, *
e
, *
p
, *
m
;

52 *
mp
;

53 
”r
;

55 
	`LTC_ARGCHK
(
sig
 !ğ
NULL
);

56 
	`LTC_ARGCHK
(
hash
 !ğ
NULL
);

57 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

58 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

61 *
¡©
 = 0;

62 
mp
 = 
NULL
;

65 ià(
	`Éc_ecc_is_v®id_idx
(
key
->
idx
) != 1) {

66  
CRYPT_PK_INVALID_TYPE
;

70 ià((
”r
 = 
	`mp_š™_muÉi
(&
r
, &
s
, &
v
, &
w
, &
u1
, &
u2
, &
p
, &
e
, &
m
, 
NULL
)è!ğ
CRYPT_OK
) {

71  
CRYPT_MEM
;

75 
mG
 = 
	`Éc_ecc_Ãw_pošt
();

76 
mQ
 = 
	`Éc_ecc_Ãw_pošt
();

77 ià(
mQ
 =ğ
NULL
 || 
mG
 == NULL) {

78 
”r
 = 
CRYPT_MEM
;

79 
”rÜ
;

83 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
sig
, 
sigËn
,

84 
LTC_ASN1_INTEGER
, 1UL, 
r
,

85 
LTC_ASN1_INTEGER
, 1UL, 
s
,

86 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

87 
”rÜ
;

91 ià((
”r
 = 
	`mp_»ad_¿dix
(
p
, (*)
key
->
dp
->
Üd”
, 16)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

94 ià((
”r
 = 
	`mp_»ad_¿dix
(
m
, (*)
key
->
dp
->
´ime
, 16)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

97 ià(
	`mp_isz”o
(
r
è|| mp_isz”o(
s
è|| 
	`mp_cmp
Ô, 
p
è!ğ
LTC_MP_LT
 || mp_cmp(s,…) != LTC_MP_LT) {

98 
”r
 = 
CRYPT_INVALID_PACKET
;

99 
”rÜ
;

103 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
e
, (*)
hash
, ()
hashËn
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

106 ià((
”r
 = 
	`mp_švmod
(
s
, 
p
, 
w
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

109 ià((
”r
 = 
	`mp_mulmod
(
e
, 
w
, 
p
, 
u1
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

112 ià((
”r
 = 
	`mp_mulmod
(
r
, 
w
, 
p
, 
u2
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

115 ià((
”r
 = 
	`mp_»ad_¿dix
(
mG
->
x
, (*)
key
->
dp
->
Gx
, 16)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

116 ià((
”r
 = 
	`mp_»ad_¿dix
(
mG
->
y
, (*)
key
->
dp
->
Gy
, 16)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

117 ià((
”r
 = 
	`mp_£t
(
mG
->
z
, 1)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

119 ià((
”r
 = 
	`mp_cİy
(
key
->
pubkey
.
x
, 
mQ
->x)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

120 ià((
”r
 = 
	`mp_cİy
(
key
->
pubkey
.
y
, 
mQ
->y)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

121 ià((
”r
 = 
	`mp_cİy
(
key
->
pubkey
.
z
, 
mQ
->z)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

124 ià(
Éc_mp
.
ecc_mul2add
 =ğ
NULL
) {

125 ià((
”r
 = 
Éc_mp
.
	`ecc_±mul
(
u1
, 
mG
, mG, 
m
, 0)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

126 ià((
”r
 = 
Éc_mp
.
	`ecc_±mul
(
u2
, 
mQ
, mQ, 
m
, 0)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

129 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
m
, &
mp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

132 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
mQ
, 
mG
, mG, 
m
, 
mp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

135 ià((
”r
 = 
Éc_mp
.
	`ecc_m­
(
mG
, 
m
, 
mp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

138 ià((
”r
 = 
Éc_mp
.
	`ecc_mul2add
(
mG
, 
u1
, 
mQ
, 
u2
, mG, 
m
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

142 ià((
”r
 = 
	`mp_mod
(
mG
->
x
, 
p
, 
v
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

145 ià(
	`mp_cmp
(
v
, 
r
è=ğ
LTC_MP_EQ
) {

146 *
¡©
 = 1;

150 
”r
 = 
CRYPT_OK
;

151 
”rÜ
:

152 
	`Éc_ecc_d–_pošt
(
mG
);

153 
	`Éc_ecc_d–_pošt
(
mQ
);

154 
	`mp_ş—r_muÉi
(
r
, 
s
, 
v
, 
w
, 
u1
, 
u2
, 
p
, 
e
, 
m
, 
NULL
);

155 ià(
mp
 !ğ
NULL
) {

156 
	`mp_mÚtgom”y_ä“
(
mp
);

158  
”r
;

159 
	}
}

	@libtomcrypt/src/pk/ecc/ltc_ecc_is_valid_idx.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


30 
	$Éc_ecc_is_v®id_idx
(
n
)

32 
x
;

34 
x
 = 0; 
Éc_ecc_£ts
[x].
size
 != 0; x++);

36 ià((
n
 >ğ-1è|| (À< 
x
)) {

40 
	}
}

	@libtomcrypt/src/pk/ecc/ltc_ecc_map.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


33 
	$Éc_ecc_m­
(
ecc_pošt
 *
P
, *
modulus
, *
mp
)

35 *
t1
, *
t2
;

36 
”r
;

38 
	`LTC_ARGCHK
(
P
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
mp
 !ğ
NULL
);

42 ià((
”r
 = 
	`mp_š™_muÉi
(&
t1
, &
t2
, 
NULL
)è!ğ
CRYPT_OK
) {

43  
CRYPT_MEM
;

47 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
P
->
z
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

50 ià((
”r
 = 
	`mp_švmod
(
P
->
z
, 
modulus
, 
t1
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

53 ià((
”r
 = 
	`mp_sqr
(
t1
, 
t2
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

54 ià((
”r
 = 
	`mp_mod
(
t2
, 
modulus
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

55 ià((
”r
 = 
	`mp_mul
(
t1
, 
t2
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

56 ià((
”r
 = 
	`mp_mod
(
t1
, 
modulus
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

59 ià((
”r
 = 
	`mp_mul
(
P
->
x
, 
t2
, P->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

60 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
P
->
x
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

61 ià((
”r
 = 
	`mp_mul
(
P
->
y
, 
t1
, P->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

62 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
P
->
y
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

63 ià((
”r
 = 
	`mp_£t
(
P
->
z
, 1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

65 
”r
 = 
CRYPT_OK
;

66 
dÚe
:

67 
	`mp_ş—r_muÉi
(
t1
, 
t2
, 
NULL
);

68  
”r
;

69 
	}
}

	@libtomcrypt/src/pk/ecc/ltc_ecc_mul2add.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


26 #ifdeà
LTC_ECC_SHAMIR


37 
	$Éc_ecc_mul2add
(
ecc_pošt
 *
A
, *
kA
,

38 
ecc_pošt
 *
B
, *
kB
,

39 
ecc_pošt
 *
C
,

40 *
modulus
)

42 
ecc_pošt
 *
´ecomp
[16];

43 
b™bufA
, 
b™bufB
, 
ËnA
, 
ËnB
, 
Ën
, 
x
, 
y
, 
nA
, 
nB
, 
nibbË
;

44 *
tA
, *
tB
;

45 
”r
, 
fœ¡
;

46 *
mp
, *
mu
;

49 
	`LTC_ARGCHK
(
A
 !ğ
NULL
);

50 
	`LTC_ARGCHK
(
B
 !ğ
NULL
);

51 
	`LTC_ARGCHK
(
C
 !ğ
NULL
);

52 
	`LTC_ARGCHK
(
kA
 !ğ
NULL
);

53 
	`LTC_ARGCHK
(
kB
 !ğ
NULL
);

54 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

57 
tA
 = 
	`XCALLOC
(1, 
ECC_BUF_SIZE
);

58 ià(
tA
 =ğ
NULL
) {

59  
CRYPT_MEM
;

61 
tB
 = 
	`XCALLOC
(1, 
ECC_BUF_SIZE
);

62 ià(
tB
 =ğ
NULL
) {

63 
	`XFREE
(
tA
);

64  
CRYPT_MEM
;

68 
ËnA
 = 
	`mp_unsigÃd_bš_size
(
kA
);

69 
ËnB
 = 
	`mp_unsigÃd_bš_size
(
kB
);

70 
Ën
 = 
	`MAX
(
ËnA
, 
ËnB
);

73 ià((
ËnA
 > 
ECC_BUF_SIZE
è|| (
ËnB
 > ECC_BUF_SIZE)) {

74 
”r
 = 
CRYPT_INVALID_ARG
;

75 
ERR_T
;

79 
	`mp_to_unsigÃd_bš
(
kA
, (
Ën
 - 
ËnA
è+ 
tA
);

82 
	`mp_to_unsigÃd_bš
(
kB
, (
Ën
 - 
ËnB
è+ 
tB
);

85 
x
 = 0; x < 16; x++) {

86 
´ecomp
[
x
] = 
	`Éc_ecc_Ãw_pošt
();

87 ià(
´ecomp
[
x
] =ğ
NULL
) {

88 
y
 = 0; y < 
x
; ++y) {

89 
	`Éc_ecc_d–_pošt
(
´ecomp
[
y
]);

91 
”r
 = 
CRYPT_MEM
;

92 
ERR_T
;

97 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
) {

98 
ERR_P
;

100 ià((
”r
 = 
	`mp_š™
(&
mu
)è!ğ
CRYPT_OK
) {

101 
ERR_MP
;

103 ià((
”r
 = 
	`mp_mÚtgom”y_nÜm®iz©iÚ
(
mu
, 
modulus
)è!ğ
CRYPT_OK
) {

104 
ERR_MU
;

108 ià((
”r
 = 
	`mp_mulmod
(
A
->
x
, 
mu
, 
modulus
, 
´ecomp
[1]->x)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

109 ià((
”r
 = 
	`mp_mulmod
(
A
->
y
, 
mu
, 
modulus
, 
´ecomp
[1]->y)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

110 ià((
”r
 = 
	`mp_mulmod
(
A
->
z
, 
mu
, 
modulus
, 
´ecomp
[1]->z)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

112 ià((
”r
 = 
	`mp_mulmod
(
B
->
x
, 
mu
, 
modulus
, 
´ecomp
[1<<2]->x)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

113 ià((
”r
 = 
	`mp_mulmod
(
B
->
y
, 
mu
, 
modulus
, 
´ecomp
[1<<2]->y)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

114 ià((
”r
 = 
	`mp_mulmod
(
B
->
z
, 
mu
, 
modulus
, 
´ecomp
[1<<2]->z)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

117 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
´ecomp
[1],…»comp[2], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

118 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
´ecomp
[1],…»comp[2],…»comp[3], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

121 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
´ecomp
[1<<2],…»comp[2<<2], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

122 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
´ecomp
[1<<2],…»comp[2<<2],…»comp[3<<2], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

125 
x
 = 1; x < 4; x++) {

126 
y
 = 1; y < 4; y++) {

127 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
´ecomp
[
x
],…»comp[(
y
<<2)],…»comp[x+(y<<2)], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

131 
nibbË
 = 3;

132 
fœ¡
 = 1;

133 
b™bufA
 = 
tA
[0];

134 
b™bufB
 = 
tB
[0];

137 
x
 = -1;; ) {

139 ià(++
nibbË
 == 4) {

140 ++
x
; ià(x =ğ
Ën
) ;

141 
b™bufA
 = 
tA
[
x
];

142 
b™bufB
 = 
tB
[
x
];

143 
nibbË
 = 0;

147 
nA
 = (
b™bufA
 >> 6) & 0x03;

148 
nB
 = (
b™bufB
 >> 6) & 0x03;

149 
b™bufA
 = (bitbufA << 2) & 0xFF;

150 
b™bufB
 = (bitbufB << 2) & 0xFF;

153 ià((
nA
 =ğ0è&& (
nB
 =ğ0è&& (
fœ¡
 == 1)) {

158 ià(
fœ¡
 == 0) {

160 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
C
, C, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

161 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
C
, C, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

165 ià((
nA
 !ğ0è|| (
nB
 != 0)) {

166 ià(
fœ¡
 == 1) {

168 
fœ¡
 = 0;

169 ià((
”r
 = 
	`mp_cİy
(
´ecomp
[
nA
 + (
nB
<<2)]->
x
, 
C
->x)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

170 ià((
”r
 = 
	`mp_cİy
(
´ecomp
[
nA
 + (
nB
<<2)]->
y
, 
C
->y)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

171 ià((
”r
 = 
	`mp_cİy
(
´ecomp
[
nA
 + (
nB
<<2)]->
z
, 
C
->z)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

174 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
C
, 
´ecomp
[
nA
 + (
nB
<<2)], C, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
ERR_MU
; }

180 
”r
 = 
	`Éc_ecc_m­
(
C
, 
modulus
, 
mp
);

183 
ERR_MU
:

184 
	`mp_ş—r
(
mu
);

185 
ERR_MP
:

186 
	`mp_mÚtgom”y_ä“
(
mp
);

187 
ERR_P
:

188 
x
 = 0; x < 16; x++) {

189 
	`Éc_ecc_d–_pošt
(
´ecomp
[
x
]);

191 
ERR_T
:

192 #ifdeà
LTC_CLEAN_STACK


193 
	`z”omem
(
tA
, 
ECC_BUF_SIZE
);

194 
	`z”omem
(
tB
, 
ECC_BUF_SIZE
);

196 
	`XFREE
(
tA
);

197 
	`XFREE
(
tB
);

199  
”r
;

200 
	}
}

	@libtomcrypt/src/pk/ecc/ltc_ecc_mulmod.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


25 #iâdeà
LTC_ECC_TIMING_RESISTANT


28 
	#WINSIZE
 4

	)

39 
	$Éc_ecc_mulmod
(*
k
, 
ecc_pošt
 *
G
,ƒcc_pošˆ*
R
, *
modulus
, 
m­
)

41 
ecc_pošt
 *
tG
, *
M
[8];

42 
i
, 
j
, 
”r
;

43 *
mu
, *
mp
;

44 
buf
;

45 
fœ¡
, 
b™buf
, 
b™ıy
, 
b™út
, 
mode
, 
digidx
;

47 
	`LTC_ARGCHK
(
k
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
G
 !ğ
NULL
);

49 
	`LTC_ARGCHK
(
R
 !ğ
NULL
);

50 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

53 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
) {

54  
”r
;

56 ià((
”r
 = 
	`mp_š™
(&
mu
)è!ğ
CRYPT_OK
) {

57 
	`mp_mÚtgom”y_ä“
(
mp
);

58  
”r
;

60 ià((
”r
 = 
	`mp_mÚtgom”y_nÜm®iz©iÚ
(
mu
, 
modulus
)è!ğ
CRYPT_OK
) {

61 
	`mp_mÚtgom”y_ä“
(
mp
);

62 
	`mp_ş—r
(
mu
);

63  
”r
;

67 
i
 = 0; i < 8; i++) {

68 
M
[
i
] = 
	`Éc_ecc_Ãw_pošt
();

69 ià(
M
[
i
] =ğ
NULL
) {

70 
j
 = 0; j < 
i
; j++) {

71 
	`Éc_ecc_d–_pošt
(
M
[
j
]);

73 
	`mp_mÚtgom”y_ä“
(
mp
);

74 
	`mp_ş—r
(
mu
);

75  
CRYPT_MEM
;

80 
tG
 = 
	`Éc_ecc_Ãw_pošt
();

81 ià(
tG
 =ğ
NULL
è{ 
”r
 = 
CRYPT_MEM
; 
dÚe
; }

84 ià(
	`mp_cmp_d
(
mu
, 1è=ğ
LTC_MP_EQ
) {

85 ià((
”r
 = 
	`mp_cİy
(
G
->
x
, 
tG
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

86 ià((
”r
 = 
	`mp_cİy
(
G
->
y
, 
tG
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

87 ià((
”r
 = 
	`mp_cİy
(
G
->
z
, 
tG
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

89 ià((
”r
 = 
	`mp_mulmod
(
G
->
x
, 
mu
, 
modulus
, 
tG
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

90 ià((
”r
 = 
	`mp_mulmod
(
G
->
y
, 
mu
, 
modulus
, 
tG
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

91 ià((
”r
 = 
	`mp_mulmod
(
G
->
z
, 
mu
, 
modulus
, 
tG
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

93 
	`mp_ş—r
(
mu
);

94 
mu
 = 
NULL
;

98 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
tG
, 
M
[0], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

99 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
M
[0], M[0], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

100 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
M
[0], M[0], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

103 
j
 = 9; j < 16; j++) {

104 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
M
[
j
-9], 
tG
, M[j-8], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

108 
mode
 = 0;

109 
b™út
 = 1;

110 
buf
 = 0;

111 
digidx
 = 
	`mp_g‘_dig™_couÁ
(
k
) - 1;

112 
b™ıy
 = 
b™buf
 = 0;

113 
fœ¡
 = 1;

118 ià(--
b™út
 == 0) {

119 ià(
digidx
 == -1) {

122 
buf
 = 
	`mp_g‘_dig™
(
k
, 
digidx
);

123 
b™út
 = (è
Éc_mp
.
b™s_³r_dig™
;

124 --
digidx
;

128 
i
 = (
buf
 >> (
Éc_mp
.
b™s_³r_dig™
 - 1)) & 1;

129 
buf
 <<= 1;

132 ià(
mode
 =ğ0 && 
i
 == 0) {

137 ià(
mode
 =ğ1 && 
i
 == 0) {

138 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
R
, R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

143 
b™buf
 |ğ(
i
 << (
WINSIZE
 - ++
b™ıy
));

144 
mode
 = 2;

146 ià(
b™ıy
 =ğ
WINSIZE
) {

148 ià(
fœ¡
 == 1) {

150 ià((
”r
 = 
	`mp_cİy
(
M
[
b™buf
-8]->
x
, 
R
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

151 ià((
”r
 = 
	`mp_cİy
(
M
[
b™buf
-8]->
y
, 
R
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

152 ià((
”r
 = 
	`mp_cİy
(
M
[
b™buf
-8]->
z
, 
R
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

153 
fœ¡
 = 0;

158 
j
 = 0; j < 
WINSIZE
; j++) {

159 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
R
, R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

163 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
R
, 
M
[
b™buf
-8], R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

166 
b™ıy
 = 
b™buf
 = 0;

167 
mode
 = 1;

172 ià(
mode
 =ğ2 && 
b™ıy
 > 0) {

174 
j
 = 0; j < 
b™ıy
; j++) {

176 ià(
fœ¡
 == 0) {

177 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
R
, R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

180 
b™buf
 <<= 1;

181 ià((
b™buf
 & (1 << 
WINSIZE
)) != 0) {

182 ià(
fœ¡
 == 1){

184 ià((
”r
 = 
	`mp_cİy
(
tG
->
x
, 
R
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

185 ià((
”r
 = 
	`mp_cİy
(
tG
->
y
, 
R
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

186 ià((
”r
 = 
	`mp_cİy
(
tG
->
z
, 
R
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

187 
fœ¡
 = 0;

190 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
R
, 
tG
, R, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

197 ià(
m­
) {

198 
”r
 = 
	`Éc_ecc_m­
(
R
, 
modulus
, 
mp
);

200 
”r
 = 
CRYPT_OK
;

202 
dÚe
:

203 ià(
mu
 !ğ
NULL
) {

204 
	`mp_ş—r
(
mu
);

206 
	`mp_mÚtgom”y_ä“
(
mp
);

207 
	`Éc_ecc_d–_pošt
(
tG
);

208 
i
 = 0; i < 8; i++) {

209 
	`Éc_ecc_d–_pošt
(
M
[
i
]);

211  
”r
;

212 
	}
}

216 #undeà
WINSIZE


	@libtomcrypt/src/pk/ecc/ltc_ecc_mulmod_timing.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


26 #ifdeà
LTC_ECC_TIMING_RESISTANT


37 
	$Éc_ecc_mulmod
(*
k
, 
ecc_pošt
 *
G
,ƒcc_pošˆ*
R
, *
modulus
, 
m­
)

39 
ecc_pošt
 *
tG
, *
M
[3];

40 
i
, 
j
, 
”r
;

41 *
mu
, *
mp
;

42 
buf
;

43 
fœ¡
, 
b™buf
, 
b™ıy
, 
b™út
, 
mode
, 
digidx
;

45 
	`LTC_ARGCHK
(
k
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
G
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
R
 !ğ
NULL
);

48 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

51 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
)è!ğ
CRYPT_OK
) {

52  
”r
;

54 ià((
”r
 = 
	`mp_š™
(&
mu
)è!ğ
CRYPT_OK
) {

55 
	`mp_mÚtgom”y_ä“
(
mp
);

56  
”r
;

58 ià((
”r
 = 
	`mp_mÚtgom”y_nÜm®iz©iÚ
(
mu
, 
modulus
)è!ğ
CRYPT_OK
) {

59 
	`mp_ş—r
(
mu
);

60 
	`mp_mÚtgom”y_ä“
(
mp
);

61  
”r
;

65 
i
 = 0; i < 3; i++) {

66 
M
[
i
] = 
	`Éc_ecc_Ãw_pošt
();

67 ià(
M
[
i
] =ğ
NULL
) {

68 
j
 = 0; j < 
i
; j++) {

69 
	`Éc_ecc_d–_pošt
(
M
[
j
]);

71 
	`mp_ş—r
(
mu
);

72 
	`mp_mÚtgom”y_ä“
(
mp
);

73  
CRYPT_MEM
;

78 
tG
 = 
	`Éc_ecc_Ãw_pošt
();

79 ià(
tG
 =ğ
NULL
è{ 
”r
 = 
CRYPT_MEM
; 
dÚe
; }

82 ià((
”r
 = 
	`mp_mulmod
(
G
->
x
, 
mu
, 
modulus
, 
tG
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

83 ià((
”r
 = 
	`mp_mulmod
(
G
->
y
, 
mu
, 
modulus
, 
tG
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

84 ià((
”r
 = 
	`mp_mulmod
(
G
->
z
, 
mu
, 
modulus
, 
tG
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

85 
	`mp_ş—r
(
mu
);

86 
mu
 = 
NULL
;

90 ià((
”r
 = 
	`mp_cİy
(
tG
->
x
, 
M
[0]->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

91 ià((
”r
 = 
	`mp_cİy
(
tG
->
y
, 
M
[0]->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

92 ià((
”r
 = 
	`mp_cİy
(
tG
->
z
, 
M
[0]->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

94 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
tG
, 
M
[1], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

97 
mode
 = 0;

98 
b™út
 = 1;

99 
buf
 = 0;

100 
digidx
 = 
	`mp_g‘_dig™_couÁ
(
k
) - 1;

101 
b™ıy
 = 
b™buf
 = 0;

102 
fœ¡
 = 1;

107 ià(--
b™út
 == 0) {

108 ià(
digidx
 == -1) {

111 
buf
 = 
	`mp_g‘_dig™
(
k
, 
digidx
);

112 
b™út
 = (è
MP_DIGIT_BIT
;

113 --
digidx
;

117 
i
 = (
buf
 >> (
MP_DIGIT_BIT
 - 1)) & 1;

118 
buf
 <<= 1;

120 ià(
mode
 =ğ0 && 
i
 == 0) {

122 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
M
[0], M[1], M[2], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

123 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
M
[1], M[2], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

127 ià(
mode
 =ğ0 && 
i
 == 1) {

128 
mode
 = 1;

130 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
M
[0], M[1], M[2], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

131 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
M
[1], M[2], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

135 ià((
”r
 = 
Éc_mp
.
	`ecc_±add
(
M
[0], M[1], M[
i
^1], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

136 ià((
”r
 = 
Éc_mp
.
	`ecc_±dbl
(
M
[
i
], M[i], 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

140 ià((
”r
 = 
	`mp_cİy
(
M
[0]->
x
, 
R
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

141 ià((
”r
 = 
	`mp_cİy
(
M
[0]->
y
, 
R
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

142 ià((
”r
 = 
	`mp_cİy
(
M
[0]->
z
, 
R
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

145 ià(
m­
) {

146 
”r
 = 
	`Éc_ecc_m­
(
R
, 
modulus
, 
mp
);

148 
”r
 = 
CRYPT_OK
;

150 
dÚe
:

151 ià(
mu
 !ğ
NULL
) {

152 
	`mp_ş—r
(
mu
);

154 
	`mp_mÚtgom”y_ä“
(
mp
);

155 
	`Éc_ecc_d–_pošt
(
tG
);

156 
i
 = 0; i < 3; i++) {

157 
	`Éc_ecc_d–_pošt
(
M
[
i
]);

159  
”r
;

160 
	}
}

	@libtomcrypt/src/pk/ecc/ltc_ecc_points.c

17 
	~"tomüy±.h
"

24 #ifdeà
MECC


30 
ecc_pošt
 *
	$Éc_ecc_Ãw_pošt
()

32 
ecc_pošt
 *
p
;

33 
p
 = 
	`XCALLOC
(1, (*p));

34 ià(
p
 =ğ
NULL
) {

35  
NULL
;

37 ià(
	`mp_š™_muÉi
(&
p
->
x
, &p->
y
, &p->
z
, 
NULL
è!ğ
CRYPT_OK
) {

38 
	`XFREE
(
p
);

39  
NULL
;

41  
p
;

42 
	}
}

47 
	$Éc_ecc_d–_pošt
(
ecc_pošt
 *
p
)

50 ià(
p
 !ğ
NULL
) {

51 
	`mp_ş—r_muÉi
(
p
->
x
,…->
y
,…->
z
, 
NULL
);

52 
	`XFREE
(
p
);

54 
	}
}

	@libtomcrypt/src/pk/ecc/ltc_ecc_projective_add_point.c

17 
	~"tomüy±.h
"

24 #ià
defšed
(
MECC
è&& (!defšed(
MECC_ACCEL
è|| defšed(
LTM_DESC
))

35 
	$Éc_ecc_´ojeùive_add_pošt
(
ecc_pošt
 *
P
,ƒcc_pošˆ*
Q
,ƒcc_pošˆ*
R
, *
modulus
, *
mp
)

37 *
t1
, *
t2
, *
x
, *
y
, *
z
;

38 
”r
;

40 
	`LTC_ARGCHK
(
P
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
Q
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
R
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
mp
 !ğ
NULL
);

46 ià((
”r
 = 
	`mp_š™_muÉi
(&
t1
, &
t2
, &
x
, &
y
, &
z
, 
NULL
)è!ğ
CRYPT_OK
) {

47  
”r
;

51 ià((
”r
 = 
	`mp_sub
(
modulus
, 
Q
->
y
, 
t1
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

53 iàĞ(
	`mp_cmp
(
P
->
x
, 
Q
->xè=ğ
LTC_MP_EQ
) &&

54 (
Q
->
z
 !ğ
NULL
 && 
	`mp_cmp
(
P
->z, Q->zè=ğ
LTC_MP_EQ
) &&

55 (
	`mp_cmp
(
P
->
y
, 
Q
->yè=ğ
LTC_MP_EQ
 || mp_cmp(P->y, 
t1
) == LTC_MP_EQ)) {

56 
	`mp_ş—r_muÉi
(
t1
, 
t2
, 
x
, 
y
, 
z
, 
NULL
);

57  
	`Éc_ecc_´ojeùive_dbl_pošt
(
P
, 
R
, 
modulus
, 
mp
);

60 ià((
”r
 = 
	`mp_cİy
(
P
->
x
, x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

61 ià((
”r
 = 
	`mp_cİy
(
P
->
y
, y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

62 ià((
”r
 = 
	`mp_cİy
(
P
->
z
, z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

65 ià(
Q
->
z
 !ğ
NULL
) {

67 ià((
”r
 = 
	`mp_sqr
(
Q
->
z
, 
t1
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

68 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

70 ià((
”r
 = 
	`mp_mul
(
t1
, 
x
, x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

71 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
x
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

73 ià((
”r
 = 
	`mp_mul
(
Q
->
z
, 
t1
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

74 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

76 ià((
”r
 = 
	`mp_mul
(
t1
, 
y
, y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

77 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
y
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

81 ià((
”r
 = 
	`mp_sqr
(
z
, 
t1
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

82 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

84 ià((
”r
 = 
	`mp_mul
(
Q
->
x
, 
t1
, 
t2
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

85 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t2
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

87 ià((
”r
 = 
	`mp_mul
(
z
, 
t1
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

88 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

90 ià((
”r
 = 
	`mp_mul
(
Q
->
y
, 
t1
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

91 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

94 ià((
”r
 = 
	`mp_sub
(
y
, 
t1
, y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

95 ià(
	`mp_cmp_d
(
y
, 0è=ğ
LTC_MP_LT
) {

96 ià((
”r
 = 
	`mp_add
(
y
, 
modulus
, y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

99 ià((
”r
 = 
	`mp_add
(
t1
,1,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

100 ià(
	`mp_cmp
(
t1
, 
modulus
è!ğ
LTC_MP_LT
) {

101 ià((
”r
 = 
	`mp_sub
(
t1
, 
modulus
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

104 ià((
”r
 = 
	`mp_add
(
t1
, 
y
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

105 ià(
	`mp_cmp
(
t1
, 
modulus
è!ğ
LTC_MP_LT
) {

106 ià((
”r
 = 
	`mp_sub
(
t1
, 
modulus
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

109 ià((
”r
 = 
	`mp_sub
(
x
, 
t2
, x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

110 ià(
	`mp_cmp_d
(
x
, 0è=ğ
LTC_MP_LT
) {

111 ià((
”r
 = 
	`mp_add
(
x
, 
modulus
, x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

114 ià((
”r
 = 
	`mp_add
(
t2
,2,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

115 ià(
	`mp_cmp
(
t2
, 
modulus
è!ğ
LTC_MP_LT
) {

116 ià((
”r
 = 
	`mp_sub
(
t2
, 
modulus
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

119 ià((
”r
 = 
	`mp_add
(
t2
, 
x
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

120 ià(
	`mp_cmp
(
t2
, 
modulus
è!ğ
LTC_MP_LT
) {

121 ià((
”r
 = 
	`mp_sub
(
t2
, 
modulus
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

125 ià(
Q
->
z
 !ğ
NULL
) {

127 ià((
”r
 = 
	`mp_mul
(
z
, 
Q
->z, z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

128 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
z
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

132 ià((
”r
 = 
	`mp_mul
(
z
, 
x
, z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

133 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
z
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

136 ià((
”r
 = 
	`mp_mul
(
t1
, 
x
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

137 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

139 ià((
”r
 = 
	`mp_sqr
(
x
, x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

140 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
x
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

142 ià((
”r
 = 
	`mp_mul
(
t2
, 
x
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

143 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t2
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

145 ià((
”r
 = 
	`mp_mul
(
t1
, 
x
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

146 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

149 ià((
”r
 = 
	`mp_sqr
(
y
, 
x
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

150 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
x
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

152 ià((
”r
 = 
	`mp_sub
(
x
, 
t2
, x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

153 ià(
	`mp_cmp_d
(
x
, 0è=ğ
LTC_MP_LT
) {

154 ià((
”r
 = 
	`mp_add
(
x
, 
modulus
, x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

158 ià((
”r
 = 
	`mp_sub
(
t2
, 
x
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

159 ià(
	`mp_cmp_d
(
t2
, 0è=ğ
LTC_MP_LT
) {

160 ià((
”r
 = 
	`mp_add
(
t2
, 
modulus
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

163 ià((
”r
 = 
	`mp_sub
(
t2
, 
x
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

164 ià(
	`mp_cmp_d
(
t2
, 0è=ğ
LTC_MP_LT
) {

165 ià((
”r
 = 
	`mp_add
(
t2
, 
modulus
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

168 ià((
”r
 = 
	`mp_mul
(
t2
, 
y
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

169 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t2
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

171 ià((
”r
 = 
	`mp_sub
(
t2
, 
t1
, 
y
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

172 ià(
	`mp_cmp_d
(
y
, 0è=ğ
LTC_MP_LT
) {

173 ià((
”r
 = 
	`mp_add
(
y
, 
modulus
, y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

176 ià(
	`mp_isodd
(
y
)) {

177 ià((
”r
 = 
	`mp_add
(
y
, 
modulus
, y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

179 ià((
”r
 = 
	`mp_div_2
(
y
, y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

181 ià((
”r
 = 
	`mp_cİy
(
x
, 
R
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

182 ià((
”r
 = 
	`mp_cİy
(
y
, 
R
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

183 ià((
”r
 = 
	`mp_cİy
(
z
, 
R
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

185 
”r
 = 
CRYPT_OK
;

186 
dÚe
:

187 
	`mp_ş—r_muÉi
(
t1
, 
t2
, 
x
, 
y
, 
z
, 
NULL
);

188  
”r
;

189 
	}
}

	@libtomcrypt/src/pk/ecc/ltc_ecc_projective_dbl_point.c

17 
	~"tomüy±.h
"

24 #ià
defšed
(
MECC
è&& (!defšed(
MECC_ACCEL
è|| defšed(
LTM_DESC
))

34 
	$Éc_ecc_´ojeùive_dbl_pošt
(
ecc_pošt
 *
P
,ƒcc_pošˆ*
R
, *
modulus
, *
mp
)

36 *
t1
, *
t2
;

37 
”r
;

39 
	`LTC_ARGCHK
(
P
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
R
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
modulus
 !ğ
NULL
);

42 
	`LTC_ARGCHK
(
mp
 !ğ
NULL
);

44 ià((
”r
 = 
	`mp_š™_muÉi
(&
t1
, &
t2
, 
NULL
)è!ğ
CRYPT_OK
) {

45  
”r
;

48 ià(
P
 !ğ
R
) {

49 ià((
”r
 = 
	`mp_cİy
(
P
->
x
, 
R
->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

50 ià((
”r
 = 
	`mp_cİy
(
P
->
y
, 
R
->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

51 ià((
”r
 = 
	`mp_cİy
(
P
->
z
, 
R
->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

55 ià((
”r
 = 
	`mp_sqr
(
R
->
z
, 
t1
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

56 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t1
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

58 ià((
”r
 = 
	`mp_mul
(
R
->
z
, R->
y
, R->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

59 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
R
->
z
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

61 ià((
”r
 = 
	`mp_add
(
R
->
z
, R->z, R->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

62 ià(
	`mp_cmp
(
R
->
z
, 
modulus
è!ğ
LTC_MP_LT
) {

63 ià((
”r
 = 
	`mp_sub
(
R
->
z
, 
modulus
, R->z)è!ğ
CRYPT_OK
è{ 
dÚe
; }

67 ià((
”r
 = 
	`mp_sub
(
R
->
x
, 
t1
, 
t2
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

68 ià(
	`mp_cmp_d
(
t2
, 0è=ğ
LTC_MP_LT
) {

69 ià((
”r
 = 
	`mp_add
(
t2
, 
modulus
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

72 ià((
”r
 = 
	`mp_add
(
t1
, 
R
->
x
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

73 ià(
	`mp_cmp
(
t1
, 
modulus
è!ğ
LTC_MP_LT
) {

74 ià((
”r
 = 
	`mp_sub
(
t1
, 
modulus
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

77 ià((
”r
 = 
	`mp_mul
(
t1
, 
t2
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

78 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t2
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

80 ià((
”r
 = 
	`mp_add
(
t2
,2, 
t1
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

81 ià(
	`mp_cmp
(
t1
, 
modulus
è!ğ
LTC_MP_LT
) {

82 ià((
”r
 = 
	`mp_sub
(
t1
, 
modulus
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

85 ià((
”r
 = 
	`mp_add
(
t1
, 
t2
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

86 ià(
	`mp_cmp
(
t1
, 
modulus
è!ğ
LTC_MP_LT
) {

87 ià((
”r
 = 
	`mp_sub
(
t1
, 
modulus
,1)è!ğ
CRYPT_OK
è{ 
dÚe
; }

91 ià((
”r
 = 
	`mp_add
(
R
->
y
, R->y, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

92 ià(
	`mp_cmp
(
R
->
y
, 
modulus
è!ğ
LTC_MP_LT
) {

93 ià((
”r
 = 
	`mp_sub
(
R
->
y
, 
modulus
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

96 ià((
”r
 = 
	`mp_sqr
(
R
->
y
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

97 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
R
->
y
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

99 ià((
”r
 = 
	`mp_sqr
(
R
->
y
, 
t2
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

100 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
t2
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

102 ià(
	`mp_isodd
(
t2
)) {

103 ià((
”r
 = 
	`mp_add
(
t2
, 
modulus
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

105 ià((
”r
 = 
	`mp_div_2
(
t2
,2)è!ğ
CRYPT_OK
è{ 
dÚe
; }

107 ià((
”r
 = 
	`mp_mul
(
R
->
y
, R->
x
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

108 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
R
->
y
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

111 ià((
”r
 = 
	`mp_sqr
(
t1
, 
R
->
x
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

112 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
R
->
x
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

114 ià((
”r
 = 
	`mp_sub
(
R
->
x
, R->
y
, R->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

115 ià(
	`mp_cmp_d
(
R
->
x
, 0è=ğ
LTC_MP_LT
) {

116 ià((
”r
 = 
	`mp_add
(
R
->
x
, 
modulus
, R->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

119 ià((
”r
 = 
	`mp_sub
(
R
->
x
, R->
y
, R->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

120 ià(
	`mp_cmp_d
(
R
->
x
, 0è=ğ
LTC_MP_LT
) {

121 ià((
”r
 = 
	`mp_add
(
R
->
x
, 
modulus
, R->x)è!ğ
CRYPT_OK
è{ 
dÚe
; }

125 ià((
”r
 = 
	`mp_sub
(
R
->
y
, R->
x
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

126 ià(
	`mp_cmp_d
(
R
->
y
, 0è=ğ
LTC_MP_LT
) {

127 ià((
”r
 = 
	`mp_add
(
R
->
y
, 
modulus
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

130 ià((
”r
 = 
	`mp_mul
(
R
->
y
, 
t1
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

131 ià((
”r
 = 
	`mp_mÚtgom”y_»duû
(
R
->
y
, 
modulus
, 
mp
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

133 ià((
”r
 = 
	`mp_sub
(
R
->
y
, 
t2
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

134 ià(
	`mp_cmp_d
(
R
->
y
, 0è=ğ
LTC_MP_LT
) {

135 ià((
”r
 = 
	`mp_add
(
R
->
y
, 
modulus
, R->y)è!ğ
CRYPT_OK
è{ 
dÚe
; }

138 
”r
 = 
CRYPT_OK
;

139 
dÚe
:

140 
	`mp_ş—r_muÉi
(
t1
, 
t2
, 
NULL
);

141  
”r
;

142 
	}
}

	@libtomcrypt/src/pk/katja/katja_decrypt_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MKAT


33 
	$k©ja_deüy±_key
(cÚ¡ *
š
, 
šËn
,

34 *
out
, *
ou’
,

35 cÚ¡ *
Í¬am
, 
Í¬amËn
,

36 
hash_idx
, *
¡©
,

37 
k©ja_key
 *
key
)

39 
modulus_b™Ën
, 
modulus_by‹Ën
, 
x
;

40 
”r
;

41 *
tmp
;

43 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

49 *
¡©
 = 0;

52 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

53  
”r
;

57 
modulus_b™Ën
 = 
	`mp_couÁ_b™s
Ğ(
key
->
N
));

60 
modulus_b™Ën
 = ((modulus_bitlen << 1) / 3);

63 
modulus_b™Ën
 -= (modulus_bitlen & 7) + 8;

66 
modulus_by‹Ën
 = 
	`mp_unsigÃd_bš_size
Ğ(
key
->
N
));

67 ià(
modulus_by‹Ën
 !ğ
šËn
) {

68  
CRYPT_INVALID_PACKET
;

72 
tmp
 = 
	`XMALLOC
(
šËn
);

73 ià(
tmp
 =ğ
NULL
) {

74  
CRYPT_MEM
;

78 
x
 = 
šËn
;

79 ià((
”r
 = 
	`k©ja_ex±mod
(
š
, 
šËn
, 
tmp
, &
x
, 
PK_PRIVATE
, 
key
)è!ğ
CRYPT_OK
) {

80 
	`XFREE
(
tmp
);

81  
”r
;

85 
x
 = 0; x < (
modulus_b™Ën
 >> 3); x++) {

86 
tmp
[
x
] =mp[x+(
modulus_by‹Ën
-(
modulus_b™Ën
>>3))];

90 
”r
 = 
	`pkcs_1_ß•_decode
(
tmp
, 
x
, 
Í¬am
, 
Í¬amËn
, 
modulus_b™Ën
, 
hash_idx
,

91 
out
, 
ou’
, 
¡©
);

93 
	`XFREE
(
tmp
);

94  
”r
;

95 
	}
}

	@libtomcrypt/src/pk/katja/katja_encrypt_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MKAT


34 
	$k©ja_’üy±_key
(cÚ¡ *
š
, 
šËn
,

35 *
out
, *
ou’
,

36 cÚ¡ *
Í¬am
, 
Í¬amËn
,

37 
´ng_¡©e
 *
´ng
, 
´ng_idx
, 
hash_idx
, 
k©ja_key
 *
key
)

39 
modulus_b™Ën
, 
modulus_by‹Ën
, 
x
;

40 
”r
;

42 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

48 ià((
”r
 = 
	`´ng_is_v®id
(
´ng_idx
)è!ğ
CRYPT_OK
) {

49  
”r
;

51 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

52  
”r
;

56 
modulus_b™Ën
 = 
	`mp_couÁ_b™s
((
key
->
N
));

59 
modulus_b™Ën
 = ((modulus_bitlen << 1) / 3);

62 
modulus_b™Ën
 -= (modulus_bitlen & 7) + 8;

65 
modulus_by‹Ën
 = 
	`mp_unsigÃd_bš_size
((
key
->
N
));

66 ià(
modulus_by‹Ën
 > *
ou’
) {

67 *
ou’
 = 
modulus_by‹Ën
;

68  
CRYPT_BUFFER_OVERFLOW
;

72 
x
 = *
ou’
;

73 ià((
”r
 = 
	`pkcs_1_ß•_’code
(
š
, 
šËn
, 
Í¬am
,

74 
Í¬amËn
, 
modulus_b™Ën
, 
´ng
, 
´ng_idx
, 
hash_idx
,

75 
out
, &
x
)è!ğ
CRYPT_OK
) {

76  
”r
;

80  
	`k©ja_ex±mod
(
out
, 
x
, out, 
ou’
, 
PK_PUBLIC
, 
key
);

81 
	}
}

	@libtomcrypt/src/pk/katja/katja_export.c

11 
	~"tomüy±.h
"

18 #ifdeà
MKAT


28 
	$k©ja_expÜt
(*
out
, *
ou’
, 
ty³
, 
k©ja_key
 *
key
)

30 
”r
;

31 
z”o
=0;

33 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

38 ià(!(
key
->
ty³
 =ğ
PK_PRIVATE
) && (type == PK_PRIVATE)) {

39  
CRYPT_PK_INVALID_TYPE
;

42 ià(
ty³
 =ğ
PK_PRIVATE
) {

47 ià((
”r
 = 
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

48 
LTC_ASN1_SHORT_INTEGER
, 1UL, &
z”o
,

49 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

50 
LTC_ASN1_INTEGER
, 1UL, 
key
->
d
,

51 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

52 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

53 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dP
,

54 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dQ
,

55 
LTC_ASN1_INTEGER
, 1UL, 
key
->
qP
,

56 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pq
,

57 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

58  
”r
;

62  
CRYPT_OK
;

65  
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

66 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

67 
LTC_ASN1_EOL
, 0UL, 
NULL
);

69 
	}
}

	@libtomcrypt/src/pk/katja/katja_exptmod.c

11 
	~"tomüy±.h
"

18 #ifdeà
MKAT


30 
	$k©ja_ex±mod
(cÚ¡ *
š
, 
šËn
,

31 *
out
, *
ou’
, 
which
,

32 
k©ja_key
 *
key
)

34 *
tmp
, *
tm·
, *
tmpb
;

35 
x
;

36 
”r
;

38 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 ià(
which
 =ğ
PK_PRIVATE
 && (
key
->
ty³
 != PK_PRIVATE)) {

45  
CRYPT_PK_NOT_PRIVATE
;

49 ià(
which
 !ğ
PK_PRIVATE
 && which !ğ
PK_PUBLIC
) {

50  
CRYPT_PK_INVALID_TYPE
;

54 ià((
”r
 = 
	`mp_š™_muÉi
(&
tmp
, &
tm·
, &
tmpb
, 
NULL
)è!ğ
CRYPT_OK
) { ƒrr; }

55 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
tmp
, (*)
š
, ()
šËn
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

58 ià(
	`mp_cmp
(
key
->
N
, 
tmp
è=ğ
LTC_MP_LT
) {

59 
”r
 = 
CRYPT_PK_INVALID_SIZE
;

60 
dÚe
;

64 ià(
which
 =ğ
PK_PRIVATE
) {

66 ià((
”r
 = 
	`mp_ex±mod
(
tmp
, 
key
->
dP
, key->
p
, 
tm·
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

69 ià((
”r
 = 
	`mp_ex±mod
(
tmp
, 
key
->
dQ
, key->
q
, 
tmpb
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

72 ià((
”r
 = 
	`mp_sub
(
tm·
, 
tmpb
, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

73 ià((
”r
 = 
	`mp_mulmod
(
tmp
, 
key
->
qP
, key->
p
,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

76 ià((
”r
 = 
	`mp_mul
(
tmp
, 
key
->
q
,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

77 ià((
”r
 = 
	`mp_add
(
tmp
, 
tmpb
,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

80 ià((
”r
 = 
	`mp_ex±mod
(
tmp
, 
key
->
N
, key->N,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

84 
x
 = ()
	`mp_unsigÃd_bš_size
(
key
->
N
);

85 ià(
x
 > *
ou’
) {

86 *
ou’
 = 
x
;

87 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

88 
dÚe
;

92 ià(
	`mp_unsigÃd_bš_size
(
tmp
è> mp_unsigÃd_bš_size(
key
->
N
)) {

93 
”r
 = 
CRYPT_ERROR
;

94 
dÚe
;

96 *
ou’
 = 
x
;

99 
	`z”omem
(
out
, 
x
);

100 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
tmp
, 
out
+(
x
-
	`mp_unsigÃd_bš_size
Ñmp)))è!ğ
CRYPT_OK
è{ 
”rÜ
; }

103 
”r
 = 
CRYPT_OK
;

104 
dÚe
;

105 
”rÜ
:

106 
dÚe
:

107 
	`mp_ş—r_muÉi
(
tmp
, 
tm·
, 
tmpb
, 
NULL
);

108  
”r
;

109 
	}
}

	@libtomcrypt/src/pk/katja/katja_free.c

11 
	~"tomüy±.h
"

18 #ifdeà
MKAT


24 
	$k©ja_ä“
(
k©ja_key
 *
key
)

26 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

27 
	`mp_ş—r_muÉi
Ğ
key
->
d
, key->
N
, key->
dQ
, key->
dP
,

28 
key
->
qP
, key->
p
, key->
q
, key->
pq
, 
NULL
);

29 
	}
}

	@libtomcrypt/src/pk/katja/katja_import.c

11 
	~"tomüy±.h
"

18 #ifdeà
MKAT


27 
	$k©ja_impÜt
(cÚ¡ *
š
, 
šËn
, 
k©ja_key
 *
key
)

29 
”r
;

30 *
z”o
;

32 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

37 ià((
”r
 = 
	`mp_š™_muÉi
(&
z”o
, &
key
->
d
, &key->
N
, &key->
dQ
,

38 &
key
->
dP
, &key->
qP
, &key->
p
, &key->
q
, &key->
pq
, 
NULL
)è!ğ
CRYPT_OK
) {

39  
”r
;

42 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

43 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

44 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

45 
LBL_ERR
;

48 ià(
	`mp_cmp_d
(
key
->
N
, 0è=ğ
LTC_MP_EQ
) {

50 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

51 
LTC_ASN1_INTEGER
, 1UL, 
z”o
,

52 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

53 
LTC_ASN1_INTEGER
, 1UL, 
key
->
d
,

54 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

55 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

56 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dP
,

57 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dQ
,

58 
LTC_ASN1_INTEGER
, 1UL, 
key
->
qP
,

59 
LTC_ASN1_INTEGER
, 1UL, 
key
->
pq
,

60 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

61 
LBL_ERR
;

63 
key
->
ty³
 = 
PK_PRIVATE
;

66 
key
->
ty³
 = 
PK_PUBLIC
;

68 
	`mp_ş—r
(
z”o
);

69  
CRYPT_OK
;

70 
LBL_ERR
:

71 
	`mp_ş—r_muÉi
(
z”o
, 
key
->
d
, key->
N
, key->
dQ
, key->
dP
,

72 
key
->
qP
, key->
p
, key->
q
, key->
pq
, 
NULL
);

73  
”r
;

74 
	}
}

	@libtomcrypt/src/pk/katja/katja_make_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MKAT


28 
	$k©ja_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
size
, 
k©ja_key
 *
key
)

30 *
p
, *
q
, *
tmp1
, *
tmp2
;

31 
”r
;

33 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

34 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

36 ià((
size
 < (
MIN_KAT_SIZE
/8)è|| (siz> (
MAX_KAT_SIZE
/8))) {

37  
CRYPT_INVALID_KEYSIZE
;

40 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

41  
”r
;

44 ià((
”r
 = 
	`mp_š™_muÉi
(&
p
, &
q
, &
tmp1
, &
tmp2
, 
NULL
)è!ğ
CRYPT_OK
) {

45  
”r
;

49 
size
 = (((size << 3) / 3) + 7) >> 3;

52 ià((
”r
 = 
	`¿nd_´ime
(
q
, -
size
, 
´ng
, 
w´ng
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

53 ià((
”r
 = 
	`mp_sub_d
(
q
, 1, 
tmp1
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

57 ià((
”r
 = 
	`¿nd_´ime
(
p
, 
size
+1, 
´ng
, 
w´ng
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

58 ià((
”r
 = 
	`mp_gcd
(
p
, 
tmp1
, 
tmp2
)è!ğ
CRYPT_OK
è{ 
dÚe
; }

59 } 
	`mp_cmp_d
(
tmp2
, 1è!ğ
LTC_MP_EQ
);

62 ià((
”r
 = 
	`mp_š™_muÉi
(&
key
->
d
, &key->
N
, &key->
dQ
, &key->
dP
,

63 &
key
->
qP
, &key->
p
, &key->
q
, &key->
pq
, 
NULL
)è!ğ
CRYPT_OK
) {

64 
”rÜ
;

68 ià((
”r
 = 
	`mp_cİy
Ğ
p
, 
key
->p)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

69 ià((
”r
 = 
	`mp_cİy
Ğ
q
, 
key
->q)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

70 ià((
”r
 = 
	`mp_mul
(
key
->
p
, key->
q
, key->
pq
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

71 ià((
”r
 = 
	`mp_mul
(
key
->
pq
, key->
p
, key->
N
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

72 ià((
”r
 = 
	`mp_sub_d
Ğ
p
, 1, 
tmp1
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

73 ià((
”r
 = 
	`mp_sub_d
Ğ
q
, 1, 
tmp2
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

74 ià((
”r
 = 
	`mp_lcm
(
tmp1
, 
tmp2
, 
key
->
d
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

75 ià((
”r
 = 
	`mp_švmod
Ğ
key
->
N
, key->
d
, key->d)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

79 ià((
”r
 = 
	`mp_mod
Ğ
key
->
d
, 
tmp1
, key->
dP
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

80 ià((
”r
 = 
	`mp_mod
Ğ
key
->
d
, 
tmp2
, key->
dQ
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

81 ià((
”r
 = 
	`mp_švmod
Ğ
q
, 
p
, 
key
->
qP
)è!ğ
CRYPT_OK
è{ 
”rÜ2
; }

84 
key
->
ty³
 = 
PK_PRIVATE
;

87 
”r
 = 
CRYPT_OK
;

88 
dÚe
;

89 
”rÜ2
:

90 
	`mp_ş—r_muÉi
Ğ
key
->
d
, key->
N
, key->
dQ
, key->
dP
, key->
qP
, key->
p
, key->
q
, key->
pq
, 
NULL
);

91 
”rÜ
:

92 
dÚe
:

93 
	`mp_ş—r_muÉi
Ğ
tmp2
, 
tmp1
, 
p
, 
q
, 
NULL
);

94  
”r
;

95 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_i2osp.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


31 
	$pkcs_1_i2o¥
(*
n
, 
modulus_Ën
, *
out
)

33 
size
;

35 
size
 = 
	`mp_unsigÃd_bš_size
(
n
);

37 ià(
size
 > 
modulus_Ën
) {

38  
CRYPT_BUFFER_OVERFLOW
;

42 
	`z”omem
(
out
, 
modulus_Ën
);

43  
	`mp_to_unsigÃd_bš
(
n
, 
out
+(
modulus_Ën
-
size
));

44 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_mgf1.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


29 
	$pkcs_1_mgf1
(
hash_idx
,

30 cÚ¡ *
£ed
, 
£edËn
,

31 *
mask
, 
maskËn
)

33 
hL’
, 
x
;

34 
ulÚg32
 
couÁ”
;

35 
”r
;

36 
hash_¡©e
 *
md
;

37 *
buf
;

39 
	`LTC_ARGCHK
(
£ed
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
mask
 !ğ
NULL
);

43 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

44  
”r
;

48 
hL’
 = 
hash_desütÜ
[
hash_idx
].
hashsize
;

51 
md
 = 
	`XMALLOC
((
hash_¡©e
));

52 
buf
 = 
	`XMALLOC
(
hL’
);

53 ià(
md
 =ğ
NULL
 || 
buf
 == NULL) {

54 ià(
md
 !ğ
NULL
) {

55 
	`XFREE
(
md
);

57 ià(
buf
 !ğ
NULL
) {

58 
	`XFREE
(
buf
);

60  
CRYPT_MEM
;

64 
couÁ”
 = 0;

66 
maskËn
 > 0) {

68 
	`STORE32H
(
couÁ”
, 
buf
);

69 ++
couÁ”
;

72 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`š™
(
md
)è!ğ
CRYPT_OK
) {

73 
LBL_ERR
;

75 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(
md
, 
£ed
, 
£edËn
)è!ğ
CRYPT_OK
) {

76 
LBL_ERR
;

78 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(
md
, 
buf
, 4)è!ğ
CRYPT_OK
) {

79 
LBL_ERR
;

81 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`dÚe
(
md
, 
buf
)è!ğ
CRYPT_OK
) {

82 
LBL_ERR
;

86 
x
 = 0; x < 
hL’
 && 
maskËn
 > 0; x++, masklen--) {

87 *
mask
++ = 
buf
[
x
];

91 
”r
 = 
CRYPT_OK
;

92 
LBL_ERR
:

93 #ifdeà
LTC_CLEAN_STACK


94 
	`z”omem
(
buf
, 
hL’
);

95 
	`z”omem
(
md
, (
hash_¡©e
));

98 
	`XFREE
(
buf
);

99 
	`XFREE
(
md
);

101  
”r
;

102 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_oaep_decode.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


33 
	$pkcs_1_ß•_decode
(cÚ¡ *
msg
, 
msgËn
,

34 cÚ¡ *
Í¬am
, 
Í¬amËn
,

35 
modulus_b™Ën
, 
hash_idx
,

36 *
out
, *
ou’
,

37 *
»s
)

39 *
DB
, *
£ed
, *
mask
;

40 
hL’
, 
x
, 
y
, 
modulus_Ën
;

41 
”r
;

43 
	`LTC_ARGCHK
(
msg
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
»s
 !ğ
NULL
);

49 *
»s
 = 0;

52 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

53  
”r
;

55 
hL’
 = 
hash_desütÜ
[
hash_idx
].
hashsize
;

56 
modulus_Ën
 = (
modulus_b™Ën
 >> 3) + (modulus_bitlen & 7 ? 1 : 0);

59 ià((2*
hL’
 >ğ(
modulus_Ën
 - 2)è|| (
msgËn
 != modulus_len)) {

60  
CRYPT_PK_INVALID_SIZE
;

64 
DB
 = 
	`XMALLOC
(
modulus_Ën
);

65 
mask
 = 
	`XMALLOC
(
modulus_Ën
);

66 
£ed
 = 
	`XMALLOC
(
hL’
);

67 ià(
DB
 =ğ
NULL
 || 
mask
 =ğNULL || 
£ed
 == NULL) {

68 ià(
DB
 !ğ
NULL
) {

69 
	`XFREE
(
DB
);

71 ià(
mask
 !ğ
NULL
) {

72 
	`XFREE
(
mask
);

74 ià(
£ed
 !ğ
NULL
) {

75 
	`XFREE
(
£ed
);

77  
CRYPT_MEM
;

89 ià(
msg
[0] != 0x00) {

90 
”r
 = 
CRYPT_OK
;

91 
LBL_ERR
;

95 
x
 = 1;

96 
	`XMEMCPY
(
£ed
, 
msg
 + 
x
, 
hL’
);

97 
x
 +ğ
hL’
;

100 
	`XMEMCPY
(
DB
, 
msg
 + 
x
, 
modulus_Ën
 - 
hL’
 - 1);

101 
x
 +ğ
modulus_Ën
 - 
hL’
 - 1;

104 ià((
”r
 = 
	`pkcs_1_mgf1
(
hash_idx
, 
DB
, 
modulus_Ën
 - 
hL’
 - 1, 
mask
, hL’)è!ğ
CRYPT_OK
) {

105 
LBL_ERR
;

109 
y
 = 0; y < 
hL’
; y++) {

110 
£ed
[
y
] ^ğ
mask
[y];

114 ià((
”r
 = 
	`pkcs_1_mgf1
(
hash_idx
, 
£ed
, 
hL’
, 
mask
, 
modulus_Ën
 - hL’ - 1)è!ğ
CRYPT_OK
) {

115 
LBL_ERR
;

119 
y
 = 0; y < (
modulus_Ën
 - 
hL’
 - 1); y++) {

120 
DB
[
y
] ^ğ
mask
[y];

126 
x
 = 
modulus_Ën
;

127 ià(
Í¬am
 !ğ
NULL
) {

128 ià((
”r
 = 
	`hash_memÜy
(
hash_idx
, 
Í¬am
, 
Í¬amËn
, 
£ed
, &
x
)è!ğ
CRYPT_OK
) {

129 
LBL_ERR
;

133 ià((
”r
 = 
	`hash_memÜy
(
hash_idx
, 
DB
, 0, 
£ed
, &
x
)è!ğ
CRYPT_OK
) {

134 
LBL_ERR
;

139 ià(
	`XMEMCMP
(
£ed
, 
DB
, 
hL’
) != 0) {

140 
”r
 = 
CRYPT_OK
;

141 
LBL_ERR
;

145 
x
 = 
hL’
; x < (
modulus_Ën
 - hL’ - 1è&& 
DB
[x] == 0x00; x++) {

150 ià(
x
 =ğ(
modulus_Ën
 - 
hL’
 - 1è|| 
DB
[x] != 0x01) {

151 
”r
 = 
CRYPT_INVALID_PACKET
;

152 
LBL_ERR
;

156 ià((
modulus_Ën
 - 
hL’
 - 1 - ++
x
è> *
ou’
) {

157 *
ou’
 = 
modulus_Ën
 - 
hL’
 - 1 - 
x
;

158 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

159 
LBL_ERR
;

163 *
ou’
 = 
modulus_Ën
 - 
hL’
 - 1 - 
x
;

164 
	`XMEMCPY
(
out
, 
DB
 + 
x
, 
modulus_Ën
 - 
hL’
 - 1 - x);

165 
x
 +ğ
modulus_Ën
 - 
hL’
 - 1;

168 *
»s
 = 1;

170 
”r
 = 
CRYPT_OK
;

171 
LBL_ERR
:

172 #ifdeà
LTC_CLEAN_STACK


173 
	`z”omem
(
DB
, 
modulus_Ën
);

174 
	`z”omem
(
£ed
, 
hL’
);

175 
	`z”omem
(
mask
, 
modulus_Ën
);

178 
	`XFREE
(
£ed
);

179 
	`XFREE
(
mask
);

180 
	`XFREE
(
DB
);

182  
”r
;

183 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_oaep_encode.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


34 
	$pkcs_1_ß•_’code
(cÚ¡ *
msg
, 
msgËn
,

35 cÚ¡ *
Í¬am
, 
Í¬amËn
,

36 
modulus_b™Ën
, 
´ng_¡©e
 *
´ng
,

37 
´ng_idx
, 
hash_idx
,

38 *
out
, *
ou’
)

40 *
DB
, *
£ed
, *
mask
;

41 
hL’
, 
x
, 
y
, 
modulus_Ën
;

42 
”r
;

44 
	`LTC_ARGCHK
(
msg
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

49 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

50  
”r
;

54 ià((
”r
 = 
	`´ng_is_v®id
(
´ng_idx
)è!ğ
CRYPT_OK
) {

55  
”r
;

58 
hL’
 = 
hash_desütÜ
[
hash_idx
].
hashsize
;

59 
modulus_Ën
 = (
modulus_b™Ën
 >> 3) + (modulus_bitlen & 7 ? 1 : 0);

62 ià((2*
hL’
 >ğ(
modulus_Ën
 - 2)è|| (
msgËn
 > (modulus_len - 2*hLen - 2))) {

63  
CRYPT_PK_INVALID_SIZE
;

67 
DB
 = 
	`XMALLOC
(
modulus_Ën
);

68 
mask
 = 
	`XMALLOC
(
modulus_Ën
);

69 
£ed
 = 
	`XMALLOC
(
hL’
);

70 ià(
DB
 =ğ
NULL
 || 
mask
 =ğNULL || 
£ed
 == NULL) {

71 ià(
DB
 !ğ
NULL
) {

72 
	`XFREE
(
DB
);

74 ià(
mask
 !ğ
NULL
) {

75 
	`XFREE
(
mask
);

77 ià(
£ed
 !ğ
NULL
) {

78 
	`XFREE
(
£ed
);

80  
CRYPT_MEM
;

85 
x
 = 
modulus_Ën
;

86 ià(
Í¬am
 !ğ
NULL
) {

87 ià((
”r
 = 
	`hash_memÜy
(
hash_idx
, 
Í¬am
, 
Í¬amËn
, 
DB
, &
x
)è!ğ
CRYPT_OK
) {

88 
LBL_ERR
;

92 ià((
”r
 = 
	`hash_memÜy
(
hash_idx
, 
DB
, 0, DB, &
x
)è!ğ
CRYPT_OK
) {

93 
LBL_ERR
;

98 
x
 = 
hL’
;

99 
y
 = 
modulus_Ën
 - 
msgËn
 - 2*
hL’
 - 2;

100 
	`XMEMSET
(
DB
+
x
, 0, 
y
);

101 
x
 +ğ
y
;

104 
DB
[
x
++] = 0x01;

107 
	`XMEMCPY
(
DB
+
x
, 
msg
, 
msgËn
);

108 
x
 +ğ
msgËn
;

111 ià(
´ng_desütÜ
[
´ng_idx
].
	`»ad
(
£ed
, 
hL’
, 
´ng
) != hLen) {

112 
”r
 = 
CRYPT_ERROR_READPRNG
;

113 
LBL_ERR
;

117 ià((
”r
 = 
	`pkcs_1_mgf1
(
hash_idx
, 
£ed
, 
hL’
, 
mask
, 
modulus_Ën
 - hL’ - 1)è!ğ
CRYPT_OK
) {

118 
LBL_ERR
;

122 
y
 = 0; y < (
modulus_Ën
 - 
hL’
 - 1); y++) {

123 
DB
[
y
] ^ğ
mask
[y];

127 ià((
”r
 = 
	`pkcs_1_mgf1
(
hash_idx
, 
DB
, 
modulus_Ën
 - 
hL’
 - 1, 
mask
, hL’)è!ğ
CRYPT_OK
) {

128 
LBL_ERR
;

132 
y
 = 0; y < 
hL’
; y++) {

133 
£ed
[
y
] ^ğ
mask
[y];

137 ià(*
ou’
 < 
modulus_Ën
) {

138 *
ou’
 = 
modulus_Ën
;

139 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

140 
LBL_ERR
;

144 
x
 = 0;

145 
out
[
x
++] = 0x00;

146 
	`XMEMCPY
(
out
+
x
, 
£ed
, 
hL’
);

147 
x
 +ğ
hL’
;

148 
	`XMEMCPY
(
out
+
x
, 
DB
, 
modulus_Ën
 - 
hL’
 - 1);

149 
x
 +ğ
modulus_Ën
 - 
hL’
 - 1;

151 *
ou’
 = 
x
;

153 
”r
 = 
CRYPT_OK
;

154 
LBL_ERR
:

155 #ifdeà
LTC_CLEAN_STACK


156 
	`z”omem
(
DB
, 
modulus_Ën
);

157 
	`z”omem
(
£ed
, 
hL’
);

158 
	`z”omem
(
mask
, 
modulus_Ën
);

161 
	`XFREE
(
£ed
);

162 
	`XFREE
(
mask
);

163 
	`XFREE
(
DB
);

165  
”r
;

166 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_os2ip.c

11 
	~"tomüy±.h
"

17 #ifdeà
PKCS_1


26 
	$pkcs_1_os2
(*
n
, *
š
, 
šËn
)

28  
	`mp_»ad_unsigÃd_bš
(
n
, 
š
, 
šËn
);

29 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_pss_decode.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


32 
	$pkcs_1_pss_decode
(cÚ¡ *
msghash
, 
msghashËn
,

33 cÚ¡ *
sig
, 
sigËn
,

34 
§ÉËn
, 
hash_idx
,

35 
modulus_b™Ën
, *
»s
)

37 *
DB
, *
mask
, *
§É
, *
hash
;

38 
x
, 
y
, 
hL’
, 
modulus_Ën
;

39 
”r
;

40 
hash_¡©e
 
md
;

42 
	`LTC_ARGCHK
(
msghash
 !ğ
NULL
);

43 
	`LTC_ARGCHK
(
»s
 !ğ
NULL
);

46 *
»s
 = 0;

49 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

50  
”r
;

53 
hL’
 = 
hash_desütÜ
[
hash_idx
].
hashsize
;

54 
modulus_Ën
 = (
modulus_b™Ën
>>3) + (modulus_bitlen & 7 ? 1 : 0);

57 ià((
§ÉËn
 > 
modulus_Ën
) ||

58 (
modulus_Ën
 < 
hL’
 + 
§ÉËn
 + 2è|| (
sigËn
 != modulus_len)) {

59  
CRYPT_PK_INVALID_SIZE
;

63 
DB
 = 
	`XMALLOC
(
modulus_Ën
);

64 
mask
 = 
	`XMALLOC
(
modulus_Ën
);

65 
§É
 = 
	`XMALLOC
(
modulus_Ën
);

66 
hash
 = 
	`XMALLOC
(
modulus_Ën
);

67 ià(
DB
 =ğ
NULL
 || 
mask
 =ğNULL || 
§É
 =ğNULL || 
hash
 == NULL) {

68 ià(
DB
 !ğ
NULL
) {

69 
	`XFREE
(
DB
);

71 ià(
mask
 !ğ
NULL
) {

72 
	`XFREE
(
mask
);

74 ià(
§É
 !ğ
NULL
) {

75 
	`XFREE
(
§É
);

77 ià(
hash
 !ğ
NULL
) {

78 
	`XFREE
(
hash
);

80  
CRYPT_MEM
;

84 ià(
sig
[
sigËn
-1] != 0xBC) {

85 
”r
 = 
CRYPT_INVALID_PACKET
;

86 
LBL_ERR
;

90 
x
 = 0;

91 
	`XMEMCPY
(
DB
, 
sig
 + 
x
, 
modulus_Ën
 - 
hL’
 - 1);

92 
x
 +ğ
modulus_Ën
 - 
hL’
 - 1;

95 
	`XMEMCPY
(
hash
, 
sig
 + 
x
, 
hL’
);

96 
x
 +ğ
hL’
;

99 ià((
sig
[0] & ~(0xFF >> ((
modulus_Ën
<<3è- (
modulus_b™Ën
-1)))) != 0) {

100 
”r
 = 
CRYPT_INVALID_PACKET
;

101 
LBL_ERR
;

105 ià((
”r
 = 
	`pkcs_1_mgf1
(
hash_idx
, 
hash
, 
hL’
, 
mask
, 
modulus_Ën
 - hL’ - 1)è!ğ
CRYPT_OK
) {

106 
LBL_ERR
;

110 
y
 = 0; y < (
modulus_Ën
 - 
hL’
 - 1); y++) {

111 
DB
[
y
] ^ğ
mask
[y];

115 
DB
[0] &ğ0xFF >> ((
modulus_Ën
<<3è- (
modulus_b™Ën
-1));

120 
x
 = 0; x < 
modulus_Ën
 - 
§ÉËn
 - 
hL’
 - 2; x++) {

121 ià(
DB
[
x
] != 0x00) {

122 
”r
 = 
CRYPT_INVALID_PACKET
;

123 
LBL_ERR
;

128 ià(
DB
[
x
++] != 0x01) {

129 
”r
 = 
CRYPT_INVALID_PACKET
;

130 
LBL_ERR
;

134 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`š™
(&
md
)è!ğ
CRYPT_OK
) {

135 
LBL_ERR
;

137 
	`z”omem
(
mask
, 8);

138 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(&
md
, 
mask
, 8)è!ğ
CRYPT_OK
) {

139 
LBL_ERR
;

141 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(&
md
, 
msghash
, 
msghashËn
)è!ğ
CRYPT_OK
) {

142 
LBL_ERR
;

144 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(&
md
, 
DB
+
x
, 
§ÉËn
)è!ğ
CRYPT_OK
) {

145 
LBL_ERR
;

147 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`dÚe
(&
md
, 
mask
)è!ğ
CRYPT_OK
) {

148 
LBL_ERR
;

152 ià(
	`XMEMCMP
(
mask
, 
hash
, 
hL’
) == 0) {

153 *
»s
 = 1;

156 
”r
 = 
CRYPT_OK
;

157 
LBL_ERR
:

158 #ifdeà
LTC_CLEAN_STACK


159 
	`z”omem
(
DB
, 
modulus_Ën
);

160 
	`z”omem
(
mask
, 
modulus_Ën
);

161 
	`z”omem
(
§É
, 
modulus_Ën
);

162 
	`z”omem
(
hash
, 
modulus_Ën
);

165 
	`XFREE
(
hash
);

166 
	`XFREE
(
§É
);

167 
	`XFREE
(
mask
);

168 
	`XFREE
(
DB
);

170  
”r
;

171 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_pss_encode.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


33 
	$pkcs_1_pss_’code
(cÚ¡ *
msghash
, 
msghashËn
,

34 
§ÉËn
, 
´ng_¡©e
 *
´ng
,

35 
´ng_idx
, 
hash_idx
,

36 
modulus_b™Ën
,

37 *
out
, *
ou’
)

39 *
DB
, *
mask
, *
§É
, *
hash
;

40 
x
, 
y
, 
hL’
, 
modulus_Ën
;

41 
”r
;

42 
hash_¡©e
 
md
;

44 
	`LTC_ARGCHK
(
msghash
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

49 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

50  
”r
;

52 ià((
”r
 = 
	`´ng_is_v®id
(
´ng_idx
)è!ğ
CRYPT_OK
) {

53  
”r
;

56 
hL’
 = 
hash_desütÜ
[
hash_idx
].
hashsize
;

57 
modulus_Ën
 = (
modulus_b™Ën
>>3) + (modulus_bitlen & 7 ? 1 : 0);

60 ià((
§ÉËn
 > 
modulus_Ën
è|| (modulus_ËÀ< 
hL’
 + saltlen + 2)) {

61  
CRYPT_PK_INVALID_SIZE
;

65 
DB
 = 
	`XMALLOC
(
modulus_Ën
);

66 
mask
 = 
	`XMALLOC
(
modulus_Ën
);

67 
§É
 = 
	`XMALLOC
(
modulus_Ën
);

68 
hash
 = 
	`XMALLOC
(
modulus_Ën
);

69 ià(
DB
 =ğ
NULL
 || 
mask
 =ğNULL || 
§É
 =ğNULL || 
hash
 == NULL) {

70 ià(
DB
 !ğ
NULL
) {

71 
	`XFREE
(
DB
);

73 ià(
mask
 !ğ
NULL
) {

74 
	`XFREE
(
mask
);

76 ià(
§É
 !ğ
NULL
) {

77 
	`XFREE
(
§É
);

79 ià(
hash
 !ğ
NULL
) {

80 
	`XFREE
(
hash
);

82  
CRYPT_MEM
;

87 ià(
§ÉËn
 > 0) {

88 ià(
´ng_desütÜ
[
´ng_idx
].
	`»ad
(
§É
, 
§ÉËn
, 
´ng
) != saltlen) {

89 
”r
 = 
CRYPT_ERROR_READPRNG
;

90 
LBL_ERR
;

95 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`š™
(&
md
)è!ğ
CRYPT_OK
) {

96 
LBL_ERR
;

98 
	`z”omem
(
DB
, 8);

99 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(&
md
, 
DB
, 8)è!ğ
CRYPT_OK
) {

100 
LBL_ERR
;

102 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(&
md
, 
msghash
, 
msghashËn
)è!ğ
CRYPT_OK
) {

103 
LBL_ERR
;

105 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`´oûss
(&
md
, 
§É
, 
§ÉËn
)è!ğ
CRYPT_OK
) {

106 
LBL_ERR
;

108 ià((
”r
 = 
hash_desütÜ
[
hash_idx
].
	`dÚe
(&
md
, 
hash
)è!ğ
CRYPT_OK
) {

109 
LBL_ERR
;

113 
x
 = 0;

114 
	`XMEMSET
(
DB
 + 
x
, 0, 
modulus_Ën
 - 
§ÉËn
 - 
hL’
 - 2);

115 
x
 +ğ
modulus_Ën
 - 
§ÉËn
 - 
hL’
 - 2;

116 
DB
[
x
++] = 0x01;

117 
	`XMEMCPY
(
DB
 + 
x
, 
§É
, 
§ÉËn
);

118 
x
 +ğ
§ÉËn
;

121 ià((
”r
 = 
	`pkcs_1_mgf1
(
hash_idx
, 
hash
, 
hL’
, 
mask
, 
modulus_Ën
 - hL’ - 1)è!ğ
CRYPT_OK
) {

122 
LBL_ERR
;

126 
y
 = 0; y < (
modulus_Ën
 - 
hL’
 - 1); y++) {

127 
DB
[
y
] ^ğ
mask
[y];

131 ià(*
ou’
 < 
modulus_Ën
) {

132 *
ou’
 = 
modulus_Ën
;

133 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

134 
LBL_ERR
;

138 
y
 = 0;

139 
	`XMEMCPY
(
out
 + 
y
, 
DB
, 
modulus_Ën
 - 
hL’
 - 1);

140 
y
 +ğ
modulus_Ën
 - 
hL’
 - 1;

143 
	`XMEMCPY
(
out
 + 
y
, 
hash
, 
hL’
);

144 
y
 +ğ
hL’
;

147 
out
[
y
] = 0xBC;

150 
out
[0] &ğ0xFF >> ((
modulus_Ën
<<3è- (
modulus_b™Ën
-1));

153 *
ou’
 = 
modulus_Ën
;

154 
”r
 = 
CRYPT_OK
;

155 
LBL_ERR
:

156 #ifdeà
LTC_CLEAN_STACK


157 
	`z”omem
(
DB
, 
modulus_Ën
);

158 
	`z”omem
(
mask
, 
modulus_Ën
);

159 
	`z”omem
(
§É
, 
modulus_Ën
);

160 
	`z”omem
(
hash
, 
modulus_Ën
);

163 
	`XFREE
(
hash
);

164 
	`XFREE
(
§É
);

165 
	`XFREE
(
mask
);

166 
	`XFREE
(
DB
);

168  
”r
;

169 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_v1_5_decode.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


32 
	$pkcs_1_v1_5_decode
(cÚ¡ *
msg
,

33 
msgËn
,

34 
block_ty³
,

35 
modulus_b™Ën
,

36 *
out
,

37 *
ou’
,

38 *
is_v®id
)

40 
modulus_Ën
, 
ps_Ën
, 
i
;

41 
»suÉ
;

44 *
is_v®id
 = 0;

46 
modulus_Ën
 = (
modulus_b™Ën
 >> 3) + (modulus_bitlen & 7 ? 1 : 0);

50 ià((
msgËn
 > 
modulus_Ën
) || (modulus_len < 11)) {

51  
CRYPT_PK_INVALID_SIZE
;

56 ià((
msg
[0] !ğ0x00è|| (msg[1] !ğ()
block_ty³
)) {

57 
»suÉ
 = 
CRYPT_INVALID_PACKET
;

58 
ba
;

61 ià(
block_ty³
 =ğ
LTC_PKCS_1_EME
) {

62 
i
 = 2; i < 
modulus_Ën
; i++) {

64 ià(
msg
[
i
] == 0x00) { ; }

66 
ps_Ën
 = 
i
++ - 2;

68 ià((
i
 >ğ
modulus_Ën
è|| (
ps_Ën
 < 8)) {

72 
»suÉ
 = 
CRYPT_INVALID_PACKET
;

73 
ba
;

76 
i
 = 2; i < 
modulus_Ën
 - 1; i++) {

77 ià(
msg
[
i
] != 0xFF) { ; }

81 ià(
msg
[
i
] != 0) {

83 
»suÉ
 = 
CRYPT_INVALID_PACKET
;

84 
ba
;

87 
ps_Ën
 = 
i
 - 2;

90 ià(*
ou’
 < (
msgËn
 - (2 + 
ps_Ën
 + 1))) {

91 *
ou’
 = 
msgËn
 - (2 + 
ps_Ën
 + 1);

92 
»suÉ
 = 
CRYPT_BUFFER_OVERFLOW
;

93 
ba
;

96 *
ou’
 = (
msgËn
 - (2 + 
ps_Ën
 + 1));

97 
	`XMEMCPY
(
out
, &
msg
[2 + 
ps_Ën
 + 1], *
ou’
);

100 *
is_v®id
 = 1;

101 
»suÉ
 = 
CRYPT_OK
;

102 
ba
:

103  
»suÉ
;

104 
	}
}

	@libtomcrypt/src/pk/pkcs1/pkcs_1_v1_5_encode.c

11 
	~"tomüy±.h
"

18 #ifdeà
PKCS_1


33 
	$pkcs_1_v1_5_’code
(cÚ¡ *
msg
,

34 
msgËn
,

35 
block_ty³
,

36 
modulus_b™Ën
,

37 
´ng_¡©e
 *
´ng
,

38 
´ng_idx
,

39 *
out
,

40 *
ou’
)

42 
modulus_Ën
, 
ps_Ën
, 
i
;

43 *
ps
;

44 
»suÉ
;

47 ià((
block_ty³
 !ğ
LTC_PKCS_1_EMSA
) &&

48 (
block_ty³
 !ğ
LTC_PKCS_1_EME
)) {

49  
CRYPT_PK_INVALID_PADDING
;

52 ià(
block_ty³
 =ğ
LTC_PKCS_1_EME
) {

53 ià((
»suÉ
 = 
	`´ng_is_v®id
(
´ng_idx
)è!ğ
CRYPT_OK
) {

54  
»suÉ
;

58 
modulus_Ën
 = (
modulus_b™Ën
 >> 3) + (modulus_bitlen & 7 ? 1 : 0);

61 ià((
msgËn
 + 11è> 
modulus_Ën
) {

62  
CRYPT_PK_INVALID_SIZE
;

65 ià(*
ou’
 < 
modulus_Ën
) {

66 *
ou’
 = 
modulus_Ën
;

67 
»suÉ
 = 
CRYPT_BUFFER_OVERFLOW
;

68 
ba
;

72 
ps
 = &
out
[2];

73 
ps_Ën
 = 
modulus_Ën
 - 
msgËn
 - 3;

75 ià(
block_ty³
 =ğ
LTC_PKCS_1_EME
) {

77 ià(
´ng_desütÜ
[
´ng_idx
].
	`»ad
(
ps
, 
ps_Ën
, 
´ng
) !=…s_len) {

78 
»suÉ
 = 
CRYPT_ERROR_READPRNG
;

79 
ba
;

83 
i
 = 0; i < 
ps_Ën
; i++) {

84 
ps
[
i
] == 0) {

85 ià(
´ng_desütÜ
[
´ng_idx
].
	`»ad
(&
ps
[
i
], 1, 
´ng
) != 1) {

86 
»suÉ
 = 
CRYPT_ERROR_READPRNG
;

87 
ba
;

92 
	`XMEMSET
(
ps
, 0xFF, 
ps_Ën
);

96 
out
[0] = 0x00;

97 
out
[1] = ()
block_ty³
;

98 
out
[2 + 
ps_Ën
] = 0x00;

99 
	`XMEMCPY
(&
out
[2 + 
ps_Ën
 + 1], 
msg
, 
msgËn
);

100 *
ou’
 = 
modulus_Ën
;

102 
»suÉ
 = 
CRYPT_OK
;

103 
ba
:

104  
»suÉ
;

105 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_decrypt_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


34 
	$r§_deüy±_key_ex
(cÚ¡ *
š
, 
šËn
,

35 *
out
, *
ou’
,

36 cÚ¡ *
Í¬am
, 
Í¬amËn
,

37 
hash_idx
, 
·ddšg
,

38 *
¡©
, 
r§_key
 *
key
)

40 
modulus_b™Ën
, 
modulus_by‹Ën
, 
x
;

41 
”r
;

42 *
tmp
;

44 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

50 *
¡©
 = 0;

54 ià((
·ddšg
 !ğ
LTC_PKCS_1_V1_5
) &&

55 (
·ddšg
 !ğ
LTC_PKCS_1_OAEP
)) {

56  
CRYPT_PK_INVALID_PADDING
;

59 ià(
·ddšg
 =ğ
LTC_PKCS_1_OAEP
) {

61 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

62  
”r
;

67 
modulus_b™Ën
 = 
	`mp_couÁ_b™s
Ğ(
key
->
N
));

70 
modulus_by‹Ën
 = 
	`mp_unsigÃd_bš_size
Ğ(
key
->
N
));

71 ià(
modulus_by‹Ën
 !ğ
šËn
) {

72  
CRYPT_INVALID_PACKET
;

76 
tmp
 = 
	`XMALLOC
(
šËn
);

77 ià(
tmp
 =ğ
NULL
) {

78  
CRYPT_MEM
;

82 
x
 = 
šËn
;

83 ià((
”r
 = 
Éc_mp
.
	`r§_me
(
š
, 
šËn
, 
tmp
, &
x
, 
PK_PRIVATE
, 
key
)è!ğ
CRYPT_OK
) {

84 
	`XFREE
(
tmp
);

85  
”r
;

88 ià(
·ddšg
 =ğ
LTC_PKCS_1_OAEP
) {

90 
”r
 = 
	`pkcs_1_ß•_decode
(
tmp
, 
x
, 
Í¬am
, 
Í¬amËn
, 
modulus_b™Ën
, 
hash_idx
,

91 
out
, 
ou’
, 
¡©
);

94 
”r
 = 
	`pkcs_1_v1_5_decode
(
tmp
, 
x
, 
LTC_PKCS_1_EME
, 
modulus_b™Ën
, 
out
, 
ou’
, 
¡©
);

97 
	`XFREE
(
tmp
);

98  
”r
;

99 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_encrypt_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


35 
	$r§_’üy±_key_ex
(cÚ¡ *
š
, 
šËn
,

36 *
out
, *
ou’
,

37 cÚ¡ *
Í¬am
, 
Í¬amËn
,

38 
´ng_¡©e
 *
´ng
, 
´ng_idx
, 
hash_idx
, 
·ddšg
, 
r§_key
 *
key
)

40 
modulus_b™Ën
, 
modulus_by‹Ën
, 
x
;

41 
”r
;

43 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

49 ià((
·ddšg
 !ğ
LTC_PKCS_1_V1_5
) &&

50 (
·ddšg
 !ğ
LTC_PKCS_1_OAEP
)) {

51  
CRYPT_PK_INVALID_PADDING
;

55 ià((
”r
 = 
	`´ng_is_v®id
(
´ng_idx
)è!ğ
CRYPT_OK
) {

56  
”r
;

59 ià(
·ddšg
 =ğ
LTC_PKCS_1_OAEP
) {

61 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

62  
”r
;

67 
modulus_b™Ën
 = 
	`mp_couÁ_b™s
Ğ(
key
->
N
));

70 
modulus_by‹Ën
 = 
	`mp_unsigÃd_bš_size
Ğ(
key
->
N
));

71 ià(
modulus_by‹Ën
 > *
ou’
) {

72 *
ou’
 = 
modulus_by‹Ën
;

73  
CRYPT_BUFFER_OVERFLOW
;

76 ià(
·ddšg
 =ğ
LTC_PKCS_1_OAEP
) {

78 
x
 = *
ou’
;

79 ià((
”r
 = 
	`pkcs_1_ß•_’code
(
š
, 
šËn
, 
Í¬am
,

80 
Í¬amËn
, 
modulus_b™Ën
, 
´ng
, 
´ng_idx
, 
hash_idx
,

81 
out
, &
x
)è!ğ
CRYPT_OK
) {

82  
”r
;

86 
x
 = *
ou’
;

87 ià((
”r
 = 
	`pkcs_1_v1_5_’code
(
š
, 
šËn
, 
LTC_PKCS_1_EME
,

88 
modulus_b™Ën
, 
´ng
, 
´ng_idx
,

89 
out
, &
x
)è!ğ
CRYPT_OK
) {

90  
”r
;

95  
Éc_mp
.
	`r§_me
(
out
, 
x
, out, 
ou’
, 
PK_PUBLIC
, 
key
);

96 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_export.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


28 
	$r§_expÜt
(*
out
, *
ou’
, 
ty³
, 
r§_key
 *
key
)

30 
z”o
=0;

31 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

32 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

33 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

36 ià(!(
key
->
ty³
 =ğ
PK_PRIVATE
) && (type == PK_PRIVATE)) {

37  
CRYPT_PK_INVALID_TYPE
;

40 ià(
ty³
 =ğ
PK_PRIVATE
) {

45  
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

46 
LTC_ASN1_SHORT_INTEGER
, 1UL, &
z”o
,

47 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

48 
LTC_ASN1_INTEGER
, 1UL, 
key
->
e
,

49 
LTC_ASN1_INTEGER
, 1UL, 
key
->
d
,

50 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

51 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

52 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dP
,

53 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dQ
,

54 
LTC_ASN1_INTEGER
, 1UL, 
key
->
qP
,

55 
LTC_ASN1_EOL
, 0UL, 
NULL
);

58  
	`d”_’code_£qu’û_muÉi
(
out
, 
ou’
,

59 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

60 
LTC_ASN1_INTEGER
, 1UL, 
key
->
e
,

61 
LTC_ASN1_EOL
, 0UL, 
NULL
);

63 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_exptmod.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


30 
	$r§_ex±mod
(cÚ¡ *
š
, 
šËn
,

31 *
out
, *
ou’
, 
which
,

32 
r§_key
 *
key
)

34 *
tmp
, *
tm·
, *
tmpb
;

35 
x
;

36 
”r
;

38 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

39 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

40 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

41 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

44 ià(
which
 =ğ
PK_PRIVATE
 && (
key
->
ty³
 != PK_PRIVATE)) {

45  
CRYPT_PK_NOT_PRIVATE
;

49 ià(
which
 !ğ
PK_PRIVATE
 && which !ğ
PK_PUBLIC
) {

50  
CRYPT_PK_INVALID_TYPE
;

54 ià((
”r
 = 
	`mp_š™_muÉi
(&
tmp
, &
tm·
, &
tmpb
, 
NULL
)è!ğ
CRYPT_OK
) { ƒrr; }

55 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
tmp
, (*)
š
, ()
šËn
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

58 ià(
	`mp_cmp
(
key
->
N
, 
tmp
è=ğ
LTC_MP_LT
) {

59 
”r
 = 
CRYPT_PK_INVALID_SIZE
;

60 
”rÜ
;

64 ià(
which
 =ğ
PK_PRIVATE
) {

66 ià((
”r
 = 
	`mp_ex±mod
(
tmp
, 
key
->
dP
, key->
p
, 
tm·
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

69 ià((
”r
 = 
	`mp_ex±mod
(
tmp
, 
key
->
dQ
, key->
q
, 
tmpb
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

72 ià((
”r
 = 
	`mp_sub
(
tm·
, 
tmpb
, 
tmp
)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

73 ià((
”r
 = 
	`mp_mulmod
(
tmp
, 
key
->
qP
, key->
p
,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

76 ià((
”r
 = 
	`mp_mul
(
tmp
, 
key
->
q
,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

77 ià((
”r
 = 
	`mp_add
(
tmp
, 
tmpb
,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

80 ià((
”r
 = 
	`mp_ex±mod
(
tmp
, 
key
->
e
, key->
N
,mp)è!ğ
CRYPT_OK
è{ 
”rÜ
; }

84 
x
 = ()
	`mp_unsigÃd_bš_size
(
key
->
N
);

85 ià(
x
 > *
ou’
) {

86 *
ou’
 = 
x
;

87 
”r
 = 
CRYPT_BUFFER_OVERFLOW
;

88 
”rÜ
;

92 ià(
	`mp_unsigÃd_bš_size
(
tmp
è> mp_unsigÃd_bš_size(
key
->
N
)) {

93 
”r
 = 
CRYPT_ERROR
;

94 
”rÜ
;

96 *
ou’
 = 
x
;

99 
	`z”omem
(
out
, 
x
);

100 ià((
”r
 = 
	`mp_to_unsigÃd_bš
(
tmp
, 
out
+(
x
-
	`mp_unsigÃd_bš_size
Ñmp)))è!ğ
CRYPT_OK
è{ 
”rÜ
; }

103 
”r
 = 
CRYPT_OK
;

104 
”rÜ
:

105 
	`mp_ş—r_muÉi
(
tmp
, 
tm·
, 
tmpb
, 
NULL
);

106  
”r
;

107 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_free.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


24 
	$r§_ä“
(
r§_key
 *
key
)

26 
	`LTC_ARGCHKVD
(
key
 !ğ
NULL
);

27 
	`mp_ş—r_muÉi
(
key
->
e
, key->
d
, key->
N
, key->
dQ
, key->
dP
, key->
qP
, key->
p
, key->
q
, 
NULL
);

28 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_import.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


27 
	$r§_impÜt
(cÚ¡ *
š
, 
šËn
, 
r§_key
 *
key
)

29 
”r
;

30 *
z”o
;

31 *
tmpbuf
;

32 
t
, 
x
, 
y
, 
z
, 
tmpoid
[16];

33 
Éc_a¢1_li¡
 
s¦_pubkey_hashoid
[2];

34 
Éc_a¢1_li¡
 
s¦_pubkey
[2];

36 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

37 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

38 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

41 ià((
”r
 = 
	`mp_š™_muÉi
(&
key
->
e
, &key->
d
, &key->
N
, &key->
dQ
,

42 &
key
->
dP
, &key->
qP
, &key->
p
, &key->
q
, 
NULL
)è!ğ
CRYPT_OK
) {

43  
”r
;

47 
tmpbuf
 = 
	`XCALLOC
(1, 
MAX_RSA_SIZE
*8);

48 ià(
tmpbuf
 =ğ
NULL
) {

49 
”r
 = 
CRYPT_MEM
;

50 
LBL_ERR
;

54 
	`LTC_SET_ASN1
(
s¦_pubkey_hashoid
, 0, 
LTC_ASN1_OBJECT_IDENTIFIER
, 
tmpoid
, (tmpoid)/(tmpoid[0]));

55 
	`LTC_SET_ASN1
(
s¦_pubkey_hashoid
, 1, 
LTC_ASN1_NULL
, 
NULL
, 0);

60 
	`LTC_SET_ASN1
(
s¦_pubkey
, 0, 
LTC_ASN1_SEQUENCE
, &
s¦_pubkey_hashoid
, 2);

61 
	`LTC_SET_ASN1
(
s¦_pubkey
, 1, 
LTC_ASN1_BIT_STRING
, 
tmpbuf
, 
MAX_RSA_SIZE
*8);

63 ià(
	`d”_decode_£qu’û
(
š
, 
šËn
,

64 
s¦_pubkey
, 2ULè=ğ
CRYPT_OK
) {

67 
t
 = 
y
 = 
z
 = 
x
 = 0; x < 
s¦_pubkey
[1].
size
; x++) {

68 
y
 = (y << 1è| 
tmpbuf
[
x
];

69 ià(++
z
 == 8) {

70 
tmpbuf
[
t
++] = ()
y
;

71 
y
 = 0;

72 
z
 = 0;

77 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
tmpbuf
, 
t
,

78 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

79 
LTC_ASN1_INTEGER
, 1UL, 
key
->
e
,

80 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

81 
	`XFREE
(
tmpbuf
);

82 
LBL_ERR
;

84 
	`XFREE
(
tmpbuf
);

85 
key
->
ty³
 = 
PK_PUBLIC
;

86  
CRYPT_OK
;

88 
	`XFREE
(
tmpbuf
);

91 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

92 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

93 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

94 
LBL_ERR
;

97 ià(
	`mp_cmp_d
(
key
->
N
, 0è=ğ
LTC_MP_EQ
) {

98 ià((
”r
 = 
	`mp_š™
(&
z”o
)è!ğ
CRYPT_OK
) {

99 
LBL_ERR
;

102 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

103 
LTC_ASN1_INTEGER
, 1UL, 
z”o
,

104 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

105 
LTC_ASN1_INTEGER
, 1UL, 
key
->
e
,

106 
LTC_ASN1_INTEGER
, 1UL, 
key
->
d
,

107 
LTC_ASN1_INTEGER
, 1UL, 
key
->
p
,

108 
LTC_ASN1_INTEGER
, 1UL, 
key
->
q
,

109 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dP
,

110 
LTC_ASN1_INTEGER
, 1UL, 
key
->
dQ
,

111 
LTC_ASN1_INTEGER
, 1UL, 
key
->
qP
,

112 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

113 
	`mp_ş—r
(
z”o
);

114 
LBL_ERR
;

116 
	`mp_ş—r
(
z”o
);

117 
key
->
ty³
 = 
PK_PRIVATE
;

118 } ià(
	`mp_cmp_d
(
key
->
N
, 1è=ğ
LTC_MP_EQ
) {

120 
”r
 = 
CRYPT_PK_INVALID_TYPE
;

121 
LBL_ERR
;

124 ià((
”r
 = 
	`d”_decode_£qu’û_muÉi
(
š
, 
šËn
,

125 
LTC_ASN1_INTEGER
, 1UL, 
key
->
N
,

126 
LTC_ASN1_INTEGER
, 1UL, 
key
->
e
,

127 
LTC_ASN1_EOL
, 0UL, 
NULL
)è!ğ
CRYPT_OK
) {

128 
LBL_ERR
;

130 
key
->
ty³
 = 
PK_PUBLIC
;

132  
CRYPT_OK
;

133 
LBL_ERR
:

134 
	`mp_ş—r_muÉi
(
key
->
d
, key->
e
, key->
N
, key->
dQ
, key->
dP
, key->
qP
, key->
p
, key->
q
, 
NULL
);

135  
”r
;

136 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_make_key.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


29 
	$r§_make_key
(
´ng_¡©e
 *
´ng
, 
w´ng
, 
size
, 
e
, 
r§_key
 *
key
)

31 *
p
, *
q
, *
tmp1
, *
tmp2
, *
tmp3
;

32 
”r
;

34 
	`LTC_ARGCHK
(
Éc_mp
.
Çme
 !ğ
NULL
);

35 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

37 ià((
size
 < (
MIN_RSA_SIZE
/8)è|| (siz> (
MAX_RSA_SIZE
/8))) {

38  
CRYPT_INVALID_KEYSIZE
;

41 ià((
e
 < 3) || ((e & 1) == 0)) {

42  
CRYPT_INVALID_ARG
;

45 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

46  
”r
;

49 ià((
”r
 = 
	`mp_š™_muÉi
(&
p
, &
q
, &
tmp1
, &
tmp2
, &
tmp3
, 
NULL
)è!ğ
CRYPT_OK
) {

50  
”r
;

54 ià((
”r
 = 
	`mp_£t_št
(
tmp3
, 
e
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

58 ià((
”r
 = 
	`¿nd_´ime
Ğ
p
, 
size
/2, 
´ng
, 
w´ng
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

59 ià((
”r
 = 
	`mp_sub_d
Ğ
p
, 1, 
tmp1
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

60 ià((
”r
 = 
	`mp_gcd
Ğ
tmp1
, 
tmp3
, 
tmp2
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

61 } 
	`mp_cmp_d
Ğ
tmp2
, 1) != 0);

65 ià((
”r
 = 
	`¿nd_´ime
Ğ
q
, 
size
/2, 
´ng
, 
w´ng
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

66 ià((
”r
 = 
	`mp_sub_d
Ğ
q
, 1, 
tmp1
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

67 ià((
”r
 = 
	`mp_gcd
Ğ
tmp1
, 
tmp3
, 
tmp2
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

68 } 
	`mp_cmp_d
Ğ
tmp2
, 1) != 0);

71 ià((
”r
 = 
	`mp_sub_d
Ğ
p
, 1, 
tmp2
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

73 ià((
”r
 = 
	`mp_lcm
Ğ
tmp1
, 
tmp2
,mp1)è!ğ
CRYPT_OK
è{ 
”rkey
; }

76 ià((
”r
 = 
	`mp_š™_muÉi
(&
key
->
e
, &key->
d
, &key->
N
, &key->
dQ
, &key->
dP
, &key->
qP
, &key->
p
, &key->
q
, 
NULL
)è!ğ
CRYPT_OK
) {

77 
”rkey
;

80 ià((
”r
 = 
	`mp_£t_št
Ğ
key
->
e
,ƒ)è!ğ
CRYPT_OK
è{ 
”rkey
; }

81 ià((
”r
 = 
	`mp_švmod
Ğ
key
->
e
, 
tmp1
, key->
d
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

82 ià((
”r
 = 
	`mp_mul
Ğ
p
, 
q
, 
key
->
N
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

86 ià((
”r
 = 
	`mp_sub_d
Ğ
p
, 1, 
tmp1
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

87 ià((
”r
 = 
	`mp_sub_d
Ğ
q
, 1, 
tmp2
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

88 ià((
”r
 = 
	`mp_mod
Ğ
key
->
d
, 
tmp1
, key->
dP
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

89 ià((
”r
 = 
	`mp_mod
Ğ
key
->
d
, 
tmp2
, key->
dQ
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

90 ià((
”r
 = 
	`mp_švmod
Ğ
q
, 
p
, 
key
->
qP
)è!ğ
CRYPT_OK
è{ 
”rkey
; }

92 ià((
”r
 = 
	`mp_cİy
Ğ
p
, 
key
->p)è!ğ
CRYPT_OK
è{ 
”rkey
; }

93 ià((
”r
 = 
	`mp_cİy
Ğ
q
, 
key
->q)è!ğ
CRYPT_OK
è{ 
”rkey
; }

96 
key
->
ty³
 = 
PK_PRIVATE
;

99 
”r
 = 
CRYPT_OK
;

100 
ş—nup
;

101 
”rkey
:

102 
	`mp_ş—r_muÉi
(
key
->
d
, key->
e
, key->
N
, key->
dQ
, key->
dP
, key->
qP
, key->
p
, key->
q
, 
NULL
);

103 
ş—nup
:

104 
	`mp_ş—r_muÉi
(
tmp3
, 
tmp2
, 
tmp1
, 
p
, 
q
, 
NULL
);

105  
”r
;

106 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_sign_hash.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


34 
	$r§_sign_hash_ex
(cÚ¡ *
š
, 
šËn
,

35 *
out
, *
ou’
,

36 
·ddšg
,

37 
´ng_¡©e
 *
´ng
, 
´ng_idx
,

38 
hash_idx
, 
§ÉËn
,

39 
r§_key
 *
key
)

41 
modulus_b™Ën
, 
modulus_by‹Ën
, 
x
, 
y
;

42 
”r
;

44 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

47 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

50 ià((
·ddšg
 !ğ
LTC_PKCS_1_V1_5
è&& (·ddšg !ğ
LTC_PKCS_1_PSS
)) {

51  
CRYPT_PK_INVALID_PADDING
;

54 ià(
·ddšg
 =ğ
LTC_PKCS_1_PSS
) {

56 ià((
”r
 = 
	`´ng_is_v®id
(
´ng_idx
)è!ğ
CRYPT_OK
) {

57  
”r
;

59 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

60  
”r
;

65 
modulus_b™Ën
 = 
	`mp_couÁ_b™s
((
key
->
N
));

68 
modulus_by‹Ën
 = 
	`mp_unsigÃd_bš_size
((
key
->
N
));

69 ià(
modulus_by‹Ën
 > *
ou’
) {

70 *
ou’
 = 
modulus_by‹Ën
;

71  
CRYPT_BUFFER_OVERFLOW
;

74 ià(
·ddšg
 =ğ
LTC_PKCS_1_PSS
) {

76 
x
 = *
ou’
;

77 ià((
”r
 = 
	`pkcs_1_pss_’code
(
š
, 
šËn
, 
§ÉËn
, 
´ng
, 
´ng_idx
,

78 
hash_idx
, 
modulus_b™Ën
, 
out
, &
x
)è!ğ
CRYPT_OK
) {

79  
”r
;

83 *
tmpš
;

84 
Éc_a¢1_li¡
 
dige¡šfo
[2], 
sigšfo
[2];

87 ià(
hash_desütÜ
[
hash_idx
].
OIDËn
 == 0) {

88  
CRYPT_INVALID_ARG
;

99 
	`LTC_SET_ASN1
(
dige¡šfo
, 0, 
LTC_ASN1_OBJECT_IDENTIFIER
, 
hash_desütÜ
[
hash_idx
].
OID
, hash_desütÜ[hash_idx].
OIDËn
);

100 
	`LTC_SET_ASN1
(
dige¡šfo
, 1, 
LTC_ASN1_NULL
, 
NULL
, 0);

101 
	`LTC_SET_ASN1
(
sigšfo
, 0, 
LTC_ASN1_SEQUENCE
, 
dige¡šfo
, 2);

102 
	`LTC_SET_ASN1
(
sigšfo
, 1, 
LTC_ASN1_OCTET_STRING
, 
š
, 
šËn
);

105 
y
 = 
	`mp_unsigÃd_bš_size
(
key
->
N
);

106 
tmpš
 = 
	`XMALLOC
(
y
);

107 ià(
tmpš
 =ğ
NULL
) {

108  
CRYPT_MEM
;

111 ià((
”r
 = 
	`d”_’code_£qu’û
(
sigšfo
, 2, 
tmpš
, &
y
)è!ğ
CRYPT_OK
) {

112 
	`XFREE
(
tmpš
);

113  
”r
;

116 
x
 = *
ou’
;

117 ià((
”r
 = 
	`pkcs_1_v1_5_’code
(
tmpš
, 
y
, 
LTC_PKCS_1_EMSA
,

118 
modulus_b™Ën
, 
NULL
, 0,

119 
out
, &
x
)è!ğ
CRYPT_OK
) {

120 
	`XFREE
(
tmpš
);

121  
”r
;

123 
	`XFREE
(
tmpš
);

127  
Éc_mp
.
	`r§_me
(
out
, 
x
, out, 
ou’
, 
PK_PRIVATE
, 
key
);

128 
	}
}

	@libtomcrypt/src/pk/rsa/rsa_verify_hash.c

11 
	~"tomüy±.h
"

18 #ifdeà
MRSA


33 
	$r§_v”ify_hash_ex
(cÚ¡ *
sig
, 
sigËn
,

34 cÚ¡ *
hash
, 
hashËn
,

35 
·ddšg
,

36 
hash_idx
, 
§ÉËn
,

37 *
¡©
, 
r§_key
 *
key
)

39 
modulus_b™Ën
, 
modulus_by‹Ën
, 
x
;

40 
”r
;

41 *
tmpbuf
;

43 
	`LTC_ARGCHK
(
hash
 !ğ
NULL
);

44 
	`LTC_ARGCHK
(
sig
 !ğ
NULL
);

45 
	`LTC_ARGCHK
(
¡©
 !ğ
NULL
);

46 
	`LTC_ARGCHK
(
key
 !ğ
NULL
);

49 *
¡©
 = 0;

53 ià((
·ddšg
 !ğ
LTC_PKCS_1_V1_5
) &&

54 (
·ddšg
 !ğ
LTC_PKCS_1_PSS
)) {

55  
CRYPT_PK_INVALID_PADDING
;

58 ià(
·ddšg
 =ğ
LTC_PKCS_1_PSS
) {

60 ià((
”r
 = 
	`hash_is_v®id
(
hash_idx
)è!ğ
CRYPT_OK
) {

61  
”r
;

66 
modulus_b™Ën
 = 
	`mp_couÁ_b™s
Ğ(
key
->
N
));

69 
modulus_by‹Ën
 = 
	`mp_unsigÃd_bš_size
Ğ(
key
->
N
));

70 ià(
modulus_by‹Ën
 !ğ
sigËn
) {

71  
CRYPT_INVALID_PACKET
;

75 
tmpbuf
 = 
	`XMALLOC
(
sigËn
);

76 ià(
tmpbuf
 =ğ
NULL
) {

77  
CRYPT_MEM
;

81 
x
 = 
sigËn
;

82 ià((
”r
 = 
Éc_mp
.
	`r§_me
(
sig
, 
sigËn
, 
tmpbuf
, &
x
, 
PK_PUBLIC
, 
key
)è!ğ
CRYPT_OK
) {

83 
	`XFREE
(
tmpbuf
);

84  
”r
;

88 ià(
x
 !ğ
sigËn
) {

89 
	`XFREE
(
tmpbuf
);

90  
CRYPT_INVALID_PACKET
;

93 ià(
·ddšg
 =ğ
LTC_PKCS_1_PSS
) {

95 
”r
 = 
	`pkcs_1_pss_decode
(
hash
, 
hashËn
, 
tmpbuf
, 
x
, 
§ÉËn
, 
hash_idx
, 
modulus_b™Ën
, 
¡©
);

98 *
out
;

99 
ou’
, 
loid
[16];

100 
decoded
;

101 
Éc_a¢1_li¡
 
dige¡šfo
[2], 
sigšfo
[2];

104 ià(
hash_desütÜ
[
hash_idx
].
OIDËn
 == 0) {

105 
”r
 = 
CRYPT_INVALID_ARG
;

106 
ba_2
;

110 
ou’
 = ((
modulus_b™Ën
 >> 3) + (modulus_bitlen & 7 ? 1 : 0)) - 3;

111 
out
 = 
	`XMALLOC
(
ou’
);

112 ià(
out
 =ğ
NULL
) {

113 
”r
 = 
CRYPT_MEM
;

114 
ba_2
;

117 ià((
”r
 = 
	`pkcs_1_v1_5_decode
(
tmpbuf
, 
x
, 
LTC_PKCS_1_EMSA
, 
modulus_b™Ën
, 
out
, &
ou’
, &
decoded
)è!ğ
CRYPT_OK
) {

118 
	`XFREE
(
out
);

119 
ba_2
;

131 
	`LTC_SET_ASN1
(
dige¡šfo
, 0, 
LTC_ASN1_OBJECT_IDENTIFIER
, 
loid
, (loid)/(loid[0]));

132 
	`LTC_SET_ASN1
(
dige¡šfo
, 1, 
LTC_ASN1_NULL
, 
NULL
, 0);

133 
	`LTC_SET_ASN1
(
sigšfo
, 0, 
LTC_ASN1_SEQUENCE
, 
dige¡šfo
, 2);

134 
	`LTC_SET_ASN1
(
sigšfo
, 1, 
LTC_ASN1_OCTET_STRING
, 
tmpbuf
, 
sigËn
);

136 ià((
”r
 = 
	`d”_decode_£qu’û
(
out
, 
ou’
, 
sigšfo
, 2)è!ğ
CRYPT_OK
) {

137 
	`XFREE
(
out
);

138 
ba_2
;

142 ià((
dige¡šfo
[0].
size
 =ğ
hash_desütÜ
[
hash_idx
].
OIDËn
) &&

143 (
	`XMEMCMP
(
dige¡šfo
[0].
d©a
, 
hash_desütÜ
[
hash_idx
].
OID
, (è* hash_desütÜ[hash_idx].
OIDËn
) == 0) &&

144 (
sigšfo
[1].
size
 =ğ
hashËn
) &&

145 (
	`XMEMCMP
(
sigšfo
[1].
d©a
, 
hash
, 
hashËn
) == 0)) {

146 *
¡©
 = 1;

149 #ifdeà
LTC_CLEAN_STACK


150 
	`z”omem
(
out
, 
ou’
);

152 
	`XFREE
(
out
);

155 
ba_2
:

156 #ifdeà
LTC_CLEAN_STACK


157 
	`z”omem
(
tmpbuf
, 
sigËn
);

159 
	`XFREE
(
tmpbuf
);

160  
”r
;

161 
	}
}

	@libtomcrypt/src/prngs/fortuna.c

11 
	~"tomüy±.h
"

24 #ifdeà
FORTUNA


27 #ià!(
defšed
(
RIJNDAEL
è&& defšed(
SHA256
))

28 #”rÜ 
FORTUNA
 
»quœes
 
SHA256
 
ªd
 
RIJNDAEL
 (
AES
)

31 #iâdeà
FORTUNA_POOLS


32 #w¬nšg 
FORTUNA_POOLS
 
was
 
nÙ
 
´eviou¦y
 
defšed
 (
Şd
 
h—d”s
?)

33 
	#FORTUNA_POOLS
 32

	)

36 #ià
FORTUNA_POOLS
 < 4 || FORTUNA_POOLS > 32

37 #”rÜ 
FORTUNA_POOLS
 
mu¡
 
be
 
š
 [4..32]

40 cÚ¡ 
Éc_´ng_desütÜ
 
	gfÜtuÇ_desc
 = {

42 &
fÜtuÇ_¡¬t
,

43 &
fÜtuÇ_add_’Œİy
,

44 &
fÜtuÇ_»ady
,

45 &
fÜtuÇ_»ad
,

46 &
fÜtuÇ_dÚe
,

47 &
fÜtuÇ_expÜt
,

48 &
fÜtuÇ_impÜt
,

49 &
fÜtuÇ_‹¡


53 
	$fÜtuÇ_upd©e_iv
(
´ng_¡©e
 *
´ng
)

55 
x
;

56 *
IV
;

58 
IV
 = 
´ng
->
fÜtuÇ
.IV;

59 
x
 = 0; x < 16; x++) {

60 
IV
[
x
] = (IV[x] + 1) & 255;

61 ià(
IV
[
x
] != 0) ;

63 
	}
}

66 
	$fÜtuÇ_»£ed
(
´ng_¡©e
 *
´ng
)

68 
tmp
[
MAXBLOCKSIZE
];

69 
hash_¡©e
 
md
;

70 
”r
, 
x
;

72 ++
´ng
->
fÜtuÇ
.
»£t_út
;

75 
	`sha256_š™
(&
md
);

76 ià((
”r
 = 
	`sha256_´oûss
(&
md
, 
´ng
->
fÜtuÇ
.
K
, 32)è!ğ
CRYPT_OK
) {

77 
	`sha256_dÚe
(&
md
, 
tmp
);

78  
”r
;

81 
x
 = 0; x < 
FORTUNA_POOLS
; x++) {

82 ià(
x
 =ğ0 || ((
´ng
->
fÜtuÇ
.
»£t_út
 >> (x-1)) & 1) == 0) {

84 ià((
”r
 = 
	`sha256_dÚe
(&
´ng
->
fÜtuÇ
.
poŞ
[
x
], 
tmp
)è!ğ
CRYPT_OK
) {

85 
	`sha256_dÚe
(&
md
, 
tmp
);

86  
”r
;

89 ià((
”r
 = 
	`sha256_´oûss
(&
md
, 
tmp
, 32)è!ğ
CRYPT_OK
) {

90 
	`sha256_dÚe
(&
md
, 
tmp
);

91  
”r
;

94 ià((
”r
 = 
	`sha256_š™
(&
´ng
->
fÜtuÇ
.
poŞ
[
x
])è!ğ
CRYPT_OK
) {

95 
	`sha256_dÚe
(&
md
, 
tmp
);

96  
”r
;

104 ià((
”r
 = 
	`sha256_dÚe
(&
md
, 
´ng
->
fÜtuÇ
.
K
)è!ğ
CRYPT_OK
) {

105  
”r
;

107 ià((
”r
 = 
	`rijnd«l_£tup
(
´ng
->
fÜtuÇ
.
K
, 32, 0, &´ng->fÜtuÇ.
skey
)è!ğ
CRYPT_OK
) {

108  
”r
;

110 
	`fÜtuÇ_upd©e_iv
(
´ng
);

113 
´ng
->
fÜtuÇ
.
poŞ0_Ën
 = 0;

114 
´ng
->
fÜtuÇ
.
wd
 = 0;

117 #ifdeà
LTC_CLEAN_STACK


118 
	`z”omem
(&
md
, (md));

119 
	`z”omem
(
tmp
, (tmp));

122  
CRYPT_OK
;

123 
	}
}

130 
	$fÜtuÇ_¡¬t
(
´ng_¡©e
 *
´ng
)

132 
”r
, 
x
, 
y
;

133 
tmp
[
MAXBLOCKSIZE
];

135 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

138 
x
 = 0; x < 
FORTUNA_POOLS
; x++) {

139 ià((
”r
 = 
	`sha256_š™
(&
´ng
->
fÜtuÇ
.
poŞ
[
x
])è!ğ
CRYPT_OK
) {

140 
y
 = 0; y < 
x
; y++) {

141 
	`sha256_dÚe
(&
´ng
->
fÜtuÇ
.
poŞ
[
y
], 
tmp
);

143  
”r
;

146 
´ng
->
fÜtuÇ
.
poŞ_idx
 =…ºg->fÜtuÇ.
poŞ0_Ën
 =…ºg->fÜtuÇ.
wd
 = 0;

147 
´ng
->
fÜtuÇ
.
»£t_út
 = 0;

150 
	`z”omem
(
´ng
->
fÜtuÇ
.
K
, 32);

151 ià((
”r
 = 
	`rijnd«l_£tup
(
´ng
->
fÜtuÇ
.
K
, 32, 0, &´ng->fÜtuÇ.
skey
)è!ğ
CRYPT_OK
) {

152 
x
 = 0; x < 
FORTUNA_POOLS
; x++) {

153 
	`sha256_dÚe
(&
´ng
->
fÜtuÇ
.
poŞ
[
x
], 
tmp
);

155  
”r
;

157 
	`z”omem
(
´ng
->
fÜtuÇ
.
IV
, 16);

159 
	`LTC_MUTEX_INIT
(&
´ng
->
fÜtuÇ
.
´ng_lock
)

161  
CRYPT_OK
;

162 
	}
}

171 
	$fÜtuÇ_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

173 
tmp
[2];

174 
”r
;

176 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

177 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

179 
	`LTC_MUTEX_LOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

182 ià(
šËn
 > 32) {

183 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

184  
CRYPT_INVALID_ARG
;

188 
tmp
[0] = 0;

189 
tmp
[1] = ()
šËn
;

190 ià((
”r
 = 
	`sha256_´oûss
(&
´ng
->
fÜtuÇ
.
poŞ
[´ng->fÜtuÇ.
poŞ_idx
], 
tmp
, 2)è!ğ
CRYPT_OK
) {

191 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

192  
”r
;

194 ià((
”r
 = 
	`sha256_´oûss
(&
´ng
->
fÜtuÇ
.
poŞ
[´ng->fÜtuÇ.
poŞ_idx
], 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

195 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

196  
”r
;

198 ià(
´ng
->
fÜtuÇ
.
poŞ_idx
 == 0) {

199 
´ng
->
fÜtuÇ
.
poŞ0_Ën
 +ğ
šËn
;

201 ià(++(
´ng
->
fÜtuÇ
.
poŞ_idx
è=ğ
FORTUNA_POOLS
) {

202 
´ng
->
fÜtuÇ
.
poŞ_idx
 = 0;

205 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

206  
CRYPT_OK
;

207 
	}
}

214 
	$fÜtuÇ_»ady
(
´ng_¡©e
 *
´ng
)

216  
	`fÜtuÇ_»£ed
(
´ng
);

217 
	}
}

226 
	$fÜtuÇ_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
)

228 
tmp
[16];

229 
”r
;

230 
’
;

232 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

233 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

235 
	`LTC_MUTEX_LOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

238 ià(++
´ng
->
fÜtuÇ
.
wd
 =ğ
FORTUNA_WD
 ||…ºg->fÜtuÇ.
poŞ0_Ën
 >= 64) {

239 ià((
”r
 = 
	`fÜtuÇ_»£ed
(
´ng
)è!ğ
CRYPT_OK
) {

240 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

246 
’
 = 
ou’
;

249 
ou’
 >= 16) {

251 
	`rijnd«l_ecb_’üy±
(
´ng
->
fÜtuÇ
.
IV
, 
out
, &´ng->fÜtuÇ.
skey
);

252 
out
 += 16;

253 
ou’
 -= 16;

254 
	`fÜtuÇ_upd©e_iv
(
´ng
);

258 ià(
ou’
 > 0) {

259 
	`rijnd«l_ecb_’üy±
(
´ng
->
fÜtuÇ
.
IV
, 
tmp
, &´ng->fÜtuÇ.
skey
);

260 
	`XMEMCPY
(
out
, 
tmp
, 
ou’
);

261 
	`fÜtuÇ_upd©e_iv
(
´ng
);

265 
	`rijnd«l_ecb_’üy±
(
´ng
->
fÜtuÇ
.
IV
,…ºg->fÜtuÇ.
K
 , &´ng->fÜtuÇ.
skey
); 
	`fÜtuÇ_upd©e_iv
(prng);

266 
	`rijnd«l_ecb_’üy±
(
´ng
->
fÜtuÇ
.
IV
,…ºg->fÜtuÇ.
K
+16, &´ng->fÜtuÇ.
skey
); 
	`fÜtuÇ_upd©e_iv
(prng);

267 ià((
”r
 = 
	`rijnd«l_£tup
(
´ng
->
fÜtuÇ
.
K
, 32, 0, &´ng->fÜtuÇ.
skey
)è!ğ
CRYPT_OK
) {

268 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

272 #ifdeà
LTC_CLEAN_STACK


273 
	`z”omem
(
tmp
, (tmp));

275 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

276  
’
;

277 
	}
}

284 
	$fÜtuÇ_dÚe
(
´ng_¡©e
 *
´ng
)

286 
”r
, 
x
;

287 
tmp
[32];

289 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

290 
	`LTC_MUTEX_LOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

293 
x
 = 0; x < 
FORTUNA_POOLS
; x++) {

294 ià((
”r
 = 
	`sha256_dÚe
(&(
´ng
->
fÜtuÇ
.
poŞ
[
x
]), 
tmp
)è!ğ
CRYPT_OK
) {

295 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

296  
”r
;

301 #ifdeà
LTC_CLEAN_STACK


302 
	`z”omem
(
tmp
, (tmp));

305 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

306  
CRYPT_OK
;

307 
	}
}

316 
	$fÜtuÇ_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
)

318 
x
, 
”r
;

319 
hash_¡©e
 *
md
;

321 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

322 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

323 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

325 
	`LTC_MUTEX_LOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

328 ià(*
ou’
 < 32*
FORTUNA_POOLS
) {

329 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

330 *
ou’
 = 32*
FORTUNA_POOLS
;

331  
CRYPT_BUFFER_OVERFLOW
;

334 
md
 = 
	`XMALLOC
((
hash_¡©e
));

335 ià(
md
 =ğ
NULL
) {

336 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

337  
CRYPT_MEM
;

343 
x
 = 0; x < 
FORTUNA_POOLS
; x++) {

345 
	`XMEMCPY
(
md
, &(
´ng
->
fÜtuÇ
.
poŞ
[
x
]), (*md));

348 ià((
”r
 = 
	`sha256_dÚe
(
md
, 
out
+
x
*32)è!ğ
CRYPT_OK
) {

349 
LBL_ERR
;

353 ià((
”r
 = 
	`sha256_š™
(
md
)è!ğ
CRYPT_OK
) {

354 
LBL_ERR
;

356 ià((
”r
 = 
	`sha256_´oûss
(
md
, 
out
+
x
*32, 32)è!ğ
CRYPT_OK
) {

357 
LBL_ERR
;

359 ià((
”r
 = 
	`sha256_dÚe
(
md
, 
out
+
x
*32)è!ğ
CRYPT_OK
) {

360 
LBL_ERR
;

363 *
ou’
 = 32*
FORTUNA_POOLS
;

364 
”r
 = 
CRYPT_OK
;

366 
LBL_ERR
:

367 #ifdeà
LTC_CLEAN_STACK


368 
	`z”omem
(
md
, (*md));

370 
	`XFREE
(
md
);

371 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
fÜtuÇ
.
´ng_lock
);

372  
”r
;

373 
	}
}

382 
	$fÜtuÇ_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

384 
”r
, 
x
;

386 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

387 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

389 ià(
šËn
 !ğ32*
FORTUNA_POOLS
) {

390  
CRYPT_INVALID_ARG
;

393 ià((
”r
 = 
	`fÜtuÇ_¡¬t
(
´ng
)è!ğ
CRYPT_OK
) {

394  
”r
;

396 
x
 = 0; x < 
FORTUNA_POOLS
; x++) {

397 ià((
”r
 = 
	`fÜtuÇ_add_’Œİy
(
š
+
x
*32, 32, 
´ng
)è!ğ
CRYPT_OK
) {

398  
”r
;

401  
”r
;

402 
	}
}

408 
	$fÜtuÇ_‹¡
()

410 #iâdeà
LTC_TEST


411  
CRYPT_NOP
;

413 
”r
;

415 ià((
”r
 = 
	`sha256_‹¡
()è!ğ
CRYPT_OK
) {

416  
”r
;

418  
	`rijnd«l_‹¡
();

420 
	}
}

	@libtomcrypt/src/prngs/rc4.c

11 
	~"tomüy±.h
"

18 #ifdeà
RC4


20 cÚ¡ 
Éc_´ng_desütÜ
 
	grc4_desc
 =

23 &
rc4_¡¬t
,

24 &
rc4_add_’Œİy
,

25 &
rc4_»ady
,

26 &
rc4_»ad
,

27 &
rc4_dÚe
,

28 &
rc4_expÜt
,

29 &
rc4_impÜt
,

30 &
rc4_‹¡


38 
	$rc4_¡¬t
(
´ng_¡©e
 *
´ng
)

40 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

43 
´ng
->
rc4
.
x
 = 0;

45  
CRYPT_OK
;

46 
	}
}

55 
	$rc4_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

57 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

58 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

61 ià(
´ng
->
rc4
.
x
 + 
šËn
 > 256) {

62 ià(
´ng
->
rc4
.
x
 == 256) {

64  
CRYPT_OK
;

67 
šËn
 = 256 - 
´ng
->
rc4
.
x
;

71 
šËn
--) {

72 
´ng
->
rc4
.
buf
[´ng->rc4.
x
++] = *
š
++;

75  
CRYPT_OK
;

77 
	}
}

84 
	$rc4_»ady
(
´ng_¡©e
 *
´ng
)

86 
key
[256], 
tmp
, *
s
;

87 
keyËn
, 
x
, 
y
, 
j
;

89 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

92 
s
 = 
´ng
->
rc4
.
buf
;

93 
	`XMEMCPY
(
key
, 
s
, 256);

94 
keyËn
 = 
´ng
->
rc4
.
x
;

97 
x
 = 0; x < 256; x++) {

98 
s
[
x
] = x;

101 
j
 = 
x
 = 
y
 = 0; x < 256; x++) {

102 
y
 = (y + 
´ng
->
rc4
.
buf
[
x
] + 
key
[
j
++]) & 255;

103 ià(
j
 =ğ
keyËn
) {

104 
j
 = 0;

106 
tmp
 = 
s
[
x
]; s[x] = s[
y
]; s[y] =mp;

108 
´ng
->
rc4
.
x
 = 0;

109 
´ng
->
rc4
.
y
 = 0;

111 #ifdeà
LTC_CLEAN_STACK


112 
	`z”omem
(
key
, (key));

115  
CRYPT_OK
;

116 
	}
}

125 
	$rc4_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
)

127 
x
, 
y
, *
s
, 
tmp
;

128 
n
;

130 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

131 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

133 #ifdeà
LTC_VALGRIND


134 
	`z”omem
(
out
, 
ou’
);

137 
n
 = 
ou’
;

138 
x
 = 
´ng
->
rc4
.x;

139 
y
 = 
´ng
->
rc4
.y;

140 
s
 = 
´ng
->
rc4
.
buf
;

141 
ou’
--) {

142 
x
 = (x + 1) & 255;

143 
y
 = (y + 
s
[
x
]) & 255;

144 
tmp
 = 
s
[
x
]; s[x] = s[
y
]; s[y] =mp;

145 
tmp
 = (
s
[
x
] + s[
y
]) & 255;

146 *
out
++ ^ğ
s
[
tmp
];

148 
´ng
->
rc4
.
x
 = x;

149 
´ng
->
rc4
.
y
 = y;

150  
n
;

151 
	}
}

158 
	$rc4_dÚe
(
´ng_¡©e
 *
´ng
)

160 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

161  
CRYPT_OK
;

162 
	}
}

171 
	$rc4_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
)

173 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

174 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

175 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

177 ià(*
ou’
 < 32) {

178 *
ou’
 = 32;

179  
CRYPT_BUFFER_OVERFLOW
;

182 ià(
	`rc4_»ad
(
out
, 32, 
´ng
) != 32) {

183  
CRYPT_ERROR_READPRNG
;

185 *
ou’
 = 32;

187  
CRYPT_OK
;

188 
	}
}

197 
	$rc4_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

199 
”r
;

200 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

201 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

203 ià(
šËn
 != 32) {

204  
CRYPT_INVALID_ARG
;

207 ià((
”r
 = 
	`rc4_¡¬t
(
´ng
)è!ğ
CRYPT_OK
) {

208  
”r
;

210  
	`rc4_add_’Œİy
(
š
, 32, 
´ng
);

211 
	}
}

217 
	$rc4_‹¡
()

219 #ià!
	`defšed
(
LTC_TEST
è|| defšed(
LTC_VALGRIND
)

220  
CRYPT_NOP
;

223 
key
[8], 
±
[8], 
ù
[8];

224 } 
‹¡s
[] = {

231 
´ng_¡©e
 
´ng
;

232 
d¡
[8];

233 
”r
, 
x
;

235 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

236 ià((
”r
 = 
	`rc4_¡¬t
(&
´ng
)è!ğ
CRYPT_OK
) {

237  
”r
;

239 ià((
”r
 = 
	`rc4_add_’Œİy
(
‹¡s
[
x
].
key
, 8, &
´ng
)è!ğ
CRYPT_OK
) {

240  
”r
;

242 ià((
”r
 = 
	`rc4_»ady
(&
´ng
)è!ğ
CRYPT_OK
) {

243  
”r
;

245 
	`XMEMCPY
(
d¡
, 
‹¡s
[
x
].
±
, 8);

246 ià(
	`rc4_»ad
(
d¡
, 8, &
´ng
) != 8) {

247  
CRYPT_ERROR_READPRNG
;

249 
	`rc4_dÚe
(&
´ng
);

250 ià(
	`XMEMCMP
(
d¡
, 
‹¡s
[
x
].
ù
, 8)) {

252 
y
;

253 
	`´štf
("\n\nRC4 failed, I got:\n");

254 
y
 = 0; y < 8; y++è
	`´štf
("%02x ", 
d¡
[y]);

255 
	`´štf
("\n");

257  
CRYPT_FAIL_TESTVECTOR
;

260  
CRYPT_OK
;

262 
	}
}

	@libtomcrypt/src/prngs/rng_get_bytes.c

11 
	~"tomüy±.h
"

18 #ifdeà
DEVRANDOM


20 
ºg_nix
(*
buf
, 
Ën
,

21 (*
ÿÎback
)())

23 #ifdeà
LTC_NO_FILE


26 
FILE
 *
f
;

27 
x
;

28 #ifdeà
TRY_URANDOM_FIRST


29 
f
 = 
	`fİ’
("/dev/urandom", "rb");

30 ià(
f
 =ğ
NULL
)

32 
f
 = 
	`fİ’
("/dev/random", "rb");

34 ià(
f
 =ğ
NULL
) {

39 ià(
	`£tvbuf
(
f
, 
NULL
, 
_IONBF
, 0) != 0) {

40 
	`fşo£
(
f
);

44 
x
 = ()
	`ä—d
(
buf
, 1, (
size_t
)
Ën
, 
f
);

45 
	`fşo£
(
f
);

46  
x
;

48 
	}
}

53 #ià
defšed
(
CLOCKS_PER_SEC
è&& !defšed(
WINCE
)

55 
	#ANSI_RNG


	)

57 
ºg_ªsic
(*
buf
, 
Ën
,

58 (*
ÿÎback
)())

60 
şock_t
 
t1
;

61 
l
, 
acc
, 
b™s
, 
a
, 
b
;

63 ià(
XCLOCKS_PER_SEC
 < 100 || XCLOCKS_PER_SEC > 10000) {

67 
l
 = 
Ën
;

68 
b™s
 = 8;

69 
acc
 = 
a
 = 
b
 = 0;

70 
Ën
--) {

71 ià(
ÿÎback
 !ğ
NULL
è
	`ÿÎback
();

72 
b™s
--) {

74 
t1
 = 
	`XCLOCK
(); t1 =ğXCLOCK()è
a
 ^= 1;

75 
t1
 = 
	`XCLOCK
(); t1 =ğXCLOCK()è
b
 ^= 1;

76 } 
a
 =ğ
b
);

77 
acc
 = (acø<< 1è| 
a
;

79 *
buf
++ = 
acc
;

80 
acc
 = 0;

81 
b™s
 = 8;

83 
acc
 = 
b™s
 = 
a
 = 
b
 = 0;

84  
l
;

85 
	}
}

90 #ià
defšed
(
WIN32
è|| defšed(
WINCE
)

91 
	#_WIN32_WINNT
 0x0400

	)

92 #ifdeà
WINCE


93 
	#UNDER_CE


	)

94 
	#ARM


	)

96 
	~<wšdows.h
>

97 
	~<wšüy±.h
>

99 
ºg_wš32
(*
buf
, 
Ën
,

100 (*
ÿÎback
)())

102 
HCRYPTPROV
 
hProv
 = 0;

103 ià(!
	`Cry±AcquœeCÚ‹xt
(&
hProv
, 
NULL
, 
MS_DEF_PROV
, 
PROV_RSA_FULL
,

104 (
CRYPT_VERIFYCONTEXT
 | 
CRYPT_MACHINE_KEYSET
)) &&

105 !
	`Cry±AcquœeCÚ‹xt
 (&
hProv
, 
NULL
, 
MS_DEF_PROV
, 
PROV_RSA_FULL
,

106 
CRYPT_VERIFYCONTEXT
 | 
CRYPT_MACHINE_KEYSET
 | 
CRYPT_NEWKEYSET
))

109 ià(
	`Cry±G’Rªdom
(
hProv
, 
Ën
, 
buf
è=ğ
TRUE
) {

110 
	`Cry±R–—£CÚ‹xt
(
hProv
, 0);

111  
Ën
;

113 
	`Cry±R–—£CÚ‹xt
(
hProv
, 0);

116 
	}
}

127 
ºg_g‘_by‹s
(*
out
, 
ou’
,

128 (*
ÿÎback
)())

130 
x
;

132 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

134 #ià
	`defšed
(
DEVRANDOM
)

135 
x
 = 
	`ºg_nix
(
out
, 
ou’
, 
ÿÎback
); if (x != 0) {  x; }

137 #ifdeà
WIN32


138 
x
 = 
	`ºg_wš32
(
out
, 
ou’
, 
ÿÎback
); if (x != 0) {  x; }

140 #ifdeà
ANSI_RNG


141 
x
 = 
	`ºg_ªsic
(
out
, 
ou’
, 
ÿÎback
); if (x != 0) {  x; }

144 
	}
}

	@libtomcrypt/src/prngs/rng_make_prng.c

11 
	~"tomüy±.h
"

26 
ºg_make_´ng
(
b™s
, 
w´ng
, 
´ng_¡©e
 *
´ng
,

27 (*
ÿÎback
)())

29 
buf
[256];

30 
”r
;

32 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

35 ià((
”r
 = 
	`´ng_is_v®id
(
w´ng
)è!ğ
CRYPT_OK
) {

36  
”r
;

39 ià(
b™s
 < 64 || bits > 1024) {

40  
CRYPT_INVALID_PRNGSIZE
;

43 ià((
”r
 = 
´ng_desütÜ
[
w´ng
].
	`¡¬t
(
´ng
)è!ğ
CRYPT_OK
) {

44  
”r
;

47 
b™s
 = ((bits/8)+((bits&7)!=0?1:0)) * 2;

48 ià(
	`ºg_g‘_by‹s
(
buf
, ()
b™s
, 
ÿÎback
) != ()bits) {

49  
CRYPT_ERROR_READPRNG
;

52 ià((
”r
 = 
´ng_desütÜ
[
w´ng
].
	`add_’Œİy
(
buf
, ()
b™s
, 
´ng
)è!ğ
CRYPT_OK
) {

53  
”r
;

56 ià((
”r
 = 
´ng_desütÜ
[
w´ng
].
	`»ady
(
´ng
)è!ğ
CRYPT_OK
) {

57  
”r
;

60 #ifdeà
LTC_CLEAN_STACK


61 
	`z”omem
(
buf
, (buf));

63  
CRYPT_OK
;

64 
	}
}

	@libtomcrypt/src/prngs/sober128.c

11 
	~"tomüy±.h
"

19 #ifdeà
SOBER128


21 
	~"sob”128b.c
"

23 cÚ¡ 
Éc_´ng_desütÜ
 
	gsob”128_desc
 =

26 &
sob”128_¡¬t
,

27 &
sob”128_add_’Œİy
,

28 &
sob”128_»ady
,

29 &
sob”128_»ad
,

30 &
sob”128_dÚe
,

31 &
sob”128_expÜt
,

32 &
sob”128_impÜt
,

33 &
sob”128_‹¡


37 
	#N
 17

	)

38 
	#FOLD
 
N


	)

39 
	#INITKONST
 0x6996c53¨

	)

40 
	#KEYP
 15

	)

41 
	#FOLDP
 4

	)

43 
	#B
(
x
,
i
è(()(((xè>> (8*i)è& 0xFF))

	)

45 
ulÚg32
 
	$BYTE2WORD
(*
b
)

47 
ulÚg32
 
t
;

48 
	`LOAD32L
(
t
, 
b
);

49  
t
;

50 
	}
}

52 
	#WORD2BYTE
(
w
, 
b
è
	`STORE32L
(b, w)

	)

54 
	$XORWORD
(
ulÚg32
 
w
, *
b
)

56 
ulÚg32
 
t
;

57 
	`LOAD32L
(
t
, 
b
);

58 
t
 ^ğ
w
;

59 
	`STORE32L
(
t
, 
b
);

60 
	}
}

65 
	#OFF
(
z”o
, 
i
è(((z”o)+(i)è% 
N
)

	)

69 
	#STEP
(
R
,
z
) \

70 
R
[
	`OFF
(
z
,0)] = R[OFF(z,15)] ^ R[OFF(z,4)] ^ (R[OFF(z,0)] << 8è^ 
MuÉab
[(R[OFF(z,0)] >> 24è& 0xFF];

	)

72 
	$cyşe
(
ulÚg32
 *
R
)

74 
ulÚg32
 
t
;

75 
i
;

77 
	`STEP
(
R
,0);

78 
t
 = 
R
[0];

79 
i
 = 1; i < 
N
; ++i) {

80 
R
[
i
-1] = R[i];

82 
R
[
N
-1] = 
t
;

83 
	}
}

87 
	#NLFUNC
(
c
,
z
) \

89 
t
 = 
c
->
R
[
	`OFF
(
z
,0)] + c->R[OFF(z,16)]; \

90 
t
 ^ğ
Sbox
[(t >> 24) & 0xFF]; \

91 
t
 = 
	`RORc
(t, 8); \

92 
t
 = (Ñ + 
c
->
R
[
	`OFF
(
z
,1)]è^ c->
kÚ¡
) + c->R[OFF(z,6)]; \

93 
t
 ^ğ
Sbox
[(t >> 24) & 0xFF]; \

94 
t
 = + 
c
->
R
[
	`OFF
(
z
,13)]; \

95 }

	)

97 
ulÚg32
 
	$Æp
(
sob”128_´ng
 *
c
)

99 
ulÚg32
 
t
;

100 
	`NLFUNC
(
c
, 0);

101  
t
;

102 
	}
}

109 
	$sob”128_¡¬t
(
´ng_¡©e
 *
´ng
)

111 
i
;

112 
sob”128_´ng
 *
c
;

114 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

116 
c
 = &(
´ng
->
sob”128
);

119 
c
->
R
[0] = 1;

120 
c
->
R
[1] = 1;

121 
i
 = 2; i < 
N
; ++i) {

122 
c
->
R
[
i
] = c->R[i-1] + c->R[i-2];

124 
c
->
kÚ¡
 = 
INITKONST
;

127 
c
->
æag
 = 1;

128 
c
->
£t
 = 0;

130  
CRYPT_OK
;

131 
	}
}

135 
	$s128_§ve¡©e
(
sob”128_´ng
 *
c
)

137 
i
;

138 
i
 = 0; i < 
N
; ++i) {

139 
c
->
š™R
[
i
] = c->
R
[i];

141 
	}
}

145 
	$s128_»lßd¡©e
(
sob”128_´ng
 *
c
)

147 
i
;

149 
i
 = 0; i < 
N
; ++i) {

150 
c
->
R
[
i
] = c->
š™R
[i];

152 
	}
}

156 
	$s128_g’kÚ¡
(
sob”128_´ng
 *
c
)

158 
ulÚg32
 
ÃwkÚ¡
;

161 
	`cyşe
(
c
->
R
);

162 
ÃwkÚ¡
 = 
	`Æp
(
c
);

163 } (
ÃwkÚ¡
 & 0xFF000000) == 0);

164 
c
->
kÚ¡
 = 
ÃwkÚ¡
;

165 
	}
}

169 
	#ADDKEY
(
k
) \

170 
c
->
R
[
KEYP
] +ğ(
k
);

	)

172 
	#XORNL
(
Æ
) \

173 
c
->
R
[
FOLDP
] ^ğ(
Æ
);

	)

176 
	#DROUND
(
z
è
	`STEP
(
c
->
R
,z); 
	`NLFUNC
(c,(z+1)); c->R[
	`OFF
((z+1),
FOLDP
)] ^ğ
t
;

	)

177 
	$s128_diffu£
(
sob”128_´ng
 *
c
)

179 
ulÚg32
 
t
;

181 
	`DROUND
(0);

182 
	`DROUND
(1);

183 
	`DROUND
(2);

184 
	`DROUND
(3);

185 
	`DROUND
(4);

186 
	`DROUND
(5);

187 
	`DROUND
(6);

188 
	`DROUND
(7);

189 
	`DROUND
(8);

190 
	`DROUND
(9);

191 
	`DROUND
(10);

192 
	`DROUND
(11);

193 
	`DROUND
(12);

194 
	`DROUND
(13);

195 
	`DROUND
(14);

196 
	`DROUND
(15);

197 
	`DROUND
(16);

198 
	}
}

207 
	$sob”128_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

209 
sob”128_´ng
 *
c
;

210 
ulÚg32
 
i
, 
k
;

212 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

213 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

214 
c
 = &(
´ng
->
sob”128
);

216 ià(
c
->
æag
 == 1) {

219 ià((
šËn
 & 3) != 0) {

220  
CRYPT_INVALID_KEYSIZE
;

223 
i
 = 0; i < 
šËn
; i += 4) {

224 
k
 = 
	`BYTE2WORD
((*)&
š
[
i
]);

225 
	`ADDKEY
(
k
);

226 
	`cyşe
(
c
->
R
);

227 
	`XORNL
(
	`Æp
(
c
));

231 
	`ADDKEY
(
šËn
);

234 
	`s128_diffu£
(
c
);

236 
	`s128_g’kÚ¡
(
c
);

237 
	`s128_§ve¡©e
(
c
);

238 
c
->
nbuf
 = 0;

239 
c
->
æag
 = 0;

240 
c
->
£t
 = 1;

243 
	`s128_»lßd¡©e
(
c
);

246 ià((
šËn
 & 3) != 0) {

247  
CRYPT_INVALID_KEYSIZE
;

250 
i
 = 0; i < 
šËn
; i += 4) {

251 
k
 = 
	`BYTE2WORD
((*)&
š
[
i
]);

252 
	`ADDKEY
(
k
);

253 
	`cyşe
(
c
->
R
);

254 
	`XORNL
(
	`Æp
(
c
));

258 
	`ADDKEY
(
šËn
);

261 
	`s128_diffu£
(
c
);

262 
c
->
nbuf
 = 0;

265  
CRYPT_OK
;

266 
	}
}

273 
	$sob”128_»ady
(
´ng_¡©e
 *
´ng
)

275  
´ng
->
sob”128
.
£t
 =ğ1 ? 
CRYPT_OK
 : 
CRYPT_ERROR
;

276 
	}
}

280 
	#SROUND
(
z
è
	`STEP
(
c
->
R
,z); 
	`NLFUNC
(c,(z+1)); 
	`XORWORD
(
t
, 
out
+(z*4));

	)

289 
	$sob”128_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
)

291 
sob”128_´ng
 *
c
;

292 
ulÚg32
 
t
, 
’
;

294 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

295 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

297 #ifdeà
LTC_VALGRIND


298 
	`z”omem
(
out
, 
ou’
);

301 
c
 = &(
´ng
->
sob”128
);

302 
t
 = 0;

303 
’
 = 
ou’
;

306 
c
->
nbuf
 !ğ0 && 
ou’
 != 0) {

307 *
out
++ ^ğ
c
->
sbuf
 & 0xFF;

308 
c
->
sbuf
 >>= 8;

309 
c
->
nbuf
 -= 8;

310 --
ou’
;

313 #iâdeà
LTC_SMALL_CODE


315 
ou’
 >ğ
N
*4) {

316 
	`SROUND
(0);

317 
	`SROUND
(1);

318 
	`SROUND
(2);

319 
	`SROUND
(3);

320 
	`SROUND
(4);

321 
	`SROUND
(5);

322 
	`SROUND
(6);

323 
	`SROUND
(7);

324 
	`SROUND
(8);

325 
	`SROUND
(9);

326 
	`SROUND
(10);

327 
	`SROUND
(11);

328 
	`SROUND
(12);

329 
	`SROUND
(13);

330 
	`SROUND
(14);

331 
	`SROUND
(15);

332 
	`SROUND
(16);

333 
out
 +ğ4*
N
;

334 
ou’
 -ğ4*
N
;

339 4 <ğ
ou’
) {

340 
	`cyşe
(
c
->
R
);

341 
t
 = 
	`Æp
(
c
);

342 
	`XORWORD
(
t
, 
out
);

343 
out
 += 4;

344 
ou’
 -= 4;

348 ià(
ou’
 != 0) {

349 
	`cyşe
(
c
->
R
);

350 
c
->
sbuf
 = 
	`Æp
(c);

351 
c
->
nbuf
 = 32;

352 
c
->
nbuf
 !ğ0 && 
ou’
 != 0) {

353 *
out
++ ^ğ
c
->
sbuf
 & 0xFF;

354 
c
->
sbuf
 >>= 8;

355 
c
->
nbuf
 -= 8;

356 --
ou’
;

360  
’
;

361 
	}
}

368 
	$sob”128_dÚe
(
´ng_¡©e
 *
´ng
)

370 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

371  
CRYPT_OK
;

372 
	}
}

381 
	$sob”128_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
)

383 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

384 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

385 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

387 ià(*
ou’
 < 64) {

388 *
ou’
 = 64;

389  
CRYPT_BUFFER_OVERFLOW
;

392 ià(
	`sob”128_»ad
(
out
, 64, 
´ng
) != 64) {

393  
CRYPT_ERROR_READPRNG
;

395 *
ou’
 = 64;

397  
CRYPT_OK
;

398 
	}
}

407 
	$sob”128_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

409 
”r
;

410 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

411 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

413 ià(
šËn
 != 64) {

414  
CRYPT_INVALID_ARG
;

417 ià((
”r
 = 
	`sob”128_¡¬t
(
´ng
)è!ğ
CRYPT_OK
) {

418  
”r
;

420 ià((
”r
 = 
	`sob”128_add_’Œİy
(
š
, 64, 
´ng
)è!ğ
CRYPT_OK
) {

421  
”r
;

423  
	`sob”128_»ady
(
´ng
);

424 
	}
}

430 
	$sob”128_‹¡
()

432 #iâdeà
LTC_TEST


433  
CRYPT_NOP
;

436 
keyËn
, 
ivËn
, 
Ën
;

437 
key
[16], 
iv
[4], 
out
[20];

438 } 
‹¡s
[] = {

457 
´ng_¡©e
 
´ng
;

458 
d¡
[20];

459 
”r
, 
x
;

461 
x
 = 0; x < ()((
‹¡s
)/(tests[0])); x++) {

462 ià((
”r
 = 
	`sob”128_¡¬t
(&
´ng
)è!ğ
CRYPT_OK
) {

463  
”r
;

465 ià((
”r
 = 
	`sob”128_add_’Œİy
(
‹¡s
[
x
].
key
,e¡s[x].
keyËn
, &
´ng
)è!ğ
CRYPT_OK
) {

466  
”r
;

469 ià((
”r
 = 
	`sob”128_add_’Œİy
(
‹¡s
[
x
].
iv
,e¡s[x].
ivËn
, &
´ng
)è!ğ
CRYPT_OK
) {

470  
”r
;

474 ià((
”r
 = 
	`sob”128_»ady
(&
´ng
)è!ğ
CRYPT_OK
) {

475  
”r
;

477 
	`XMEMSET
(
d¡
, 0, 
‹¡s
[
x
].
Ën
);

478 ià(
	`sob”128_»ad
(
d¡
, 
‹¡s
[
x
].
Ën
, &
´ng
) != ()tests[x].len) {

479  
CRYPT_ERROR_READPRNG
;

481 
	`sob”128_dÚe
(&
´ng
);

482 ià(
	`XMEMCMP
(
d¡
, 
‹¡s
[
x
].
out
,e¡s[x].
Ën
)) {

484 
	`´štf
("\n\nSOBER128 failed, I got:\n");

485 
y
 = 0; y < 
‹¡s
[
x
].
Ën
; y++è
	`´štf
("%02x ", 
d¡
[y]);

486 
	`´štf
("\n");

488  
CRYPT_FAIL_TESTVECTOR
;

491  
CRYPT_OK
;

493 
	}
}

	@libtomcrypt/src/prngs/sober128tab.c

8 cÚ¡ 
ulÚg32
 
	gMuÉab
[256] = {

93 cÚ¡ 
ulÚg32
 
	gSbox
[256] = {

	@libtomcrypt/src/prngs/sprng.c

11 
	~"tomüy±.h
"

23 #ifdeà
SPRNG


25 cÚ¡ 
Éc_´ng_desütÜ
 
	g¥ºg_desc
 =

28 &
¥ºg_¡¬t
,

29 &
¥ºg_add_’Œİy
,

30 &
¥ºg_»ady
,

31 &
¥ºg_»ad
,

32 &
¥ºg_dÚe
,

33 &
¥ºg_expÜt
,

34 &
¥ºg_impÜt
,

35 &
¥ºg_‹¡


43 
	$¥ºg_¡¬t
(
´ng_¡©e
 *
´ng
)

45  
CRYPT_OK
;

46 
	}
}

55 
	$¥ºg_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

57  
CRYPT_OK
;

58 
	}
}

65 
	$¥ºg_»ady
(
´ng_¡©e
 *
´ng
)

67  
CRYPT_OK
;

68 
	}
}

77 
	$¥ºg_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
)

79 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

80  
	`ºg_g‘_by‹s
(
out
, 
ou’
, 
NULL
);

81 
	}
}

88 
	$¥ºg_dÚe
(
´ng_¡©e
 *
´ng
)

90  
CRYPT_OK
;

91 
	}
}

100 
	$¥ºg_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
)

102 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

104 *
ou’
 = 0;

105  
CRYPT_OK
;

106 
	}
}

115 
	$¥ºg_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

117  
CRYPT_OK
;

118 
	}
}

124 
	$¥ºg_‹¡
()

126  
CRYPT_OK
;

127 
	}
}

	@libtomcrypt/src/prngs/yarrow.c

11 
	~"tomüy±.h
"

18 #ifdeà
YARROW


20 cÚ¡ 
Éc_´ng_desütÜ
 
	gy¬row_desc
 =

23 &
y¬row_¡¬t
,

24 &
y¬row_add_’Œİy
,

25 &
y¬row_»ady
,

26 &
y¬row_»ad
,

27 &
y¬row_dÚe
,

28 &
y¬row_expÜt
,

29 &
y¬row_impÜt
,

30 &
y¬row_‹¡


38 
	$y¬row_¡¬t
(
´ng_¡©e
 *
´ng
)

40 
”r
;

42 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

45 #ifdeà
RIJNDAEL


46 #ià 
YARROW_AES
==0

47 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
rijnd«l_’c_desc
);

48 #–ià 
YARROW_AES
==1

49 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
«s_’c_desc
);

50 #–ià 
YARROW_AES
==2

51 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
rijnd«l_desc
);

52 #–ià 
YARROW_AES
==3

53 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
«s_desc
);

55 #–ià
	`defšed
(
BLOWFISH
)

56 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
blowfish_desc
);

57 #–ià
	`defšed
(
TWOFISH
)

58 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
twofish_desc
);

59 #–ià
	`defšed
(
RC6
)

60 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
rc6_desc
);

61 #–ià
	`defšed
(
RC5
)

62 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
rc5_desc
);

63 #–ià
	`defšed
(
SAFERP
)

64 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
§ã½_desc
);

65 #–ià
	`defšed
(
RC2
)

66 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
rc2_desc
);

67 #–ià
	`defšed
(
NOEKEON
)

68 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
nÛkeÚ_desc
);

69 #–ià
	`defšed
(
ANUBIS
)

70 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
ªubis_desc
);

71 #–ià
	`defšed
(
KSEED
)

72 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
k£ed_desc
);

73 #–ià
	`defšed
(
KHAZAD
)

74 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
khazad_desc
);

75 #–ià
	`defšed
(
CAST5
)

76 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
ÿ¡5_desc
);

77 #–ià
	`defšed
(
XTEA
)

78 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
x‹a_desc
);

79 #–ià
	`defšed
(
SAFER
)

80 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
§ãr_sk128_desc
);

81 #–ià
	`defšed
(
DES
)

82 
´ng
->
y¬row
.
ch”
 = 
	`»gi¡”_ch”
(&
des3_desc
);

84 #”rÜ 
YARROW
 
Ãeds
 
©
 
Ëa¡
 
Úe
 
CIPHER


86 ià((
”r
 = 
	`ch”_is_v®id
(
´ng
->
y¬row
.
ch”
)è!ğ
CRYPT_OK
) {

87  
”r
;

90 #ifdeà
SHA256


91 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
sha256_desc
);

92 #–ià
	`defšed
(
SHA512
)

93 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
sha512_desc
);

94 #–ià
	`defšed
(
TIGER
)

95 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
tig”_desc
);

96 #–ià
	`defšed
(
SHA1
)

97 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
sha1_desc
);

98 #–ià
	`defšed
(
RIPEMD320
)

99 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
rmd320_desc
);

100 #–ià
	`defšed
(
RIPEMD256
)

101 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
rmd256_desc
);

102 #–ià
	`defšed
(
RIPEMD160
)

103 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
rmd160_desc
);

104 #–ià
	`defšed
(
RIPEMD128
)

105 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
rmd128_desc
);

106 #–ià
	`defšed
(
MD5
)

107 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
md5_desc
);

108 #–ià
	`defšed
(
MD4
)

109 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
md4_desc
);

110 #–ià
	`defšed
(
MD2
)

111 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
md2_desc
);

112 #–ià
	`defšed
(
WHIRLPOOL
)

113 
´ng
->
y¬row
.
hash
 = 
	`»gi¡”_hash
(&
whœÍoŞ_desc
);

115 #”rÜ 
YARROW
 
Ãeds
 
©
 
Ëa¡
 
Úe
 
HASH


117 ià((
”r
 = 
	`hash_is_v®id
(
´ng
->
y¬row
.
hash
)è!ğ
CRYPT_OK
) {

118  
”r
;

122 
	`z”omem
(
´ng
->
y¬row
.
poŞ
, (prng->yarrow.pool));

123 
	`LTC_MUTEX_INIT
(&
´ng
->
y¬row
.
´ng_lock
)

125  
CRYPT_OK
;

126 
	}
}

135 
	$y¬row_add_’Œİy
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

137 
hash_¡©e
 
md
;

138 
”r
;

140 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

141 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

143 
	`LTC_MUTEX_LOCK
(&
´ng
->
y¬row
.
´ng_lock
);

145 ià((
”r
 = 
	`hash_is_v®id
(
´ng
->
y¬row
.
hash
)è!ğ
CRYPT_OK
) {

146 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

147  
”r
;

151 ià((
”r
 = 
hash_desütÜ
[
´ng
->
y¬row
.
hash
].
	`š™
(&
md
)è!ğ
CRYPT_OK
) {

152 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

153  
”r
;

157 ià((
”r
 = 
hash_desütÜ
[
´ng
->
y¬row
.
hash
].
	`´oûss
(&
md
,…ºg->y¬row.
poŞ
,

158 
hash_desütÜ
[
´ng
->
y¬row
.
hash
].
hashsize
)è!ğ
CRYPT_OK
) {

159 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

160  
”r
;

164 ià((
”r
 = 
hash_desütÜ
[
´ng
->
y¬row
.
hash
].
	`´oûss
(&
md
, 
š
, 
šËn
)è!ğ
CRYPT_OK
) {

165 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

166  
”r
;

170 ià((
”r
 = 
hash_desütÜ
[
´ng
->
y¬row
.
hash
].
	`dÚe
(&
md
,…ºg->y¬row.
poŞ
)è!ğ
CRYPT_OK
) {

171 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

172  
”r
;

175 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

176  
CRYPT_OK
;

177 
	}
}

184 
	$y¬row_»ady
(
´ng_¡©e
 *
´ng
)

186 
ks
, 
”r
;

188 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

189 
	`LTC_MUTEX_LOCK
(&
´ng
->
y¬row
.
´ng_lock
);

191 ià((
”r
 = 
	`hash_is_v®id
(
´ng
->
y¬row
.
hash
)è!ğ
CRYPT_OK
) {

192 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

193  
”r
;

196 ià((
”r
 = 
	`ch”_is_v®id
(
´ng
->
y¬row
.
ch”
)è!ğ
CRYPT_OK
) {

197 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

198  
”r
;

202 
ks
 = ()
hash_desütÜ
[
´ng
->
y¬row
.
hash
].
hashsize
;

203 ià((
”r
 = 
ch”_desütÜ
[
´ng
->
y¬row
.
ch”
].
	`keysize
(&
ks
)è!ğ
CRYPT_OK
) {

204 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

205  
”r
;

208 ià((
”r
 = 
	`ùr_¡¬t
(
´ng
->
y¬row
.
ch”
,

209 
´ng
->
y¬row
.
poŞ
,

210 
´ng
->
y¬row
.
poŞ
, 
ks
,

212 
CTR_COUNTER_LITTLE_ENDIAN
,

213 &
´ng
->
y¬row
.
ùr
)è!ğ
CRYPT_OK
) {

214 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

215  
”r
;

217 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

218  
CRYPT_OK
;

219 
	}
}

228 
	$y¬row_»ad
(*
out
, 
ou’
, 
´ng_¡©e
 *
´ng
)

230 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

231 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

233 
	`LTC_MUTEX_LOCK
(&
´ng
->
y¬row
.
´ng_lock
);

236 
	`z”omem
(
out
, 
ou’
);

239 ià(
	`ùr_’üy±
(
out
, out, 
ou’
, &
´ng
->
y¬row
.
ùr
è!ğ
CRYPT_OK
) {

240 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

243 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

244  
ou’
;

245 
	}
}

252 
	$y¬row_dÚe
(
´ng_¡©e
 *
´ng
)

254 
”r
;

255 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

257 
	`LTC_MUTEX_LOCK
(&
´ng
->
y¬row
.
´ng_lock
);

262 
”r
 = 
	`ùr_dÚe
(&
´ng
->
y¬row
.
ùr
);

264 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

265  
”r
;

266 
	}
}

275 
	$y¬row_expÜt
(*
out
, *
ou’
, 
´ng_¡©e
 *
´ng
)

277 
	`LTC_ARGCHK
(
out
 !ğ
NULL
);

278 
	`LTC_ARGCHK
(
ou’
 !ğ
NULL
);

279 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

281 
	`LTC_MUTEX_LOCK
(&
´ng
->
y¬row
.
´ng_lock
);

284 ià(*
ou’
 < 64) {

285 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

286 *
ou’
 = 64;

287  
CRYPT_BUFFER_OVERFLOW
;

290 ià(
	`y¬row_»ad
(
out
, 64, 
´ng
) != 64) {

291 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

292  
CRYPT_ERROR_READPRNG
;

294 *
ou’
 = 64;

296  
CRYPT_OK
;

297 
	}
}

306 
	$y¬row_impÜt
(cÚ¡ *
š
, 
šËn
, 
´ng_¡©e
 *
´ng
)

308 
”r
;

310 
	`LTC_ARGCHK
(
š
 !ğ
NULL
);

311 
	`LTC_ARGCHK
(
´ng
 !ğ
NULL
);

313 
	`LTC_MUTEX_LOCK
(&
´ng
->
y¬row
.
´ng_lock
);

315 ià(
šËn
 != 64) {

316 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

317  
CRYPT_INVALID_ARG
;

320 ià((
”r
 = 
	`y¬row_¡¬t
(
´ng
)è!ğ
CRYPT_OK
) {

321 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

322  
”r
;

324 
”r
 = 
	`y¬row_add_’Œİy
(
š
, 64, 
´ng
);

325 
	`LTC_MUTEX_UNLOCK
(&
´ng
->
y¬row
.
´ng_lock
);

326  
”r
;

327 
	}
}

333 
	$y¬row_‹¡
()

335 #iâdeà
LTC_TEST


336  
CRYPT_NOP
;

338 
”r
;

339 
´ng_¡©e
 
´ng
;

341 ià((
”r
 = 
	`y¬row_¡¬t
(&
´ng
)è!ğ
CRYPT_OK
) {

342  
”r
;

346 ià((
”r
 = 
ch”_desütÜ
[
´ng
.
y¬row
.
ch”
].
	`‹¡
()è!ğ
CRYPT_OK
) {

347  
”r
;

349 ià((
”r
 = 
hash_desütÜ
[
´ng
.
y¬row
.
hash
].
	`‹¡
()è!ğ
CRYPT_OK
) {

350  
”r
;

353  
CRYPT_OK
;

355 
	}
}

	@libtomcrypt/testprof/base64_test.c

1 
	~<tomüy±_‹¡.h
>

3 
	$ba£64_‹¡
()

5 
š
[64], 
out
[256], 
tmp
[64];

6 
x
, 
l1
, 
l2
;

8 
x
 = 0; x < 64; x++) {

9 
	`y¬row_»ad
(
š
, 
x
, &
y¬row_´ng
);

10 
l1
 = (
out
);

11 
	`DO
(
	`ba£64_’code
(
š
, 
x
, 
out
, &
l1
));

12 
l2
 = (
tmp
);

13 
	`DO
(
	`ba£64_decode
(
out
, 
l1
, 
tmp
, &
l2
));

14 ià(
l2
 !ğ
x
 || 
	`memcmp
(
tmp
, 
š
, x)) {

15 
	`årštf
(
¡d”r
, "ba£64 faed %lu %lu %lu", 
x
, 
l1
, 
l2
);

20 
	}
}

	@libtomcrypt/testprof/cipher_hash_test.c

3 
	~<tomüy±_‹¡.h
>

5 
	$ch”_hash_‹¡
()

7 
x
;

8 
buf
[4096];

9 
n
;

10 
´ng_¡©e
 
Åºg
;

13 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

14 
	`DO
(
ch”_desütÜ
[
x
].
	`‹¡
());

18 
x
 = 0; 
hash_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

19 
	`DO
(
hash_desütÜ
[
x
].
	`‹¡
());

23 
x
 = 0; 
´ng_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

24 
	`DO
(
´ng_desütÜ
[
x
].
	`‹¡
());

25 
	`DO
(
´ng_desütÜ
[
x
].
	`¡¬t
(&
Åºg
));

26 
	`DO
(
´ng_desütÜ
[
x
].
	`add_’Œİy
((*)"h–lowÜld12", 12, &
Åºg
));

27 
	`DO
(
´ng_desütÜ
[
x
].
	`»ady
(&
Åºg
));

28 
n
 = (
buf
);

29 
	`DO
(
´ng_desütÜ
[
x
].
	`³xpÜt
(
buf
, &
n
, &
Åºg
));

30 
´ng_desütÜ
[
x
].
	`dÚe
(&
Åºg
);

31 
	`DO
(
´ng_desütÜ
[
x
].
	`pimpÜt
(
buf
, 
n
, &
Åºg
));

32 
	`DO
(
´ng_desütÜ
[
x
].
	`»ady
(&
Åºg
));

33 ià(
´ng_desütÜ
[
x
].
	`»ad
(
buf
, 100, &
Åºg
) != 100) {

34 
	`årštf
(
¡d”r
, "Error„eading from imported PRNG!\n");

35 
	`ex™
(
EXIT_FAILURE
);

37 
´ng_desütÜ
[
x
].
	`dÚe
(&
Åºg
);

41 
	}
}

	@libtomcrypt/testprof/der_tests.c

1 
	~<tomüy±_‹¡.h
>

2 #ià
defšed
(
GMP_DESC
è|| defšed(
USE_GMP
)

3 
	~<gmp.h
>

6 #iâdeà
LTC_DER


8 
	$d”_‹¡s
()

10 
	`årštf
(
¡d”r
, "NOP");

12 
	}
}

16 
	$d”_£t_‹¡
()

18 
Éc_a¢1_li¡
 
li¡
[10];

19 cÚ¡ 
où_¡r
[] = { 1, 2, 3, 4 };

20 cÚ¡ 
bš_¡r
[] = { 1, 0, 0, 1 };

21 cÚ¡ 
št_v®
 = 12345678UL;

23 
¡rs
[10][10], 
outbuf
[128];

24 
x
, 
v®
, 
ou’
;

25 
”r
;

28 
	`LTC_SET_ASN1
(
li¡
, 0, 
LTC_ASN1_OCTET_STRING
, 
où_¡r
, (oct_str));

29 
	`LTC_SET_ASN1
(
li¡
, 1, 
LTC_ASN1_BIT_STRING
, 
bš_¡r
, (bin_str));

30 
	`LTC_SET_ASN1
(
li¡
, 2, 
LTC_ASN1_SHORT_INTEGER
, &
št_v®
, 1);

33 
ou’
 = (
outbuf
);

34 ià((
”r
 = 
	`d”_’code_£t
(
li¡
, 3, 
outbuf
, &
ou’
)è!ğ
CRYPT_OK
) {

35 
	`årštf
(
¡d”r
, "”rÜƒncodšg s‘: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

36 
	`ex™
(
EXIT_FAILURE
);

41 
	`LTC_SET_ASN1
(
li¡
, 0, 
LTC_ASN1_BIT_STRING
, 
¡rs
[1], (strs[1]));

42 
	`LTC_SET_ASN1
(
li¡
, 1, 
LTC_ASN1_SHORT_INTEGER
, &
v®
, 1);

43 
	`LTC_SET_ASN1
(
li¡
, 2, 
LTC_ASN1_OCTET_STRING
, 
¡rs
[0], (strs[0]));

45 ià((
”r
 = 
	`d”_decode_£t
(
outbuf
, 
ou’
, 
li¡
, 3)è!ğ
CRYPT_OK
) {

46 
	`årštf
(
¡d”r
, "”rÜ decodšg s‘ usšg d”_decode_£t: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

47 
	`ex™
(
EXIT_FAILURE
);

51 ià(
	`memcmp
(
¡rs
[0], 
où_¡r
, (oct_str))) {

52 
	`årštf
(
¡d”r
, "error decoding set using der_decode_set (oct_str is wrong):\n");

53 
	`ex™
(
EXIT_FAILURE
);

56 ià(
	`memcmp
(
¡rs
[1], 
bš_¡r
, (bin_str))) {

57 
	`årštf
(
¡d”r
, "error decoding set using der_decode_set (bin_str is wrong):\n");

58 
	`ex™
(
EXIT_FAILURE
);

61 ià(
v®
 !ğ
št_v®
) {

62 
	`årštf
(
¡d”r
, "error decoding set using der_decode_set (int_val is wrong):\n");

63 
	`ex™
(
EXIT_FAILURE
);

66 
	`¡rıy
((*)
¡rs
[0], "one");

67 
	`¡rıy
((*)
¡rs
[1], "one2");

68 
	`¡rıy
((*)
¡rs
[2], "two");

69 
	`¡rıy
((*)
¡rs
[3], "aaa");

70 
	`¡rıy
((*)
¡rs
[4], "aaaa");

71 
	`¡rıy
((*)
¡rs
[5], "aab");

72 
	`¡rıy
((*)
¡rs
[6], "aaab");

73 
	`¡rıy
((*)
¡rs
[7], "bbb");

74 
	`¡rıy
((*)
¡rs
[8], "bbba");

75 
	`¡rıy
((*)
¡rs
[9], "bbbb");

77 
x
 = 0; x < 10; x++) {

78 
	`LTC_SET_ASN1
(
li¡
, 
x
, 
LTC_ASN1_PRINTABLE_STRING
, 
¡rs
[x], 
	`¡¾’
((*)strs[x]));

81 
ou’
 = (
outbuf
);

82 ià((
”r
 = 
	`d”_’code_£tof
(
li¡
, 10, 
outbuf
, &
ou’
)è!ğ
CRYPT_OK
) {

83 
	`årštf
(
¡d”r
, "”rÜƒncodšg SET OF: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

84 
	`ex™
(
EXIT_FAILURE
);

87 
x
 = 0; x < 10; x++) {

88 
	`LTC_SET_ASN1
(
li¡
, 
x
, 
LTC_ASN1_PRINTABLE_STRING
, 
¡rs
[x], (strs[x]) - 1);

90 
	`XMEMSET
(
¡rs
, 0, (strs));

92 ià((
”r
 = 
	`d”_decode_£t
(
outbuf
, 
ou’
, 
li¡
, 10)è!ğ
CRYPT_OK
) {

93 
	`årštf
(
¡d”r
, "”rÜ decodšg SET OF: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

94 
	`ex™
(
EXIT_FAILURE
);

98 
x
 = 1; x < 10; x++) {

99 ià(!(
	`¡¾’
((*)
¡rs
[
x
-1]è<ğ¡¾’((*)¡rs[x])è&& 
	`¡rcmp
((*)strs[x-1], (*)strs[x]) >= 0) {

100 
	`årštf
(
¡d”r
, "”rÜ SET OF ord”‡ˆ%lu i wrÚg\n", 
x
);

101 
	`ex™
(
EXIT_FAILURE
);

105 
	}
}

132 
	$d”_æexi_‹¡
()

134 cÚ¡ 
´šbË_¡r
[] = "printable";

135 cÚ¡ 
£t1_¡r
[] = "333";

136 cÚ¡ 
£t2_¡r
[] = "222";

137 cÚ¡ 
Ÿ5_¡r
[] = "ia5";

138 cÚ¡ 
št_v®
 = 12345678UL;

139 cÚ¡ 
Éc_utùime
 
utùime
 = { 91, 5, 6, 16, 45, 40, 1, 7, 0 };

140 cÚ¡ 
où_¡r
[] = { 1, 2, 3, 4 };

141 cÚ¡ 
b™_¡r
[] = { 1, 0, 0, 1 };

142 cÚ¡ 
oid_¡r
[] = { 1, 2, 840, 113549 };

144 
’code_buf
[192];

145 
’code_buf_Ën
, 
decode_Ën
;

146 
”r
;

148 
Éc_a¢1_li¡
 
¡©ic_li¡
[5][3], *
decoded_li¡
, *
l
;

151 
	`LTC_SET_ASN1
(
¡©ic_li¡
[0], 0, 
LTC_ASN1_PRINTABLE_STRING
, (*)
´šbË_¡r
, 
	`¡¾’
(printable_str));

152 
	`LTC_SET_ASN1
(
¡©ic_li¡
[0], 1, 
LTC_ASN1_IA5_STRING
, (*)
Ÿ5_¡r
, 
	`¡¾’
(ia5_str));

153 
	`LTC_SET_ASN1
(
¡©ic_li¡
[0], 2, 
LTC_ASN1_SEQUENCE
, static_list[1], 3);

155 
	`LTC_SET_ASN1
(
¡©ic_li¡
[1], 0, 
LTC_ASN1_SHORT_INTEGER
, (*)&
št_v®
, 1);

156 
	`LTC_SET_ASN1
(
¡©ic_li¡
[1], 1, 
LTC_ASN1_UTCTIME
, (*)&
utùime
, 1);

157 
	`LTC_SET_ASN1
(
¡©ic_li¡
[1], 2, 
LTC_ASN1_SEQUENCE
, static_list[2], 3);

159 
	`LTC_SET_ASN1
(
¡©ic_li¡
[2], 0, 
LTC_ASN1_OCTET_STRING
, (*)
où_¡r
, 4);

160 
	`LTC_SET_ASN1
(
¡©ic_li¡
[2], 1, 
LTC_ASN1_BIT_STRING
, (*)
b™_¡r
, 4);

161 
	`LTC_SET_ASN1
(
¡©ic_li¡
[2], 2, 
LTC_ASN1_SEQUENCE
, static_list[3], 3);

163 
	`LTC_SET_ASN1
(
¡©ic_li¡
[3], 0, 
LTC_ASN1_OBJECT_IDENTIFIER
,(*)
oid_¡r
, 4);

164 
	`LTC_SET_ASN1
(
¡©ic_li¡
[3], 1, 
LTC_ASN1_NULL
, 
NULL
, 0);

165 
	`LTC_SET_ASN1
(
¡©ic_li¡
[3], 2, 
LTC_ASN1_SETOF
, static_list[4], 2);

167 
	`LTC_SET_ASN1
(
¡©ic_li¡
[4], 0, 
LTC_ASN1_PRINTABLE_STRING
, 
£t1_¡r
, 
	`¡¾’
(set1_str));

168 
	`LTC_SET_ASN1
(
¡©ic_li¡
[4], 1, 
LTC_ASN1_PRINTABLE_STRING
, 
£t2_¡r
, 
	`¡¾’
(set2_str));

171 
’code_buf_Ën
 = (
’code_buf
);

172 ià((
”r
 = 
	`d”_’code_£qu’û
(&
¡©ic_li¡
[0][0], 3, 
’code_buf
, &
’code_buf_Ën
)è!ğ
CRYPT_OK
) {

173 
	`årštf
(
¡d”r
, "Encodšg stic_li¡: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

174 
	`ex™
(
EXIT_FAILURE
);

179 
FILE
 *
f
;

180 
f
 = 
	`fİ’
("t.bin", "wb");

181 
	`fwr™e
(
’code_buf
, 1, 
’code_buf_Ën
, 
f
);

182 
	`fşo£
(
f
);

187 
decode_Ën
 = 
’code_buf_Ën
;

188 ià((
”r
 = 
	`d”_decode_£qu’û_æexi
(
’code_buf
, &
decode_Ën
, &
decoded_li¡
)è!ğ
CRYPT_OK
) {

189 
	`årštf
(
¡d”r
, "decodšg stic_li¡: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

190 
	`ex™
(
EXIT_FAILURE
);

193 ià(
decode_Ën
 !ğ
’code_buf_Ën
) {

194 
	`årštf
(
¡d”r
, "DecodËÀoà%lu dÛ nÙ m©chƒncodËÀoà%lu \n", 
decode_Ën
, 
’code_buf_Ën
);

195 
	`ex™
(
EXIT_FAILURE
);

199 
l
 = 
decoded_li¡
;

200 ià(
l
->
Ãxt
 !ğ
NULL
 ||†->
chd
 == NULL) {

201 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

202 
	`ex™
(
EXIT_FAILURE
);

206 ià(
l
->
ty³
 !ğ
LTC_ASN1_SEQUENCE
) {

207 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

208 
	`ex™
(
EXIT_FAILURE
);

210 
l
 =†->
chd
;

214 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

215 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

216 
	`ex™
(
EXIT_FAILURE
);

219 ià(
l
->
ty³
 !ğ
LTC_ASN1_PRINTABLE_STRING
) {

220 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

221 
	`ex™
(
EXIT_FAILURE
);

224 ià(
l
->
size
 !ğ
	`¡¾’
(
´šbË_¡r
è|| 
	`memcmp
ÕršbË_¡r,†->
d©a
,†->size)) {

225 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

226 
	`ex™
(
EXIT_FAILURE
);

230 
l
 =†->
Ãxt
;

234 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

235 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

236 
	`ex™
(
EXIT_FAILURE
);

239 ià(
l
->
ty³
 !ğ
LTC_ASN1_IA5_STRING
) {

240 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

241 
	`ex™
(
EXIT_FAILURE
);

244 ià(
l
->
size
 !ğ
	`¡¾’
(
Ÿ5_¡r
è|| 
	`memcmp
(Ÿ5_¡r,†->
d©a
,†->size)) {

245 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

246 
	`ex™
(
EXIT_FAILURE
);

250 
l
 =†->
Ãxt
;

254 ià(
l
->
Ãxt
 !ğ
NULL
 ||†->
chd
 == NULL) {

255 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

256 
	`ex™
(
EXIT_FAILURE
);

259 ià(
l
->
ty³
 !ğ
LTC_ASN1_SEQUENCE
) {

260 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

261 
	`ex™
(
EXIT_FAILURE
);

263 
l
 =†->
chd
;

268 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

269 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

270 
	`ex™
(
EXIT_FAILURE
);

273 ià(
l
->
ty³
 !ğ
LTC_ASN1_INTEGER
) {

274 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

275 
	`ex™
(
EXIT_FAILURE
);

278 ià(
	`mp_cmp_d
(
l
->
d©a
, 12345678ULè!ğ
LTC_MP_EQ
) {

279 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

280 
	`ex™
(
EXIT_FAILURE
);

284 
l
 =†->
Ãxt
;

288 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

289 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

290 
	`ex™
(
EXIT_FAILURE
);

293 ià(
l
->
ty³
 !ğ
LTC_ASN1_UTCTIME
) {

294 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

295 
	`ex™
(
EXIT_FAILURE
);

298 ià(
	`memcmp
(
l
->
d©a
, &
utùime
, (utctime))) {

299 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

300 
	`ex™
(
EXIT_FAILURE
);

304 
l
 =†->
Ãxt
;

308 ià(
l
->
Ãxt
 !ğ
NULL
 ||†->
chd
 == NULL) {

309 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

310 
	`ex™
(
EXIT_FAILURE
);

313 ià(
l
->
ty³
 !ğ
LTC_ASN1_SEQUENCE
) {

314 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

315 
	`ex™
(
EXIT_FAILURE
);

317 
l
 =†->
chd
;

322 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

323 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

324 
	`ex™
(
EXIT_FAILURE
);

327 ià(
l
->
ty³
 !ğ
LTC_ASN1_OCTET_STRING
) {

328 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

329 
	`ex™
(
EXIT_FAILURE
);

332 ià(
l
->
size
 !ğ(
où_¡r
è|| 
	`memcmp
(où_¡r,†->
d©a
,†->size)) {

333 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

334 
	`ex™
(
EXIT_FAILURE
);

338 
l
 =†->
Ãxt
;

342 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

343 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

344 
	`ex™
(
EXIT_FAILURE
);

347 ià(
l
->
ty³
 !ğ
LTC_ASN1_BIT_STRING
) {

348 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

349 
	`ex™
(
EXIT_FAILURE
);

352 ià(
l
->
size
 !ğ(
b™_¡r
è|| 
	`memcmp
(b™_¡r,†->
d©a
,†->size)) {

353 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

354 
	`ex™
(
EXIT_FAILURE
);

358 
l
 =†->
Ãxt
;

362 ià(
l
->
Ãxt
 !ğ
NULL
 ||†->
chd
 == NULL) {

363 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

364 
	`ex™
(
EXIT_FAILURE
);

367 ià(
l
->
ty³
 !ğ
LTC_ASN1_SEQUENCE
) {

368 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

369 
	`ex™
(
EXIT_FAILURE
);

371 
l
 =†->
chd
;

376 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

377 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

378 
	`ex™
(
EXIT_FAILURE
);

381 ià(
l
->
ty³
 !ğ
LTC_ASN1_OBJECT_IDENTIFIER
) {

382 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

383 
	`ex™
(
EXIT_FAILURE
);

386 ià(
l
->
size
 !ğ(
oid_¡r
)/(oid_¡r[0]è|| 
	`memcmp
(oid_¡r,†->
d©a
,†->size*(oid_str[0]))) {

387 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

388 
	`ex™
(
EXIT_FAILURE
);

392 
l
 =†->
Ãxt
;

395 ià(
l
->
ty³
 !ğ
LTC_ASN1_NULL
) {

396 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

397 
	`ex™
(
EXIT_FAILURE
);

401 
l
 =†->
Ãxt
;

404 ià(
l
->
Ãxt
 !ğ
NULL
 ||†->
chd
 == NULL) {

405 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

406 
	`ex™
(
EXIT_FAILURE
);

409 ià(
l
->
ty³
 !ğ
LTC_ASN1_SET
) {

410 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

411 
	`ex™
(
EXIT_FAILURE
);

413 
l
 =†->
chd
;

417 ià(
l
->
Ãxt
 =ğ
NULL
 ||†->
chd
 != NULL) {

418 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

419 
	`ex™
(
EXIT_FAILURE
);

422 ià(
l
->
ty³
 !ğ
LTC_ASN1_PRINTABLE_STRING
) {

423 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

424 
	`ex™
(
EXIT_FAILURE
);

428 ià(
l
->
size
 !ğ
	`¡¾’
(
£t2_¡r
è|| 
	`memcmp
(£t2_¡r,†->
d©a
,†->size)) {

429 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

430 
	`ex™
(
EXIT_FAILURE
);

434 
l
 =†->
Ãxt
;

438 ià(
l
->
ty³
 !ğ
LTC_ASN1_PRINTABLE_STRING
) {

439 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

440 
	`ex™
(
EXIT_FAILURE
);

443 ià(
l
->
size
 !ğ
	`¡¾’
(
£t1_¡r
è|| 
	`memcmp
(£t1_¡r,†->
d©a
,†->size)) {

444 
	`årštf
(
¡d”r
, "(%d), %d, %lu,‚ext=%p,…»v=%p,…¬’t=%p, chd=%p\n", 
__LINE__
, 
l
->
ty³
,†->
size
,†->
Ãxt
,†->
´ev
,†->
·»Á
,†->
chd
);

445 
	`ex™
(
EXIT_FAILURE
);

449 
	`d”_£qu’û_ä“
(
l
);

451 
	}
}

453 
	$d”_choiû_‹¡
()

455 
Éc_a¢1_li¡
 
ty³s
[7], 
ho¡
[1];

456 
b™buf
[10], 
où‘buf
[10], 
Ÿ5buf
[10], 
´štbuf
[10], 
outbuf
[256];

457 
š‹g”
, 
oidbuf
[10], 
ou’
, 
šËn
, 
x
, 
y
;

458 *
mpš‹g”
;

459 
Éc_utùime
 
utùime
 = { 91, 5, 6, 16, 45, 40, 1, 7, 0 };

462 
x
 = 0; x < (
b™buf
); x++) { bitbuf[x] = x & 1; }

463 
x
 = 0; x < (
où‘buf
); x++) { octetbuf[x] = x; }

464 
x
 = 0; x < (
Ÿ5buf
); x++) { ia5buf[x] = 'a'; }

465 
x
 = 0; x < (
´štbuf
); x++) {…rintbuf[x] = 'a'; }

466 
š‹g”
 = 1;

467 
x
 = 0; x < (
oidbuf
)/(oidbuf[0]); x++) { oidbuf[x] = x + 1; }

468 
	`DO
(
	`mp_š™
(&
mpš‹g”
));

470 
x
 = 0; x < 14; x++) {

472 
	`LTC_SET_ASN1
(
ty³s
, 0, 
LTC_ASN1_PRINTABLE_STRING
, 
´štbuf
, (printbuf));

473 
	`LTC_SET_ASN1
(
ty³s
, 1, 
LTC_ASN1_BIT_STRING
, 
b™buf
, (bitbuf));

474 
	`LTC_SET_ASN1
(
ty³s
, 2, 
LTC_ASN1_OCTET_STRING
, 
où‘buf
, (octetbuf));

475 
	`LTC_SET_ASN1
(
ty³s
, 3, 
LTC_ASN1_IA5_STRING
, 
Ÿ5buf
, (ia5buf));

476 ià(
x
 > 7) {

477 
	`LTC_SET_ASN1
(
ty³s
, 4, 
LTC_ASN1_SHORT_INTEGER
, &
š‹g”
, 1);

479 
	`LTC_SET_ASN1
(
ty³s
, 4, 
LTC_ASN1_INTEGER
, 
mpš‹g”
, 1);

481 
	`LTC_SET_ASN1
(
ty³s
, 5, 
LTC_ASN1_OBJECT_IDENTIFIER
, 
oidbuf
, (oidbuf)/(oidbuf[0]));

482 
	`LTC_SET_ASN1
(
ty³s
, 6, 
LTC_ASN1_UTCTIME
, &
utùime
, 1);

484 
	`LTC_SET_ASN1
(
ho¡
, 0, 
LTC_ASN1_CHOICE
, 
ty³s
, 7);

488 
ou’
 = (
outbuf
);

489 
	`DO
(
	`d”_’code_£qu’û
(&
ty³s
[
x
>6?x-7:x], 1, 
outbuf
, &
ou’
));

492 
šËn
 = 
ou’
;

493 
	`DO
(
	`d”_decode_£qu’û
(
outbuf
, 
šËn
, &
ho¡
[0], 1));

495 
y
 = 0; y < 7; y++) {

496 ià(
ty³s
[
y
].
u£d
 && y !ğ(
x
>6?x-7:x)) {

497 
	`årštf
(
¡d”r
, "CHOICE, fÏg %lu iÀŒŸÈ%lu wa šcÜ»ùly s‘ØÚe\n", 
y
, 
x
);

500 ià(!
ty³s
[
y
].
u£d
 && y =ğ(
x
>6?x-7:x)) {

501 
	`årštf
(
¡d”r
, "CHOICE, fÏg %lu iÀŒŸÈ%lu wa šcÜ»ùly s‘Øz”o\n", 
y
, 
x
);

506 
	`mp_ş—r
(
mpš‹g”
);

508 
	}
}

511 
	$d”_‹¡s
()

513 
x
, 
y
, 
z
, 
zz
, 
oid
[2][32];

514 
buf
[3][2048];

515 *
a
, *
b
, *
c
, *
d
, *
e
, *
f
, *
g
;

517 cÚ¡ 
r§_oid_d”
[] = { 0x06, 0x06, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d };

518 cÚ¡ 
r§_oid
[] = { 1, 2, 840, 113549 };

520 cÚ¡ 
r§_Ÿ5
[] = "test1@rsa.com";

521 cÚ¡ 
r§_Ÿ5_d”
[] = { 0x16, 0x0d, 0x74, 0x65, 0x73, 0x74, 0x31,

524 cÚ¡ 
r§_´šbË
[] = "Test User 1";

525 cÚ¡ 
r§_´šbË_d”
[] = { 0x13, 0x0b, 0x54, 0x65, 0x73, 0x74, 0x20, 0x55,

528 cÚ¡ 
Éc_utùime
 
r§_time1
 = { 91, 5, 6, 16, 45, 40, 1, 7, 0 };

529 cÚ¡ 
Éc_utùime
 
r§_time2
 = { 91, 5, 6, 23, 45, 40, 0, 0, 0 };

530 
Éc_utùime
 
tmp_time
;

532 cÚ¡ 
r§_time1_d”
[] = { 0x17, 0x11, 0x39, 0x31, 0x30, 0x35, 0x30, 0x36, 0x31, 0x36, 0x34, 0x35, 0x34, 0x30, 0x2D, 0x30, 0x37, 0x30, 0x30 };

533 cÚ¡ 
r§_time2_d”
[] = { 0x17, 0x0d, 0x39, 0x31, 0x30, 0x35, 0x30, 0x36, 0x32, 0x33, 0x34, 0x35, 0x34, 0x30, 0x5a };

535 cÚ¡ 
wch¬_t
 
utf8_1
[] = { 0x0041, 0x2262, 0x0391, 0x002E };

536 cÚ¡ 
utf8_1_d”
[] = { 0x0C, 0x07, 0x41, 0xE2, 0x89, 0xA2, 0xCE, 0x91, 0x2E };

537 cÚ¡ 
wch¬_t
 
utf8_2
[] = { 0xD55C, 0xAD6D, 0xC5B4 };

538 cÚ¡ 
utf8_2_d”
[] = { 0x0C, 0x09, 0xED, 0x95, 0x9C, 0xEA, 0xB5, 0xAD, 0xEC, 0x96, 0xB4 };

540 
utf8_buf
[32];

541 
wch¬_t
 
utf8_out
[32];

543 
	`DO
(
	`mp_š™_muÉi
(&
a
, &
b
, &
c
, &
d
, &
e
, &
f
, &
g
, 
NULL
));

544 
zz
 = 0; zz < 16; zz++) {

545 #ifdeà
USE_TFM


546 
z
 = 0; z < 256; z++) {

548 
z
 = 0; z < 1024; z++) {

550 ià(
	`y¬row_»ad
(
buf
[0], 
z
, &
y¬row_´ng
) != z) {

551 
	`årštf
(
¡d”r
, "FaedØ»ad %lu by‹ äom y¬row\n", 
z
);

554 
	`DO
(
	`mp_»ad_unsigÃd_bš
(
a
, 
buf
[0], 
z
));

556 
x
 = (
buf
[0]);

557 
	`DO
(
	`d”_’code_š‹g”
(
a
, 
buf
[0], &
x
));

558 
	`DO
(
	`d”_Ëngth_š‹g”
(
a
, &
y
));

559 ià(
y
 !ğ
x
è{ 
	`årštf
(
¡d”r
, "DER INTEGER size mismatch\n");  1; }

560 
	`mp_£t_št
(
b
, 0);

561 
	`DO
(
	`d”_decode_š‹g”
(
buf
[0], 
y
, 
b
));

562 ià(
y
 !ğ
x
 || 
	`mp_cmp
(
a
, 
b
è!ğ
LTC_MP_EQ
) {

563 
	`årštf
(
¡d”r
, "%lu: %lu v %lu\n", 
z
, 
x
, 
y
);

564 
	`mp_ş—r_muÉi
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
NULL
);

571 
zz
 = 0; zz < 256; zz++) {

572 
z
 = 1; z < 4; z++) {

573 ià(
	`y¬row_»ad
(
buf
[0], 
z
, &
y¬row_´ng
) != z) {

574 
	`årštf
(
¡d”r
, "FaedØ»ad %lu by‹ äom y¬row\n", 
z
);

578 
	`DO
(
	`mp_»ad_unsigÃd_bš
(
a
, 
buf
[0], 
z
));

580 
x
 = (
buf
[0]);

581 
	`DO
(
	`d”_’code_š‹g”
(
a
, 
buf
[0], &
x
));

584 
y
 = (
buf
[1]);

585 
	`DO
(
	`d”_’code_shÜt_š‹g”
(
	`mp_g‘_št
(
a
), 
buf
[1], &
y
));

586 ià(
x
 !ğ
y
 || 
	`memcmp
(
buf
[0], buf[1], x)) {

587 
	`årštf
(
¡d”r
, "DER INTEGER shÜˆ’codšg faed, %lu, %lu\n", 
x
, 
y
);

588 
z
 = 0; z < 
x
; z++è
	`årštf
(
¡d”r
, "%02x ", 
buf
[0][z]); fprintf(stderr, "\n");

589 
z
 = 0; z < 
y
; z++è
	`årštf
(
¡d”r
, "%02x ", 
buf
[1][z]); fprintf(stderr, "\n");

590 
	`mp_ş—r_muÉi
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
NULL
);

595 
x
 = 0;

596 
	`DO
(
	`d”_decode_shÜt_š‹g”
(
buf
[1], 
y
, &
x
));

597 ià(
x
 !ğ
	`mp_g‘_št
(
a
)) {

598 
	`årštf
(
¡d”r
, "DER INTEGER shÜˆdecodšg faed, %lu, %lu\n", 
x
, 
	`mp_g‘_št
(
a
));

599 
	`mp_ş—r_muÉi
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
NULL
);

604 
	`mp_ş—r_muÉi
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
NULL
);

608 
zz
 = 1; zz < 1536; zz++) {

609 
	`y¬row_»ad
(
buf
[0], 
zz
, &
y¬row_´ng
);

610 
z
 = 0; z < 
zz
; z++) {

611 
buf
[0][
z
] &= 0x01;

613 
x
 = (
buf
[1]);

614 
	`DO
(
	`d”_’code_b™_¡ršg
(
buf
[0], 
zz
, buf[1], &
x
));

615 
	`DO
(
	`d”_Ëngth_b™_¡ršg
(
zz
, &
y
));

616 ià(
y
 !ğ
x
) {

617 
	`årštf
(
¡d”r
, "\nDER BIT STRING†’gth oà’coded‚Ù m©chƒx³ùed : %lu, %lu, %lu\n", 
z
, 
x
, 
y
);

621 
y
 = (
buf
[2]);

622 
	`DO
(
	`d”_decode_b™_¡ršg
(
buf
[1], 
x
, buf[2], &
y
));

623 ià(
y
 !ğ
zz
 || 
	`memcmp
(
buf
[0], buf[2], zz)) {

624 
	`årštf
(
¡d”r
, "%lu, %lu, %d\n", 
y
, 
zz
, 
	`memcmp
(
buf
[0], buf[2], zz));

630 
zz
 = 1; zz < 1536; zz++) {

631 
	`y¬row_»ad
(
buf
[0], 
zz
, &
y¬row_´ng
);

632 
x
 = (
buf
[1]);

633 
	`DO
(
	`d”_’code_où‘_¡ršg
(
buf
[0], 
zz
, buf[1], &
x
));

634 
	`DO
(
	`d”_Ëngth_où‘_¡ršg
(
zz
, &
y
));

635 ià(
y
 !ğ
x
) {

636 
	`årštf
(
¡d”r
, "\nDER OCTET STRING†’gth oà’coded‚Ù m©chƒx³ùed : %lu, %lu, %lu\n", 
z
, 
x
, 
y
);

639 
y
 = (
buf
[2]);

640 
	`DO
(
	`d”_decode_où‘_¡ršg
(
buf
[1], 
x
, buf[2], &
y
));

641 ià(
y
 !ğ
zz
 || 
	`memcmp
(
buf
[0], buf[2], zz)) {

642 
	`årštf
(
¡d”r
, "%lu, %lu, %d\n", 
y
, 
zz
, 
	`memcmp
(
buf
[0], buf[2], zz));

648 
x
 = (
buf
[0]);

649 
	`DO
(
	`d”_’code_objeù_id’tif›r
((*)
r§_oid
, Ô§_oid)/Ô§_oid[0]), 
buf
[0], &
x
));

650 ià(
x
 !ğ(
r§_oid_d”
è|| 
	`memcmp
Ô§_oid_d”, 
buf
[0], x)) {

651 
	`årštf
(
¡d”r
, "r§_oid_d”ƒncodçedØm©ch, %lu, ", 
x
);

652 
y
 = 0; y < 
x
; y++è
	`årštf
(
¡d”r
, "%02x ", 
buf
[0][y]);

653 
	`årštf
(
¡d”r
, "\n");

657 
y
 = (
oid
[0])/(oid[0][0]);

658 
	`DO
(
	`d”_decode_objeù_id’tif›r
(
buf
[0], 
x
, 
oid
[0], &
y
));

659 ià(
y
 !ğ(
r§_oid
)/Ô§_oid[0]è|| 
	`memcmp
Ô§_oid, 
oid
[0], (rsa_oid))) {

660 
	`årštf
(
¡d”r
, "r§_oid_d” decodçedØm©ch, %lu, ", 
y
);

661 
z
 = 0; z < 
y
; z++è
	`årštf
(
¡d”r
, "%lu ", 
oid
[0][z]);

662 
	`årštf
(
¡d”r
, "\n");

667 
zz
 = 0; zz < 5000; zz++) {

669 
	`y¬row_»ad
(
buf
[0], 4, &
y¬row_´ng
);

670 
	`LOAD32L
(
z
, 
buf
[0]);

671 
z
 = 2 + (z % (((
oid
[0])/(oid[0][0])) - 2));

674 
oid
[0][0] = 
buf
[0][0] % 3;

675 
oid
[0][1] = 
buf
[0][1] % 40;

677 
y
 = 2; y < 
z
; y++) {

678 
	`y¬row_»ad
(
buf
[0], 4, &
y¬row_´ng
);

679 
	`LOAD32L
(
oid
[0][
y
], 
buf
[0]);

683 
x
 = (
buf
[0]);

684 
	`DO
(
	`d”_’code_objeù_id’tif›r
(
oid
[0], 
z
, 
buf
[0], &
x
));

685 
	`DO
(
	`d”_Ëngth_objeù_id’tif›r
(
oid
[0], 
z
, &
y
));

686 ià(
x
 !ğ
y
) {

687 
	`årštf
(
¡d”r
, "Rªdom OID %lue¡ faed,†’gth mism©ch: %lu, %lu\n", 
z
, 
x
, 
y
);

688 
x
 = 0; x < 
z
; x++è
	`årštf
(
¡d”r
, "%lu\n", 
oid
[0][x]);

693 
y
 = (
oid
[0])/(oid[0][0]);

694 
	`DO
(
	`d”_decode_objeù_id’tif›r
(
buf
[0], 
x
, 
oid
[1], &
y
));

695 ià(
y
 !ğ
z
) {

696 
	`årštf
(
¡d”r
, "Rªdom OID %lue¡ faed, decodËngth mism©ch: %lu, %lu\n", 
z
, 
x
, 
y
);

699 ià(
	`memcmp
(
oid
[0], oid[1], (oid[0][0]è* 
z
)) {

700 
	`årštf
(
¡d”r
, "Rªdom OID %lue¡ faed, decoded v®ue wrÚg\n", 
z
);

701 
x
 = 0; x < 
z
; x++è
	`årštf
(
¡d”r
, "%lu\n", 
oid
[0][x]); fprintf(stderr, "\n\n Got \n\n");

702 
x
 = 0; x < 
z
; x++è
	`årštf
(
¡d”r
, "%lu\n", 
oid
[1][x]);

708 
x
 = (
buf
[0]);

709 
	`DO
(
	`d”_’code_Ÿ5_¡ršg
(
r§_Ÿ5
, 
	`¡¾’
((*ì§_Ÿ5), 
buf
[0], &
x
));

710 ià(
x
 !ğ(
r§_Ÿ5_d”
è|| 
	`memcmp
(
buf
[0],„sa_ia5_der, x)) {

711 
	`årštf
(
¡d”r
, "IA5ƒncodçed: %lu, %lu\n", 
x
, ()(
r§_Ÿ5_d”
));

714 
	`DO
(
	`d”_Ëngth_Ÿ5_¡ršg
(
r§_Ÿ5
, 
	`¡¾’
((*ì§_Ÿ5), &
y
));

715 ià(
y
 !ğ
x
) {

716 
	`årštf
(
¡d”r
, "IA5†’gth faedØm©ch: %lu, %lu\n", 
x
, 
y
);

719 
y
 = (
buf
[1]);

720 
	`DO
(
	`d”_decode_Ÿ5_¡ršg
(
buf
[0], 
x
, buf[1], &
y
));

721 ià(
y
 !ğ
	`¡¾’
((*)
r§_Ÿ5
è|| 
	`memcmp
(
buf
[1],„sa_ia5, strlen((*)rsa_ia5))) {

722 
	`årštf
(
¡d”r
, "DER IA5 failedest vector\n");

727 
x
 = (
buf
[0]);

728 
	`DO
(
	`d”_’code_´šbË_¡ršg
(
r§_´šbË
, 
	`¡¾’
((*ì§_´šbË), 
buf
[0], &
x
));

729 ià(
x
 !ğ(
r§_´šbË_d”
è|| 
	`memcmp
(
buf
[0],„sa_printable_der, x)) {

730 
	`årštf
(
¡d”r
, "PRINTABLEƒncodçed: %lu, %lu\n", 
x
, ()(
r§_´šbË_d”
));

733 
	`DO
(
	`d”_Ëngth_´šbË_¡ršg
(
r§_´šbË
, 
	`¡¾’
((*ì§_´šbË), &
y
));

734 ià(
y
 !ğ
x
) {

735 
	`årštf
(
¡d”r
, "´šbË†’gth faedØm©ch: %lu, %lu\n", 
x
, 
y
);

738 
y
 = (
buf
[1]);

739 
	`DO
(
	`d”_decode_´šbË_¡ršg
(
buf
[0], 
x
, buf[1], &
y
));

740 ià(
y
 !ğ
	`¡¾’
((*)
r§_´šbË
è|| 
	`memcmp
(
buf
[1],„sa_printable, strlen((*)rsa_printable))) {

741 
	`årštf
(
¡d”r
, "DER…rintable failedest vector\n");

746 
x
 = (
buf
[0]);

747 
	`DO
(
	`d”_’code_utùime
((
Éc_utùime
*)&
r§_time1
, 
buf
[0], &
x
));

748 ià(
x
 !ğ(
r§_time1_d”
è|| 
	`memcmp
(
buf
[0],„sa_time1_der, x)) {

749 
	`årštf
(
¡d”r
, "UTCTIMEƒncodoàr§_time1 faed: %lu, %lu\n", 
x
, ()(
r§_time1_d”
));

750 
	`årštf
(
¡d”r
, "\n\n");

751 
y
 = 0; y < 
x
; y++è
	`årštf
(
¡d”r
, "%02x ", 
buf
[0][y]); 
	`´štf
("\n");

755 
	`DO
(
	`d”_Ëngth_utùime
((
Éc_utùime
*)&
r§_time1
, &
y
));

756 ià(
y
 !ğ
x
) {

757 
	`årštf
(
¡d”r
, "UTCTIME†’gth faedØm©ch fÜ„§_time1: %lu, %lu\n", 
x
, 
y
);

760 
	`DO
(
	`d”_decode_utùime
(
buf
[0], &
y
, &
tmp_time
));

761 ià(
y
 !ğ
x
 || 
	`memcmp
(&
r§_time1
, &
tmp_time
, (
Éc_utùime
))) {

762 
	`årštf
(
¡d”r
, "UTCTIME decodçed fÜ„§_time1: %lu %lu\n", 
x
, 
y
);

763 
	`årštf
(
¡d”r
, "\n\n%u %u %u %u %u %u %u %u %u\n\n",

764 
tmp_time
.
YY
,

765 
tmp_time
.
MM
,

766 
tmp_time
.
DD
,

767 
tmp_time
.
hh
,

768 
tmp_time
.
mm
,

769 
tmp_time
.
ss
,

770 
tmp_time
.
off_dœ
,

771 
tmp_time
.
off_mm
,

772 
tmp_time
.
off_hh
);

776 
x
 = (
buf
[0]);

777 
	`DO
(
	`d”_’code_utùime
((
Éc_utùime
*)&
r§_time2
, 
buf
[0], &
x
));

778 ià(
x
 !ğ(
r§_time2_d”
è|| 
	`memcmp
(
buf
[0],„sa_time2_der, x)) {

779 
	`årštf
(
¡d”r
, "UTCTIMEƒncodoàr§_time2 faed: %lu, %lu\n", 
x
, ()(
r§_time1_d”
));

780 
	`årštf
(
¡d”r
, "\n\n");

781 
y
 = 0; y < 
x
; y++è
	`årštf
(
¡d”r
, "%02x ", 
buf
[0][y]); 
	`´štf
("\n");

785 
	`DO
(
	`d”_Ëngth_utùime
((
Éc_utùime
*)&
r§_time2
, &
y
));

786 ià(
y
 !ğ
x
) {

787 
	`årštf
(
¡d”r
, "UTCTIME†’gth faedØm©ch fÜ„§_time2: %lu, %lu\n", 
x
, 
y
);

790 
	`DO
(
	`d”_decode_utùime
(
buf
[0], &
y
, &
tmp_time
));

791 ià(
y
 !ğ
x
 || 
	`memcmp
(&
r§_time2
, &
tmp_time
, (
Éc_utùime
))) {

792 
	`årštf
(
¡d”r
, "UTCTIME decodçed fÜ„§_time2: %lu %lu\n", 
x
, 
y
);

793 
	`årštf
(
¡d”r
, "\n\n%u %u %u %u %u %u %u %u %u\n\n",

794 
tmp_time
.
YY
,

795 
tmp_time
.
MM
,

796 
tmp_time
.
DD
,

797 
tmp_time
.
hh
,

798 
tmp_time
.
mm
,

799 
tmp_time
.
ss
,

800 
tmp_time
.
off_dœ
,

801 
tmp_time
.
off_mm
,

802 
tmp_time
.
off_hh
);

810 
x
 = (
utf8_buf
);

811 
	`DO
(
	`d”_’code_utf8_¡ršg
(
utf8_1
, (utf8_1è/ (utf8_1[0]), 
utf8_buf
, &
x
));

812 ià(
x
 !ğ(
utf8_1_d”
è|| 
	`memcmp
(
utf8_buf
, utf8_1_der, x)) {

813 
	`årštf
(
¡d”r
, "DER UTF8_1ƒncodedØ%lu by‹s\n", 
x
);

814 
y
 = 0; y < 
x
; y++è
	`årštf
(
¡d”r
, "%02x ", ()
utf8_buf
[y]); fprintf(stderr, "\n");

818 
y
 = (
utf8_out
) / (utf8_out[0]);

819 
	`DO
(
	`d”_decode_utf8_¡ršg
(
utf8_buf
, 
x
, 
utf8_out
, &
y
));

820 ià(
y
 !ğ((
utf8_1
è/ (utf8_1[0])è|| 
	`memcmp
(utf8_1, 
utf8_out
, y * (
wch¬_t
))) {

821 
	`årštf
(
¡d”r
, "DER UTF8_1 decodedØ%lu wch¬_t\n", 
y
);

822 
x
 = 0; x < 
y
; x++è
	`årštf
(
¡d”r
, "%04lx ", ()
utf8_out
[x]); fprintf(stderr, "\n");

827 
x
 = (
utf8_buf
);

828 
	`DO
(
	`d”_’code_utf8_¡ršg
(
utf8_2
, (utf8_2è/ (utf8_2[0]), 
utf8_buf
, &
x
));

829 ià(
x
 !ğ(
utf8_2_d”
è|| 
	`memcmp
(
utf8_buf
, utf8_2_der, x)) {

830 
	`årštf
(
¡d”r
, "DER UTF8_2ƒncodedØ%lu by‹s\n", 
x
);

831 
y
 = 0; y < 
x
; y++è
	`årštf
(
¡d”r
, "%02x ", ()
utf8_buf
[y]); fprintf(stderr, "\n");

835 
y
 = (
utf8_out
) / (utf8_out[0]);

836 
	`DO
(
	`d”_decode_utf8_¡ršg
(
utf8_buf
, 
x
, 
utf8_out
, &
y
));

837 ià(
y
 !ğ((
utf8_2
è/ (utf8_2[0])è|| 
	`memcmp
(utf8_2, 
utf8_out
, y * (
wch¬_t
))) {

838 
	`årštf
(
¡d”r
, "DER UTF8_2 decodedØ%lu wch¬_t\n", 
y
);

839 
x
 = 0; x < 
y
; x++è
	`årštf
(
¡d”r
, "%04lx ", ()
utf8_out
[x]); fprintf(stderr, "\n");

844 
	`d”_£t_‹¡
();

845 
	`d”_æexi_‹¡
();

846  
	`d”_choiû_‹¡
();

847 
	}
}

	@libtomcrypt/testprof/dsa_test.c

1 
	~<tomüy±_‹¡.h
>

3 #ifdeà
MDSA


5 
	$d§_‹¡
()

7 
msg
[16], 
out
[1024], 
out2
[1024];

8 
x
, 
y
;

9 
¡©1
, 
¡©2
;

10 
d§_key
 
key
, 
key2
;

13 
	`DO
(
	`d§_make_key
(&
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), 20, 128, &
key
));

16 
	`DO
(
	`d§_v”ify_key
(&
key
, &
¡©1
));

17 ià(
¡©1
 =ğ0è{ 
	`årštf
(
¡d”r
, "dsa_verify_key ");  1; }

20 
x
 = 0; x < 16; x++è{ 
msg
[x] = x; }

21 
x
 = (
out
);

22 
	`DO
(
	`d§_’üy±_key
(
msg
, 16, 
out
, &
x
, &
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), 
	`fšd_hash
("sha1"), &
key
));

25 
y
 = (
out2
);

26 
	`DO
(
	`d§_deüy±_key
(
out
, 
x
, 
out2
, &
y
, &
key
));

28 ià(
y
 !ğ16 || 
	`memcmp
(
out2
, 
msg
, 16)) {

29 
	`årštf
(
¡d”r
, "d§_deüy± faed, y =ğ%lu\n", 
y
);

34 
x
 = (
out
);

35 
	`DO
(
	`d§_sign_hash
(
msg
, (msg), 
out
, &
x
, &
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), &
key
));

38 
	`DO
(
	`d§_v”ify_hash
(
out
, 
x
, 
msg
, (msg), &
¡©1
, &
key
));

41 
msg
[0] ^= 1;

42 
	`DO
(
	`d§_v”ify_hash
(
out
, 
x
, 
msg
, (msg), &
¡©2
, &
key
));

43 
msg
[0] ^= 1;

44 ià(!(
¡©1
 =ğ1 && 
¡©2
 =ğ0)è{ 
	`årštf
(
¡d”r
, "dsa_verify %d %d", stat1, stat2);  1; }

47 
x
 = (
out2
);

48 
	`DO
(
	`d§_expÜt
(
out2
, &
x
, 
PK_PRIVATE
, &
key
));

49 
	`DO
(
	`d§_impÜt
(
out2
, 
x
, &
key2
));

52 
	`DO
(
	`d§_v”ify_hash
(
out
, 
x
, 
msg
, (msg), &
¡©1
, &
key2
));

53 ià(
¡©1
 =ğ0è{ 
	`årštf
(
¡d”r
, "dsa_verify (import…rivate) %d ", stat1);  1; }

54 
	`d§_ä“
(&
key2
);

57 
x
 = (
out2
);

58 
	`DO
(
	`d§_expÜt
(
out2
, &
x
, 
PK_PUBLIC
, &
key
));

60 
	`DO
(
	`d§_impÜt
(
out2
, 
x
, &
key2
));

62 
	`DO
(
	`d§_v”ify_hash
(
out
, 
x
, 
msg
, (msg), &
¡©1
, &
key2
));

63 ià(
¡©1
 =ğ0è{ 
	`årštf
(
¡d”r
, "dsa_verify (import…ublic) %d ", stat1);  1; }

64 
	`d§_ä“
(&
key2
);

65 
	`d§_ä“
(&
key
);

68 
	}
}

72 
	$d§_‹¡
()

74 
	`årštf
(
¡d”r
, "NOP");

76 
	}
}

	@libtomcrypt/testprof/ecc_test.c

1 
	~<tomüy±_‹¡.h
>

3 #ifdeà
MECC


5 
	gsizes
[] = {

6 #ifdeà
ECC112


9 #ifdeà
ECC128


12 #ifdeà
ECC160


15 #ifdeà
ECC192


18 #ifdeà
ECC224


21 #ifdeà
ECC256


24 #ifdeà
ECC384


27 #ifdeà
ECC521


32 #ifdeà
LTC_ECC_SHAMIR


33 
	$ecc_‹¡_shamœ
()

35 *
modulus
, *
mp
, *
kA
, *
kB
, *
rA
, *
rB
;

36 
ecc_pošt
 *
G
, *
A
, *
B
, *
C1
, *
C2
;

37 
x
, 
y
, 
z
;

38 
buf
[
ECC_BUF_SIZE
];

40 
	`DO
(
	`mp_š™_muÉi
(&
kA
, &
kB
, &
rA
, &
rB
, &
modulus
, 
NULL
));

41 
	`LTC_ARGCHK
((
G
 = 
	`Éc_ecc_Ãw_pošt
()è!ğ
NULL
);

42 
	`LTC_ARGCHK
((
A
 = 
	`Éc_ecc_Ãw_pošt
()è!ğ
NULL
);

43 
	`LTC_ARGCHK
((
B
 = 
	`Éc_ecc_Ãw_pošt
()è!ğ
NULL
);

44 
	`LTC_ARGCHK
((
C1
 = 
	`Éc_ecc_Ãw_pošt
()è!ğ
NULL
);

45 
	`LTC_ARGCHK
((
C2
 = 
	`Éc_ecc_Ãw_pošt
()è!ğ
NULL
);

47 
x
 = 0; x < ()((
sizes
)/(sizes[0])); x++) {

49 
z
 = 0; 
Éc_ecc_£ts
[z].
Çme
; z++) {

50 ià(
sizes
[
z
] < 
Éc_ecc_£ts
[z].
size
) ;

52 
	`LTC_ARGCHK
(
Éc_ecc_£ts
[
z
].
Çme
 !ğ
NULL
);

55 
	`DO
(
	`mp_»ad_¿dix
(
G
->
x
, 
Éc_ecc_£ts
[
z
].
Gx
, 16));

56 
	`DO
(
	`mp_»ad_¿dix
(
G
->
y
, 
Éc_ecc_£ts
[
z
].
Gy
, 16));

57 
	`DO
(
	`mp_£t
(
G
->
z
, 1));

58 
	`DO
(
	`mp_»ad_¿dix
(
modulus
, 
Éc_ecc_£ts
[
z
].
´ime
, 16));

59 
	`DO
(
	`mp_mÚtgom”y_£tup
(
modulus
, &
mp
));

62 
y
 = 0; y < 100; y++) {

64 
	`LTC_ARGCHK
(
	`y¬row_»ad
(
buf
, 
sizes
[
x
], &
y¬row_´ng
) == sizes[x]);

65 
	`DO
(
	`mp_»ad_unsigÃd_bš
(
rA
, 
buf
, 
sizes
[
x
]));

66 
	`LTC_ARGCHK
(
	`y¬row_»ad
(
buf
, 
sizes
[
x
], &
y¬row_´ng
) == sizes[x]);

67 
	`DO
(
	`mp_»ad_unsigÃd_bš
(
rB
, 
buf
, 
sizes
[
x
]));

70 
	`DO
(
Éc_mp
.
	`ecc_±mul
(
rA
, 
G
, 
A
, 
modulus
, 1));

73 
	`DO
(
Éc_mp
.
	`ecc_±mul
(
rB
, 
G
, 
B
, 
modulus
, 1));

76 
	`LTC_ARGCHK
(
	`y¬row_»ad
(
buf
, 
sizes
[
x
], &
y¬row_´ng
) == sizes[x]);

77 
	`DO
(
	`mp_»ad_unsigÃd_bš
(
kA
, 
buf
, 
sizes
[
x
]));

78 
	`LTC_ARGCHK
(
	`y¬row_»ad
(
buf
, 
sizes
[
x
], &
y¬row_´ng
) == sizes[x]);

79 
	`DO
(
	`mp_»ad_unsigÃd_bš
(
kB
, 
buf
, 
sizes
[
x
]));

82 
	`DO
(
Éc_mp
.
	`ecc_±mul
(
kA
, 
A
, 
C1
, 
modulus
, 0));

83 
	`DO
(
Éc_mp
.
	`ecc_±mul
(
kB
, 
B
, 
C2
, 
modulus
, 0));

84 
	`DO
(
Éc_mp
.
	`ecc_±add
(
C1
, 
C2
, C1, 
modulus
, 
mp
));

85 
	`DO
(
Éc_mp
.
	`ecc_m­
(
C1
, 
modulus
, 
mp
));

88 
	`DO
(
Éc_mp
.
	`ecc_mul2add
(
A
, 
kA
, 
B
, 
kB
, 
C2
, 
modulus
));

91 ià((
	`mp_cmp
(
C1
->
x
, 
C2
->xè!ğ
LTC_MP_EQ
è|| (mp_cmp(C1->
y
, C2->yè!ğLTC_MP_EQè|| (mp_cmp(C1->
z
, C2->z) != LTC_MP_EQ)) {

92 
	`årštf
(
¡d”r
, "ECC faed shamœe¡: size=%d,e¡no=%d\n", 
sizes
[
x
], 
y
);

96 
	`mp_mÚtgom”y_ä“
(
mp
);

98 
	`Éc_ecc_d–_pošt
(
C2
);

99 
	`Éc_ecc_d–_pošt
(
C1
);

100 
	`Éc_ecc_d–_pošt
(
B
);

101 
	`Éc_ecc_d–_pošt
(
A
);

102 
	`Éc_ecc_d–_pošt
(
G
);

103 
	`mp_ş—r_muÉi
(
kA
, 
kB
, 
rA
, 
rB
, 
modulus
, 
NULL
);

105 
	}
}

108 
	$ecc_‹¡s
 ()

110 
buf
[4][4096];

111 
x
, 
y
, 
z
, 
s
;

112 
¡©
, 
¡©2
;

113 
ecc_key
 
u£¿
, 
u£rb
, 
pubKey
, 
´ivKey
;

115 
	`DO
(
	`ecc_‹¡
 ());

116 
	`DO
(
	`ecc_‹¡
 ());

117 
	`DO
(
	`ecc_‹¡
 ());

118 
	`DO
(
	`ecc_‹¡
 ());

119 
	`DO
(
	`ecc_‹¡
 ());

121 
s
 = 0; s < ((
sizes
)/(sizes[0])); s++) {

123 
	`DO
(
	`ecc_make_key
 (&
y¬row_´ng
, 
	`fšd_´ng
 ("y¬row"), 
sizes
[
s
], &
u£¿
));

124 
	`DO
(
	`ecc_make_key
 (&
y¬row_´ng
, 
	`fšd_´ng
 ("y¬row"), 
sizes
[
s
], &
u£rb
));

127 
x
 = (
buf
[0]);

128 
	`DO
(
	`ecc_sh¬ed_£ü‘
 (&
u£¿
, &
u£rb
, 
buf
[0], &
x
));

130 
y
 = (
buf
[1]);

131 
	`DO
(
	`ecc_sh¬ed_£ü‘
 (&
u£rb
, &
u£¿
, 
buf
[1], &
y
));

133 ià(
y
 !ğ
x
) {

134 
	`årštf
(
¡d”r
, "ecc Shared keys‡re‚ot same size.");

138 ià(
	`memcmp
 (
buf
[0], buf[1], 
x
)) {

139 
	`årštf
(
¡d”r
, "ecc Shared keys‚ot same contents.");

144 
y
 = (
buf
[0]);

145 
	`DO
(
	`ecc_expÜt
 (
buf
[1], &
y
, 
PK_PUBLIC
, &
u£rb
));

146 
	`ecc_ä“
 (&
u£rb
);

149 
	`DO
(
	`ecc_impÜt
 (
buf
[1], 
y
, &
u£rb
));

151 
z
 = (
buf
[0]);

152 
	`DO
(
	`ecc_sh¬ed_£ü‘
 (&
u£¿
, &
u£rb
, 
buf
[2], &
z
));

154 ià(
z
 !ğ
x
) {

155 
	`årštf
(
¡d”r
, "failed. Size don't match?");

158 ià(
	`memcmp
 (
buf
[0], buf[2], 
x
)) {

159 
	`årštf
(
¡d”r
, "Failed. Contents didn't match.");

164 
y
 = (
buf
[1]);

165 
	`DO
(
	`ecc_ªsi_x963_expÜt
(&
u£rb
, 
buf
[1], &
y
));

166 
	`ecc_ä“
 (&
u£rb
);

169 
	`DO
(
	`ecc_ªsi_x963_impÜt
(
buf
[1], 
y
, &
u£rb
));

172 
z
 = (
buf
[0]);

173 
	`DO
(
	`ecc_sh¬ed_£ü‘
 (&
u£¿
, &
u£rb
, 
buf
[2], &
z
));

175 ià(
z
 !ğ
x
) {

176 
	`årštf
(
¡d”r
, "failed. Size don't match?");

179 ià(
	`memcmp
 (
buf
[0], buf[2], 
x
)) {

180 
	`årštf
(
¡d”r
, "Failed. Contents didn't match.");

184 
	`ecc_ä“
 (&
u£¿
);

185 
	`ecc_ä“
 (&
u£rb
);

188 
	`DO
(
	`ecc_make_key
 (&
y¬row_´ng
, 
	`fšd_´ng
 ("y¬row"), 
sizes
[
s
], &
u£¿
));

191 
x
 = (
buf
[0]);

192 
	`DO
(
	`ecc_expÜt
(
buf
[0], &
x
, 
PK_PUBLIC
, &
u£¿
));

193 
	`DO
(
	`ecc_impÜt
(
buf
[0], 
x
, &
pubKey
));

194 
x
 = (
buf
[0]);

195 
	`DO
(
	`ecc_expÜt
(
buf
[0], &
x
, 
PK_PRIVATE
, &
u£¿
));

196 
	`DO
(
	`ecc_impÜt
(
buf
[0], 
x
, &
´ivKey
));

198 
x
 = 0; x < 32; x++) {

199 
buf
[0][
x
] = x;

201 
y
 =  (
buf
[1]);

202 
	`DO
(
	`ecc_’üy±_key
 (
buf
[0], 32, buf[1], &
y
, &
y¬row_´ng
, 
	`fšd_´ng
 ("y¬row"), 
	`fšd_hash
 ("sha256"), &
pubKey
));

203 
	`z”omem
 (
buf
[0],  (buf[0]));

204 
x
 =  (
buf
[0]);

205 
	`DO
(
	`ecc_deüy±_key
 (
buf
[1], 
y
, buf[0], &
x
, &
´ivKey
));

206 ià(
x
 != 32) {

207 
	`årštf
(
¡d”r
, "Failed (length)");

210 
x
 = 0; x < 32; x++) {

211 ià(
buf
[0][
x
] != x) {

212 
	`årštf
(
¡d”r
, "Failed (contents)");

217 
x
 = 0; x < 16; x++) {

218 
buf
[0][
x
] = x;

220 
x
 =  (
buf
[1]);

221 
	`DO
(
	`ecc_sign_hash
 (
buf
[0], 16, buf[1], &
x
, &
y¬row_´ng
, 
	`fšd_´ng
 ("y¬row"), &
´ivKey
));

222 
	`DO
(
	`ecc_v”ify_hash
 (
buf
[1], 
x
, buf[0], 16, &
¡©
, &
pubKey
));

223 
buf
[0][0] ^= 1;

224 
	`DO
(
	`ecc_v”ify_hash
 (
buf
[1], 
x
, buf[0], 16, &
¡©2
, &
´ivKey
));

225 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

226 
	`årštf
(
¡d”r
, "ecc_v”ify_hash faed %d, %d, ", 
¡©
, 
¡©2
);

229 
	`ecc_ä“
 (&
u£¿
);

230 
	`ecc_ä“
 (&
pubKey
);

231 
	`ecc_ä“
 (&
´ivKey
);

233 #ifdeà
LTC_ECC_SHAMIR


234  
	`ecc_‹¡_shamœ
();

238 
	}
}

242 
	$ecc_‹¡s
()

244 
	`årštf
(
¡d”r
, "NOP");

246 
	}
}

	@libtomcrypt/testprof/katja_test.c

1 
	~<tomüy±_‹¡.h
>

3 #ifdeà
MKAT


5 
	$k©ja_‹¡
()

7 
š
[1024], 
out
[1024], 
tmp
[1024];

8 
k©ja_key
 
key
, 
´ivKey
, 
pubKey
;

9 
hash_idx
, 
´ng_idx
, 
¡©
, 
¡©2
, 
size
;

10 
k©_msgsize
, 
Ën
, 
Ën2
, 
út
;

11 
Í¬am
[] = { 0x01, 0x02, 0x03, 0x04 };

13 
hash_idx
 = 
	`fšd_hash
("sha1");

14 
´ng_idx
 = 
	`fšd_´ng
("yarrow");

15 ià(
hash_idx
 =ğ-1 || 
´ng_idx
 == -1) {

16 
	`årštf
(
¡d”r
, "katja_test„equires SHA1‡nd yarrow");

20 
size
 = 1024; size <= 2048; size += 256) {

23 
út
 = 0; cnt < 10; cnt++) {

24 
	`DO
(
	`k©ja_make_key
(&
y¬row_´ng
, 
´ng_idx
, 
size
/8, &
key
));

25 ià(
	`mp_couÁ_b™s
(
key
.
N
è< 
size
 - 7) {

26 
	`årštf
(
¡d”r
, "k©ja_%d key modulu ha %d b™s\n", 
size
, 
	`mp_couÁ_b™s
(
key
.
N
));

28 
Ën
 = 
	`mp_unsigÃd_bš_size
(
key
.
N
);

29 
	`mp_to_unsigÃd_bš
(
key
.
N
, 
tmp
);

30 
	`årštf
(
¡d”r
, "N == \n");

31 
út
 = 0; cÁ < 
Ën
; ) {

32 
	`årštf
(
¡d”r
, "%02x ", 
tmp
[
út
]);

33 ià(!(++
út
 & 15)è
	`årštf
(
¡d”r
, "\n");

36 
Ën
 = 
	`mp_unsigÃd_bš_size
(
key
.
p
);

37 
	`mp_to_unsigÃd_bš
(
key
.
p
, 
tmp
);

38 
	`årštf
(
¡d”r
, "p == \n");

39 
út
 = 0; cÁ < 
Ën
; ) {

40 
	`årštf
(
¡d”r
, "%02x ", 
tmp
[
út
]);

41 ià(!(++
út
 & 15)è
	`årštf
(
¡d”r
, "\n");

44 
Ën
 = 
	`mp_unsigÃd_bš_size
(
key
.
q
);

45 
	`mp_to_unsigÃd_bš
(
key
.
q
, 
tmp
);

46 
	`årštf
(
¡d”r
, "\nq == \n");

47 
út
 = 0; cÁ < 
Ën
; ) {

48 
	`årštf
(
¡d”r
, "%02x ", 
tmp
[
út
]);

49 ià(!(++
út
 & 15)è
	`årštf
(
¡d”r
, "\n");

51 
	`årštf
(
¡d”r
, "\n");

56 ià(
út
 != 9) {

57 
	`k©ja_ä“
(&
key
);

61 
út
 = 0; cnt < 4; cnt++) {

62 
k©_msgsize
 = 1; kat_msgsize <= 42; kat_msgsize++) {

64 
	`y¬row_»ad
(
š
, 
k©_msgsize
, &
y¬row_´ng
);

66 
Ën
 = (
out
);

67 
Ën2
 = 
k©_msgsize
;

69 
	`DO
(
	`k©ja_’üy±_key
(
š
, 
k©_msgsize
, 
out
, &
Ën
, 
NULL
, 0, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, &
key
));

71 
out
[8] ^= 1;

72 
	`DO
(
	`k©ja_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
NULL
, 0, 
hash_idx
, &
¡©2
, &
key
));

74 
out
[8] ^= 1;

75 ià(
Ën2
 !ğ
k©_msgsize
) {

76 
	`årštf
(
¡d”r
, "\nk©ja_deüy±_key mism©ch†’ %lu (fœ¡ deüy±)", 
Ën2
);

80 
Ën2
 = 
k©_msgsize
;

81 
	`DO
(
	`k©ja_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
NULL
, 0, 
hash_idx
, &
¡©
, &
key
));

82 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

83 
	`årštf
(
¡d”r
, "katja_decrypt_key failed");

86 ià(
Ën2
 !ğ
k©_msgsize
 || 
	`memcmp
(
tmp
, 
š
, kat_msgsize)) {

87 
x
;

88 
	`årštf
(
¡d”r
, "\nk©ja_deüy±_key mism©ch,†’ %lu (£cÚd deüy±)\n", 
Ën2
);

89 
	`årštf
(
¡d”r
, "Original contents: \n");

90 
x
 = 0; x < 
k©_msgsize
; ) {

91 
	`årštf
(
¡d”r
, "%02x ", 
š
[
x
]);

92 ià(!(++
x
 % 16)) {

93 
	`årštf
(
¡d”r
, "\n");

96 
	`årštf
(
¡d”r
, "\n");

97 
	`årštf
(
¡d”r
, "Output contents: \n");

98 
x
 = 0; x < 
k©_msgsize
; ) {

99 
	`årštf
(
¡d”r
, "%02x ", 
out
[
x
]);

100 ià(!(++
x
 % 16)) {

101 
	`årštf
(
¡d”r
, "\n");

104 
	`årštf
(
¡d”r
, "\n");

111 
k©_msgsize
 = 1; kat_msgsize <= 42; kat_msgsize++) {

112 
Ën
 = (
out
);

113 
Ën2
 = 
k©_msgsize
;

114 
	`DO
(
	`k©ja_’üy±_key
(
š
, 
k©_msgsize
, 
out
, &
Ën
, 
Í¬am
, Ö·¿m), &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, &
key
));

116 
out
[8] ^= 1;

117 
	`DO
(
	`k©ja_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
Í¬am
, Ö·¿m), 
hash_idx
, &
¡©2
, &
key
));

118 ià(
Ën2
 !ğ
k©_msgsize
) {

119 
	`årštf
(
¡d”r
, "\nk©ja_deüy±_key mism©ch†’ %lu (fœ¡ deüy±)", 
Ën2
);

123 
out
[8] ^= 1;

125 
Ën2
 = 
k©_msgsize
;

126 
	`DO
(
	`k©ja_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
Í¬am
, Ö·¿m), 
hash_idx
, &
¡©
, &
key
));

127 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

128 
	`årštf
(
¡d”r
, "katja_decrypt_key failed");

131 ià(
Ën2
 !ğ
k©_msgsize
 || 
	`memcmp
(
tmp
, 
š
, kat_msgsize)) {

132 
	`årštf
(
¡d”r
, "k©ja_deüy±_key mism©ch†’ %lu", 
Ën2
);

140 
Ën
 = (
out
);

141 
	`DO
(
	`k©ja_sign_hash
(
š
, 20, 
out
, &
Ën
, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, 0, &
key
));

144 
Ën2
 = (
tmp
);

145 
	`DO
(
	`k©ja_expÜt
(
tmp
, &
Ën2
, 
PK_PRIVATE
, &
key
));

146 
	`DO
(
	`k©ja_impÜt
(
tmp
, 
Ën2
, &
´ivKey
));

147 
Ën2
 = (
tmp
);

148 
	`DO
(
	`k©ja_expÜt
(
tmp
, &
Ën2
, 
PK_PUBLIC
, &
key
));

149 
	`DO
(
	`k©ja_impÜt
(
tmp
, 
Ën2
, &
pubKey
));

152 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©
, &
key
));

154 
š
[0] ^= 1;

155 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©2
, &
key
));

157 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

158 
	`årštf
(
¡d”r
, "k©ja_v”ify_hash (un§Éed, origKeyèçed, %d, %d", 
¡©
, 
¡©2
);

159 
	`k©ja_ä“
(&
key
);

160 
	`k©ja_ä“
(&
pubKey
);

161 
	`k©ja_ä“
(&
´ivKey
);

167 
š
[0] ^= 1;

168 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©
, &
´ivKey
));

170 
š
[0] ^= 1;

171 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©2
, &
´ivKey
));

173 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

174 
	`årštf
(
¡d”r
, "k©ja_v”ify_hash (un§Éed,…rivKeyèçed, %d, %d", 
¡©
, 
¡©2
);

175 
	`k©ja_ä“
(&
key
);

176 
	`k©ja_ä“
(&
pubKey
);

177 
	`k©ja_ä“
(&
´ivKey
);

183 
š
[0] ^= 1;

184 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©
, &
pubKey
));

186 
š
[0] ^= 1;

187 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©2
, &
pubKey
));

189 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

190 
	`årštf
(
¡d”r
, "k©ja_v”ify_hash (un§Éed,…ubkeyèçed, %d, %d", 
¡©
, 
¡©2
);

191 
	`k©ja_ä“
(&
key
);

192 
	`k©ja_ä“
(&
pubKey
);

193 
	`k©ja_ä“
(&
´ivKey
);

198 
Ën
 = (
out
);

199 
	`DO
(
	`k©ja_sign_hash
(
š
, 20, 
out
, &
Ën
, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, 8, &
´ivKey
));

200 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 8, &
¡©
, &
pubKey
));

202 
š
[0] ^= 1;

203 
	`DO
(
	`k©ja_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 8, &
¡©2
, &
pubKey
));

205 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

206 
	`årštf
(
¡d”r
, "k©ja_v”ify_hash (§Éedèçed, %d, %d", 
¡©
, 
¡©2
);

207 
	`k©ja_ä“
(&
key
);

208 
	`k©ja_ä“
(&
pubKey
);

209 
	`k©ja_ä“
(&
´ivKey
);

214 
	`k©ja_ä“
(&
key
);

215 
	`k©ja_ä“
(&
pubKey
);

216 
	`k©ja_ä“
(&
´ivKey
);

221 
	}
}

225 
	$k©ja_‹¡
()

227 
	`årštf
(
¡d”r
, "NOP");

229 
	}
}

	@libtomcrypt/testprof/mac_test.c

2 
	~<tomüy±_‹¡.h
>

4 
	$mac_‹¡
()

6 #ifdeà
LTC_HMAC


7 
	`DO
(
	`hmac_‹¡
());

9 #ifdeà
LTC_PMAC


10 
	`DO
(
	`pmac_‹¡
());

12 #ifdeà
LTC_OMAC


13 
	`DO
(
	`omac_‹¡
());

15 #ifdeà
LTC_XCBC


16 
	`DO
(
	`xcbc_‹¡
());

18 #ifdeà
LTC_F9_MODE


19 
	`DO
(
	`f9_‹¡
());

21 #ifdeà
EAX_MODE


22 
	`DO
(
	`—x_‹¡
());

24 #ifdeà
OCB_MODE


25 
	`DO
(
	`ocb_‹¡
());

27 #ifdeà
CCM_MODE


28 
	`DO
(
	`ccm_‹¡
());

30 #ifdeà
GCM_MODE


31 
	`DO
(
	`gcm_‹¡
());

33 #ifdeà
PELICAN


34 
	`DO
(
	`³liÿn_‹¡
());

37 
	}
}

	@libtomcrypt/testprof/modes_test.c

2 
	~<tomüy±_‹¡.h
>

4 
	$modes_‹¡
()

6 
±
[64], 
ù
[64], 
tmp
[64], 
key
[16], 
iv
[16], 
iv2
[16];

7 
ch”_idx
;

8 #ifdeà
LTC_CBC_MODE


9 
symm‘ric_CBC
 
cbc
;

11 #ifdeà
LTC_CFB_MODE


12 
symm‘ric_CFB
 
cfb
;

14 #ifdeà
LTC_OFB_MODE


15 
symm‘ric_OFB
 
ofb
;

17 
l
;

20 
	`y¬row_»ad
(
±
, 64, &
y¬row_´ng
);

21 
	`y¬row_»ad
(
key
, 16, &
y¬row_´ng
);

22 
	`y¬row_»ad
(
iv
, 16, &
y¬row_´ng
);

25 
ch”_idx
 = 
	`fšd_ch”
("aes");

26 ià(
ch”_idx
 == -1) {

27 
	`årštf
(
¡d”r
, "test„equires AES");

31 #ifdeà
LTC_F8_MODE


32 
	`DO
(
	`f8_‹¡_mode
());

35 #ifdeà
LTC_LRW_MODE


36 
	`DO
(
	`Ìw_‹¡
());

39 #ifdeà
LTC_CBC_MODE


42 
	`DO
(
	`cbc_¡¬t
(
ch”_idx
, 
iv
, 
key
, 16, 0, &
cbc
));

43 
l
 = (
iv2
);

44 
	`DO
(
	`cbc_g‘iv
(
iv2
, &
l
, &
cbc
));

45 ià(
l
 !ğ16 || 
	`memcmp
(
iv2
, 
iv
, 16)) {

46 
	`årštf
(
¡d”r
, "cbc_getiv failed");

49 
	`DO
(
	`cbc_’üy±
(
±
, 
ù
, 64, &
cbc
));

52 
	`DO
(
	`cbc_£tiv
(
iv2
, 
l
, &
cbc
));

53 
	`z”omem
(
tmp
, (tmp));

54 
	`DO
(
	`cbc_deüy±
(
ù
, 
tmp
, 64, &
cbc
));

55 ià(
	`memcmp
(
tmp
, 
±
, 64) != 0) {

56 
	`årštf
(
¡d”r
, "CBC failed");

61 #ifdeà
LTC_CFB_MODE


64 
	`DO
(
	`cfb_¡¬t
(
ch”_idx
, 
iv
, 
key
, 16, 0, &
cfb
));

65 
l
 = (
iv2
);

66 
	`DO
(
	`cfb_g‘iv
(
iv2
, &
l
, &
cfb
));

68 ià(
l
 != 16) {

69 
	`årštf
(
¡d”r
, "cfb_getiv failed");

72 
	`DO
(
	`cfb_’üy±
(
±
, 
ù
, 64, &
cfb
));

75 
	`DO
(
	`cfb_£tiv
(
iv
, 
l
, &
cfb
));

76 
	`z”omem
(
tmp
, (tmp));

77 
	`DO
(
	`cfb_deüy±
(
ù
, 
tmp
, 64, &
cfb
));

78 ià(
	`memcmp
(
tmp
, 
±
, 64) != 0) {

79 
	`årštf
(
¡d”r
, "CFB failed");

84 #ifdeà
LTC_OFB_MODE


87 
	`DO
(
	`ofb_¡¬t
(
ch”_idx
, 
iv
, 
key
, 16, 0, &
ofb
));

88 
l
 = (
iv2
);

89 
	`DO
(
	`ofb_g‘iv
(
iv2
, &
l
, &
ofb
));

90 ià(
l
 !ğ16 || 
	`memcmp
(
iv2
, 
iv
, 16)) {

91 
	`årštf
(
¡d”r
, "ofb_getiv failed");

94 
	`DO
(
	`ofb_’üy±
(
±
, 
ù
, 64, &
ofb
));

97 
	`DO
(
	`ofb_£tiv
(
iv2
, 
l
, &
ofb
));

98 
	`z”omem
(
tmp
, (tmp));

99 
	`DO
(
	`ofb_deüy±
(
ù
, 
tmp
, 64, &
ofb
));

100 ià(
	`memcmp
(
tmp
, 
±
, 64) != 0) {

101 
	`årštf
(
¡d”r
, "OFB failed");

106 #ifdeà
LTC_CTR_MODE


107 
	`DO
(
	`ùr_‹¡
());

111 
	}
}

	@libtomcrypt/testprof/pkcs_1_test.c

1 
	~<tomüy±_‹¡.h
>

3 #ifdeà
PKCS_1


5 
	$pkcs_1_‹¡
()

7 
buf
[3][128];

8 
»s1
, 
»s2
, 
»s3
, 
´ng_idx
, 
hash_idx
, 
”r
;

9 
x
, 
y
, 
l1
, 
l2
, 
l3
, 
i1
, 
i2
, 
Í¬amËn
, 
§ÉËn
, 
modËn
;

10 cÚ¡ 
Í¬am
[] = { 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16 };

13 
hash_idx
 = 
	`fšd_hash
("sha1");

14 
´ng_idx
 = 
	`fšd_´ng
("yarrow");

16 ià(
hash_idx
 =ğ-1 || 
´ng_idx
 == -1) {

17 
	`årštf
(
¡d”r
, "pkcs_1ests„equire sha1/yarrow");

21 
	`¤ªd
(
	`time
(
NULL
));

23 
x
 = 0; x < 100; x++) {

24 
	`z”omem
(
buf
, (buf));

27 
l3
 = (
	`¿nd
() & 31) + 8;

28 
y
 = 0; y < 
l3
; y++è
buf
[0][y] = 
	`¿nd
() & 255;

31 
Í¬amËn
 = 
	`abs
(
	`¿nd
()) % 17;

34 
§ÉËn
 = 
	`abs
(
	`¿nd
()) % 17;

37 
modËn
 = 800 + (
	`abs
(
	`¿nd
()) % 224);

40 
l1
 = (
buf
[1]);

41 
	`DO
(
	`pkcs_1_ß•_’code
(
buf
[0], 
l3
, 
Í¬am
, 
Í¬amËn
, 
modËn
, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, buf[1], &
l1
));

44 
l2
 = (
buf
[2]);

45 
	`DO
(
	`pkcs_1_ß•_decode
(
buf
[1], 
l1
, 
Í¬am
, 
Í¬amËn
, 
modËn
, 
hash_idx
, buf[2], &
l2
, &
»s1
));

47 ià(
»s1
 !ğ1 || 
l2
 !ğ
l3
 || 
	`memcmp
(
buf
[2], buf[0],†3) != 0) {

48 
	`årštf
(
¡d”r
, "Outsiz=ğ%lu, should havb“À%lu,„es1 = %d,†·¿mËÀğ%lu, msg cÚ‹Á fŞlow.\n", 
l2
, 
l3
, 
»s1
, 
Í¬amËn
);

49 
	`årštf
(
¡d”r
, "ORIGINAL:\n");

50 
x
 = 0; x < 
l3
; x++) {

51 
	`årštf
(
¡d”r
, "%02x ", 
buf
[0][
x
]);

53 
	`årštf
(
¡d”r
, "\nRESULT:\n");

54 
x
 = 0; x < 
l2
; x++) {

55 
	`årštf
(
¡d”r
, "%02x ", 
buf
[2][
x
]);

57 
	`årštf
(
¡d”r
, "\n\n");

62 
l1
 = (
buf
[1]);

63 
	`DO
(
	`pkcs_1_pss_’code
(
buf
[0], 
l3
, 
§ÉËn
, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, 
modËn
, buf[1], &
l1
));

64 
	`DO
(
	`pkcs_1_pss_decode
(
buf
[0], 
l3
, buf[1], 
l1
, 
§ÉËn
, 
hash_idx
, 
modËn
, &
»s1
));

66 
buf
[0][
i1
 = 
	`abs
(
	`¿nd
()è% 
l3
] ^= 1;

67 
	`DO
(
	`pkcs_1_pss_decode
(
buf
[0], 
l3
, buf[1], 
l1
, 
§ÉËn
, 
hash_idx
, 
modËn
, &
»s2
));

69 
buf
[0][
i1
] ^= 1;

70 
buf
[1][
i2
 = 
	`abs
(
	`¿nd
()è% (
l1
 - 1)] ^= 1;

71 
	`pkcs_1_pss_decode
(
buf
[0], 
l3
, buf[1], 
l1
, 
§ÉËn
, 
hash_idx
, 
modËn
, &
»s3
);

72 ià(!(
»s1
 =ğ1 && 
»s2
 =ğ0 && 
»s3
 == 0)) {

73 
	`årštf
(
¡d”r
, "PSS faed: %d, %d, %d, %lu, %lu\n", 
»s1
, 
»s2
, 
»s3
, 
l3
, 
§ÉËn
);

78 
	}
}

82 
	$pkcs_1_‹¡
()

84 
	`årštf
(
¡d”r
, "NOP");

86 
	}
}

	@libtomcrypt/testprof/rsa_test.c

1 
	~<tomüy±_‹¡.h
>

3 #ifdeà
MRSA


5 
	#RSA_MSGSIZE
 78

	)

8 cÚ¡ 
	gİ’s¦_´iv©e_r§
[] = {

51 cÚ¡ 
	gİ’s¦_public_r§
[] = {

65 cÚ¡ 
	gİ’s¦_public_r§_¡r³d
[] = {

77 
	$r§_com·t_‹¡
()

79 
r§_key
 
key
;

80 
buf
[1024];

81 
Ën
;

84 
	`DO
(
	`r§_impÜt
(
İ’s¦_´iv©e_r§
, (İ’s¦_´iv©e_r§), &
key
));

87 
Ën
 = (
buf
);

88 
	`DO
(
	`r§_expÜt
(
buf
, &
Ën
, 
PK_PRIVATE
, &
key
));

89 ià(
Ën
 !ğ(
İ’s¦_´iv©e_r§
è|| 
	`memcmp
(
buf
, openssl_private_rsa,†en)) {

90 
	`årštf
(
¡d”r
, "RSA…riv©expÜˆçedØm©ch O³nSSL ouut, %lu, %lu\n", 
Ën
, ()(
İ’s¦_´iv©e_r§
));

94 
Ën
 = (
buf
);

95 
	`DO
(
	`r§_expÜt
(
buf
, &
Ën
, 
PK_PUBLIC
, &
key
));

96 ià(
Ën
 !ğ(
İ’s¦_public_r§_¡r³d
è|| 
	`memcmp
(
buf
, openssl_public_rsa_stripped,†en)) {

97 
	`årštf
(
¡d”r
, "RSA(private)…ublicƒxport failedo match OpenSSL output\n");

100 
	`r§_ä“
(&
key
);

103 
	`DO
(
	`r§_impÜt
(
İ’s¦_public_r§_¡r³d
, (İ’s¦_public_r§_¡r³d), &
key
));

104 
Ën
 = (
buf
);

105 
	`DO
(
	`r§_expÜt
(
buf
, &
Ën
, 
PK_PUBLIC
, &
key
));

106 ià(
Ën
 !ğ(
İ’s¦_public_r§_¡r³d
è|| 
	`memcmp
(
buf
, openssl_public_rsa_stripped,†en)) {

107 
	`årštf
(
¡d”r
, "RSA(public) stripped…ublic import failedo match OpenSSL output\n");

110 
	`r§_ä“
(&
key
);

113 
	`DO
(
	`r§_impÜt
(
İ’s¦_public_r§
, (İ’s¦_public_r§), &
key
));

114 
Ën
 = (
buf
);

115 
	`DO
(
	`r§_expÜt
(
buf
, &
Ën
, 
PK_PUBLIC
, &
key
));

116 ià(
Ën
 !ğ(
İ’s¦_public_r§_¡r³d
è|| 
	`memcmp
(
buf
, openssl_public_rsa_stripped,†en)) {

117 
	`årštf
(
¡d”r
, "RSA(public) SSL…ublic import failedo match OpenSSL output\n");

120 
	`r§_ä“
(&
key
);

123 
	}
}

125 
	$r§_‹¡
()

127 
š
[1024], 
out
[1024], 
tmp
[1024];

128 
r§_key
 
key
, 
´ivKey
, 
pubKey
;

129 
hash_idx
, 
´ng_idx
, 
¡©
, 
¡©2
;

130 
r§_msgsize
, 
Ën
, 
Ën2
, 
út
;

131 
Í¬am
[] = { 0x01, 0x02, 0x03, 0x04 };

133 ià(
	`r§_com·t_‹¡
() != 0) {

137 
hash_idx
 = 
	`fšd_hash
("sha1");

138 
´ng_idx
 = 
	`fšd_´ng
("yarrow");

139 ià(
hash_idx
 =ğ-1 || 
´ng_idx
 == -1) {

140 
	`årštf
(
¡d”r
, "rsa_test„equires SHA1‡nd yarrow");

145 
út
 = 0; cnt < 10; cnt++) {

146 
	`DO
(
	`r§_make_key
(&
y¬row_´ng
, 
´ng_idx
, 1024/8, 65537, &
key
));

147 ià(
	`mp_couÁ_b™s
(
key
.
N
) != 1024) {

148 
	`årštf
(
¡d”r
, "r§_1024 key modulu ha %d b™s\n", 
	`mp_couÁ_b™s
(
key
.
N
));

150 
Ën
 = 
	`mp_unsigÃd_bš_size
(
key
.
N
);

151 
	`mp_to_unsigÃd_bš
(
key
.
N
, 
tmp
);

152 
	`årštf
(
¡d”r
, "N == \n");

153 
út
 = 0; cÁ < 
Ën
; ) {

154 
	`årštf
(
¡d”r
, "%02x ", 
tmp
[
út
]);

155 ià(!(++
út
 & 15)è
	`årštf
(
¡d”r
, "\n");

158 
Ën
 = 
	`mp_unsigÃd_bš_size
(
key
.
p
);

159 
	`mp_to_unsigÃd_bš
(
key
.
p
, 
tmp
);

160 
	`årštf
(
¡d”r
, "p == \n");

161 
út
 = 0; cÁ < 
Ën
; ) {

162 
	`årštf
(
¡d”r
, "%02x ", 
tmp
[
út
]);

163 ià(!(++
út
 & 15)è
	`årštf
(
¡d”r
, "\n");

166 
Ën
 = 
	`mp_unsigÃd_bš_size
(
key
.
q
);

167 
	`mp_to_unsigÃd_bš
(
key
.
q
, 
tmp
);

168 
	`årštf
(
¡d”r
, "\nq == \n");

169 
út
 = 0; cÁ < 
Ën
; ) {

170 
	`årštf
(
¡d”r
, "%02x ", 
tmp
[
út
]);

171 ià(!(++
út
 & 15)è
	`årštf
(
¡d”r
, "\n");

173 
	`årštf
(
¡d”r
, "\n");

178 ià(
út
 != 9) {

179 
	`r§_ä“
(&
key
);

184 
út
 = 0; cnt < 4; cnt++) {

185 
r§_msgsize
 = 1;„sa_msgsize <= 86;„sa_msgsize++) {

187 
	`y¬row_»ad
(
š
, 
r§_msgsize
, &
y¬row_´ng
);

189 
Ën
 = (
out
);

190 
Ën2
 = 
r§_msgsize
;

192 
	`DO
(
	`r§_’üy±_key
(
š
, 
r§_msgsize
, 
out
, &
Ën
, 
NULL
, 0, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, &
key
));

194 
out
[8] ^= 1;

195 
	`DO
(
	`r§_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
NULL
, 0, 
hash_idx
, &
¡©2
, &
key
));

197 
out
[8] ^= 1;

198 ià(
Ën2
 !ğ
r§_msgsize
) {

199 
	`årštf
(
¡d”r
, "\Ä§_deüy±_key mism©ch†’ %lu (fœ¡ deüy±)", 
Ën2
);

203 
Ën2
 = 
r§_msgsize
;

204 
	`DO
(
	`r§_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
NULL
, 0, 
hash_idx
, &
¡©
, &
key
));

205 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

206 
	`årštf
(
¡d”r
, "rsa_decrypt_key failed");

209 ià(
Ën2
 !ğ
r§_msgsize
 || 
	`memcmp
(
tmp
, 
š
,„sa_msgsize)) {

210 
x
;

211 
	`årštf
(
¡d”r
, "\Ä§_deüy±_key mism©ch,†’ %lu (£cÚd deüy±)\n", 
Ën2
);

212 
	`årštf
(
¡d”r
, "Original contents: \n");

213 
x
 = 0; x < 
r§_msgsize
; ) {

214 
	`årštf
(
¡d”r
, "%02x ", 
š
[
x
]);

215 ià(!(++
x
 % 16)) {

216 
	`årštf
(
¡d”r
, "\n");

219 
	`årštf
(
¡d”r
, "\n");

220 
	`årštf
(
¡d”r
, "Output contents: \n");

221 
x
 = 0; x < 
r§_msgsize
; ) {

222 
	`årštf
(
¡d”r
, "%02x ", 
out
[
x
]);

223 ià(!(++
x
 % 16)) {

224 
	`årštf
(
¡d”r
, "\n");

227 
	`årštf
(
¡d”r
, "\n");

234 
r§_msgsize
 = 1;„sa_msgsize <= 86;„sa_msgsize++) {

235 
Ën
 = (
out
);

236 
Ën2
 = 
r§_msgsize
;

237 
	`DO
(
	`r§_’üy±_key
(
š
, 
r§_msgsize
, 
out
, &
Ën
, 
Í¬am
, Ö·¿m), &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, &
key
));

239 
out
[8] ^= 1;

240 
	`DO
(
	`r§_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
Í¬am
, Ö·¿m), 
hash_idx
, &
¡©2
, &
key
));

241 ià(
Ën2
 !ğ
r§_msgsize
) {

242 
	`årštf
(
¡d”r
, "\Ä§_deüy±_key mism©ch†’ %lu (fœ¡ deüy±)", 
Ën2
);

246 
out
[8] ^= 1;

248 
Ën2
 = 
r§_msgsize
;

249 
	`DO
(
	`r§_deüy±_key
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
Í¬am
, Ö·¿m), 
hash_idx
, &
¡©
, &
key
));

250 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

251 
	`årštf
(
¡d”r
, "rsa_decrypt_key failed");

254 ià(
Ën2
 !ğ
r§_msgsize
 || 
	`memcmp
(
tmp
, 
š
,„sa_msgsize)) {

255 
	`årštf
(
¡d”r
, "r§_deüy±_key mism©ch†’ %lu", 
Ën2
);

261 
r§_msgsize
 = 1;„sa_msgsize <= 117;„sa_msgsize++) {

262 
Ën
 = (
out
);

263 
Ën2
 = 
r§_msgsize
;

264 
	`DO
(
	`r§_’üy±_key_ex
(
š
, 
r§_msgsize
, 
out
, &
Ën
, 
NULL
, 0, &
y¬row_´ng
, 
´ng_idx
, 0, 
LTC_PKCS_1_V1_5
, &
key
));

266 
Ën2
 = 
r§_msgsize
;

267 
	`DO
(
	`r§_deüy±_key_ex
(
out
, 
Ën
, 
tmp
, &
Ën2
, 
NULL
, 0, 0, 
LTC_PKCS_1_V1_5
, &
¡©
, &
key
));

268 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

269 
	`årštf
(
¡d”r
, "r§_deüy±_key_ex faed, %d, %d", 
¡©
, 
¡©2
);

272 ià(
Ën2
 !ğ
r§_msgsize
 || 
	`memcmp
(
tmp
, 
š
,„sa_msgsize)) {

273 
	`årštf
(
¡d”r
, "r§_deüy±_key_ex mism©ch†’ %lu", 
Ën2
);

279 
Ën
 = (
out
);

280 
	`DO
(
	`r§_sign_hash
(
š
, 20, 
out
, &
Ën
, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, 0, &
key
));

283 
Ën2
 = (
tmp
);

284 
	`DO
(
	`r§_expÜt
(
tmp
, &
Ën2
, 
PK_PRIVATE
, &
key
));

285 
	`DO
(
	`r§_impÜt
(
tmp
, 
Ën2
, &
´ivKey
));

286 
Ën2
 = (
tmp
);

287 
	`DO
(
	`r§_expÜt
(
tmp
, &
Ën2
, 
PK_PUBLIC
, &
key
));

288 
	`DO
(
	`r§_impÜt
(
tmp
, 
Ën2
, &
pubKey
));

291 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©
, &
key
));

293 
š
[0] ^= 1;

294 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©2
, &
key
));

296 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

297 
	`årštf
(
¡d”r
, "r§_v”ify_hash (un§Éed, origKeyèçed, %d, %d", 
¡©
, 
¡©2
);

298 
	`r§_ä“
(&
key
);

299 
	`r§_ä“
(&
pubKey
);

300 
	`r§_ä“
(&
´ivKey
);

306 
š
[0] ^= 1;

307 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©
, &
´ivKey
));

309 
š
[0] ^= 1;

310 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©2
, &
´ivKey
));

312 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

313 
	`årštf
(
¡d”r
, "r§_v”ify_hash (un§Éed,…rivKeyèçed, %d, %d", 
¡©
, 
¡©2
);

314 
	`r§_ä“
(&
key
);

315 
	`r§_ä“
(&
pubKey
);

316 
	`r§_ä“
(&
´ivKey
);

322 
š
[0] ^= 1;

323 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©
, &
pubKey
));

325 
š
[0] ^= 1;

326 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 0, &
¡©2
, &
pubKey
));

328 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

329 
	`årštf
(
¡d”r
, "r§_v”ify_hash (un§Éed,…ubkeyèçed, %d, %d", 
¡©
, 
¡©2
);

330 
	`r§_ä“
(&
key
);

331 
	`r§_ä“
(&
pubKey
);

332 
	`r§_ä“
(&
´ivKey
);

337 
Ën
 = (
out
);

338 
	`DO
(
	`r§_sign_hash
(
š
, 20, 
out
, &
Ën
, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, 8, &
´ivKey
));

339 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 8, &
¡©
, &
pubKey
));

341 
š
[0] ^= 1;

342 
	`DO
(
	`r§_v”ify_hash
(
out
, 
Ën
, 
š
, 20, 
hash_idx
, 8, &
¡©2
, &
pubKey
));

344 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

345 
	`årštf
(
¡d”r
, "r§_v”ify_hash (§Éedèçed, %d, %d", 
¡©
, 
¡©2
);

346 
	`r§_ä“
(&
key
);

347 
	`r§_ä“
(&
pubKey
);

348 
	`r§_ä“
(&
´ivKey
);

353 
Ën
 = (
out
);

354 
	`DO
(
	`r§_sign_hash_ex
(
š
, 20, 
out
, &
Ën
, 
LTC_PKCS_1_V1_5
, &
y¬row_´ng
, 
´ng_idx
, 
hash_idx
, 8, &
´ivKey
));

355 
	`DO
(
	`r§_v”ify_hash_ex
(
out
, 
Ën
, 
š
, 20, 
LTC_PKCS_1_V1_5
, 
hash_idx
, 8, &
¡©
, &
pubKey
));

357 
š
[0] ^= 1;

358 
	`DO
(
	`r§_v”ify_hash_ex
(
out
, 
Ën
, 
š
, 20, 
LTC_PKCS_1_V1_5
, 
hash_idx
, 8, &
¡©2
, &
pubKey
));

360 ià(!(
¡©
 =ğ1 && 
¡©2
 == 0)) {

361 
	`årštf
(
¡d”r
, "r§_v”ify_hash_ex faed, %d, %d", 
¡©
, 
¡©2
);

362 
	`r§_ä“
(&
key
);

363 
	`r§_ä“
(&
pubKey
);

364 
	`r§_ä“
(&
´ivKey
);

369 
	`r§_ä“
(&
key
);

370 
	`r§_ä“
(&
pubKey
);

371 
	`r§_ä“
(&
´ivKey
);

373 
	}
}

377 
	$r§_‹¡
()

379 
	`årštf
(
¡d”r
, "NOP");

381 
	}
}

	@libtomcrypt/testprof/store_test.c

1 
	~<tomüy±_‹¡.h
>

4 
	$¡Üe_‹¡
()

6 
buf
[256];

7 
y
;

8 
ulÚg32
 
L
, 
L1
;

9 
ulÚg64
 
LL
, 
LL1
;

10 #ifdeà
LTC_FAST


11 
x
, 
z
;

14 
y
 = 0; y < 4; y++) {

15 
L
 = 0x12345678UL;

16 
L1
 = 0;

17 
	`STORE32L
(
L
, 
buf
 + 
y
);

18 
	`LOAD32L
(
L1
, 
buf
 + 
y
);

19 ià(
L1
 !ğ
L
) {

20 
	`årštf
(
¡d”r
, "\n32L faed‡ˆoff£ˆ%d\n", 
y
);

23 
	`STORE32H
(
L
, 
buf
 + 
y
);

24 
	`LOAD32H
(
L1
, 
buf
 + 
y
);

25 ià(
L1
 !ğ
L
) {

26 
	`årštf
(
¡d”r
, "\n32H faed‡ˆoff£ˆ%d\n", 
y
);

31 
y
 = 0; y < 8; y++) {

32 
LL
 = 
	`CONST64
 (0x01020304050607);

33 
LL1
 = 0;

34 
	`STORE64L
(
LL
, 
buf
 + 
y
);

35 
	`LOAD64L
(
LL1
, 
buf
 + 
y
);

36 ià(
LL1
 !ğ
LL
) {

37 
	`årštf
(
¡d”r
, "\n64L faed‡ˆoff£ˆ%d\n", 
y
);

40 
	`STORE64H
(
LL
, 
buf
 + 
y
);

41 
	`LOAD64H
(
LL1
, 
buf
 + 
y
);

42 ià(
LL1
 !ğ
LL
) {

43 
	`årštf
(
¡d”r
, "\n64H faed‡ˆoff£ˆ%d\n", 
y
);

49 #ifdeà
LTC_FAST


50 
y
 = 16;

52 
z
 = 0; z < 
y
; z++) {

54 
	`y¬row_»ad
(
buf
+
z
, 
y
, &
y¬row_´ng
);

55 
	`y¬row_»ad
(
buf
+
z
+
y
, y, &
y¬row_´ng
);

58 
x
 = 0; x < 
y
; x++) {

59 
buf
[2*
y
+
z
+
x
] = buf[z+x] ^ buf[z+y+x];

63 
x
 = 0; x < 
y
; x +ğ(
LTC_FAST_TYPE
)) {

64 *((
LTC_FAST_TYPE
*)(&
buf
[3*
y
+
z
+
x
])) = *((LTC_FAST_TYPE*)(&buf[z+x])) ^ *((LTC_FAST_TYPE*)(&buf[z+y+x]));

67 ià(
	`memcmp
(&
buf
[2*
y
+
z
], &buf[3*y+z], y)) {

68 
	`årštf
(
¡d”r
, "\nLTC_FAST faed‡ˆoff£ˆ%d\n", 
z
);

74 
	}
}

	@libtomcrypt/testprof/test_driver.c

1 
	~<tomüy±_‹¡.h
>

3 
	$run_cmd
(
»s
, 
lše
, *
fe
, *
cmd
)

5 ià(
»s
 !ğ
CRYPT_OK
) {

6 
	`årštf
(
¡d”r
, "% (%d)\n%s:%d:%s\n", 
	`”rÜ_to_¡ršg
(
»s
),„es, 
fe
, 
lše
, 
cmd
);

7 ià(
»s
 !ğ
CRYPT_NOP
) {

8 
	`ex™
(
EXIT_FAILURE
);

11 
	}
}

	@libtomcrypt/testprof/tomcrypt_test.h

2 #iâdeà
__TEST_H_


3 
	#__TEST_H_


	)

5 
	~<tomüy±.h
>

11 
	#STACK_DOWN


	)

14 *
	mÇme
, *
	m´ov
, *
	m»q
;

15 (*
	m’Œy
)();

16 } 
	t‹¡_’Œy
;

18 
´ng_¡©e
 
y¬row_´ng
;

20 
run_cmd
(
»s
, 
lše
, *
fe
, *
cmd
);

22 #ifdeà
LTC_VERBOSE


23 
	#DO
(
x
èdØ{ 
	`årštf
(
¡d”r
, "%s:\n", #x); 
	`run_cmd
((x), 
__LINE__
, 
__FILE__
, #x); } 0);

	)

25 
	#DO
(
x
èdØ{ 
	`run_cmd
((x), 
__LINE__
, 
__FILE__
, #x); } 0);

	)

29 
ch”_hash_‹¡
();

30 
modes_‹¡
();

31 
mac_‹¡
();

32 
pkcs_1_‹¡
();

33 
¡Üe_‹¡
();

34 
r§_‹¡
();

35 
k©ja_‹¡
();

36 
ecc_‹¡s
();

37 
d§_‹¡
();

38 
d”_‹¡s
();

41 
	#KTIMES
 25

	)

42 
	#TIMES
 100000

	)

44 
	sli¡
 {

45 
id
;

46 
¥d1
, 
¥d2
, 
avg
;

47 } 
»suÉs
[];

49 
no_»suÉs
;

51 
sÜ‹r
(cÚ¡ *
a
, cÚ¡ *
b
);

52 
Îy_»suÉs
(
ty³
);

53 
ulÚg64
 
rdtsc
 ();

55 
t_¡¬t
();

56 
ulÚg64
 
t_»ad
();

57 
š™_tim”
();

60 
»g_®gs
();

61 
time_keysched
();

62 
time_ch”
();

63 
time_ch”2
();

64 
time_ch”3
();

65 
time_hash
();

66 
time_muÉ
();

67 
time_sqr
();

68 
time_´ng
();

69 
time_r§
();

70 
time_d§
();

71 
time_k©ja
();

72 
time_ecc
();

73 
time_macs_
(
MAC_SIZE
);

74 
time_macs
();

75 
time_’cmacs
();

	@libtomcrypt/testprof/x86_prof.c

1 
	~<tomüy±_‹¡.h
>

3 
´ng_¡©e
 
	gy¬row_´ng
;

5 
li¡
 
	g»suÉs
[100];

6 
	gno_»suÉs
;

7 
	$sÜ‹r
(cÚ¡ *
a
, cÚ¡ *
b
)

9 cÚ¡ 
li¡
 *
A
, *
B
;

10 
A
 = 
a
;

11 
B
 = 
b
;

12 ià(
A
->
avg
 < 
B
->avg)  -1;

13 ià(
A
->
avg
 > 
B
->avg)  1;

15 
	}
}

17 
	$Îy_»suÉs
(
ty³
)

19 
x
;

22 
	`qsÜt
(
»suÉs
, 
no_»suÉs
, (
li¡
), &
sÜ‹r
);

24 
	`årštf
(
¡d”r
, "\n");

25 ià(
ty³
 == 0) {

26 
x
 = 0; x < 
no_»suÉs
; x++) {

27 
	`årštf
(
¡d”r
, "%-20s: ScheduË‡ˆ%6lu\n", 
ch”_desütÜ
[
»suÉs
[
x
].
id
].
Çme
, (ìesuÉs[x].
¥d1
);

29 } ià(
ty³
 == 1) {

30 
x
 = 0; x < 
no_»suÉs
; x++) {

31 
´štf


32 ("%-20s[%3d]: Enüy±‡ˆ%5lu, Deüy±‡ˆ%5lu\n", 
ch”_desütÜ
[
»suÉs
[
x
].
id
].
Çme
, ch”_desütÜ[»suÉs[x].id].
ID
,„esuÉs[x].
¥d1
,„esuÉs[x].
¥d2
);

35 
x
 = 0; x < 
no_»suÉs
; x++) {

36 
´štf


37 ("%-20s: Proûs © %5lu\n", 
hash_desütÜ
[
»suÉs
[
x
].
id
].
Çme
,„esuÉs[x].
¥d1
 / 1000);

40 
	}
}

43 
ulÚg64
 
	$rdtsc
 ()

45 #ià
defšed
 
__GNUC__
 && !
	`defšed
(
LTC_NO_ASM
)

46 #ifdeà
INTEL_CC


47 
ulÚg64
 
a
;

48 
	`asm
 ( "„dtsø":"=A"(
a
));

49  
a
;

50 #–ià
	`defšed
(
__i386__
è|| defšed(
__x86_64__
)

51 
ulÚg64
 
a
;

52 
asm
 
	`__vŞ©e__
 ("rdtsc\nmovÈ%%—x,(%0)\nmovÈ%%edx,4(%0)\n"::"r"(&
a
):"%eax","%edx");

53  
a
;

54 #–ià
	`defšed
(
LTC_PPC32
è|| defšed(
TFM_PPC32
)

55 
a
, 
b
;

56 
__asm__
 
	`__vŞ©e__
 ("mábu %1 \nmáb %0\n":"ô"(
a
), "ô"(
b
));

57  (((
ulÚg64
)
b
è<< 32ULLè| ((ulÚg64)
a
);

58 #–ià
	`defšed
(
__Ÿ64__
)

59 
»suÉ
;

60 
__asm__
 
	`__vŞ©e__
("mov %0÷r.™c" : "ô"(
»suÉ
) :: "memory");

61 
	`__butš_ex³ù
 ((è
»suÉ
 == -1, 0))

62 
__asm__
 
	`__vŞ©e__
("mov %0÷r.™c" : "ô"(
»suÉ
) :: "memory");

63  
»suÉ
;

64 #–ià
	`defšed
(
__¥¬c__
)

65 #ià
	`defšed
(
__¬ch64__
)

66 
ulÚg64
 
a
;

67 
asm
 vŞ©e("rd %%tick,%0" : "ô" (
a
));

68  
a
;

70 
x
, 
y
;

71 
__asm__
 
	`__vŞ©e__
 ("rd %%tick, %0; cÌuw %0, %1; s¾x %0, 32, %0" : "ô" (
x
), "ô" (
y
) : "0" (x), "1" (y));

72  ((è
x
 << 32è| 
y
;

75  
	`XCLOCK
();

79 #–ià
defšed
 
_M_IX86
 && !
	`defšed
(
LTC_NO_ASM
)

80 
__asm
 
rdtsc


81 #–ià
defšed
 
_M_AMD64
 && !
	`defšed
(
LTC_NO_ASM
)

82  
	`__rdtsc
 ();

83 #–ià
defšed
 
_M_IA64
 && !
	`defšed
(
LTC_NO_ASM
)

84 #ià
defšed
 
__INTEL_COMPILER


85 
	~<Ÿ64šŒš.h
>

87  
	`__g‘Reg
 (3116);

89  
	`XCLOCK
();

91 
	}
}

93 
ulÚg64
 
	gtim”
, 
	gskew
 = 0;

95 
	$t_¡¬t
()

97 
tim”
 = 
	`rdtsc
();

98 
	}
}

100 
ulÚg64
 
	$t_»ad
()

102  
	`rdtsc
(è- 
tim”
;

103 
	}
}

105 
	$š™_tim”
()

107 
ulÚg64
 
c1
, 
c2
, 
t1
, 
t2
, 
t3
;

108 
y1
;

110 
c1
 = 
c2
 = (
ulÚg64
)-1;

111 
y1
 = 0; y1 < 
TIMES
*100; y1++) {

112 
	`t_¡¬t
();

113 
t1
 = 
	`t_»ad
();

114 
t3
 = 
	`t_»ad
();

115 
t2
 = (
	`t_»ad
(è- 
t1
)>>1;

117 
c1
 = (
t1
 > c1) ?1 : c1;

118 
c2
 = (
t2
 > c2) ?2 : c2;

120 
skew
 = 
c2
 - 
c1
;

121 
	`årštf
(
¡d”r
, "Clock Skew: %lu\n", ()
skew
);

122 
	}
}

124 
	$»g_®gs
()

126 
”r
;

127 #ifdeà
RIJNDAEL


128 
	`»gi¡”_ch”
 (&
«s_desc
);

130 #ifdeà
BLOWFISH


131 
	`»gi¡”_ch”
 (&
blowfish_desc
);

133 #ifdeà
XTEA


134 
	`»gi¡”_ch”
 (&
x‹a_desc
);

136 #ifdeà
RC5


137 
	`»gi¡”_ch”
 (&
rc5_desc
);

139 #ifdeà
RC6


140 
	`»gi¡”_ch”
 (&
rc6_desc
);

142 #ifdeà
SAFERP


143 
	`»gi¡”_ch”
 (&
§ã½_desc
);

145 #ifdeà
TWOFISH


146 
	`»gi¡”_ch”
 (&
twofish_desc
);

148 #ifdeà
SAFER


149 
	`»gi¡”_ch”
 (&
§ãr_k64_desc
);

150 
	`»gi¡”_ch”
 (&
§ãr_sk64_desc
);

151 
	`»gi¡”_ch”
 (&
§ãr_k128_desc
);

152 
	`»gi¡”_ch”
 (&
§ãr_sk128_desc
);

154 #ifdeà
RC2


155 
	`»gi¡”_ch”
 (&
rc2_desc
);

157 #ifdeà
DES


158 
	`»gi¡”_ch”
 (&
des_desc
);

159 
	`»gi¡”_ch”
 (&
des3_desc
);

161 #ifdeà
CAST5


162 
	`»gi¡”_ch”
 (&
ÿ¡5_desc
);

164 #ifdeà
NOEKEON


165 
	`»gi¡”_ch”
 (&
nÛkeÚ_desc
);

167 #ifdeà
SKIPJACK


168 
	`»gi¡”_ch”
 (&
skjack_desc
);

170 #ifdeà
KHAZAD


171 
	`»gi¡”_ch”
 (&
khazad_desc
);

173 #ifdeà
ANUBIS


174 
	`»gi¡”_ch”
 (&
ªubis_desc
);

176 #ifdeà
KSEED


177 
	`»gi¡”_ch”
 (&
k£ed_desc
);

179 #ifdeà
LTC_KASUMI


180 
	`»gi¡”_ch”
 (&
kasumi_desc
);

183 #ifdeà
TIGER


184 
	`»gi¡”_hash
 (&
tig”_desc
);

186 #ifdeà
MD2


187 
	`»gi¡”_hash
 (&
md2_desc
);

189 #ifdeà
MD4


190 
	`»gi¡”_hash
 (&
md4_desc
);

192 #ifdeà
MD5


193 
	`»gi¡”_hash
 (&
md5_desc
);

195 #ifdeà
SHA1


196 
	`»gi¡”_hash
 (&
sha1_desc
);

198 #ifdeà
SHA224


199 
	`»gi¡”_hash
 (&
sha224_desc
);

201 #ifdeà
SHA256


202 
	`»gi¡”_hash
 (&
sha256_desc
);

204 #ifdeà
SHA384


205 
	`»gi¡”_hash
 (&
sha384_desc
);

207 #ifdeà
SHA512


208 
	`»gi¡”_hash
 (&
sha512_desc
);

210 #ifdeà
RIPEMD128


211 
	`»gi¡”_hash
 (&
rmd128_desc
);

213 #ifdeà
RIPEMD160


214 
	`»gi¡”_hash
 (&
rmd160_desc
);

216 #ifdeà
RIPEMD256


217 
	`»gi¡”_hash
 (&
rmd256_desc
);

219 #ifdeà
RIPEMD320


220 
	`»gi¡”_hash
 (&
rmd320_desc
);

222 #ifdeà
WHIRLPOOL


223 
	`»gi¡”_hash
 (&
whœÍoŞ_desc
);

225 #ifdeà
CHC_HASH


226 
	`»gi¡”_hash
(&
chc_desc
);

227 ià((
”r
 = 
	`chc_»gi¡”
(
	`»gi¡”_ch”
(&
«s_desc
))è!ğ
CRYPT_OK
) {

228 
	`årštf
(
¡d”r
, "chc_»gi¡”ƒ¼Ü: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

229 
	`ex™
(
EXIT_FAILURE
);

234 #iâdeà
YARROW


235 #”rÜ 
This
 
demo
 
»quœes
 
Y¬row
.

237 
	`»gi¡”_´ng
(&
y¬row_desc
);

238 #ifdeà
FORTUNA


239 
	`»gi¡”_´ng
(&
fÜtuÇ_desc
);

241 #ifdeà
RC4


242 
	`»gi¡”_´ng
(&
rc4_desc
);

244 #ifdeà
SOBER128


245 
	`»gi¡”_´ng
(&
sob”128_desc
);

248 ià((
”r
 = 
	`ºg_make_´ng
(128, 
	`fšd_´ng
("y¬row"), &
y¬row_´ng
, 
NULL
)è!ğ
CRYPT_OK
) {

249 
	`årštf
(
¡d”r
, "ºg_make_´ng faed: %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

250 
	`ex™
(
EXIT_FAILURE
);

253 
	}
}

255 
	$time_keysched
()

257 
x
, 
y1
;

258 
ulÚg64
 
t1
, 
c1
;

259 
symm‘ric_key
 
skey
;

260 
kl
;

261 (*
func
è(cÚ¡ *, , , 
symm‘ric_key
 *);

262 
key
[
MAXBLOCKSIZE
];

264 
	`årštf
(
¡d”r
, "\n\nKey Schedule Time Trials forhe Symmetric Ciphers:\n(Times‡re cycles…er key)\n");

265 
no_»suÉs
 = 0;

266 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

267 
	#DO1
(
k
è
	`func
(k, 
kl
, 0, &
skey
);

	)

269 
func
 = 
ch”_desütÜ
[
x
].
£tup
;

270 
kl
 = 
ch”_desütÜ
[
x
].
mš_key_Ëngth
;

271 
c1
 = (
ulÚg64
)-1;

272 
y1
 = 0; y1 < 
KTIMES
; y1++) {

273 
	`y¬row_»ad
(
key
, 
kl
, &
y¬row_´ng
);

274 
	`t_¡¬t
();

275 
	`DO1
(
key
);

276 
t1
 = 
	`t_»ad
();

277 
c1
 = (
t1
 > c1) ? c1 :1;

279 
t1
 = 
c1
 - 
skew
;

280 
»suÉs
[
no_»suÉs
].
¥d1
 =„esuÉs[no_»suÉs].
avg
 = 
t1
;

281 
»suÉs
[
no_»suÉs
++].
id
 = 
x
;

282 
	`årštf
(
¡d”r
, "."); 
	`fæush
(
¡dout
);

284 #undeà
DO1


286 
	`Îy_»suÉs
(0);

289 
	}
}

291 
	$time_ch”
()

293 
x
, 
y1
;

294 
ulÚg64
 
t1
, 
t2
, 
c1
, 
c2
, 
a1
, 
a2
;

295 
symm‘ric_ECB
 
ecb
;

296 
key
[
MAXBLOCKSIZE
], 
±
[4096];

297 
”r
;

299 
	`årštf
(
¡d”r
, "\n\nECB Time Trials forhe Symmetric Ciphers:\n");

300 
no_»suÉs
 = 0;

301 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

302 
	`ecb_¡¬t
(
x
, 
key
, 
ch”_desütÜ
[x].
mš_key_Ëngth
, 0, &
ecb
);

305 ià((
”r
 = 
ch”_desütÜ
[
x
].
	`‹¡
()è!ğ
CRYPT_OK
) {

306 
	`årštf
(
¡d”r
, "\n\nERROR: Ch” % çed s–f-‹¡ %s\n", 
ch”_desütÜ
[
x
].
Çme
, 
	`”rÜ_to_¡ršg
(
”r
));

307 
	`ex™
(
EXIT_FAILURE
);

310 
	#DO1
 
	`ecb_’üy±
(
±
,…t, Õt), &
ecb
);

	)

311 
	#DO2
 
DO1
 
	)
DO1

313 
c1
 = 
c2
 = (
ulÚg64
)-1;

314 
y1
 = 0; y1 < 100; y1++) {

315 
	`t_¡¬t
();

316 
DO1
;

317 
t1
 = 
	`t_»ad
();

318 
DO2
;

319 
t2
 = 
	`t_»ad
();

320 
t2
 -ğ
t1
;

322 
c1
 = (
t1
 > c1 ? c1 :1);

323 
c2
 = (
t2
 > c2 ? c2 :2);

325 
a1
 = 
c2
 - 
c1
 - 
skew
;

327 #undeà
DO1


328 #undeà
DO2


329 
	#DO1
 
	`ecb_deüy±
(
±
,…t, Õt), &
ecb
);

	)

330 
	#DO2
 
DO1
 
	)
DO1

332 
c1
 = 
c2
 = (
ulÚg64
)-1;

333 
y1
 = 0; y1 < 100; y1++) {

334 
	`t_¡¬t
();

335 
DO1
;

336 
t1
 = 
	`t_»ad
();

337 
DO2
;

338 
t2
 = 
	`t_»ad
();

339 
t2
 -ğ
t1
;

341 
c1
 = (
t1
 > c1 ? c1 :1);

342 
c2
 = (
t2
 > c2 ? c2 :2);

344 
a2
 = 
c2
 - 
c1
 - 
skew
;

345 
	`ecb_dÚe
(&
ecb
);

347 
»suÉs
[
no_»suÉs
].
id
 = 
x
;

348 
»suÉs
[
no_»suÉs
].
¥d1
 = 
a1
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

349 
»suÉs
[
no_»suÉs
].
¥d2
 = 
a2
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

350 
»suÉs
[
no_»suÉs
].
avg
 = (»suÉs[no_»suÉs].
¥d1
 +„esuÉs[no_»suÉs].
¥d2
+1)/2;

351 ++
no_»suÉs
;

352 
	`årštf
(
¡d”r
, "."); 
	`fæush
(
¡dout
);

354 #undeà
DO2


355 #undeà
DO1


357 
	`Îy_»suÉs
(1);

360 
	}
}

362 #ifdeà
LTC_CBC_MODE


363 
	$time_ch”2
()

365 
x
, 
y1
;

366 
ulÚg64
 
t1
, 
t2
, 
c1
, 
c2
, 
a1
, 
a2
;

367 
symm‘ric_CBC
 
cbc
;

368 
key
[
MAXBLOCKSIZE
], 
±
[4096];

369 
”r
;

371 
	`årštf
(
¡d”r
, "\n\nCBC Time Trials forhe Symmetric Ciphers:\n");

372 
no_»suÉs
 = 0;

373 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

374 
	`cbc_¡¬t
(
x
, 
±
, 
key
, 
ch”_desütÜ
[x].
mš_key_Ëngth
, 0, &
cbc
);

377 ià((
”r
 = 
ch”_desütÜ
[
x
].
	`‹¡
()è!ğ
CRYPT_OK
) {

378 
	`årštf
(
¡d”r
, "\n\nERROR: Ch” % çed s–f-‹¡ %s\n", 
ch”_desütÜ
[
x
].
Çme
, 
	`”rÜ_to_¡ršg
(
”r
));

379 
	`ex™
(
EXIT_FAILURE
);

382 
	#DO1
 
	`cbc_’üy±
(
±
,…t, Õt), &
cbc
);

	)

383 
	#DO2
 
DO1
 
	)
DO1

385 
c1
 = 
c2
 = (
ulÚg64
)-1;

386 
y1
 = 0; y1 < 100; y1++) {

387 
	`t_¡¬t
();

388 
DO1
;

389 
t1
 = 
	`t_»ad
();

390 
DO2
;

391 
t2
 = 
	`t_»ad
();

392 
t2
 -ğ
t1
;

394 
c1
 = (
t1
 > c1 ? c1 :1);

395 
c2
 = (
t2
 > c2 ? c2 :2);

397 
a1
 = 
c2
 - 
c1
 - 
skew
;

399 #undeà
DO1


400 #undeà
DO2


401 
	#DO1
 
	`cbc_deüy±
(
±
,…t, Õt), &
cbc
);

	)

402 
	#DO2
 
DO1
 
	)
DO1

404 
c1
 = 
c2
 = (
ulÚg64
)-1;

405 
y1
 = 0; y1 < 100; y1++) {

406 
	`t_¡¬t
();

407 
DO1
;

408 
t1
 = 
	`t_»ad
();

409 
DO2
;

410 
t2
 = 
	`t_»ad
();

411 
t2
 -ğ
t1
;

413 
c1
 = (
t1
 > c1 ? c1 :1);

414 
c2
 = (
t2
 > c2 ? c2 :2);

416 
a2
 = 
c2
 - 
c1
 - 
skew
;

417 
	`cbc_dÚe
(&
cbc
);

419 
»suÉs
[
no_»suÉs
].
id
 = 
x
;

420 
»suÉs
[
no_»suÉs
].
¥d1
 = 
a1
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

421 
»suÉs
[
no_»suÉs
].
¥d2
 = 
a2
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

422 
»suÉs
[
no_»suÉs
].
avg
 = (»suÉs[no_»suÉs].
¥d1
 +„esuÉs[no_»suÉs].
¥d2
+1)/2;

423 ++
no_»suÉs
;

424 
	`årštf
(
¡d”r
, "."); 
	`fæush
(
¡dout
);

426 #undeà
DO2


427 #undeà
DO1


429 
	`Îy_»suÉs
(1);

432 
	}
}

434 
	$time_ch”2
(è{ 
	`årštf
(
¡d”r
, "NO CBC\n");  0; 
	}
}

437 #ifdeà
LTC_CTR_MODE


438 
	$time_ch”3
()

440 
x
, 
y1
;

441 
ulÚg64
 
t1
, 
t2
, 
c1
, 
c2
, 
a1
, 
a2
;

442 
symm‘ric_CTR
 
ùr
;

443 
key
[
MAXBLOCKSIZE
], 
±
[4096];

444 
”r
;

446 
	`årštf
(
¡d”r
, "\n\nCTR Time Trials forhe Symmetric Ciphers:\n");

447 
no_»suÉs
 = 0;

448 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

449 
	`ùr_¡¬t
(
x
, 
±
, 
key
, 
ch”_desütÜ
[x].
mš_key_Ëngth
, 0, 
CTR_COUNTER_LITTLE_ENDIAN
, &
ùr
);

452 ià((
”r
 = 
ch”_desütÜ
[
x
].
	`‹¡
()è!ğ
CRYPT_OK
) {

453 
	`årštf
(
¡d”r
, "\n\nERROR: Ch” % çed s–f-‹¡ %s\n", 
ch”_desütÜ
[
x
].
Çme
, 
	`”rÜ_to_¡ršg
(
”r
));

454 
	`ex™
(
EXIT_FAILURE
);

457 
	#DO1
 
	`ùr_’üy±
(
±
,…t, Õt), &
ùr
);

	)

458 
	#DO2
 
DO1
 
	)
DO1

460 
c1
 = 
c2
 = (
ulÚg64
)-1;

461 
y1
 = 0; y1 < 100; y1++) {

462 
	`t_¡¬t
();

463 
DO1
;

464 
t1
 = 
	`t_»ad
();

465 
DO2
;

466 
t2
 = 
	`t_»ad
();

467 
t2
 -ğ
t1
;

469 
c1
 = (
t1
 > c1 ? c1 :1);

470 
c2
 = (
t2
 > c2 ? c2 :2);

472 
a1
 = 
c2
 - 
c1
 - 
skew
;

474 #undeà
DO1


475 #undeà
DO2


476 
	#DO1
 
	`ùr_deüy±
(
±
,…t, Õt), &
ùr
);

	)

477 
	#DO2
 
DO1
 
	)
DO1

479 
c1
 = 
c2
 = (
ulÚg64
)-1;

480 
y1
 = 0; y1 < 100; y1++) {

481 
	`t_¡¬t
();

482 
DO1
;

483 
t1
 = 
	`t_»ad
();

484 
DO2
;

485 
t2
 = 
	`t_»ad
();

486 
t2
 -ğ
t1
;

488 
c1
 = (
t1
 > c1 ? c1 :1);

489 
c2
 = (
t2
 > c2 ? c2 :2);

491 
a2
 = 
c2
 - 
c1
 - 
skew
;

492 
	`ùr_dÚe
(&
ùr
);

494 
»suÉs
[
no_»suÉs
].
id
 = 
x
;

495 
»suÉs
[
no_»suÉs
].
¥d1
 = 
a1
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

496 
»suÉs
[
no_»suÉs
].
¥d2
 = 
a2
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

497 
»suÉs
[
no_»suÉs
].
avg
 = (»suÉs[no_»suÉs].
¥d1
 +„esuÉs[no_»suÉs].
¥d2
+1)/2;

498 ++
no_»suÉs
;

499 
	`årštf
(
¡d”r
, "."); 
	`fæush
(
¡dout
);

501 #undeà
DO2


502 #undeà
DO1


504 
	`Îy_»suÉs
(1);

507 
	}
}

509 
	$time_ch”3
(è{ 
	`årštf
(
¡d”r
, "NO CTR\n");  0; 
	}
}

512 #ifdeà
LTC_LRW_MODE


513 
	$time_ch”4
()

515 
x
, 
y1
;

516 
ulÚg64
 
t1
, 
t2
, 
c1
, 
c2
, 
a1
, 
a2
;

517 
symm‘ric_LRW
 
Ìw
;

518 
key
[
MAXBLOCKSIZE
], 
±
[4096];

519 
”r
;

521 
	`årštf
(
¡d”r
, "\n\nLRW Time Trials forhe Symmetric Ciphers:\n");

522 
no_»suÉs
 = 0;

523 
x
 = 0; 
ch”_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

524 ià(
ch”_desütÜ
[
x
].
block_Ëngth
 != 16) ;

525 
	`Ìw_¡¬t
(
x
, 
±
, 
key
, 
ch”_desütÜ
[x].
mš_key_Ëngth
, key, 0, &
Ìw
);

528 ià((
”r
 = 
ch”_desütÜ
[
x
].
	`‹¡
()è!ğ
CRYPT_OK
) {

529 
	`årštf
(
¡d”r
, "\n\nERROR: Ch” % çed s–f-‹¡ %s\n", 
ch”_desütÜ
[
x
].
Çme
, 
	`”rÜ_to_¡ršg
(
”r
));

530 
	`ex™
(
EXIT_FAILURE
);

533 
	#DO1
 
	`Ìw_’üy±
(
±
,…t, Õt), &
Ìw
);

	)

534 
	#DO2
 
DO1
 
	)
DO1

536 
c1
 = 
c2
 = (
ulÚg64
)-1;

537 
y1
 = 0; y1 < 100; y1++) {

538 
	`t_¡¬t
();

539 
DO1
;

540 
t1
 = 
	`t_»ad
();

541 
DO2
;

542 
t2
 = 
	`t_»ad
();

543 
t2
 -ğ
t1
;

545 
c1
 = (
t1
 > c1 ? c1 :1);

546 
c2
 = (
t2
 > c2 ? c2 :2);

548 
a1
 = 
c2
 - 
c1
 - 
skew
;

550 #undeà
DO1


551 #undeà
DO2


552 
	#DO1
 
	`Ìw_deüy±
(
±
,…t, Õt), &
Ìw
);

	)

553 
	#DO2
 
DO1
 
	)
DO1

555 
c1
 = 
c2
 = (
ulÚg64
)-1;

556 
y1
 = 0; y1 < 100; y1++) {

557 
	`t_¡¬t
();

558 
DO1
;

559 
t1
 = 
	`t_»ad
();

560 
DO2
;

561 
t2
 = 
	`t_»ad
();

562 
t2
 -ğ
t1
;

564 
c1
 = (
t1
 > c1 ? c1 :1);

565 
c2
 = (
t2
 > c2 ? c2 :2);

567 
a2
 = 
c2
 - 
c1
 - 
skew
;

569 
	`Ìw_dÚe
(&
Ìw
);

571 
»suÉs
[
no_»suÉs
].
id
 = 
x
;

572 
»suÉs
[
no_»suÉs
].
¥d1
 = 
a1
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

573 
»suÉs
[
no_»suÉs
].
¥d2
 = 
a2
/((
±
)/
ch”_desütÜ
[
x
].
block_Ëngth
);

574 
»suÉs
[
no_»suÉs
].
avg
 = (»suÉs[no_»suÉs].
¥d1
 +„esuÉs[no_»suÉs].
¥d2
+1)/2;

575 ++
no_»suÉs
;

576 
	`årštf
(
¡d”r
, "."); 
	`fæush
(
¡dout
);

578 #undeà
DO2


579 #undeà
DO1


581 
	`Îy_»suÉs
(1);

584 
	}
}

586 
	$time_ch”4
(è{ 
	`årštf
(
¡d”r
, "NO LRW\n");  0; 
	}
}

590 
	$time_hash
()

592 
x
, 
y1
, 
Ën
;

593 
ulÚg64
 
t1
, 
t2
, 
c1
, 
c2
;

594 
hash_¡©e
 
md
;

595 (*
func
)(
hash_¡©e
 *, cÚ¡ *, ), 
”r
;

596 
±
[
MAXBLOCKSIZE
];

599 
	`årštf
(
¡d”r
, "\n\nHASH Time Trials for:\n");

600 
no_»suÉs
 = 0;

601 
x
 = 0; 
hash_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

604 ià((
”r
 = 
hash_desütÜ
[
x
].
	`‹¡
()è!ğ
CRYPT_OK
) {

605 
	`årštf
(
¡d”r
, "\n\nERROR: Hash % çed s–f-‹¡ %s\n", 
hash_desütÜ
[
x
].
Çme
, 
	`”rÜ_to_¡ršg
(
”r
));

606 
	`ex™
(
EXIT_FAILURE
);

609 
hash_desütÜ
[
x
].
	`š™
(&
md
);

611 
	#DO1
 
	`func
(&
md
,
±
,
Ën
);

	)

612 
	#DO2
 
DO1
 
	)
DO1

614 
func
 = 
hash_desütÜ
[
x
].
´oûss
;

615 
Ën
 = 
hash_desütÜ
[
x
].
blocksize
;

617 
c1
 = 
c2
 = (
ulÚg64
)-1;

618 
y1
 = 0; y1 < 
TIMES
; y1++) {

619 
	`t_¡¬t
();

620 
DO1
;

621 
t1
 = 
	`t_»ad
();

622 
DO2
;

623 
t2
 = 
	`t_»ad
(è- 
t1
;

624 
c1
 = (
t1
 > c1) ? c1 :1;

625 
c2
 = (
t2
 > c2) ? c2 :2;

627 
t1
 = 
c2
 - 
c1
 - 
skew
;

628 
t1
 = (Ñ1 * 
	`CONST64
(1000))è/ ((
ulÚg64
)
hash_desütÜ
[
x
].
blocksize
);

629 
»suÉs
[
no_»suÉs
].
id
 = 
x
;

630 
»suÉs
[
no_»suÉs
].
¥d1
 =„esuÉs[no_»suÉs].
avg
 = 
t1
;

631 ++
no_»suÉs
;

632 
	`årštf
(
¡d”r
, "."); 
	`fæush
(
¡dout
);

633 #undeà
DO2


634 #undeà
DO1


636 
	`Îy_»suÉs
(2);

639 
	}
}

641 #undeà
MPI


644 #ifdeà
MPI


645 
	$time_muÉ
()

647 
ulÚg64
 
t1
, 
t2
;

648 
x
, 
y
;

649 *
a
, *
b
, *
c
;

651 
	`årštf
(
¡d”r
, "Timing Multiplying:\n");

652 
	`mp_š™_muÉi
(&
a
,&
b
,&
c
,
NULL
);

653 
x
 = 128/
DIGIT_BIT
; x <= 1536/DIGIT_BIT; x += 128/DIGIT_BIT) {

654 
	`mp_¿nd
(&
a
, 
x
);

655 
	`mp_¿nd
(&
b
, 
x
);

657 
	#DO1
 
	`mp_mul
(&
a
, &
b
, &
c
);

	)

658 
	#DO2
 
DO1
; DO1;

	)

660 
t2
 = -1;

661 
y
 = 0; y < 
TIMES
; y++) {

662 
	`t_¡¬t
();

663 
t1
 = 
	`t_»ad
();

664 
DO2
;

665 
t1
 = (
	`t_»ad
() -1)>>1;

666 ià(
t1
 < 
t2
)2 =1;

668 
	`årštf
(
¡d”r
, "%4lu b™s: %9Îu cyşes\n", 
x
*
DIGIT_BIT
, 
t2
);

670 
	`mp_ş—r_muÉi
(&
a
,&
b
,&
c
,
NULL
);

672 #undeà
DO1


673 #undeà
DO2


674 
	}
}

676 
	$time_sqr
()

678 
ulÚg64
 
t1
, 
t2
;

679 
x
, 
y
;

680 
mp_št
 
a
, 
b
;

682 
	`årštf
(
¡d”r
, "Timing Squaring:\n");

683 
	`mp_š™_muÉi
(&
a
,&
b
,
NULL
);

684 
x
 = 128/
DIGIT_BIT
; x <= 1536/DIGIT_BIT; x += 128/DIGIT_BIT) {

685 
	`mp_¿nd
(&
a
, 
x
);

687 
	#DO1
 
	`mp_sqr
(&
a
, &
b
);

	)

688 
	#DO2
 
DO1
; DO1;

	)

690 
t2
 = -1;

691 
y
 = 0; y < 
TIMES
; y++) {

692 
	`t_¡¬t
();

693 
t1
 = 
	`t_»ad
();

694 
DO2
;

695 
t1
 = (
	`t_»ad
() -1)>>1;

696 ià(
t1
 < 
t2
)2 =1;

698 
	`årštf
(
¡d”r
, "%4lu b™s: %9Îu cyşes\n", 
x
*
DIGIT_BIT
, 
t2
);

700 
	`mp_ş—r_muÉi
(&
a
,&
b
,
NULL
);

702 #undeà
DO1


703 #undeà
DO2


704 
	}
}

706 
	$time_muÉ
(è{ 
	`årštf
(
¡d”r
, "NO MULT\n"); 
	}
}

707 
	$time_sqr
(è{ 
	`årštf
(
¡d”r
, "NO SQR\n"); 
	}
}

710 
	$time_´ng
()

712 
ulÚg64
 
t1
, 
t2
;

713 
buf
[4096];

714 
´ng_¡©e
 
ºg
;

715 
x
, 
y
;

716 
”r
;

718 
	`årštf
(
¡d”r
, "Timing PRNGs (cycles/byte output, cycles‡dd_entropy (32 bytes) :\n");

719 
x
 = 0; 
´ng_desütÜ
[x].
Çme
 !ğ
NULL
; x++) {

722 ià((
”r
 = 
´ng_desütÜ
[
x
].
	`‹¡
()è!ğ
CRYPT_OK
) {

723 
	`årštf
(
¡d”r
, "\n\nERROR: PRNG % çed s–f-‹¡ %s\n", 
´ng_desütÜ
[
x
].
Çme
, 
	`”rÜ_to_¡ršg
(
”r
));

724 
	`ex™
(
EXIT_FAILURE
);

727 
´ng_desütÜ
[
x
].
	`¡¬t
(&
ºg
);

728 
	`z”omem
(
buf
, 256);

729 
´ng_desütÜ
[
x
].
	`add_’Œİy
(
buf
, 256, &
ºg
);

730 
´ng_desütÜ
[
x
].
	`»ady
(&
ºg
);

731 
t2
 = -1;

733 
	#DO1
 ià(
´ng_desütÜ
[
x
].
	`»ad
(
buf
, 4096, &
ºg
è!ğ4096è{ 
	`årštf
(
¡d”r
, "\n\nERROR READ !ğ4096\n\n"); 
	`ex™
(
EXIT_FAILURE
); }

	)

734 
	#DO2
 
DO1
 
	)
DO1

735 
y
 = 0; y < 10000; y++) {

736 
	`t_¡¬t
();

737 
t1
 = 
	`t_»ad
();

738 
DO2
;

739 
t1
 = (
	`t_»ad
() -1)>>1;

740 ià(
t1
 < 
t2
)2 =1;

742 
	`årštf
(
¡d”r
, "%20s: %5Îu ", 
´ng_desütÜ
[
x
].
Çme
, 
t2
>>12);

743 #undeà
DO2


744 #undeà
DO1


746 
	#DO1
 
´ng_desütÜ
[
x
].
	`¡¬t
(&
ºg
);…ºg_desütÜ[x].
	`add_’Œİy
(
buf
, 32, &ºg);…ºg_desütÜ[x].
	`»ady
(&ºg);…ºg_desütÜ[x].
	`dÚe
(&ºg);

	)

747 
	#DO2
 
DO1
 
	)
DO1

748 
y
 = 0; y < 10000; y++) {

749 
	`t_¡¬t
();

750 
t1
 = 
	`t_»ad
();

751 
DO2
;

752 
t1
 = (
	`t_»ad
() -1)>>1;

753 ià(
t1
 < 
t2
)2 =1;

755 
	`årštf
(
¡d”r
, "%5Îu\n", 
t2
);

756 #undeà
DO2


757 #undeà
DO1


760 
	}
}

762 #ifdeà
MDSA


764 
	$time_d§
()

766 
d§_key
 
key
;

767 
ulÚg64
 
t1
, 
t2
;

768 
x
, 
y
;

769 
”r
;

771 
group
, 
modulus
;

772 } 
groups
[] = {

780 
x
 = 0; x < ((
groups
)/(groups[0])); x++) {

781 
t2
 = 0;

782 
y
 = 0; y < 4; y++) {

783 
	`t_¡¬t
();

784 
t1
 = 
	`t_»ad
();

785 ià((
”r
 = 
	`d§_make_key
(&
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), 
groups
[
x
].
group
, groups[x].
modulus
, &
key
)è!ğ
CRYPT_OK
) {

786 
	`årštf
(
¡d”r
, "\n\nd§_make_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

787 
	`ex™
(
EXIT_FAILURE
);

789 
t1
 = 
	`t_»ad
() -1;

790 
t2
 +ğ
t1
;

792 #ifdeà
LTC_PROFILE


793 
t2
 <<= 2;

796 ià(
y
 < 3) {

797 
	`d§_ä“
(&
key
);

800 
t2
 >>= 2;

801 
	`årštf
(
¡d”r
, "DSA-(%lu, %luèmake_keyook %15Îu cyşes\n", ()
groups
[
x
].
group
*8, ()groups[x].
modulus
*8, 
t2
);

803 
	}
}

807 #ifdeà
MRSA


809 
	$time_r§
()

811 
r§_key
 
key
;

812 
ulÚg64
 
t1
, 
t2
;

813 
buf
[2][2048];

814 
x
, 
y
, 
z
, 
zzz
;

815 
”r
, 
zz
, 
¡©
;

817 
x
 = 1024; x <= 2048; x += 256) {

818 
t2
 = 0;

819 
y
 = 0; y < 4; y++) {

820 
	`t_¡¬t
();

821 
t1
 = 
	`t_»ad
();

822 ià((
”r
 = 
	`r§_make_key
(&
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), 
x
/8, 65537, &
key
)è!ğ
CRYPT_OK
) {

823 
	`årštf
(
¡d”r
, "\n\Ä§_make_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

824 
	`ex™
(
EXIT_FAILURE
);

826 
t1
 = 
	`t_»ad
() -1;

827 
t2
 +ğ
t1
;

829 #ifdeà
LTC_PROFILE


830 
t2
 <<= 2;

834 ià(
y
 < 3) {

835 
	`r§_ä“
(&
key
);

838 
t2
 >>= 2;

839 
	`årštf
(
¡d”r
, "RSA-%lu make_keyook %15Îu cyşes\n", 
x
, 
t2
);

841 
t2
 = 0;

842 
y
 = 0; y < 16; y++) {

843 
	`t_¡¬t
();

844 
t1
 = 
	`t_»ad
();

845 
z
 = (
buf
[1]);

846 ià((
”r
 = 
	`r§_’üy±_key
(
buf
[0], 32, buf[1], &
z
, (cÚ¡ *)"‹¡´og", 8, &
y¬row_´ng
,

847 
	`fšd_´ng
("y¬row"), 
	`fšd_hash
("sha1"),

848 &
key
)è!ğ
CRYPT_OK
) {

849 
	`årštf
(
¡d”r
, "\n\Ä§_’üy±_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

850 
	`ex™
(
EXIT_FAILURE
);

852 
t1
 = 
	`t_»ad
() -1;

853 
t2
 +ğ
t1
;

854 #ifdeà
LTC_PROFILE


855 
t2
 <<= 4;

859 
t2
 >>= 4;

860 
	`årštf
(
¡d”r
, "RSA-%luƒnüy±_keyook %15Îu cyşes\n", 
x
, 
t2
);

862 
t2
 = 0;

863 
y
 = 0; y < 2048; y++) {

864 
	`t_¡¬t
();

865 
t1
 = 
	`t_»ad
();

866 
zzz
 = (
buf
[0]);

867 ià((
”r
 = 
	`r§_deüy±_key
(
buf
[1], 
z
, buf[0], &
zzz
, (cÚ¡ *)"‹¡´og", 8, 
	`fšd_hash
("sha1"),

868 &
zz
, &
key
)è!ğ
CRYPT_OK
) {

869 
	`årštf
(
¡d”r
, "\n\Ä§_deüy±_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

870 
	`ex™
(
EXIT_FAILURE
);

872 
t1
 = 
	`t_»ad
() -1;

873 
t2
 +ğ
t1
;

874 #ifdeà
LTC_PROFILE


875 
t2
 <<= 11;

879 
t2
 >>= 11;

880 
	`årštf
(
¡d”r
, "RSA-%lu deüy±_keyook %15Îu cyşes\n", 
x
, 
t2
);

882 
t2
 = 0;

883 
y
 = 0; y < 256; y++) {

884 
	`t_¡¬t
();

885 
t1
 = 
	`t_»ad
();

886 
z
 = (
buf
[1]);

887 ià((
”r
 = 
	`r§_sign_hash
(
buf
[0], 20, buf[1], &
z
, &
y¬row_´ng
,

888 
	`fšd_´ng
("y¬row"), 
	`fšd_hash
("sha1"), 8, &
key
)è!ğ
CRYPT_OK
) {

889 
	`årštf
(
¡d”r
, "\n\Ä§_sign_hash say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

890 
	`ex™
(
EXIT_FAILURE
);

892 
t1
 = 
	`t_»ad
() -1;

893 
t2
 +ğ
t1
;

894 #ifdeà
LTC_PROFILE


895 
t2
 <<= 8;

899 
t2
 >>= 8;

900 
	`årštf
(
¡d”r
, "RSA-%lu sign_hashook %15Îu cyşes\n", 
x
, 
t2
);

902 
t2
 = 0;

903 
y
 = 0; y < 2048; y++) {

904 
	`t_¡¬t
();

905 
t1
 = 
	`t_»ad
();

906 ià((
”r
 = 
	`r§_v”ify_hash
(
buf
[1], 
z
, buf[0], 20, 
	`fšd_hash
("sha1"), 8, &
¡©
, &
key
)è!ğ
CRYPT_OK
) {

907 
	`årštf
(
¡d”r
, "\n\Ä§_v”ify_hash say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

908 
	`ex™
(
EXIT_FAILURE
);

910 ià(
¡©
 == 0) {

911 
	`årštf
(
¡d”r
, "\n\Ä§_v”ify_hash fÜ RSA-%lu faedØv”ify sigÇtu»(%lu)\n", 
x
, 
y
);

912 
	`ex™
(
EXIT_FAILURE
);

914 
t1
 = 
	`t_»ad
() -1;

915 
t2
 +ğ
t1
;

916 #ifdeà
LTC_PROFILE


917 
t2
 <<= 11;

921 
t2
 >>= 11;

922 
	`årštf
(
¡d”r
, "RSA-%lu v”ify_hashook %15Îu cyşes\n", 
x
, 
t2
);

923 
	`årštf
(
¡d”r
, "\n\n");

924 
	`r§_ä“
(&
key
);

926 
	}
}

928 
	$time_r§
(è{ 
	`årštf
(
¡d”r
, "NO RSA\n"); 
	}
}

931 #ifdeà
MKAT


933 
	$time_k©ja
()

935 
k©ja_key
 
key
;

936 
ulÚg64
 
t1
, 
t2
;

937 
buf
[2][4096];

938 
x
, 
y
, 
z
, 
zzz
;

939 
”r
, 
zz
;

941 
x
 = 1024; x <= 2048; x += 256) {

942 
t2
 = 0;

943 
y
 = 0; y < 4; y++) {

944 
	`t_¡¬t
();

945 
t1
 = 
	`t_»ad
();

946 ià((
”r
 = 
	`k©ja_make_key
(&
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), 
x
/8, &
key
)è!ğ
CRYPT_OK
) {

947 
	`årštf
(
¡d”r
, "\n\nk©ja_make_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

948 
	`ex™
(
EXIT_FAILURE
);

950 
t1
 = 
	`t_»ad
() -1;

951 
t2
 +ğ
t1
;

953 ià(
y
 < 3) {

954 
	`k©ja_ä“
(&
key
);

957 
t2
 >>= 2;

958 
	`årštf
(
¡d”r
, "K©ja-%lu make_keyook %15Îu cyşes\n", 
x
, 
t2
);

960 
t2
 = 0;

961 
y
 = 0; y < 16; y++) {

962 
	`t_¡¬t
();

963 
t1
 = 
	`t_»ad
();

964 
z
 = (
buf
[1]);

965 ià((
”r
 = 
	`k©ja_’üy±_key
(
buf
[0], 32, buf[1], &
z
, "‹¡´og", 8, &
y¬row_´ng
,

966 
	`fšd_´ng
("y¬row"), 
	`fšd_hash
("sha1"),

967 &
key
)è!ğ
CRYPT_OK
) {

968 
	`årštf
(
¡d”r
, "\n\nk©ja_’üy±_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

969 
	`ex™
(
EXIT_FAILURE
);

971 
t1
 = 
	`t_»ad
() -1;

972 
t2
 +ğ
t1
;

974 
t2
 >>= 4;

975 
	`årštf
(
¡d”r
, "K©ja-%luƒnüy±_keyook %15Îu cyşes\n", 
x
, 
t2
);

977 
t2
 = 0;

978 
y
 = 0; y < 2048; y++) {

979 
	`t_¡¬t
();

980 
t1
 = 
	`t_»ad
();

981 
zzz
 = (
buf
[0]);

982 ià((
”r
 = 
	`k©ja_deüy±_key
(
buf
[1], 
z
, buf[0], &
zzz
, "‹¡´og", 8, 
	`fšd_hash
("sha1"),

983 &
zz
, &
key
)è!ğ
CRYPT_OK
) {

984 
	`årštf
(
¡d”r
, "\n\nk©ja_deüy±_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

985 
	`ex™
(
EXIT_FAILURE
);

987 
t1
 = 
	`t_»ad
() -1;

988 
t2
 +ğ
t1
;

990 
t2
 >>= 11;

991 
	`årštf
(
¡d”r
, "K©ja-%lu deüy±_keyook %15Îu cyşes\n", 
x
, 
t2
);

994 
	`k©ja_ä“
(&
key
);

996 
	}
}

998 
	$time_k©ja
(è{ 
	`årštf
(
¡d”r
, "NO K©ja\n"); 
	}
}

1001 #ifdeà
MECC


1003 
	$time_ecc
()

1005 
ecc_key
 
key
;

1006 
ulÚg64
 
t1
, 
t2
;

1007 
buf
[2][256];

1008 
i
, 
w
, 
x
, 
y
, 
z
;

1009 
”r
, 
¡©
;

1010 
sizes
[] = {

1011 #ifdeà
ECC112


1014 #ifdeà
ECC128


1017 #ifdeà
ECC160


1020 #ifdeà
ECC192


1023 #ifdeà
ECC224


1026 #ifdeà
ECC256


1029 #ifdeà
ECC384


1032 #ifdeà
ECC521


1037 
x
 = 
sizes
[
i
=0]; x < 100000; x = sizes[++i]) {

1038 
t2
 = 0;

1039 
y
 = 0; y < 256; y++) {

1040 
	`t_¡¬t
();

1041 
t1
 = 
	`t_»ad
();

1042 ià((
”r
 = 
	`ecc_make_key
(&
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), 
x
, &
key
)è!ğ
CRYPT_OK
) {

1043 
	`årštf
(
¡d”r
, "\n\Ãcc_make_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

1044 
	`ex™
(
EXIT_FAILURE
);

1046 
t1
 = 
	`t_»ad
() -1;

1047 
t2
 +ğ
t1
;

1049 #ifdeà
LTC_PROFILE


1050 
t2
 <<= 8;

1054 ià(
y
 < 255) {

1055 
	`ecc_ä“
(&
key
);

1058 
t2
 >>= 8;

1059 
	`årštf
(
¡d”r
, "ECC-%lu make_keyook %15Îu cyşes\n", 
x
*8, 
t2
);

1061 
t2
 = 0;

1062 
y
 = 0; y < 256; y++) {

1063 
	`t_¡¬t
();

1064 
t1
 = 
	`t_»ad
();

1065 
z
 = (
buf
[1]);

1066 ià((
”r
 = 
	`ecc_’üy±_key
(
buf
[0], 20, buf[1], &
z
, &
y¬row_´ng
, 
	`fšd_´ng
("y¬row"), 
	`fšd_hash
("sha1"),

1067 &
key
)è!ğ
CRYPT_OK
) {

1068 
	`årštf
(
¡d”r
, "\n\Ãcc_’üy±_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

1069 
	`ex™
(
EXIT_FAILURE
);

1071 
t1
 = 
	`t_»ad
() -1;

1072 
t2
 +ğ
t1
;

1073 #ifdeà
LTC_PROFILE


1074 
t2
 <<= 8;

1078 
t2
 >>= 8;

1079 
	`årštf
(
¡d”r
, "ECC-%luƒnüy±_keyook %15Îu cyşes\n", 
x
*8, 
t2
);

1081 
t2
 = 0;

1082 
y
 = 0; y < 256; y++) {

1083 
	`t_¡¬t
();

1084 
t1
 = 
	`t_»ad
();

1085 
w
 = 20;

1086 ià((
”r
 = 
	`ecc_deüy±_key
(
buf
[1], 
z
, buf[0], &
w
, &
key
)è!ğ
CRYPT_OK
) {

1087 
	`årštf
(
¡d”r
, "\n\Ãcc_deüy±_key say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

1088 
	`ex™
(
EXIT_FAILURE
);

1090 
t1
 = 
	`t_»ad
() -1;

1091 
t2
 +ğ
t1
;

1092 #ifdeà
LTC_PROFILE


1093 
t2
 <<= 8;

1097 
t2
 >>= 8;

1098 
	`årštf
(
¡d”r
, "ECC-%lu deüy±_keyook %15Îu cyşes\n", 
x
*8, 
t2
);

1100 
t2
 = 0;

1101 
y
 = 0; y < 256; y++) {

1102 
	`t_¡¬t
();

1103 
t1
 = 
	`t_»ad
();

1104 
z
 = (
buf
[1]);

1105 ià((
”r
 = 
	`ecc_sign_hash
(
buf
[0], 20, buf[1], &
z
, &
y¬row_´ng
,

1106 
	`fšd_´ng
("y¬row"), &
key
)è!ğ
CRYPT_OK
) {

1107 
	`årštf
(
¡d”r
, "\n\Ãcc_sign_hash say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

1108 
	`ex™
(
EXIT_FAILURE
);

1110 
t1
 = 
	`t_»ad
() -1;

1111 
t2
 +ğ
t1
;

1112 #ifdeà
LTC_PROFILE


1113 
t2
 <<= 8;

1117 
t2
 >>= 8;

1118 
	`årštf
(
¡d”r
, "ECC-%lu sign_hashook %15Îu cyşes\n", 
x
*8, 
t2
);

1120 
t2
 = 0;

1121 
y
 = 0; y < 256; y++) {

1122 
	`t_¡¬t
();

1123 
t1
 = 
	`t_»ad
();

1124 ià((
”r
 = 
	`ecc_v”ify_hash
(
buf
[1], 
z
, buf[0], 20, &
¡©
, &
key
)è!ğ
CRYPT_OK
) {

1125 
	`årštf
(
¡d”r
, "\n\Ãcc_v”ify_hash say %s, wa™...nØ™ should say %s...damÀyou!\n", 
	`”rÜ_to_¡ršg
(
”r
),ƒ¼Ü_to_¡ršg(
CRYPT_OK
));

1126 
	`ex™
(
EXIT_FAILURE
);

1128 ià(
¡©
 == 0) {

1129 
	`årštf
(
¡d”r
, "\n\Ãcc_v”ify_hash fÜ ECC-%lu faedØv”ify sigÇtu»(%lu)\n", 
x
*8, 
y
);

1130 
	`ex™
(
EXIT_FAILURE
);

1132 
t1
 = 
	`t_»ad
() -1;

1133 
t2
 +ğ
t1
;

1134 #ifdeà
LTC_PROFILE


1135 
t2
 <<= 8;

1139 
t2
 >>= 8;

1140 
	`årštf
(
¡d”r
, "ECC-%lu v”ify_hashook %15Îu cyşes\n", 
x
*8, 
t2
);

1142 
	`årštf
(
¡d”r
, "\n\n");

1143 
	`ecc_ä“
(&
key
);

1145 
	}
}

1147 
	$time_ecc
(è{ 
	`årštf
(
¡d”r
, "NO ECC\n"); 
	}
}

1150 
	$time_macs_
(
MAC_SIZE
)

1152 *
buf
, 
key
[16], 
g
[16];

1153 
ulÚg64
 
t1
, 
t2
;

1154 
x
, 
z
;

1155 
”r
, 
ch”_idx
, 
hash_idx
;

1157 
	`årštf
(
¡d”r
, "\nMAC Timšg (cyşes/by‹ oÀ%luKB blocks):\n", 
MAC_SIZE
);

1159 
buf
 = 
	`XMALLOC
(
MAC_SIZE
*1024);

1160 ià(
buf
 =ğ
NULL
) {

1161 
	`årštf
(
¡d”r
, "\n\nout of heap yo\n\n");

1162 
	`ex™
(
EXIT_FAILURE
);

1165 
ch”_idx
 = 
	`fšd_ch”
("aes");

1166 
hash_idx
 = 
	`fšd_hash
("sha1");

1168 ià(
ch”_idx
 =ğ-1 || 
hash_idx
 == -1) {

1169 
	`årštf
(
¡d”r
, "Warninghe MACests„equires AES‡nd SHA1o operate... so sorry\n");

1173 
	`y¬row_»ad
(
buf
, 
MAC_SIZE
*1024, &
y¬row_´ng
);

1174 
	`y¬row_»ad
(
key
, 16, &
y¬row_´ng
);

1176 #ifdeà
LTC_OMAC


1177 
t2
 = -1;

1178 
x
 = 0; x < 10000; x++) {

1179 
	`t_¡¬t
();

1180 
t1
 = 
	`t_»ad
();

1181 
z
 = 16;

1182 ià((
”r
 = 
	`omac_memÜy
(
ch”_idx
, 
key
, 16, 
buf
, 
MAC_SIZE
*1024, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1183 
	`årštf
(
¡d”r
, "\n\nomaø”rÜ... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1184 
	`ex™
(
EXIT_FAILURE
);

1186 
t1
 = 
	`t_»ad
() -1;

1187 ià(
t1
 < 
t2
)2 =1;

1189 
	`årštf
(
¡d”r
, "OMAC-%s\t\t%9Îu\n", 
ch”_desütÜ
[
ch”_idx
].
Çme
, 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1192 #ifdeà
LTC_XCBC


1193 
t2
 = -1;

1194 
x
 = 0; x < 10000; x++) {

1195 
	`t_¡¬t
();

1196 
t1
 = 
	`t_»ad
();

1197 
z
 = 16;

1198 ià((
”r
 = 
	`xcbc_memÜy
(
ch”_idx
, 
key
, 16, 
buf
, 
MAC_SIZE
*1024, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1199 
	`årštf
(
¡d”r
, "\n\nxcbø”rÜ... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1200 
	`ex™
(
EXIT_FAILURE
);

1202 
t1
 = 
	`t_»ad
() -1;

1203 ià(
t1
 < 
t2
)2 =1;

1205 
	`årštf
(
¡d”r
, "XCBC-%s\t\t%9Îu\n", 
ch”_desütÜ
[
ch”_idx
].
Çme
, 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1208 #ifdeà
LTC_F9_MODE


1209 
t2
 = -1;

1210 
x
 = 0; x < 10000; x++) {

1211 
	`t_¡¬t
();

1212 
t1
 = 
	`t_»ad
();

1213 
z
 = 16;

1214 ià((
”r
 = 
	`f9_memÜy
(
ch”_idx
, 
key
, 16, 
buf
, 
MAC_SIZE
*1024, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1215 
	`årštf
(
¡d”r
, "\n\nF9ƒ¼Ü... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1216 
	`ex™
(
EXIT_FAILURE
);

1218 
t1
 = 
	`t_»ad
() -1;

1219 ià(
t1
 < 
t2
)2 =1;

1221 
	`årštf
(
¡d”r
, "F9-%s\t\t\t%9Îu\n", 
ch”_desütÜ
[
ch”_idx
].
Çme
, 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1224 #ifdeà
LTC_PMAC


1225 
t2
 = -1;

1226 
x
 = 0; x < 10000; x++) {

1227 
	`t_¡¬t
();

1228 
t1
 = 
	`t_»ad
();

1229 
z
 = 16;

1230 ià((
”r
 = 
	`pmac_memÜy
(
ch”_idx
, 
key
, 16, 
buf
, 
MAC_SIZE
*1024, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1231 
	`årštf
(
¡d”r
, "\n\Åmaø”rÜ... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1232 
	`ex™
(
EXIT_FAILURE
);

1234 
t1
 = 
	`t_»ad
() -1;

1235 ià(
t1
 < 
t2
)2 =1;

1237 
	`årštf
(
¡d”r
, "PMAC-AES\t\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1240 #ifdeà
PELICAN


1241 
t2
 = -1;

1242 
x
 = 0; x < 10000; x++) {

1243 
	`t_¡¬t
();

1244 
t1
 = 
	`t_»ad
();

1245 
z
 = 16;

1246 ià((
”r
 = 
	`³liÿn_memÜy
(
key
, 16, 
buf
, 
MAC_SIZE
*1024, 
g
)è!ğ
CRYPT_OK
) {

1247 
	`årštf
(
¡d”r
, "\n\Å–iÿÀ”rÜ... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1248 
	`ex™
(
EXIT_FAILURE
);

1250 
t1
 = 
	`t_»ad
() -1;

1251 ià(
t1
 < 
t2
)2 =1;

1253 
	`årštf
(
¡d”r
, "PELICAN \t\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1256 #ifdeà
LTC_HMAC


1257 
t2
 = -1;

1258 
x
 = 0; x < 10000; x++) {

1259 
	`t_¡¬t
();

1260 
t1
 = 
	`t_»ad
();

1261 
z
 = 16;

1262 ià((
”r
 = 
	`hmac_memÜy
(
hash_idx
, 
key
, 16, 
buf
, 
MAC_SIZE
*1024, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1263 
	`årštf
(
¡d”r
, "\n\nhmaø”rÜ... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1264 
	`ex™
(
EXIT_FAILURE
);

1266 
t1
 = 
	`t_»ad
() -1;

1267 ià(
t1
 < 
t2
)2 =1;

1269 
	`årštf
(
¡d”r
, "HMAC-%s\t\t%9Îu\n", 
hash_desütÜ
[
hash_idx
].
Çme
, 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1272 
	`XFREE
(
buf
);

1273 
	}
}

1275 
	$time_macs
()

1277 
	`time_macs_
(1);

1278 
	`time_macs_
(4);

1279 
	`time_macs_
(32);

1280 
	}
}

1282 
	$time_’cmacs_
(
MAC_SIZE
)

1284 *
buf
, 
IV
[16], 
key
[16], 
g
[16];

1285 
ulÚg64
 
t1
, 
t2
;

1286 
x
, 
z
;

1287 
”r
, 
ch”_idx
;

1288 
symm‘ric_key
 
skey
;

1290 
	`årštf
(
¡d”r
, "\nENC+MAC Timšg (z”Øby‹ AAD, 16 by‹ IV, cyşes/by‹ oÀ%luKB blocks):\n", 
MAC_SIZE
);

1292 
buf
 = 
	`XMALLOC
(
MAC_SIZE
*1024);

1293 ià(
buf
 =ğ
NULL
) {

1294 
	`årštf
(
¡d”r
, "\n\nout of heap yo\n\n");

1295 
	`ex™
(
EXIT_FAILURE
);

1298 
ch”_idx
 = 
	`fšd_ch”
("aes");

1300 
	`y¬row_»ad
(
buf
, 
MAC_SIZE
*1024, &
y¬row_´ng
);

1301 
	`y¬row_»ad
(
key
, 16, &
y¬row_´ng
);

1302 
	`y¬row_»ad
(
IV
, 16, &
y¬row_´ng
);

1304 #ifdeà
EAX_MODE


1305 
t2
 = -1;

1306 
x
 = 0; x < 10000; x++) {

1307 
	`t_¡¬t
();

1308 
t1
 = 
	`t_»ad
();

1309 
z
 = 16;

1310 ià((
”r
 = 
	`—x_’üy±_auth’tiÿ‹_memÜy
(
ch”_idx
, 
key
, 16, 
IV
, 16, 
NULL
, 0, 
buf
, 
MAC_SIZE
*1024, buf, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1311 
	`årštf
(
¡d”r
, "\nEAXƒ¼Ü... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1312 
	`ex™
(
EXIT_FAILURE
);

1314 
t1
 = 
	`t_»ad
() -1;

1315 ià(
t1
 < 
t2
)2 =1;

1317 
	`årštf
(
¡d”r
, "EAX \t\t\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1320 #ifdeà
OCB_MODE


1321 
t2
 = -1;

1322 
x
 = 0; x < 10000; x++) {

1323 
	`t_¡¬t
();

1324 
t1
 = 
	`t_»ad
();

1325 
z
 = 16;

1326 ià((
”r
 = 
	`ocb_’üy±_auth’tiÿ‹_memÜy
(
ch”_idx
, 
key
, 16, 
IV
, 
buf
, 
MAC_SIZE
*1024, buf, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1327 
	`årštf
(
¡d”r
, "\nOCBƒ¼Ü... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1328 
	`ex™
(
EXIT_FAILURE
);

1330 
t1
 = 
	`t_»ad
() -1;

1331 ià(
t1
 < 
t2
)2 =1;

1333 
	`årštf
(
¡d”r
, "OCB \t\t\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1336 #ifdeà
CCM_MODE


1337 
t2
 = -1;

1338 
x
 = 0; x < 10000; x++) {

1339 
	`t_¡¬t
();

1340 
t1
 = 
	`t_»ad
();

1341 
z
 = 16;

1342 ià((
”r
 = 
	`ccm_memÜy
(
ch”_idx
, 
key
, 16, 
NULL
, 
IV
, 16, NULL, 0, 
buf
, 
MAC_SIZE
*1024, buf, 
g
, &
z
, 
CCM_ENCRYPT
)è!ğ
CRYPT_OK
) {

1343 
	`årštf
(
¡d”r
, "\nCCMƒ¼Ü... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1344 
	`ex™
(
EXIT_FAILURE
);

1346 
t1
 = 
	`t_»ad
() -1;

1347 ià(
t1
 < 
t2
)2 =1;

1349 
	`årštf
(
¡d”r
, "CCM (no-´ecompè\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1351 
ch”_desütÜ
[
ch”_idx
].
	`£tup
(
key
, 16, 0, &
skey
);

1352 
t2
 = -1;

1353 
x
 = 0; x < 10000; x++) {

1354 
	`t_¡¬t
();

1355 
t1
 = 
	`t_»ad
();

1356 
z
 = 16;

1357 ià((
”r
 = 
	`ccm_memÜy
(
ch”_idx
, 
key
, 16, &
skey
, 
IV
, 16, 
NULL
, 0, 
buf
, 
MAC_SIZE
*1024, buf, 
g
, &
z
, 
CCM_ENCRYPT
)è!ğ
CRYPT_OK
) {

1358 
	`årštf
(
¡d”r
, "\nCCMƒ¼Ü... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1359 
	`ex™
(
EXIT_FAILURE
);

1361 
t1
 = 
	`t_»ad
() -1;

1362 ià(
t1
 < 
t2
)2 =1;

1364 
	`årštf
(
¡d”r
, "CCM (´ecompè\t\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1365 
ch”_desütÜ
[
ch”_idx
].
	`dÚe
(&
skey
);

1368 #ifdeà
GCM_MODE


1369 
t2
 = -1;

1370 
x
 = 0; x < 100; x++) {

1371 
	`t_¡¬t
();

1372 
t1
 = 
	`t_»ad
();

1373 
z
 = 16;

1374 ià((
”r
 = 
	`gcm_memÜy
(
ch”_idx
, 
key
, 16, 
IV
, 16, 
NULL
, 0, 
buf
, 
MAC_SIZE
*1024, buf, 
g
, &
z
, 
GCM_ENCRYPT
)è!ğ
CRYPT_OK
) {

1375 
	`årštf
(
¡d”r
, "\nGCMƒ¼Ü... %s\n", 
	`”rÜ_to_¡ršg
(
”r
));

1376 
	`ex™
(
EXIT_FAILURE
);

1378 
t1
 = 
	`t_»ad
() -1;

1379 ià(
t1
 < 
t2
)2 =1;

1381 
	`årštf
(
¡d”r
, "GCM (no-´ecomp)\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1384 
gcm_¡©e
 
gcm


1385 #ifdeà
GCM_TABLES_SSE2


1386 
	`__©Œibu‹__
 ((
	`®igÃd
 (16)))

1390 ià((
”r
 = 
	`gcm_š™
(&
gcm
, 
ch”_idx
, 
key
, 16)è!ğ
CRYPT_OK
è{ 
	`årštf
(
¡d”r
, "gcm_š™: %s\n", 
	`”rÜ_to_¡ršg
Ó¼)); 
	`ex™
(
EXIT_FAILURE
); }

1391 
t2
 = -1;

1392 
x
 = 0; x < 10000; x++) {

1393 
	`t_¡¬t
();

1394 
t1
 = 
	`t_»ad
();

1395 
z
 = 16;

1396 ià((
”r
 = 
	`gcm_»£t
(&
gcm
)è!ğ
CRYPT_OK
) {

1397 
	`årštf
(
¡d”r
, "\nGCMƒ¼Ü[%d]... %s\n", 
__LINE__
, 
	`”rÜ_to_¡ršg
(
”r
));

1398 
	`ex™
(
EXIT_FAILURE
);

1400 ià((
”r
 = 
	`gcm_add_iv
(&
gcm
, 
IV
, 16)è!ğ
CRYPT_OK
) {

1401 
	`årštf
(
¡d”r
, "\nGCMƒ¼Ü[%d]... %s\n", 
__LINE__
, 
	`”rÜ_to_¡ršg
(
”r
));

1402 
	`ex™
(
EXIT_FAILURE
);

1404 ià((
”r
 = 
	`gcm_add_¯d
(&
gcm
, 
NULL
, 0)è!ğ
CRYPT_OK
) {

1405 
	`årštf
(
¡d”r
, "\nGCMƒ¼Ü[%d]... %s\n", 
__LINE__
, 
	`”rÜ_to_¡ršg
(
”r
));

1406 
	`ex™
(
EXIT_FAILURE
);

1408 ià((
”r
 = 
	`gcm_´oûss
(&
gcm
, 
buf
, 
MAC_SIZE
*1024, buf, 
GCM_ENCRYPT
)è!ğ
CRYPT_OK
) {

1409 
	`årštf
(
¡d”r
, "\nGCMƒ¼Ü[%d]... %s\n", 
__LINE__
, 
	`”rÜ_to_¡ršg
(
”r
));

1410 
	`ex™
(
EXIT_FAILURE
);

1413 ià((
”r
 = 
	`gcm_dÚe
(&
gcm
, 
g
, &
z
)è!ğ
CRYPT_OK
) {

1414 
	`årštf
(
¡d”r
, "\nGCMƒ¼Ü[%d]... %s\n", 
__LINE__
, 
	`”rÜ_to_¡ršg
(
”r
));

1415 
	`ex™
(
EXIT_FAILURE
);

1417 
t1
 = 
	`t_»ad
() -1;

1418 ià(
t1
 < 
t2
)2 =1;

1420 
	`årštf
(
¡d”r
, "GCM (´ecomp)\t\t%9Îu\n", 
t2
/(
ulÚg64
)(
MAC_SIZE
*1024));

1425 
	}
}

1427 
	$time_’cmacs
()

1429 
	`time_’cmacs_
(1);

1430 
	`time_’cmacs_
(4);

1431 
	`time_’cmacs_
(32);

1432 
	}
}

	@libtommath/bn_error.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_ERROR_C


19 
	mcode
;

20 *
	mmsg
;

21 } 
	gmsgs
[] = {

22 { 
MP_OKAY
, "Successful" },

23 { 
MP_MEM
, "Out of heap" },

24 { 
MP_VAL
, "Value out of„ange" }

28 *
	$mp_”rÜ_to_¡ršg
(
code
)

30 
x
;

33 
x
 = 0; x < ()((
msgs
) / (msgs[0])); x++) {

34 ià(
msgs
[
x
].
code
 == code) {

35  
msgs
[
x
].
msg
;

41 
	}
}

	@libtommath/bn_fast_mp_invmod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_FAST_MP_INVMOD_C


24 
	$ç¡_mp_švmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

26 
mp_št
 
x
, 
y
, 
u
, 
v
, 
B
, 
D
;

27 
»s
, 
Ãg
;

30 ià(
	`mp_i£v’
 (
b
) == 1) {

31  
MP_VAL
;

35 ià((
»s
 = 
	`mp_š™_muÉi
(&
x
, &
y
, &
u
, &
v
, &
B
, &
D
, 
NULL
)è!ğ
MP_OKAY
) {

36  
»s
;

40 ià((
»s
 = 
	`mp_cİy
 (
b
, &
x
)è!ğ
MP_OKAY
) {

41 
LBL_ERR
;

45 ià((
»s
 = 
	`mp_mod
 (
a
, 
b
, &
y
)è!ğ
MP_OKAY
) {

46 
LBL_ERR
;

50 ià((
»s
 = 
	`mp_cİy
 (&
x
, &
u
)è!ğ
MP_OKAY
) {

51 
LBL_ERR
;

53 ià((
»s
 = 
	`mp_cİy
 (&
y
, &
v
)è!ğ
MP_OKAY
) {

54 
LBL_ERR
;

56 
	`mp_£t
 (&
D
, 1);

58 
tİ
:

60 
	`mp_i£v’
 (&
u
) == 1) {

62 ià((
»s
 = 
	`mp_div_2
 (&
u
, &u)è!ğ
MP_OKAY
) {

63 
LBL_ERR
;

66 ià(
	`mp_isodd
 (&
B
) == 1) {

67 ià((
»s
 = 
	`mp_sub
 (&
B
, &
x
, &B)è!ğ
MP_OKAY
) {

68 
LBL_ERR
;

72 ià((
»s
 = 
	`mp_div_2
 (&
B
, &B)è!ğ
MP_OKAY
) {

73 
LBL_ERR
;

78 
	`mp_i£v’
 (&
v
) == 1) {

80 ià((
»s
 = 
	`mp_div_2
 (&
v
, &v)è!ğ
MP_OKAY
) {

81 
LBL_ERR
;

84 ià(
	`mp_isodd
 (&
D
) == 1) {

86 ià((
»s
 = 
	`mp_sub
 (&
D
, &
x
, &D)è!ğ
MP_OKAY
) {

87 
LBL_ERR
;

91 ià((
»s
 = 
	`mp_div_2
 (&
D
, &D)è!ğ
MP_OKAY
) {

92 
LBL_ERR
;

97 ià(
	`mp_cmp
 (&
u
, &
v
è!ğ
MP_LT
) {

99 ià((
»s
 = 
	`mp_sub
 (&
u
, &
v
, &u)è!ğ
MP_OKAY
) {

100 
LBL_ERR
;

103 ià((
»s
 = 
	`mp_sub
 (&
B
, &
D
, &B)è!ğ
MP_OKAY
) {

104 
LBL_ERR
;

108 ià((
»s
 = 
	`mp_sub
 (&
v
, &
u
, &v)è!ğ
MP_OKAY
) {

109 
LBL_ERR
;

112 ià((
»s
 = 
	`mp_sub
 (&
D
, &
B
, &D)è!ğ
MP_OKAY
) {

113 
LBL_ERR
;

118 ià(
	`mp_isz”o
 (&
u
) == 0) {

119 
tİ
;

125 ià(
	`mp_cmp_d
 (&
v
, 1è!ğ
MP_EQ
) {

126 
»s
 = 
MP_VAL
;

127 
LBL_ERR
;

131 
Ãg
 = 
a
->
sign
;

132 
D
.
sign
 =ğ
MP_NEG
) {

133 ià((
»s
 = 
	`mp_add
 (&
D
, 
b
, &D)è!ğ
MP_OKAY
) {

134 
LBL_ERR
;

137 
	`mp_exch
 (&
D
, 
c
);

138 
c
->
sign
 = 
Ãg
;

139 
»s
 = 
MP_OKAY
;

141 
LBL_ERR
:
	`mp_ş—r_muÉi
 (&
x
, &
y
, &
u
, &
v
, &
B
, &
D
, 
NULL
);

142  
»s
;

143 
	}
}

	@libtommath/bn_fast_mp_montgomery_reduce.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_FAST_MP_MONTGOMERY_REDUCE_C


26 
	$ç¡_mp_mÚtgom”y_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
n
, 
mp_dig™
 
rho
)

28 
ix
, 
»s
, 
Şdu£
;

29 
mp_wÜd
 
W
[
MP_WARRAY
];

32 
Şdu£
 = 
x
->
u£d
;

35 ià(
x
->
®loc
 < 
n
->
u£d
 + 1) {

36 ià((
»s
 = 
	`mp_grow
 (
x
, 
n
->
u£d
 + 1)è!ğ
MP_OKAY
) {

37  
»s
;

45 
mp_wÜd
 *
_W
;

46 
mp_dig™
 *
tmpx
;

49 
_W
 = 
W
;

52 
tmpx
 = 
x
->
dp
;

55 
ix
 = 0; ix < 
x
->
u£d
; ix++) {

56 *
_W
++ = *
tmpx
++;

60 ; 
ix
 < 
n
->
u£d
 * 2 + 1; ix++) {

61 *
_W
++ = 0;

68 
ix
 = 0; ix < 
n
->
u£d
; ix++) {

75 
mp_dig™
 
mu
;

76 
mu
 = (
mp_dig™
è(((
W
[
ix
] & 
MP_MASK
è* 
rho
) & MP_MASK);

93 
iy
;

94 
mp_dig™
 *
tm²
;

95 
mp_wÜd
 *
_W
;

98 
tm²
 = 
n
->
dp
;

101 
_W
 = 
W
 + 
ix
;

104 
iy
 = 0; iy < 
n
->
u£d
; iy++) {

105 *
_W
++ +ğ((
mp_wÜd
)
mu
è* ((mp_wÜd)*
tm²
++);

110 
W
[
ix
 + 1] +ğW[ix] >> ((
mp_wÜd
è
DIGIT_BIT
);

118 
mp_dig™
 *
tmpx
;

119 
mp_wÜd
 *
_W
, *
_W1
;

124 
_W1
 = 
W
 + 
ix
;

127 
_W
 = 
W
 + ++
ix
;

129 ; 
ix
 <ğ
n
->
u£d
 * 2 + 1; ix++) {

130 *
_W
++ +ğ*
_W1
++ >> ((
mp_wÜd
è
DIGIT_BIT
);

141 
tmpx
 = 
x
->
dp
;

144 
_W
 = 
W
 + 
n
->
u£d
;

146 
ix
 = 0; ix < 
n
->
u£d
 + 1; ix++) {

147 *
tmpx
++ = (
mp_dig™
)(*
_W
++ & ((
mp_wÜd
è
MP_MASK
));

153 ; 
ix
 < 
Şdu£
; ix++) {

154 *
tmpx
++ = 0;

159 
x
->
u£d
 = 
n
->used + 1;

160 
	`mp_şamp
 (
x
);

163 ià(
	`mp_cmp_mag
 (
x
, 
n
è!ğ
MP_LT
) {

164  
	`s_mp_sub
 (
x
, 
n
, x);

166  
MP_OKAY
;

167 
	}
}

	@libtommath/bn_fast_s_mp_mul_digs.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_FAST_S_MP_MUL_DIGS_C


34 
	$ç¡_s_mp_mul_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

36 
Şdu£
, 
»s
, 
·
, 
ix
, 
iz
;

37 
mp_dig™
 
W
[
MP_WARRAY
];

38 
mp_wÜd
 
_W
;

41 ià(
c
->
®loc
 < 
digs
) {

42 ià((
»s
 = 
	`mp_grow
 (
c
, 
digs
)è!ğ
MP_OKAY
) {

43  
»s
;

48 
·
 = 
	`MIN
(
digs
, 
a
->
u£d
 + 
b
->used);

51 
_W
 = 0;

52 
ix
 = 0; ix < 
·
; ix++) {

53 
tx
, 
ty
;

54 
iy
;

55 
mp_dig™
 *
tmpx
, *
tmpy
;

58 
ty
 = 
	`MIN
(
b
->
u£d
-1, 
ix
);

59 
tx
 = 
ix
 - 
ty
;

62 
tmpx
 = 
a
->
dp
 + 
tx
;

63 
tmpy
 = 
b
->
dp
 + 
ty
;

68 
iy
 = 
	`MIN
(
a
->
u£d
-
tx
, 
ty
+1);

71 
iz
 = 0; iz < 
iy
; ++iz) {

72 
_W
 +ğ((
mp_wÜd
)*
tmpx
++)*((mp_wÜd)*
tmpy
--);

77 
W
[
ix
] = ((
mp_dig™
)
_W
è& 
MP_MASK
;

80 
_W
 = _W >> ((
mp_wÜd
)
DIGIT_BIT
);

84 
Şdu£
 = 
c
->
u£d
;

85 
c
->
u£d
 = 
·
;

88 
mp_dig™
 *
tmpc
;

89 
tmpc
 = 
c
->
dp
;

90 
ix
 = 0; ix < 
·
+1; ix++) {

92 *
tmpc
++ = 
W
[
ix
];

96 ; 
ix
 < 
Şdu£
; ix++) {

97 *
tmpc
++ = 0;

100 
	`mp_şamp
 (
c
);

101  
MP_OKAY
;

102 
	}
}

	@libtommath/bn_fast_s_mp_mul_high_digs.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_FAST_S_MP_MUL_HIGH_DIGS_C


27 
	$ç¡_s_mp_mul_high_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

29 
Şdu£
, 
»s
, 
·
, 
ix
, 
iz
;

30 
mp_dig™
 
W
[
MP_WARRAY
];

31 
mp_wÜd
 
_W
;

34 
·
 = 
a
->
u£d
 + 
b
->used;

35 ià(
c
->
®loc
 < 
·
) {

36 ià((
»s
 = 
	`mp_grow
 (
c
, 
·
)è!ğ
MP_OKAY
) {

37  
»s
;

42 
·
 = 
a
->
u£d
 + 
b
->used;

43 
_W
 = 0;

44 
ix
 = 
digs
; ix < 
·
; ix++) {

45 
tx
, 
ty
, 
iy
;

46 
mp_dig™
 *
tmpx
, *
tmpy
;

49 
ty
 = 
	`MIN
(
b
->
u£d
-1, 
ix
);

50 
tx
 = 
ix
 - 
ty
;

53 
tmpx
 = 
a
->
dp
 + 
tx
;

54 
tmpy
 = 
b
->
dp
 + 
ty
;

59 
iy
 = 
	`MIN
(
a
->
u£d
-
tx
, 
ty
+1);

62 
iz
 = 0; iz < 
iy
; iz++) {

63 
_W
 +ğ((
mp_wÜd
)*
tmpx
++)*((mp_wÜd)*
tmpy
--);

67 
W
[
ix
] = ((
mp_dig™
)
_W
è& 
MP_MASK
;

70 
_W
 = _W >> ((
mp_wÜd
)
DIGIT_BIT
);

74 
Şdu£
 = 
c
->
u£d
;

75 
c
->
u£d
 = 
·
;

78 
mp_dig™
 *
tmpc
;

80 
tmpc
 = 
c
->
dp
 + 
digs
;

81 
ix
 = 
digs
; ix < 
·
; ix++) {

83 *
tmpc
++ = 
W
[
ix
];

87 ; 
ix
 < 
Şdu£
; ix++) {

88 *
tmpc
++ = 0;

91 
	`mp_şamp
 (
c
);

92  
MP_OKAY
;

93 
	}
}

	@libtommath/bn_fast_s_mp_sqr.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_FAST_S_MP_SQR_C


28 
	$ç¡_s_mp_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

30 
Şdu£
, 
»s
, 
·
, 
ix
, 
iz
;

31 
mp_dig™
 
W
[
MP_WARRAY
], *
tmpx
;

32 
mp_wÜd
 
W1
;

35 
·
 = 
a
->
u£d
 +‡->used;

36 ià(
b
->
®loc
 < 
·
) {

37 ià((
»s
 = 
	`mp_grow
 (
b
, 
·
)è!ğ
MP_OKAY
) {

38  
»s
;

43 
W1
 = 0;

44 
ix
 = 0; ix < 
·
; ix++) {

45 
tx
, 
ty
, 
iy
;

46 
mp_wÜd
 
_W
;

47 
mp_dig™
 *
tmpy
;

50 
_W
 = 0;

53 
ty
 = 
	`MIN
(
a
->
u£d
-1, 
ix
);

54 
tx
 = 
ix
 - 
ty
;

57 
tmpx
 = 
a
->
dp
 + 
tx
;

58 
tmpy
 = 
a
->
dp
 + 
ty
;

63 
iy
 = 
	`MIN
(
a
->
u£d
-
tx
, 
ty
+1);

69 
iy
 = 
	`MIN
(iy, (
ty
-
tx
+1)>>1);

72 
iz
 = 0; iz < 
iy
; iz++) {

73 
_W
 +ğ((
mp_wÜd
)*
tmpx
++)*((mp_wÜd)*
tmpy
--);

77 
_W
 = _W + _W + 
W1
;

80 ià((
ix
&1) == 0) {

81 
_W
 +ğ((
mp_wÜd
)
a
->
dp
[
ix
>>1])*((mp_word)a->dp[ix>>1]);

85 
W
[
ix
] = (
mp_dig™
)(
_W
 & 
MP_MASK
);

88 
W1
 = 
_W
 >> ((
mp_wÜd
)
DIGIT_BIT
);

92 
Şdu£
 = 
b
->
u£d
;

93 
b
->
u£d
 = 
a
->used+a->used;

96 
mp_dig™
 *
tmpb
;

97 
tmpb
 = 
b
->
dp
;

98 
ix
 = 0; ix < 
·
; ix++) {

99 *
tmpb
++ = 
W
[
ix
] & 
MP_MASK
;

103 ; 
ix
 < 
Şdu£
; ix++) {

104 *
tmpb
++ = 0;

107 
	`mp_şamp
 (
b
);

108  
MP_OKAY
;

109 
	}
}

	@libtommath/bn_mp_2expt.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_2EXPT_C


24 
	$mp_2ex±
 (
mp_št
 * 
a
, 
b
)

26 
»s
;

29 
	`mp_z”o
 (
a
);

32 ià((
»s
 = 
	`mp_grow
 (
a
, 
b
 / 
DIGIT_BIT
 + 1)è!ğ
MP_OKAY
) {

33  
»s
;

37 
a
->
u£d
 = 
b
 / 
DIGIT_BIT
 + 1;

40 
a
->
dp
[
b
 / 
DIGIT_BIT
] = ((
mp_dig™
)1) << (b % DIGIT_BIT);

42  
MP_OKAY
;

43 
	}
}

	@libtommath/bn_mp_abs.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_ABS_C


23 
	$mp_abs
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

25 
»s
;

28 ià(
a
 !ğ
b
) {

29 ià((
»s
 = 
	`mp_cİy
 (
a
, 
b
)è!ğ
MP_OKAY
) {

30  
»s
;

35 
b
->
sign
 = 
MP_ZPOS
;

37  
MP_OKAY
;

38 
	}
}

	@libtommath/bn_mp_add.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_ADD_C


19 
	$mp_add
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

21 
§
, 
sb
, 
»s
;

24 
§
 = 
a
->
sign
;

25 
sb
 = 
b
->
sign
;

28 ià(
§
 =ğ
sb
) {

31 
c
->
sign
 = 
§
;

32 
»s
 = 
	`s_mp_add
 (
a
, 
b
, 
c
);

38 ià(
	`mp_cmp_mag
 (
a
, 
b
è=ğ
MP_LT
) {

39 
c
->
sign
 = 
sb
;

40 
»s
 = 
	`s_mp_sub
 (
b
, 
a
, 
c
);

42 
c
->
sign
 = 
§
;

43 
»s
 = 
	`s_mp_sub
 (
a
, 
b
, 
c
);

46  
»s
;

47 
	}
}

	@libtommath/bn_mp_add_d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_ADD_D_C


20 
	$mp_add_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

22 
»s
, 
ix
, 
Şdu£d
;

23 
mp_dig™
 *
tm·
, *
tmpc
, 
mu
;

26 ià(
c
->
®loc
 < 
a
->
u£d
 + 1) {

27 ià((
»s
 = 
	`mp_grow
(
c
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

28  
»s
;

33 ià(
a
->
sign
 =ğ
MP_NEG
 && (a->
u£d
 > 1 ||‡->
dp
[0] >ğ
b
)) {

35 
a
->
sign
 = 
MP_ZPOS
;

38 
»s
 = 
	`mp_sub_d
(
a
, 
b
, 
c
);

41 
a
->
sign
 = 
c
->sigÀğ
MP_NEG
;

44 
	`mp_şamp
(
c
);

46  
»s
;

50 
Şdu£d
 = 
c
->
u£d
;

53 
c
->
sign
 = 
MP_ZPOS
;

56 
tm·
 = 
a
->
dp
;

59 
tmpc
 = 
c
->
dp
;

62 ià(
a
->
sign
 =ğ
MP_ZPOS
) {

66 *
tmpc
 = *
tm·
++ + 
b
;

67 
mu
 = *
tmpc
 >> 
DIGIT_BIT
;

68 *
tmpc
++ &ğ
MP_MASK
;

71 
ix
 = 1; ix < 
a
->
u£d
; ix++) {

72 *
tmpc
 = *
tm·
++ + 
mu
;

73 
mu
 = *
tmpc
 >> 
DIGIT_BIT
;

74 *
tmpc
++ &ğ
MP_MASK
;

77 
ix
++;

78 *
tmpc
++ = 
mu
;

81 
c
->
u£d
 = 
a
->used + 1;

84 
c
->
u£d
 = 1;

87 ià(
a
->
u£d
 == 1) {

88 *
tmpc
++ = 
b
 - 
a
->
dp
[0];

90 *
tmpc
++ = 
b
;

96 
ix
 = 1;

100 
ix
++ < 
Şdu£d
) {

101 *
tmpc
++ = 0;

103 
	`mp_şamp
(
c
);

105  
MP_OKAY
;

106 
	}
}

	@libtommath/bn_mp_addmod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_ADDMOD_C


20 
	$mp_addmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

22 
»s
;

23 
mp_št
 
t
;

25 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

26  
»s
;

29 ià((
»s
 = 
	`mp_add
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

30 
	`mp_ş—r
 (&
t
);

31  
»s
;

33 
»s
 = 
	`mp_mod
 (&
t
, 
c
, 
d
);

34 
	`mp_ş—r
 (&
t
);

35  
»s
;

36 
	}
}

	@libtommath/bn_mp_and.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_AND_C


20 
	$mp_ªd
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 
»s
, 
ix
, 
px
;

23 
mp_št
 
t
, *
x
;

25 ià(
a
->
u£d
 > 
b
->used) {

26 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

27  
»s
;

29 
px
 = 
b
->
u£d
;

30 
x
 = 
b
;

32 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
b
)è!ğ
MP_OKAY
) {

33  
»s
;

35 
px
 = 
a
->
u£d
;

36 
x
 = 
a
;

39 
ix
 = 0; ix < 
px
; ix++) {

40 
t
.
dp
[
ix
] &ğ
x
->dp[ix];

44 ; 
ix
 < 
t
.
u£d
; ix++) {

45 
t
.
dp
[
ix
] = 0;

48 
	`mp_şamp
 (&
t
);

49 
	`mp_exch
 (
c
, &
t
);

50 
	`mp_ş—r
 (&
t
);

51  
MP_OKAY
;

52 
	}
}

	@libtommath/bn_mp_clamp.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_CLAMP_C


26 
	$mp_şamp
 (
mp_št
 * 
a
)

31 
a
->
u£d
 > 0 &&‡->
dp
[a->used - 1] == 0) {

32 --(
a
->
u£d
);

36 ià(
a
->
u£d
 == 0) {

37 
a
->
sign
 = 
MP_ZPOS
;

39 
	}
}

	@libtommath/bn_mp_clear.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_CLEAR_C


20 
	$mp_ş—r
 (
mp_št
 * 
a
)

22 vŞ©
mp_dig™
 *
p
;

23 
Ën
;

26 ià(
a
->
dp
 !ğ
NULL
) {

28 
Ën
 = 
a
->
®loc
;

29 
p
 = 
a
->
dp
;

30 
Ën
--) {

31 *
p
++ = 0;

35 
	`XFREE
(
a
->
dp
);

38 
a
->
dp
 = 
NULL
;

39 
a
->
®loc
 =‡->
u£d
 = 0;

40 
a
->
sign
 = 
MP_ZPOS
;

42 
	}
}

	@libtommath/bn_mp_clear_multi.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_CLEAR_MULTI_C


17 
	~<¡d¬g.h
>

19 
	$mp_ş—r_muÉi
(
mp_št
 *
mp
, ...)

21 
mp_št
* 
Ãxt_mp
 = 
mp
;

22 
va_li¡
 
¬gs
;

23 
	`va_¡¬t
(
¬gs
, 
mp
);

24 
Ãxt_mp
 !ğ
NULL
) {

25 
	`mp_ş—r
(
Ãxt_mp
);

26 
Ãxt_mp
 = 
	`va_¬g
(
¬gs
, 
mp_št
*);

28 
	`va_’d
(
¬gs
);

29 
	}
}

	@libtommath/bn_mp_cmp.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_CMP_C


20 
	$mp_cmp
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

23 ià(
a
->
sign
 !ğ
b
->sign) {

24 ià(
a
->
sign
 =ğ
MP_NEG
) {

25  
MP_LT
;

27  
MP_GT
;

32 ià(
a
->
sign
 =ğ
MP_NEG
) {

34  
	`mp_cmp_mag
(
b
, 
a
);

36  
	`mp_cmp_mag
(
a
, 
b
);

38 
	}
}

	@libtommath/bn_mp_cmp_d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_CMP_D_C


19 
	$mp_cmp_d
(
mp_št
 * 
a
, 
mp_dig™
 
b
)

22 ià(
a
->
sign
 =ğ
MP_NEG
) {

23  
MP_LT
;

27 ià(
a
->
u£d
 > 1) {

28  
MP_GT
;

32 ià(
a
->
dp
[0] > 
b
) {

33  
MP_GT
;

34 } ià(
a
->
dp
[0] < 
b
) {

35  
MP_LT
;

37  
MP_EQ
;

39 
	}
}

	@libtommath/bn_mp_cmp_mag.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_CMP_MAG_C


19 
	$mp_cmp_mag
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

21 
n
;

22 
mp_dig™
 *
tm·
, *
tmpb
;

25 ià(
a
->
u£d
 > 
b
->used) {

26  
MP_GT
;

29 ià(
a
->
u£d
 < 
b
->used) {

30  
MP_LT
;

34 
tm·
 = 
a
->
dp
 + (a->
u£d
 - 1);

37 
tmpb
 = 
b
->
dp
 + (
a
->
u£d
 - 1);

40 
n
 = 0;‚ < 
a
->
u£d
; ++n, --
tm·
, --
tmpb
) {

41 ià(*
tm·
 > *
tmpb
) {

42  
MP_GT
;

45 ià(*
tm·
 < *
tmpb
) {

46  
MP_LT
;

49  
MP_EQ
;

50 
	}
}

	@libtommath/bn_mp_cnt_lsb.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_CNT_LSB_C


18 cÚ¡ 
	gÊz
[16] = {

23 
	$mp_út_lsb
(
mp_št
 *
a
)

25 
x
;

26 
mp_dig™
 
q
, 
qq
;

29 ià(
	`mp_isz”o
(
a
) == 1) {

34 
x
 = 0; x < 
a
->
u£d
 &&‡->
dp
[x] == 0; x++);

35 
q
 = 
a
->
dp
[
x
];

36 
x
 *ğ
DIGIT_BIT
;

39 ià((
q
 & 1) == 0) {

41 
qq
 = 
q
 & 15;

42 
x
 +ğ
Êz
[
qq
];

43 
q
 >>= 4;

44 } 
qq
 == 0);

46  
x
;

47 
	}
}

	@libtommath/bn_mp_copy.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_COPY_C


20 
	$mp_cİy
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

22 
»s
, 
n
;

25 ià(
a
 =ğ
b
) {

26  
MP_OKAY
;

30 ià(
b
->
®loc
 < 
a
->
u£d
) {

31 ià((
»s
 = 
	`mp_grow
 (
b
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

32  
»s
;

38 
mp_dig™
 *
tm·
, *
tmpb
;

43 
tm·
 = 
a
->
dp
;

46 
tmpb
 = 
b
->
dp
;

49 
n
 = 0;‚ < 
a
->
u£d
;‚++) {

50 *
tmpb
++ = *
tm·
++;

54 ; 
n
 < 
b
->
u£d
;‚++) {

55 *
tmpb
++ = 0;

60 
b
->
u£d
 = 
a
->used;

61 
b
->
sign
 = 
a
->sign;

62  
MP_OKAY
;

63 
	}
}

	@libtommath/bn_mp_count_bits.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_COUNT_BITS_C


20 
	$mp_couÁ_b™s
 (
mp_št
 * 
a
)

22 
r
;

23 
mp_dig™
 
q
;

26 ià(
a
->
u£d
 == 0) {

31 
r
 = (
a
->
u£d
 - 1è* 
DIGIT_BIT
;

34 
q
 = 
a
->
dp
[a->
u£d
 - 1];

35 
q
 > ((
mp_dig™
) 0)) {

36 ++
r
;

37 
q
 >>ğ((
mp_dig™
) 1);

39  
r
;

40 
	}
}

	@libtommath/bn_mp_div.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DIV_C


18 #ifdeà
BN_MP_DIV_SMALL


21 
	$mp_div
(
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

23 
mp_št
 

, 
tb
, 
tq
, 
q
;

24 
»s
, 
n
, 
n2
;

27 ià(
	`mp_isz”o
 (
b
) == 1) {

28  
MP_VAL
;

32 ià(
	`mp_cmp_mag
 (
a
, 
b
è=ğ
MP_LT
) {

33 ià(
d
 !ğ
NULL
) {

34 
»s
 = 
	`mp_cİy
 (
a
, 
d
);

36 
»s
 = 
MP_OKAY
;

38 ià(
c
 !ğ
NULL
) {

39 
	`mp_z”o
 (
c
);

41  
»s
;

45 ià((
»s
 = 
	`mp_š™_muÉi
(&

, &
tb
, &
tq
, &
q
, 
NULL
è!ğ
MP_OKAY
)) {

46  
»s
;

50 
	`mp_£t
(&
tq
, 1);

51 
n
 = 
	`mp_couÁ_b™s
(
a
è- mp_couÁ_b™s(
b
);

52 ià(((
»s
 = 
	`mp_abs
(
a
, &

)è!ğ
MP_OKAY
) ||

53 ((
»s
 = 
	`mp_abs
(
b
, &
tb
)è!ğ
MP_OKAY
) ||

54 ((
»s
 = 
	`mp_mul_2d
(&
tb
, 
n
, &tb)è!ğ
MP_OKAY
) ||

55 ((
»s
 = 
	`mp_mul_2d
(&
tq
, 
n
, &tq)è!ğ
MP_OKAY
)) {

56 
LBL_ERR
;

59 
n
-- >= 0) {

60 ià(
	`mp_cmp
(&
tb
, &

è!ğ
MP_GT
) {

61 ià(((
»s
 = 
	`mp_sub
(&

, &
tb
, &)è!ğ
MP_OKAY
) ||

62 ((
»s
 = 
	`mp_add
(&
q
, &
tq
, &q)è!ğ
MP_OKAY
)) {

63 
LBL_ERR
;

66 ià(((
»s
 = 
	`mp_div_2d
(&
tb
, 1, &tb, 
NULL
)è!ğ
MP_OKAY
) ||

67 ((
»s
 = 
	`mp_div_2d
(&
tq
, 1, &tq, 
NULL
)è!ğ
MP_OKAY
)) {

68 
LBL_ERR
;

73 
n
 = 
a
->
sign
;

74 
n2
 = (
a
->
sign
 =ğ
b
->sigÀ? 
MP_ZPOS
 : 
MP_NEG
);

75 ià(
c
 !ğ
NULL
) {

76 
	`mp_exch
(
c
, &
q
);

77 
c
->
sign
 = (
	`mp_isz”o
(cè=ğ
MP_YES
è? 
MP_ZPOS
 : 
n2
;

79 ià(
d
 !ğ
NULL
) {

80 
	`mp_exch
(
d
, &

);

81 
d
->
sign
 = (
	`mp_isz”o
(dè=ğ
MP_YES
è? 
MP_ZPOS
 : 
n
;

83 
LBL_ERR
:

84 
	`mp_ş—r_muÉi
(&

, &
tb
, &
tq
, &
q
, 
NULL
);

85  
»s
;

86 
	}
}

103 
	$mp_div
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

105 
mp_št
 
q
, 
x
, 
y
, 
t1
, 
t2
;

106 
»s
, 
n
, 
t
, 
i
, 
nÜm
, 
Ãg
;

109 ià(
	`mp_isz”o
 (
b
) == 1) {

110  
MP_VAL
;

114 ià(
	`mp_cmp_mag
 (
a
, 
b
è=ğ
MP_LT
) {

115 ià(
d
 !ğ
NULL
) {

116 
»s
 = 
	`mp_cİy
 (
a
, 
d
);

118 
»s
 = 
MP_OKAY
;

120 ià(
c
 !ğ
NULL
) {

121 
	`mp_z”o
 (
c
);

123  
»s
;

126 ià((
»s
 = 
	`mp_š™_size
 (&
q
, 
a
->
u£d
 + 2)è!ğ
MP_OKAY
) {

127  
»s
;

129 
q
.
u£d
 = 
a
->used + 2;

131 ià((
»s
 = 
	`mp_š™
 (&
t1
)è!ğ
MP_OKAY
) {

132 
LBL_Q
;

135 ià((
»s
 = 
	`mp_š™
 (&
t2
)è!ğ
MP_OKAY
) {

136 
LBL_T1
;

139 ià((
»s
 = 
	`mp_š™_cİy
 (&
x
, 
a
)è!ğ
MP_OKAY
) {

140 
LBL_T2
;

143 ià((
»s
 = 
	`mp_š™_cİy
 (&
y
, 
b
)è!ğ
MP_OKAY
) {

144 
LBL_X
;

148 
Ãg
 = (
a
->
sign
 =ğ
b
->signè? 
MP_ZPOS
 : 
MP_NEG
;

149 
x
.
sign
 = 
y
.sigÀğ
MP_ZPOS
;

152 
nÜm
 = 
	`mp_couÁ_b™s
(&
y
è% 
DIGIT_BIT
;

153 ià(
nÜm
 < ()(
DIGIT_BIT
-1)) {

154 
nÜm
 = (
DIGIT_BIT
-1) -‚orm;

155 ià((
»s
 = 
	`mp_mul_2d
 (&
x
, 
nÜm
, &x)è!ğ
MP_OKAY
) {

156 
LBL_Y
;

158 ià((
»s
 = 
	`mp_mul_2d
 (&
y
, 
nÜm
, &y)è!ğ
MP_OKAY
) {

159 
LBL_Y
;

162 
nÜm
 = 0;

166 
n
 = 
x
.
u£d
 - 1;

167 
t
 = 
y
.
u£d
 - 1;

170 ià((
»s
 = 
	`mp_lshd
 (&
y
, 
n
 - 
t
)è!ğ
MP_OKAY
) {

171 
LBL_Y
;

174 
	`mp_cmp
 (&
x
, &
y
è!ğ
MP_LT
) {

175 ++(
q
.
dp
[
n
 - 
t
]);

176 ià((
»s
 = 
	`mp_sub
 (&
x
, &
y
, &x)è!ğ
MP_OKAY
) {

177 
LBL_Y
;

182 
	`mp_rshd
 (&
y
, 
n
 - 
t
);

185 
i
 = 
n
; i >ğ(
t
 + 1); i--) {

186 ià(
i
 > 
x
.
u£d
) {

192 ià(
x
.
dp
[
i
] =ğ
y
.dp[
t
]) {

193 
q
.
dp
[
i
 - 
t
 - 1] = ((((
mp_dig™
)1è<< 
DIGIT_BIT
) - 1);

195 
mp_wÜd
 
tmp
;

196 
tmp
 = ((
mp_wÜd
è
x
.
dp
[
i
]è<< ((mp_wÜdè
DIGIT_BIT
);

197 
tmp
 |ğ((
mp_wÜd
è
x
.
dp
[
i
 - 1]);

198 
tmp
 /ğ((
mp_wÜd
è
y
.
dp
[
t
]);

199 ià(
tmp
 > (
mp_wÜd
è
MP_MASK
)

200 
tmp
 = 
MP_MASK
;

201 
q
.
dp
[
i
 - 
t
 - 1] = (
mp_dig™
è(
tmp
 & (
mp_wÜd
è(
MP_MASK
));

209 
q
.
dp
[
i
 - 
t
 - 1] = (q.dp[˜- - 1] + 1è& 
MP_MASK
;

211 
q
.
dp
[
i
 - 
t
 - 1] = (q.dp[˜- - 1] - 1è& 
MP_MASK
;

214 
	`mp_z”o
 (&
t1
);

215 
t1
.
dp
[0] = (
t
 - 1 < 0è? 0 : 
y
.dp[t - 1];

216 
t1
.
dp
[1] = 
y
.dp[
t
];

217 
t1
.
u£d
 = 2;

218 ià((
»s
 = 
	`mp_mul_d
 (&
t1
, 
q
.
dp
[
i
 - 
t
 - 1], &t1)è!ğ
MP_OKAY
) {

219 
LBL_Y
;

223 
t2
.
dp
[0] = (
i
 - 2 < 0è? 0 : 
x
.dp[i - 2];

224 
t2
.
dp
[1] = (
i
 - 1 < 0è? 0 : 
x
.dp[i - 1];

225 
t2
.
dp
[2] = 
x
.dp[
i
];

226 
t2
.
u£d
 = 3;

227 } 
	`mp_cmp_mag
(&
t1
, &
t2
è=ğ
MP_GT
);

230 ià((
»s
 = 
	`mp_mul_d
 (&
y
, 
q
.
dp
[
i
 - 
t
 - 1], &
t1
)è!ğ
MP_OKAY
) {

231 
LBL_Y
;

234 ià((
»s
 = 
	`mp_lshd
 (&
t1
, 
i
 - 
t
 - 1)è!ğ
MP_OKAY
) {

235 
LBL_Y
;

238 ià((
»s
 = 
	`mp_sub
 (&
x
, &
t1
, &x)è!ğ
MP_OKAY
) {

239 
LBL_Y
;

243 ià(
x
.
sign
 =ğ
MP_NEG
) {

244 ià((
»s
 = 
	`mp_cİy
 (&
y
, &
t1
)è!ğ
MP_OKAY
) {

245 
LBL_Y
;

247 ià((
»s
 = 
	`mp_lshd
 (&
t1
, 
i
 - 
t
 - 1)è!ğ
MP_OKAY
) {

248 
LBL_Y
;

250 ià((
»s
 = 
	`mp_add
 (&
x
, &
t1
, &x)è!ğ
MP_OKAY
) {

251 
LBL_Y
;

254 
q
.
dp
[
i
 - 
t
 - 1] = (q.dp[˜- - 1] - 1ULè& 
MP_MASK
;

263 
x
.
sign
 = x.
u£d
 =ğ0 ? 
MP_ZPOS
 : 
a
->sign;

265 ià(
c
 !ğ
NULL
) {

266 
	`mp_şamp
 (&
q
);

267 
	`mp_exch
 (&
q
, 
c
);

268 
c
->
sign
 = 
Ãg
;

271 ià(
d
 !ğ
NULL
) {

272 ià((
»s
 = 
	`mp_div_2d
 (&
x
, 
nÜm
, &x, 
NULL
)è!ğ
MP_OKAY
) {

273 
LBL_Y
;

275 
	`mp_exch
 (&
x
, 
d
);

278 
»s
 = 
MP_OKAY
;

280 
LBL_Y
:
	`mp_ş—r
 (&
y
);

281 
LBL_X
:
	`mp_ş—r
 (&
x
);

282 
LBL_T2
:
	`mp_ş—r
 (&
t2
);

283 
LBL_T1
:
	`mp_ş—r
 (&
t1
);

284 
LBL_Q
:
	`mp_ş—r
 (&
q
);

285  
»s
;

286 
	}
}

	@libtommath/bn_mp_div_2.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DIV_2_C


19 
	$mp_div_2
(
mp_št
 * 
a
, mp_šˆ* 
b
)

21 
x
, 
»s
, 
Şdu£d
;

24 ià(
b
->
®loc
 < 
a
->
u£d
) {

25 ià((
»s
 = 
	`mp_grow
 (
b
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

26  
»s
;

30 
Şdu£d
 = 
b
->
u£d
;

31 
b
->
u£d
 = 
a
->used;

33 
mp_dig™
 
r
, 
¼
, *
tm·
, *
tmpb
;

36 
tm·
 = 
a
->
dp
 + 
b
->
u£d
 - 1;

39 
tmpb
 = 
b
->
dp
 + b->
u£d
 - 1;

42 
r
 = 0;

43 
x
 = 
b
->
u£d
 - 1; x >= 0; x--) {

45 
¼
 = *
tm·
 & 1;

48 *
tmpb
-- = (*
tm·
-- >> 1è| (
r
 << (
DIGIT_BIT
 - 1));

51 
r
 = 
¼
;

55 
tmpb
 = 
b
->
dp
 + b->
u£d
;

56 
x
 = 
b
->
u£d
; x < 
Şdu£d
; x++) {

57 *
tmpb
++ = 0;

60 
b
->
sign
 = 
a
->sign;

61 
	`mp_şamp
 (
b
);

62  
MP_OKAY
;

63 
	}
}

	@libtommath/bn_mp_div_2d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DIV_2D_C


19 
	$mp_div_2d
 (
mp_št
 * 
a
, 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

21 
mp_dig™
 
D
, 
r
, 
¼
;

22 
x
, 
»s
;

23 
mp_št
 
t
;

27 ià(
b
 <= 0) {

28 
»s
 = 
	`mp_cİy
 (
a
, 
c
);

29 ià(
d
 !ğ
NULL
) {

30 
	`mp_z”o
 (
d
);

32  
»s
;

35 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

36  
»s
;

40 ià(
d
 !ğ
NULL
) {

41 ià((
»s
 = 
	`mp_mod_2d
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

42 
	`mp_ş—r
 (&
t
);

43  
»s
;

48 ià((
»s
 = 
	`mp_cİy
 (
a
, 
c
)è!ğ
MP_OKAY
) {

49 
	`mp_ş—r
 (&
t
);

50  
»s
;

54 ià(
b
 >ğ()
DIGIT_BIT
) {

55 
	`mp_rshd
 (
c
, 
b
 / 
DIGIT_BIT
);

59 
D
 = (
mp_dig™
è(
b
 % 
DIGIT_BIT
);

60 ià(
D
 != 0) {

61 
mp_dig™
 *
tmpc
, 
mask
, 
shiá
;

64 
mask
 = (((
mp_dig™
)1è<< 
D
) - 1;

67 
shiá
 = 
DIGIT_BIT
 - 
D
;

70 
tmpc
 = 
c
->
dp
 + (c->
u£d
 - 1);

73 
r
 = 0;

74 
x
 = 
c
->
u£d
 - 1; x >= 0; x--) {

76 
¼
 = *
tmpc
 & 
mask
;

79 *
tmpc
 = (*tmpø>> 
D
è| (
r
 << 
shiá
);

80 --
tmpc
;

83 
r
 = 
¼
;

86 
	`mp_şamp
 (
c
);

87 ià(
d
 !ğ
NULL
) {

88 
	`mp_exch
 (&
t
, 
d
);

90 
	`mp_ş—r
 (&
t
);

91  
MP_OKAY
;

92 
	}
}

	@libtommath/bn_mp_div_3.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DIV_3_C


20 
	$mp_div_3
 (
mp_št
 * 
a
, mp_šˆ*
c
, 
mp_dig™
 * 
d
)

22 
mp_št
 
q
;

23 
mp_wÜd
 
w
, 
t
;

24 
mp_dig™
 
b
;

25 
»s
, 
ix
;

28 
b
 = (((
mp_wÜd
)1è<< ((mp_wÜd)
DIGIT_BIT
)) / ((mp_word)3);

30 ià((
»s
 = 
	`mp_š™_size
(&
q
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

31  
»s
;

34 
q
.
u£d
 = 
a
->used;

35 
q
.
sign
 = 
a
->sign;

36 
w
 = 0;

37 
ix
 = 
a
->
u£d
 - 1; ix >= 0; ix--) {

38 
w
 = (w << ((
mp_wÜd
)
DIGIT_BIT
)è| ((mp_wÜd)
a
->
dp
[
ix
]);

40 ià(
w
 >= 3) {

42 
t
 = (
w
 * ((
mp_wÜd
)
b
)è>> ((mp_wÜd)
DIGIT_BIT
);

45 
w
 -ğ
t
+t+t;

50 
w
 >= 3) {

51 
t
 += 1;

52 
w
 -= 3;

55 
t
 = 0;

57 
q
.
dp
[
ix
] = (
mp_dig™
)
t
;

61 ià(
d
 !ğ
NULL
) {

62 *
d
 = (
mp_dig™
)
w
;

66 ià(
c
 !ğ
NULL
) {

67 
	`mp_şamp
(&
q
);

68 
	`mp_exch
(&
q
, 
c
);

70 
	`mp_ş—r
(&
q
);

72  
»s
;

73 
	}
}

	@libtommath/bn_mp_div_d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DIV_D_C


18 
	$s_is_pow”_of_two
(
mp_dig™
 
b
, *
p
)

20 
x
;

22 
x
 = 1; x < 
DIGIT_BIT
; x++) {

23 ià(
b
 =ğ(((
mp_dig™
)1)<<
x
)) {

24 *
p
 = 
x
;

29 
	}
}

32 
	$mp_div_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
, mp_dig™ * 
d
)

34 
mp_št
 
q
;

35 
mp_wÜd
 
w
;

36 
mp_dig™
 
t
;

37 
»s
, 
ix
;

40 ià(
b
 == 0) {

41  
MP_VAL
;

45 ià(
b
 =ğ1 || 
	`mp_isz”o
(
a
) == 1) {

46 ià(
d
 !ğ
NULL
) {

47 *
d
 = 0;

49 ià(
c
 !ğ
NULL
) {

50  
	`mp_cİy
(
a
, 
c
);

52  
MP_OKAY
;

56 ià(
	`s_is_pow”_of_two
(
b
, &
ix
) == 1) {

57 ià(
d
 !ğ
NULL
) {

58 *
d
 = 
a
->
dp
[0] & ((((
mp_dig™
)1)<<
ix
) - 1);

60 ià(
c
 !ğ
NULL
) {

61  
	`mp_div_2d
(
a
, 
ix
, 
c
, 
NULL
);

63  
MP_OKAY
;

66 #ifdeà
BN_MP_DIV_3_C


68 ià(
b
 == 3) {

69  
	`mp_div_3
(
a
, 
c
, 
d
);

74 ià((
»s
 = 
	`mp_š™_size
(&
q
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

75  
»s
;

78 
q
.
u£d
 = 
a
->used;

79 
q
.
sign
 = 
a
->sign;

80 
w
 = 0;

81 
ix
 = 
a
->
u£d
 - 1; ix >= 0; ix--) {

82 
w
 = (w << ((
mp_wÜd
)
DIGIT_BIT
)è| ((mp_wÜd)
a
->
dp
[
ix
]);

84 ià(
w
 >ğ
b
) {

85 
t
 = (
mp_dig™
)(
w
 / 
b
);

86 
w
 -ğ((
mp_wÜd
)
t
è* ((mp_wÜd)
b
);

88 
t
 = 0;

90 
q
.
dp
[
ix
] = (
mp_dig™
)
t
;

93 ià(
d
 !ğ
NULL
) {

94 *
d
 = (
mp_dig™
)
w
;

97 ià(
c
 !ğ
NULL
) {

98 
	`mp_şamp
(&
q
);

99 
	`mp_exch
(&
q
, 
c
);

101 
	`mp_ş—r
(&
q
);

103  
»s
;

104 
	}
}

	@libtommath/bn_mp_dr_is_modulus.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DR_IS_MODULUS_C


19 
	$mp_dr_is_modulus
(
mp_št
 *
a
)

21 
ix
;

24 ià(
a
->
u£d
 < 2) {

31 
ix
 = 1; ix < 
a
->
u£d
; ix++) {

32 ià(
a
->
dp
[
ix
] !ğ
MP_MASK
) {

37 
	}
}

	@libtommath/bn_mp_dr_reduce.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DR_REDUCE_C


33 
	$mp_dr_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
n
, 
mp_dig™
 
k
)

35 
”r
, 
i
, 
m
;

36 
mp_wÜd
 
r
;

37 
mp_dig™
 
mu
, *
tmpx1
, *
tmpx2
;

40 
m
 = 
n
->
u£d
;

43 ià(
x
->
®loc
 < 
m
 + m) {

44 ià((
”r
 = 
	`mp_grow
 (
x
, 
m
 + m)è!ğ
MP_OKAY
) {

45  
”r
;

52 
tİ
:

55 
tmpx1
 = 
x
->
dp
;

58 
tmpx2
 = 
x
->
dp
 + 
m
;

61 
mu
 = 0;

64 
i
 = 0; i < 
m
; i++) {

65 
r
 = ((
mp_wÜd
)*
tmpx2
++è* ((mp_wÜd)
k
è+ *
tmpx1
 + 
mu
;

66 *
tmpx1
++ = (
mp_dig™
)(
r
 & 
MP_MASK
);

67 
mu
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
)
DIGIT_BIT
));

71 *
tmpx1
++ = 
mu
;

74 
i
 = 
m
 + 1; i < 
x
->
u£d
; i++) {

75 *
tmpx1
++ = 0;

79 
	`mp_şamp
 (
x
);

84 ià(
	`mp_cmp_mag
 (
x
, 
n
è!ğ
MP_LT
) {

85 
	`s_mp_sub
(
x
, 
n
, x);

86 
tİ
;

88  
MP_OKAY
;

89 
	}
}

	@libtommath/bn_mp_dr_setup.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_DR_SETUP_C


19 
	$mp_dr_£tup
(
mp_št
 *
a
, 
mp_dig™
 *
d
)

24 *
d
 = (
mp_dig™
)((((
mp_wÜd
)1è<< ((mp_wÜd)
DIGIT_BIT
)) -

25 ((
mp_wÜd
)
a
->
dp
[0]));

26 
	}
}

	@libtommath/bn_mp_exch.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_EXCH_C


22 
	$mp_exch
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

24 
mp_št
 
t
;

26 
t
 = *
a
;

27 *
a
 = *
b
;

28 *
b
 = 
t
;

29 
	}
}

	@libtommath/bn_mp_expt_d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_EXPT_D_C


19 
	$mp_ex±_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

21 
»s
, 
x
;

22 
mp_št
 
g
;

24 ià((
»s
 = 
	`mp_š™_cİy
 (&
g
, 
a
)è!ğ
MP_OKAY
) {

25  
»s
;

29 
	`mp_£t
 (
c
, 1);

31 
x
 = 0; x < (è
DIGIT_BIT
; x++) {

33 ià((
»s
 = 
	`mp_sqr
 (
c
, c)è!ğ
MP_OKAY
) {

34 
	`mp_ş—r
 (&
g
);

35  
»s
;

39 ià((
b
 & (
mp_dig™
è(((mp_dig™)1è<< (
DIGIT_BIT
 - 1))) != 0) {

40 ià((
»s
 = 
	`mp_mul
 (
c
, &
g
, c)è!ğ
MP_OKAY
) {

41 
	`mp_ş—r
 (&
g
);

42  
»s
;

47 
b
 <<= 1;

50 
	`mp_ş—r
 (&
g
);

51  
MP_OKAY
;

52 
	}
}

	@libtommath/bn_mp_exptmod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_EXPTMOD_C


24 
	$mp_ex±mod
 (
mp_št
 * 
G
, mp_šˆ* 
X
, mp_šˆ* 
P
, mp_šˆ* 
Y
)

26 
dr
;

29 ià(
P
->
sign
 =ğ
MP_NEG
) {

30  
MP_VAL
;

34 ià(
X
->
sign
 =ğ
MP_NEG
) {

35 #ifdeà
BN_MP_INVMOD_C


36 
mp_št
 
tmpG
, 
tmpX
;

37 
”r
;

40 ià((
”r
 = 
	`mp_š™
(&
tmpG
)è!ğ
MP_OKAY
) {

41  
”r
;

43 ià((
”r
 = 
	`mp_švmod
(
G
, 
P
, &
tmpG
)è!ğ
MP_OKAY
) {

44 
	`mp_ş—r
(&
tmpG
);

45  
”r
;

49 ià((
”r
 = 
	`mp_š™
(&
tmpX
)è!ğ
MP_OKAY
) {

50 
	`mp_ş—r
(&
tmpG
);

51  
”r
;

53 ià((
”r
 = 
	`mp_abs
(
X
, &
tmpX
)è!ğ
MP_OKAY
) {

54 
	`mp_ş—r_muÉi
(&
tmpG
, &
tmpX
, 
NULL
);

55  
”r
;

59 
”r
 = 
	`mp_ex±mod
(&
tmpG
, &
tmpX
, 
P
, 
Y
);

60 
	`mp_ş—r_muÉi
(&
tmpG
, &
tmpX
, 
NULL
);

61  
”r
;

64  
MP_VAL
;

69 #ià
	`defšed
(
BN_MP_REDUCE_IS_2K_L_C
è&& defšed(
BN_MP_REDUCE_2K_L_C
è&& defšed(
BN_S_MP_EXPTMOD_C
)

70 ià(
	`mp_»duû_is_2k_l
(
P
è=ğ
MP_YES
) {

71  
	`s_mp_ex±mod
(
G
, 
X
, 
P
, 
Y
, 1);

75 #ifdeà
BN_MP_DR_IS_MODULUS_C


77 
dr
 = 
	`mp_dr_is_modulus
(
P
);

80 
dr
 = 0;

83 #ifdeà
BN_MP_REDUCE_IS_2K_C


85 ià(
dr
 == 0) {

86 
dr
 = 
	`mp_»duû_is_2k
(
P
) << 1;

91 #ifdeà
BN_MP_EXPTMOD_FAST_C


92 ià(
	`mp_isodd
 (
P
è=ğ1 || 
dr
 != 0) {

93  
	`mp_ex±mod_ç¡
 (
G
, 
X
, 
P
, 
Y
, 
dr
);

96 #ifdeà
BN_S_MP_EXPTMOD_C


98  
	`s_mp_ex±mod
 (
G
, 
X
, 
P
, 
Y
, 0);

101  
MP_VAL
;

103 #ifdeà
BN_MP_EXPTMOD_FAST_C


106 
	}
}

	@libtommath/bn_mp_exptmod_fast.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_EXPTMOD_FAST_C


26 #ifdeà
MP_LOW_MEM


27 
	#TAB_SIZE
 32

	)

29 
	#TAB_SIZE
 256

	)

32 
	$mp_ex±mod_ç¡
 (
mp_št
 * 
G
, mp_šˆ* 
X
, mp_šˆ* 
P
, mp_šˆ* 
Y
, 
»dmode
)

34 
mp_št
 
M
[
TAB_SIZE
], 
»s
;

35 
mp_dig™
 
buf
, 
mp
;

36 
”r
, 
b™buf
, 
b™ıy
, 
b™út
, 
mode
, 
digidx
, 
x
, 
y
, 
wšsize
;

42 (*
»dux
)(
mp_št
*,mp_št*,
mp_dig™
);

45 
x
 = 
	`mp_couÁ_b™s
 (
X
);

46 ià(
x
 <= 7) {

47 
wšsize
 = 2;

48 } ià(
x
 <= 36) {

49 
wšsize
 = 3;

50 } ià(
x
 <= 140) {

51 
wšsize
 = 4;

52 } ià(
x
 <= 450) {

53 
wšsize
 = 5;

54 } ià(
x
 <= 1303) {

55 
wšsize
 = 6;

56 } ià(
x
 <= 3529) {

57 
wšsize
 = 7;

59 
wšsize
 = 8;

62 #ifdeà
MP_LOW_MEM


63 ià(
wšsize
 > 5) {

64 
wšsize
 = 5;

70 ià((
”r
 = 
	`mp_š™
(&
M
[1])è!ğ
MP_OKAY
) {

71  
”r
;

75 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

76 ià((
”r
 = 
	`mp_š™
(&
M
[
x
])è!ğ
MP_OKAY
) {

77 
y
 = 1<<(
wšsize
-1); y < 
x
; y++) {

78 
	`mp_ş—r
 (&
M
[
y
]);

80 
	`mp_ş—r
(&
M
[1]);

81  
”r
;

86 ià(
»dmode
 == 0) {

87 #ifdeà
BN_MP_MONTGOMERY_SETUP_C


89 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
 (
P
, &
mp
)è!ğ
MP_OKAY
) {

90 
LBL_M
;

93 
”r
 = 
MP_VAL
;

94 
LBL_M
;

98 #ifdeà
BN_FAST_MP_MONTGOMERY_REDUCE_C


99 ià(((
P
->
u£d
 * 2 + 1è< 
MP_WARRAY
) &&

100 
P
->
u£d
 < (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

101 
»dux
 = 
ç¡_mp_mÚtgom”y_»duû
;

105 #ifdeà
BN_MP_MONTGOMERY_REDUCE_C


107 
»dux
 = 
mp_mÚtgom”y_»duû
;

109 
”r
 = 
MP_VAL
;

110 
LBL_M
;

113 } ià(
»dmode
 == 1) {

114 #ià
	`defšed
(
BN_MP_DR_SETUP_C
è&& defšed(
BN_MP_DR_REDUCE_C
)

116 
	`mp_dr_£tup
(
P
, &
mp
);

117 
»dux
 = 
mp_dr_»duû
;

119 
”r
 = 
MP_VAL
;

120 
LBL_M
;

123 #ià
	`defšed
(
BN_MP_REDUCE_2K_SETUP_C
è&& defšed(
BN_MP_REDUCE_2K_C
)

125 ià((
”r
 = 
	`mp_»duû_2k_£tup
(
P
, &
mp
)è!ğ
MP_OKAY
) {

126 
LBL_M
;

128 
»dux
 = 
mp_»duû_2k
;

130 
”r
 = 
MP_VAL
;

131 
LBL_M
;

136 ià((
”r
 = 
	`mp_š™
 (&
»s
)è!ğ
MP_OKAY
) {

137 
LBL_M
;

147 ià(
»dmode
 == 0) {

148 #ifdeà
BN_MP_MONTGOMERY_CALC_NORMALIZATION_C


150 ià((
”r
 = 
	`mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
 (&
»s
, 
P
)è!ğ
MP_OKAY
) {

151 
LBL_RES
;

154 
”r
 = 
MP_VAL
;

155 
LBL_RES
;

159 ià((
”r
 = 
	`mp_mulmod
 (
G
, &
»s
, 
P
, &
M
[1])è!ğ
MP_OKAY
) {

160 
LBL_RES
;

163 
	`mp_£t
(&
»s
, 1);

164 ià((
”r
 = 
	`mp_mod
(
G
, 
P
, &
M
[1])è!ğ
MP_OKAY
) {

165 
LBL_RES
;

170 ià((
”r
 = 
	`mp_cİy
 (&
M
[1], &M[1 << (
wšsize
 - 1)])è!ğ
MP_OKAY
) {

171 
LBL_RES
;

174 
x
 = 0; x < (
wšsize
 - 1); x++) {

175 ià((
”r
 = 
	`mp_sqr
 (&
M
[1 << (
wšsize
 - 1)], &M[1 << (wšsiz- 1)])è!ğ
MP_OKAY
) {

176 
LBL_RES
;

178 ià((
”r
 = 
	`»dux
 (&
M
[1 << (
wšsize
 - 1)], 
P
, 
mp
)è!ğ
MP_OKAY
) {

179 
LBL_RES
;

184 
x
 = (1 << (
wšsize
 - 1)) + 1; x < (1 << winsize); x++) {

185 ià((
”r
 = 
	`mp_mul
 (&
M
[
x
 - 1], &M[1], &M[x])è!ğ
MP_OKAY
) {

186 
LBL_RES
;

188 ià((
”r
 = 
	`»dux
 (&
M
[
x
], 
P
, 
mp
)è!ğ
MP_OKAY
) {

189 
LBL_RES
;

194 
mode
 = 0;

195 
b™út
 = 1;

196 
buf
 = 0;

197 
digidx
 = 
X
->
u£d
 - 1;

198 
b™ıy
 = 0;

199 
b™buf
 = 0;

203 ià(--
b™út
 == 0) {

205 ià(
digidx
 == -1) {

209 
buf
 = 
X
->
dp
[
digidx
--];

210 
b™út
 = ()
DIGIT_BIT
;

214 
y
 = (
mp_dig™
)(
buf
 >> (
DIGIT_BIT
 - 1)) & 1;

215 
buf
 <<ğ(
mp_dig™
)1;

222 ià(
mode
 =ğ0 && 
y
 == 0) {

227 ià(
mode
 =ğ1 && 
y
 == 0) {

228 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

229 
LBL_RES
;

231 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

232 
LBL_RES
;

238 
b™buf
 |ğ(
y
 << (
wšsize
 - ++
b™ıy
));

239 
mode
 = 2;

241 ià(
b™ıy
 =ğ
wšsize
) {

244 
x
 = 0; x < 
wšsize
; x++) {

245 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

246 
LBL_RES
;

248 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

249 
LBL_RES
;

254 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[
b™buf
], &»s)è!ğ
MP_OKAY
) {

255 
LBL_RES
;

257 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

258 
LBL_RES
;

262 
b™ıy
 = 0;

263 
b™buf
 = 0;

264 
mode
 = 1;

269 ià(
mode
 =ğ2 && 
b™ıy
 > 0) {

271 
x
 = 0; x < 
b™ıy
; x++) {

272 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

273 
LBL_RES
;

275 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

276 
LBL_RES
;

280 
b™buf
 <<= 1;

281 ià((
b™buf
 & (1 << 
wšsize
)) != 0) {

283 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[1], &»s)è!ğ
MP_OKAY
) {

284 
LBL_RES
;

286 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

287 
LBL_RES
;

293 ià(
»dmode
 == 0) {

300 ià((
”r
 = 
	`»dux
(&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

301 
LBL_RES
;

306 
	`mp_exch
 (&
»s
, 
Y
);

307 
”r
 = 
MP_OKAY
;

308 
LBL_RES
:
	`mp_ş—r
 (&
»s
);

309 
LBL_M
:

310 
	`mp_ş—r
(&
M
[1]);

311 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

312 
	`mp_ş—r
 (&
M
[
x
]);

314  
”r
;

315 
	}
}

	@libtommath/bn_mp_exteuclid.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_EXTEUCLID_C


21 
	$mp_ex‹uşid
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
U1
, mp_šˆ*
U2
, mp_šˆ*
U3
)

23 
mp_št
 
u1
,
u2
,
u3
,
v1
,
v2
,
v3
,
t1
,
t2
,
t3
,
q
,
tmp
;

24 
”r
;

26 ià((
”r
 = 
	`mp_š™_muÉi
(&
u1
, &
u2
, &
u3
, &
v1
, &
v2
, &
v3
, &
t1
, &
t2
, &
t3
, &
q
, &
tmp
, 
NULL
)è!ğ
MP_OKAY
) {

27  
”r
;

31 
	`mp_£t
(&
u1
, 1);

32 ià((
”r
 = 
	`mp_cİy
(
a
, &
u3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

35 
	`mp_£t
(&
v2
, 1);

36 ià((
”r
 = 
	`mp_cİy
(
b
, &
v3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

39 
	`mp_isz”o
(&
v3
è=ğ
MP_NO
) {

41 ià((
”r
 = 
	`mp_div
(&
u3
, &
v3
, &
q
, 
NULL
)è!ğ
MP_OKAY
è{ 
_ERR
; }

44 ià((
”r
 = 
	`mp_mul
(&
v1
, &
q
, &
tmp
)è!ğ
MP_OKAY
è{ 
_ERR
; }

45 ià((
”r
 = 
	`mp_sub
(&
u1
, &
tmp
, &
t1
)è!ğ
MP_OKAY
è{ 
_ERR
; }

46 ià((
”r
 = 
	`mp_mul
(&
v2
, &
q
, &
tmp
)è!ğ
MP_OKAY
è{ 
_ERR
; }

47 ià((
”r
 = 
	`mp_sub
(&
u2
, &
tmp
, &
t2
)è!ğ
MP_OKAY
è{ 
_ERR
; }

48 ià((
”r
 = 
	`mp_mul
(&
v3
, &
q
, &
tmp
)è!ğ
MP_OKAY
è{ 
_ERR
; }

49 ià((
”r
 = 
	`mp_sub
(&
u3
, &
tmp
, &
t3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

52 ià((
”r
 = 
	`mp_cİy
(&
v1
, &
u1
)è!ğ
MP_OKAY
è{ 
_ERR
; }

53 ià((
”r
 = 
	`mp_cİy
(&
v2
, &
u2
)è!ğ
MP_OKAY
è{ 
_ERR
; }

54 ià((
”r
 = 
	`mp_cİy
(&
v3
, &
u3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

57 ià((
”r
 = 
	`mp_cİy
(&
t1
, &
v1
)è!ğ
MP_OKAY
è{ 
_ERR
; }

58 ià((
”r
 = 
	`mp_cİy
(&
t2
, &
v2
)è!ğ
MP_OKAY
è{ 
_ERR
; }

59 ià((
”r
 = 
	`mp_cİy
(&
t3
, &
v3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

63 ià(
u3
.
sign
 =ğ
MP_NEG
) {

64 
	`mp_Ãg
(&
u1
, &u1);

65 
	`mp_Ãg
(&
u2
, &u2);

66 
	`mp_Ãg
(&
u3
, &u3);

70 ià(
U1
 !ğ
NULL
è{ 
	`mp_exch
(U1, &
u1
); }

71 ià(
U2
 !ğ
NULL
è{ 
	`mp_exch
(U2, &
u2
); }

72 ià(
U3
 !ğ
NULL
è{ 
	`mp_exch
(U3, &
u3
); }

74 
”r
 = 
MP_OKAY
;

75 
_ERR
: 
	`mp_ş—r_muÉi
(&
u1
, &
u2
, &
u3
, &
v1
, &
v2
, &
v3
, &
t1
, &
t2
, &
t3
, &
q
, &
tmp
, 
NULL
);

76  
”r
;

77 
	}
}

	@libtommath/bn_mp_fread.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_FREAD_C


19 
	$mp_ä—d
(
mp_št
 *
a
, 
¿dix
, 
FILE
 *
¡»am
)

21 
”r
, 
ch
, 
Ãg
, 
y
;

24 
	`mp_z”o
(
a
);

27 
ch
 = 
	`fg‘c
(
¡»am
);

28 ià(
ch
 == '-') {

29 
Ãg
 = 
MP_NEG
;

30 
ch
 = 
	`fg‘c
(
¡»am
);

32 
Ãg
 = 
MP_ZPOS
;

37 
y
 = 0; y < 
¿dix
; y++) {

38 ià(
mp_s_rm­
[
y
] =ğ
ch
) {

42 ià(
y
 =ğ
¿dix
) {

47 ià((
”r
 = 
	`mp_mul_d
(
a
, 
¿dix
,‡)è!ğ
MP_OKAY
) {

48  
”r
;

50 ià((
”r
 = 
	`mp_add_d
(
a
, 
y
,‡)è!ğ
MP_OKAY
) {

51  
”r
;

54 
ch
 = 
	`fg‘c
(
¡»am
);

56 ià(
	`mp_cmp_d
(
a
, 0è!ğ
MP_EQ
) {

57 
a
->
sign
 = 
Ãg
;

60  
MP_OKAY
;

61 
	}
}

	@libtommath/bn_mp_fwrite.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_FWRITE_C


18 
	$mp_fwr™e
(
mp_št
 *
a
, 
¿dix
, 
FILE
 *
¡»am
)

20 *
buf
;

21 
”r
, 
Ën
, 
x
;

23 ià((
”r
 = 
	`mp_¿dix_size
(
a
, 
¿dix
, &
Ën
)è!ğ
MP_OKAY
) {

24  
”r
;

27 
buf
 = 
	`OPT_CAST
(è
	`XMALLOC
 (
Ën
);

28 ià(
buf
 =ğ
NULL
) {

29  
MP_MEM
;

32 ià((
”r
 = 
	`mp_tÜadix
(
a
, 
buf
, 
¿dix
)è!ğ
MP_OKAY
) {

33 
	`XFREE
 (
buf
);

34  
”r
;

37 
x
 = 0; x < 
Ën
; x++) {

38 ià(
	`åutc
(
buf
[
x
], 
¡»am
è=ğ
EOF
) {

39 
	`XFREE
 (
buf
);

40  
MP_VAL
;

44 
	`XFREE
 (
buf
);

45  
MP_OKAY
;

46 
	}
}

	@libtommath/bn_mp_gcd.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_GCD_C


19 
	$mp_gcd
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

21 
mp_št
 
u
, 
v
;

22 
k
, 
u_lsb
, 
v_lsb
, 
»s
;

25 ià(
	`mp_isz”o
 (
a
è=ğ
MP_YES
) {

26  
	`mp_abs
 (
b
, 
c
);

28 ià(
	`mp_isz”o
 (
b
è=ğ
MP_YES
) {

29  
	`mp_abs
 (
a
, 
c
);

33 ià((
»s
 = 
	`mp_š™_cİy
 (&
u
, 
a
)è!ğ
MP_OKAY
) {

34  
»s
;

37 ià((
»s
 = 
	`mp_š™_cİy
 (&
v
, 
b
)è!ğ
MP_OKAY
) {

38 
LBL_U
;

42 
u
.
sign
 = 
v
.sigÀğ
MP_ZPOS
;

45 
u_lsb
 = 
	`mp_út_lsb
(&
u
);

46 
v_lsb
 = 
	`mp_út_lsb
(&
v
);

47 
k
 = 
	`MIN
(
u_lsb
, 
v_lsb
);

49 ià(
k
 > 0) {

51 ià((
»s
 = 
	`mp_div_2d
(&
u
, 
k
, &u, 
NULL
)è!ğ
MP_OKAY
) {

52 
LBL_V
;

55 ià((
»s
 = 
	`mp_div_2d
(&
v
, 
k
, &v, 
NULL
)è!ğ
MP_OKAY
) {

56 
LBL_V
;

61 ià(
u_lsb
 !ğ
k
) {

62 ià((
»s
 = 
	`mp_div_2d
(&
u
, 
u_lsb
 - 
k
, &u, 
NULL
)è!ğ
MP_OKAY
) {

63 
LBL_V
;

67 ià(
v_lsb
 !ğ
k
) {

68 ià((
»s
 = 
	`mp_div_2d
(&
v
, 
v_lsb
 - 
k
, &v, 
NULL
)è!ğ
MP_OKAY
) {

69 
LBL_V
;

73 
	`mp_isz”o
(&
v
) == 0) {

75 ià(
	`mp_cmp_mag
(&
u
, &
v
è=ğ
MP_GT
) {

77 
	`mp_exch
(&
u
, &
v
);

81 ià((
»s
 = 
	`s_mp_sub
(&
v
, &
u
, &v)è!ğ
MP_OKAY
) {

82 
LBL_V
;

86 ià((
»s
 = 
	`mp_div_2d
(&
v
, 
	`mp_út_lsb
(&v), &v, 
NULL
)è!ğ
MP_OKAY
) {

87 
LBL_V
;

92 ià((
»s
 = 
	`mp_mul_2d
 (&
u
, 
k
, 
c
)è!ğ
MP_OKAY
) {

93 
LBL_V
;

95 
c
->
sign
 = 
MP_ZPOS
;

96 
»s
 = 
MP_OKAY
;

97 
LBL_V
:
	`mp_ş—r
 (&
u
);

98 
LBL_U
:
	`mp_ş—r
 (&
v
);

99  
»s
;

100 
	}
}

	@libtommath/bn_mp_get_int.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_GET_INT_C


19 
	$mp_g‘_št
(
mp_št
 * 
a
)

21 
i
;

22 
»s
;

24 ià(
a
->
u£d
 == 0) {

29 
i
 = 
	`MIN
(
a
->
u£d
,()((()*
CHAR_BIT
+
DIGIT_BIT
-1)/DIGIT_BIT))-1;

32 
»s
 = 
	`DIGIT
(
a
,
i
);

34 --
i
 >= 0) {

35 
»s
 = (» << 
DIGIT_BIT
è| 
	`DIGIT
(
a
,
i
);

39  
»s
 & 0xFFFFFFFFUL;

40 
	}
}

	@libtommath/bn_mp_grow.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_GROW_C


19 
	$mp_grow
 (
mp_št
 * 
a
, 
size
)

21 
i
;

22 
mp_dig™
 *
tmp
;

25 ià(
a
->
®loc
 < 
size
) {

27 
size
 +ğ(
MP_PREC
 * 2) - (size % MP_PREC);

35 
tmp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XREALLOC
 (
a
->
dp
,  (mp_dig™è* 
size
);

36 ià(
tmp
 =ğ
NULL
) {

38  
MP_MEM
;

42 
a
->
dp
 = 
tmp
;

45 
i
 = 
a
->
®loc
;

46 
a
->
®loc
 = 
size
;

47 ; 
i
 < 
a
->
®loc
; i++) {

48 
a
->
dp
[
i
] = 0;

51  
MP_OKAY
;

52 
	}
}

	@libtommath/bn_mp_init.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INIT_C


19 
	$mp_š™
 (
mp_št
 * 
a
)

21 
i
;

24 
a
->
dp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XMALLOC
 ( (mp_dig™è* 
MP_PREC
);

25 ià(
a
->
dp
 =ğ
NULL
) {

26  
MP_MEM
;

30 
i
 = 0; i < 
MP_PREC
; i++) {

31 
a
->
dp
[
i
] = 0;

36 
a
->
u£d
 = 0;

37 
a
->
®loc
 = 
MP_PREC
;

38 
a
->
sign
 = 
MP_ZPOS
;

40  
MP_OKAY
;

41 
	}
}

	@libtommath/bn_mp_init_copy.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INIT_COPY_C


19 
	$mp_š™_cİy
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

21 
»s
;

23 ià((
»s
 = 
	`mp_š™
 (
a
)è!ğ
MP_OKAY
) {

24  
»s
;

26  
	`mp_cİy
 (
b
, 
a
);

27 
	}
}

	@libtommath/bn_mp_init_multi.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INIT_MULTI_C


17 
	~<¡d¬g.h
>

19 
	$mp_š™_muÉi
(
mp_št
 *
mp
, ...)

21 
mp_”r
 
»s
 = 
MP_OKAY
;

22 
n
 = 0;

23 
mp_št
* 
cur_¬g
 = 
mp
;

24 
va_li¡
 
¬gs
;

26 
	`va_¡¬t
(
¬gs
, 
mp
);

27 
cur_¬g
 !ğ
NULL
) {

28 ià(
	`mp_š™
(
cur_¬g
è!ğ
MP_OKAY
) {

32 
va_li¡
 
ş—n_¬gs
;

35 
	`va_’d
(
¬gs
);

38 
cur_¬g
 = 
mp
;

39 
	`va_¡¬t
(
ş—n_¬gs
, 
mp
);

40 
n
--) {

41 
	`mp_ş—r
(
cur_¬g
);

42 
cur_¬g
 = 
	`va_¬g
(
ş—n_¬gs
, 
mp_št
*);

44 
	`va_’d
(
ş—n_¬gs
);

45 
»s
 = 
MP_MEM
;

48 
n
++;

49 
cur_¬g
 = 
	`va_¬g
(
¬gs
, 
mp_št
*);

51 
	`va_’d
(
¬gs
);

52  
»s
;

53 
	}
}

	@libtommath/bn_mp_init_set.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INIT_SET_C


19 
	$mp_š™_£t
 (
mp_št
 * 
a
, 
mp_dig™
 
b
)

21 
”r
;

22 ià((
”r
 = 
	`mp_š™
(
a
)è!ğ
MP_OKAY
) {

23  
”r
;

25 
	`mp_£t
(
a
, 
b
);

26  
”r
;

27 
	}
}

	@libtommath/bn_mp_init_set_int.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INIT_SET_INT_C


19 
	$mp_š™_£t_št
 (
mp_št
 * 
a
, 
b
)

21 
”r
;

22 ià((
”r
 = 
	`mp_š™
(
a
)è!ğ
MP_OKAY
) {

23  
”r
;

25  
	`mp_£t_št
(
a
, 
b
);

26 
	}
}

	@libtommath/bn_mp_init_size.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INIT_SIZE_C


19 
	$mp_š™_size
 (
mp_št
 * 
a
, 
size
)

21 
x
;

24 
size
 +ğ(
MP_PREC
 * 2) - (size % MP_PREC);

27 
a
->
dp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XMALLOC
 ( (mp_dig™è* 
size
);

28 ià(
a
->
dp
 =ğ
NULL
) {

29  
MP_MEM
;

33 
a
->
u£d
 = 0;

34 
a
->
®loc
 = 
size
;

35 
a
->
sign
 = 
MP_ZPOS
;

38 
x
 = 0; x < 
size
; x++) {

39 
a
->
dp
[
x
] = 0;

42  
MP_OKAY
;

43 
	}
}

	@libtommath/bn_mp_invmod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INVMOD_C


19 
	$mp_švmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 ià(
b
->
sign
 =ğ
MP_NEG
 || 
	`mp_isz”o
(b) == 1) {

23  
MP_VAL
;

26 #ifdeà
BN_FAST_MP_INVMOD_C


28 ià(
	`mp_isodd
 (
b
) == 1) {

29  
	`ç¡_mp_švmod
 (
a
, 
b
, 
c
);

33 #ifdeà
BN_MP_INVMOD_SLOW_C


34  
	`mp_švmod_¦ow
(
a
, 
b
, 
c
);

37  
MP_VAL
;

38 
	}
}

	@libtommath/bn_mp_invmod_slow.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_INVMOD_SLOW_C


19 
	$mp_švmod_¦ow
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

21 
mp_št
 
x
, 
y
, 
u
, 
v
, 
A
, 
B
, 
C
, 
D
;

22 
»s
;

25 ià(
b
->
sign
 =ğ
MP_NEG
 || 
	`mp_isz”o
(b) == 1) {

26  
MP_VAL
;

30 ià((
»s
 = 
	`mp_š™_muÉi
(&
x
, &
y
, &
u
, &
v
,

31 &
A
, &
B
, &
C
, &
D
, 
NULL
)è!ğ
MP_OKAY
) {

32  
»s
;

36 ià((
»s
 = 
	`mp_mod
(
a
, 
b
, &
x
)è!ğ
MP_OKAY
) {

37 
LBL_ERR
;

39 ià((
»s
 = 
	`mp_cİy
 (
b
, &
y
)è!ğ
MP_OKAY
) {

40 
LBL_ERR
;

44 ià(
	`mp_i£v’
 (&
x
è=ğ1 && mp_i£v’ (&
y
) == 1) {

45 
»s
 = 
MP_VAL
;

46 
LBL_ERR
;

50 ià((
»s
 = 
	`mp_cİy
 (&
x
, &
u
)è!ğ
MP_OKAY
) {

51 
LBL_ERR
;

53 ià((
»s
 = 
	`mp_cİy
 (&
y
, &
v
)è!ğ
MP_OKAY
) {

54 
LBL_ERR
;

56 
	`mp_£t
 (&
A
, 1);

57 
	`mp_£t
 (&
D
, 1);

59 
tİ
:

61 
	`mp_i£v’
 (&
u
) == 1) {

63 ià((
»s
 = 
	`mp_div_2
 (&
u
, &u)è!ğ
MP_OKAY
) {

64 
LBL_ERR
;

67 ià(
	`mp_isodd
 (&
A
è=ğ1 || mp_isodd (&
B
) == 1) {

69 ià((
»s
 = 
	`mp_add
 (&
A
, &
y
, &A)è!ğ
MP_OKAY
) {

70 
LBL_ERR
;

72 ià((
»s
 = 
	`mp_sub
 (&
B
, &
x
, &B)è!ğ
MP_OKAY
) {

73 
LBL_ERR
;

77 ià((
»s
 = 
	`mp_div_2
 (&
A
, &A)è!ğ
MP_OKAY
) {

78 
LBL_ERR
;

80 ià((
»s
 = 
	`mp_div_2
 (&
B
, &B)è!ğ
MP_OKAY
) {

81 
LBL_ERR
;

86 
	`mp_i£v’
 (&
v
) == 1) {

88 ià((
»s
 = 
	`mp_div_2
 (&
v
, &v)è!ğ
MP_OKAY
) {

89 
LBL_ERR
;

92 ià(
	`mp_isodd
 (&
C
è=ğ1 || mp_isodd (&
D
) == 1) {

94 ià((
»s
 = 
	`mp_add
 (&
C
, &
y
, &C)è!ğ
MP_OKAY
) {

95 
LBL_ERR
;

97 ià((
»s
 = 
	`mp_sub
 (&
D
, &
x
, &D)è!ğ
MP_OKAY
) {

98 
LBL_ERR
;

102 ià((
»s
 = 
	`mp_div_2
 (&
C
, &C)è!ğ
MP_OKAY
) {

103 
LBL_ERR
;

105 ià((
»s
 = 
	`mp_div_2
 (&
D
, &D)è!ğ
MP_OKAY
) {

106 
LBL_ERR
;

111 ià(
	`mp_cmp
 (&
u
, &
v
è!ğ
MP_LT
) {

113 ià((
»s
 = 
	`mp_sub
 (&
u
, &
v
, &u)è!ğ
MP_OKAY
) {

114 
LBL_ERR
;

117 ià((
»s
 = 
	`mp_sub
 (&
A
, &
C
, &A)è!ğ
MP_OKAY
) {

118 
LBL_ERR
;

121 ià((
»s
 = 
	`mp_sub
 (&
B
, &
D
, &B)è!ğ
MP_OKAY
) {

122 
LBL_ERR
;

126 ià((
»s
 = 
	`mp_sub
 (&
v
, &
u
, &v)è!ğ
MP_OKAY
) {

127 
LBL_ERR
;

130 ià((
»s
 = 
	`mp_sub
 (&
C
, &
A
, &C)è!ğ
MP_OKAY
) {

131 
LBL_ERR
;

134 ià((
»s
 = 
	`mp_sub
 (&
D
, &
B
, &D)è!ğ
MP_OKAY
) {

135 
LBL_ERR
;

140 ià(
	`mp_isz”o
 (&
u
) == 0)

141 
tİ
;

146 ià(
	`mp_cmp_d
 (&
v
, 1è!ğ
MP_EQ
) {

147 
»s
 = 
MP_VAL
;

148 
LBL_ERR
;

152 
	`mp_cmp_d
(&
C
, 0è=ğ
MP_LT
) {

153 ià((
»s
 = 
	`mp_add
(&
C
, 
b
, &C)è!ğ
MP_OKAY
) {

154 
LBL_ERR
;

159 
	`mp_cmp_mag
(&
C
, 
b
è!ğ
MP_LT
) {

160 ià((
»s
 = 
	`mp_sub
(&
C
, 
b
, &C)è!ğ
MP_OKAY
) {

161 
LBL_ERR
;

166 
	`mp_exch
 (&
C
, 
c
);

167 
»s
 = 
MP_OKAY
;

168 
LBL_ERR
:
	`mp_ş—r_muÉi
 (&
x
, &
y
, &
u
, &
v
, &
A
, &
B
, &
C
, &
D
, 
NULL
);

169  
»s
;

170 
	}
}

	@libtommath/bn_mp_is_square.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_IS_SQUARE_C


19 cÚ¡ 
	g»m_128
[128] = {

30 cÚ¡ 
	g»m_105
[105] = {

41 
	$mp_is_squ¬e
(
mp_št
 *
¬g
,*
»t
)

43 
»s
;

44 
mp_dig™
 
c
;

45 
mp_št
 
t
;

46 
r
;

49 *
»t
 = 
MP_NO
;

51 ià(
¬g
->
sign
 =ğ
MP_NEG
) {

52  
MP_VAL
;

56 ià(
¬g
->
u£d
 == 0) {

57  
MP_OKAY
;

61 ià(
»m_128
[127 & 
	`DIGIT
(
¬g
,0)] == 1) {

62  
MP_OKAY
;

66 ià((
»s
 = 
	`mp_mod_d
(
¬g
,105,&
c
)è!ğ
MP_OKAY
) {

67  
»s
;

69 ià(
»m_105
[
c
] == 1) {

70  
MP_OKAY
;

74 ià((
»s
 = 
	`mp_š™_£t_št
(&
t
,11L*13L*17L*19L*23L*29L*31L)è!ğ
MP_OKAY
) {

75  
»s
;

77 ià((
»s
 = 
	`mp_mod
(
¬g
,&
t
,&t)è!ğ
MP_OKAY
) {

78 
ERR
;

80 
r
 = 
	`mp_g‘_št
(&
t
);

85 iàĞ(1L<<(
r
%11)è& 0x5C4L ) 
ERR
;

86 iàĞ(1L<<(
r
%13)è& 0x9E4L ) 
ERR
;

87 iàĞ(1L<<(
r
%17)è& 0x5CE8L ) 
ERR
;

88 iàĞ(1L<<(
r
%19)è& 0x4F50CL ) 
ERR
;

89 iàĞ(1L<<(
r
%23)è& 0x7ACCA0L ) 
ERR
;

90 iàĞ(1L<<(
r
%29)è& 0xC2EDD0CL ) 
ERR
;

91 iàĞ(1L<<(
r
%31)è& 0x6DE2B848L ) 
ERR
;

94 ià((
»s
 = 
	`mp_sq¹
(
¬g
,&
t
)è!ğ
MP_OKAY
) {

95 
ERR
;

97 ià((
»s
 = 
	`mp_sqr
(&
t
,&t)è!ğ
MP_OKAY
) {

98 
ERR
;

101 *
»t
 = (
	`mp_cmp_mag
(&
t
,
¬g
è=ğ
MP_EQ
è? 
MP_YES
 : 
MP_NO
;

102 
ERR
:
	`mp_ş—r
(&
t
);

103  
»s
;

104 
	}
}

	@libtommath/bn_mp_jacobi.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_JACOBI_C


21 
	$mp_jacobi
 (
mp_št
 * 
a
, mp_šˆ* 
p
, *
c
)

23 
mp_št
 
a1
, 
p1
;

24 
k
, 
s
, 
r
, 
»s
;

25 
mp_dig™
 
»sidue
;

28 ià(
	`mp_cmp_d
(
p
, 0è!ğ
MP_GT
) {

29  
MP_VAL
;

33 ià(
	`mp_isz”o
 (
a
) == 1) {

34 *
c
 = 0;

35  
MP_OKAY
;

39 ià(
	`mp_cmp_d
 (
a
, 1è=ğ
MP_EQ
) {

40 *
c
 = 1;

41  
MP_OKAY
;

45 
s
 = 0;

48 ià((
»s
 = 
	`mp_š™_cİy
 (&
a1
, 
a
)è!ğ
MP_OKAY
) {

49  
»s
;

52 ià((
»s
 = 
	`mp_š™
 (&
p1
)è!ğ
MP_OKAY
) {

53 
LBL_A1
;

57 
k
 = 
	`mp_út_lsb
(&
a1
);

58 ià((
»s
 = 
	`mp_div_2d
(&
a1
, 
k
, &a1, 
NULL
)è!ğ
MP_OKAY
) {

59 
LBL_P1
;

63 ià((
k
 & 1) == 0) {

64 
s
 = 1;

67 
»sidue
 = 
p
->
dp
[0] & 7;

69 ià(
»sidue
 == 1 ||„esidue == 7) {

70 
s
 = 1;

71 } ià(
»sidue
 == 3 ||„esidue == 5) {

72 
s
 = -1;

77 iàĞ((
p
->
dp
[0] & 3è=ğ3è&& ((
a1
.dp[0] & 3) == 3)) {

78 
s
 = -s;

82 ià(
	`mp_cmp_d
 (&
a1
, 1è=ğ
MP_EQ
) {

83 *
c
 = 
s
;

86 ià((
»s
 = 
	`mp_mod
 (
p
, &
a1
, &
p1
)è!ğ
MP_OKAY
) {

87 
LBL_P1
;

89 ià((
»s
 = 
	`mp_jacobi
 (&
p1
, &
a1
, &
r
)è!ğ
MP_OKAY
) {

90 
LBL_P1
;

92 *
c
 = 
s
 * 
r
;

96 
»s
 = 
MP_OKAY
;

97 
LBL_P1
:
	`mp_ş—r
 (&
p1
);

98 
LBL_A1
:
	`mp_ş—r
 (&
a1
);

99  
»s
;

100 
	}
}

	@libtommath/bn_mp_karatsuba_mul.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_KARATSUBA_MUL_C


47 
	$mp_k¬©suba_mul
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

49 
mp_št
 
x0
, 
x1
, 
y0
, 
y1
, 
t1
, 
x0y0
, 
x1y1
;

50 
B
, 
”r
;

53 
”r
 = 
MP_MEM
;

56 
B
 = 
	`MIN
 (
a
->
u£d
, 
b
->used);

59 
B
 = B >> 1;

62 ià(
	`mp_š™_size
 (&
x0
, 
B
è!ğ
MP_OKAY
)

63 
ERR
;

64 ià(
	`mp_š™_size
 (&
x1
, 
a
->
u£d
 - 
B
è!ğ
MP_OKAY
)

65 
X0
;

66 ià(
	`mp_š™_size
 (&
y0
, 
B
è!ğ
MP_OKAY
)

67 
X1
;

68 ià(
	`mp_š™_size
 (&
y1
, 
b
->
u£d
 - 
B
è!ğ
MP_OKAY
)

69 
Y0
;

72 ià(
	`mp_š™_size
 (&
t1
, 
B
 * 2è!ğ
MP_OKAY
)

73 
Y1
;

74 ià(
	`mp_š™_size
 (&
x0y0
, 
B
 * 2è!ğ
MP_OKAY
)

75 
T1
;

76 ià(
	`mp_š™_size
 (&
x1y1
, 
B
 * 2è!ğ
MP_OKAY
)

77 
X0Y0
;

80 
x0
.
u£d
 = 
y0
.u£d = 
B
;

81 
x1
.
u£d
 = 
a
->u£d - 
B
;

82 
y1
.
u£d
 = 
b
->u£d - 
B
;

85 
x
;

86 
mp_dig™
 *
tm·
, *
tmpb
, *
tmpx
, *
tmpy
;

91 
tm·
 = 
a
->
dp
;

92 
tmpb
 = 
b
->
dp
;

94 
tmpx
 = 
x0
.
dp
;

95 
tmpy
 = 
y0
.
dp
;

96 
x
 = 0; x < 
B
; x++) {

97 *
tmpx
++ = *
tm·
++;

98 *
tmpy
++ = *
tmpb
++;

101 
tmpx
 = 
x1
.
dp
;

102 
x
 = 
B
; x < 
a
->
u£d
; x++) {

103 *
tmpx
++ = *
tm·
++;

106 
tmpy
 = 
y1
.
dp
;

107 
x
 = 
B
; x < 
b
->
u£d
; x++) {

108 *
tmpy
++ = *
tmpb
++;

115 
	`mp_şamp
 (&
x0
);

116 
	`mp_şamp
 (&
y0
);

120 ià(
	`mp_mul
 (&
x0
, &
y0
, &
x0y0
è!ğ
MP_OKAY
)

121 
X1Y1
;

122 ià(
	`mp_mul
 (&
x1
, &
y1
, &
x1y1
è!ğ
MP_OKAY
)

123 
X1Y1
;

126 ià(
	`s_mp_add
 (&
x1
, &
x0
, &
t1
è!ğ
MP_OKAY
)

127 
X1Y1
;

128 ià(
	`s_mp_add
 (&
y1
, &
y0
, &
x0
è!ğ
MP_OKAY
)

129 
X1Y1
;

130 ià(
	`mp_mul
 (&
t1
, &
x0
, &t1è!ğ
MP_OKAY
)

131 
X1Y1
;

134 ià(
	`mp_add
 (&
x0y0
, &
x1y1
, &
x0
è!ğ
MP_OKAY
)

135 
X1Y1
;

136 ià(
	`s_mp_sub
 (&
t1
, &
x0
, &t1è!ğ
MP_OKAY
)

137 
X1Y1
;

140 ià(
	`mp_lshd
 (&
t1
, 
B
è!ğ
MP_OKAY
)

141 
X1Y1
;

142 ià(
	`mp_lshd
 (&
x1y1
, 
B
 * 2è!ğ
MP_OKAY
)

143 
X1Y1
;

145 ià(
	`mp_add
 (&
x0y0
, &
t1
, &t1è!ğ
MP_OKAY
)

146 
X1Y1
;

147 ià(
	`mp_add
 (&
t1
, &
x1y1
, 
c
è!ğ
MP_OKAY
)

148 
X1Y1
;

151 
”r
 = 
MP_OKAY
;

153 
X1Y1
:
	`mp_ş—r
 (&
x1y1
);

154 
X0Y0
:
	`mp_ş—r
 (&
x0y0
);

155 
T1
:
	`mp_ş—r
 (&
t1
);

156 
Y1
:
	`mp_ş—r
 (&
y1
);

157 
Y0
:
	`mp_ş—r
 (&
y0
);

158 
X1
:
	`mp_ş—r
 (&
x1
);

159 
X0
:
	`mp_ş—r
 (&
x0
);

160 
ERR
:

161  
”r
;

162 
	}
}

	@libtommath/bn_mp_karatsuba_sqr.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_KARATSUBA_SQR_C


25 
	$mp_k¬©suba_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

27 
mp_št
 
x0
, 
x1
, 
t1
, 
t2
, 
x0x0
, 
x1x1
;

28 
B
, 
”r
;

30 
”r
 = 
MP_MEM
;

33 
B
 = 
a
->
u£d
;

36 
B
 = B >> 1;

39 ià(
	`mp_š™_size
 (&
x0
, 
B
è!ğ
MP_OKAY
)

40 
ERR
;

41 ià(
	`mp_š™_size
 (&
x1
, 
a
->
u£d
 - 
B
è!ğ
MP_OKAY
)

42 
X0
;

45 ià(
	`mp_š™_size
 (&
t1
, 
a
->
u£d
 * 2è!ğ
MP_OKAY
)

46 
X1
;

47 ià(
	`mp_š™_size
 (&
t2
, 
a
->
u£d
 * 2è!ğ
MP_OKAY
)

48 
T1
;

49 ià(
	`mp_š™_size
 (&
x0x0
, 
B
 * 2è!ğ
MP_OKAY
)

50 
T2
;

51 ià(
	`mp_š™_size
 (&
x1x1
, (
a
->
u£d
 - 
B
è* 2è!ğ
MP_OKAY
)

52 
X0X0
;

55 
x
;

56 
mp_dig™
 *
d¡
, *
¤c
;

58 
¤c
 = 
a
->
dp
;

61 
d¡
 = 
x0
.
dp
;

62 
x
 = 0; x < 
B
; x++) {

63 *
d¡
++ = *
¤c
++;

66 
d¡
 = 
x1
.
dp
;

67 
x
 = 
B
; x < 
a
->
u£d
; x++) {

68 *
d¡
++ = *
¤c
++;

72 
x0
.
u£d
 = 
B
;

73 
x1
.
u£d
 = 
a
->u£d - 
B
;

75 
	`mp_şamp
 (&
x0
);

78 ià(
	`mp_sqr
 (&
x0
, &
x0x0
è!ğ
MP_OKAY
)

79 
X1X1
;

80 ià(
	`mp_sqr
 (&
x1
, &
x1x1
è!ğ
MP_OKAY
)

81 
X1X1
;

84 ià(
	`s_mp_add
 (&
x1
, &
x0
, &
t1
è!ğ
MP_OKAY
)

85 
X1X1
;

86 ià(
	`mp_sqr
 (&
t1
, &t1è!ğ
MP_OKAY
)

87 
X1X1
;

90 ià(
	`s_mp_add
 (&
x0x0
, &
x1x1
, &
t2
è!ğ
MP_OKAY
)

91 
X1X1
;

92 ià(
	`s_mp_sub
 (&
t1
, &
t2
, &t1è!ğ
MP_OKAY
)

93 
X1X1
;

96 ià(
	`mp_lshd
 (&
t1
, 
B
è!ğ
MP_OKAY
)

97 
X1X1
;

98 ià(
	`mp_lshd
 (&
x1x1
, 
B
 * 2è!ğ
MP_OKAY
)

99 
X1X1
;

101 ià(
	`mp_add
 (&
x0x0
, &
t1
, &t1è!ğ
MP_OKAY
)

102 
X1X1
;

103 ià(
	`mp_add
 (&
t1
, &
x1x1
, 
b
è!ğ
MP_OKAY
)

104 
X1X1
;

106 
”r
 = 
MP_OKAY
;

108 
X1X1
:
	`mp_ş—r
 (&
x1x1
);

109 
X0X0
:
	`mp_ş—r
 (&
x0x0
);

110 
T2
:
	`mp_ş—r
 (&
t2
);

111 
T1
:
	`mp_ş—r
 (&
t1
);

112 
X1
:
	`mp_ş—r
 (&
x1
);

113 
X0
:
	`mp_ş—r
 (&
x0
);

114 
ERR
:

115  
”r
;

116 
	}
}

	@libtommath/bn_mp_lcm.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_LCM_C


19 
	$mp_lcm
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

21 
»s
;

22 
mp_št
 
t1
, 
t2
;

25 ià((
»s
 = 
	`mp_š™_muÉi
 (&
t1
, &
t2
, 
NULL
)è!ğ
MP_OKAY
) {

26  
»s
;

30 ià((
»s
 = 
	`mp_gcd
 (
a
, 
b
, &
t1
)è!ğ
MP_OKAY
) {

31 
LBL_T
;

35 ià(
	`mp_cmp_mag
(
a
, 
b
è=ğ
MP_LT
) {

37 ià((
»s
 = 
	`mp_div
(
a
, &
t1
, &
t2
, 
NULL
)è!ğ
MP_OKAY
) {

38 
LBL_T
;

40 
»s
 = 
	`mp_mul
(
b
, &
t2
, 
c
);

43 ià((
»s
 = 
	`mp_div
(
b
, &
t1
, &
t2
, 
NULL
)è!ğ
MP_OKAY
) {

44 
LBL_T
;

46 
»s
 = 
	`mp_mul
(
a
, &
t2
, 
c
);

50 
c
->
sign
 = 
MP_ZPOS
;

52 
LBL_T
:

53 
	`mp_ş—r_muÉi
 (&
t1
, &
t2
, 
NULL
);

54  
»s
;

55 
	}
}

	@libtommath/bn_mp_lshd.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_LSHD_C


19 
	$mp_lshd
 (
mp_št
 * 
a
, 
b
)

21 
x
, 
»s
;

24 ià(
b
 <= 0) {

25  
MP_OKAY
;

29 ià(
a
->
®loc
 <‡->
u£d
 + 
b
) {

30 ià((
»s
 = 
	`mp_grow
 (
a
,‡->
u£d
 + 
b
)è!ğ
MP_OKAY
) {

31  
»s
;

36 
mp_dig™
 *
tİ
, *
bÙtom
;

39 
a
->
u£d
 +ğ
b
;

42 
tİ
 = 
a
->
dp
 +‡->
u£d
 - 1;

45 
bÙtom
 = 
a
->
dp
 +‡->
u£d
 - 1 - 
b
;

51 
x
 = 
a
->
u£d
 - 1; x >ğ
b
; x--) {

52 *
tİ
-- = *
bÙtom
--;

56 
tİ
 = 
a
->
dp
;

57 
x
 = 0; x < 
b
; x++) {

58 *
tİ
++ = 0;

61  
MP_OKAY
;

62 
	}
}

	@libtommath/bn_mp_mod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MOD_C


20 
	$mp_mod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 
mp_št
 
t
;

23 
»s
;

25 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

26  
»s
;

29 ià((
»s
 = 
	`mp_div
 (
a
, 
b
, 
NULL
, &
t
)è!ğ
MP_OKAY
) {

30 
	`mp_ş—r
 (&
t
);

31  
»s
;

34 ià(
t
.
sign
 !ğ
b
->sign) {

35 
»s
 = 
	`mp_add
 (
b
, &
t
, 
c
);

37 
»s
 = 
MP_OKAY
;

38 
	`mp_exch
 (&
t
, 
c
);

41 
	`mp_ş—r
 (&
t
);

42  
»s
;

43 
	}
}

	@libtommath/bn_mp_mod_2d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MOD_2D_C


20 
	$mp_mod_2d
 (
mp_št
 * 
a
, 
b
, mp_šˆ* 
c
)

22 
x
, 
»s
;

25 ià(
b
 <= 0) {

26 
	`mp_z”o
 (
c
);

27  
MP_OKAY
;

31 ià(
b
 >ğ(è(
a
->
u£d
 * 
DIGIT_BIT
)) {

32 
»s
 = 
	`mp_cİy
 (
a
, 
c
);

33  
»s
;

37 ià((
»s
 = 
	`mp_cİy
 (
a
, 
c
)è!ğ
MP_OKAY
) {

38  
»s
;

42 
x
 = (
b
 / 
DIGIT_BIT
è+ ((b % DIGIT_BITè=ğ0 ? 0 : 1); x < 
c
->
u£d
; x++) {

43 
c
->
dp
[
x
] = 0;

46 
c
->
dp
[
b
 / 
DIGIT_BIT
] &=

47 (
mp_dig™
è((((mp_dig™è1è<< (((mp_dig™è
b
è% 
DIGIT_BIT
)) - ((mp_digit) 1));

48 
	`mp_şamp
 (
c
);

49  
MP_OKAY
;

50 
	}
}

	@libtommath/bn_mp_mod_d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MOD_D_C


19 
	$mp_mod_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_dig™ * 
c
)

21  
	`mp_div_d
(
a
, 
b
, 
NULL
, 
c
);

22 
	}
}

	@libtommath/bn_mp_montgomery_calc_normalization.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MONTGOMERY_CALC_NORMALIZATION_C


24 
	$mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

26 
x
, 
b™s
, 
»s
;

29 
b™s
 = 
	`mp_couÁ_b™s
 (
b
è% 
DIGIT_BIT
;

31 ià(
b
->
u£d
 > 1) {

32 ià((
»s
 = 
	`mp_2ex±
 (
a
, (
b
->
u£d
 - 1è* 
DIGIT_BIT
 + 
b™s
 - 1)è!ğ
MP_OKAY
) {

33  
»s
;

36 
	`mp_£t
(
a
, 1);

37 
b™s
 = 1;

42 
x
 = 
b™s
 - 1; x < ()
DIGIT_BIT
; x++) {

43 ià((
»s
 = 
	`mp_mul_2
 (
a
,‡)è!ğ
MP_OKAY
) {

44  
»s
;

46 ià(
	`mp_cmp_mag
 (
a
, 
b
è!ğ
MP_LT
) {

47 ià((
»s
 = 
	`s_mp_sub
 (
a
, 
b
,‡)è!ğ
MP_OKAY
) {

48  
»s
;

53  
MP_OKAY
;

54 
	}
}

	@libtommath/bn_mp_montgomery_reduce.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MONTGOMERY_REDUCE_C


20 
	$mp_mÚtgom”y_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
n
, 
mp_dig™
 
rho
)

22 
ix
, 
»s
, 
digs
;

23 
mp_dig™
 
mu
;

31 
digs
 = 
n
->
u£d
 * 2 + 1;

32 ià((
digs
 < 
MP_WARRAY
) &&

33 
n
->
u£d
 <

34 (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

35  
	`ç¡_mp_mÚtgom”y_»duû
 (
x
, 
n
, 
rho
);

39 ià(
x
->
®loc
 < 
digs
) {

40 ià((
»s
 = 
	`mp_grow
 (
x
, 
digs
)è!ğ
MP_OKAY
) {

41  
»s
;

44 
x
->
u£d
 = 
digs
;

46 
ix
 = 0; ix < 
n
->
u£d
; ix++) {

55 
mu
 = (
mp_dig™
è(((
mp_wÜd
)
x
->
dp
[
ix
]è* ((mp_wÜd)
rho
è& 
MP_MASK
);

59 
iy
;

60 
mp_dig™
 *
tm²
, *
tmpx
, 
u
;

61 
mp_wÜd
 
r
;

64 
tm²
 = 
n
->
dp
;

67 
tmpx
 = 
x
->
dp
 + 
ix
;

70 
u
 = 0;

73 
iy
 = 0; iy < 
n
->
u£d
; iy++) {

75 
r
 = ((
mp_wÜd
)
mu
è* ((mp_wÜd)*
tm²
++) +

76 ((
mp_wÜd
è
u
è+ ((mp_wÜdè* 
tmpx
);

79 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

82 *
tmpx
++ = (
mp_dig™
)(
r
 & ((
mp_wÜd
è
MP_MASK
));

88 
u
) {

89 *
tmpx
 +ğ
u
;

90 
u
 = *
tmpx
 >> 
DIGIT_BIT
;

91 *
tmpx
++ &ğ
MP_MASK
;

104 
	`mp_şamp
(
x
);

105 
	`mp_rshd
 (
x
, 
n
->
u£d
);

108 ià(
	`mp_cmp_mag
 (
x
, 
n
è!ğ
MP_LT
) {

109  
	`s_mp_sub
 (
x
, 
n
, x);

112  
MP_OKAY
;

113 
	}
}

	@libtommath/bn_mp_montgomery_setup.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MONTGOMERY_SETUP_C


20 
	$mp_mÚtgom”y_£tup
 (
mp_št
 * 
n
, 
mp_dig™
 * 
rho
)

22 
mp_dig™
 
x
, 
b
;

32 
b
 = 
n
->
dp
[0];

34 ià((
b
 & 1) == 0) {

35  
MP_VAL
;

38 
x
 = (((
b
 + 2) & 4) << 1) + b;

39 
x
 *ğ2 - 
b
 * x;

40 #ià!
	`defšed
(
MP_8BIT
)

41 
x
 *ğ2 - 
b
 * x;

43 #ià
	`defšed
(
MP_64BIT
è|| !(defšed(
MP_8BIT
è|| defšed(
MP_16BIT
))

44 
x
 *ğ2 - 
b
 * x;

46 #ifdeà
MP_64BIT


47 
x
 *ğ2 - 
b
 * x;

51 *
rho
 = ()(((
mp_wÜd
)1 << ((mp_wÜdè
DIGIT_BIT
)è- 
x
è& 
MP_MASK
;

53  
MP_OKAY
;

54 
	}
}

	@libtommath/bn_mp_mul.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MUL_C


19 
	$mp_mul
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

21 
»s
, 
Ãg
;

22 
Ãg
 = (
a
->
sign
 =ğ
b
->signè? 
MP_ZPOS
 : 
MP_NEG
;

25 #ifdeà
BN_MP_TOOM_MUL_C


26 ià(
	`MIN
 (
a
->
u£d
, 
b
->u£dè>ğ
TOOM_MUL_CUTOFF
) {

27 
»s
 = 
	`mp_toom_mul
(
a
, 
b
, 
c
);

30 #ifdeà
BN_MP_KARATSUBA_MUL_C


32 ià(
	`MIN
 (
a
->
u£d
, 
b
->u£dè>ğ
KARATSUBA_MUL_CUTOFF
) {

33 
»s
 = 
	`mp_k¬©suba_mul
 (
a
, 
b
, 
c
);

43 
digs
 = 
a
->
u£d
 + 
b
->used + 1;

45 #ifdeà
BN_FAST_S_MP_MUL_DIGS_C


46 ià((
digs
 < 
MP_WARRAY
) &&

47 
	`MIN
(
a
->
u£d
, 
b
->used) <=

48 (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

49 
»s
 = 
	`ç¡_s_mp_mul_digs
 (
a
, 
b
, 
c
, 
digs
);

52 #ifdeà
BN_S_MP_MUL_DIGS_C


53 
»s
 = 
	`s_mp_mul
 (
a
, 
b
, 
c
);

55 
»s
 = 
MP_VAL
;

59 
c
->
sign
 = (c->
u£d
 > 0è? 
Ãg
 : 
MP_ZPOS
;

60  
»s
;

61 
	}
}

	@libtommath/bn_mp_mul_2.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MUL_2_C


19 
	$mp_mul_2
(
mp_št
 * 
a
, mp_šˆ* 
b
)

21 
x
, 
»s
, 
Şdu£d
;

24 ià(
b
->
®loc
 < 
a
->
u£d
 + 1) {

25 ià((
»s
 = 
	`mp_grow
 (
b
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

26  
»s
;

30 
Şdu£d
 = 
b
->
u£d
;

31 
b
->
u£d
 = 
a
->used;

34 
mp_dig™
 
r
, 
¼
, *
tm·
, *
tmpb
;

37 
tm·
 = 
a
->
dp
;

40 
tmpb
 = 
b
->
dp
;

43 
r
 = 0;

44 
x
 = 0; x < 
a
->
u£d
; x++) {

49 
¼
 = *
tm·
 >> ((
mp_dig™
)(
DIGIT_BIT
 - 1));

52 *
tmpb
++ = ((*
tm·
++ << ((
mp_dig™
)1)è| 
r
è& 
MP_MASK
;

57 
r
 = 
¼
;

61 ià(
r
 != 0) {

63 *
tmpb
 = 1;

64 ++(
b
->
u£d
);

70 
tmpb
 = 
b
->
dp
 + b->
u£d
;

71 
x
 = 
b
->
u£d
; x < 
Şdu£d
; x++) {

72 *
tmpb
++ = 0;

75 
b
->
sign
 = 
a
->sign;

76  
MP_OKAY
;

77 
	}
}

	@libtommath/bn_mp_mul_2d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MUL_2D_C


19 
	$mp_mul_2d
 (
mp_št
 * 
a
, 
b
, mp_šˆ* 
c
)

21 
mp_dig™
 
d
;

22 
»s
;

25 ià(
a
 !ğ
c
) {

26 ià((
»s
 = 
	`mp_cİy
 (
a
, 
c
)è!ğ
MP_OKAY
) {

27  
»s
;

31 ià(
c
->
®loc
 < ()(c->
u£d
 + 
b
/
DIGIT_BIT
 + 1)) {

32 ià((
»s
 = 
	`mp_grow
 (
c
, c->
u£d
 + 
b
 / 
DIGIT_BIT
 + 1)è!ğ
MP_OKAY
) {

33  
»s
;

38 ià(
b
 >ğ()
DIGIT_BIT
) {

39 ià((
»s
 = 
	`mp_lshd
 (
c
, 
b
 / 
DIGIT_BIT
)è!ğ
MP_OKAY
) {

40  
»s
;

45 
d
 = (
mp_dig™
è(
b
 % 
DIGIT_BIT
);

46 ià(
d
 != 0) {

47 
mp_dig™
 *
tmpc
, 
shiá
, 
mask
, 
r
, 
¼
;

48 
x
;

51 
mask
 = (((
mp_dig™
)1è<< 
d
) - 1;

54 
shiá
 = 
DIGIT_BIT
 - 
d
;

57 
tmpc
 = 
c
->
dp
;

60 
r
 = 0;

61 
x
 = 0; x < 
c
->
u£d
; x++) {

63 
¼
 = (*
tmpc
 >> 
shiá
è& 
mask
;

66 *
tmpc
 = ((*tmpø<< 
d
è| 
r
è& 
MP_MASK
;

67 ++
tmpc
;

70 
r
 = 
¼
;

74 ià(
r
 != 0) {

75 
c
->
dp
[(c->
u£d
)++] = 
r
;

78 
	`mp_şamp
 (
c
);

79  
MP_OKAY
;

80 
	}
}

	@libtommath/bn_mp_mul_d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MUL_D_C


20 
	$mp_mul_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

22 
mp_dig™
 
u
, *
tm·
, *
tmpc
;

23 
mp_wÜd
 
r
;

24 
ix
, 
»s
, 
Şdu£
;

27 ià(
c
->
®loc
 < 
a
->
u£d
 + 1) {

28 ià((
»s
 = 
	`mp_grow
 (
c
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

29  
»s
;

34 
Şdu£
 = 
c
->
u£d
;

37 
c
->
sign
 = 
a
->sign;

40 
tm·
 = 
a
->
dp
;

43 
tmpc
 = 
c
->
dp
;

46 
u
 = 0;

49 
ix
 = 0; ix < 
a
->
u£d
; ix++) {

51 
r
 = ((
mp_wÜd
è
u
è+ ((mp_wÜd)*
tm·
++è* ((mp_wÜd)
b
);

54 *
tmpc
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

57 
u
 = (
mp_dig™
è(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

61 *
tmpc
++ = 
u
;

62 ++
ix
;

65 
ix
++ < 
Şdu£
) {

66 *
tmpc
++ = 0;

70 
c
->
u£d
 = 
a
->used + 1;

71 
	`mp_şamp
(
c
);

73  
MP_OKAY
;

74 
	}
}

	@libtommath/bn_mp_mulmod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_MULMOD_C


19 
	$mp_mulmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

21 
»s
;

22 
mp_št
 
t
;

24 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

25  
»s
;

28 ià((
»s
 = 
	`mp_mul
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

29 
	`mp_ş—r
 (&
t
);

30  
»s
;

32 
»s
 = 
	`mp_mod
 (&
t
, 
c
, 
d
);

33 
	`mp_ş—r
 (&
t
);

34  
»s
;

35 
	}
}

	@libtommath/bn_mp_n_root.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_N_ROOT_C


28 
	$mp_n_roÙ
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

30 
mp_št
 
t1
, 
t2
, 
t3
;

31 
»s
, 
Ãg
;

34 ià((
b
 & 1è=ğ0 && 
a
->
sign
 =ğ
MP_NEG
) {

35  
MP_VAL
;

38 ià((
»s
 = 
	`mp_š™
 (&
t1
)è!ğ
MP_OKAY
) {

39  
»s
;

42 ià((
»s
 = 
	`mp_š™
 (&
t2
)è!ğ
MP_OKAY
) {

43 
LBL_T1
;

46 ià((
»s
 = 
	`mp_š™
 (&
t3
)è!ğ
MP_OKAY
) {

47 
LBL_T2
;

51 
Ãg
 = 
a
->
sign
;

52 
a
->
sign
 = 
MP_ZPOS
;

55 
	`mp_£t
 (&
t2
, 2);

59 ià((
»s
 = 
	`mp_cİy
 (&
t2
, &
t1
)è!ğ
MP_OKAY
) {

60 
LBL_T3
;

66 ià((
»s
 = 
	`mp_ex±_d
 (&
t1
, 
b
 - 1, &
t3
)è!ğ
MP_OKAY
) {

67 
LBL_T3
;

72 ià((
»s
 = 
	`mp_mul
 (&
t3
, &
t1
, &
t2
)è!ğ
MP_OKAY
) {

73 
LBL_T3
;

77 ià((
»s
 = 
	`mp_sub
 (&
t2
, 
a
, &t2)è!ğ
MP_OKAY
) {

78 
LBL_T3
;

83 ià((
»s
 = 
	`mp_mul_d
 (&
t3
, 
b
, &t3)è!ğ
MP_OKAY
) {

84 
LBL_T3
;

88 ià((
»s
 = 
	`mp_div
 (&
t2
, &
t3
, &t3, 
NULL
)è!ğ
MP_OKAY
) {

89 
LBL_T3
;

92 ià((
»s
 = 
	`mp_sub
 (&
t1
, &
t3
, &
t2
)è!ğ
MP_OKAY
) {

93 
LBL_T3
;

95 } 
	`mp_cmp
 (&
t1
, &
t2
è!ğ
MP_EQ
);

99 ià((
»s
 = 
	`mp_ex±_d
 (&
t1
, 
b
, &
t2
)è!ğ
MP_OKAY
) {

100 
LBL_T3
;

103 ià(
	`mp_cmp
 (&
t2
, 
a
è=ğ
MP_GT
) {

104 ià((
»s
 = 
	`mp_sub_d
 (&
t1
, 1, &t1)è!ğ
MP_OKAY
) {

105 
LBL_T3
;

113 
a
->
sign
 = 
Ãg
;

116 
	`mp_exch
 (&
t1
, 
c
);

119 
c
->
sign
 = 
Ãg
;

121 
»s
 = 
MP_OKAY
;

123 
LBL_T3
:
	`mp_ş—r
 (&
t3
);

124 
LBL_T2
:
	`mp_ş—r
 (&
t2
);

125 
LBL_T1
:
	`mp_ş—r
 (&
t1
);

126  
»s
;

127 
	}
}

	@libtommath/bn_mp_neg.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_NEG_C


19 
	$mp_Ãg
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

21 
»s
;

22 ià(
a
 !ğ
b
) {

23 ià((
»s
 = 
	`mp_cİy
 (
a
, 
b
)è!ğ
MP_OKAY
) {

24  
»s
;

28 ià(
	`mp_isz”o
(
b
è!ğ
MP_YES
) {

29 
b
->
sign
 = (
a
->sigÀ=ğ
MP_ZPOS
è? 
MP_NEG
 : MP_ZPOS;

31 
b
->
sign
 = 
MP_ZPOS
;

34  
MP_OKAY
;

35 
	}
}

	@libtommath/bn_mp_or.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_OR_C


19 
	$mp_Ü
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

21 
»s
, 
ix
, 
px
;

22 
mp_št
 
t
, *
x
;

24 ià(
a
->
u£d
 > 
b
->used) {

25 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

26  
»s
;

28 
px
 = 
b
->
u£d
;

29 
x
 = 
b
;

31 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
b
)è!ğ
MP_OKAY
) {

32  
»s
;

34 
px
 = 
a
->
u£d
;

35 
x
 = 
a
;

38 
ix
 = 0; ix < 
px
; ix++) {

39 
t
.
dp
[
ix
] |ğ
x
->dp[ix];

41 
	`mp_şamp
 (&
t
);

42 
	`mp_exch
 (
c
, &
t
);

43 
	`mp_ş—r
 (&
t
);

44  
MP_OKAY
;

45 
	}
}

	@libtommath/bn_mp_prime_fermat.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_PRIME_FERMAT_C


26 
	$mp_´ime_ãrm©
 (
mp_št
 * 
a
, mp_šˆ* 
b
, *
»suÉ
)

28 
mp_št
 
t
;

29 
”r
;

32 *
»suÉ
 = 
MP_NO
;

35 ià(
	`mp_cmp_d
(
b
, 1è!ğ
MP_GT
) {

36  
MP_VAL
;

40 ià((
”r
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

41  
”r
;

45 ià((
”r
 = 
	`mp_ex±mod
 (
b
, 
a
,‡, &
t
)è!ğ
MP_OKAY
) {

46 
LBL_T
;

50 ià(
	`mp_cmp
 (&
t
, 
b
è=ğ
MP_EQ
) {

51 *
»suÉ
 = 
MP_YES
;

54 
”r
 = 
MP_OKAY
;

55 
LBL_T
:
	`mp_ş—r
 (&
t
);

56  
”r
;

57 
	}
}

	@libtommath/bn_mp_prime_is_divisible.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_PRIME_IS_DIVISIBLE_C


23 
	$mp_´ime_is_divisibË
 (
mp_št
 * 
a
, *
»suÉ
)

25 
”r
, 
ix
;

26 
mp_dig™
 
»s
;

29 *
»suÉ
 = 
MP_NO
;

31 
ix
 = 0; ix < 
PRIME_SIZE
; ix++) {

33 ià((
”r
 = 
	`mp_mod_d
 (
a
, 
Ém_´ime_b
[
ix
], &
»s
)è!ğ
MP_OKAY
) {

34  
”r
;

38 ià(
»s
 == 0) {

39 *
»suÉ
 = 
MP_YES
;

40  
MP_OKAY
;

44  
MP_OKAY
;

45 
	}
}

	@libtommath/bn_mp_prime_is_prime.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_PRIME_IS_PRIME_C


25 
	$mp_´ime_is_´ime
 (
mp_št
 * 
a
, 
t
, *
»suÉ
)

27 
mp_št
 
b
;

28 
ix
, 
”r
, 
»s
;

31 *
»suÉ
 = 
MP_NO
;

34 ià(
t
 <ğ0 || > 
PRIME_SIZE
) {

35  
MP_VAL
;

39 
ix
 = 0; ix < 
PRIME_SIZE
; ix++) {

40 ià(
	`mp_cmp_d
(
a
, 
Ém_´ime_b
[
ix
]è=ğ
MP_EQ
) {

41 *
»suÉ
 = 1;

42  
MP_OKAY
;

47 ià((
”r
 = 
	`mp_´ime_is_divisibË
 (
a
, &
»s
)è!ğ
MP_OKAY
) {

48  
”r
;

52 ià(
»s
 =ğ
MP_YES
) {

53  
MP_OKAY
;

57 ià((
”r
 = 
	`mp_š™
 (&
b
)è!ğ
MP_OKAY
) {

58  
”r
;

61 
ix
 = 0; ix < 
t
; ix++) {

63 
	`mp_£t
 (&
b
, 
Ém_´ime_b
[
ix
]);

65 ià((
”r
 = 
	`mp_´ime_mËr_¿bš
 (
a
, &
b
, &
»s
)è!ğ
MP_OKAY
) {

66 
LBL_B
;

69 ià(
»s
 =ğ
MP_NO
) {

70 
LBL_B
;

75 *
»suÉ
 = 
MP_YES
;

76 
LBL_B
:
	`mp_ş—r
 (&
b
);

77  
”r
;

78 
	}
}

	@libtommath/bn_mp_prime_miller_rabin.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_PRIME_MILLER_RABIN_C


25 
	$mp_´ime_mËr_¿bš
 (
mp_št
 * 
a
, mp_šˆ* 
b
, *
»suÉ
)

27 
mp_št
 
n1
, 
y
, 
r
;

28 
s
, 
j
, 
”r
;

31 *
»suÉ
 = 
MP_NO
;

34 ià(
	`mp_cmp_d
(
b
, 1è!ğ
MP_GT
) {

35  
MP_VAL
;

39 ià((
”r
 = 
	`mp_š™_cİy
 (&
n1
, 
a
)è!ğ
MP_OKAY
) {

40  
”r
;

42 ià((
”r
 = 
	`mp_sub_d
 (&
n1
, 1, &n1)è!ğ
MP_OKAY
) {

43 
LBL_N1
;

47 ià((
”r
 = 
	`mp_š™_cİy
 (&
r
, &
n1
)è!ğ
MP_OKAY
) {

48 
LBL_N1
;

54 
s
 = 
	`mp_út_lsb
(&
r
);

57 ià((
”r
 = 
	`mp_div_2d
 (&
r
, 
s
, &r, 
NULL
)è!ğ
MP_OKAY
) {

58 
LBL_R
;

62 ià((
”r
 = 
	`mp_š™
 (&
y
)è!ğ
MP_OKAY
) {

63 
LBL_R
;

65 ià((
”r
 = 
	`mp_ex±mod
 (
b
, &
r
, 
a
, &
y
)è!ğ
MP_OKAY
) {

66 
LBL_Y
;

70 ià(
	`mp_cmp_d
 (&
y
, 1è!ğ
MP_EQ
 && 
	`mp_cmp
 (&y, &
n1
) != MP_EQ) {

71 
j
 = 1;

73 (
j
 <ğ(
s
 - 1)è&& 
	`mp_cmp
 (&
y
, &
n1
è!ğ
MP_EQ
) {

74 ià((
”r
 = 
	`mp_sqrmod
 (&
y
, 
a
, &y)è!ğ
MP_OKAY
) {

75 
LBL_Y
;

79 ià(
	`mp_cmp_d
 (&
y
, 1è=ğ
MP_EQ
) {

80 
LBL_Y
;

83 ++
j
;

87 ià(
	`mp_cmp
 (&
y
, &
n1
è!ğ
MP_EQ
) {

88 
LBL_Y
;

93 *
»suÉ
 = 
MP_YES
;

94 
LBL_Y
:
	`mp_ş—r
 (&
y
);

95 
LBL_R
:
	`mp_ş—r
 (&
r
);

96 
LBL_N1
:
	`mp_ş—r
 (&
n1
);

97  
”r
;

98 
	}
}

	@libtommath/bn_mp_prime_next_prime.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_PRIME_NEXT_PRIME_C


23 
	$mp_´ime_Ãxt_´ime
(
mp_št
 *
a
, 
t
, 
bbs_¡yË
)

25 
”r
, 
»s
, 
x
, 
y
;

26 
mp_dig™
 
»s_b
[
PRIME_SIZE
], 
¡•
, 
k¡•
;

27 
mp_št
 
b
;

30 ià(
t
 <ğ0 || > 
PRIME_SIZE
) {

31  
MP_VAL
;

35 
a
->
sign
 = 
MP_ZPOS
;

38 ià(
	`mp_cmp_d
(
a
, 
Ém_´ime_b
[
PRIME_SIZE
-1]è=ğ
MP_LT
) {

40 
x
 = 
PRIME_SIZE
 - 2; x >= 0; x--) {

41 ià(
	`mp_cmp_d
(
a
, 
Ém_´ime_b
[
x
]è!ğ
MP_LT
) {

42 ià(
bbs_¡yË
 == 1) {

49 ià((
Ém_´ime_b
[
x
 + 1] & 3) != 3) {

51 
y
 = 
x
 + 1; y < 
PRIME_SIZE
; y++) {

52 ià((
Ém_´ime_b
[
y
] & 3) == 3) {

53 
	`mp_£t
(
a
, 
Ém_´ime_b
[
y
]);

54  
MP_OKAY
;

59 
	`mp_£t
(
a
, 
Ém_´ime_b
[
x
 + 1]);

60  
MP_OKAY
;

65 ià(
	`mp_cmp_d
(
a
, 1è=ğ
MP_EQ
) {

66 
	`mp_£t
(
a
, 2);

67  
MP_OKAY
;

73 ià(
bbs_¡yË
 == 1) {

74 
k¡•
 = 4;

76 
k¡•
 = 2;

81 ià(
bbs_¡yË
 == 1) {

83 ià((
a
->
dp
[0] & 3) != 3) {

84 ià((
”r
 = 
	`mp_sub_d
(
a
, (a->
dp
[0] & 3è+ 1,‡)è!ğ
MP_OKAY
) { ƒrr; };

87 ià(
	`mp_i£v’
(
a
) == 1) {

89 ià((
”r
 = 
	`mp_sub_d
(
a
, 1,‡)è!ğ
MP_OKAY
) {

90  
”r
;

96 
x
 = 1; x < 
PRIME_SIZE
; x++) {

97 ià((
”r
 = 
	`mp_mod_d
(
a
, 
Ém_´ime_b
[
x
], 
»s_b
 + x)è!ğ
MP_OKAY
) {

98  
”r
;

103 ià((
”r
 = 
	`mp_š™
(&
b
)è!ğ
MP_OKAY
) {

104  
”r
;

109 
¡•
 = 0;

112 
y
 = 0;

115 
¡•
 +ğ
k¡•
;

118 
x
 = 1; x < 
PRIME_SIZE
; x++) {

120 
»s_b
[
x
] +ğ
k¡•
;

123 ià(
»s_b
[
x
] >ğ
Ém_´ime_b
[x]) {

124 
»s_b
[
x
] -ğ
Ém_´ime_b
[x];

128 ià(
»s_b
[
x
] == 0) {

129 
y
 = 1;

132 } 
y
 =ğ1 && 
¡•
 < ((((
mp_dig™
)1)<<
DIGIT_BIT
è- 
k¡•
));

135 ià((
”r
 = 
	`mp_add_d
(
a
, 
¡•
,‡)è!ğ
MP_OKAY
) {

136 
LBL_ERR
;

140 ià(
y
 =ğ1 && 
¡•
 >ğ((((
mp_dig™
)1)<<
DIGIT_BIT
è- 
k¡•
)) {

145 
x
 = 0; x < 
t
; x++) {

146 
	`mp_£t
(&
b
, 
Ém_´ime_b
[
x
]);

147 ià((
”r
 = 
	`mp_´ime_mËr_¿bš
(
a
, &
b
, &
»s
)è!ğ
MP_OKAY
) {

148 
LBL_ERR
;

150 ià(
»s
 =ğ
MP_NO
) {

155 ià(
»s
 =ğ
MP_YES
) {

160 
”r
 = 
MP_OKAY
;

161 
LBL_ERR
:

162 
	`mp_ş—r
(&
b
);

163  
”r
;

164 
	}
}

	@libtommath/bn_mp_prime_rabin_miller_trials.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_PRIME_RABIN_MILLER_TRIALS_C


20 
	mk
, 
	mt
;

21 } 
	gsizes
[] = {

33 
	$mp_´ime_¿bš_mËr_ŒŸls
(
size
)

35 
x
;

37 
x
 = 0; x < ()((
sizes
)/((sizes[0]))); x++) {

38 ià(
sizes
[
x
].
k
 =ğ
size
) {

39  
sizes
[
x
].
t
;

40 } ià(
sizes
[
x
].
k
 > 
size
) {

41  (
x
 =ğ0è? 
sizes
[0].
t
 : sizes[x - 1].t;

44  
sizes
[
x
-1].
t
 + 1;

45 
	}
}

	@libtommath/bn_mp_prime_random_ex.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_PRIME_RANDOM_EX_C


34 
	$mp_´ime_¿ndom_ex
(
mp_št
 *
a
, 
t
, 
size
, 
æags
, 
Ém_´ime_ÿÎback
 
cb
, *
d©
)

36 *
tmp
, 
maskAND
, 
maskOR_msb
, 
maskOR_lsb
;

37 
»s
, 
”r
, 
bsize
, 
maskOR_msb_off£t
;

40 ià(
size
 <ğ1 || 
t
 <= 0) {

41  
MP_VAL
;

45 ià(
æags
 & 
LTM_PRIME_SAFE
) {

46 
æags
 |ğ
LTM_PRIME_BBS
;

50 
bsize
 = (
size
>>3) + ((size&7)?1:0);

53 
tmp
 = 
	`OPT_CAST
(è
	`XMALLOC
(
bsize
);

54 ià(
tmp
 =ğ
NULL
) {

55  
MP_MEM
;

59 
maskAND
 = ((
size
&7) == 0) ? 0xFF : (0xFF >> (8 - (size & 7)));

62 
maskOR_msb
 = 0;

63 
maskOR_msb_off£t
 = ((
size
 & 7) == 1) ? 1 : 0;

64 ià(
æags
 & 
LTM_PRIME_2MSB_ON
) {

65 
maskOR_msb
 |ğ0x80 >> ((9 - 
size
) & 7);

69 
maskOR_lsb
 = 1;

70 ià(
æags
 & 
LTM_PRIME_BBS
) {

71 
maskOR_lsb
 |= 3;

76 ià(
	`cb
(
tmp
, 
bsize
, 
d©
) != bsize) {

77 
”r
 = 
MP_VAL
;

78 
”rÜ
;

82 
tmp
[0] &ğ
maskAND
;

83 
tmp
[0] |ğ1 << ((
size
 - 1) & 7);

86 
tmp
[
maskOR_msb_off£t
] |ğ
maskOR_msb
;

87 
tmp
[
bsize
-1] |ğ
maskOR_lsb
;

90 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
a
, 
tmp
, 
bsize
)è!ğ
MP_OKAY
è{ 
”rÜ
; }

93 ià((
”r
 = 
	`mp_´ime_is_´ime
(
a
, 
t
, &
»s
)è!ğ
MP_OKAY
è{ 
”rÜ
; }

94 ià(
»s
 =ğ
MP_NO
) {

98 ià(
æags
 & 
LTM_PRIME_SAFE
) {

100 ià((
”r
 = 
	`mp_sub_d
(
a
, 1,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

101 ià((
”r
 = 
	`mp_div_2
(
a
,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

104 ià((
”r
 = 
	`mp_´ime_is_´ime
(
a
, 
t
, &
»s
)è!ğ
MP_OKAY
è{ 
”rÜ
; }

106 } 
»s
 =ğ
MP_NO
);

108 ià(
æags
 & 
LTM_PRIME_SAFE
) {

110 ià((
”r
 = 
	`mp_mul_2
(
a
,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

111 ià((
”r
 = 
	`mp_add_d
(
a
, 1,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

114 
”r
 = 
MP_OKAY
;

115 
”rÜ
:

116 
	`XFREE
(
tmp
);

117  
”r
;

118 
	}
}

	@libtommath/bn_mp_radix_size.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_RADIX_SIZE_C


19 
	$mp_¿dix_size
 (
mp_št
 * 
a
, 
¿dix
, *
size
)

21 
»s
, 
digs
;

22 
mp_št
 
t
;

23 
mp_dig™
 
d
;

25 *
size
 = 0;

28 ià(
¿dix
 == 2) {

29 *
size
 = 
	`mp_couÁ_b™s
 (
a
è+ (a->
sign
 =ğ
MP_NEG
 ? 1 : 0) + 1;

30  
MP_OKAY
;

34 ià(
¿dix
 < 2 ||„adix > 64) {

35  
MP_VAL
;

38 ià(
	`mp_isz”o
(
a
è=ğ
MP_YES
) {

39 *
size
 = 2;

40  
MP_OKAY
;

44 
digs
 = 0;

47 ià(
a
->
sign
 =ğ
MP_NEG
) {

48 ++
digs
;

52 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

53  
»s
;

57 
t
.
sign
 = 
MP_ZPOS
;

60 
	`mp_isz”o
 (&
t
è=ğ
MP_NO
) {

61 ià((
»s
 = 
	`mp_div_d
 (&
t
, (
mp_dig™
è
¿dix
, &t, &
d
)è!ğ
MP_OKAY
) {

62 
	`mp_ş—r
 (&
t
);

63  
»s
;

65 ++
digs
;

67 
	`mp_ş—r
 (&
t
);

70 *
size
 = 
digs
 + 1;

71  
MP_OKAY
;

72 
	}
}

	@libtommath/bn_mp_radix_smap.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_RADIX_SMAP_C


19 cÚ¡ *
	gmp_s_rm­
 = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/";

	@libtommath/bn_mp_rand.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_RAND_C


20 
	$mp_¿nd
 (
mp_št
 * 
a
, 
dig™s
)

22 
»s
;

23 
mp_dig™
 
d
;

25 
	`mp_z”o
 (
a
);

26 ià(
dig™s
 <= 0) {

27  
MP_OKAY
;

32 
d
 = ((
mp_dig™
è
	`abs
 (
	`¿nd
 ())è& 
MP_MASK
;

33 } 
d
 == 0);

35 ià((
»s
 = 
	`mp_add_d
 (
a
, 
d
,‡)è!ğ
MP_OKAY
) {

36  
»s
;

39 --
dig™s
 > 0) {

40 ià((
»s
 = 
	`mp_lshd
 (
a
, 1)è!ğ
MP_OKAY
) {

41  
»s
;

44 ià((
»s
 = 
	`mp_add_d
 (
a
, ((
mp_dig™
è
	`abs
 (
	`¿nd
 ())),‡)è!ğ
MP_OKAY
) {

45  
»s
;

49  
MP_OKAY
;

50 
	}
}

	@libtommath/bn_mp_read_radix.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_READ_RADIX_C


19 
	$mp_»ad_¿dix
 (
mp_št
 * 
a
, cÚ¡ *
¡r
, 
¿dix
)

21 
y
, 
»s
, 
Ãg
;

22 
ch
;

25 
	`mp_z”o
(
a
);

28 ià(
¿dix
 < 2 ||„adix > 64) {

29  
MP_VAL
;

35 ià(*
¡r
 == '-') {

36 ++
¡r
;

37 
Ãg
 = 
MP_NEG
;

39 
Ãg
 = 
MP_ZPOS
;

43 
	`mp_z”o
 (
a
);

46 *
¡r
) {

51 
ch
 = (è((
¿dix
 < 36è? 
	`touµ”
 (*
¡r
) : *str);

52 
y
 = 0; y < 64; y++) {

53 ià(
ch
 =ğ
mp_s_rm­
[
y
]) {

62 ià(
y
 < 
¿dix
) {

63 ià((
»s
 = 
	`mp_mul_d
 (
a
, (
mp_dig™
è
¿dix
,‡)è!ğ
MP_OKAY
) {

64  
»s
;

66 ià((
»s
 = 
	`mp_add_d
 (
a
, (
mp_dig™
è
y
,‡)è!ğ
MP_OKAY
) {

67  
»s
;

72 ++
¡r
;

76 ià(
	`mp_isz”o
(
a
) != 1) {

77 
a
->
sign
 = 
Ãg
;

79  
MP_OKAY
;

80 
	}
}

	@libtommath/bn_mp_read_signed_bin.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_READ_SIGNED_BIN_C


19 
	$mp_»ad_sigÃd_bš
 (
mp_št
 * 
a
, cÚ¡ *
b
, 
c
)

21 
»s
;

24 ià((
»s
 = 
	`mp_»ad_unsigÃd_bš
 (
a
, 
b
 + 1, 
c
 - 1)è!ğ
MP_OKAY
) {

25  
»s
;

29 ià(
b
[0] == 0) {

30 
a
->
sign
 = 
MP_ZPOS
;

32 
a
->
sign
 = 
MP_NEG
;

35  
MP_OKAY
;

36 
	}
}

	@libtommath/bn_mp_read_unsigned_bin.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_READ_UNSIGNED_BIN_C


19 
	$mp_»ad_unsigÃd_bš
 (
mp_št
 * 
a
, cÚ¡ *
b
, 
c
)

21 
»s
;

24 ià(
a
->
®loc
 < 2) {

25 ià((
»s
 = 
	`mp_grow
(
a
, 2)è!ğ
MP_OKAY
) {

26  
»s
;

31 
	`mp_z”o
 (
a
);

34 
c
-- > 0) {

35 ià((
»s
 = 
	`mp_mul_2d
 (
a
, 8,‡)è!ğ
MP_OKAY
) {

36  
»s
;

39 #iâdeà
MP_8BIT


40 
a
->
dp
[0] |ğ*
b
++;

41 
a
->
u£d
 += 1;

43 
a
->
dp
[0] = (*
b
 & 
MP_MASK
);

44 
a
->
dp
[1] |ğ((*
b
++ >> 7U) & 1);

45 
a
->
u£d
 += 2;

48 
	`mp_şamp
 (
a
);

49  
MP_OKAY
;

50 
	}
}

	@libtommath/bn_mp_reduce.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_C


22 
	$mp_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
m
, mp_šˆ* 
mu
)

24 
mp_št
 
q
;

25 
»s
, 
um
 = 
m
->
u£d
;

28 ià((
»s
 = 
	`mp_š™_cİy
 (&
q
, 
x
)è!ğ
MP_OKAY
) {

29  
»s
;

33 
	`mp_rshd
 (&
q
, 
um
 - 1);

36 ià(((è
um
è> (((
mp_dig™
)1è<< (
DIGIT_BIT
 - 1))) {

37 ià((
»s
 = 
	`mp_mul
 (&
q
, 
mu
, &q)è!ğ
MP_OKAY
) {

38 
CLEANUP
;

41 #ifdeà
BN_S_MP_MUL_HIGH_DIGS_C


42 ià((
»s
 = 
	`s_mp_mul_high_digs
 (&
q
, 
mu
, &q, 
um
)è!ğ
MP_OKAY
) {

43 
CLEANUP
;

45 #–ià
	`defšed
(
BN_FAST_S_MP_MUL_HIGH_DIGS_C
)

46 ià((
»s
 = 
	`ç¡_s_mp_mul_high_digs
 (&
q
, 
mu
, &q, 
um
)è!ğ
MP_OKAY
) {

47 
CLEANUP
;

51 
»s
 = 
MP_VAL
;

52 
CLEANUP
;

58 
	`mp_rshd
 (&
q
, 
um
 + 1);

61 ià((
»s
 = 
	`mp_mod_2d
 (
x
, 
DIGIT_BIT
 * (
um
 + 1), x)è!ğ
MP_OKAY
) {

62 
CLEANUP
;

66 ià((
»s
 = 
	`s_mp_mul_digs
 (&
q
, 
m
, &q, 
um
 + 1)è!ğ
MP_OKAY
) {

67 
CLEANUP
;

71 ià((
»s
 = 
	`mp_sub
 (
x
, &
q
, x)è!ğ
MP_OKAY
) {

72 
CLEANUP
;

76 ià(
	`mp_cmp_d
 (
x
, 0è=ğ
MP_LT
) {

77 
	`mp_£t
 (&
q
, 1);

78 ià((
»s
 = 
	`mp_lshd
 (&
q
, 
um
 + 1)è!ğ
MP_OKAY
)

79 
CLEANUP
;

80 ià((
»s
 = 
	`mp_add
 (
x
, &
q
, x)è!ğ
MP_OKAY
)

81 
CLEANUP
;

85 
	`mp_cmp
 (
x
, 
m
è!ğ
MP_LT
) {

86 ià((
»s
 = 
	`s_mp_sub
 (
x
, 
m
, x)è!ğ
MP_OKAY
) {

87 
CLEANUP
;

91 
CLEANUP
:

92 
	`mp_ş—r
 (&
q
);

94  
»s
;

95 
	}
}

	@libtommath/bn_mp_reduce_2k.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_2K_C


19 
	$mp_»duû_2k
(
mp_št
 *
a
, mp_šˆ*
n
, 
mp_dig™
 
d
)

21 
mp_št
 
q
;

22 
p
, 
»s
;

24 ià((
»s
 = 
	`mp_š™
(&
q
)è!ğ
MP_OKAY
) {

25  
»s
;

28 
p
 = 
	`mp_couÁ_b™s
(
n
);

29 
tİ
:

31 ià((
»s
 = 
	`mp_div_2d
(
a
, 
p
, &
q
,‡)è!ğ
MP_OKAY
) {

32 
ERR
;

35 ià(
d
 != 1) {

37 ià((
»s
 = 
	`mp_mul_d
(&
q
, 
d
, &q)è!ğ
MP_OKAY
) {

38 
ERR
;

43 ià((
»s
 = 
	`s_mp_add
(
a
, &
q
,‡)è!ğ
MP_OKAY
) {

44 
ERR
;

47 ià(
	`mp_cmp_mag
(
a
, 
n
è!ğ
MP_LT
) {

48 
	`s_mp_sub
(
a
, 
n
,‡);

49 
tİ
;

52 
ERR
:

53 
	`mp_ş—r
(&
q
);

54  
»s
;

55 
	}
}

	@libtommath/bn_mp_reduce_2k_l.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_2K_L_C


22 
	$mp_»duû_2k_l
(
mp_št
 *
a
, mp_šˆ*
n
, mp_šˆ*
d
)

24 
mp_št
 
q
;

25 
p
, 
»s
;

27 ià((
»s
 = 
	`mp_š™
(&
q
)è!ğ
MP_OKAY
) {

28  
»s
;

31 
p
 = 
	`mp_couÁ_b™s
(
n
);

32 
tİ
:

34 ià((
»s
 = 
	`mp_div_2d
(
a
, 
p
, &
q
,‡)è!ğ
MP_OKAY
) {

35 
ERR
;

39 ià((
»s
 = 
	`mp_mul
(&
q
, 
d
, &q)è!ğ
MP_OKAY
) {

40 
ERR
;

44 ià((
»s
 = 
	`s_mp_add
(
a
, &
q
,‡)è!ğ
MP_OKAY
) {

45 
ERR
;

48 ià(
	`mp_cmp_mag
(
a
, 
n
è!ğ
MP_LT
) {

49 
	`s_mp_sub
(
a
, 
n
,‡);

50 
tİ
;

53 
ERR
:

54 
	`mp_ş—r
(&
q
);

55  
»s
;

56 
	}
}

	@libtommath/bn_mp_reduce_2k_setup.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_2K_SETUP_C


19 
	$mp_»duû_2k_£tup
(
mp_št
 *
a
, 
mp_dig™
 *
d
)

21 
»s
, 
p
;

22 
mp_št
 
tmp
;

24 ià((
»s
 = 
	`mp_š™
(&
tmp
)è!ğ
MP_OKAY
) {

25  
»s
;

28 
p
 = 
	`mp_couÁ_b™s
(
a
);

29 ià((
»s
 = 
	`mp_2ex±
(&
tmp
, 
p
)è!ğ
MP_OKAY
) {

30 
	`mp_ş—r
(&
tmp
);

31  
»s
;

34 ià((
»s
 = 
	`s_mp_sub
(&
tmp
, 
a
, &tmp)è!ğ
MP_OKAY
) {

35 
	`mp_ş—r
(&
tmp
);

36  
»s
;

39 *
d
 = 
tmp
.
dp
[0];

40 
	`mp_ş—r
(&
tmp
);

41  
MP_OKAY
;

42 
	}
}

	@libtommath/bn_mp_reduce_2k_setup_l.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_2K_SETUP_L_C


19 
	$mp_»duû_2k_£tup_l
(
mp_št
 *
a
, mp_šˆ*
d
)

21 
»s
;

22 
mp_št
 
tmp
;

24 ià((
»s
 = 
	`mp_š™
(&
tmp
)è!ğ
MP_OKAY
) {

25  
»s
;

28 ià((
»s
 = 
	`mp_2ex±
(&
tmp
, 
	`mp_couÁ_b™s
(
a
))è!ğ
MP_OKAY
) {

29 
ERR
;

32 ià((
»s
 = 
	`s_mp_sub
(&
tmp
, 
a
, 
d
)è!ğ
MP_OKAY
) {

33 
ERR
;

36 
ERR
:

37 
	`mp_ş—r
(&
tmp
);

38  
»s
;

39 
	}
}

	@libtommath/bn_mp_reduce_is_2k.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_IS_2K_C


19 
	$mp_»duû_is_2k
(
mp_št
 *
a
)

21 
ix
, 
iy
, 
iw
;

22 
mp_dig™
 
iz
;

24 ià(
a
->
u£d
 == 0) {

25  
MP_NO
;

26 } ià(
a
->
u£d
 == 1) {

27  
MP_YES
;

28 } ià(
a
->
u£d
 > 1) {

29 
iy
 = 
	`mp_couÁ_b™s
(
a
);

30 
iz
 = 1;

31 
iw
 = 1;

34 
ix
 = 
DIGIT_BIT
; ix < 
iy
; ix++) {

35 ià((
a
->
dp
[
iw
] & 
iz
) == 0) {

36  
MP_NO
;

38 
iz
 <<= 1;

39 ià(
iz
 > (
mp_dig™
)
MP_MASK
) {

40 ++
iw
;

41 
iz
 = 1;

45  
MP_YES
;

46 
	}
}

	@libtommath/bn_mp_reduce_is_2k_l.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_IS_2K_L_C


19 
	$mp_»duû_is_2k_l
(
mp_št
 *
a
)

21 
ix
, 
iy
;

23 ià(
a
->
u£d
 == 0) {

24  
MP_NO
;

25 } ià(
a
->
u£d
 == 1) {

26  
MP_YES
;

27 } ià(
a
->
u£d
 > 1) {

29 
iy
 = 
ix
 = 0; ix < 
a
->
u£d
; ix++) {

30 ià(
a
->
dp
[
ix
] =ğ
MP_MASK
) {

31 ++
iy
;

34  (
iy
 >ğ(
a
->
u£d
/2)è? 
MP_YES
 : 
MP_NO
;

37  
MP_NO
;

38 
	}
}

	@libtommath/bn_mp_reduce_setup.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_REDUCE_SETUP_C


21 
	$mp_»duû_£tup
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

23 
»s
;

25 ià((
»s
 = 
	`mp_2ex±
 (
a
, 
b
->
u£d
 * 2 * 
DIGIT_BIT
)è!ğ
MP_OKAY
) {

26  
»s
;

28  
	`mp_div
 (
a
, 
b
,‡, 
NULL
);

29 
	}
}

	@libtommath/bn_mp_rshd.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_RSHD_C


19 
	$mp_rshd
 (
mp_št
 * 
a
, 
b
)

21 
x
;

24 ià(
b
 <= 0) {

29 ià(
a
->
u£d
 <ğ
b
) {

30 
	`mp_z”o
 (
a
);

35 
mp_dig™
 *
bÙtom
, *
tİ
;

40 
bÙtom
 = 
a
->
dp
;

43 
tİ
 = 
a
->
dp
 + 
b
;

55 
x
 = 0; x < (
a
->
u£d
 - 
b
); x++) {

56 *
bÙtom
++ = *
tİ
++;

60 ; 
x
 < 
a
->
u£d
; x++) {

61 *
bÙtom
++ = 0;

66 
a
->
u£d
 -ğ
b
;

67 
	}
}

	@libtommath/bn_mp_set.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SET_C


19 
	$mp_£t
 (
mp_št
 * 
a
, 
mp_dig™
 
b
)

21 
	`mp_z”o
 (
a
);

22 
a
->
dp
[0] = 
b
 & 
MP_MASK
;

23 
a
->
u£d
 = (a->
dp
[0] != 0) ? 1 : 0;

24 
	}
}

	@libtommath/bn_mp_set_int.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SET_INT_C


19 
	$mp_£t_št
 (
mp_št
 * 
a
, 
b
)

21 
x
, 
»s
;

23 
	`mp_z”o
 (
a
);

26 
x
 = 0; x < 8; x++) {

28 ià((
»s
 = 
	`mp_mul_2d
 (
a
, 4,‡)è!ğ
MP_OKAY
) {

29  
»s
;

33 
a
->
dp
[0] |ğ(
b
 >> 28) & 15;

36 
b
 <<= 4;

39 
a
->
u£d
 += 1;

41 
	`mp_şamp
 (
a
);

42  
MP_OKAY
;

43 
	}
}

	@libtommath/bn_mp_shrink.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SHRINK_C


19 
	$mp_shršk
 (
mp_št
 * 
a
)

21 
mp_dig™
 *
tmp
;

22 ià(
a
->
®loc
 !ğa->
u£d
 &&‡->used > 0) {

23 ià((
tmp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XREALLOC
 (
a
->
dp
,  (mp_dig™è*‡->
u£d
)è=ğ
NULL
) {

24  
MP_MEM
;

26 
a
->
dp
 = 
tmp
;

27 
a
->
®loc
 =‡->
u£d
;

29  
MP_OKAY
;

30 
	}
}

	@libtommath/bn_mp_signed_bin_size.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SIGNED_BIN_SIZE_C


19 
	$mp_sigÃd_bš_size
 (
mp_št
 * 
a
)

21  1 + 
	`mp_unsigÃd_bš_size
 (
a
);

22 
	}
}

	@libtommath/bn_mp_sqr.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SQR_C


20 
	$mp_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

22 
»s
;

24 #ifdeà
BN_MP_TOOM_SQR_C


26 ià(
a
->
u£d
 >ğ
TOOM_SQR_CUTOFF
) {

27 
»s
 = 
	`mp_toom_sqr
(
a
, 
b
);

31 #ifdeà
BN_MP_KARATSUBA_SQR_C


32 ià(
a
->
u£d
 >ğ
KARATSUBA_SQR_CUTOFF
) {

33 
»s
 = 
	`mp_k¬©suba_sqr
 (
a
, 
b
);

37 #ifdeà
BN_FAST_S_MP_SQR_C


39 ià((
a
->
u£d
 * 2 + 1è< 
MP_WARRAY
 &&

40 
a
->
u£d
 <

41 (1 << ((
mp_wÜd
è* 
CHAR_BIT
 - 2*
DIGIT_BIT
 - 1))) {

42 
»s
 = 
	`ç¡_s_mp_sqr
 (
a
, 
b
);

45 #ifdeà
BN_S_MP_SQR_C


46 
»s
 = 
	`s_mp_sqr
 (
a
, 
b
);

48 
»s
 = 
MP_VAL
;

51 
b
->
sign
 = 
MP_ZPOS
;

52  
»s
;

53 
	}
}

	@libtommath/bn_mp_sqrmod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SQRMOD_C


20 
	$mp_sqrmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 
»s
;

23 
mp_št
 
t
;

25 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

26  
»s
;

29 ià((
»s
 = 
	`mp_sqr
 (
a
, &
t
)è!ğ
MP_OKAY
) {

30 
	`mp_ş—r
 (&
t
);

31  
»s
;

33 
»s
 = 
	`mp_mod
 (&
t
, 
b
, 
c
);

34 
	`mp_ş—r
 (&
t
);

35  
»s
;

36 
	}
}

	@libtommath/bn_mp_sqrt.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SQRT_C


19 
	$mp_sq¹
(
mp_št
 *
¬g
, mp_šˆ*
»t
)

21 
»s
;

22 
mp_št
 
t1
,
t2
;

25 ià(
¬g
->
sign
 =ğ
MP_NEG
) {

26  
MP_VAL
;

30 ià(
	`mp_isz”o
(
¬g
è=ğ
MP_YES
) {

31 
	`mp_z”o
(
»t
);

32  
MP_OKAY
;

35 ià((
»s
 = 
	`mp_š™_cİy
(&
t1
, 
¬g
)è!ğ
MP_OKAY
) {

36  
»s
;

39 ià((
»s
 = 
	`mp_š™
(&
t2
)è!ğ
MP_OKAY
) {

40 
E2
;

44 
	`mp_rshd
 (&
t1
,t1.
u£d
/2);

47 ià((
»s
 = 
	`mp_div
(
¬g
,&
t1
,&
t2
,
NULL
)è!ğ
MP_OKAY
) {

48 
E1
;

50 ià((
»s
 = 
	`mp_add
(&
t1
,&
t2
,&t1)è!ğ
MP_OKAY
) {

51 
E1
;

53 ià((
»s
 = 
	`mp_div_2
(&
t1
,&t1)è!ğ
MP_OKAY
) {

54 
E1
;

58 ià((
»s
 = 
	`mp_div
(
¬g
,&
t1
,&
t2
,
NULL
)è!ğ
MP_OKAY
) {

59 
E1
;

61 ià((
»s
 = 
	`mp_add
(&
t1
,&
t2
,&t1)è!ğ
MP_OKAY
) {

62 
E1
;

64 ià((
»s
 = 
	`mp_div_2
(&
t1
,&t1)è!ğ
MP_OKAY
) {

65 
E1
;

68 } 
	`mp_cmp_mag
(&
t1
,&
t2
è=ğ
MP_GT
);

70 
	`mp_exch
(&
t1
,
»t
);

72 
E1
: 
	`mp_ş—r
(&
t2
);

73 
E2
: 
	`mp_ş—r
(&
t1
);

74  
»s
;

75 
	}
}

	@libtommath/bn_mp_sub.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SUB_C


20 
	$mp_sub
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 
§
, 
sb
, 
»s
;

24 
§
 = 
a
->
sign
;

25 
sb
 = 
b
->
sign
;

27 ià(
§
 !ğ
sb
) {

32 
c
->
sign
 = 
§
;

33 
»s
 = 
	`s_mp_add
 (
a
, 
b
, 
c
);

39 ià(
	`mp_cmp_mag
 (
a
, 
b
è!ğ
MP_LT
) {

41 
c
->
sign
 = 
§
;

43 
»s
 = 
	`s_mp_sub
 (
a
, 
b
, 
c
);

47 
c
->
sign
 = (
§
 =ğ
MP_ZPOS
è? 
MP_NEG
 : MP_ZPOS;

49 
»s
 = 
	`s_mp_sub
 (
b
, 
a
, 
c
);

52  
»s
;

53 
	}
}

	@libtommath/bn_mp_sub_d.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SUB_D_C


20 
	$mp_sub_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

22 
mp_dig™
 *
tm·
, *
tmpc
, 
mu
;

23 
»s
, 
ix
, 
Şdu£d
;

26 ià(
c
->
®loc
 < 
a
->
u£d
 + 1) {

27 ià((
»s
 = 
	`mp_grow
(
c
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

28  
»s
;

35 ià(
a
->
sign
 =ğ
MP_NEG
) {

36 
a
->
sign
 = 
MP_ZPOS
;

37 
»s
 = 
	`mp_add_d
(
a
, 
b
, 
c
);

38 
a
->
sign
 = 
c
->sigÀğ
MP_NEG
;

41 
	`mp_şamp
(
c
);

43  
»s
;

47 
Şdu£d
 = 
c
->
u£d
;

48 
tm·
 = 
a
->
dp
;

49 
tmpc
 = 
c
->
dp
;

52 ià((
a
->
u£d
 =ğ1 &&‡->
dp
[0] <ğ
b
) ||‡->used == 0) {

53 ià(
a
->
u£d
 == 1) {

54 *
tmpc
++ = 
b
 - *
tm·
;

56 *
tmpc
++ = 
b
;

58 
ix
 = 1;

61 
c
->
sign
 = 
MP_NEG
;

62 
c
->
u£d
 = 1;

65 
c
->
sign
 = 
MP_ZPOS
;

66 
c
->
u£d
 = 
a
->used;

69 *
tmpc
 = *
tm·
++ - 
b
;

70 
mu
 = *
tmpc
 >> ((
mp_dig™
è* 
CHAR_BIT
 - 1);

71 *
tmpc
++ &ğ
MP_MASK
;

74 
ix
 = 1; ix < 
a
->
u£d
; ix++) {

75 *
tmpc
 = *
tm·
++ - 
mu
;

76 
mu
 = *
tmpc
 >> ((
mp_dig™
è* 
CHAR_BIT
 - 1);

77 *
tmpc
++ &ğ
MP_MASK
;

82 
ix
++ < 
Şdu£d
) {

83 *
tmpc
++ = 0;

85 
	`mp_şamp
(
c
);

86  
MP_OKAY
;

87 
	}
}

	@libtommath/bn_mp_submod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_SUBMOD_C


20 
	$mp_submod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

22 
»s
;

23 
mp_št
 
t
;

26 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

27  
»s
;

30 ià((
»s
 = 
	`mp_sub
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

31 
	`mp_ş—r
 (&
t
);

32  
»s
;

34 
»s
 = 
	`mp_mod
 (&
t
, 
c
, 
d
);

35 
	`mp_ş—r
 (&
t
);

36  
»s
;

37 
	}
}

	@libtommath/bn_mp_to_signed_bin.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TO_SIGNED_BIN_C


19 
	$mp_to_sigÃd_bš
 (
mp_št
 * 
a
, *
b
)

21 
»s
;

23 ià((
»s
 = 
	`mp_to_unsigÃd_bš
 (
a
, 
b
 + 1)è!ğ
MP_OKAY
) {

24  
»s
;

26 
b
[0] = (è((
a
->
sign
 =ğ
MP_ZPOS
) ? 0 : 1);

27  
MP_OKAY
;

28 
	}
}

	@libtommath/bn_mp_to_signed_bin_n.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TO_SIGNED_BIN_N_C


19 
	$mp_to_sigÃd_bš_n
 (
mp_št
 * 
a
, *
b
, *
ou’
)

21 ià(*
ou’
 < ()
	`mp_sigÃd_bš_size
(
a
)) {

22  
MP_VAL
;

24 *
ou’
 = 
	`mp_sigÃd_bš_size
(
a
);

25  
	`mp_to_sigÃd_bš
(
a
, 
b
);

26 
	}
}

	@libtommath/bn_mp_to_unsigned_bin.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TO_UNSIGNED_BIN_C


19 
	$mp_to_unsigÃd_bš
 (
mp_št
 * 
a
, *
b
)

21 
x
, 
»s
;

22 
mp_št
 
t
;

24 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

25  
»s
;

28 
x
 = 0;

29 
	`mp_isz”o
 (&
t
) == 0) {

30 #iâdeà
MP_8BIT


31 
b
[
x
++] = (è(
t
.
dp
[0] & 255);

33 
b
[
x
++] = (è(
t
.
dp
[0] | ((t.dp[1] & 0x01) << 7));

35 ià((
»s
 = 
	`mp_div_2d
 (&
t
, 8, &t, 
NULL
)è!ğ
MP_OKAY
) {

36 
	`mp_ş—r
 (&
t
);

37  
»s
;

40 
	`bn_»v”£
 (
b
, 
x
);

41 
	`mp_ş—r
 (&
t
);

42  
MP_OKAY
;

43 
	}
}

	@libtommath/bn_mp_to_unsigned_bin_n.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TO_UNSIGNED_BIN_N_C


19 
	$mp_to_unsigÃd_bš_n
 (
mp_št
 * 
a
, *
b
, *
ou’
)

21 ià(*
ou’
 < ()
	`mp_unsigÃd_bš_size
(
a
)) {

22  
MP_VAL
;

24 *
ou’
 = 
	`mp_unsigÃd_bš_size
(
a
);

25  
	`mp_to_unsigÃd_bš
(
a
, 
b
);

26 
	}
}

	@libtommath/bn_mp_toom_mul.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TOOM_MUL_C


25 
	$mp_toom_mul
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

27 
mp_št
 
w0
, 
w1
, 
w2
, 
w3
, 
w4
, 
tmp1
, 
tmp2
, 
a0
, 
a1
, 
a2
, 
b0
, 
b1
, 
b2
;

28 
»s
, 
B
;

31 ià((
»s
 = 
	`mp_š™_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
,

32 &
a0
, &
a1
, &
a2
, &
b0
, &
b1
,

33 &
b2
, &
tmp1
, &
tmp2
, 
NULL
)è!ğ
MP_OKAY
) {

34  
»s
;

38 
B
 = 
	`MIN
(
a
->
u£d
, 
b
->used) / 3;

41 ià((
»s
 = 
	`mp_mod_2d
(
a
, 
DIGIT_BIT
 * 
B
, &
a0
)è!ğ
MP_OKAY
) {

42 
ERR
;

45 ià((
»s
 = 
	`mp_cİy
(
a
, &
a1
)è!ğ
MP_OKAY
) {

46 
ERR
;

48 
	`mp_rshd
(&
a1
, 
B
);

49 
	`mp_mod_2d
(&
a1
, 
DIGIT_BIT
 * 
B
, &a1);

51 ià((
»s
 = 
	`mp_cİy
(
a
, &
a2
)è!ğ
MP_OKAY
) {

52 
ERR
;

54 
	`mp_rshd
(&
a2
, 
B
*2);

57 ià((
»s
 = 
	`mp_mod_2d
(
b
, 
DIGIT_BIT
 * 
B
, &
b0
)è!ğ
MP_OKAY
) {

58 
ERR
;

61 ià((
»s
 = 
	`mp_cİy
(
b
, &
b1
)è!ğ
MP_OKAY
) {

62 
ERR
;

64 
	`mp_rshd
(&
b1
, 
B
);

65 
	`mp_mod_2d
(&
b1
, 
DIGIT_BIT
 * 
B
, &b1);

67 ià((
»s
 = 
	`mp_cİy
(
b
, &
b2
)è!ğ
MP_OKAY
) {

68 
ERR
;

70 
	`mp_rshd
(&
b2
, 
B
*2);

73 ià((
»s
 = 
	`mp_mul
(&
a0
, &
b0
, &
w0
)è!ğ
MP_OKAY
) {

74 
ERR
;

78 ià((
»s
 = 
	`mp_mul
(&
a2
, &
b2
, &
w4
)è!ğ
MP_OKAY
) {

79 
ERR
;

83 ià((
»s
 = 
	`mp_mul_2
(&
a0
, &
tmp1
)è!ğ
MP_OKAY
) {

84 
ERR
;

86 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

87 
ERR
;

89 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

90 
ERR
;

92 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a2
, &tmp1)è!ğ
MP_OKAY
) {

93 
ERR
;

96 ià((
»s
 = 
	`mp_mul_2
(&
b0
, &
tmp2
)è!ğ
MP_OKAY
) {

97 
ERR
;

99 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b1
, &tmp2)è!ğ
MP_OKAY
) {

100 
ERR
;

102 ià((
»s
 = 
	`mp_mul_2
(&
tmp2
, &tmp2)è!ğ
MP_OKAY
) {

103 
ERR
;

105 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b2
, &tmp2)è!ğ
MP_OKAY
) {

106 
ERR
;

109 ià((
»s
 = 
	`mp_mul
(&
tmp1
, &
tmp2
, &
w1
)è!ğ
MP_OKAY
) {

110 
ERR
;

114 ià((
»s
 = 
	`mp_mul_2
(&
a2
, &
tmp1
)è!ğ
MP_OKAY
) {

115 
ERR
;

117 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

118 
ERR
;

120 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

121 
ERR
;

123 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

124 
ERR
;

127 ià((
»s
 = 
	`mp_mul_2
(&
b2
, &
tmp2
)è!ğ
MP_OKAY
) {

128 
ERR
;

130 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b1
, &tmp2)è!ğ
MP_OKAY
) {

131 
ERR
;

133 ià((
»s
 = 
	`mp_mul_2
(&
tmp2
, &tmp2)è!ğ
MP_OKAY
) {

134 
ERR
;

136 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b0
, &tmp2)è!ğ
MP_OKAY
) {

137 
ERR
;

140 ià((
»s
 = 
	`mp_mul
(&
tmp1
, &
tmp2
, &
w3
)è!ğ
MP_OKAY
) {

141 
ERR
;

146 ià((
»s
 = 
	`mp_add
(&
a2
, &
a1
, &
tmp1
)è!ğ
MP_OKAY
) {

147 
ERR
;

149 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

150 
ERR
;

152 ià((
»s
 = 
	`mp_add
(&
b2
, &
b1
, &
tmp2
)è!ğ
MP_OKAY
) {

153 
ERR
;

155 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b0
, &tmp2)è!ğ
MP_OKAY
) {

156 
ERR
;

158 ià((
»s
 = 
	`mp_mul
(&
tmp1
, &
tmp2
, &
w2
)è!ğ
MP_OKAY
) {

159 
ERR
;

175 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w4
, &w1)è!ğ
MP_OKAY
) {

176 
ERR
;

179 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w0
, &w3)è!ğ
MP_OKAY
) {

180 
ERR
;

183 ià((
»s
 = 
	`mp_div_2
(&
w1
, &w1)è!ğ
MP_OKAY
) {

184 
ERR
;

187 ià((
»s
 = 
	`mp_div_2
(&
w3
, &w3)è!ğ
MP_OKAY
) {

188 
ERR
;

191 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w0
, &w2)è!ğ
MP_OKAY
) {

192 
ERR
;

194 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w4
, &w2)è!ğ
MP_OKAY
) {

195 
ERR
;

198 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

199 
ERR
;

202 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

203 
ERR
;

206 ià((
»s
 = 
	`mp_mul_2d
(&
w0
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

207 
ERR
;

209 ià((
»s
 = 
	`mp_sub
(&
w1
, &
tmp1
, &w1)è!ğ
MP_OKAY
) {

210 
ERR
;

213 ià((
»s
 = 
	`mp_mul_2d
(&
w4
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

214 
ERR
;

216 ià((
»s
 = 
	`mp_sub
(&
w3
, &
tmp1
, &w3)è!ğ
MP_OKAY
) {

217 
ERR
;

220 ià((
»s
 = 
	`mp_mul_d
(&
w2
, 3, &w2)è!ğ
MP_OKAY
) {

221 
ERR
;

223 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w1
, &w2)è!ğ
MP_OKAY
) {

224 
ERR
;

226 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w3
, &w2)è!ğ
MP_OKAY
) {

227 
ERR
;

230 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

231 
ERR
;

234 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

235 
ERR
;

238 ià((
»s
 = 
	`mp_div_3
(&
w1
, &w1, 
NULL
)è!ğ
MP_OKAY
) {

239 
ERR
;

242 ià((
»s
 = 
	`mp_div_3
(&
w3
, &w3, 
NULL
)è!ğ
MP_OKAY
) {

243 
ERR
;

247 ià((
»s
 = 
	`mp_lshd
(&
w1
, 1*
B
)è!ğ
MP_OKAY
) {

248 
ERR
;

250 ià((
»s
 = 
	`mp_lshd
(&
w2
, 2*
B
)è!ğ
MP_OKAY
) {

251 
ERR
;

253 ià((
»s
 = 
	`mp_lshd
(&
w3
, 3*
B
)è!ğ
MP_OKAY
) {

254 
ERR
;

256 ià((
»s
 = 
	`mp_lshd
(&
w4
, 4*
B
)è!ğ
MP_OKAY
) {

257 
ERR
;

260 ià((
»s
 = 
	`mp_add
(&
w0
, &
w1
, 
c
)è!ğ
MP_OKAY
) {

261 
ERR
;

263 ià((
»s
 = 
	`mp_add
(&
w2
, &
w3
, &
tmp1
)è!ğ
MP_OKAY
) {

264 
ERR
;

266 ià((
»s
 = 
	`mp_add
(&
w4
, &
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

267 
ERR
;

269 ià((
»s
 = 
	`mp_add
(&
tmp1
, 
c
, c)è!ğ
MP_OKAY
) {

270 
ERR
;

273 
ERR
:

274 
	`mp_ş—r_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
,

275 &
a0
, &
a1
, &
a2
, &
b0
, &
b1
,

276 &
b2
, &
tmp1
, &
tmp2
, 
NULL
);

277  
»s
;

278 
	}
}

	@libtommath/bn_mp_toom_sqr.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TOOM_SQR_C


20 
	$mp_toom_sqr
(
mp_št
 *
a
, mp_šˆ*
b
)

22 
mp_št
 
w0
, 
w1
, 
w2
, 
w3
, 
w4
, 
tmp1
, 
a0
, 
a1
, 
a2
;

23 
»s
, 
B
;

26 ià((
»s
 = 
	`mp_š™_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
, &
a0
, &
a1
, &
a2
, &
tmp1
, 
NULL
)è!ğ
MP_OKAY
) {

27  
»s
;

31 
B
 = 
a
->
u£d
 / 3;

34 ià((
»s
 = 
	`mp_mod_2d
(
a
, 
DIGIT_BIT
 * 
B
, &
a0
)è!ğ
MP_OKAY
) {

35 
ERR
;

38 ià((
»s
 = 
	`mp_cİy
(
a
, &
a1
)è!ğ
MP_OKAY
) {

39 
ERR
;

41 
	`mp_rshd
(&
a1
, 
B
);

42 
	`mp_mod_2d
(&
a1
, 
DIGIT_BIT
 * 
B
, &a1);

44 ià((
»s
 = 
	`mp_cİy
(
a
, &
a2
)è!ğ
MP_OKAY
) {

45 
ERR
;

47 
	`mp_rshd
(&
a2
, 
B
*2);

50 ià((
»s
 = 
	`mp_sqr
(&
a0
, &
w0
)è!ğ
MP_OKAY
) {

51 
ERR
;

55 ià((
»s
 = 
	`mp_sqr
(&
a2
, &
w4
)è!ğ
MP_OKAY
) {

56 
ERR
;

60 ià((
»s
 = 
	`mp_mul_2
(&
a0
, &
tmp1
)è!ğ
MP_OKAY
) {

61 
ERR
;

63 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

64 
ERR
;

66 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

67 
ERR
;

69 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a2
, &tmp1)è!ğ
MP_OKAY
) {

70 
ERR
;

73 ià((
»s
 = 
	`mp_sqr
(&
tmp1
, &
w1
)è!ğ
MP_OKAY
) {

74 
ERR
;

78 ià((
»s
 = 
	`mp_mul_2
(&
a2
, &
tmp1
)è!ğ
MP_OKAY
) {

79 
ERR
;

81 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

82 
ERR
;

84 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

85 
ERR
;

87 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

88 
ERR
;

91 ià((
»s
 = 
	`mp_sqr
(&
tmp1
, &
w3
)è!ğ
MP_OKAY
) {

92 
ERR
;

97 ià((
»s
 = 
	`mp_add
(&
a2
, &
a1
, &
tmp1
)è!ğ
MP_OKAY
) {

98 
ERR
;

100 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

101 
ERR
;

103 ià((
»s
 = 
	`mp_sqr
(&
tmp1
, &
w2
)è!ğ
MP_OKAY
) {

104 
ERR
;

119 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w4
, &w1)è!ğ
MP_OKAY
) {

120 
ERR
;

123 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w0
, &w3)è!ğ
MP_OKAY
) {

124 
ERR
;

127 ià((
»s
 = 
	`mp_div_2
(&
w1
, &w1)è!ğ
MP_OKAY
) {

128 
ERR
;

131 ià((
»s
 = 
	`mp_div_2
(&
w3
, &w3)è!ğ
MP_OKAY
) {

132 
ERR
;

135 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w0
, &w2)è!ğ
MP_OKAY
) {

136 
ERR
;

138 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w4
, &w2)è!ğ
MP_OKAY
) {

139 
ERR
;

142 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

143 
ERR
;

146 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

147 
ERR
;

150 ià((
»s
 = 
	`mp_mul_2d
(&
w0
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

151 
ERR
;

153 ià((
»s
 = 
	`mp_sub
(&
w1
, &
tmp1
, &w1)è!ğ
MP_OKAY
) {

154 
ERR
;

157 ià((
»s
 = 
	`mp_mul_2d
(&
w4
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

158 
ERR
;

160 ià((
»s
 = 
	`mp_sub
(&
w3
, &
tmp1
, &w3)è!ğ
MP_OKAY
) {

161 
ERR
;

164 ià((
»s
 = 
	`mp_mul_d
(&
w2
, 3, &w2)è!ğ
MP_OKAY
) {

165 
ERR
;

167 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w1
, &w2)è!ğ
MP_OKAY
) {

168 
ERR
;

170 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w3
, &w2)è!ğ
MP_OKAY
) {

171 
ERR
;

174 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

175 
ERR
;

178 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

179 
ERR
;

182 ià((
»s
 = 
	`mp_div_3
(&
w1
, &w1, 
NULL
)è!ğ
MP_OKAY
) {

183 
ERR
;

186 ià((
»s
 = 
	`mp_div_3
(&
w3
, &w3, 
NULL
)è!ğ
MP_OKAY
) {

187 
ERR
;

191 ià((
»s
 = 
	`mp_lshd
(&
w1
, 1*
B
)è!ğ
MP_OKAY
) {

192 
ERR
;

194 ià((
»s
 = 
	`mp_lshd
(&
w2
, 2*
B
)è!ğ
MP_OKAY
) {

195 
ERR
;

197 ià((
»s
 = 
	`mp_lshd
(&
w3
, 3*
B
)è!ğ
MP_OKAY
) {

198 
ERR
;

200 ià((
»s
 = 
	`mp_lshd
(&
w4
, 4*
B
)è!ğ
MP_OKAY
) {

201 
ERR
;

204 ià((
»s
 = 
	`mp_add
(&
w0
, &
w1
, 
b
)è!ğ
MP_OKAY
) {

205 
ERR
;

207 ià((
»s
 = 
	`mp_add
(&
w2
, &
w3
, &
tmp1
)è!ğ
MP_OKAY
) {

208 
ERR
;

210 ià((
»s
 = 
	`mp_add
(&
w4
, &
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

211 
ERR
;

213 ià((
»s
 = 
	`mp_add
(&
tmp1
, 
b
, b)è!ğ
MP_OKAY
) {

214 
ERR
;

217 
ERR
:

218 
	`mp_ş—r_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
, &
a0
, &
a1
, &
a2
, &
tmp1
, 
NULL
);

219  
»s
;

220 
	}
}

	@libtommath/bn_mp_toradix.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TORADIX_C


19 
	$mp_tÜadix
 (
mp_št
 * 
a
, *
¡r
, 
¿dix
)

21 
»s
, 
digs
;

22 
mp_št
 
t
;

23 
mp_dig™
 
d
;

24 *
_s
 = 
¡r
;

27 ià(
¿dix
 < 2 ||„adix > 64) {

28  
MP_VAL
;

32 ià(
	`mp_isz”o
(
a
) == 1) {

33 *
¡r
++ = '0';

34 *
¡r
 = '\0';

35  
MP_OKAY
;

38 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

39  
»s
;

43 ià(
t
.
sign
 =ğ
MP_NEG
) {

44 ++
_s
;

45 *
¡r
++ = '-';

46 
t
.
sign
 = 
MP_ZPOS
;

49 
digs
 = 0;

50 
	`mp_isz”o
 (&
t
) == 0) {

51 ià((
»s
 = 
	`mp_div_d
 (&
t
, (
mp_dig™
è
¿dix
, &t, &
d
)è!ğ
MP_OKAY
) {

52 
	`mp_ş—r
 (&
t
);

53  
»s
;

55 *
¡r
++ = 
mp_s_rm­
[
d
];

56 ++
digs
;

62 
	`bn_»v”£
 ((*)
_s
, 
digs
);

65 *
¡r
 = '\0';

67 
	`mp_ş—r
 (&
t
);

68  
MP_OKAY
;

69 
	}
}

	@libtommath/bn_mp_toradix_n.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_TORADIX_N_C


22 
	$mp_tÜadix_n
(
mp_št
 * 
a
, *
¡r
, 
¿dix
, 
maxËn
)

24 
»s
, 
digs
;

25 
mp_št
 
t
;

26 
mp_dig™
 
d
;

27 *
_s
 = 
¡r
;

30 ià(
maxËn
 < 2 || 
¿dix
 < 2 ||„adix > 64) {

31  
MP_VAL
;

35 ià(
	`mp_isz”o
(
a
è=ğ
MP_YES
) {

36 *
¡r
++ = '0';

37 *
¡r
 = '\0';

38  
MP_OKAY
;

41 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

42  
»s
;

46 ià(
t
.
sign
 =ğ
MP_NEG
) {

48 ++
_s
;

51 *
¡r
++ = '-';

52 
t
.
sign
 = 
MP_ZPOS
;

55 --
maxËn
;

58 
digs
 = 0;

59 
	`mp_isz”o
 (&
t
) == 0) {

60 ià(--
maxËn
 < 1) {

64 ià((
»s
 = 
	`mp_div_d
 (&
t
, (
mp_dig™
è
¿dix
, &t, &
d
)è!ğ
MP_OKAY
) {

65 
	`mp_ş—r
 (&
t
);

66  
»s
;

68 *
¡r
++ = 
mp_s_rm­
[
d
];

69 ++
digs
;

75 
	`bn_»v”£
 ((*)
_s
, 
digs
);

78 *
¡r
 = '\0';

80 
	`mp_ş—r
 (&
t
);

81  
MP_OKAY
;

82 
	}
}

	@libtommath/bn_mp_unsigned_bin_size.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_UNSIGNED_BIN_SIZE_C


19 
	$mp_unsigÃd_bš_size
 (
mp_št
 * 
a
)

21 
size
 = 
	`mp_couÁ_b™s
 (
a
);

22  (
size
 / 8 + ((size & 7) != 0 ? 1 : 0));

23 
	}
}

	@libtommath/bn_mp_xor.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_XOR_C


20 
	$mp_xÜ
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 
»s
, 
ix
, 
px
;

23 
mp_št
 
t
, *
x
;

25 ià(
a
->
u£d
 > 
b
->used) {

26 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

27  
»s
;

29 
px
 = 
b
->
u£d
;

30 
x
 = 
b
;

32 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
b
)è!ğ
MP_OKAY
) {

33  
»s
;

35 
px
 = 
a
->
u£d
;

36 
x
 = 
a
;

39 
ix
 = 0; ix < 
px
; ix++) {

40 
t
.
dp
[
ix
] ^ğ
x
->dp[ix];

42 
	`mp_şamp
 (&
t
);

43 
	`mp_exch
 (
c
, &
t
);

44 
	`mp_ş—r
 (&
t
);

45  
MP_OKAY
;

46 
	}
}

	@libtommath/bn_mp_zero.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_MP_ZERO_C


19 
	$mp_z”o
 (
mp_št
 * 
a
)

21 
n
;

22 
mp_dig™
 *
tmp
;

24 
a
->
sign
 = 
MP_ZPOS
;

25 
a
->
u£d
 = 0;

27 
tmp
 = 
a
->
dp
;

28 
n
 = 0;‚ < 
a
->
®loc
;‚++) {

29 *
tmp
++ = 0;

31 
	}
}

	@libtommath/bn_prime_tab.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_PRIME_TAB_C


17 cÚ¡ 
mp_dig™
 
	gÉm_´ime_b
[] = {

22 #iâdeà
MP_8BIT


	@libtommath/bn_reverse.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_REVERSE_C


20 
	$bn_»v”£
 (*
s
, 
Ën
)

22 
ix
, 
iy
;

23 
t
;

25 
ix
 = 0;

26 
iy
 = 
Ën
 - 1;

27 
ix
 < 
iy
) {

28 
t
 = 
s
[
ix
];

29 
s
[
ix
] = s[
iy
];

30 
s
[
iy
] = 
t
;

31 ++
ix
;

32 --
iy
;

34 
	}
}

	@libtommath/bn_s_mp_add.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_S_MP_ADD_C


20 
	$s_mp_add
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 
mp_št
 *
x
;

23 
Şdu£
, 
»s
, 
mš
, 
max
;

28 ià(
a
->
u£d
 > 
b
->used) {

29 
mš
 = 
b
->
u£d
;

30 
max
 = 
a
->
u£d
;

31 
x
 = 
a
;

33 
mš
 = 
a
->
u£d
;

34 
max
 = 
b
->
u£d
;

35 
x
 = 
b
;

39 ià(
c
->
®loc
 < 
max
 + 1) {

40 ià((
»s
 = 
	`mp_grow
 (
c
, 
max
 + 1)è!ğ
MP_OKAY
) {

41  
»s
;

46 
Şdu£
 = 
c
->
u£d
;

47 
c
->
u£d
 = 
max
 + 1;

50 
mp_dig™
 
u
, *
tm·
, *
tmpb
, *
tmpc
;

51 
i
;

56 
tm·
 = 
a
->
dp
;

59 
tmpb
 = 
b
->
dp
;

62 
tmpc
 = 
c
->
dp
;

65 
u
 = 0;

66 
i
 = 0; i < 
mš
; i++) {

68 *
tmpc
 = *
tm·
++ + *
tmpb
++ + 
u
;

71 
u
 = *
tmpc
 >> ((
mp_dig™
)
DIGIT_BIT
);

74 *
tmpc
++ &ğ
MP_MASK
;

80 ià(
mš
 !ğ
max
) {

81 ; 
i
 < 
max
; i++) {

83 *
tmpc
 = 
x
->
dp
[
i
] + 
u
;

86 
u
 = *
tmpc
 >> ((
mp_dig™
)
DIGIT_BIT
);

89 *
tmpc
++ &ğ
MP_MASK
;

94 *
tmpc
++ = 
u
;

97 
i
 = 
c
->
u£d
; i < 
Şdu£
; i++) {

98 *
tmpc
++ = 0;

102 
	`mp_şamp
 (
c
);

103  
MP_OKAY
;

104 
	}
}

	@libtommath/bn_s_mp_exptmod.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_S_MP_EXPTMOD_C


17 #ifdeà
MP_LOW_MEM


18 
	#TAB_SIZE
 32

	)

20 
	#TAB_SIZE
 256

	)

23 
	$s_mp_ex±mod
 (
mp_št
 * 
G
, mp_šˆ* 
X
, mp_šˆ* 
P
, mp_šˆ* 
Y
, 
»dmode
)

25 
mp_št
 
M
[
TAB_SIZE
], 
»s
, 
mu
;

26 
mp_dig™
 
buf
;

27 
”r
, 
b™buf
, 
b™ıy
, 
b™út
, 
mode
, 
digidx
, 
x
, 
y
, 
wšsize
;

28 (*
»dux
)(
mp_št
*,mp_int*,mp_int*);

31 
x
 = 
	`mp_couÁ_b™s
 (
X
);

32 ià(
x
 <= 7) {

33 
wšsize
 = 2;

34 } ià(
x
 <= 36) {

35 
wšsize
 = 3;

36 } ià(
x
 <= 140) {

37 
wšsize
 = 4;

38 } ià(
x
 <= 450) {

39 
wšsize
 = 5;

40 } ià(
x
 <= 1303) {

41 
wšsize
 = 6;

42 } ià(
x
 <= 3529) {

43 
wšsize
 = 7;

45 
wšsize
 = 8;

48 #ifdeà
MP_LOW_MEM


49 ià(
wšsize
 > 5) {

50 
wšsize
 = 5;

56 ià((
”r
 = 
	`mp_š™
(&
M
[1])è!ğ
MP_OKAY
) {

57  
”r
;

61 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

62 ià((
”r
 = 
	`mp_š™
(&
M
[
x
])è!ğ
MP_OKAY
) {

63 
y
 = 1<<(
wšsize
-1); y < 
x
; y++) {

64 
	`mp_ş—r
 (&
M
[
y
]);

66 
	`mp_ş—r
(&
M
[1]);

67  
”r
;

72 ià((
”r
 = 
	`mp_š™
 (&
mu
)è!ğ
MP_OKAY
) {

73 
LBL_M
;

76 ià(
»dmode
 == 0) {

77 ià((
”r
 = 
	`mp_»duû_£tup
 (&
mu
, 
P
)è!ğ
MP_OKAY
) {

78 
LBL_MU
;

80 
»dux
 = 
mp_»duû
;

82 ià((
”r
 = 
	`mp_»duû_2k_£tup_l
 (
P
, &
mu
)è!ğ
MP_OKAY
) {

83 
LBL_MU
;

85 
»dux
 = 
mp_»duû_2k_l
;

96 ià((
”r
 = 
	`mp_mod
 (
G
, 
P
, &
M
[1])è!ğ
MP_OKAY
) {

97 
LBL_MU
;

103 ià((
”r
 = 
	`mp_cİy
 (&
M
[1], &M[1 << (
wšsize
 - 1)])è!ğ
MP_OKAY
) {

104 
LBL_MU
;

107 
x
 = 0; x < (
wšsize
 - 1); x++) {

109 ià((
”r
 = 
	`mp_sqr
 (&
M
[1 << (
wšsize
 - 1)],

110 &
M
[1 << (
wšsize
 - 1)])è!ğ
MP_OKAY
) {

111 
LBL_MU
;

115 ià((
”r
 = 
	`»dux
 (&
M
[1 << (
wšsize
 - 1)], 
P
, &
mu
)è!ğ
MP_OKAY
) {

116 
LBL_MU
;

123 
x
 = (1 << (
wšsize
 - 1)) + 1; x < (1 << winsize); x++) {

124 ià((
”r
 = 
	`mp_mul
 (&
M
[
x
 - 1], &M[1], &M[x])è!ğ
MP_OKAY
) {

125 
LBL_MU
;

127 ià((
”r
 = 
	`»dux
 (&
M
[
x
], 
P
, &
mu
)è!ğ
MP_OKAY
) {

128 
LBL_MU
;

133 ià((
”r
 = 
	`mp_š™
 (&
»s
)è!ğ
MP_OKAY
) {

134 
LBL_MU
;

136 
	`mp_£t
 (&
»s
, 1);

139 
mode
 = 0;

140 
b™út
 = 1;

141 
buf
 = 0;

142 
digidx
 = 
X
->
u£d
 - 1;

143 
b™ıy
 = 0;

144 
b™buf
 = 0;

148 ià(--
b™út
 == 0) {

150 ià(
digidx
 == -1) {

154 
buf
 = 
X
->
dp
[
digidx
--];

155 
b™út
 = (è
DIGIT_BIT
;

159 
y
 = (
buf
 >> (
mp_dig™
)(
DIGIT_BIT
 - 1)) & 1;

160 
buf
 <<ğ(
mp_dig™
)1;

167 ià(
mode
 =ğ0 && 
y
 == 0) {

172 ià(
mode
 =ğ1 && 
y
 == 0) {

173 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

174 
LBL_RES
;

176 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

177 
LBL_RES
;

183 
b™buf
 |ğ(
y
 << (
wšsize
 - ++
b™ıy
));

184 
mode
 = 2;

186 ià(
b™ıy
 =ğ
wšsize
) {

189 
x
 = 0; x < 
wšsize
; x++) {

190 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

191 
LBL_RES
;

193 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

194 
LBL_RES
;

199 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[
b™buf
], &»s)è!ğ
MP_OKAY
) {

200 
LBL_RES
;

202 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

203 
LBL_RES
;

207 
b™ıy
 = 0;

208 
b™buf
 = 0;

209 
mode
 = 1;

214 ià(
mode
 =ğ2 && 
b™ıy
 > 0) {

216 
x
 = 0; x < 
b™ıy
; x++) {

217 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

218 
LBL_RES
;

220 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

221 
LBL_RES
;

224 
b™buf
 <<= 1;

225 ià((
b™buf
 & (1 << 
wšsize
)) != 0) {

227 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[1], &»s)è!ğ
MP_OKAY
) {

228 
LBL_RES
;

230 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

231 
LBL_RES
;

237 
	`mp_exch
 (&
»s
, 
Y
);

238 
”r
 = 
MP_OKAY
;

239 
LBL_RES
:
	`mp_ş—r
 (&
»s
);

240 
LBL_MU
:
	`mp_ş—r
 (&
mu
);

241 
LBL_M
:

242 
	`mp_ş—r
(&
M
[1]);

243 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

244 
	`mp_ş—r
 (&
M
[
x
]);

246  
”r
;

247 
	}
}

	@libtommath/bn_s_mp_mul_digs.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_S_MP_MUL_DIGS_C


22 
	$s_mp_mul_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

24 
mp_št
 
t
;

25 
»s
, 
·
, 
pb
, 
ix
, 
iy
;

26 
mp_dig™
 
u
;

27 
mp_wÜd
 
r
;

28 
mp_dig™
 
tmpx
, *
tm±
, *
tmpy
;

31 ià(((
digs
è< 
MP_WARRAY
) &&

32 
	`MIN
 (
a
->
u£d
, 
b
->used) <

33 (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

34  
	`ç¡_s_mp_mul_digs
 (
a
, 
b
, 
c
, 
digs
);

37 ià((
»s
 = 
	`mp_š™_size
 (&
t
, 
digs
)è!ğ
MP_OKAY
) {

38  
»s
;

40 
t
.
u£d
 = 
digs
;

43 
·
 = 
a
->
u£d
;

44 
ix
 = 0; ix < 
·
; ix++) {

46 
u
 = 0;

49 
pb
 = 
	`MIN
 (
b
->
u£d
, 
digs
 - 
ix
);

53 
tmpx
 = 
a
->
dp
[
ix
];

56 
tm±
 = 
t
.
dp
 + 
ix
;

59 
tmpy
 = 
b
->
dp
;

62 
iy
 = 0; iy < 
pb
; iy++) {

64 
r
 = ((
mp_wÜd
)*
tm±
) +

65 ((
mp_wÜd
)
tmpx
è* ((mp_wÜd)*
tmpy
++) +

66 ((
mp_wÜd
è
u
);

69 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

72 
u
 = (
mp_dig™
è(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

75 ià(
ix
 + 
iy
 < 
digs
) {

76 *
tm±
 = 
u
;

80 
	`mp_şamp
 (&
t
);

81 
	`mp_exch
 (&
t
, 
c
);

83 
	`mp_ş—r
 (&
t
);

84  
MP_OKAY
;

85 
	}
}

	@libtommath/bn_s_mp_mul_high_digs.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_S_MP_MUL_HIGH_DIGS_C


22 
	$s_mp_mul_high_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

24 
mp_št
 
t
;

25 
»s
, 
·
, 
pb
, 
ix
, 
iy
;

26 
mp_dig™
 
u
;

27 
mp_wÜd
 
r
;

28 
mp_dig™
 
tmpx
, *
tm±
, *
tmpy
;

31 #ifdeà
BN_FAST_S_MP_MUL_HIGH_DIGS_C


32 ià(((
a
->
u£d
 + 
b
->u£d + 1è< 
MP_WARRAY
)

33 && 
	`MIN
 (
a
->
u£d
, 
b
->u£dè< (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

34  
	`ç¡_s_mp_mul_high_digs
 (
a
, 
b
, 
c
, 
digs
);

38 ià((
»s
 = 
	`mp_š™_size
 (&
t
, 
a
->
u£d
 + 
b
->u£d + 1)è!ğ
MP_OKAY
) {

39  
»s
;

41 
t
.
u£d
 = 
a
->u£d + 
b
->used + 1;

43 
·
 = 
a
->
u£d
;

44 
pb
 = 
b
->
u£d
;

45 
ix
 = 0; ix < 
·
; ix++) {

47 
u
 = 0;

50 
tmpx
 = 
a
->
dp
[
ix
];

53 
tm±
 = &(
t
.
dp
[
digs
]);

56 
tmpy
 = 
b
->
dp
 + (
digs
 - 
ix
);

58 
iy
 = 
digs
 - 
ix
; iy < 
pb
; iy++) {

60 
r
 = ((
mp_wÜd
)*
tm±
) +

61 ((
mp_wÜd
)
tmpx
è* ((mp_wÜd)*
tmpy
++) +

62 ((
mp_wÜd
è
u
);

65 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

68 
u
 = (
mp_dig™
è(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

70 *
tm±
 = 
u
;

72 
	`mp_şamp
 (&
t
);

73 
	`mp_exch
 (&
t
, 
c
);

74 
	`mp_ş—r
 (&
t
);

75  
MP_OKAY
;

76 
	}
}

	@libtommath/bn_s_mp_sqr.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_S_MP_SQR_C


19 
	$s_mp_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

21 
mp_št
 
t
;

22 
»s
, 
ix
, 
iy
, 
·
;

23 
mp_wÜd
 
r
;

24 
mp_dig™
 
u
, 
tmpx
, *
tm±
;

26 
·
 = 
a
->
u£d
;

27 ià((
»s
 = 
	`mp_š™_size
 (&
t
, 2*
·
 + 1)è!ğ
MP_OKAY
) {

28  
»s
;

32 
t
.
u£d
 = 2*
·
 + 1;

34 
ix
 = 0; ix < 
·
; ix++) {

37 
r
 = ((
mp_wÜd
è
t
.
dp
[2*
ix
]) +

38 ((
mp_wÜd
)
a
->
dp
[
ix
])*((mp_word)a->dp[ix]);

41 
t
.
dp
[
ix
+ix] = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

44 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

47 
tmpx
 = 
a
->
dp
[
ix
];

50 
tm±
 = 
t
.
dp
 + (2*
ix
 + 1);

52 
iy
 = 
ix
 + 1; iy < 
·
; iy++) {

54 
r
 = ((
mp_wÜd
)
tmpx
è* ((mp_wÜd)
a
->
dp
[
iy
]);

59 
r
 = ((
mp_wÜd
è*
tm±
è+„ +„ + ((mp_wÜdè
u
);

62 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

65 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

68 
u
 !ğ((
mp_dig™
) 0)) {

69 
r
 = ((
mp_wÜd
è*
tm±
è+ ((mp_wÜdè
u
);

70 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

71 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

75 
	`mp_şamp
 (&
t
);

76 
	`mp_exch
 (&
t
, 
b
);

77 
	`mp_ş—r
 (&
t
);

78  
MP_OKAY
;

79 
	}
}

	@libtommath/bn_s_mp_sub.c

1 
	~<tomm©h.h
>

2 #ifdeà
BN_S_MP_SUB_C


20 
	$s_mp_sub
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

22 
Şdu£
, 
»s
, 
mš
, 
max
;

25 
mš
 = 
b
->
u£d
;

26 
max
 = 
a
->
u£d
;

29 ià(
c
->
®loc
 < 
max
) {

30 ià((
»s
 = 
	`mp_grow
 (
c
, 
max
)è!ğ
MP_OKAY
) {

31  
»s
;

34 
Şdu£
 = 
c
->
u£d
;

35 
c
->
u£d
 = 
max
;

38 
mp_dig™
 
u
, *
tm·
, *
tmpb
, *
tmpc
;

39 
i
;

42 
tm·
 = 
a
->
dp
;

43 
tmpb
 = 
b
->
dp
;

44 
tmpc
 = 
c
->
dp
;

47 
u
 = 0;

48 
i
 = 0; i < 
mš
; i++) {

50 *
tmpc
 = *
tm·
++ - *
tmpb
++ - 
u
;

57 
u
 = *
tmpc
 >> ((
mp_dig™
)(
CHAR_BIT
 *  (mp_digit) - 1));

60 *
tmpc
++ &ğ
MP_MASK
;

64 ; 
i
 < 
max
; i++) {

66 *
tmpc
 = *
tm·
++ - 
u
;

69 
u
 = *
tmpc
 >> ((
mp_dig™
)(
CHAR_BIT
 *  (mp_digit) - 1));

72 *
tmpc
++ &ğ
MP_MASK
;

76 
i
 = 
c
->
u£d
; i < 
Şdu£
; i++) {

77 *
tmpc
++ = 0;

81 
	`mp_şamp
 (
c
);

82  
MP_OKAY
;

83 
	}
}

	@libtommath/bncore.c

1 
	~<tomm©h.h
>

2 #ifdeà
BNCORE_C


27 
	gKARATSUBA_MUL_CUTOFF
 = 80,

28 
	gKARATSUBA_SQR_CUTOFF
 = 120,

30 
	gTOOM_MUL_CUTOFF
 = 350,

31 
	gTOOM_SQR_CUTOFF
 = 400;

	@libtommath/demo/demo.c

1 
	~<time.h
>

3 #ifdeà
IOWNANATHLON


4 
	~<uni¡d.h
>

5 
	#SLEEP
 
	`¦“p
(4)

	)

7 
	#SLEEP


	)

10 
	~"tomm©h.h
"

12 
	$nd¿w
(
mp_št
 * 
a
, *
Çme
)

14 
buf
[16000];

16 
	`´štf
("%s: ", 
Çme
);

17 
	`mp_tÜadix
(
a
, 
buf
, 10);

18 
	`´štf
("%s\n", 
buf
);

19 
	}
}

21 
	$d¿w
(
mp_št
 * 
a
)

23 
	`nd¿w
(
a
, "");

24 
	}
}

27 
	glf¤
 = 0xAAAAAAAAUL;

29 
	$lb™
()

31 ià(
lf¤
 & 0x80000000UL) {

32 
lf¤
 = ((lfsr << 1) ^ 0x8000001BUL) & 0xFFFFFFFFUL;

35 
lf¤
 <<= 1;

38 
	}
}

40 
	$myºg
(*
d¡
, 
Ën
, *
d©
)

42 
x
;

44 
x
 = 0; x < 
Ën
; x++)

45 
d¡
[
x
] = 
	`¿nd
() & 0xFF;

46  
Ën
;

47 
	}
}

51 
	gcmd
[4096], 
	gbuf
[4096];

52 
	$maš
()

54 
mp_št
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
;

55 
ex±_n
, 
add_n
, 
sub_n
, 
mul_n
, 
div_n
, 
sqr_n
, 
mul2d_n
, 
div2d_n
,

56 
gcd_n
, 
lcm_n
, 
šv_n
, 
div2_n
, 
mul2_n
, 
add_d_n
, 
sub_d_n
, 
t
;

57 
¼
;

58 
i
, 
n
, 
”r
, 
út
, 
ix
, 
Şd_k¬a_m
, 
Şd_k¬a_s
;

59 
mp_dig™
 
mp
;

62 
	`mp_š™
(&
a
);

63 
	`mp_š™
(&
b
);

64 
	`mp_š™
(&
c
);

65 
	`mp_š™
(&
d
);

66 
	`mp_š™
(&
e
);

67 
	`mp_š™
(&
f
);

69 
	`¤ªd
(
	`time
(
NULL
));

73 
	`´štf
("Testing montgomery...\n");

74 
i
 = 1; i < 10; i++) {

75 
	`´štf
("Te¡šg dig™ size: %d\n", 
i
);

76 
n
 = 0;‚ < 1000;‚++) {

77 
	`mp_¿nd
(&
a
, 
i
);

78 
a
.
dp
[0] |= 1;

81 
	`mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
(&
b
, &
a
);

82 
	`mp_mÚtgom”y_£tup
(&
a
, &
mp
);

85 
ix
 = 0; ix < 100; ix++) {

86 
	`mp_¿nd
(&
c
, 1 + 
	`abs
(
	`¿nd
()è% (2*
i
));

87 
	`mp_cİy
(&
c
, &
d
);

88 
	`mp_cİy
(&
c
, &
e
);

90 
	`mp_mod
(&
d
, &
a
, &d);

91 
	`mp_mÚtgom”y_»duû
(&
c
, &
a
, 
mp
);

92 
	`mp_mulmod
(&
c
, &
b
, &
a
, &c);

94 ià(
	`mp_cmp
(&
c
, &
d
è!ğ
MP_EQ
) {

95 
	`´štf
("d =ƒ mod‡, c =ƒ MOD‡\n");

96 
	`mp_todecim®
(&
a
, 
buf
); 
	`´štf
("a = %s\n", buf);

97 
	`mp_todecim®
(&
e
, 
buf
); 
	`´štf
("e = %s\n", buf);

98 
	`mp_todecim®
(&
d
, 
buf
); 
	`´štf
("d = %s\n", buf);

99 
	`mp_todecim®
(&
c
, 
buf
); 
	`´štf
("c = %s\n", buf);

100 
	`´štf
("com·»‚Øcom·»!\n"); 
	`ex™
(
EXIT_FAILURE
); }

104 
	`´štf
("done\n");

107 
	`´štf
("Testing: mp_get_int\n");

108 
i
 = 0; i < 1000; ++i) {

109 
t
 = ((è
	`¿nd
() *„and() + 1) & 0xFFFFFFFF;

110 
	`mp_£t_št
(&
a
, 
t
);

111 ià(
t
 !ğ
	`mp_g‘_št
(&
a
)) {

112 
	`´štf
("mp_get_int() bad„esult!\n");

116 
	`mp_£t_št
(&
a
, 0);

117 ià(
	`mp_g‘_št
(&
a
) != 0) {

118 
	`´štf
("mp_get_int() bad„esult!\n");

121 
	`mp_£t_št
(&
a
, 0xffffffff);

122 ià(
	`mp_g‘_št
(&
a
) != 0xffffffff) {

123 
	`´štf
("mp_get_int() bad„esult!\n");

127 
	`´štf
("Testing: mp_sqrt\n");

128 
i
 = 0; i < 1000; ++i) {

129 
	`´štf
("%6d\r", 
i
);

130 
	`fæush
(
¡dout
);

131 
n
 = (
	`¿nd
() & 15) + 1;

132 
	`mp_¿nd
(&
a
, 
n
);

133 ià(
	`mp_sq¹
(&
a
, &
b
è!ğ
MP_OKAY
) {

134 
	`´štf
("mp_sqrt()ƒrror!\n");

137 
	`mp_n_roÙ
(&
a
, 2, &a);

138 ià(
	`mp_cmp_mag
(&
b
, &
a
è!ğ
MP_EQ
) {

139 
	`´štf
("mp_sqrt() bad„esult!\n");

144 
	`´štf
("\nTesting: mp_is_square\n");

145 
i
 = 0; i < 1000; ++i) {

146 
	`´štf
("%6d\r", 
i
);

147 
	`fæush
(
¡dout
);

150 
n
 = (
	`¿nd
() & 7) + 1;

151 
	`mp_¿nd
(&
a
, 
n
);

152 
	`mp_sqr
(&
a
, &a);

153 ià(
	`mp_is_squ¬e
(&
a
, &
n
è!ğ
MP_OKAY
) {

154 
	`´štf
("fn:mp_is_square()ƒrror!\n");

157 ià(
n
 == 0) {

158 
	`´štf
("fn:mp_is_square() bad„esult!\n");

163 
	`mp_add_d
(&
a
, 1, &a);

164 ià(
	`mp_is_squ¬e
(&
a
, &
n
è!ğ
MP_OKAY
) {

165 
	`´štf
("fp:mp_is_square()ƒrror!\n");

168 ià(
n
 == 1) {

169 
	`´štf
("fp:mp_is_square() bad„esult!\n");

174 
	`´štf
("\n\n");

177 
ix
 = 10; ix < 128; ix++) {

178 
	`´štf
("Te¡šg (nÙ saã-´ime): %9d b™  \r", 
ix
);

179 
	`fæush
(
¡dout
);

180 
”r
 =

181 
	`mp_´ime_¿ndom_ex
(&
a
, 8, 
ix
,

182 (
	`¿nd
(è& 1è? 
LTM_PRIME_2MSB_OFF
 :

183 
LTM_PRIME_2MSB_ON
, 
myºg
, 
NULL
);

184 ià(
”r
 !ğ
MP_OKAY
) {

185 
	`´štf
("çed w™hƒ¼ cod%d\n", 
”r
);

186  
EXIT_FAILURE
;

188 ià(
	`mp_couÁ_b™s
(&
a
è!ğ
ix
) {

189 
	`´štf
("Primi %d‚Ù %d b™s!!!\n", 
	`mp_couÁ_b™s
(&
a
), 
ix
);

190  
EXIT_FAILURE
;

194 
ix
 = 16; ix < 128; ix++) {

195 
	`´štf
("Te¡šg ( saã-´ime): %9d b™  \r", 
ix
);

196 
	`fæush
(
¡dout
);

197 
”r
 =

198 
	`mp_´ime_¿ndom_ex
(&
a
, 8, 
ix
,

199 ((
	`¿nd
(è& 1è? 
LTM_PRIME_2MSB_OFF
 :

200 
LTM_PRIME_2MSB_ON
è| 
LTM_PRIME_SAFE
, 
myºg
,

201 
NULL
);

202 ià(
”r
 !ğ
MP_OKAY
) {

203 
	`´štf
("çed w™hƒ¼ cod%d\n", 
”r
);

204  
EXIT_FAILURE
;

206 ià(
	`mp_couÁ_b™s
(&
a
è!ğ
ix
) {

207 
	`´štf
("Primi %d‚Ù %d b™s!!!\n", 
	`mp_couÁ_b™s
(&
a
), 
ix
);

208  
EXIT_FAILURE
;

211 
	`mp_sub_d
(&
a
, 1, &a);

212 
	`mp_div_2
(&
a
, &a);

213 
	`mp_´ime_is_´ime
(&
a
, 8, &
út
);

214 ià(
út
 !ğ
MP_YES
) {

215 
	`´štf
("sub is‚ot…rime!\n");

216  
EXIT_FAILURE
;

220 
	`´štf
("\n\n");

222 
	`mp_»ad_¿dix
(&
a
, "123456", 10);

223 
	`mp_tÜadix_n
(&
a
, 
buf
, 10, 3);

224 
	`´štf
("¨=ğ%s\n", 
buf
);

225 
	`mp_tÜadix_n
(&
a
, 
buf
, 10, 4);

226 
	`´štf
("¨=ğ%s\n", 
buf
);

227 
	`mp_tÜadix_n
(&
a
, 
buf
, 10, 30);

228 
	`´štf
("¨=ğ%s\n", 
buf
);

233 
	`fg‘s
(
buf
, (buf), 
¡dš
);

234 
	`mp_»ad_¿dix
(&
a
, 
buf
, 10);

235 
	`mp_´ime_Ãxt_´ime
(&
a
, 5, 1);

236 
	`mp_tÜadix
(&
a
, 
buf
, 10);

237 
	`´štf
("%s, %lu\n", 
buf
, 
a
.
dp
[0] & 3);

242 
	`´štf
("testing mp_cnt_lsb...\n");

243 
	`mp_£t
(&
a
, 1);

244 
ix
 = 0; ix < 1024; ix++) {

245 ià(
	`mp_út_lsb
(&
a
è!ğ
ix
) {

246 
	`´štf
("Faed‡ˆ%d, %d\n", 
ix
, 
	`mp_út_lsb
(&
a
));

249 
	`mp_mul_2
(&
a
, &a);

253 
	`´štf
("Testing mp_reduce_2k...\n");

254 
út
 = 3; cnt <= 128; ++cnt) {

255 
mp_dig™
 
tmp
;

257 
	`mp_2ex±
(&
a
, 
út
);

258 
	`mp_sub_d
(&
a
, 2, &a);

261 
	`´štf
("\nTe¡šg %4d b™s", 
út
);

262 
	`´štf
("(%d)", 
	`mp_»duû_is_2k
(&
a
));

263 
	`mp_»duû_2k_£tup
(&
a
, &
tmp
);

264 
	`´štf
("(%d)", 
tmp
);

265 
ix
 = 0; ix < 1000; ix++) {

266 ià(!(
ix
 & 127)) {

267 
	`´štf
(".");

268 
	`fæush
(
¡dout
);

270 
	`mp_¿nd
(&
b
, (
út
 / 
DIGIT_BIT
 + 1) * 2);

271 
	`mp_cİy
(&
c
, &
b
);

272 
	`mp_mod
(&
c
, &
a
, &c);

273 
	`mp_»duû_2k
(&
b
, &
a
, 2);

274 ià(
	`mp_cmp
(&
c
, &
b
)) {

275 
	`´štf
("FAILED\n");

276 
	`ex™
(0);

282 
	`´štf
("Testing mp_div_3...\n");

283 
	`mp_£t
(&
d
, 3);

284 
út
 = 0; cnt < 10000;) {

285 
mp_dig™
 
r1
, 
r2
;

287 ià(!(++
út
 & 127))

288 
	`´štf
("%9d\r", 
út
);

289 
	`mp_¿nd
(&
a
, 
	`abs
(
	`¿nd
()) % 128 + 1);

290 
	`mp_div
(&
a
, &
d
, &
b
, &
e
);

291 
	`mp_div_3
(&
a
, &
c
, &
r2
);

293 ià(
	`mp_cmp
(&
b
, &
c
è|| 
	`mp_cmp_d
(&
e
, 
r2
)) {

294 
	`´štf
("\n\nmp_div_3 => Failure\n");

297 
	`´štf
("\n\nPassed div_3esting\n");

300 
	`´štf
("testing mp_dr_reduce...\n");

301 
út
 = 2; cnt < 32; cnt++) {

302 
	`´štf
("%d dig™ modulus\n", 
út
);

303 
	`mp_grow
(&
a
, 
út
);

304 
	`mp_z”o
(&
a
);

305 
ix
 = 1; ix < 
út
; ix++) {

306 
a
.
dp
[
ix
] = 
MP_MASK
;

308 
a
.
u£d
 = 
út
;

309 
a
.
dp
[0] = 3;

311 
	`mp_¿nd
(&
b
, 
út
 - 1);

312 
	`mp_cİy
(&
b
, &
c
);

314 
¼
 = 0;

316 ià(!(
¼
 & 127)) {

317 
	`´štf
("%9lu\r", 
¼
);

318 
	`fæush
(
¡dout
);

320 
	`mp_sqr
(&
b
, &b);

321 
	`mp_add_d
(&
b
, 1, &b);

322 
	`mp_cİy
(&
b
, &
c
);

324 
	`mp_mod
(&
b
, &
a
, &b);

325 
	`mp_dr_»duû
(&
c
, &
a
, (((
mp_dig™
è1è<< 
DIGIT_BIT
è-‡.
dp
[0]);

327 ià(
	`mp_cmp
(&
b
, &
c
è!ğ
MP_EQ
) {

328 
	`´štf
("Faed oÀŒŸÈ%lu\n", 
¼
);

329 
	`ex™
(-1);

332 } ++
¼
 < 500);

333 
	`´štf
("Pas£d DRe¡ fÜ %d dig™s\n", 
út
);

342 
	`mp_2ex±
(&
a
, 1024);

343 
	`mp_»ad_¿dix
(&
b
, "2A434B9FDEC95D8F9D550FFFFFFFFFFFFFFFF", 16);

344 
	`mp_sub
(&
a
, &
b
, &a);

347 
	`mp_2ex±
(&
a
, 2048);

348 
	`mp_»ad_¿dix
(&
b
,

351 
	`mp_sub
(&
a
, &
b
, &a);

354 
	`mp_todecim®
(&
a
, 
buf
);

355 
	`´štf
("p==%s\n", 
buf
);

357 ià(
	`mp_»duû_is_2k_l
(&
a
) != 1) {

358 
	`´štf
("mp_reduce_is_2k_l()„eturn 0, should be 1\n");

359  
EXIT_FAILURE
;

361 
	`mp_»duû_2k_£tup_l
(&
a
, &
d
);

363 
	`mp_¿nd
(&
b
, 64);

364 
	`mp_mod
(&
b
, &
a
, &b);

365 
	`mp_cİy
(&
b
, &
c
);

366 
	`´štf
("testing mp_reduce_2k_l...");

367 
	`fæush
(
¡dout
);

368 
út
 = 0; cnt < (1UL << 20); cnt++) {

369 
	`mp_sqr
(&
b
, &b);

370 
	`mp_add_d
(&
b
, 1, &b);

371 
	`mp_»duû_2k_l
(&
b
, &
a
, &
d
);

372 
	`mp_sqr
(&
c
, &c);

373 
	`mp_add_d
(&
c
, 1, &c);

374 
	`mp_mod
(&
c
, &
a
, &c);

375 ià(
	`mp_cmp
(&
b
, &
c
è!ğ
MP_EQ
) {

376 
	`´štf
("mp_»duû_2k_l(èçed‡ˆ¡• %lu\n", 
út
);

377 
	`mp_tohex
(&
b
, 
buf
);

378 
	`´štf
("b =ğ%s\n", 
buf
);

379 
	`mp_tohex
(&
c
, 
buf
);

380 
	`´štf
("ø=ğ%s\n", 
buf
);

381  
EXIT_FAILURE
;

384 
	`´štf
("...Passed\n");

387 
div2_n
 = 
mul2_n
 = 
šv_n
 = 
ex±_n
 = 
lcm_n
 = 
gcd_n
 = 
add_n
 =

388 
sub_n
 = 
mul_n
 = 
div_n
 = 
sqr_n
 = 
mul2d_n
 = 
div2d_n
 = 
út
 = 
add_d_n
 =

389 
sub_d_n
 = 0;

392 
KARATSUBA_SQR_CUTOFF
 = 
KARATSUBA_MUL_CUTOFF
 = 8;

393 
TOOM_SQR_CUTOFF
 = 
TOOM_MUL_CUTOFF
 = 16;

397 
	`abs
(
	`¿nd
()) % 7) {

399 
	`mp_ş—r
(&
a
);

400 
	`mp_š™
(&
a
);

403 
	`mp_ş—r
(&
b
);

404 
	`mp_š™
(&
b
);

407 
	`mp_ş—r
(&
c
);

408 
	`mp_š™
(&
c
);

411 
	`mp_ş—r
(&
d
);

412 
	`mp_š™
(&
d
);

415 
	`mp_ş—r
(&
e
);

416 
	`mp_š™
(&
e
);

419 
	`mp_ş—r
(&
f
);

420 
	`mp_š™
(&
f
);

427 
´štf


429 
add_n
, 
sub_n
, 
mul_n
, 
div_n
, 
sqr_n
, 
mul2d_n
, 
div2d_n
, 
gcd_n
, 
lcm_n
,

430 
ex±_n
, 
šv_n
, 
div2_n
, 
mul2_n
, 
add_d_n
, 
sub_d_n
);

431 
	`fg‘s
(
cmd
, 4095, 
¡dš
);

432 
cmd
[
	`¡¾’
(cmd) - 1] = 0;

433 
	`´štf
("%  ]\r", 
cmd
);

434 
	`fæush
(
¡dout
);

435 ià(!
	`¡rcmp
(
cmd
, "mul2d")) {

436 ++
mul2d_n
;

437 
	`fg‘s
(
buf
, 4095, 
¡dš
);

438 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

439 
	`fg‘s
(
buf
, 4095, 
¡dš
);

440 
	`ssÿnf
(
buf
, "%d", &
¼
);

441 
	`fg‘s
(
buf
, 4095, 
¡dš
);

442 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

444 
	`mp_mul_2d
(&
a
, 
¼
, &a);

445 
a
.
sign
 = 
b
.sign;

446 ià(
	`mp_cmp
(&
a
, &
b
è!ğ
MP_EQ
) {

447 
	`´štf
("mul2d faed,„¸=ğ%d\n", 
¼
);

448 
	`d¿w
(&
a
);

449 
	`d¿w
(&
b
);

452 } ià(!
	`¡rcmp
(
cmd
, "div2d")) {

453 ++
div2d_n
;

454 
	`fg‘s
(
buf
, 4095, 
¡dš
);

455 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

456 
	`fg‘s
(
buf
, 4095, 
¡dš
);

457 
	`ssÿnf
(
buf
, "%d", &
¼
);

458 
	`fg‘s
(
buf
, 4095, 
¡dš
);

459 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

461 
	`mp_div_2d
(&
a
, 
¼
, &a, &
e
);

462 
a
.
sign
 = 
b
.sign;

463 ià(
a
.
u£d
 =ğ
b
.used &&‡.used == 0) {

464 
a
.
sign
 = 
b
.sigÀğ
MP_ZPOS
;

466 ià(
	`mp_cmp
(&
a
, &
b
è!ğ
MP_EQ
) {

467 
	`´štf
("div2d faed,„¸=ğ%d\n", 
¼
);

468 
	`d¿w
(&
a
);

469 
	`d¿w
(&
b
);

472 } ià(!
	`¡rcmp
(
cmd
, "add")) {

473 ++
add_n
;

474 
	`fg‘s
(
buf
, 4095, 
¡dš
);

475 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

476 
	`fg‘s
(
buf
, 4095, 
¡dš
);

477 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

478 
	`fg‘s
(
buf
, 4095, 
¡dš
);

479 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

480 
	`mp_cİy
(&
a
, &
d
);

481 
	`mp_add
(&
d
, &
b
, &d);

482 ià(
	`mp_cmp
(&
c
, &
d
è!ğ
MP_EQ
) {

483 
	`´štf
("add %lu fau»!\n", 
add_n
);

484 
	`d¿w
(&
a
);

485 
	`d¿w
(&
b
);

486 
	`d¿w
(&
c
);

487 
	`d¿w
(&
d
);

493 
¼
 = 
	`mp_sigÃd_bš_size
(&
c
);

494 
	`mp_to_sigÃd_bš
(&
c
, (*è
cmd
);

495 
	`mem£t
(
cmd
 + 
¼
, 
	`¿nd
() & 255, (cmd) -„r);

496 
	`mp_»ad_sigÃd_bš
(&
d
, (*è
cmd
, 
¼
);

497 ià(
	`mp_cmp
(&
c
, &
d
è!ğ
MP_EQ
) {

498 
	`´štf
("mp_signed_bin failure!\n");

499 
	`d¿w
(&
c
);

500 
	`d¿w
(&
d
);

505 
¼
 = 
	`mp_unsigÃd_bš_size
(&
c
);

506 
	`mp_to_unsigÃd_bš
(&
c
, (*è
cmd
);

507 
	`mem£t
(
cmd
 + 
¼
, 
	`¿nd
() & 255, (cmd) -„r);

508 
	`mp_»ad_unsigÃd_bš
(&
d
, (*è
cmd
, 
¼
);

509 ià(
	`mp_cmp_mag
(&
c
, &
d
è!ğ
MP_EQ
) {

510 
	`´štf
("mp_unsigned_bin failure!\n");

511 
	`d¿w
(&
c
);

512 
	`d¿w
(&
d
);

516 } ià(!
	`¡rcmp
(
cmd
, "sub")) {

517 ++
sub_n
;

518 
	`fg‘s
(
buf
, 4095, 
¡dš
);

519 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

520 
	`fg‘s
(
buf
, 4095, 
¡dš
);

521 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

522 
	`fg‘s
(
buf
, 4095, 
¡dš
);

523 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

524 
	`mp_cİy
(&
a
, &
d
);

525 
	`mp_sub
(&
d
, &
b
, &d);

526 ià(
	`mp_cmp
(&
c
, &
d
è!ğ
MP_EQ
) {

527 
	`´štf
("sub %lu fau»!\n", 
sub_n
);

528 
	`d¿w
(&
a
);

529 
	`d¿w
(&
b
);

530 
	`d¿w
(&
c
);

531 
	`d¿w
(&
d
);

534 } ià(!
	`¡rcmp
(
cmd
, "mul")) {

535 ++
mul_n
;

536 
	`fg‘s
(
buf
, 4095, 
¡dš
);

537 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

538 
	`fg‘s
(
buf
, 4095, 
¡dš
);

539 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

540 
	`fg‘s
(
buf
, 4095, 
¡dš
);

541 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

542 
	`mp_cİy
(&
a
, &
d
);

543 
	`mp_mul
(&
d
, &
b
, &d);

544 ià(
	`mp_cmp
(&
c
, &
d
è!ğ
MP_EQ
) {

545 
	`´štf
("muÈ%lu fau»!\n", 
mul_n
);

546 
	`d¿w
(&
a
);

547 
	`d¿w
(&
b
);

548 
	`d¿w
(&
c
);

549 
	`d¿w
(&
d
);

552 } ià(!
	`¡rcmp
(
cmd
, "div")) {

553 ++
div_n
;

554 
	`fg‘s
(
buf
, 4095, 
¡dš
);

555 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

556 
	`fg‘s
(
buf
, 4095, 
¡dš
);

557 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

558 
	`fg‘s
(
buf
, 4095, 
¡dš
);

559 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

560 
	`fg‘s
(
buf
, 4095, 
¡dš
);

561 
	`mp_»ad_¿dix
(&
d
, 
buf
, 64);

563 
	`mp_div
(&
a
, &
b
, &
e
, &
f
);

564 ià(
	`mp_cmp
(&
c
, &
e
è!ğ
MP_EQ
 || mp_cmp(&
d
, &
f
) != MP_EQ) {

565 
	`´štf
("div %lu %d, %d, fau»!\n", 
div_n
, 
	`mp_cmp
(&
c
, &
e
),

566 
	`mp_cmp
(&
d
, &
f
));

567 
	`d¿w
(&
a
);

568 
	`d¿w
(&
b
);

569 
	`d¿w
(&
c
);

570 
	`d¿w
(&
d
);

571 
	`d¿w
(&
e
);

572 
	`d¿w
(&
f
);

576 } ià(!
	`¡rcmp
(
cmd
, "sqr")) {

577 ++
sqr_n
;

578 
	`fg‘s
(
buf
, 4095, 
¡dš
);

579 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

580 
	`fg‘s
(
buf
, 4095, 
¡dš
);

581 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

582 
	`mp_cİy
(&
a
, &
c
);

583 
	`mp_sqr
(&
c
, &c);

584 ià(
	`mp_cmp
(&
b
, &
c
è!ğ
MP_EQ
) {

585 
	`´štf
("sq¸%lu fau»!\n", 
sqr_n
);

586 
	`d¿w
(&
a
);

587 
	`d¿w
(&
b
);

588 
	`d¿w
(&
c
);

591 } ià(!
	`¡rcmp
(
cmd
, "gcd")) {

592 ++
gcd_n
;

593 
	`fg‘s
(
buf
, 4095, 
¡dš
);

594 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

595 
	`fg‘s
(
buf
, 4095, 
¡dš
);

596 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

597 
	`fg‘s
(
buf
, 4095, 
¡dš
);

598 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

599 
	`mp_cİy
(&
a
, &
d
);

600 
	`mp_gcd
(&
d
, &
b
, &d);

601 
d
.
sign
 = 
c
.sign;

602 ià(
	`mp_cmp
(&
c
, &
d
è!ğ
MP_EQ
) {

603 
	`´štf
("gcd %lu fau»!\n", 
gcd_n
);

604 
	`d¿w
(&
a
);

605 
	`d¿w
(&
b
);

606 
	`d¿w
(&
c
);

607 
	`d¿w
(&
d
);

610 } ià(!
	`¡rcmp
(
cmd
, "lcm")) {

611 ++
lcm_n
;

612 
	`fg‘s
(
buf
, 4095, 
¡dš
);

613 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

614 
	`fg‘s
(
buf
, 4095, 
¡dš
);

615 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

616 
	`fg‘s
(
buf
, 4095, 
¡dš
);

617 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

618 
	`mp_cİy
(&
a
, &
d
);

619 
	`mp_lcm
(&
d
, &
b
, &d);

620 
d
.
sign
 = 
c
.sign;

621 ià(
	`mp_cmp
(&
c
, &
d
è!ğ
MP_EQ
) {

622 
	`´štf
("lcm %lu fau»!\n", 
lcm_n
);

623 
	`d¿w
(&
a
);

624 
	`d¿w
(&
b
);

625 
	`d¿w
(&
c
);

626 
	`d¿w
(&
d
);

629 } ià(!
	`¡rcmp
(
cmd
, "expt")) {

630 ++
ex±_n
;

631 
	`fg‘s
(
buf
, 4095, 
¡dš
);

632 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

633 
	`fg‘s
(
buf
, 4095, 
¡dš
);

634 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

635 
	`fg‘s
(
buf
, 4095, 
¡dš
);

636 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

637 
	`fg‘s
(
buf
, 4095, 
¡dš
);

638 
	`mp_»ad_¿dix
(&
d
, 
buf
, 64);

639 
	`mp_cİy
(&
a
, &
e
);

640 
	`mp_ex±mod
(&
e
, &
b
, &
c
, &e);

641 ià(
	`mp_cmp
(&
d
, &
e
è!ğ
MP_EQ
) {

642 
	`´štf
("ex± %lu fau»!\n", 
ex±_n
);

643 
	`d¿w
(&
a
);

644 
	`d¿w
(&
b
);

645 
	`d¿w
(&
c
);

646 
	`d¿w
(&
d
);

647 
	`d¿w
(&
e
);

650 } ià(!
	`¡rcmp
(
cmd
, "invmod")) {

651 ++
šv_n
;

652 
	`fg‘s
(
buf
, 4095, 
¡dš
);

653 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

654 
	`fg‘s
(
buf
, 4095, 
¡dš
);

655 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

656 
	`fg‘s
(
buf
, 4095, 
¡dš
);

657 
	`mp_»ad_¿dix
(&
c
, 
buf
, 64);

658 
	`mp_švmod
(&
a
, &
b
, &
d
);

659 
	`mp_mulmod
(&
d
, &
a
, &
b
, &
e
);

660 ià(
	`mp_cmp_d
(&
e
, 1è!ğ
MP_EQ
) {

661 
	`´štf
("inv [wrong value from MPI?!] failure\n");

662 
	`d¿w
(&
a
);

663 
	`d¿w
(&
b
);

664 
	`d¿w
(&
c
);

665 
	`d¿w
(&
d
);

666 
	`mp_gcd
(&
a
, &
b
, &
e
);

667 
	`d¿w
(&
e
);

671 } ià(!
	`¡rcmp
(
cmd
, "div2")) {

672 ++
div2_n
;

673 
	`fg‘s
(
buf
, 4095, 
¡dš
);

674 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

675 
	`fg‘s
(
buf
, 4095, 
¡dš
);

676 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

677 
	`mp_div_2
(&
a
, &
c
);

678 ià(
	`mp_cmp
(&
c
, &
b
è!ğ
MP_EQ
) {

679 
	`´štf
("div_2 %lu fau»\n", 
div2_n
);

680 
	`d¿w
(&
a
);

681 
	`d¿w
(&
b
);

682 
	`d¿w
(&
c
);

685 } ià(!
	`¡rcmp
(
cmd
, "mul2")) {

686 ++
mul2_n
;

687 
	`fg‘s
(
buf
, 4095, 
¡dš
);

688 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

689 
	`fg‘s
(
buf
, 4095, 
¡dš
);

690 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

691 
	`mp_mul_2
(&
a
, &
c
);

692 ià(
	`mp_cmp
(&
c
, &
b
è!ğ
MP_EQ
) {

693 
	`´štf
("mul_2 %lu fau»\n", 
mul2_n
);

694 
	`d¿w
(&
a
);

695 
	`d¿w
(&
b
);

696 
	`d¿w
(&
c
);

699 } ià(!
	`¡rcmp
(
cmd
, "add_d")) {

700 ++
add_d_n
;

701 
	`fg‘s
(
buf
, 4095, 
¡dš
);

702 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

703 
	`fg‘s
(
buf
, 4095, 
¡dš
);

704 
	`ssÿnf
(
buf
, "%d", &
ix
);

705 
	`fg‘s
(
buf
, 4095, 
¡dš
);

706 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

707 
	`mp_add_d
(&
a
, 
ix
, &
c
);

708 ià(
	`mp_cmp
(&
b
, &
c
è!ğ
MP_EQ
) {

709 
	`´štf
("add_d %lu fau»\n", 
add_d_n
);

710 
	`d¿w
(&
a
);

711 
	`d¿w
(&
b
);

712 
	`d¿w
(&
c
);

713 
	`´štf
("d =ğ%d\n", 
ix
);

716 } ià(!
	`¡rcmp
(
cmd
, "sub_d")) {

717 ++
sub_d_n
;

718 
	`fg‘s
(
buf
, 4095, 
¡dš
);

719 
	`mp_»ad_¿dix
(&
a
, 
buf
, 64);

720 
	`fg‘s
(
buf
, 4095, 
¡dš
);

721 
	`ssÿnf
(
buf
, "%d", &
ix
);

722 
	`fg‘s
(
buf
, 4095, 
¡dš
);

723 
	`mp_»ad_¿dix
(&
b
, 
buf
, 64);

724 
	`mp_sub_d
(&
a
, 
ix
, &
c
);

725 ià(
	`mp_cmp
(&
b
, &
c
è!ğ
MP_EQ
) {

726 
	`´štf
("sub_d %lu fau»\n", 
sub_d_n
);

727 
	`d¿w
(&
a
);

728 
	`d¿w
(&
b
);

729 
	`d¿w
(&
c
);

730 
	`´štf
("d =ğ%d\n", 
ix
);

736 
	}
}

	@libtommath/demo/timing.c

1 
	~<tomm©h.h
>

2 
	~<time.h
>

4 
ulÚg64
 
	g_‰
;

6 #ifdeà
IOWNANATHLON


7 
	~<uni¡d.h
>

8 
	#SLEEP
 
	`¦“p
(4)

	)

10 
	#SLEEP


	)

14 
	$nd¿w
(
mp_št
 * 
a
, *
Çme
)

16 
buf
[4096];

18 
	`´štf
("%s: ", 
Çme
);

19 
	`mp_tÜadix
(
a
, 
buf
, 64);

20 
	`´štf
("%s\n", 
buf
);

21 
	}
}

23 
	$d¿w
(
mp_št
 * 
a
)

25 
	`nd¿w
(
a
, "");

26 
	}
}

29 
	glf¤
 = 0xAAAAAAAAUL;

31 
	$lb™
()

33 ià(
lf¤
 & 0x80000000UL) {

34 
lf¤
 = ((lfsr << 1) ^ 0x8000001BUL) & 0xFFFFFFFFUL;

37 
lf¤
 <<= 1;

40 
	}
}

43 
ulÚg64
 
	$TIMFUNC
()

45 #ià
defšed
 
__GNUC__


46 #ià
	`defšed
(
__i386__
è|| defšed(
__x86_64__
)

47 
a
;

48 
__asm__
 
	`__vŞ©e__
("rdtsc\nmovl %%eax,%0\nmovl %%edx,4+%0\n"::

49 "m"(
a
):"%eax", "%edx");

50  
a
;

52 
»suÉ
;

53 
__asm__
 
	`__vŞ©e__
("mov %0÷r.™c":"ô"(
»suÉ
)::"memory");

55 
	`__butš_ex³ù
((è
»suÉ
 == -1, 0))

56 
__asm__
 
	`__vŞ©e__
("mov %0÷r.™c":"ô"(
»suÉ
)::"memory");

58  
»suÉ
;

62 #–ià
defšed
 
_M_IX86


63 
__asm
 
rdtsc


64 #–ià
defšed
 
_M_AMD64


65  
	`__rdtsc
();

66 #–ià
defšed
 
_M_IA64


67 #ià
defšed
 
__INTEL_COMPILER


68 
	~<Ÿ64šŒš.h
>

70  
	`__g‘Reg
(3116);

72 #”rÜ 
Ãed
 
rdtsc
 
funùiÚ
 
this
 
bud


74 
	}
}

76 
	#DO
(
x
èx; x;

	)

81 
	$maš
()

83 
ulÚg64
 
‰
, 
gg
, 
CLK_PER_SEC
;

84 
FILE
 *
log
, *
logb
, *
logc
, *
logd
;

85 
mp_št
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
;

86 
n
, 
út
, 
ix
, 
Şd_k¬a_m
, 
Şd_k¬a_s
;

87 
¼
;

89 
	`mp_š™
(&
a
);

90 
	`mp_š™
(&
b
);

91 
	`mp_š™
(&
c
);

92 
	`mp_š™
(&
d
);

93 
	`mp_š™
(&
e
);

94 
	`mp_š™
(&
f
);

96 
	`¤ªd
(
	`time
(
NULL
));

100 
TOOM_MUL_CUTOFF
 = 
TOOM_SQR_CUTOFF
 = 100000;

102 
CLK_PER_SEC
 = 
	`TIMFUNC
();

103 
	`¦“p
(1);

104 
CLK_PER_SEC
 = 
	`TIMFUNC
() - CLK_PER_SEC;

106 
	`´štf
("CLK_PER_SEC =ğ%Îu\n", 
CLK_PER_SEC
);

107 
ex±mod
;

108 
log
 = 
	`fİ’
("logs/add.log", "w");

109 
út
 = 8; cnt <= 128; cnt += 8) {

110 
SLEEP
;

111 
	`mp_¿nd
(&
a
, 
út
);

112 
	`mp_¿nd
(&
b
, 
út
);

113 
¼
 = 0;

114 
‰
 = -1;

116 
gg
 = 
	`TIMFUNC
();

117 
	`DO
(
	`mp_add
(&
a
, &
b
, &
c
));

118 
gg
 = (
	`TIMFUNC
() - gg) >> 1;

119 ià(
‰
 > 
gg
)

120 
‰
 = 
gg
;

121 } ++
¼
 < 100000);

122 
	`´štf
("Adding\t\t%4d-bit => %9llu/sec, %9llu cycles\n",

123 
	`mp_couÁ_b™s
(&
a
), 
CLK_PER_SEC
 / 
‰
,t);

124 
	`årštf
(
log
, "%d %9Îu\n", 
út
 * 
DIGIT_BIT
, 
‰
);

125 
	`fæush
(
log
);

127 
	`fşo£
(
log
);

129 
log
 = 
	`fİ’
("logs/sub.log", "w");

130 
út
 = 8; cnt <= 128; cnt += 8) {

131 
SLEEP
;

132 
	`mp_¿nd
(&
a
, 
út
);

133 
	`mp_¿nd
(&
b
, 
út
);

134 
¼
 = 0;

135 
‰
 = -1;

137 
gg
 = 
	`TIMFUNC
();

138 
	`DO
(
	`mp_sub
(&
a
, &
b
, &
c
));

139 
gg
 = (
	`TIMFUNC
() - gg) >> 1;

140 ià(
‰
 > 
gg
)

141 
‰
 = 
gg
;

142 } ++
¼
 < 100000);

144 
	`´štf
("Subtracting\t\t%4d-bit => %9llu/sec, %9llu cycles\n",

145 
	`mp_couÁ_b™s
(&
a
), 
CLK_PER_SEC
 / 
‰
,t);

146 
	`årštf
(
log
, "%d %9Îu\n", 
út
 * 
DIGIT_BIT
, 
‰
);

147 
	`fæush
(
log
);

149 
	`fşo£
(
log
);

152 
muÉ‹¡
:

153 
Şd_k¬a_m
 = 
KARATSUBA_MUL_CUTOFF
;

154 
Şd_k¬a_s
 = 
KARATSUBA_SQR_CUTOFF
;

155 
ix
 = 0; ix < 2; ix++) {

156 
	`´štf
("W™h% K¬©suba\n", (
ix
 == 0) ? "out" : "");

158 
KARATSUBA_MUL_CUTOFF
 = (
ix
 =ğ0è? 9999 : 
Şd_k¬a_m
;

159 
KARATSUBA_SQR_CUTOFF
 = (
ix
 =ğ0è? 9999 : 
Şd_k¬a_s
;

161 
log
 = 
	`fİ’
((
ix
 == 0) ? "logs/mult.log" : "logs/mult_kara.log", "w");

162 
út
 = 4; cÁ <ğ10240 / 
DIGIT_BIT
; cnt += 2) {

163 
SLEEP
;

164 
	`mp_¿nd
(&
a
, 
út
);

165 
	`mp_¿nd
(&
b
, 
út
);

166 
¼
 = 0;

167 
‰
 = -1;

169 
gg
 = 
	`TIMFUNC
();

170 
	`DO
(
	`mp_mul
(&
a
, &
b
, &
c
));

171 
gg
 = (
	`TIMFUNC
() - gg) >> 1;

172 ià(
‰
 > 
gg
)

173 
‰
 = 
gg
;

174 } ++
¼
 < 100);

175 
	`´štf
("Multiplying\t%4d-bit => %9llu/sec, %9llu cycles\n",

176 
	`mp_couÁ_b™s
(&
a
), 
CLK_PER_SEC
 / 
‰
,t);

177 
	`årštf
(
log
, "%d %9Îu\n", 
	`mp_couÁ_b™s
(&
a
), 
‰
);

178 
	`fæush
(
log
);

180 
	`fşo£
(
log
);

182 
log
 = 
	`fİ’
((
ix
 == 0) ? "logs/sqr.log" : "logs/sqr_kara.log", "w");

183 
út
 = 4; cÁ <ğ10240 / 
DIGIT_BIT
; cnt += 2) {

184 
SLEEP
;

185 
	`mp_¿nd
(&
a
, 
út
);

186 
¼
 = 0;

187 
‰
 = -1;

189 
gg
 = 
	`TIMFUNC
();

190 
	`DO
(
	`mp_sqr
(&
a
, &
b
));

191 
gg
 = (
	`TIMFUNC
() - gg) >> 1;

192 ià(
‰
 > 
gg
)

193 
‰
 = 
gg
;

194 } ++
¼
 < 100);

195 
	`´štf
("Squaring\t%4d-bit => %9llu/sec, %9llu cycles\n",

196 
	`mp_couÁ_b™s
(&
a
), 
CLK_PER_SEC
 / 
‰
,t);

197 
	`årštf
(
log
, "%d %9Îu\n", 
	`mp_couÁ_b™s
(&
a
), 
‰
);

198 
	`fæush
(
log
);

200 
	`fşo£
(
log
);

203 
ex±mod
:

206 *
´imes
[] = {

236 
NULL


238 
log
 = 
	`fİ’
("logs/expt.log", "w");

239 
logb
 = 
	`fİ’
("logs/expt_dr.log", "w");

240 
logc
 = 
	`fİ’
("logs/expt_2k.log", "w");

241 
logd
 = 
	`fİ’
("logs/expt_2kl.log", "w");

242 
n
 = 0; 
´imes
[n];‚++) {

243 
SLEEP
;

244 
	`mp_»ad_¿dix
(&
a
, 
´imes
[
n
], 10);

245 
	`mp_z”o
(&
b
);

246 
¼
 = 0;„¸< (è
	`mp_couÁ_b™s
(&
a
);„r++) {

247 
	`mp_mul_2
(&
b
, &b);

248 
b
.
dp
[0] |ğ
	`lb™
();

249 
b
.
u£d
 += 1;

251 
	`mp_sub_d
(&
a
, 1, &
c
);

252 
	`mp_mod
(&
b
, &
c
, &b);

253 
	`mp_£t
(&
c
, 3);

254 
¼
 = 0;

255 
‰
 = -1;

257 
gg
 = 
	`TIMFUNC
();

258 
	`DO
(
	`mp_ex±mod
(&
c
, &
b
, &
a
, &
d
));

259 
gg
 = (
	`TIMFUNC
() - gg) >> 1;

260 ià(
‰
 > 
gg
)

261 
‰
 = 
gg
;

262 } ++
¼
 < 10);

263 
	`mp_sub_d
(&
a
, 1, &
e
);

264 
	`mp_sub
(&
e
, &
b
, &b);

265 
	`mp_ex±mod
(&
c
, &
b
, &
a
, &
e
);

266 
	`mp_mulmod
(&
e
, &
d
, &
a
, &d);

267 ià(
	`mp_cmp_d
(&
d
, 1)) {

268 
	`´štf
("Difã»Á (%d)!!!\n", 
	`mp_couÁ_b™s
(&
a
));

269 
	`d¿w
(&
d
);

270 
	`ex™
(0);

272 
	`´štf
("Exponentiating\t%4d-bit => %9llu/sec, %9llu cycles\n",

273 
	`mp_couÁ_b™s
(&
a
), 
CLK_PER_SEC
 / 
‰
,t);

274 
	`årštf
(
n
 < 4 ? 
logd
 : (À< 9è? 
logc
 : (À< 16è? 
logb
 : 
log
,

275 "%d %9Îu\n", 
	`mp_couÁ_b™s
(&
a
), 
‰
);

278 
	`fşo£
(
log
);

279 
	`fşo£
(
logb
);

280 
	`fşo£
(
logc
);

281 
	`fşo£
(
logd
);

283 
log
 = 
	`fİ’
("logs/invmod.log", "w");

284 
út
 = 4; cnt <= 128; cnt += 4) {

285 
SLEEP
;

286 
	`mp_¿nd
(&
a
, 
út
);

287 
	`mp_¿nd
(&
b
, 
út
);

290 
	`mp_add_d
(&
b
, 1, &b);

291 
	`mp_gcd
(&
a
, &
b
, &
c
);

292 } 
	`mp_cmp_d
(&
c
, 1è!ğ
MP_EQ
);

294 
¼
 = 0;

295 
‰
 = -1;

297 
gg
 = 
	`TIMFUNC
();

298 
	`DO
(
	`mp_švmod
(&
b
, &
a
, &
c
));

299 
gg
 = (
	`TIMFUNC
() - gg) >> 1;

300 ià(
‰
 > 
gg
)

301 
‰
 = 
gg
;

302 } ++
¼
 < 1000);

303 
	`mp_mulmod
(&
b
, &
c
, &
a
, &
d
);

304 ià(
	`mp_cmp_d
(&
d
, 1è!ğ
MP_EQ
) {

305 
	`´štf
("Failedo invert\n");

308 
	`´štf
("Inverting mod\t%4d-bit => %9llu/sec, %9llu cycles\n",

309 
	`mp_couÁ_b™s
(&
a
), 
CLK_PER_SEC
 / 
‰
,t);

310 
	`årštf
(
log
, "%d %9Îu\n", 
út
 * 
DIGIT_BIT
, 
‰
);

312 
	`fşo£
(
log
);

315 
	}
}

	@libtommath/etc/2kprime.c

2 
	~<tomm©h.h
>

3 
	~<time.h
>

5 
	gsizes
[] = {256, 512, 768, 1024, 1536, 2048, 3072, 4096};

7 
	$maš
()

9 
buf
[2000];

10 
x
, 
y
;

11 
mp_št
 
q
, 
p
;

12 
FILE
 *
out
;

13 
şock_t
 
t1
;

14 
mp_dig™
 
z
;

16 
	`mp_š™_muÉi
(&
q
, &
p
, 
NULL
);

18 
out
 = 
	`fİ’
("2kprime.1", "w");

19 
x
 = 0; x < ()((
sizes
) / (sizes[0])); x++) {

20 
tİ
:

21 
	`mp_2ex±
(&
q
, 
sizes
[
x
]);

22 
	`mp_add_d
(&
q
, 3, &q);

23 
z
 = -3;

25 
t1
 = 
	`şock
();

27 
	`mp_sub_d
(&
q
, 4, &q);

28 
z
 += 4;

30 ià(
z
 > 
MP_MASK
) {

31 
	`´štf
("NØ´ime oàsiz%d found\n", 
sizes
[
x
]);

35 ià(
	`şock
(è- 
t1
 > 
CLOCKS_PER_SEC
) {

36 
	`´štf
("."); 
	`fæush
(
¡dout
);

38 
t1
 = 
	`şock
();

42 
	`mp_´ime_is_´ime
(&
q
, 1, &
y
);

43 ià(
y
 == 0) {

48 
	`mp_sub_d
(&
q
, 1, &
p
);

49 
	`mp_div_2
(&
p
, &p);

50 
	`mp_´ime_is_´ime
(&
p
, 3, &
y
);

51 ià(
y
 == 0) {

56 
	`mp_´ime_is_´ime
(&
q
, 3, &
y
);

57 ià(
y
 == 0) {

64 ià(
y
 == 0) {

65 ++
sizes
[
x
];

66 
tİ
;

69 
	`mp_tÜadix
(&
q
, 
buf
, 10);

70 
	`´štf
("\n\n%d-b™ (k = %luèğ%s\n", 
sizes
[
x
], 
z
, 
buf
);

71 
	`årštf
(
out
, "%d-b™ (k = %luèğ%s\n", 
sizes
[
x
], 
z
, 
buf
); 
	`fæush
(out);

75 
	}
}

	@libtommath/etc/drprime.c

2 
	~<tomm©h.h
>

4 
	gsizes
[] = { 1+256/
DIGIT_BIT
, 1+512/DIGIT_BIT, 1+768/DIGIT_BIT, 1+1024/DIGIT_BIT, 1+2048/DIGIT_BIT, 1+4096/DIGIT_BIT };

5 
	$maš
()

7 
»s
, 
x
, 
y
;

8 
buf
[4096];

9 
FILE
 *
out
;

10 
mp_št
 
a
, 
b
;

12 
	`mp_š™
(&
a
);

13 
	`mp_š™
(&
b
);

15 
out
 = 
	`fİ’
("drprimes.txt", "w");

16 
x
 = 0; x < ()((
sizes
)/(sizes[0])); x++) {

17 
tİ
:

18 
	`´štf
("S“kšg‡ %d-b™ saã…rime\n", 
sizes
[
x
] * 
DIGIT_BIT
);

19 
	`mp_grow
(&
a
, 
sizes
[
x
]);

20 
	`mp_z”o
(&
a
);

21 
y
 = 1; y < 
sizes
[
x
]; y++) {

22 
a
.
dp
[
y
] = 
MP_MASK
;

26 
a
.
dp
[0] = -1;

27 
a
.
u£d
 = 
sizes
[
x
];

30 
»s
 = 0;

32 
a
.
dp
[0] += 4;

33 ià(
a
.
dp
[0] >ğ
MP_MASK
) ;

34 
	`mp_´ime_is_´ime
(&
a
, 1, &
»s
);

35 ià(
»s
 == 0) ;

36 
	`´štf
("."); 
	`fæush
(
¡dout
);

37 
	`mp_sub_d
(&
a
, 1, &
b
);

38 
	`mp_div_2
(&
b
, &b);

39 
	`mp_´ime_is_´ime
(&
b
, 3, &
»s
);

40 ià(
»s
 == 0) ;

41 
	`mp_´ime_is_´ime
(&
a
, 3, &
»s
);

42 ià(
»s
 == 1) ;

45 ià(
»s
 != 1) {

46 
	`´štf
("E¼Ü‚Ù DR modulus\n"); 
sizes
[
x
] +ğ1; 
tİ
;

48 
	`mp_tÜadix
(&
a
, 
buf
, 10);

49 
	`´štf
("\n\Å =ğ%s\n\n", 
buf
);

50 
	`årštf
(
out
, "%d-b™…rime:\Å =ğ%s\n\n", 
	`mp_couÁ_b™s
(&
a
), 
buf
); 
	`fæush
(out);

53 
	`fşo£
(
out
);

55 
	`mp_ş—r
(&
a
);

56 
	`mp_ş—r
(&
b
);

59 
	}
}

	@libtommath/etc/mersenne.c

5 
	~<time.h
>

6 
	~<tomm©h.h
>

9 
	$is_m”£Âe
 (
s
, *
µ
)

11 
mp_št
 
n
, 
u
;

12 
»s
, 
k
;

14 *
µ
 = 0;

16 ià((
»s
 = 
	`mp_š™
 (&
n
)è!ğ
MP_OKAY
) {

17  
»s
;

20 ià((
»s
 = 
	`mp_š™
 (&
u
)è!ğ
MP_OKAY
) {

21 
LBL_N
;

25 ià((
»s
 = 
	`mp_2ex±
(&
n
, 
s
)è!ğ
MP_OKAY
) {

26 
LBL_MU
;

28 ià((
»s
 = 
	`mp_sub_d
 (&
n
, 1, &n)è!ğ
MP_OKAY
) {

29 
LBL_MU
;

33 
	`mp_£t
 (&
u
, 4);

36 
k
 = 1; k <ğ
s
 - 2; k++) {

38 ià((
»s
 = 
	`mp_sqr
 (&
u
, &u)è!ğ
MP_OKAY
) {

39 
LBL_MU
;

41 ià((
»s
 = 
	`mp_sub_d
 (&
u
, 2, &u)è!ğ
MP_OKAY
) {

42 
LBL_MU
;

46 
u
.
sign
 =ğ
MP_NEG
) {

47 ià((
»s
 = 
	`mp_add
 (&
u
, &
n
, &u)è!ğ
MP_OKAY
) {

48 
LBL_MU
;

53 ià((
»s
 = 
	`mp_»duû_2k
 (&
u
, &
n
, 1)è!ğ
MP_OKAY
) {

54 
LBL_MU
;

59 ià(
	`mp_isz”o
 (&
u
) == 1) {

60 
	`mp_´ime_is_´ime
(&
n
, 8, 
µ
);

61 ià(*
µ
 !ğ1è
	`´štf
("FAILURE\n");

64 
»s
 = 
MP_OKAY
;

65 
LBL_MU
:
	`mp_ş—r
 (&
u
);

66 
LBL_N
:
	`mp_ş—r
 (&
n
);

67  
»s
;

68 
	}
}

72 
	$i_sq¹
 (
x
)

74 
x1
, 
x2
;

76 
x2
 = 16;

78 
x1
 = 
x2
;

79 
x2
 = 
x1
 - ((x1 * x1è- 
x
) / (2 * x1);

80 } 
x1
 !ğ
x2
);

82 ià(
x1
 * x1 > 
x
) {

83 --
x1
;

86  
x1
;

87 
	}
}

91 
	$i¥rime
 (
k
)

93 
y
, 
z
;

95 
y
 = 
	`i_sq¹
 (
k
);

96 
z
 = 2; z <ğ
y
; z++) {

97 ià((
k
 % 
z
) == 0)

101 
	}
}

105 
	$maš
 ()

107 
µ
;

108 
k
;

109 
şock_t
 
‰
;

111 
k
 = 3;

115 
‰
 = 
	`şock
 ();

118 ià(
	`is_m”£Âe
 (
k
, &
µ
è!ğ
MP_OKAY
) {

119 
	`´štf
 ("Whoaƒrror\n");

123 ià(
µ
 == 1) {

125 
‰
 = 
	`şock
 () -t;

128 
	`´štf
 ("2^%-5ld - 1 i ´ime,e¡ook %ldicks\n", 
k
, 
‰
);

132 
k
 += 2;

135 
	`i¥rime
 (
k
) == 0) {

136 
k
 += 2;

140 
	}
}

	@libtommath/etc/mont.c

2 
	~<tomm©h.h
>

4 
	$maš
()

6 
mp_št
 
modulus
, 
R
, 
p
, 
µ
;

7 
mp_dig™
 
mp
;

8 
x
, 
y
;

10 
	`¤ªd
(
	`time
(
NULL
));

11 
	`mp_š™_muÉi
(&
modulus
, &
R
, &
p
, &
µ
, 
NULL
);

14 
x
 = 4; x < 256; x++) {

15 
	`´štf
("DIGITS =ğ%3ld...", 
x
); 
	`fæush
(
¡dout
);

18 
	`mp_¿nd
(&
modulus
, 
x
);

19 
modulus
.
dp
[0] |= 1;

22 
	`mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
(&
R
, &
modulus
);

23 
	`mp_mÚtgom”y_£tup
(&
modulus
, &
mp
);

26 
y
 = 0; y < 1000; y++) {

27 
	`mp_¿nd
(&
p
, 
x
/2);

28 
	`mp_mul
(&
p
, &
R
, &
µ
);

29 
	`mp_mÚtgom”y_»duû
(&
µ
, &
modulus
, 
mp
);

32 ià(
	`mp_cmp
(&
µ
, &
p
è!ğ
MP_EQ
) {

33 
	`´štf
("FAILURE!\n");

34 
	`ex™
(-1);

37 
	`´štf
("PASSED\n");

41 
	}
}

	@libtommath/etc/pprime.c

7 
	~<time.h
>

8 
	~"tomm©h.h
"

10 
	gn_´ime
;

11 
FILE
 *
	g´imes
;

14 
mp_dig™


15 
	$i_sq¹
 (
mp_wÜd
 
x
)

17 
mp_wÜd
 
x1
, 
x2
;

19 
x2
 = 
x
;

21 
x1
 = 
x2
;

22 
x2
 = 
x1
 - ((x1 * x1è- 
x
) / (2 * x1);

23 } 
x1
 !ğ
x2
);

25 ià(
x1
 * x1 > 
x
) {

26 --
x1
;

29  
x1
;

30 
	}
}

34 
	$g’_´ime
 ()

36 
mp_dig™
 
r
, 
x
, 
y
, 
Ãxt
;

37 
FILE
 *
out
;

39 
out
 = 
	`fİ’
("pprime.dat", "wb");

42 
r
 = 3; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

43 
r
 = 5; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

44 
r
 = 7; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

45 
r
 = 11; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

46 
r
 = 13; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

47 
r
 = 17; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

48 
r
 = 19; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

49 
r
 = 23; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

50 
r
 = 29; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

51 
r
 = 31; 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
);

54 
y
 = 
	`i_sq¹
 (
r
);

55 
Ãxt
 = (
y
 + 1) * (y + 1);

59 
r
 += 2;

60 
r
 &ğ
MP_MASK
;

61 ià(
r
 < 31) ;

64 ià(
Ãxt
 <ğ
r
) {

65 ++
y
;

66 
Ãxt
 = (
y
 + 1) * (y + 1);

70 ià((
r
 % 3) == 0) {

71 
x
 = 0;

74 ià((
r
 % 5) == 0) {

75 
x
 = 0;

78 ià((
r
 % 7) == 0) {

79 
x
 = 0;

82 ià((
r
 % 11) == 0) {

83 
x
 = 0;

86 ià((
r
 % 13) == 0) {

87 
x
 = 0;

90 ià((
r
 % 17) == 0) {

91 
x
 = 0;

94 ià((
r
 % 19) == 0) {

95 
x
 = 0;

98 ià((
r
 % 23) == 0) {

99 
x
 = 0;

102 ià((
r
 % 29) == 0) {

103 
x
 = 0;

108 
x
 = 30; x <ğ
y
; x += 30) {

109 ià((
r
 % (
x
 + 1)) == 0) {

110 
x
 = 0;

113 ià((
r
 % (
x
 + 7)) == 0) {

114 
x
 = 0;

117 ià((
r
 % (
x
 + 11)) == 0) {

118 
x
 = 0;

121 ià((
r
 % (
x
 + 13)) == 0) {

122 
x
 = 0;

125 ià((
r
 % (
x
 + 17)) == 0) {

126 
x
 = 0;

129 ià((
r
 % (
x
 + 19)) == 0) {

130 
x
 = 0;

133 ià((
r
 % (
x
 + 23)) == 0) {

134 
x
 = 0;

137 ià((
r
 % (
x
 + 29)) == 0) {

138 
x
 = 0;

142 } 
x
 == 0);

143 ià(
r
 > 31è{ 
	`fwr™e
(&r, 1, (
mp_dig™
), 
out
); 
	`´štf
("%9d\r",„); 
	`fæush
(
¡dout
); }

144 ià(
r
 < 31) ;

147 
	`fşo£
(
out
);

148 
	}
}

150 
	$lßd_b
()

152 
´imes
 = 
	`fİ’
("pprime.dat", "rb");

153 ià(
´imes
 =ğ
NULL
) {

154 
	`g’_´ime
();

155 
´imes
 = 
	`fİ’
("pprime.dat", "rb");

157 
	`f£ek
(
´imes
, 0, 
SEEK_END
);

158 
n_´ime
 = 
	`á–l
(
´imes
è/ (
mp_dig™
);

159 
	}
}

161 
mp_dig™
 
	$´ime_dig™
()

163 
n
;

164 
mp_dig™
 
d
;

166 
n
 = 
	`abs
(
	`¿nd
()è% 
n_´ime
;

167 
	`f£ek
(
´imes
, 
n
 * (
mp_dig™
), 
SEEK_SET
);

168 
	`ä—d
(&
d
, 1, (
mp_dig™
), 
´imes
);

169  
d
;

170 
	}
}

175 
	$µrime
 (
k
, 
li
, 
mp_št
 * 
p
, mp_šˆ* 
q
)

177 
mp_št
 
a
, 
b
, 
c
, 
n
, 
x
, 
y
, 
z
, 
v
;

178 
»s
, 
ii
;

179 cÚ¡ 
mp_dig™
 
ba£s
[] = { 2, 3, 5, 7, 11, 13, 17, 19 };

182 ià(
k
 <ğ(è
DIGIT_BIT
) {

183 
	`mp_£t
 (
p
, 
	`´ime_dig™
 ());

184  
MP_OKAY
;

187 ià((
»s
 = 
	`mp_š™
 (&
c
)è!ğ
MP_OKAY
) {

188  
»s
;

191 ià((
»s
 = 
	`mp_š™
 (&
v
)è!ğ
MP_OKAY
) {

192 
LBL_C
;

196 ià((
»s
 =

197 
	`mp_»ad_¿dix
 (&
v
,

199 10)è!ğ
MP_OKAY
) {

200 
LBL_V
;

203 ià((
»s
 = 
	`mp_š™
 (&
a
)è!ğ
MP_OKAY
) {

204 
LBL_V
;

208 
	`mp_£t
 (&
a
, 
	`´ime_dig™
 ());

210 ià((
»s
 = 
	`mp_š™
 (&
b
)è!ğ
MP_OKAY
) {

211 
LBL_A
;

214 ià((
»s
 = 
	`mp_š™
 (&
n
)è!ğ
MP_OKAY
) {

215 
LBL_B
;

218 ià((
»s
 = 
	`mp_š™
 (&
x
)è!ğ
MP_OKAY
) {

219 
LBL_N
;

222 ià((
»s
 = 
	`mp_š™
 (&
y
)è!ğ
MP_OKAY
) {

223 
LBL_X
;

226 ià((
»s
 = 
	`mp_š™
 (&
z
)è!ğ
MP_OKAY
) {

227 
LBL_Y
;

231 
	`mp_couÁ_b™s
 (&
a
è< 
k
) {

232 
	`årštf
 (
¡d”r
, "´imha %4d b™ Ëá\r", 
k
 - 
	`mp_couÁ_b™s
 (&
a
));

233 
	`fæush
 (
¡d”r
);

234 
tİ
:

235 
	`mp_£t
 (&
b
, 
	`´ime_dig™
 ());

238 ià((
»s
 = 
	`mp_mul
 (&
a
, &
b
, &
z
)è!ğ
MP_OKAY
) {

239 
LBL_Z
;

242 ià((
»s
 = 
	`mp_cİy
 (&
z
, &
c
)è!ğ
MP_OKAY
) {

243 
LBL_Z
;

246 ià((
»s
 = 
	`mp_mul_2
 (&
z
, &z)è!ğ
MP_OKAY
) {

247 
LBL_Z
;

251 ià((
»s
 = 
	`mp_add_d
 (&
z
, 1, &
n
)è!ğ
MP_OKAY
) {

252 
LBL_Z
;

256 ià((
»s
 = 
	`mp_gcd
 (&
n
, &
v
, &
y
)è!ğ
MP_OKAY
) {

257 
LBL_Z
;

260 ià(
	`mp_cmp_d
 (&
y
, 1è!ğ
MP_EQ
)

261 
tİ
;

264 
ii
 = 0; i˜< 
li
; ii++) {

265 
	`mp_£t
 (&
x
, 
ba£s
[
ii
]);

268 ià((
»s
 = 
	`mp_ex±mod
 (&
x
, &
a
, &
n
, &
y
)è!ğ
MP_OKAY
) {

269 
LBL_Z
;

273 ià(
	`mp_cmp_d
 (&
y
, 1è=ğ
MP_EQ
)

277 ià((
»s
 = 
	`mp_sqrmod
 (&
y
, &
n
, &y)è!ğ
MP_OKAY
) {

278 
LBL_Z
;

281 ià(
	`mp_cmp_d
 (&
y
, 1è=ğ
MP_EQ
)

285 ià((
»s
 = 
	`mp_ex±mod
 (&
x
, &
b
, &
n
, &
y
)è!ğ
MP_OKAY
) {

286 
LBL_Z
;

290 ià(
	`mp_cmp_d
 (&
y
, 1è=ğ
MP_EQ
)

294 ià((
»s
 = 
	`mp_sqrmod
 (&
y
, &
n
, &y)è!ğ
MP_OKAY
) {

295 
LBL_Z
;

298 ià(
	`mp_cmp_d
 (&
y
, 1è=ğ
MP_EQ
)

302 ià((
»s
 = 
	`mp_ex±mod
 (&
x
, &
c
, &
n
, &
y
)è!ğ
MP_OKAY
) {

303 
LBL_Z
;

307 ià(
	`mp_cmp_d
 (&
y
, 1è=ğ
MP_EQ
)

311 ià((
»s
 = 
	`mp_sqrmod
 (&
y
, &
n
, &y)è!ğ
MP_OKAY
) {

312 
LBL_Z
;

316 ià(
	`mp_cmp_d
 (&
y
, 1è!ğ
MP_EQ
)

322 ià(
ii
 =ğ
li
)

323 
tİ
;

326 
buf
[4096];

328 
	`mp_tÜadix
(&
n
, 
buf
, 10);

329 
	`´štf
("C”tifiÿ‹ oà´im®™y fÜ:\n%s\n\n", 
buf
);

330 
	`mp_tÜadix
(&
a
, 
buf
, 10);

331 
	`´štf
("A =ğ\n%s\n\n", 
buf
);

332 
	`mp_tÜadix
(&
b
, 
buf
, 10);

333 
	`´štf
("B =ğ\n%s\n\nG =ğ%d\n", 
buf
, 
ba£s
[
ii
]);

334 
	`´štf
("----------------------------------------------------------------\n");

338 
	`mp_cİy
 (&
n
, &
a
);

342 
	`mp_sub_d
 (&
n
, 1, 
q
);

343 
	`mp_div_2
 (
q
, q);

344 
	`mp_div
 (
q
, &
b
, q, 
NULL
);

346 
	`mp_exch
 (&
n
, 
p
);

348 
»s
 = 
MP_OKAY
;

349 
LBL_Z
:
	`mp_ş—r
 (&
z
);

350 
LBL_Y
:
	`mp_ş—r
 (&
y
);

351 
LBL_X
:
	`mp_ş—r
 (&
x
);

352 
LBL_N
:
	`mp_ş—r
 (&
n
);

353 
LBL_B
:
	`mp_ş—r
 (&
b
);

354 
LBL_A
:
	`mp_ş—r
 (&
a
);

355 
LBL_V
:
	`mp_ş—r
 (&
v
);

356 
LBL_C
:
	`mp_ş—r
 (&
c
);

357  
»s
;

358 
	}
}

362 
	$maš
 ()

364 
mp_št
 
p
, 
q
;

365 
buf
[4096];

366 
k
, 
li
;

367 
şock_t
 
t1
;

369 
	`¤ªd
 (
	`time
 (
NULL
));

370 
	`lßd_b
();

372 
	`´štf
 ("Enter # of bits: \n");

373 
	`fg‘s
 (
buf
,  (buf), 
¡dš
);

374 
	`ssÿnf
 (
buf
, "%d", &
k
);

376 
	`´štf
 ("Enter‚umber of basesory (1o 8):\n");

377 
	`fg‘s
 (
buf
,  (buf), 
¡dš
);

378 
	`ssÿnf
 (
buf
, "%d", &
li
);

381 
	`mp_š™
 (&
p
);

382 
	`mp_š™
 (&
q
);

384 
t1
 = 
	`şock
 ();

385 
	`µrime
 (
k
, 
li
, &
p
, &
q
);

386 
t1
 = 
	`şock
 () -1;

388 
	`´štf
 ("\n\nTook %ldicks, %d b™s\n", 
t1
, 
	`mp_couÁ_b™s
 (&
p
));

390 
	`mp_tÜadix
 (&
p
, 
buf
, 10);

391 
	`´štf
 ("P =ğ%s\n", 
buf
);

392 
	`mp_tÜadix
 (&
q
, 
buf
, 10);

393 
	`´štf
 ("Q =ğ%s\n", 
buf
);

396 
	}
}

	@libtommath/etc/tune.c

5 
	~<tomm©h.h
>

6 
	~<time.h
>

11 
	#TIMES
 (1UL<<14UL)

	)

14 
ulÚg64
 
	$TIMFUNC
 ()

16 #ià
defšed
 
__GNUC__


17 #ià
	`defšed
(
__i386__
è|| defšed(
__x86_64__
)

18 
a
;

19 
__asm__
 
	`__vŞ©e__
 ("rdtsc\nmovÈ%%—x,%0\nmovÈ%%edx,4+%0\n"::"m"(
a
):"%eax","%edx");

20  
a
;

22 
»suÉ
;

23 
__asm__
 
	`__vŞ©e__
("mov %0÷r.™c" : "ô"(
»suÉ
) :: "memory");

24 
	`__butš_ex³ù
 ((è
»suÉ
 == -1, 0))

25 
__asm__
 
	`__vŞ©e__
("mov %0÷r.™c" : "ô"(
»suÉ
) :: "memory");

26  
»suÉ
;

30 #–ià
defšed
 
_M_IX86


31 
__asm
 
rdtsc


32 #–ià
defšed
 
_M_AMD64


33  
	`__rdtsc
 ();

34 #–ià
defšed
 
_M_IA64


35 #ià
defšed
 
__INTEL_COMPILER


36 
	~<Ÿ64šŒš.h
>

38  
	`__g‘Reg
 (3116);

40 #”rÜ 
Ãed
 
rdtsc
 
funùiÚ
 
this
 
bud


42 
	}
}

45 #iâdeà
X86_TIMER


48 
ulÚg64
 
	gLBL_T
;

49 
	$t_¡¬t
(è{ 
LBL_T
 = 
	`TIMFUNC
(); 
	}
}

50 
ulÚg64
 
	$t_»ad
(è{  
	`TIMFUNC
(è- 
LBL_T
; 
	}
}

53 
t_¡¬t
();

54 
ulÚg64
 
t_»ad
();

57 
ulÚg64
 
	$time_muÉ
(
size
, 
s
)

59 
x
;

60 
mp_št
 
a
, 
b
, 
c
;

61 
ulÚg64
 
t1
;

63 
	`mp_š™
 (&
a
);

64 
	`mp_š™
 (&
b
);

65 
	`mp_š™
 (&
c
);

67 
	`mp_¿nd
 (&
a
, 
size
);

68 
	`mp_¿nd
 (&
b
, 
size
);

70 ià(
s
 == 1) {

71 
KARATSUBA_MUL_CUTOFF
 = 
size
;

73 
KARATSUBA_MUL_CUTOFF
 = 100000;

76 
	`t_¡¬t
();

77 
x
 = 0; x < 
TIMES
; x++) {

78 
	`mp_mul
(&
a
,&
b
,&
c
);

80 
t1
 = 
	`t_»ad
();

81 
	`mp_ş—r
 (&
a
);

82 
	`mp_ş—r
 (&
b
);

83 
	`mp_ş—r
 (&
c
);

84  
t1
;

85 
	}
}

87 
ulÚg64
 
	$time_sqr
(
size
, 
s
)

89 
x
;

90 
mp_št
 
a
, 
b
;

91 
ulÚg64
 
t1
;

93 
	`mp_š™
 (&
a
);

94 
	`mp_š™
 (&
b
);

96 
	`mp_¿nd
 (&
a
, 
size
);

98 ià(
s
 == 1) {

99 
KARATSUBA_SQR_CUTOFF
 = 
size
;

101 
KARATSUBA_SQR_CUTOFF
 = 100000;

104 
	`t_¡¬t
();

105 
x
 = 0; x < 
TIMES
; x++) {

106 
	`mp_sqr
(&
a
,&
b
);

108 
t1
 = 
	`t_»ad
();

109 
	`mp_ş—r
 (&
a
);

110 
	`mp_ş—r
 (&
b
);

111  
t1
;

112 
	}
}

115 
	$maš
 ()

117 
ulÚg64
 
t1
, 
t2
;

118 
x
, 
y
;

120 
x
 = 8; ; x += 2) {

121 
t1
 = 
	`time_muÉ
(
x
, 0);

122 
t2
 = 
	`time_muÉ
(
x
, 1);

123 
	`´štf
("%d: %9Îu %9Îu, %9Îu\n", 
x
, 
t1
, 
t2
,2 -1);

124 ià(
t2
 < 
t1
) ;

126 
y
 = 
x
;

128 
x
 = 8; ; x += 2) {

129 
t1
 = 
	`time_sqr
(
x
, 0);

130 
t2
 = 
	`time_sqr
(
x
, 1);

131 
	`´štf
("%d: %9Îu %9Îu, %9Îu\n", 
x
, 
t1
, 
t2
,2 -1);

132 ià(
t2
 < 
t1
) ;

134 
	`´štf
("KARATSUBA_MUL_CUTOFF = %d\n", 
y
);

135 
	`´štf
("KARATSUBA_SQR_CUTOFF = %d\n", 
x
);

138 
	}
}

	@libtommath/mtest/logtab.h

1 cÚ¡ 
	gs_logv_2
[] = {

	@libtommath/mtest/mpi-config.h

4 #iâdeà
MPI_CONFIG_H_


5 
	#MPI_CONFIG_H_


	)

16 #iâdeà
MP_IOFUNC


17 
	#MP_IOFUNC
 0

	)

20 #iâdeà
MP_MODARITH


21 
	#MP_MODARITH
 1

	)

24 #iâdeà
MP_NUMTH


25 
	#MP_NUMTH
 1

	)

28 #iâdeà
MP_LOGTAB


29 
	#MP_LOGTAB
 1

	)

32 #iâdeà
MP_MEMSET


33 
	#MP_MEMSET
 1

	)

36 #iâdeà
MP_MEMCPY


37 
	#MP_MEMCPY
 1

	)

40 #iâdeà
MP_CRYPTO


41 
	#MP_CRYPTO
 1

	)

44 #iâdeà
MP_ARGCHK


50 
	#MP_ARGCHK
 2

	)

53 #iâdeà
MP_DEBUG


54 
	#MP_DEBUG
 0

	)

57 #iâdeà
MP_DEFPREC


58 
	#MP_DEFPREC
 64

	)

61 #iâdeà
MP_MACRO


62 
	#MP_MACRO
 1

	)

65 #iâdeà
MP_SQUARE


66 
	#MP_SQUARE
 1

	)

69 #iâdeà
MP_PTAB_SIZE


76 
	#MP_PTAB_SIZE
 128

	)

79 #iâdeà
MP_COMPAT_MACROS


80 
	#MP_COMPAT_MACROS
 1

	)

	@libtommath/mtest/mpi-types.h

2 
	tmp_sign
;

3 
	tmp_dig™
;

4 
	tmp_wÜd
;

5 
	tmp_size
;

6 
	tmp_”r
;

8 
	#MP_DIGIT_BIT
 (
CHAR_BIT
*(
mp_dig™
))

	)

9 
	#MP_DIGIT_MAX
 
USHRT_MAX


	)

10 
	#MP_WORD_BIT
 (
CHAR_BIT
*(
mp_wÜd
))

	)

11 
	#MP_WORD_MAX
 
UINT_MAX


	)

13 
	#MP_DIGIT_SIZE
 2

	)

14 
	#DIGIT_FMT
 "%04X"

	)

15 
	#RADIX
 (
MP_DIGIT_MAX
+1)

	)

	@libtommath/mtest/mpi.c

12 
	~"mpi.h
"

13 
	~<¡dlib.h
>

14 
	~<¡ršg.h
>

15 
	~<ùy³.h
>

17 #ià
MP_DEBUG


18 
	~<¡dio.h
>

20 
	#DIAG
(
T
,
V
è{
	`årštf
(
¡d”r
,T);
	`mp_´št
(V,¡d”r);
	`åutc
('\n',¡d”r);}

	)

22 
	#DIAG
(
T
,
V
)

	)

30 #ià
MP_LOGTAB


49 
	~"logb.h
"

52 
	#LOG_V_2
(
R
è
s_logv_2
[(R)]

	)

56 
	~<m©h.h
>

57 
	#LOG_V_2
(
R
è(
	`log
(2.0)/log(R))

	)

62 
	gs_mp_deå»c
 = 
MP_DEFPREC
;

78 
	#CARRYOUT
(
W
è((W)>>
DIGIT_BIT
)

	)

79 
	#ACCUM
(
W
è((W)&
MP_DIGIT_MAX
)

	)

85 
	#MP_LT
 -1

	)

86 
	#MP_EQ
 0

	)

87 
	#MP_GT
 1

	)

94 cÚ¡ *
	gmp_”r_¡ršg
[] = {

107 cÚ¡ *
	gs_dm­_1
 =

112 cÚ¡ *
	gs_dm­_2
 =

132 #ià
MP_MACRO
 == 0

133 
s_mp_£tz
(
mp_dig™
 *
dp
, 
mp_size
 
couÁ
);

134 
s_mp_cİy
(
mp_dig™
 *
¥
, mp_dig™ *
dp
, 
mp_size
 
couÁ
);

135 *
s_mp_®loc
(
size_t
 
nb
, size_ˆ
ni
);

136 
s_mp_ä“
(*
±r
);

142 #ià
MP_MEMSET
 == 0

143 
	#s_mp_£tz
(
dp
, 
couÁ
) \

144 {
ix
;ix=0;ix<(
couÁ
);ix++)(
dp
)[ix]=0;}

	)

146 
	#s_mp_£tz
(
dp
, 
couÁ
è
	`mem£t
(dp, 0, (couÁè* (
mp_dig™
))

	)

149 #ià
MP_MEMCPY
 == 0

150 
	#s_mp_cİy
(
¥
, 
dp
, 
couÁ
) \

151 {
ix
;ix=0;ix<(
couÁ
);ix++)(
dp
)[ix]=(
¥
)[ix];}

	)

153 
	#s_mp_cİy
(
¥
, 
dp
, 
couÁ
è
	`memıy
(dp, sp, (couÁè* (
mp_dig™
))

	)

156 
	#s_mp_®loc
(
nb
, 
ni
è
	`ÿÎoc
Òb,‚i)

	)

157 
	#s_mp_ä“
(
±r
è{ifÕŒè
	`ä“
ÕŒ);}

	)

160 
mp_”r
 
s_mp_grow
(
mp_št
 *
mp
, 
mp_size
 
mš
);

161 
mp_”r
 
s_mp_·d
(
mp_št
 *
mp
, 
mp_size
 
mš
);

163 
s_mp_şamp
(
mp_št
 *
mp
);

165 
s_mp_exch
(
mp_št
 *
a
, mp_šˆ*
b
);

167 
mp_”r
 
s_mp_lshd
(
mp_št
 *
mp
, 
mp_size
 
p
);

168 
s_mp_rshd
(
mp_št
 *
mp
, 
mp_size
 
p
);

169 
s_mp_div_2d
(
mp_št
 *
mp
, 
mp_dig™
 
d
);

170 
s_mp_mod_2d
(
mp_št
 *
mp
, 
mp_dig™
 
d
);

171 
mp_”r
 
s_mp_mul_2d
(
mp_št
 *
mp
, 
mp_dig™
 
d
);

172 
s_mp_div_2
(
mp_št
 *
mp
);

173 
mp_”r
 
s_mp_mul_2
(
mp_št
 *
mp
);

174 
mp_dig™
 
s_mp_nÜm
(
mp_št
 *
a
, mp_šˆ*
b
);

175 
mp_”r
 
s_mp_add_d
(
mp_št
 *
mp
, 
mp_dig™
 
d
);

176 
mp_”r
 
s_mp_sub_d
(
mp_št
 *
mp
, 
mp_dig™
 
d
);

177 
mp_”r
 
s_mp_mul_d
(
mp_št
 *
mp
, 
mp_dig™
 
d
);

178 
mp_”r
 
s_mp_div_d
(
mp_št
 *
mp
, 
mp_dig™
 
d
, mp_dig™ *
r
);

180 
mp_”r
 
s_mp_»duû
(
mp_št
 *
x
, mp_šˆ*
m
, mp_šˆ*
mu
);

182 
mp_”r
 
s_mp_add
(
mp_št
 *
a
, mp_šˆ*
b
);

183 
mp_”r
 
s_mp_sub
(
mp_št
 *
a
, mp_šˆ*
b
);

184 
mp_”r
 
s_mp_mul
(
mp_št
 *
a
, mp_šˆ*
b
);

186 
s_mp_kmul
(
mp_dig™
 *
a
, mp_dig™ *
b
, mp_dig™ *
out
, 
mp_size
 
Ën
);

189 #ià
MP_SQUARE


190 
mp_”r
 
s_mp_sqr
(
mp_št
 *
a
);

192 
	#s_mp_sqr
(
a
è
	`s_mp_mul
×,‡)

	)

194 
mp_”r
 
s_mp_div
(
mp_št
 *
a
, mp_šˆ*
b
);

195 
mp_”r
 
s_mp_2ex±
(
mp_št
 *
a
, 
mp_dig™
 
k
);

196 
s_mp_cmp
(
mp_št
 *
a
, mp_šˆ*
b
);

197 
s_mp_cmp_d
(
mp_št
 *
a
, 
mp_dig™
 
d
);

198 
s_mp_i¥ow2
(
mp_št
 *
v
);

199 
s_mp_i¥ow2d
(
mp_dig™
 
d
);

201 
s_mp_tov®ue
(
ch
, 
r
);

202 
s_mp_todig™
(
v®
, 
r
, 
low
);

203 
s_mp_ou’
(
b™s
, 
r
);

209 
	$mp_g‘_´ec
()

211  
s_mp_deå»c
;

213 
	}
}

215 
	$mp_£t_´ec
(
´ec
)

217 if(
´ec
 == 0)

218 
s_mp_deå»c
 = 
MP_DEFPREC
;

220 
s_mp_deå»c
 = 
´ec
;

222 
	}
}

236 
mp_”r
 
	$mp_š™
(
mp_št
 *
mp
)

238  
	`mp_š™_size
(
mp
, 
s_mp_deå»c
);

240 
	}
}

246 
mp_”r
 
	$mp_š™_¬¿y
(
mp_št
 
mp
[], 
couÁ
)

248 
mp_”r
 
»s
;

249 
pos
;

251 
	`ARGCHK
(
mp
 !=
NULL
 && 
couÁ
 > 0, 
MP_BADARG
);

253 
pos
 = 0;…o < 
couÁ
; ++pos) {

254 if((
»s
 = 
	`mp_š™
(&
mp
[
pos
])è!ğ
MP_OKAY
)

255 
CLEANUP
;

258  
MP_OKAY
;

260 
CLEANUP
:

261 --
pos
 >= 0)

262 
	`mp_ş—r
(&
mp
[
pos
]);

264  
»s
;

266 
	}
}

280 
mp_”r
 
	$mp_š™_size
(
mp_št
 *
mp
, 
mp_size
 
´ec
)

282 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
´ec
 > 0, 
MP_BADARG
);

284 if((
	`DIGITS
(
mp
èğ
	`s_mp_®loc
(
´ec
, (
mp_dig™
))è=ğ
NULL
)

285  
MP_MEM
;

287 
	`SIGN
(
mp
èğ
MP_ZPOS
;

288 
	`USED
(
mp
) = 1;

289 
	`ALLOC
(
mp
èğ
´ec
;

291  
MP_OKAY
;

293 
	}
}

307 
mp_”r
 
	$mp_š™_cİy
(
mp_št
 *
mp
, mp_šˆ*
äom
)

309 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
äom
 !ğNULL, 
MP_BADARG
);

311 if(
mp
 =ğ
äom
)

312  
MP_OKAY
;

314 if((
	`DIGITS
(
mp
èğ
	`s_mp_®loc
(
	`USED
(
äom
), (
mp_dig™
))è=ğ
NULL
)

315  
MP_MEM
;

317 
	`s_mp_cİy
(
	`DIGITS
(
äom
), DIGITS(
mp
), 
	`USED
(from));

318 
	`USED
(
mp
èğUSED(
äom
);

319 
	`ALLOC
(
mp
èğ
	`USED
(
äom
);

320 
	`SIGN
(
mp
èğSIGN(
äom
);

322  
MP_OKAY
;

324 
	}
}

338 
mp_”r
 
	$mp_cİy
(
mp_št
 *
äom
, mp_šˆ*
to
)

340 
	`ARGCHK
(
äom
 !ğ
NULL
 && 
to
 !ğNULL, 
MP_BADARG
);

342 if(
äom
 =ğ
to
)

343  
MP_OKAY
;

346 
mp_dig™
 *
tmp
;

355 if(
	`ALLOC
(
to
è>ğ
	`USED
(
äom
)) {

356 
	`s_mp_£tz
(
	`DIGITS
(
to
è+ 
	`USED
(
äom
), 
	`ALLOC
(to) - USED(from));

357 
	`s_mp_cİy
(
	`DIGITS
(
äom
), DIGITS(
to
), 
	`USED
(from));

360 if((
tmp
 = 
	`s_mp_®loc
(
	`USED
(
äom
), (
mp_dig™
))è=ğ
NULL
)

361  
MP_MEM
;

363 
	`s_mp_cİy
(
	`DIGITS
(
äom
), 
tmp
, 
	`USED
(from));

365 if(
	`DIGITS
(
to
è!ğ
NULL
) {

366 #ià
MP_CRYPTO


367 
	`s_mp_£tz
(
	`DIGITS
(
to
), 
	`ALLOC
(to));

369 
	`s_mp_ä“
(
	`DIGITS
(
to
));

372 
	`DIGITS
(
to
èğ
tmp
;

373 
	`ALLOC
(
to
èğ
	`USED
(
äom
);

377 
	`USED
(
to
èğUSED(
äom
);

378 
	`SIGN
(
to
èğSIGN(
äom
);

381  
MP_OKAY
;

383 
	}
}

397 
	$mp_exch
(
mp_št
 *
mp1
, mp_šˆ*
mp2
)

399 #ià
MP_ARGCHK
 == 2

400 
	`as£¹
(
mp1
 !ğ
NULL
 && 
mp2
 != NULL);

402 if(
mp1
 =ğ
NULL
 || 
mp2
 == NULL)

406 
	`s_mp_exch
(
mp1
, 
mp2
);

408 
	}
}

422 
	$mp_ş—r
(
mp_št
 *
mp
)

424 if(
mp
 =ğ
NULL
)

427 if(
	`DIGITS
(
mp
è!ğ
NULL
) {

428 #ià
MP_CRYPTO


429 
	`s_mp_£tz
(
	`DIGITS
(
mp
), 
	`ALLOC
(mp));

431 
	`s_mp_ä“
(
	`DIGITS
(
mp
));

432 
	`DIGITS
(
mp
èğ
NULL
;

435 
	`USED
(
mp
) = 0;

436 
	`ALLOC
(
mp
) = 0;

438 
	}
}

444 
	$mp_ş—r_¬¿y
(
mp_št
 
mp
[], 
couÁ
)

446 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
couÁ
 > 0, 
MP_BADARG
);

448 --
couÁ
 >= 0)

449 
	`mp_ş—r
(&
mp
[
couÁ
]);

451 
	}
}

463 
	$mp_z”o
(
mp_št
 *
mp
)

465 if(
mp
 =ğ
NULL
)

468 
	`s_mp_£tz
(
	`DIGITS
(
mp
), 
	`ALLOC
(mp));

469 
	`USED
(
mp
) = 1;

470 
	`SIGN
(
mp
èğ
MP_ZPOS
;

472 
	}
}

478 
	$mp_£t
(
mp_št
 *
mp
, 
mp_dig™
 
d
)

480 if(
mp
 =ğ
NULL
)

483 
	`mp_z”o
(
mp
);

484 
	`DIGIT
(
mp
, 0èğ
d
;

486 
	}
}

492 
mp_”r
 
	$mp_£t_št
(
mp_št
 *
mp
, 
z
)

494 
ix
;

495 
v
 = 
	`abs
(
z
);

496 
mp_”r
 
»s
;

498 
	`ARGCHK
(
mp
 !ğ
NULL
, 
MP_BADARG
);

500 
	`mp_z”o
(
mp
);

501 if(
z
 == 0)

502  
MP_OKAY
;

504 
ix
 = () - 1; ix >= 0; ix--) {

506 if((
»s
 = 
	`s_mp_mul_2d
(
mp
, 
CHAR_BIT
)è!ğ
MP_OKAY
)

507  
»s
;

509 
»s
 = 
	`s_mp_add_d
(
mp
,

510 (
mp_dig™
)((
v
 >> (
ix
 * 
CHAR_BIT
)è& 
UCHAR_MAX
));

511 if(
»s
 !ğ
MP_OKAY
)

512  
»s
;

516 if(
z
 < 0)

517 
	`SIGN
(
mp
èğ
MP_NEG
;

519  
MP_OKAY
;

521 
	}
}

537 
mp_”r
 
	$mp_add_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
b
)

539 
mp_”r
 
»s
 = 
MP_OKAY
;

541 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

543 if((
»s
 = 
	`mp_cİy
(
a
, 
b
)è!ğ
MP_OKAY
)

544  
»s
;

546 if(
	`SIGN
(
b
è=ğ
MP_ZPOS
) {

547 
»s
 = 
	`s_mp_add_d
(
b
, 
d
);

548 } if(
	`s_mp_cmp_d
(
b
, 
d
) >= 0) {

549 
»s
 = 
	`s_mp_sub_d
(
b
, 
d
);

551 
	`SIGN
(
b
èğ
MP_ZPOS
;

553 
	`DIGIT
(
b
, 0èğ
d
 - DIGIT(b, 0);

556  
»s
;

558 
	}
}

571 
mp_”r
 
	$mp_sub_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
b
)

573 
mp_”r
 
»s
;

575 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

577 if((
»s
 = 
	`mp_cİy
(
a
, 
b
)è!ğ
MP_OKAY
)

578  
»s
;

580 if(
	`SIGN
(
b
è=ğ
MP_NEG
) {

581 if((
»s
 = 
	`s_mp_add_d
(
b
, 
d
)è!ğ
MP_OKAY
)

582  
»s
;

584 } if(
	`s_mp_cmp_d
(
b
, 
d
) >= 0) {

585 if((
»s
 = 
	`s_mp_sub_d
(
b
, 
d
)è!ğ
MP_OKAY
)

586  
»s
;

589 
	`mp_Ãg
(
b
, b);

591 
	`DIGIT
(
b
, 0èğ
d
 - DIGIT(b, 0);

592 
	`SIGN
(
b
èğ
MP_NEG
;

595 if(
	`s_mp_cmp_d
(
b
, 0) == 0)

596 
	`SIGN
(
b
èğ
MP_ZPOS
;

598  
MP_OKAY
;

600 
	}
}

613 
mp_”r
 
	$mp_mul_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
b
)

615 
mp_”r
 
»s
;

617 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

619 if(
d
 == 0) {

620 
	`mp_z”o
(
b
);

621  
MP_OKAY
;

624 if((
»s
 = 
	`mp_cİy
(
a
, 
b
)è!ğ
MP_OKAY
)

625  
»s
;

627 
»s
 = 
	`s_mp_mul_d
(
b
, 
d
);

629  
»s
;

631 
	}
}

637 
mp_”r
 
	$mp_mul_2
(
mp_št
 *
a
, mp_šˆ*
c
)

639 
mp_”r
 
»s
;

641 
	`ARGCHK
(
a
 !ğ
NULL
 && 
c
 !ğNULL, 
MP_BADARG
);

643 if((
»s
 = 
	`mp_cİy
(
a
, 
c
)è!ğ
MP_OKAY
)

644  
»s
;

646  
	`s_mp_mul_2
(
c
);

648 
	}
}

662 
mp_”r
 
	$mp_div_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
q
, mp_dig™ *
r
)

664 
mp_”r
 
»s
;

665 
mp_dig™
 
»m
;

666 
pow
;

668 
	`ARGCHK
(
a
 !ğ
NULL
, 
MP_BADARG
);

670 if(
d
 == 0)

671  
MP_RANGE
;

674 if((
pow
 = 
	`s_mp_i¥ow2d
(
d
)) >= 0) {

675 
mp_dig™
 
mask
;

677 
mask
 = (1 << 
pow
) - 1;

678 
»m
 = 
	`DIGIT
(
a
, 0è& 
mask
;

680 if(
q
) {

681 
	`mp_cİy
(
a
, 
q
);

682 
	`s_mp_div_2d
(
q
, 
pow
);

685 if(
r
)

686 *
r
 = 
»m
;

688  
MP_OKAY
;

701 if(
q
) {

702 if((
»s
 = 
	`mp_cİy
(
a
, 
q
)è!ğ
MP_OKAY
)

703  
»s
;

705 
»s
 = 
	`s_mp_div_d
(
q
, 
d
, &
»m
);

706 if(
	`s_mp_cmp_d
(
q
, 0è=ğ
MP_EQ
)

707 
	`SIGN
(
q
èğ
MP_ZPOS
;

710 
mp_št
 
qp
;

712 if((
»s
 = 
	`mp_š™_cİy
(&
qp
, 
a
)è!ğ
MP_OKAY
)

713  
»s
;

715 
»s
 = 
	`s_mp_div_d
(&
qp
, 
d
, &
»m
);

716 if(
	`s_mp_cmp_d
(&
qp
, 0) == 0)

717 
	`SIGN
(&
qp
èğ
MP_ZPOS
;

719 
	`mp_ş—r
(&
qp
);

722 if(
r
)

723 *
r
 = 
»m
;

725  
»s
;

727 
	}
}

739 
mp_”r
 
	$mp_div_2
(
mp_št
 *
a
, mp_šˆ*
c
)

741 
mp_”r
 
»s
;

743 
	`ARGCHK
(
a
 !ğ
NULL
 && 
c
 !ğNULL, 
MP_BADARG
);

745 if((
»s
 = 
	`mp_cİy
(
a
, 
c
)è!ğ
MP_OKAY
)

746  
»s
;

748 
	`s_mp_div_2
(
c
);

750  
MP_OKAY
;

752 
	}
}

758 
mp_”r
 
	$mp_ex±_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
c
)

760 
mp_št
 
s
, 
x
;

761 
mp_”r
 
»s
;

763 
	`ARGCHK
(
a
 !ğ
NULL
 && 
c
 !ğNULL, 
MP_BADARG
);

765 if((
»s
 = 
	`mp_š™
(&
s
)è!ğ
MP_OKAY
)

766  
»s
;

767 if((
»s
 = 
	`mp_š™_cİy
(&
x
, 
a
)è!ğ
MP_OKAY
)

768 
X
;

770 
	`DIGIT
(&
s
, 0) = 1;

772 
d
 != 0) {

773 if(
d
 & 1) {

774 if((
»s
 = 
	`s_mp_mul
(&
s
, &
x
)è!ğ
MP_OKAY
)

775 
CLEANUP
;

778 
d
 >>= 1;

780 if((
»s
 = 
	`s_mp_sqr
(&
x
)è!ğ
MP_OKAY
)

781 
CLEANUP
;

784 
	`s_mp_exch
(&
s
, 
c
);

786 
CLEANUP
:

787 
	`mp_ş—r
(&
x
);

788 
X
:

789 
	`mp_ş—r
(&
s
);

791  
»s
;

793 
	}
}

810 
mp_”r
 
	$mp_abs
(
mp_št
 *
a
, mp_šˆ*
b
)

812 
mp_”r
 
»s
;

814 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

816 if((
»s
 = 
	`mp_cİy
(
a
, 
b
)è!ğ
MP_OKAY
)

817  
»s
;

819 
	`SIGN
(
b
èğ
MP_ZPOS
;

821  
MP_OKAY
;

823 
	}
}

835 
mp_”r
 
	$mp_Ãg
(
mp_št
 *
a
, mp_šˆ*
b
)

837 
mp_”r
 
»s
;

839 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

841 if((
»s
 = 
	`mp_cİy
(
a
, 
b
)è!ğ
MP_OKAY
)

842  
»s
;

844 if(
	`s_mp_cmp_d
(
b
, 0è=ğ
MP_EQ
)

845 
	`SIGN
(
b
èğ
MP_ZPOS
;

847 
	`SIGN
(
b
èğ(SIGN(bè=ğ
MP_NEG
è? 
MP_ZPOS
 : MP_NEG;

849  
MP_OKAY
;

851 
	}
}

863 
mp_”r
 
	$mp_add
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

865 
mp_”r
 
»s
;

866 
cmp
;

868 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

870 if(
	`SIGN
(
a
è=ğSIGN(
b
)) {

876 if(
c
 =ğ
b
) {

877 if((
»s
 = 
	`s_mp_add
(
c
, 
a
)è!ğ
MP_OKAY
)

878  
»s
;

880 if(
c
 !ğ
a
 && (
»s
 = 
	`mp_cİy
×, c)è!ğ
MP_OKAY
)

881  
»s
;

883 if((
»s
 = 
	`s_mp_add
(
c
, 
b
)è!ğ
MP_OKAY
)

884  
»s
;

887 } if((
cmp
 = 
	`s_mp_cmp
(
a
, 
b
)) > 0) {

893 if(
c
 =ğ
b
) {

894 
mp_št
 
tmp
;

896 if((
»s
 = 
	`mp_š™_cİy
(&
tmp
, 
a
)è!ğ
MP_OKAY
)

897  
»s
;

898 if((
»s
 = 
	`s_mp_sub
(&
tmp
, 
b
)è!ğ
MP_OKAY
) {

899 
	`mp_ş—r
(&
tmp
);

900  
»s
;

903 
	`s_mp_exch
(&
tmp
, 
c
);

904 
	`mp_ş—r
(&
tmp
);

908 if(
c
 !ğ
a
 && (
»s
 = 
	`mp_cİy
×, c)è!ğ
MP_OKAY
)

909  
»s
;

910 if((
»s
 = 
	`s_mp_sub
(
c
, 
b
)è!ğ
MP_OKAY
)

911  
»s
;

915 } if(
cmp
 == 0) {

917 
	`mp_z”o
(
c
);

918  
MP_OKAY
;

923 if(
c
 =ğ
a
) {

924 
mp_št
 
tmp
;

926 if((
»s
 = 
	`mp_š™_cİy
(&
tmp
, 
b
)è!ğ
MP_OKAY
)

927  
»s
;

928 if((
»s
 = 
	`s_mp_sub
(&
tmp
, 
a
)è!ğ
MP_OKAY
) {

929 
	`mp_ş—r
(&
tmp
);

930  
»s
;

933 
	`s_mp_exch
(&
tmp
, 
c
);

934 
	`mp_ş—r
(&
tmp
);

938 if(
c
 !ğ
b
 && (
»s
 = 
	`mp_cİy
(b, c)è!ğ
MP_OKAY
)

939  
»s
;

940 if((
»s
 = 
	`s_mp_sub
(
c
, 
a
)è!ğ
MP_OKAY
)

941  
»s
;

946 if(
	`USED
(
c
è=ğ1 && 
	`DIGIT
(c, 0) == 0)

947 
	`SIGN
(
c
èğ
MP_ZPOS
;

949  
MP_OKAY
;

951 
	}
}

963 
mp_”r
 
	$mp_sub
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

965 
mp_”r
 
»s
;

966 
cmp
;

968 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

970 if(
	`SIGN
(
a
è!ğSIGN(
b
)) {

971 if(
c
 =ğ
a
) {

972 if((
»s
 = 
	`s_mp_add
(
c
, 
b
)è!ğ
MP_OKAY
)

973  
»s
;

975 if(
c
 !ğ
b
 && ((
»s
 = 
	`mp_cİy
(b, c)è!ğ
MP_OKAY
))

976  
»s
;

977 if((
»s
 = 
	`s_mp_add
(
c
, 
a
)è!ğ
MP_OKAY
)

978  
»s
;

979 
	`SIGN
(
c
èğSIGN(
a
);

982 } if((
cmp
 = 
	`s_mp_cmp
(
a
, 
b
)) > 0) {

983 if(
c
 =ğ
b
) {

984 
mp_št
 
tmp
;

986 if((
»s
 = 
	`mp_š™_cİy
(&
tmp
, 
a
)è!ğ
MP_OKAY
)

987  
»s
;

988 if((
»s
 = 
	`s_mp_sub
(&
tmp
, 
b
)è!ğ
MP_OKAY
) {

989 
	`mp_ş—r
(&
tmp
);

990  
»s
;

992 
	`s_mp_exch
(&
tmp
, 
c
);

993 
	`mp_ş—r
(&
tmp
);

996 if(
c
 !ğ
a
 && ((
»s
 = 
	`mp_cİy
×, c)è!ğ
MP_OKAY
))

997  
»s
;

999 if((
»s
 = 
	`s_mp_sub
(
c
, 
b
)è!ğ
MP_OKAY
)

1000  
»s
;

1003 } if(
cmp
 == 0) {

1004 
	`mp_z”o
(
c
);

1005  
MP_OKAY
;

1008 if(
c
 =ğ
a
) {

1009 
mp_št
 
tmp
;

1011 if((
»s
 = 
	`mp_š™_cİy
(&
tmp
, 
b
)è!ğ
MP_OKAY
)

1012  
»s
;

1014 if((
»s
 = 
	`s_mp_sub
(&
tmp
, 
a
)è!ğ
MP_OKAY
) {

1015 
	`mp_ş—r
(&
tmp
);

1016  
»s
;

1018 
	`s_mp_exch
(&
tmp
, 
c
);

1019 
	`mp_ş—r
(&
tmp
);

1022 if(
c
 !ğ
b
 && ((
»s
 = 
	`mp_cİy
(b, c)è!ğ
MP_OKAY
))

1023  
»s
;

1025 if((
»s
 = 
	`s_mp_sub
(
c
, 
a
)è!ğ
MP_OKAY
)

1026  
»s
;

1029 
	`SIGN
(
c
èğ!SIGN(
b
);

1032 if(
	`USED
(
c
è=ğ1 && 
	`DIGIT
(c, 0) == 0)

1033 
	`SIGN
(
c
èğ
MP_ZPOS
;

1035  
MP_OKAY
;

1037 
	}
}

1049 
mp_”r
 
	$mp_mul
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

1051 
mp_”r
 
»s
;

1052 
mp_sign
 
sgn
;

1054 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1056 
sgn
 = (
	`SIGN
(
a
è=ğSIGN(
b
)è? 
MP_ZPOS
 : 
MP_NEG
;

1058 if(
c
 =ğ
b
) {

1059 if((
»s
 = 
	`s_mp_mul
(
c
, 
a
)è!ğ
MP_OKAY
)

1060  
»s
;

1063 if((
»s
 = 
	`mp_cİy
(
a
, 
c
)è!ğ
MP_OKAY
)

1064  
»s
;

1066 if((
»s
 = 
	`s_mp_mul
(
c
, 
b
)è!ğ
MP_OKAY
)

1067  
»s
;

1070 if(
sgn
 =ğ
MP_ZPOS
 || 
	`s_mp_cmp_d
(
c
, 0è=ğ
MP_EQ
)

1071 
	`SIGN
(
c
èğ
MP_ZPOS
;

1073 
	`SIGN
(
c
èğ
sgn
;

1075  
MP_OKAY
;

1077 
	}
}

1089 
mp_”r
 
	$mp_mul_2d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
c
)

1091 
mp_”r
 
»s
;

1093 
	`ARGCHK
(
a
 !ğ
NULL
 && 
c
 !ğNULL, 
MP_BADARG
);

1095 if((
»s
 = 
	`mp_cİy
(
a
, 
c
)è!ğ
MP_OKAY
)

1096  
»s
;

1098 if(
d
 == 0)

1099  
MP_OKAY
;

1101  
	`s_mp_mul_2d
(
c
, 
d
);

1103 
	}
}

1109 #ià
MP_SQUARE


1110 
mp_”r
 
	$mp_sqr
(
mp_št
 *
a
, mp_šˆ*
b
)

1112 
mp_”r
 
»s
;

1114 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

1116 if((
»s
 = 
	`mp_cİy
(
a
, 
b
)è!ğ
MP_OKAY
)

1117  
»s
;

1119 if((
»s
 = 
	`s_mp_sqr
(
b
)è!ğ
MP_OKAY
)

1120  
»s
;

1122 
	`SIGN
(
b
èğ
MP_ZPOS
;

1124  
MP_OKAY
;

1126 
	}
}

1143 
mp_”r
 
	$mp_div
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
q
, mp_šˆ*
r
)

1145 
mp_”r
 
»s
;

1146 
mp_št
 
qtmp
, 
¹mp
;

1147 
cmp
;

1149 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

1151 if(
	`mp_cmp_z
(
b
è=ğ
MP_EQ
)

1152  
MP_RANGE
;

1157 if((
cmp
 = 
	`s_mp_cmp
(
a
, 
b
)) < 0) {

1158 if(
r
) {

1159 if((
»s
 = 
	`mp_cİy
(
a
, 
r
)è!ğ
MP_OKAY
)

1160  
»s
;

1163 if(
q
)

1164 
	`mp_z”o
(
q
);

1166  
MP_OKAY
;

1168 } if(
cmp
 == 0) {

1171 if(
q
) {

1172 
qÃg
 = (
	`SIGN
(
a
è!ğSIGN(
b
));

1174 
	`mp_£t
(
q
, 1);

1175 if(
qÃg
)

1176 
	`SIGN
(
q
èğ
MP_NEG
;

1179 if(
r
)

1180 
	`mp_z”o
(
r
);

1182  
MP_OKAY
;

1188 if((
»s
 = 
	`mp_š™_cİy
(&
qtmp
, 
a
)è!ğ
MP_OKAY
)

1189  
»s
;

1190 if((
»s
 = 
	`mp_š™_cİy
(&
¹mp
, 
b
)è!ğ
MP_OKAY
)

1191 
CLEANUP
;

1193 if((
»s
 = 
	`s_mp_div
(&
qtmp
, &
¹mp
)è!ğ
MP_OKAY
)

1194 
CLEANUP
;

1197 
	`SIGN
(&
¹mp
èğSIGN(
a
);

1198 if(
	`SIGN
(
a
è=ğSIGN(
b
))

1199 
	`SIGN
(&
qtmp
èğ
MP_ZPOS
;

1201 
	`SIGN
(&
qtmp
èğ
MP_NEG
;

1203 if(
	`s_mp_cmp_d
(&
qtmp
, 0è=ğ
MP_EQ
)

1204 
	`SIGN
(&
qtmp
èğ
MP_ZPOS
;

1205 if(
	`s_mp_cmp_d
(&
¹mp
, 0è=ğ
MP_EQ
)

1206 
	`SIGN
(&
¹mp
èğ
MP_ZPOS
;

1209 if(
q
)

1210 
	`s_mp_exch
(&
qtmp
, 
q
);

1212 if(
r
)

1213 
	`s_mp_exch
(&
¹mp
, 
r
);

1215 
CLEANUP
:

1216 
	`mp_ş—r
(&
¹mp
);

1217 
	`mp_ş—r
(&
qtmp
);

1219  
»s
;

1221 
	}
}

1227 
mp_”r
 
	$mp_div_2d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
q
, mp_šˆ*
r
)

1229 
mp_”r
 
»s
;

1231 
	`ARGCHK
(
a
 !ğ
NULL
, 
MP_BADARG
);

1233 if(
q
) {

1234 if((
»s
 = 
	`mp_cİy
(
a
, 
q
)è!ğ
MP_OKAY
)

1235  
»s
;

1237 
	`s_mp_div_2d
(
q
, 
d
);

1240 if(
r
) {

1241 if((
»s
 = 
	`mp_cİy
(
a
, 
r
)è!ğ
MP_OKAY
)

1242  
»s
;

1244 
	`s_mp_mod_2d
(
r
, 
d
);

1247  
MP_OKAY
;

1249 
	}
}

1262 
mp_”r
 
	$mp_ex±
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

1264 
mp_št
 
s
, 
x
;

1265 
mp_”r
 
»s
;

1266 
mp_dig™
 
d
;

1267 
dig
, 
b™
;

1269 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1271 if(
	`mp_cmp_z
(
b
) < 0)

1272  
MP_RANGE
;

1274 if((
»s
 = 
	`mp_š™
(&
s
)è!ğ
MP_OKAY
)

1275  
»s
;

1277 
	`mp_£t
(&
s
, 1);

1279 if((
»s
 = 
	`mp_š™_cİy
(&
x
, 
a
)è!ğ
MP_OKAY
)

1280 
X
;

1283 
dig
 = 0; dig < (
	`USED
(
b
) - 1); dig++) {

1284 
d
 = 
	`DIGIT
(
b
, 
dig
);

1287 
b™
 = 0; b™ < 
DIGIT_BIT
; bit++) {

1288 if(
d
 & 1) {

1289 if((
»s
 = 
	`s_mp_mul
(&
s
, &
x
)è!ğ
MP_OKAY
)

1290 
CLEANUP
;

1293 
d
 >>= 1;

1295 if((
»s
 = 
	`s_mp_sqr
(&
x
)è!ğ
MP_OKAY
)

1296 
CLEANUP
;

1301 
d
 = 
	`DIGIT
(
b
, 
dig
);

1303 
d
) {

1304 if(
d
 & 1) {

1305 if((
»s
 = 
	`s_mp_mul
(&
s
, &
x
)è!ğ
MP_OKAY
)

1306 
CLEANUP
;

1309 
d
 >>= 1;

1311 if((
»s
 = 
	`s_mp_sqr
(&
x
)è!ğ
MP_OKAY
)

1312 
CLEANUP
;

1315 if(
	`mp_i£v’
(
b
))

1316 
	`SIGN
(&
s
èğSIGN(
a
);

1318 
»s
 = 
	`mp_cİy
(&
s
, 
c
);

1320 
CLEANUP
:

1321 
	`mp_ş—r
(&
x
);

1322 
X
:

1323 
	`mp_ş—r
(&
s
);

1325  
»s
;

1327 
	}
}

1335 
mp_”r
 
	$mp_2ex±
(
mp_št
 *
a
, 
mp_dig™
 
k
)

1337 
	`ARGCHK
(
a
 !ğ
NULL
, 
MP_BADARG
);

1339  
	`s_mp_2ex±
(
a
, 
k
);

1341 
	}
}

1353 
mp_”r
 
	$mp_mod
(
mp_št
 *
a
, mp_šˆ*
m
, mp_šˆ*
c
)

1355 
mp_”r
 
»s
;

1356 
mag
;

1358 
	`ARGCHK
(
a
 !ğ
NULL
 && 
m
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1360 if(
	`SIGN
(
m
è=ğ
MP_NEG
)

1361  
MP_RANGE
;

1376 if((
mag
 = 
	`s_mp_cmp
(
a
, 
m
)) > 0) {

1377 if((
»s
 = 
	`mp_div
(
a
, 
m
, 
NULL
, 
c
)è!ğ
MP_OKAY
)

1378  
»s
;

1380 if(
	`SIGN
(
c
è=ğ
MP_NEG
) {

1381 if((
»s
 = 
	`mp_add
(
c
, 
m
, c)è!ğ
MP_OKAY
)

1382  
»s
;

1385 } if(
mag
 < 0) {

1386 if((
»s
 = 
	`mp_cİy
(
a
, 
c
)è!ğ
MP_OKAY
)

1387  
»s
;

1389 if(
	`mp_cmp_z
(
a
) < 0) {

1390 if((
»s
 = 
	`mp_add
(
c
, 
m
, c)è!ğ
MP_OKAY
)

1391  
»s
;

1396 
	`mp_z”o
(
c
);

1400  
MP_OKAY
;

1402 
	}
}

1413 
mp_”r
 
	$mp_mod_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_dig™ *
c
)

1415 
mp_”r
 
»s
;

1416 
mp_dig™
 
»m
;

1418 
	`ARGCHK
(
a
 !ğ
NULL
 && 
c
 !ğNULL, 
MP_BADARG
);

1420 if(
	`s_mp_cmp_d
(
a
, 
d
) > 0) {

1421 if((
»s
 = 
	`mp_div_d
(
a
, 
d
, 
NULL
, &
»m
)è!ğ
MP_OKAY
)

1422  
»s
;

1425 if(
	`SIGN
(
a
è=ğ
MP_NEG
)

1426 
»m
 = 
d
 - 
	`DIGIT
(
a
, 0);

1428 
»m
 = 
	`DIGIT
(
a
, 0);

1431 if(
c
)

1432 *
c
 = 
»m
;

1434  
MP_OKAY
;

1436 
	}
}

1455 
mp_”r
 
	$mp_sq¹
(
mp_št
 *
a
, mp_šˆ*
b
)

1457 
mp_št
 
x
, 
t
;

1458 
mp_”r
 
»s
;

1460 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_BADARG
);

1463 if(
	`SIGN
(
a
è=ğ
MP_NEG
)

1464  
MP_RANGE
;

1467 if(
	`mp_cmp_d
(
a
, 0è=ğ
MP_EQ
 || mp_cmp_d(a, 1) == MP_EQ)

1468  
	`mp_cİy
(
a
, 
b
);

1471 if((
»s
 = 
	`mp_š™_size
(&
t
, 
	`USED
(
a
))è!ğ
MP_OKAY
)

1472  
»s
;

1475 if((
»s
 = 
	`mp_š™_cİy
(&
x
, 
a
)è!ğ
MP_OKAY
)

1476 
X
;

1478 
	`s_mp_rshd
(&
x
, (
	`USED
(&x)/2)+1);

1479 
	`mp_add_d
(&
x
, 1, &x);

1483 
	`mp_cİy
(&
x
, &
t
);

1484 if((
»s
 = 
	`mp_sqr
(&
t
, &t)è!ğ
MP_OKAY
 ||

1485 (
»s
 = 
	`mp_sub
(&
t
, 
a
, &t)è!ğ
MP_OKAY
)

1486 
CLEANUP
;

1489 
	`s_mp_mul_2
(&
x
);

1490 if((
»s
 = 
	`mp_div
(&
t
, &
x
, &t, 
NULL
)è!ğ
MP_OKAY
)

1491 
CLEANUP
;

1492 
	`s_mp_div_2
(&
x
);

1495 if(
	`mp_cmp_z
(&
t
è=ğ
MP_EQ
)

1499 if((
»s
 = 
	`mp_sub
(&
x
, &
t
, &x)è!ğ
MP_OKAY
)

1500 
CLEANUP
;

1505 
	`mp_sub_d
(&
x
, 1, &x);

1506 
	`s_mp_exch
(&
x
, 
b
);

1508 
CLEANUP
:

1509 
	`mp_ş—r
(&
x
);

1510 
X
:

1511 
	`mp_ş—r
(&
t
);

1513  
»s
;

1515 
	}
}

1524 #ià
MP_MODARITH


1533 
mp_”r
 
	$mp_addmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
)

1535 
mp_”r
 
»s
;

1537 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
m
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1539 if((
»s
 = 
	`mp_add
(
a
, 
b
, 
c
)è!ğ
MP_OKAY
)

1540  
»s
;

1541 if((
»s
 = 
	`mp_mod
(
c
, 
m
, c)è!ğ
MP_OKAY
)

1542  
»s
;

1544  
MP_OKAY
;

1546 
	}
}

1558 
mp_”r
 
	$mp_submod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
)

1560 
mp_”r
 
»s
;

1562 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
m
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1564 if((
»s
 = 
	`mp_sub
(
a
, 
b
, 
c
)è!ğ
MP_OKAY
)

1565  
»s
;

1566 if((
»s
 = 
	`mp_mod
(
c
, 
m
, c)è!ğ
MP_OKAY
)

1567  
»s
;

1569  
MP_OKAY
;

1571 
	}
}

1583 
mp_”r
 
	$mp_mulmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
)

1585 
mp_”r
 
»s
;

1587 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
m
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1589 if((
»s
 = 
	`mp_mul
(
a
, 
b
, 
c
)è!ğ
MP_OKAY
)

1590  
»s
;

1591 if((
»s
 = 
	`mp_mod
(
c
, 
m
, c)è!ğ
MP_OKAY
)

1592  
»s
;

1594  
MP_OKAY
;

1596 
	}
}

1602 #ià
MP_SQUARE


1603 
mp_”r
 
	$mp_sqrmod
(
mp_št
 *
a
, mp_šˆ*
m
, mp_šˆ*
c
)

1605 
mp_”r
 
»s
;

1607 
	`ARGCHK
(
a
 !ğ
NULL
 && 
m
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1609 if((
»s
 = 
	`mp_sqr
(
a
, 
c
)è!ğ
MP_OKAY
)

1610  
»s
;

1611 if((
»s
 = 
	`mp_mod
(
c
, 
m
, c)è!ğ
MP_OKAY
)

1612  
»s
;

1614  
MP_OKAY
;

1616 
	}
}

1634 
mp_”r
 
	$mp_ex±mod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
)

1636 
mp_št
 
s
, 
x
, 
mu
;

1637 
mp_”r
 
»s
;

1638 
mp_dig™
 
d
, *
db
 = 
	`DIGITS
(
b
);

1639 
mp_size
 
ub
 = 
	`USED
(
b
);

1640 
dig
, 
b™
;

1642 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1644 if(
	`mp_cmp_z
(
b
è< 0 || mp_cmp_z(
m
) <= 0)

1645  
MP_RANGE
;

1647 if((
»s
 = 
	`mp_š™
(&
s
)è!ğ
MP_OKAY
)

1648  
»s
;

1649 if((
»s
 = 
	`mp_š™_cİy
(&
x
, 
a
)è!ğ
MP_OKAY
)

1650 
X
;

1651 if((
»s
 = 
	`mp_mod
(&
x
, 
m
, &x)è!ğ
MP_OKAY
 ||

1652 (
»s
 = 
	`mp_š™
(&
mu
)è!ğ
MP_OKAY
)

1653 
MU
;

1655 
	`mp_£t
(&
s
, 1);

1658 
	`s_mp_add_d
(&
mu
, 1);

1659 
	`s_mp_lshd
(&
mu
, 2 * 
	`USED
(
m
));

1660 if((
»s
 = 
	`mp_div
(&
mu
, 
m
, &mu, 
NULL
)è!ğ
MP_OKAY
)

1661 
CLEANUP
;

1664 
dig
 = 0; dig < (
ub
 - 1); dig++) {

1665 
d
 = *
db
++;

1668 
b™
 = 0; b™ < 
DIGIT_BIT
; bit++) {

1669 if(
d
 & 1) {

1670 if((
»s
 = 
	`s_mp_mul
(&
s
, &
x
)è!ğ
MP_OKAY
)

1671 
CLEANUP
;

1672 if((
»s
 = 
	`s_mp_»duû
(&
s
, 
m
, &
mu
)è!ğ
MP_OKAY
)

1673 
CLEANUP
;

1676 
d
 >>= 1;

1678 if((
»s
 = 
	`s_mp_sqr
(&
x
)è!ğ
MP_OKAY
)

1679 
CLEANUP
;

1680 if((
»s
 = 
	`s_mp_»duû
(&
x
, 
m
, &
mu
)è!ğ
MP_OKAY
)

1681 
CLEANUP
;

1686 
d
 = *
db
;

1688 
d
) {

1689 if(
d
 & 1) {

1690 if((
»s
 = 
	`s_mp_mul
(&
s
, &
x
)è!ğ
MP_OKAY
)

1691 
CLEANUP
;

1692 if((
»s
 = 
	`s_mp_»duû
(&
s
, 
m
, &
mu
)è!ğ
MP_OKAY
)

1693 
CLEANUP
;

1696 
d
 >>= 1;

1698 if((
»s
 = 
	`s_mp_sqr
(&
x
)è!ğ
MP_OKAY
)

1699 
CLEANUP
;

1700 if((
»s
 = 
	`s_mp_»duû
(&
x
, 
m
, &
mu
)è!ğ
MP_OKAY
)

1701 
CLEANUP
;

1704 
	`s_mp_exch
(&
s
, 
c
);

1706 
CLEANUP
:

1707 
	`mp_ş—r
(&
mu
);

1708 
MU
:

1709 
	`mp_ş—r
(&
x
);

1710 
X
:

1711 
	`mp_ş—r
(&
s
);

1713  
»s
;

1715 
	}
}

1721 
mp_”r
 
	$mp_ex±mod_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
m
, mp_šˆ*
c
)

1723 
mp_št
 
s
, 
x
;

1724 
mp_”r
 
»s
;

1726 
	`ARGCHK
(
a
 !ğ
NULL
 && 
c
 !ğNULL, 
MP_BADARG
);

1728 if((
»s
 = 
	`mp_š™
(&
s
)è!ğ
MP_OKAY
)

1729  
»s
;

1730 if((
»s
 = 
	`mp_š™_cİy
(&
x
, 
a
)è!ğ
MP_OKAY
)

1731 
X
;

1733 
	`mp_£t
(&
s
, 1);

1735 
d
 != 0) {

1736 if(
d
 & 1) {

1737 if((
»s
 = 
	`s_mp_mul
(&
s
, &
x
)è!ğ
MP_OKAY
 ||

1738 (
»s
 = 
	`mp_mod
(&
s
, 
m
, &s)è!ğ
MP_OKAY
)

1739 
CLEANUP
;

1742 
d
 /= 2;

1744 if((
»s
 = 
	`s_mp_sqr
(&
x
)è!ğ
MP_OKAY
 ||

1745 (
»s
 = 
	`mp_mod
(&
x
, 
m
, &x)è!ğ
MP_OKAY
)

1746 
CLEANUP
;

1749 
	`s_mp_exch
(&
s
, 
c
);

1751 
CLEANUP
:

1752 
	`mp_ş—r
(&
x
);

1753 
X
:

1754 
	`mp_ş—r
(&
s
);

1756  
»s
;

1758 
	}
}

1776 
	$mp_cmp_z
(
mp_št
 *
a
)

1778 if(
	`SIGN
(
a
è=ğ
MP_NEG
)

1779  
MP_LT
;

1780 if(
	`USED
(
a
è=ğ1 && 
	`DIGIT
(a, 0) == 0)

1781  
MP_EQ
;

1783  
MP_GT
;

1785 
	}
}

1797 
	$mp_cmp_d
(
mp_št
 *
a
, 
mp_dig™
 
d
)

1799 
	`ARGCHK
(
a
 !ğ
NULL
, 
MP_EQ
);

1801 if(
	`SIGN
(
a
è=ğ
MP_NEG
)

1802  
MP_LT
;

1804  
	`s_mp_cmp_d
(
a
, 
d
);

1806 
	}
}

1812 
	$mp_cmp
(
mp_št
 *
a
, mp_šˆ*
b
)

1814 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_EQ
);

1816 if(
	`SIGN
(
a
è=ğSIGN(
b
)) {

1817 
mag
;

1819 if((
mag
 = 
	`s_mp_cmp
(
a
, 
b
)è=ğ
MP_EQ
)

1820  
MP_EQ
;

1822 if(
	`SIGN
(
a
è=ğ
MP_ZPOS
)

1823  
mag
;

1825  -
mag
;

1827 } if(
	`SIGN
(
a
è=ğ
MP_ZPOS
) {

1828  
MP_GT
;

1830  
MP_LT
;

1833 
	}
}

1845 
	$mp_cmp_mag
(
mp_št
 *
a
, mp_šˆ*
b
)

1847 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL, 
MP_EQ
);

1849  
	`s_mp_cmp
(
a
, 
b
);

1851 
	}
}

1863 
	$mp_cmp_št
(
mp_št
 *
a
, 
z
)

1865 
mp_št
 
tmp
;

1866 
out
;

1868 
	`ARGCHK
(
a
 !ğ
NULL
, 
MP_EQ
);

1870 
	`mp_š™
(&
tmp
); 
	`mp_£t_št
(&tmp, 
z
);

1871 
out
 = 
	`mp_cmp
(
a
, &
tmp
);

1872 
	`mp_ş—r
(&
tmp
);

1874  
out
;

1876 
	}
}

1887 
	$mp_isodd
(
mp_št
 *
a
)

1889 
	`ARGCHK
(
a
 !ğ
NULL
, 0);

1891  (
	`DIGIT
(
a
, 0) & 1);

1893 
	}
}

1899 
	$mp_i£v’
(
mp_št
 *
a
)

1901  !
	`mp_isodd
(
a
);

1903 
	}
}

1912 #ià
MP_NUMTH


1919 
mp_”r
 
	$mp_gcd
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

1921 
mp_”r
 
»s
;

1922 
mp_št
 
u
, 
v
, 
t
;

1923 
mp_size
 
k
 = 0;

1925 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

1927 if(
	`mp_cmp_z
(
a
è=ğ
MP_EQ
 && mp_cmp_z(
b
) == MP_EQ)

1928  
MP_RANGE
;

1929 if(
	`mp_cmp_z
(
a
è=ğ
MP_EQ
) {

1930  
	`mp_cİy
(
b
, 
c
);

1931 } if(
	`mp_cmp_z
(
b
è=ğ
MP_EQ
) {

1932  
	`mp_cİy
(
a
, 
c
);

1935 if((
»s
 = 
	`mp_š™
(&
t
)è!ğ
MP_OKAY
)

1936  
»s
;

1937 if((
»s
 = 
	`mp_š™_cİy
(&
u
, 
a
)è!ğ
MP_OKAY
)

1938 
U
;

1939 if((
»s
 = 
	`mp_š™_cİy
(&
v
, 
b
)è!ğ
MP_OKAY
)

1940 
V
;

1942 
	`SIGN
(&
u
èğ
MP_ZPOS
;

1943 
	`SIGN
(&
v
èğ
MP_ZPOS
;

1946 
	`mp_i£v’
(&
u
è&& mp_i£v’(&
v
)) {

1947 
	`s_mp_div_2
(&
u
);

1948 
	`s_mp_div_2
(&
v
);

1949 ++
k
;

1953 if(
	`mp_isodd
(&
u
)) {

1954 if((
»s
 = 
	`mp_cİy
(&
v
, &
t
)è!ğ
MP_OKAY
)

1955 
CLEANUP
;

1958 if(
	`SIGN
(&
v
è=ğ
MP_ZPOS
)

1959 
	`SIGN
(&
t
èğ
MP_NEG
;

1961 
	`SIGN
(&
t
èğ
MP_ZPOS
;

1964 if((
»s
 = 
	`mp_cİy
(&
u
, &
t
)è!ğ
MP_OKAY
)

1965 
CLEANUP
;

1970 
	`mp_i£v’
(&
t
)) {

1971 
	`s_mp_div_2
(&
t
);

1974 if(
	`mp_cmp_z
(&
t
è=ğ
MP_GT
) {

1975 if((
»s
 = 
	`mp_cİy
(&
t
, &
u
)è!ğ
MP_OKAY
)

1976 
CLEANUP
;

1979 if((
»s
 = 
	`mp_cİy
(&
t
, &
v
)è!ğ
MP_OKAY
)

1980 
CLEANUP
;

1983 if(
	`SIGN
(&
t
è=ğ
MP_ZPOS
)

1984 
	`SIGN
(&
v
èğ
MP_NEG
;

1986 
	`SIGN
(&
v
èğ
MP_ZPOS
;

1989 if((
»s
 = 
	`mp_sub
(&
u
, &
v
, &
t
)è!ğ
MP_OKAY
)

1990 
CLEANUP
;

1992 if(
	`s_mp_cmp_d
(&
t
, 0è=ğ
MP_EQ
)

1996 
	`s_mp_2ex±
(&
v
, 
k
);

1997 
»s
 = 
	`mp_mul
(&
u
, &
v
, 
c
);

1999 
CLEANUP
:

2000 
	`mp_ş—r
(&
v
);

2001 
V
:

2002 
	`mp_ş—r
(&
u
);

2003 
U
:

2004 
	`mp_ş—r
(&
t
);

2006  
»s
;

2008 
	}
}

2021 
mp_”r
 
	$mp_lcm
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

2023 
mp_št
 
gcd
, 
´od
;

2024 
mp_”r
 
»s
;

2026 
	`ARGCHK
(
a
 !ğ
NULL
 && 
b
 !ğNULL && 
c
 !ğNULL, 
MP_BADARG
);

2029 if((
»s
 = 
	`mp_š™
(&
gcd
)è!ğ
MP_OKAY
)

2030  
»s
;

2031 if((
»s
 = 
	`mp_š™
(&
´od
)è!ğ
MP_OKAY
)

2032 
GCD
;

2034 if((
»s
 = 
	`mp_mul
(
a
, 
b
, &
´od
)è!ğ
MP_OKAY
)

2035 
CLEANUP
;

2036 if((
»s
 = 
	`mp_gcd
(
a
, 
b
, &
gcd
)è!ğ
MP_OKAY
)

2037 
CLEANUP
;

2039 
»s
 = 
	`mp_div
(&
´od
, &
gcd
, 
c
, 
NULL
);

2041 
CLEANUP
:

2042 
	`mp_ş—r
(&
´od
);

2043 
GCD
:

2044 
	`mp_ş—r
(&
gcd
);

2046  
»s
;

2048 
	}
}

2062 
mp_”r
 
	$mp_xgcd
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
g
, mp_šˆ*
x
, mp_šˆ*
y
)

2064 
mp_št
 
gx
, 
xc
, 
yc
, 
u
, 
v
, 
A
, 
B
, 
C
, 
D
;

2065 
mp_št
 *
ş—n
[9];

2066 
mp_”r
 
»s
;

2067 
Ï¡
 = -1;

2069 if(
	`mp_cmp_z
(
b
) == 0)

2070  
MP_RANGE
;

2073 if((
»s
 = 
	`mp_š™
(&
u
)è!ğ
MP_OKAY
è
CLEANUP
;

2074 
ş—n
[++
Ï¡
] = &
u
;

2075 if((
»s
 = 
	`mp_š™
(&
v
)è!ğ
MP_OKAY
è
CLEANUP
;

2076 
ş—n
[++
Ï¡
] = &
v
;

2077 if((
»s
 = 
	`mp_š™
(&
gx
)è!ğ
MP_OKAY
è
CLEANUP
;

2078 
ş—n
[++
Ï¡
] = &
gx
;

2079 if((
»s
 = 
	`mp_š™
(&
A
)è!ğ
MP_OKAY
è
CLEANUP
;

2080 
ş—n
[++
Ï¡
] = &
A
;

2081 if((
»s
 = 
	`mp_š™
(&
B
)è!ğ
MP_OKAY
è
CLEANUP
;

2082 
ş—n
[++
Ï¡
] = &
B
;

2083 if((
»s
 = 
	`mp_š™
(&
C
)è!ğ
MP_OKAY
è
CLEANUP
;

2084 
ş—n
[++
Ï¡
] = &
C
;

2085 if((
»s
 = 
	`mp_š™
(&
D
)è!ğ
MP_OKAY
è
CLEANUP
;

2086 
ş—n
[++
Ï¡
] = &
D
;

2087 if((
»s
 = 
	`mp_š™_cİy
(&
xc
, 
a
)è!ğ
MP_OKAY
è
CLEANUP
;

2088 
ş—n
[++
Ï¡
] = &
xc
;

2089 
	`mp_abs
(&
xc
, &xc);

2090 if((
»s
 = 
	`mp_š™_cİy
(&
yc
, 
b
)è!ğ
MP_OKAY
è
CLEANUP
;

2091 
ş—n
[++
Ï¡
] = &
yc
;

2092 
	`mp_abs
(&
yc
, &yc);

2094 
	`mp_£t
(&
gx
, 1);

2097 
	`mp_i£v’
(&
xc
è&& mp_i£v’(&
yc
)) {

2098 
	`s_mp_div_2
(&
xc
);

2099 
	`s_mp_div_2
(&
yc
);

2100 if((
»s
 = 
	`s_mp_mul_2
(&
gx
)è!ğ
MP_OKAY
)

2101 
CLEANUP
;

2104 
	`mp_cİy
(&
xc
, &
u
);

2105 
	`mp_cİy
(&
yc
, &
v
);

2106 
	`mp_£t
(&
A
, 1); mp_£t(&
D
, 1);

2110 
	`mp_i£v’
(&
u
)) {

2111 
	`s_mp_div_2
(&
u
);

2113 if(
	`mp_i£v’
(&
A
è&& mp_i£v’(&
B
)) {

2114 
	`s_mp_div_2
(&
A
); s_mp_div_2(&
B
);

2116 if((
»s
 = 
	`mp_add
(&
A
, &
yc
, &A)è!ğ
MP_OKAY
è
CLEANUP
;

2117 
	`s_mp_div_2
(&
A
);

2118 if((
»s
 = 
	`mp_sub
(&
B
, &
xc
, &B)è!ğ
MP_OKAY
è
CLEANUP
;

2119 
	`s_mp_div_2
(&
B
);

2123 
	`mp_i£v’
(&
v
)) {

2124 
	`s_mp_div_2
(&
v
);

2126 if(
	`mp_i£v’
(&
C
è&& mp_i£v’(&
D
)) {

2127 
	`s_mp_div_2
(&
C
); s_mp_div_2(&
D
);

2129 if((
»s
 = 
	`mp_add
(&
C
, &
yc
, &C)è!ğ
MP_OKAY
è
CLEANUP
;

2130 
	`s_mp_div_2
(&
C
);

2131 if((
»s
 = 
	`mp_sub
(&
D
, &
xc
, &D)è!ğ
MP_OKAY
è
CLEANUP
;

2132 
	`s_mp_div_2
(&
D
);

2136 if(
	`mp_cmp
(&
u
, &
v
) >= 0) {

2137 if((
»s
 = 
	`mp_sub
(&
u
, &
v
, &u)è!ğ
MP_OKAY
è
CLEANUP
;

2138 if((
»s
 = 
	`mp_sub
(&
A
, &
C
, &A)è!ğ
MP_OKAY
è
CLEANUP
;

2139 if((
»s
 = 
	`mp_sub
(&
B
, &
D
, &B)è!ğ
MP_OKAY
è
CLEANUP
;

2142 if((
»s
 = 
	`mp_sub
(&
v
, &
u
, &v)è!ğ
MP_OKAY
è
CLEANUP
;

2143 if((
»s
 = 
	`mp_sub
(&
C
, &
A
, &C)è!ğ
MP_OKAY
è
CLEANUP
;

2144 if((
»s
 = 
	`mp_sub
(&
D
, &
B
, &D)è!ğ
MP_OKAY
è
CLEANUP
;

2149 if(
	`mp_cmp_z
(&
u
) == 0) {

2150 if(
x
)

2151 if((
»s
 = 
	`mp_cİy
(&
C
, 
x
)è!ğ
MP_OKAY
è
CLEANUP
;

2153 if(
y
)

2154 if((
»s
 = 
	`mp_cİy
(&
D
, 
y
)è!ğ
MP_OKAY
è
CLEANUP
;

2156 if(
g
)

2157 if((
»s
 = 
	`mp_mul
(&
gx
, &
v
, 
g
)è!ğ
MP_OKAY
è
CLEANUP
;

2163 
CLEANUP
:

2164 
Ï¡
 >= 0)

2165 
	`mp_ş—r
(
ş—n
[
Ï¡
--]);

2167  
»s
;

2169 
	}
}

2183 
mp_”r
 
	$mp_švmod
(
mp_št
 *
a
, mp_šˆ*
m
, mp_šˆ*
c
)

2185 
mp_št
 
g
, 
x
;

2186 
mp_”r
 
»s
;

2188 
	`ARGCHK
(
a
 && 
m
 && 
c
, 
MP_BADARG
);

2190 if(
	`mp_cmp_z
(
a
è=ğ0 || mp_cmp_z(
m
) == 0)

2191  
MP_RANGE
;

2193 if((
»s
 = 
	`mp_š™
(&
g
)è!ğ
MP_OKAY
)

2194  
»s
;

2195 if((
»s
 = 
	`mp_š™
(&
x
)è!ğ
MP_OKAY
)

2196 
X
;

2198 if((
»s
 = 
	`mp_xgcd
(
a
, 
m
, &
g
, &
x
, 
NULL
)è!ğ
MP_OKAY
)

2199 
CLEANUP
;

2201 if(
	`mp_cmp_d
(&
g
, 1è!ğ
MP_EQ
) {

2202 
»s
 = 
MP_UNDEF
;

2203 
CLEANUP
;

2206 
»s
 = 
	`mp_mod
(&
x
, 
m
, 
c
);

2207 
	`SIGN
(
c
èğSIGN(
a
);

2209 
CLEANUP
:

2210 
	`mp_ş—r
(&
x
);

2211 
X
:

2212 
	`mp_ş—r
(&
g
);

2214  
»s
;

2216 
	}
}

2226 #ià
MP_IOFUNC


2234 
	$mp_´št
(
mp_št
 *
mp
, 
FILE
 *
oå
)

2236 
ix
;

2238 if(
mp
 =ğ
NULL
 || 
oå
 == NULL)

2241 
	`åutc
((
	`SIGN
(
mp
è=ğ
MP_NEG
è? '-' : '+', 
oå
);

2243 
ix
 = 
	`USED
(
mp
) - 1; ix >= 0; ix--) {

2244 
	`årštf
(
oå
, 
DIGIT_FMT
, 
	`DIGIT
(
mp
, 
ix
));

2247 
	}
}

2264 
mp_”r
 
	$mp_»ad_sigÃd_bš
(
mp_št
 *
mp
, *
¡r
, 
Ën
)

2266 
mp_”r
 
»s
;

2268 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
¡r
 !ğNULL && 
Ën
 > 0, 
MP_BADARG
);

2270 if((
»s
 = 
	`mp_»ad_unsigÃd_bš
(
mp
, 
¡r
 + 1, 
Ën
 - 1)è=ğ
MP_OKAY
) {

2272 if(
¡r
[0])

2273 
	`SIGN
(
mp
èğ
MP_NEG
;

2275 
	`SIGN
(
mp
èğ
MP_ZPOS
;

2278  
»s
;

2280 
	}
}

2286 
	$mp_sigÃd_bš_size
(
mp_št
 *
mp
)

2288 
	`ARGCHK
(
mp
 !ğ
NULL
, 0);

2290  
	`mp_unsigÃd_bš_size
(
mp
) + 1;

2292 
	}
}

2298 
mp_”r
 
	$mp_to_sigÃd_bš
(
mp_št
 *
mp
, *
¡r
)

2300 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
¡r
 !ğNULL, 
MP_BADARG
);

2303 
¡r
[0] = ()
	`SIGN
(
mp
);

2305  
	`mp_to_unsigÃd_bš
(
mp
, 
¡r
 + 1);

2307 
	}
}

2319 
mp_”r
 
	$mp_»ad_unsigÃd_bš
(
mp_št
 *
mp
, *
¡r
, 
Ën
)

2321 
ix
;

2322 
mp_”r
 
»s
;

2324 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
¡r
 !ğNULL && 
Ën
 > 0, 
MP_BADARG
);

2326 
	`mp_z”o
(
mp
);

2328 
ix
 = 0; ix < 
Ën
; ix++) {

2329 if((
»s
 = 
	`s_mp_mul_2d
(
mp
, 
CHAR_BIT
)è!ğ
MP_OKAY
)

2330  
»s
;

2332 if((
»s
 = 
	`mp_add_d
(
mp
, 
¡r
[
ix
], mp)è!ğ
MP_OKAY
)

2333  
»s
;

2336  
MP_OKAY
;

2338 
	}
}

2344 
	$mp_unsigÃd_bš_size
(
mp_št
 *
mp
)

2346 
mp_dig™
 
tİdig
;

2347 
couÁ
;

2349 
	`ARGCHK
(
mp
 !ğ
NULL
, 0);

2352 if(
	`USED
(
mp
è=ğ1 && 
	`DIGIT
(mp, 0) == 0)

2355 
couÁ
 = (
	`USED
(
mp
è- 1è* (
mp_dig™
);

2356 
tİdig
 = 
	`DIGIT
(
mp
, 
	`USED
(mp) - 1);

2358 
tİdig
 != 0) {

2359 ++
couÁ
;

2360 
tİdig
 >>ğ
CHAR_BIT
;

2363  
couÁ
;

2365 
	}
}

2371 
mp_”r
 
	$mp_to_unsigÃd_bš
(
mp_št
 *
mp
, *
¡r
)

2373 
mp_dig™
 *
dp
, *
’d
, 
d
;

2374 *
¥os
;

2376 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
¡r
 !ğNULL, 
MP_BADARG
);

2378 
dp
 = 
	`DIGITS
(
mp
);

2379 
’d
 = 
dp
 + 
	`USED
(
mp
) - 1;

2380 
¥os
 = 
¡r
;

2383 if(
dp
 =ğ
’d
 && *dp == 0) {

2384 *
¡r
 = '\0';

2385  
MP_OKAY
;

2389 
dp
 < 
’d
) {

2390 
ix
;

2392 
d
 = *
dp
;

2393 
ix
 = 0; ix < (
mp_dig™
); ++ix) {

2394 *
¥os
 = 
d
 & 
UCHAR_MAX
;

2395 
d
 >>ğ
CHAR_BIT
;

2396 ++
¥os
;

2399 ++
dp
;

2403 
d
 = *
’d
;

2404 
d
 != 0) {

2405 *
¥os
 = 
d
 & 
UCHAR_MAX
;

2406 
d
 >>ğ
CHAR_BIT
;

2407 ++
¥os
;

2411 --
¥os
 > 
¡r
) {

2412 
t
 = *
¡r
;

2413 *
¡r
 = *
¥os
;

2414 *
¥os
 = 
t
;

2416 ++
¡r
;

2419  
MP_OKAY
;

2421 
	}
}

2427 
	$mp_couÁ_b™s
(
mp_št
 *
mp
)

2429 
Ën
;

2430 
mp_dig™
 
d
;

2432 
	`ARGCHK
(
mp
 !ğ
NULL
, 
MP_BADARG
);

2434 
Ën
 = 
DIGIT_BIT
 * (
	`USED
(
mp
) - 1);

2435 
d
 = 
	`DIGIT
(
mp
, 
	`USED
(mp) - 1);

2437 
d
 != 0) {

2438 ++
Ën
;

2439 
d
 >>= 1;

2442  
Ën
;

2444 
	}
}

2459 
mp_”r
 
	$mp_»ad_¿dix
(
mp_št
 *
mp
, *
¡r
, 
¿dix
)

2461 
ix
 = 0, 
v®
 = 0;

2462 
mp_”r
 
»s
;

2463 
mp_sign
 
sig
 = 
MP_ZPOS
;

2465 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
¡r
 !ğNULL && 
¿dix
 >ğ2 &&„adix <ğ
MAX_RADIX
,

2466 
MP_BADARG
);

2468 
	`mp_z”o
(
mp
);

2471 
¡r
[
ix
] &&

2472 (
	`s_mp_tov®ue
(
¡r
[
ix
], 
¿dix
) < 0) &&

2473 
¡r
[
ix
] != '-' &&

2474 
¡r
[
ix
] != '+') {

2475 ++
ix
;

2478 if(
¡r
[
ix
] == '-') {

2479 
sig
 = 
MP_NEG
;

2480 ++
ix
;

2481 } if(
¡r
[
ix
] == '+') {

2482 
sig
 = 
MP_ZPOS
;

2483 ++
ix
;

2486 (
v®
 = 
	`s_mp_tov®ue
(
¡r
[
ix
], 
¿dix
)) >= 0) {

2487 if((
»s
 = 
	`s_mp_mul_d
(
mp
, 
¿dix
)è!ğ
MP_OKAY
)

2488  
»s
;

2489 if((
»s
 = 
	`s_mp_add_d
(
mp
, 
v®
)è!ğ
MP_OKAY
)

2490  
»s
;

2491 ++
ix
;

2494 if(
	`s_mp_cmp_d
(
mp
, 0è=ğ
MP_EQ
)

2495 
	`SIGN
(
mp
èğ
MP_ZPOS
;

2497 
	`SIGN
(
mp
èğ
sig
;

2499  
MP_OKAY
;

2501 
	}
}

2507 
	$mp_¿dix_size
(
mp_št
 *
mp
, 
¿dix
)

2509 
Ën
;

2510 
	`ARGCHK
(
mp
 !ğ
NULL
, 0);

2512 
Ën
 = 
	`s_mp_ou’
(
	`mp_couÁ_b™s
(
mp
), 
¿dix
) + 1;

2514 if(
	`mp_cmp_z
(
mp
) < 0)

2515 ++
Ën
;

2517  
Ën
;

2519 
	}
}

2532 
	$mp_v®ue_¿dix_size
(
num
, 
qty
, 
¿dix
)

2534 
	`ARGCHK
(
num
 >ğ0 && 
qty
 > 0 && 
¿dix
 >ğ2 &&„adix <ğ
MAX_RADIX
, 0);

2536  
	`s_mp_ou’
(
num
 * 
qty
, 
¿dix
);

2538 
	}
}

2544 
mp_”r
 
	$mp_tÜadix
(
mp_št
 *
mp
, *
¡r
, 
¿dix
)

2546 
ix
, 
pos
 = 0;

2548 
	`ARGCHK
(
mp
 !ğ
NULL
 && 
¡r
 !ğNULL, 
MP_BADARG
);

2549 
	`ARGCHK
(
¿dix
 > 1 &&„adix <ğ
MAX_RADIX
, 
MP_RANGE
);

2551 if(
	`mp_cmp_z
(
mp
è=ğ
MP_EQ
) {

2552 
¡r
[0] = '0';

2553 
¡r
[1] = '\0';

2555 
mp_”r
 
»s
;

2556 
mp_št
 
tmp
;

2557 
mp_sign
 
sgn
;

2558 
mp_dig™
 
»m
, 
rdx
 = (mp_dig™)
¿dix
;

2559 
ch
;

2561 if((
»s
 = 
	`mp_š™_cİy
(&
tmp
, 
mp
)è!ğ
MP_OKAY
)

2562  
»s
;

2565 
sgn
 = 
	`SIGN
(&
tmp
); SIGN(&tmpèğ
MP_ZPOS
;

2568 
	`mp_cmp_z
(&
tmp
) != 0) {

2569 if((
»s
 = 
	`s_mp_div_d
(&
tmp
, 
rdx
, &
»m
)è!ğ
MP_OKAY
) {

2570 
	`mp_ş—r
(&
tmp
);

2571  
»s
;

2575 
ch
 = 
	`s_mp_todig™
(
»m
, 
¿dix
, 0);

2577 
¡r
[
pos
++] = 
ch
;

2581 if(
sgn
 =ğ
MP_NEG
)

2582 
¡r
[
pos
++] = '-';

2585 
¡r
[
pos
--] = '\0';

2588 
ix
 = 0;

2589 
ix
 < 
pos
) {

2590 
tmp
 = 
¡r
[
ix
];

2592 
¡r
[
ix
] = sŒ[
pos
];

2593 
¡r
[
pos
] = 
tmp
;

2594 ++
ix
;

2595 --
pos
;

2598 
	`mp_ş—r
(&
tmp
);

2601  
MP_OKAY
;

2603 
	}
}

2609 
	$mp_ch¬2v®ue
(
ch
, 
r
)

2611  
	`s_mp_tov®ue
(
ch
, 
r
);

2613 
	}
}

2629 cÚ¡ *
	$mp_¡»¼Ü
(
mp_”r
 
ec
)

2631 
«c
 = (
ec
 < 0) ? -ec :ƒc;

2635 if(
ec
 < 
MP_LAST_CODE
 ||ƒø> 
MP_OKAY
) {

2636  
mp_”r_¡ršg
[0];

2638  
mp_”r_¡ršg
[
«c
 + 1];

2641 
	}
}

2654 
mp_”r
 
	$s_mp_grow
(
mp_št
 *
mp
, 
mp_size
 
mš
)

2656 if(
mš
 > 
	`ALLOC
(
mp
)) {

2657 
mp_dig™
 *
tmp
;

2660 
mš
 = ((mš + (
s_mp_deå»c
 - 1)) / s_mp_defprec) * s_mp_defprec;

2662 if((
tmp
 = 
	`s_mp_®loc
(
mš
, (
mp_dig™
))è=ğ
NULL
)

2663  
MP_MEM
;

2665 
	`s_mp_cİy
(
	`DIGITS
(
mp
), 
tmp
, 
	`USED
(mp));

2667 #ià
MP_CRYPTO


2668 
	`s_mp_£tz
(
	`DIGITS
(
mp
), 
	`ALLOC
(mp));

2670 
	`s_mp_ä“
(
	`DIGITS
(
mp
));

2671 
	`DIGITS
(
mp
èğ
tmp
;

2672 
	`ALLOC
(
mp
èğ
mš
;

2675  
MP_OKAY
;

2677 
	}
}

2684 
mp_”r
 
	$s_mp_·d
(
mp_št
 *
mp
, 
mp_size
 
mš
)

2686 if(
mš
 > 
	`USED
(
mp
)) {

2687 
mp_”r
 
»s
;

2690 if(
mš
 > 
	`ALLOC
(
mp
è&& (
»s
 = 
	`s_mp_grow
(mp, mš)è!ğ
MP_OKAY
)

2691  
»s
;

2694 
	`USED
(
mp
èğ
mš
;

2697  
MP_OKAY
;

2699 
	}
}

2705 #ià
MP_MACRO
 == 0

2707 
	$s_mp_£tz
(
mp_dig™
 *
dp
, 
mp_size
 
couÁ
)

2709 #ià
MP_MEMSET
 == 0

2710 
ix
;

2712 
ix
 = 0; ix < 
couÁ
; ix++)

2713 
dp
[
ix
] = 0;

2715 
	`mem£t
(
dp
, 0, 
couÁ
 * (
mp_dig™
));

2718 
	}
}

2725 #ià
MP_MACRO
 == 0

2727 
	$s_mp_cİy
(
mp_dig™
 *
¥
, mp_dig™ *
dp
, 
mp_size
 
couÁ
)

2729 #ià
MP_MEMCPY
 == 0

2730 
ix
;

2732 
ix
 = 0; ix < 
couÁ
; ix++)

2733 
dp
[
ix
] = 
¥
[ix];

2735 
	`memıy
(
dp
, 
¥
, 
couÁ
 * (
mp_dig™
));

2738 
	}
}

2745 #ià
MP_MACRO
 == 0

2747 *
	$s_mp_®loc
(
size_t
 
nb
, size_ˆ
ni
)

2749  
	`ÿÎoc
(
nb
, 
ni
);

2751 
	}
}

2758 #ià
MP_MACRO
 == 0

2760 
	$s_mp_ä“
(*
±r
)

2762 if(
±r
)

2763 
	`ä“
(
±r
);

2765 
	}
}

2773 
	$s_mp_şamp
(
mp_št
 *
mp
)

2775 
mp_size
 
du
 = 
	`USED
(
mp
);

2776 
mp_dig™
 *
zp
 = 
	`DIGITS
(
mp
è+ 
du
 - 1;

2778 
du
 > 1 && !*
zp
--)

2779 --
du
;

2781 
	`USED
(
mp
èğ
du
;

2783 
	}
}

2791 
	$s_mp_exch
(
mp_št
 *
a
, mp_šˆ*
b
)

2793 
mp_št
 
tmp
;

2795 
tmp
 = *
a
;

2796 *
a
 = *
b
;

2797 *
b
 = 
tmp
;

2799 
	}
}

2815 
mp_”r
 
	$s_mp_lshd
(
mp_št
 *
mp
, 
mp_size
 
p
)

2817 
mp_”r
 
»s
;

2818 
mp_size
 
pos
;

2819 
mp_dig™
 *
dp
;

2820 
ix
;

2822 if(
p
 == 0)

2823  
MP_OKAY
;

2825 if((
»s
 = 
	`s_mp_·d
(
mp
, 
	`USED
(mpè+ 
p
)è!ğ
MP_OKAY
)

2826  
»s
;

2828 
pos
 = 
	`USED
(
mp
) - 1;

2829 
dp
 = 
	`DIGITS
(
mp
);

2832 
ix
 = 
pos
 - 
p
; ix >= 0; ix--)

2833 
dp
[
ix
 + 
p
] = dp[ix];

2836 
ix
 = 0; ix < 
p
; ix++)

2837 
dp
[
ix
] = 0;

2839  
MP_OKAY
;

2841 
	}
}

2853 
	$s_mp_rshd
(
mp_št
 *
mp
, 
mp_size
 
p
)

2855 
mp_size
 
ix
;

2856 
mp_dig™
 *
dp
;

2858 if(
p
 == 0)

2862 if(
p
 >ğ
	`USED
(
mp
)) {

2863 
	`s_mp_£tz
(
	`DIGITS
(
mp
), 
	`ALLOC
(mp));

2864 
	`USED
(
mp
) = 1;

2865 
	`SIGN
(
mp
èğ
MP_ZPOS
;

2870 
dp
 = 
	`DIGITS
(
mp
);

2871 
ix
 = 
p
; ix < 
	`USED
(
mp
); ix++)

2872 
dp
[
ix
 - 
p
] = dp[ix];

2875 
ix
 -ğ
p
;

2876 
ix
 < 
	`USED
(
mp
))

2877 
dp
[
ix
++] = 0;

2880 
	`s_mp_şamp
(
mp
);

2882 
	}
}

2889 
	$s_mp_div_2
(
mp_št
 *
mp
)

2891 
	`s_mp_div_2d
(
mp
, 1);

2893 
	}
}

2899 
mp_”r
 
	$s_mp_mul_2
(
mp_št
 *
mp
)

2901 
ix
;

2902 
mp_dig™
 
kš
 = 0, 
kout
, *
dp
 = 
	`DIGITS
(
mp
);

2903 
mp_”r
 
»s
;

2906 
ix
 = 0; ix < 
	`USED
(
mp
); ix++) {

2907 
kout
 = (
dp
[
ix
] >> (
DIGIT_BIT
 - 1)) & 1;

2908 
dp
[
ix
] = (dp[ix] << 1è| 
kš
;

2910 
kš
 = 
kout
;

2914 if(
kš
) {

2915 if(
ix
 >ğ
	`ALLOC
(
mp
)) {

2916 if((
»s
 = 
	`s_mp_grow
(
mp
, 
	`ALLOC
(mpè+ 1)è!ğ
MP_OKAY
)

2917  
»s
;

2918 
dp
 = 
	`DIGITS
(
mp
);

2921 
dp
[
ix
] = 
kš
;

2922 
	`USED
(
mp
) += 1;

2925  
MP_OKAY
;

2927 
	}
}

2938 
	$s_mp_mod_2d
(
mp_št
 *
mp
, 
mp_dig™
 
d
)

2940 
ndig
 = (
d
 / 
DIGIT_BIT
), 
nb™
 = (d % DIGIT_BIT);

2941 
ix
;

2942 
mp_dig™
 
dmask
, *
dp
 = 
	`DIGITS
(
mp
);

2944 if(
ndig
 >ğ
	`USED
(
mp
))

2948 
dmask
 = (1 << 
nb™
) - 1;

2949 
dp
[
ndig
] &ğ
dmask
;

2952 
ix
 = 
ndig
 + 1; ix < 
	`USED
(
mp
); ix++)

2953 
dp
[
ix
] = 0;

2955 
	`s_mp_şamp
(
mp
);

2957 
	}
}

2968 
mp_”r
 
	$s_mp_mul_2d
(
mp_št
 *
mp
, 
mp_dig™
 
d
)

2970 
mp_”r
 
»s
;

2971 
mp_dig™
 
§ve
, 
Ãxt
, 
mask
, *
dp
;

2972 
mp_size
 
u£d
;

2973 
ix
;

2975 if((
»s
 = 
	`s_mp_lshd
(
mp
, 
d
 / 
DIGIT_BIT
)è!ğ
MP_OKAY
)

2976  
»s
;

2978 
dp
 = 
	`DIGITS
(
mp
); 
u£d
 = 
	`USED
(mp);

2979 
d
 %ğ
DIGIT_BIT
;

2981 
mask
 = (1 << 
d
) - 1;

2985 if((
dp
[
u£d
 - 1] >> (
DIGIT_BIT
 - 
d
)è& 
mask
) {

2986 if((
»s
 = 
	`s_mp_grow
(
mp
, 
u£d
 + 1)è!ğ
MP_OKAY
)

2987  
»s
;

2988 
dp
 = 
	`DIGITS
(
mp
);

2992 
§ve
 = 0;

2993 
ix
 = 0; ix < 
u£d
; ix++) {

2994 
Ãxt
 = (
dp
[
ix
] >> (
DIGIT_BIT
 - 
d
)è& 
mask
;

2995 
dp
[
ix
] = (dp[ix] << 
d
è| 
§ve
;

2996 
§ve
 = 
Ãxt
;

3002 if(
§ve
) {

3003 
dp
[
u£d
] = 
§ve
;

3004 
	`USED
(
mp
) += 1;

3007 
	`s_mp_şamp
(
mp
);

3008  
MP_OKAY
;

3010 
	}
}

3021 
	$s_mp_div_2d
(
mp_št
 *
mp
, 
mp_dig™
 
d
)

3023 
ix
;

3024 
mp_dig™
 
§ve
, 
Ãxt
, 
mask
, *
dp
 = 
	`DIGITS
(
mp
);

3026 
	`s_mp_rshd
(
mp
, 
d
 / 
DIGIT_BIT
);

3027 
d
 %ğ
DIGIT_BIT
;

3029 
mask
 = (1 << 
d
) - 1;

3031 
§ve
 = 0;

3032 
ix
 = 
	`USED
(
mp
) - 1; ix >= 0; ix--) {

3033 
Ãxt
 = 
dp
[
ix
] & 
mask
;

3034 
dp
[
ix
] = (dp[ix] >> 
d
è| (
§ve
 << (
DIGIT_BIT
 - d));

3035 
§ve
 = 
Ãxt
;

3038 
	`s_mp_şamp
(
mp
);

3040 
	}
}

3060 
mp_dig™
 
	$s_mp_nÜm
(
mp_št
 *
a
, mp_šˆ*
b
)

3062 
mp_dig™
 
t
, 
d
 = 0;

3064 
t
 = 
	`DIGIT
(
b
, 
	`USED
(b) - 1);

3065 
t
 < (
RADIX
 / 2)) {

3066 
t
 <<= 1;

3067 ++
d
;

3070 if(
d
 != 0) {

3071 
	`s_mp_mul_2d
(
a
, 
d
);

3072 
	`s_mp_mul_2d
(
b
, 
d
);

3075  
d
;

3077 
	}
}

3088 
mp_”r
 
	$s_mp_add_d
(
mp_št
 *
mp
, 
mp_dig™
 
d
)

3090 
mp_wÜd
 
w
, 
k
 = 0;

3091 
mp_size
 
ix
 = 1, 
u£d
 = 
	`USED
(
mp
);

3092 
mp_dig™
 *
dp
 = 
	`DIGITS
(
mp
);

3094 
w
 = 
dp
[0] + 
d
;

3095 
dp
[0] = 
	`ACCUM
(
w
);

3096 
k
 = 
	`CARRYOUT
(
w
);

3098 
ix
 < 
u£d
 && 
k
) {

3099 
w
 = 
dp
[
ix
] + 
k
;

3100 
dp
[
ix
] = 
	`ACCUM
(
w
);

3101 
k
 = 
	`CARRYOUT
(
w
);

3102 ++
ix
;

3105 if(
k
 != 0) {

3106 
mp_”r
 
»s
;

3108 if((
»s
 = 
	`s_mp_·d
(
mp
, 
	`USED
(mpè+ 1)è!ğ
MP_OKAY
)

3109  
»s
;

3111 
	`DIGIT
(
mp
, 
ix
èğ
k
;

3114  
MP_OKAY
;

3116 
	}
}

3123 
mp_”r
 
	$s_mp_sub_d
(
mp_št
 *
mp
, 
mp_dig™
 
d
)

3125 
mp_wÜd
 
w
, 
b
 = 0;

3126 
mp_size
 
ix
 = 1, 
u£d
 = 
	`USED
(
mp
);

3127 
mp_dig™
 *
dp
 = 
	`DIGITS
(
mp
);

3130 
w
 = (
RADIX
 + 
dp
[0]è- 
d
;

3131 
b
 = 
	`CARRYOUT
(
w
) ? 0 : 1;

3132 
dp
[0] = 
	`ACCUM
(
w
);

3135 
b
 && 
ix
 < 
u£d
) {

3136 
w
 = (
RADIX
 + 
dp
[
ix
]è- 
b
;

3137 
b
 = 
	`CARRYOUT
(
w
) ? 0 : 1;

3138 
dp
[
ix
] = 
	`ACCUM
(
w
);

3139 ++
ix
;

3143 
	`s_mp_şamp
(
mp
);

3146 if(
b
)

3147  
MP_RANGE
;

3149  
MP_OKAY
;

3151 
	}
}

3158 
mp_”r
 
	$s_mp_mul_d
(
mp_št
 *
a
, 
mp_dig™
 
d
)

3160 
mp_wÜd
 
w
, 
k
 = 0;

3161 
mp_size
 
ix
, 
max
;

3162 
mp_”r
 
»s
;

3163 
mp_dig™
 *
dp
 = 
	`DIGITS
(
a
);

3173 
max
 = 
	`USED
(
a
);

3174 
w
 = 
dp
[
max
 - 1] * 
d
;

3175 if(
	`CARRYOUT
(
w
) != 0) {

3176 if((
»s
 = 
	`s_mp_·d
(
a
, 
max
 + 1)è!ğ
MP_OKAY
)

3177  
»s
;

3178 
dp
 = 
	`DIGITS
(
a
);

3181 
ix
 = 0; ix < 
max
; ix++) {

3182 
w
 = (
dp
[
ix
] * 
d
è+ 
k
;

3183 
dp
[
ix
] = 
	`ACCUM
(
w
);

3184 
k
 = 
	`CARRYOUT
(
w
);

3190 if(
k
) {

3191 
dp
[
max
] = 
k
;

3192 
	`USED
(
a
èğ
max
 + 1;

3195 
	`s_mp_şamp
(
a
);

3197  
MP_OKAY
;

3199 
	}
}

3212 
mp_”r
 
	$s_mp_div_d
(
mp_št
 *
mp
, 
mp_dig™
 
d
, mp_dig™ *
r
)

3214 
mp_wÜd
 
w
 = 0, 
t
;

3215 
mp_št
 
quÙ
;

3216 
mp_”r
 
»s
;

3217 
mp_dig™
 *
dp
 = 
	`DIGITS
(
mp
), *
qp
;

3218 
ix
;

3220 if(
d
 == 0)

3221  
MP_RANGE
;

3224 if((
»s
 = 
	`mp_š™_size
(&
quÙ
, 
	`USED
(
mp
))è!ğ
MP_OKAY
)

3225  
»s
;

3227 
	`USED
(&
quÙ
èğUSED(
mp
);

3228 
qp
 = 
	`DIGITS
(&
quÙ
);

3231 
ix
 = 
	`USED
(
mp
) - 1; ix >= 0; ix--) {

3232 
w
 = (w << 
DIGIT_BIT
è| 
dp
[
ix
];

3234 if(
w
 >ğ
d
) {

3235 
t
 = 
w
 / 
d
;

3236 
w
 = w % 
d
;

3238 
t
 = 0;

3241 
qp
[
ix
] = 
t
;

3245 if(
r
)

3246 *
r
 = 
w
;

3248 
	`s_mp_şamp
(&
quÙ
);

3249 
	`mp_exch
(&
quÙ
, 
mp
);

3250 
	`mp_ş—r
(&
quÙ
);

3252  
MP_OKAY
;

3254 
	}
}

3265 
mp_”r
 
	$s_mp_add
(
mp_št
 *
a
, mp_šˆ*
b
)

3267 
mp_wÜd
 
w
 = 0;

3268 
mp_dig™
 *
·
, *
pb
;

3269 
mp_size
 
ix
, 
u£d
 = 
	`USED
(
b
);

3270 
mp_”r
 
»s
;

3273 if((
u£d
 > 
	`USED
(
a
)è&& (
»s
 = 
	`s_mp_·d
×, u£d)è!ğ
MP_OKAY
)

3274  
»s
;

3283 
·
 = 
	`DIGITS
(
a
);

3284 
pb
 = 
	`DIGITS
(
b
);

3285 
ix
 = 0; ix < 
u£d
; ++ix) {

3286 
w
 +ğ*
·
 + *
pb
++;

3287 *
·
++ = 
	`ACCUM
(
w
);

3288 
w
 = 
	`CARRYOUT
(w);

3294 
u£d
 = 
	`USED
(
a
);

3295 
w
 && 
ix
 < 
u£d
) {

3296 
w
 +ğ*
·
;

3297 *
·
++ = 
	`ACCUM
(
w
);

3298 
w
 = 
	`CARRYOUT
(w);

3299 ++
ix
;

3306 if(
w
) {

3307 if((
»s
 = 
	`s_mp_·d
(
a
, 
u£d
 + 1)è!ğ
MP_OKAY
)

3308  
»s
;

3310 
	`DIGIT
(
a
, 
ix
èğ
w
;

3313  
MP_OKAY
;

3315 
	}
}

3322 
mp_”r
 
	$s_mp_sub
(
mp_št
 *
a
, mp_šˆ*
b
)

3324 
mp_wÜd
 
w
 = 0;

3325 
mp_dig™
 *
·
, *
pb
;

3326 
mp_size
 
ix
, 
u£d
 = 
	`USED
(
b
);

3334 
·
 = 
	`DIGITS
(
a
);

3335 
pb
 = 
	`DIGITS
(
b
);

3337 
ix
 = 0; ix < 
u£d
; ++ix) {

3338 
w
 = (
RADIX
 + *
·
è- w - *
pb
++;

3339 *
·
++ = 
	`ACCUM
(
w
);

3340 
w
 = 
	`CARRYOUT
(w) ? 0 : 1;

3343 
u£d
 = 
	`USED
(
a
);

3344 
ix
 < 
u£d
) {

3345 
w
 = 
RADIX
 + *
·
 - w;

3346 *
·
++ = 
	`ACCUM
(
w
);

3347 
w
 = 
	`CARRYOUT
(w) ? 0 : 1;

3348 ++
ix
;

3352 
	`s_mp_şamp
(
a
);

3359 if(
w
)

3360  
MP_RANGE
;

3362  
MP_OKAY
;

3364 
	}
}

3368 
mp_”r
 
	$s_mp_»duû
(
mp_št
 *
x
, mp_šˆ*
m
, mp_šˆ*
mu
)

3370 
mp_št
 
q
;

3371 
mp_”r
 
»s
;

3372 
mp_size
 
um
 = 
	`USED
(
m
);

3374 if((
»s
 = 
	`mp_š™_cİy
(&
q
, 
x
)è!ğ
MP_OKAY
)

3375  
»s
;

3377 
	`s_mp_rshd
(&
q
, 
um
 - 1);

3378 
	`s_mp_mul
(&
q
, 
mu
);

3379 
	`s_mp_rshd
(&
q
, 
um
 + 1);

3382 
	`s_mp_mod_2d
(
x
, (
mp_dig™
)(
DIGIT_BIT
 * (
um
 + 1)));

3385 #iâdeà
SHRT_MUL


3386 
	`s_mp_mul
(&
q
, 
m
);

3387 
	`s_mp_mod_2d
(&
q
, (
mp_dig™
)(
DIGIT_BIT
 * (
um
 + 1)));

3389 
	`s_mp_mul_dig
(&
q
, 
m
, 
um
 + 1);

3393 if((
»s
 = 
	`mp_sub
(
x
, &
q
, x)è!ğ
MP_OKAY
)

3394 
CLEANUP
;

3397 if(
	`mp_cmp_z
(
x
) < 0) {

3398 
	`mp_£t
(&
q
, 1);

3399 if((
»s
 = 
	`s_mp_lshd
(&
q
, 
um
 + 1)è!ğ
MP_OKAY
)

3400 
CLEANUP
;

3401 if((
»s
 = 
	`mp_add
(
x
, &
q
, x)è!ğ
MP_OKAY
)

3402 
CLEANUP
;

3406 
	`mp_cmp
(
x
, 
m
) >= 0) {

3407 if((
»s
 = 
	`s_mp_sub
(
x
, 
m
)è!ğ
MP_OKAY
)

3411 
CLEANUP
:

3412 
	`mp_ş—r
(&
q
);

3414  
»s
;

3416 
	}
}

3423 
mp_”r
 
	$s_mp_mul
(
mp_št
 *
a
, mp_šˆ*
b
)

3425 
mp_wÜd
 
w
, 
k
 = 0;

3426 
mp_št
 
tmp
;

3427 
mp_”r
 
»s
;

3428 
mp_size
 
ix
, 
jx
, 
ua
 = 
	`USED
(
a
), 
ub
 = USED(
b
);

3429 
mp_dig™
 *
·
, *
pb
, *
±
, *
pbt
;

3431 if((
»s
 = 
	`mp_š™_size
(&
tmp
, 
ua
 + 
ub
)è!ğ
MP_OKAY
)

3432  
»s
;

3435 
	`USED
(&
tmp
èğ
ua
 + 
ub
;

3438 
pbt
 = 
	`DIGITS
(&
tmp
);

3442 
pb
 = 
	`DIGITS
(
b
);

3443 
ix
 = 0; ix < 
ub
; ++ix, ++
pb
) {

3444 if(*
pb
 == 0)

3448 
·
 = 
	`DIGITS
(
a
);

3449 
jx
 = 0; jx < 
ua
; ++jx, ++
·
) {

3450 
±
 = 
pbt
 + 
ix
 + 
jx
;

3451 
w
 = *
pb
 * *
·
 + 
k
 + *
±
;

3452 *
±
 = 
	`ACCUM
(
w
);

3453 
k
 = 
	`CARRYOUT
(
w
);

3456 
pbt
[
ix
 + 
jx
] = 
k
;

3457 
k
 = 0;

3460 
	`s_mp_şamp
(&
tmp
);

3461 
	`s_mp_exch
(&
tmp
, 
a
);

3463 
	`mp_ş—r
(&
tmp
);

3465  
MP_OKAY
;

3467 
	}
}

3474 
	$s_mp_kmul
(
mp_dig™
 *
a
, mp_dig™ *
b
, mp_dig™ *
out
, 
mp_size
 
Ën
)

3476 
mp_wÜd
 
w
, 
k
 = 0;

3477 
mp_size
 
ix
, 
jx
;

3478 
mp_dig™
 *
·
, *
±
;

3480 
ix
 = 0; ix < 
Ën
; ++ix, ++
b
) {

3481 if(*
b
 == 0)

3484 
·
 = 
a
;

3485 
jx
 = 0; jx < 
Ën
; ++jx, ++
·
) {

3486 
±
 = 
out
 + 
ix
 + 
jx
;

3487 
w
 = *
b
 * *
·
 + 
k
 + *
±
;

3488 *
±
 = 
	`ACCUM
(
w
);

3489 
k
 = 
	`CARRYOUT
(
w
);

3492 
out
[
ix
 + 
jx
] = 
k
;

3493 
k
 = 0;

3496 
	}
}

3510 #ià
MP_SQUARE


3511 
mp_”r
 
	$s_mp_sqr
(
mp_št
 *
a
)

3513 
mp_wÜd
 
w
, 
k
 = 0;

3514 
mp_št
 
tmp
;

3515 
mp_”r
 
»s
;

3516 
mp_size
 
ix
, 
jx
, 
kx
, 
u£d
 = 
	`USED
(
a
);

3517 
mp_dig™
 *
·1
, *
·2
, *
±
, *
pbt
;

3519 if((
»s
 = 
	`mp_š™_size
(&
tmp
, 2 * 
u£d
)è!ğ
MP_OKAY
)

3520  
»s
;

3523 
	`USED
(&
tmp
èğ2 * 
u£d
;

3526 
pbt
 = 
	`DIGITS
(&
tmp
);

3528 
·1
 = 
	`DIGITS
(
a
);

3529 
ix
 = 0; ix < 
u£d
; ++ix, ++
·1
) {

3530 if(*
·1
 == 0)

3533 
w
 = 
	`DIGIT
(&
tmp
, 
ix
 + ixè+ (*
·1
 * *pa1);

3535 
pbt
[
ix
 + ix] = 
	`ACCUM
(
w
);

3536 
k
 = 
	`CARRYOUT
(
w
);

3548 
jx
 = 
ix
 + 1, 
·2
 = 
	`DIGITS
(
a
è+ jx; jx < 
u£d
; ++jx, ++pa2) {

3549 
mp_wÜd
 
u
 = 0, 
v
;

3552 
±
 = 
pbt
 + 
ix
 + 
jx
;

3555 
w
 = *
·1
 * *
·2
;

3560 
u
 = (
w
 >> (
MP_WORD_BIT
 - 1)) & 1;

3565 
w
 *= 2;

3568 
v
 = *
±
 + 
k
;

3573 
u
 |ğ((
MP_WORD_MAX
 - 
v
è< 
w
);

3576 
w
 +ğ
v
;

3579 *
±
 = 
	`ACCUM
(
w
);

3583 
k
 = 
	`CARRYOUT
(
w
è| (
u
 << 
DIGIT_BIT
);

3588 
k
 = 
	`DIGIT
(&
tmp
, 
ix
 + 
jx
) + k;

3589 
pbt
[
ix
 + 
jx
] = 
	`ACCUM
(
k
);

3590 
k
 = 
	`CARRYOUT
(k);

3597 
kx
 = 1;

3598 
k
) {

3599 
k
 = 
pbt
[
ix
 + 
jx
 + 
kx
] + 1;

3600 
pbt
[
ix
 + 
jx
 + 
kx
] = 
	`ACCUM
(
k
);

3601 
k
 = 
	`CARRYOUT
(k);

3602 ++
kx
;

3606 
	`s_mp_şamp
(&
tmp
);

3607 
	`s_mp_exch
(&
tmp
, 
a
);

3609 
	`mp_ş—r
(&
tmp
);

3611  
MP_OKAY
;

3613 
	}
}

3626 
mp_”r
 
	$s_mp_div
(
mp_št
 *
a
, mp_šˆ*
b
)

3628 
mp_št
 
quÙ
, 
»m
, 
t
;

3629 
mp_wÜd
 
q
;

3630 
mp_”r
 
»s
;

3631 
mp_dig™
 
d
;

3632 
ix
;

3634 if(
	`mp_cmp_z
(
b
) == 0)

3635  
MP_RANGE
;

3638 if((
ix
 = 
	`s_mp_i¥ow2
(
b
)) >= 0) {

3639 
	`mp_cİy
(
a
, 
b
);

3640 
	`s_mp_div_2d
(
a
, (
mp_dig™
)
ix
);

3641 
	`s_mp_mod_2d
(
b
, (
mp_dig™
)
ix
);

3643  
MP_OKAY
;

3647 if((
»s
 = 
	`mp_š™_size
(&
quÙ
, 
	`USED
(
a
))è!ğ
MP_OKAY
)

3648  
»s
;

3651 if((
»s
 = 
	`mp_š™_size
(&
t
, 
	`USED
(
a
))è!ğ
MP_OKAY
)

3652 
T
;

3655 if((
»s
 = 
	`mp_š™_size
(&
»m
, 
	`USED
(
a
))è!ğ
MP_OKAY
)

3656 
REM
;

3659 
d
 = 
	`s_mp_nÜm
(
a
, 
b
);

3662 
ix
 = 
	`USED
(
a
) - 1;

3664 
ix
 >= 0) {

3666 
	`s_mp_cmp
(&
»m
, 
b
è< 0 && 
ix
 >= 0) {

3667 if((
»s
 = 
	`s_mp_lshd
(&
»m
, 1)è!ğ
MP_OKAY
)

3668 
CLEANUP
;

3670 if((
»s
 = 
	`s_mp_lshd
(&
quÙ
, 1)è!ğ
MP_OKAY
)

3671 
CLEANUP
;

3673 
	`DIGIT
(&
»m
, 0èğDIGIT(
a
, 
ix
);

3674 
	`s_mp_şamp
(&
»m
);

3675 --
ix
;

3679 if(
	`s_mp_cmp
(&
»m
, 
b
) < 0)

3683 
q
 = 
	`DIGIT
(&
»m
, 
	`USED
(&rem) - 1);

3684 if(
q
 <ğ
	`DIGIT
(
b
, 
	`USED
(bè- 1è&& USED(&
»m
) > 1)

3685 
q
 = (q << 
DIGIT_BIT
è| 
	`DIGIT
(&
»m
, 
	`USED
(&rem) - 2);

3687 
q
 /ğ
	`DIGIT
(
b
, 
	`USED
(b) - 1);

3690 if(
q
 >ğ
RADIX
)

3691 
q
 = 
RADIX
 - 1;

3694 
	`mp_cİy
(
b
, &
t
);

3695 if((
»s
 = 
	`s_mp_mul_d
(&
t
, 
q
)è!ğ
MP_OKAY
)

3696 
CLEANUP
;

3704 
	`s_mp_cmp
(&
t
, &
»m
) > 0) {

3705 --
q
;

3706 
	`s_mp_sub
(&
t
, 
b
);

3710 if((
»s
 = 
	`s_mp_sub
(&
»m
, &
t
)è!ğ
MP_OKAY
)

3711 
CLEANUP
;

3718 
	`DIGIT
(&
quÙ
, 0èğ
q
;

3722 if(
d
 != 0)

3723 
	`s_mp_div_2d
(&
»m
, 
d
);

3725 
	`s_mp_şamp
(&
quÙ
);

3726 
	`s_mp_şamp
(&
»m
);

3729 
	`s_mp_exch
(&
quÙ
, 
a
);

3732 
	`s_mp_exch
(&
»m
, 
b
);

3734 
CLEANUP
:

3735 
	`mp_ş—r
(&
»m
);

3736 
REM
:

3737 
	`mp_ş—r
(&
t
);

3738 
T
:

3739 
	`mp_ş—r
(&
quÙ
);

3741  
»s
;

3743 
	}
}

3749 
mp_”r
 
	$s_mp_2ex±
(
mp_št
 *
a
, 
mp_dig™
 
k
)

3751 
mp_”r
 
»s
;

3752 
mp_size
 
dig
, 
b™
;

3754 
dig
 = 
k
 / 
DIGIT_BIT
;

3755 
b™
 = 
k
 % 
DIGIT_BIT
;

3757 
	`mp_z”o
(
a
);

3758 if((
»s
 = 
	`s_mp_·d
(
a
, 
dig
 + 1)è!ğ
MP_OKAY
)

3759  
»s
;

3761 
	`DIGIT
(
a
, 
dig
è|ğ(1 << 
b™
);

3763  
MP_OKAY
;

3765 
	}
}

3779 
	$s_mp_cmp
(
mp_št
 *
a
, mp_šˆ*
b
)

3781 
mp_size
 
ua
 = 
	`USED
(
a
), 
ub
 = USED(
b
);

3783 if(
ua
 > 
ub
)

3784  
MP_GT
;

3785 if(
ua
 < 
ub
)

3786  
MP_LT
;

3788 
ix
 = 
ua
 - 1;

3789 
mp_dig™
 *
­
 = 
	`DIGITS
(
a
è+ 
ix
, *
bp
 = DIGITS(
b
) + ix;

3791 
ix
 >= 0) {

3792 if(*
­
 > *
bp
)

3793  
MP_GT
;

3794 if(*
­
 < *
bp
)

3795  
MP_LT
;

3797 --
­
; --
bp
; --
ix
;

3800  
MP_EQ
;

3803 
	}
}

3810 
	$s_mp_cmp_d
(
mp_št
 *
a
, 
mp_dig™
 
d
)

3812 
mp_size
 
ua
 = 
	`USED
(
a
);

3813 
mp_dig™
 *
­
 = 
	`DIGITS
(
a
);

3815 if(
ua
 > 1)

3816  
MP_GT
;

3818 if(*
­
 < 
d
)

3819  
MP_LT
;

3820 if(*
­
 > 
d
)

3821  
MP_GT
;

3823  
MP_EQ
;

3825 
	}
}

3835 
	$s_mp_i¥ow2
(
mp_št
 *
v
)

3837 
mp_dig™
 
d
, *
dp
;

3838 
mp_size
 
uv
 = 
	`USED
(
v
);

3839 
exŒa
 = 0, 
ix
;

3841 
d
 = 
	`DIGIT
(
v
, 
uv
 - 1);

3843 
d
 && ((d & 1) == 0)) {

3844 
d
 >>= 1;

3845 ++
exŒa
;

3848 if(
d
 == 1) {

3849 
ix
 = 
uv
 - 2;

3850 
dp
 = 
	`DIGITS
(
v
è+ 
ix
;

3852 
ix
 >= 0) {

3853 if(*
dp
)

3856 --
dp
; --
ix
;

3859  ((
uv
 - 1è* 
DIGIT_BIT
è+ 
exŒa
;

3864 
	}
}

3870 
	$s_mp_i¥ow2d
(
mp_dig™
 
d
)

3872 
pow
 = 0;

3874 (
d
 & 1) == 0) {

3875 ++
pow
; 
d
 >>= 1;

3878 if(
d
 == 1)

3879  
pow
;

3883 
	}
}

3901 
	$s_mp_tov®ue
(
ch
, 
r
)

3903 
v®
, 
xch
;

3905 if(
r
 > 36)

3906 
xch
 = 
ch
;

3908 
xch
 = 
	`touµ”
(
ch
);

3910 if(
	`isdig™
(
xch
))

3911 
v®
 = 
xch
 - '0';

3912 if(
	`isuµ”
(
xch
))

3913 
v®
 = 
xch
 - 'A' + 10;

3914 if(
	`i¦ow”
(
xch
))

3915 
v®
 = 
xch
 - 'a' + 36;

3916 if(
xch
 == '+')

3917 
v®
 = 62;

3918 if(
xch
 == '/')

3919 
v®
 = 63;

3923 if(
v®
 < 0 || v® >ğ
r
)

3926  
v®
;

3928 
	}
}

3943 
	$s_mp_todig™
(
v®
, 
r
, 
low
)

3945 
ch
;

3947 if(
v®
 < 0 || v® >ğ
r
)

3950 
ch
 = 
s_dm­_1
[
v®
];

3952 if(
r
 <ğ36 && 
low
)

3953 
ch
 = 
	`tŞow”
(ch);

3955  
ch
;

3957 
	}
}

3969 
	$s_mp_ou’
(
b™s
, 
r
)

3971  ()(()
b™s
 * 
	`LOG_V_2
(
r
));

3973 
	}
}

	@libtommath/mtest/mpi.h

12 #iâdeà
_H_MPI_


13 
	#_H_MPI_


	)

15 
	~"mpi-cÚfig.h
"

17 
	#MP_LT
 -1

	)

18 
	#MP_EQ
 0

	)

19 
	#MP_GT
 1

	)

21 #ià
MP_DEBUG


22 #undeà
MP_IOFUNC


23 
	#MP_IOFUNC
 1

	)

26 #ià
MP_IOFUNC


27 
	~<¡dio.h
>

28 
	~<ùy³.h
>

31 
	~<lim™s.h
>

33 
	#MP_NEG
 1

	)

34 
	#MP_ZPOS
 0

	)

37 
	#NEG
 
MP_NEG


	)

38 
	#ZPOS
 
MP_ZPOS


	)

40 
	#MP_OKAY
 0

	)

41 
	#MP_YES
 0

	)

42 
	#MP_NO
 -1

	)

43 
	#MP_MEM
 -2

	)

44 
	#MP_RANGE
 -3

	)

45 
	#MP_BADARG
 -4

	)

46 
	#MP_UNDEF
 -5

	)

47 
	#MP_LAST_CODE
 
MP_UNDEF


	)

49 
	~"mpi-ty³s.h
"

52 
	#DIGIT_BIT
 
MP_DIGIT_BIT


	)

53 
	#DIGIT_MAX
 
MP_DIGIT_MAX


	)

56 
	#SIGN
(
MP
è((MP)->
sign
)

	)

57 
	#USED
(
MP
è((MP)->
u£d
)

	)

58 
	#ALLOC
(
MP
è((MP)->
®loc
)

	)

59 
	#DIGITS
(
MP
è((MP)->
dp
)

	)

60 
	#DIGIT
(
MP
,
N
è(MP)->
dp
[(N)]

	)

62 #ià
MP_ARGCHK
 == 1

63 
	#ARGCHK
(
X
,
Y
è{if(!(X)){ (Y);}}

	)

64 #–ià
MP_ARGCHK
 == 2

65 
	~<as£¹.h
>

66 
	#ARGCHK
(
X
,
Y
è
	`as£¹
(X)

	)

68 
	#ARGCHK
(
X
,
Y
è

	)

72 
	#MAX_RADIX
 64

	)

75 
mp_sign
 
	msign
;

76 
mp_size
 
	m®loc
;

77 
mp_size
 
	mu£d
;

78 
mp_dig™
 *
	mdp
;

79 } 
	tmp_št
;

84 
mp_g‘_´ec
();

85 
mp_£t_´ec
(
´ec
);

90 
mp_”r
 
mp_š™
(
mp_št
 *
mp
);

91 
mp_”r
 
mp_š™_¬¿y
(
mp_št
 
mp
[], 
couÁ
);

92 
mp_”r
 
mp_š™_size
(
mp_št
 *
mp
, 
mp_size
 
´ec
);

93 
mp_”r
 
mp_š™_cİy
(
mp_št
 *
mp
, mp_šˆ*
äom
);

94 
mp_”r
 
mp_cİy
(
mp_št
 *
äom
, mp_šˆ*
to
);

95 
mp_exch
(
mp_št
 *
mp1
, mp_šˆ*
mp2
);

96 
mp_ş—r
(
mp_št
 *
mp
);

97 
mp_ş—r_¬¿y
(
mp_št
 
mp
[], 
couÁ
);

98 
mp_z”o
(
mp_št
 *
mp
);

99 
mp_£t
(
mp_št
 *
mp
, 
mp_dig™
 
d
);

100 
mp_”r
 
mp_£t_št
(
mp_št
 *
mp
, 
z
);

101 
mp_”r
 
mp_shršk
(
mp_št
 *
a
);

107 
mp_”r
 
mp_add_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
b
);

108 
mp_”r
 
mp_sub_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
b
);

109 
mp_”r
 
mp_mul_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
b
);

110 
mp_”r
 
mp_mul_2
(
mp_št
 *
a
, mp_šˆ*
c
);

111 
mp_”r
 
mp_div_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
q
, mp_dig™ *
r
);

112 
mp_”r
 
mp_div_2
(
mp_št
 *
a
, mp_šˆ*
c
);

113 
mp_”r
 
mp_ex±_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
c
);

118 
mp_”r
 
mp_abs
(
mp_št
 *
a
, mp_šˆ*
b
);

119 
mp_”r
 
mp_Ãg
(
mp_št
 *
a
, mp_šˆ*
b
);

124 
mp_”r
 
mp_add
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

125 
mp_”r
 
mp_sub
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

126 
mp_”r
 
mp_mul
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

127 
mp_”r
 
mp_mul_2d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
c
);

128 #ià
MP_SQUARE


129 
mp_”r
 
mp_sqr
(
mp_št
 *
a
, mp_šˆ*
b
);

131 
	#mp_sqr
(
a
, 
b
è
	`mp_mul
×,‡, b)

	)

133 
mp_”r
 
mp_div
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
q
, mp_šˆ*
r
);

134 
mp_”r
 
mp_div_2d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
q
, mp_šˆ*
r
);

135 
mp_”r
 
mp_ex±
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

136 
mp_”r
 
mp_2ex±
(
mp_št
 *
a
, 
mp_dig™
 
k
);

137 
mp_”r
 
mp_sq¹
(
mp_št
 *
a
, mp_šˆ*
b
);

142 #ià
MP_MODARITH


143 
mp_”r
 
mp_mod
(
mp_št
 *
a
, mp_šˆ*
m
, mp_šˆ*
c
);

144 
mp_”r
 
mp_mod_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_dig™ *
c
);

145 
mp_”r
 
mp_addmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
);

146 
mp_”r
 
mp_submod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
);

147 
mp_”r
 
mp_mulmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
);

148 #ià
MP_SQUARE


149 
mp_”r
 
mp_sqrmod
(
mp_št
 *
a
, mp_šˆ*
m
, mp_šˆ*
c
);

151 
	#mp_sqrmod
(
a
, 
m
, 
c
è
	`mp_mulmod
×,‡, m, c)

	)

153 
mp_”r
 
mp_ex±mod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
m
, mp_šˆ*
c
);

154 
mp_”r
 
mp_ex±mod_d
(
mp_št
 *
a
, 
mp_dig™
 
d
, mp_šˆ*
m
, mp_šˆ*
c
);

160 
mp_cmp_z
(
mp_št
 *
a
);

161 
mp_cmp_d
(
mp_št
 *
a
, 
mp_dig™
 
d
);

162 
mp_cmp
(
mp_št
 *
a
, mp_šˆ*
b
);

163 
mp_cmp_mag
(
mp_št
 *
a
, mp_šˆ*
b
);

164 
mp_cmp_št
(
mp_št
 *
a
, 
z
);

165 
mp_isodd
(
mp_št
 *
a
);

166 
mp_i£v’
(
mp_št
 *
a
);

171 #ià
MP_NUMTH


172 
mp_”r
 
mp_gcd
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

173 
mp_”r
 
mp_lcm
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

174 
mp_”r
 
mp_xgcd
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
g
, mp_šˆ*
x
, mp_šˆ*
y
);

175 
mp_”r
 
mp_švmod
(
mp_št
 *
a
, mp_šˆ*
m
, mp_šˆ*
c
);

181 #ià
MP_IOFUNC


182 
mp_´št
(
mp_št
 *
mp
, 
FILE
 *
oå
);

188 
	#BITS
 1

	)

189 
	#BYTES
 
CHAR_BIT


	)

191 
mp_”r
 
mp_»ad_sigÃd_bš
(
mp_št
 *
mp
, *
¡r
, 
Ën
);

192 
mp_sigÃd_bš_size
(
mp_št
 *
mp
);

193 
mp_”r
 
mp_to_sigÃd_bš
(
mp_št
 *
mp
, *
¡r
);

195 
mp_”r
 
mp_»ad_unsigÃd_bš
(
mp_št
 *
mp
, *
¡r
, 
Ën
);

196 
mp_unsigÃd_bš_size
(
mp_št
 *
mp
);

197 
mp_”r
 
mp_to_unsigÃd_bš
(
mp_št
 *
mp
, *
¡r
);

199 
mp_couÁ_b™s
(
mp_št
 *
mp
);

201 #ià
MP_COMPAT_MACROS


202 
	#mp_»ad_¿w
(
mp
, 
¡r
, 
Ën
è
	`mp_»ad_sigÃd_bš
((mp), (¡r), (Ën))

	)

203 
	#mp_¿w_size
(
mp
è
	`mp_sigÃd_bš_size
(mp)

	)

204 
	#mp_tÜaw
(
mp
, 
¡r
è
	`mp_to_sigÃd_bš
((mp), (¡r))

	)

205 
	#mp_»ad_mag
(
mp
, 
¡r
, 
Ën
è
	`mp_»ad_unsigÃd_bš
((mp), (¡r), (Ën))

	)

206 
	#mp_mag_size
(
mp
è
	`mp_unsigÃd_bš_size
(mp)

	)

207 
	#mp_tomag
(
mp
, 
¡r
è
	`mp_to_unsigÃd_bš
((mp), (¡r))

	)

210 
mp_”r
 
mp_»ad_¿dix
(
mp_št
 *
mp
, *
¡r
, 
¿dix
);

211 
mp_¿dix_size
(
mp_št
 *
mp
, 
¿dix
);

212 
mp_v®ue_¿dix_size
(
num
, 
qty
, 
¿dix
);

213 
mp_”r
 
mp_tÜadix
(
mp_št
 *
mp
, *
¡r
, 
¿dix
);

215 
mp_ch¬2v®ue
(
ch
, 
r
);

217 
	#mp_tobš¬y
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 2)

	)

218 
	#mp_tooù®
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 8)

	)

219 
	#mp_todecim®
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 10)

	)

220 
	#mp_tohex
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 16)

	)

225 cÚ¡ *
mp_¡»¼Ü
(
mp_”r
 
ec
);

	@libtommath/mtest/mtest.c

31 #ifdeà
MP_8BIT


32 
	#THE_MASK
 127

	)

34 
	#THE_MASK
 32767

	)

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<time.h
>

40 
	~"mpi.c
"

42 
FILE
 *
	gºg
;

44 
	$¿nd_num
(
mp_št
 *
a
)

46 
n
, 
size
;

47 
buf
[2048];

49 
size
 = 1 + ((
	`fg‘c
(
ºg
)<<8) + fgetc(rng)) % 101;

50 
buf
[0] = (
	`fg‘c
(
ºg
)&1)?1:0;

51 
	`ä—d
(
buf
+1, 1, 
size
, 
ºg
);

52 
buf
[1] =ğ0èbuf[1] = 
	`fg‘c
(
ºg
);

53 
	`mp_»ad_¿w
(
a
, 
buf
, 1+
size
);

54 
	}
}

56 
	$¿nd_num2
(
mp_št
 *
a
)

58 
n
, 
size
;

59 
buf
[2048];

61 
size
 = 10 + ((
	`fg‘c
(
ºg
)<<8) + fgetc(rng)) % 101;

62 
buf
[0] = (
	`fg‘c
(
ºg
)&1)?1:0;

63 
	`ä—d
(
buf
+1, 1, 
size
, 
ºg
);

64 
buf
[1] =ğ0èbuf[1] = 
	`fg‘c
(
ºg
);

65 
	`mp_»ad_¿w
(
a
, 
buf
, 1+
size
);

66 
	}
}

68 
	#mp_to64
(
a
, 
b
è
	`mp_tÜadix
×, b, 64)

	)

70 
	$maš
()

72 
n
, 
tmp
;

73 
mp_št
 
a
, 
b
, 
c
, 
d
, 
e
;

74 
şock_t
 
t1
;

75 
buf
[4096];

77 
	`mp_š™
(&
a
);

78 
	`mp_š™
(&
b
);

79 
	`mp_š™
(&
c
);

80 
	`mp_š™
(&
d
);

81 
	`mp_š™
(&
e
);

101 
ºg
 = 
	`fİ’
("/dev/urandom", "rb");

102 ià(
ºg
 =ğ
NULL
) {

103 
ºg
 = 
	`fİ’
("/dev/random", "rb");

104 ià(
ºg
 =ğ
NULL
) {

105 
	`årštf
(
¡d”r
, "\nWarning: stdin used‡s„andom source\n\n");

106 
ºg
 = 
¡dš
;

110 
t1
 = 
	`şock
();

113 ià(
	`şock
(è- 
t1
 > 
CLOCKS_PER_SEC
) {

114 
	`¦“p
(2);

115 
t1
 = 
	`şock
();

118 
n
 = 
	`fg‘c
(
ºg
) % 15;

120 ià(
n
 == 0) {

122 
	`¿nd_num
(&
a
);

123 
	`¿nd_num
(&
b
);

124 
	`mp_add
(&
a
, &
b
, &
c
);

125 
	`´štf
("add\n");

126 
	`mp_to64
(&
a
, 
buf
);

127 
	`´štf
("%s\n", 
buf
);

128 
	`mp_to64
(&
b
, 
buf
);

129 
	`´štf
("%s\n", 
buf
);

130 
	`mp_to64
(&
c
, 
buf
);

131 
	`´štf
("%s\n", 
buf
);

132 } ià(
n
 == 1) {

134 
	`¿nd_num
(&
a
);

135 
	`¿nd_num
(&
b
);

136 
	`mp_sub
(&
a
, &
b
, &
c
);

137 
	`´štf
("sub\n");

138 
	`mp_to64
(&
a
, 
buf
);

139 
	`´štf
("%s\n", 
buf
);

140 
	`mp_to64
(&
b
, 
buf
);

141 
	`´štf
("%s\n", 
buf
);

142 
	`mp_to64
(&
c
, 
buf
);

143 
	`´štf
("%s\n", 
buf
);

144 } ià(
n
 == 2) {

146 
	`¿nd_num
(&
a
);

147 
	`¿nd_num
(&
b
);

148 
	`mp_mul
(&
a
, &
b
, &
c
);

149 
	`´štf
("mul\n");

150 
	`mp_to64
(&
a
, 
buf
);

151 
	`´štf
("%s\n", 
buf
);

152 
	`mp_to64
(&
b
, 
buf
);

153 
	`´štf
("%s\n", 
buf
);

154 
	`mp_to64
(&
c
, 
buf
);

155 
	`´štf
("%s\n", 
buf
);

156 } ià(
n
 == 3) {

158 
	`¿nd_num
(&
a
);

159 
	`¿nd_num
(&
b
);

160 
	`mp_div
(&
a
, &
b
, &
c
, &
d
);

161 
	`´štf
("div\n");

162 
	`mp_to64
(&
a
, 
buf
);

163 
	`´štf
("%s\n", 
buf
);

164 
	`mp_to64
(&
b
, 
buf
);

165 
	`´štf
("%s\n", 
buf
);

166 
	`mp_to64
(&
c
, 
buf
);

167 
	`´štf
("%s\n", 
buf
);

168 
	`mp_to64
(&
d
, 
buf
);

169 
	`´štf
("%s\n", 
buf
);

170 } ià(
n
 == 4) {

172 
	`¿nd_num
(&
a
);

173 
	`mp_sqr
(&
a
, &
b
);

174 
	`´štf
("sqr\n");

175 
	`mp_to64
(&
a
, 
buf
);

176 
	`´štf
("%s\n", 
buf
);

177 
	`mp_to64
(&
b
, 
buf
);

178 
	`´štf
("%s\n", 
buf
);

179 } ià(
n
 == 5) {

181 
	`¿nd_num
(&
a
);

182 
	`mp_cİy
(&
a
, &
b
);

183 
n
 = 
	`fg‘c
(
ºg
) & 63;

184 
	`mp_mul_2d
(&
b
, 
n
, &b);

185 
	`mp_to64
(&
a
, 
buf
);

186 
	`´štf
("mul2d\n");

187 
	`´štf
("%s\n", 
buf
);

188 
	`´štf
("%d\n", 
n
);

189 
	`mp_to64
(&
b
, 
buf
);

190 
	`´štf
("%s\n", 
buf
);

191 } ià(
n
 == 6) {

193 
	`¿nd_num
(&
a
);

194 
	`mp_cİy
(&
a
, &
b
);

195 
n
 = 
	`fg‘c
(
ºg
) & 63;

196 
	`mp_div_2d
(&
b
, 
n
, &b, 
NULL
);

197 
	`mp_to64
(&
a
, 
buf
);

198 
	`´štf
("div2d\n");

199 
	`´štf
("%s\n", 
buf
);

200 
	`´štf
("%d\n", 
n
);

201 
	`mp_to64
(&
b
, 
buf
);

202 
	`´štf
("%s\n", 
buf
);

203 } ià(
n
 == 7) {

205 
	`¿nd_num
(&
a
);

206 
	`¿nd_num
(&
b
);

207 
a
.
sign
 = 
MP_ZPOS
;

208 
b
.
sign
 = 
MP_ZPOS
;

209 
	`mp_gcd
(&
a
, &
b
, &
c
);

210 
	`´štf
("gcd\n");

211 
	`mp_to64
(&
a
, 
buf
);

212 
	`´štf
("%s\n", 
buf
);

213 
	`mp_to64
(&
b
, 
buf
);

214 
	`´štf
("%s\n", 
buf
);

215 
	`mp_to64
(&
c
, 
buf
);

216 
	`´štf
("%s\n", 
buf
);

217 } ià(
n
 == 8) {

219 
	`¿nd_num
(&
a
);

220 
	`¿nd_num
(&
b
);

221 
a
.
sign
 = 
MP_ZPOS
;

222 
b
.
sign
 = 
MP_ZPOS
;

223 
	`mp_lcm
(&
a
, &
b
, &
c
);

224 
	`´štf
("lcm\n");

225 
	`mp_to64
(&
a
, 
buf
);

226 
	`´štf
("%s\n", 
buf
);

227 
	`mp_to64
(&
b
, 
buf
);

228 
	`´štf
("%s\n", 
buf
);

229 
	`mp_to64
(&
c
, 
buf
);

230 
	`´štf
("%s\n", 
buf
);

231 } ià(
n
 == 9) {

233 
	`¿nd_num2
(&
a
);

234 
	`¿nd_num2
(&
b
);

235 
	`¿nd_num2
(&
c
);

237 
a
.
sign
 = 
b
.sigÀğ
c
.sign = 0;

238 
	`mp_ex±mod
(&
a
, &
b
, &
c
, &
d
);

239 
	`´štf
("expt\n");

240 
	`mp_to64
(&
a
, 
buf
);

241 
	`´štf
("%s\n", 
buf
);

242 
	`mp_to64
(&
b
, 
buf
);

243 
	`´štf
("%s\n", 
buf
);

244 
	`mp_to64
(&
c
, 
buf
);

245 
	`´štf
("%s\n", 
buf
);

246 
	`mp_to64
(&
d
, 
buf
);

247 
	`´štf
("%s\n", 
buf
);

248 } ià(
n
 == 10) {

250 
	`¿nd_num2
(&
a
);

251 
	`¿nd_num2
(&
b
);

252 
b
.
sign
 = 
MP_ZPOS
;

253 
a
.
sign
 = 
MP_ZPOS
;

254 
	`mp_gcd
(&
a
, &
b
, &
c
);

255 ià(
	`mp_cmp_d
(&
c
, 1) != 0) ;

256 ià(
	`mp_cmp_d
(&
b
, 1) == 0) ;

257 
	`mp_švmod
(&
a
, &
b
, &
c
);

258 
	`´štf
("invmod\n");

259 
	`mp_to64
(&
a
, 
buf
);

260 
	`´štf
("%s\n", 
buf
);

261 
	`mp_to64
(&
b
, 
buf
);

262 
	`´štf
("%s\n", 
buf
);

263 
	`mp_to64
(&
c
, 
buf
);

264 
	`´štf
("%s\n", 
buf
);

265 } ià(
n
 == 11) {

266 
	`¿nd_num
(&
a
);

267 
	`mp_mul_2
(&
a
, &a);

268 
	`mp_div_2
(&
a
, &
b
);

269 
	`´štf
("div2\n");

270 
	`mp_to64
(&
a
, 
buf
);

271 
	`´štf
("%s\n", 
buf
);

272 
	`mp_to64
(&
b
, 
buf
);

273 
	`´štf
("%s\n", 
buf
);

274 } ià(
n
 == 12) {

275 
	`¿nd_num2
(&
a
);

276 
	`mp_mul_2
(&
a
, &
b
);

277 
	`´štf
("mul2\n");

278 
	`mp_to64
(&
a
, 
buf
);

279 
	`´štf
("%s\n", 
buf
);

280 
	`mp_to64
(&
b
, 
buf
);

281 
	`´štf
("%s\n", 
buf
);

282 } ià(
n
 == 13) {

283 
	`¿nd_num2
(&
a
);

284 
tmp
 = 
	`abs
(
	`¿nd
()è& 
THE_MASK
;

285 
	`mp_add_d
(&
a
, 
tmp
, &
b
);

286 
	`´štf
("add_d\n");

287 
	`mp_to64
(&
a
, 
buf
);

288 
	`´štf
("%s\n%d\n", 
buf
, 
tmp
);

289 
	`mp_to64
(&
b
, 
buf
);

290 
	`´štf
("%s\n", 
buf
);

291 } ià(
n
 == 14) {

292 
	`¿nd_num2
(&
a
);

293 
tmp
 = 
	`abs
(
	`¿nd
()è& 
THE_MASK
;

294 
	`mp_sub_d
(&
a
, 
tmp
, &
b
);

295 
	`´štf
("sub_d\n");

296 
	`mp_to64
(&
a
, 
buf
);

297 
	`´štf
("%s\n%d\n", 
buf
, 
tmp
);

298 
	`mp_to64
(&
b
, 
buf
);

299 
	`´štf
("%s\n", 
buf
);

302 
	`fşo£
(
ºg
);

304 
	}
}

	@libtommath/pre_gen/mpi.c

2 
	~<tomm©h.h
>

3 #ifdeà
BN_ERROR_C


20 
	mcode
;

21 *
	mmsg
;

22 } 
	gmsgs
[] = {

23 { 
MP_OKAY
, "Successful" },

24 { 
MP_MEM
, "Out of heap" },

25 { 
MP_VAL
, "Value out of„ange" }

29 *
	$mp_”rÜ_to_¡ršg
(
code
)

31 
x
;

34 
x
 = 0; x < ()((
msgs
) / (msgs[0])); x++) {

35 ià(
msgs
[
x
].
code
 == code) {

36  
msgs
[
x
].
msg
;

42 
	}
}

53 
	~<tomm©h.h
>

54 #ifdeà
BN_FAST_MP_INVMOD_C


76 
	$ç¡_mp_švmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

78 
mp_št
 
x
, 
y
, 
u
, 
v
, 
B
, 
D
;

79 
»s
, 
Ãg
;

82 ià(
	`mp_i£v’
 (
b
) == 1) {

83  
MP_VAL
;

87 ià((
»s
 = 
	`mp_š™_muÉi
(&
x
, &
y
, &
u
, &
v
, &
B
, &
D
, 
NULL
)è!ğ
MP_OKAY
) {

88  
»s
;

92 ià((
»s
 = 
	`mp_cİy
 (
b
, &
x
)è!ğ
MP_OKAY
) {

93 
LBL_ERR
;

97 ià((
»s
 = 
	`mp_mod
 (
a
, 
b
, &
y
)è!ğ
MP_OKAY
) {

98 
LBL_ERR
;

102 ià((
»s
 = 
	`mp_cİy
 (&
x
, &
u
)è!ğ
MP_OKAY
) {

103 
LBL_ERR
;

105 ià((
»s
 = 
	`mp_cİy
 (&
y
, &
v
)è!ğ
MP_OKAY
) {

106 
LBL_ERR
;

108 
	`mp_£t
 (&
D
, 1);

110 
tİ
:

112 
	`mp_i£v’
 (&
u
) == 1) {

114 ià((
»s
 = 
	`mp_div_2
 (&
u
, &u)è!ğ
MP_OKAY
) {

115 
LBL_ERR
;

118 ià(
	`mp_isodd
 (&
B
) == 1) {

119 ià((
»s
 = 
	`mp_sub
 (&
B
, &
x
, &B)è!ğ
MP_OKAY
) {

120 
LBL_ERR
;

124 ià((
»s
 = 
	`mp_div_2
 (&
B
, &B)è!ğ
MP_OKAY
) {

125 
LBL_ERR
;

130 
	`mp_i£v’
 (&
v
) == 1) {

132 ià((
»s
 = 
	`mp_div_2
 (&
v
, &v)è!ğ
MP_OKAY
) {

133 
LBL_ERR
;

136 ià(
	`mp_isodd
 (&
D
) == 1) {

138 ià((
»s
 = 
	`mp_sub
 (&
D
, &
x
, &D)è!ğ
MP_OKAY
) {

139 
LBL_ERR
;

143 ià((
»s
 = 
	`mp_div_2
 (&
D
, &D)è!ğ
MP_OKAY
) {

144 
LBL_ERR
;

149 ià(
	`mp_cmp
 (&
u
, &
v
è!ğ
MP_LT
) {

151 ià((
»s
 = 
	`mp_sub
 (&
u
, &
v
, &u)è!ğ
MP_OKAY
) {

152 
LBL_ERR
;

155 ià((
»s
 = 
	`mp_sub
 (&
B
, &
D
, &B)è!ğ
MP_OKAY
) {

156 
LBL_ERR
;

160 ià((
»s
 = 
	`mp_sub
 (&
v
, &
u
, &v)è!ğ
MP_OKAY
) {

161 
LBL_ERR
;

164 ià((
»s
 = 
	`mp_sub
 (&
D
, &
B
, &D)è!ğ
MP_OKAY
) {

165 
LBL_ERR
;

170 ià(
	`mp_isz”o
 (&
u
) == 0) {

171 
tİ
;

177 ià(
	`mp_cmp_d
 (&
v
, 1è!ğ
MP_EQ
) {

178 
»s
 = 
MP_VAL
;

179 
LBL_ERR
;

183 
Ãg
 = 
a
->
sign
;

184 
D
.
sign
 =ğ
MP_NEG
) {

185 ià((
»s
 = 
	`mp_add
 (&
D
, 
b
, &D)è!ğ
MP_OKAY
) {

186 
LBL_ERR
;

189 
	`mp_exch
 (&
D
, 
c
);

190 
c
->
sign
 = 
Ãg
;

191 
»s
 = 
MP_OKAY
;

193 
LBL_ERR
:
	`mp_ş—r_muÉi
 (&
x
, &
y
, &
u
, &
v
, &
B
, &
D
, 
NULL
);

194  
»s
;

195 
	}
}

205 
	~<tomm©h.h
>

206 #ifdeà
BN_FAST_MP_MONTGOMERY_REDUCE_C


230 
	$ç¡_mp_mÚtgom”y_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
n
, 
mp_dig™
 
rho
)

232 
ix
, 
»s
, 
Şdu£
;

233 
mp_wÜd
 
W
[
MP_WARRAY
];

236 
Şdu£
 = 
x
->
u£d
;

239 ià(
x
->
®loc
 < 
n
->
u£d
 + 1) {

240 ià((
»s
 = 
	`mp_grow
 (
x
, 
n
->
u£d
 + 1)è!ğ
MP_OKAY
) {

241  
»s
;

249 
mp_wÜd
 *
_W
;

250 
mp_dig™
 *
tmpx
;

253 
_W
 = 
W
;

256 
tmpx
 = 
x
->
dp
;

259 
ix
 = 0; ix < 
x
->
u£d
; ix++) {

260 *
_W
++ = *
tmpx
++;

264 ; 
ix
 < 
n
->
u£d
 * 2 + 1; ix++) {

265 *
_W
++ = 0;

272 
ix
 = 0; ix < 
n
->
u£d
; ix++) {

279 
mp_dig™
 
mu
;

280 
mu
 = (
mp_dig™
è(((
W
[
ix
] & 
MP_MASK
è* 
rho
) & MP_MASK);

297 
iy
;

298 
mp_dig™
 *
tm²
;

299 
mp_wÜd
 *
_W
;

302 
tm²
 = 
n
->
dp
;

305 
_W
 = 
W
 + 
ix
;

308 
iy
 = 0; iy < 
n
->
u£d
; iy++) {

309 *
_W
++ +ğ((
mp_wÜd
)
mu
è* ((mp_wÜd)*
tm²
++);

314 
W
[
ix
 + 1] +ğW[ix] >> ((
mp_wÜd
è
DIGIT_BIT
);

322 
mp_dig™
 *
tmpx
;

323 
mp_wÜd
 *
_W
, *
_W1
;

328 
_W1
 = 
W
 + 
ix
;

331 
_W
 = 
W
 + ++
ix
;

333 ; 
ix
 <ğ
n
->
u£d
 * 2 + 1; ix++) {

334 *
_W
++ +ğ*
_W1
++ >> ((
mp_wÜd
è
DIGIT_BIT
);

345 
tmpx
 = 
x
->
dp
;

348 
_W
 = 
W
 + 
n
->
u£d
;

350 
ix
 = 0; ix < 
n
->
u£d
 + 1; ix++) {

351 *
tmpx
++ = (
mp_dig™
)(*
_W
++ & ((
mp_wÜd
è
MP_MASK
));

357 ; 
ix
 < 
Şdu£
; ix++) {

358 *
tmpx
++ = 0;

363 
x
->
u£d
 = 
n
->used + 1;

364 
	`mp_şamp
 (
x
);

367 ià(
	`mp_cmp_mag
 (
x
, 
n
è!ğ
MP_LT
) {

368  
	`s_mp_sub
 (
x
, 
n
, x);

370  
MP_OKAY
;

371 
	}
}

381 
	~<tomm©h.h
>

382 #ifdeà
BN_FAST_S_MP_MUL_DIGS_C


414 
	$ç¡_s_mp_mul_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

416 
Şdu£
, 
»s
, 
·
, 
ix
, 
iz
;

417 
mp_dig™
 
W
[
MP_WARRAY
];

418 
mp_wÜd
 
_W
;

421 ià(
c
->
®loc
 < 
digs
) {

422 ià((
»s
 = 
	`mp_grow
 (
c
, 
digs
)è!ğ
MP_OKAY
) {

423  
»s
;

428 
·
 = 
	`MIN
(
digs
, 
a
->
u£d
 + 
b
->used);

431 
_W
 = 0;

432 
ix
 = 0; ix < 
·
; ix++) {

433 
tx
, 
ty
;

434 
iy
;

435 
mp_dig™
 *
tmpx
, *
tmpy
;

438 
ty
 = 
	`MIN
(
b
->
u£d
-1, 
ix
);

439 
tx
 = 
ix
 - 
ty
;

442 
tmpx
 = 
a
->
dp
 + 
tx
;

443 
tmpy
 = 
b
->
dp
 + 
ty
;

448 
iy
 = 
	`MIN
(
a
->
u£d
-
tx
, 
ty
+1);

451 
iz
 = 0; iz < 
iy
; ++iz) {

452 
_W
 +ğ((
mp_wÜd
)*
tmpx
++)*((mp_wÜd)*
tmpy
--);

457 
W
[
ix
] = ((
mp_dig™
)
_W
è& 
MP_MASK
;

460 
_W
 = _W >> ((
mp_wÜd
)
DIGIT_BIT
);

464 
Şdu£
 = 
c
->
u£d
;

465 
c
->
u£d
 = 
·
;

468 
mp_dig™
 *
tmpc
;

469 
tmpc
 = 
c
->
dp
;

470 
ix
 = 0; ix < 
·
+1; ix++) {

472 *
tmpc
++ = 
W
[
ix
];

476 ; 
ix
 < 
Şdu£
; ix++) {

477 *
tmpc
++ = 0;

480 
	`mp_şamp
 (
c
);

481  
MP_OKAY
;

482 
	}
}

492 
	~<tomm©h.h
>

493 #ifdeà
BN_FAST_S_MP_MUL_HIGH_DIGS_C


518 
	$ç¡_s_mp_mul_high_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

520 
Şdu£
, 
»s
, 
·
, 
ix
, 
iz
;

521 
mp_dig™
 
W
[
MP_WARRAY
];

522 
mp_wÜd
 
_W
;

525 
·
 = 
a
->
u£d
 + 
b
->used;

526 ià(
c
->
®loc
 < 
·
) {

527 ià((
»s
 = 
	`mp_grow
 (
c
, 
·
)è!ğ
MP_OKAY
) {

528  
»s
;

533 
·
 = 
a
->
u£d
 + 
b
->used;

534 
_W
 = 0;

535 
ix
 = 
digs
; ix < 
·
; ix++) {

536 
tx
, 
ty
, 
iy
;

537 
mp_dig™
 *
tmpx
, *
tmpy
;

540 
ty
 = 
	`MIN
(
b
->
u£d
-1, 
ix
);

541 
tx
 = 
ix
 - 
ty
;

544 
tmpx
 = 
a
->
dp
 + 
tx
;

545 
tmpy
 = 
b
->
dp
 + 
ty
;

550 
iy
 = 
	`MIN
(
a
->
u£d
-
tx
, 
ty
+1);

553 
iz
 = 0; iz < 
iy
; iz++) {

554 
_W
 +ğ((
mp_wÜd
)*
tmpx
++)*((mp_wÜd)*
tmpy
--);

558 
W
[
ix
] = ((
mp_dig™
)
_W
è& 
MP_MASK
;

561 
_W
 = _W >> ((
mp_wÜd
)
DIGIT_BIT
);

565 
Şdu£
 = 
c
->
u£d
;

566 
c
->
u£d
 = 
·
;

569 
mp_dig™
 *
tmpc
;

571 
tmpc
 = 
c
->
dp
 + 
digs
;

572 
ix
 = 
digs
; ix < 
·
; ix++) {

574 *
tmpc
++ = 
W
[
ix
];

578 ; 
ix
 < 
Şdu£
; ix++) {

579 *
tmpc
++ = 0;

582 
	`mp_şamp
 (
c
);

583  
MP_OKAY
;

584 
	}
}

594 
	~<tomm©h.h
>

595 #ifdeà
BN_FAST_S_MP_SQR_C


621 
	$ç¡_s_mp_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

623 
Şdu£
, 
»s
, 
·
, 
ix
, 
iz
;

624 
mp_dig™
 
W
[
MP_WARRAY
], *
tmpx
;

625 
mp_wÜd
 
W1
;

628 
·
 = 
a
->
u£d
 +‡->used;

629 ià(
b
->
®loc
 < 
·
) {

630 ià((
»s
 = 
	`mp_grow
 (
b
, 
·
)è!ğ
MP_OKAY
) {

631  
»s
;

636 
W1
 = 0;

637 
ix
 = 0; ix < 
·
; ix++) {

638 
tx
, 
ty
, 
iy
;

639 
mp_wÜd
 
_W
;

640 
mp_dig™
 *
tmpy
;

643 
_W
 = 0;

646 
ty
 = 
	`MIN
(
a
->
u£d
-1, 
ix
);

647 
tx
 = 
ix
 - 
ty
;

650 
tmpx
 = 
a
->
dp
 + 
tx
;

651 
tmpy
 = 
a
->
dp
 + 
ty
;

656 
iy
 = 
	`MIN
(
a
->
u£d
-
tx
, 
ty
+1);

662 
iy
 = 
	`MIN
(iy, (
ty
-
tx
+1)>>1);

665 
iz
 = 0; iz < 
iy
; iz++) {

666 
_W
 +ğ((
mp_wÜd
)*
tmpx
++)*((mp_wÜd)*
tmpy
--);

670 
_W
 = _W + _W + 
W1
;

673 ià((
ix
&1) == 0) {

674 
_W
 +ğ((
mp_wÜd
)
a
->
dp
[
ix
>>1])*((mp_word)a->dp[ix>>1]);

678 
W
[
ix
] = (
mp_dig™
)(
_W
 & 
MP_MASK
);

681 
W1
 = 
_W
 >> ((
mp_wÜd
)
DIGIT_BIT
);

685 
Şdu£
 = 
b
->
u£d
;

686 
b
->
u£d
 = 
a
->used+a->used;

689 
mp_dig™
 *
tmpb
;

690 
tmpb
 = 
b
->
dp
;

691 
ix
 = 0; ix < 
·
; ix++) {

692 *
tmpb
++ = 
W
[
ix
] & 
MP_MASK
;

696 ; 
ix
 < 
Şdu£
; ix++) {

697 *
tmpb
++ = 0;

700 
	`mp_şamp
 (
b
);

701  
MP_OKAY
;

702 
	}
}

712 
	~<tomm©h.h
>

713 #ifdeà
BN_MP_2EXPT_C


735 
	$mp_2ex±
 (
mp_št
 * 
a
, 
b
)

737 
»s
;

740 
	`mp_z”o
 (
a
);

743 ià((
»s
 = 
	`mp_grow
 (
a
, 
b
 / 
DIGIT_BIT
 + 1)è!ğ
MP_OKAY
) {

744  
»s
;

748 
a
->
u£d
 = 
b
 / 
DIGIT_BIT
 + 1;

751 
a
->
dp
[
b
 / 
DIGIT_BIT
] = ((
mp_dig™
)1) << (b % DIGIT_BIT);

753  
MP_OKAY
;

754 
	}
}

764 
	~<tomm©h.h
>

765 #ifdeà
BN_MP_ABS_C


786 
	$mp_abs
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

788 
»s
;

791 ià(
a
 !ğ
b
) {

792 ià((
»s
 = 
	`mp_cİy
 (
a
, 
b
)è!ğ
MP_OKAY
) {

793  
»s
;

798 
b
->
sign
 = 
MP_ZPOS
;

800  
MP_OKAY
;

801 
	}
}

811 
	~<tomm©h.h
>

812 #ifdeà
BN_MP_ADD_C


829 
	$mp_add
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

831 
§
, 
sb
, 
»s
;

834 
§
 = 
a
->
sign
;

835 
sb
 = 
b
->
sign
;

838 ià(
§
 =ğ
sb
) {

841 
c
->
sign
 = 
§
;

842 
»s
 = 
	`s_mp_add
 (
a
, 
b
, 
c
);

848 ià(
	`mp_cmp_mag
 (
a
, 
b
è=ğ
MP_LT
) {

849 
c
->
sign
 = 
sb
;

850 
»s
 = 
	`s_mp_sub
 (
b
, 
a
, 
c
);

852 
c
->
sign
 = 
§
;

853 
»s
 = 
	`s_mp_sub
 (
a
, 
b
, 
c
);

856  
»s
;

857 
	}
}

868 
	~<tomm©h.h
>

869 #ifdeà
BN_MP_ADD_D_C


887 
	$mp_add_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

889 
»s
, 
ix
, 
Şdu£d
;

890 
mp_dig™
 *
tm·
, *
tmpc
, 
mu
;

893 ià(
c
->
®loc
 < 
a
->
u£d
 + 1) {

894 ià((
»s
 = 
	`mp_grow
(
c
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

895  
»s
;

900 ià(
a
->
sign
 =ğ
MP_NEG
 && (a->
u£d
 > 1 ||‡->
dp
[0] >ğ
b
)) {

902 
a
->
sign
 = 
MP_ZPOS
;

905 
»s
 = 
	`mp_sub_d
(
a
, 
b
, 
c
);

908 
a
->
sign
 = 
c
->sigÀğ
MP_NEG
;

911 
	`mp_şamp
(
c
);

913  
»s
;

917 
Şdu£d
 = 
c
->
u£d
;

920 
c
->
sign
 = 
MP_ZPOS
;

923 
tm·
 = 
a
->
dp
;

926 
tmpc
 = 
c
->
dp
;

929 ià(
a
->
sign
 =ğ
MP_ZPOS
) {

933 *
tmpc
 = *
tm·
++ + 
b
;

934 
mu
 = *
tmpc
 >> 
DIGIT_BIT
;

935 *
tmpc
++ &ğ
MP_MASK
;

938 
ix
 = 1; ix < 
a
->
u£d
; ix++) {

939 *
tmpc
 = *
tm·
++ + 
mu
;

940 
mu
 = *
tmpc
 >> 
DIGIT_BIT
;

941 *
tmpc
++ &ğ
MP_MASK
;

944 
ix
++;

945 *
tmpc
++ = 
mu
;

948 
c
->
u£d
 = 
a
->used + 1;

951 
c
->
u£d
 = 1;

954 ià(
a
->
u£d
 == 1) {

955 *
tmpc
++ = 
b
 - 
a
->
dp
[0];

957 *
tmpc
++ = 
b
;

963 
ix
 = 1;

967 
ix
++ < 
Şdu£d
) {

968 *
tmpc
++ = 0;

970 
	`mp_şamp
(
c
);

972  
MP_OKAY
;

973 
	}
}

984 
	~<tomm©h.h
>

985 #ifdeà
BN_MP_ADDMOD_C


1003 
	$mp_addmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

1005 
»s
;

1006 
mp_št
 
t
;

1008 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

1009  
»s
;

1012 ià((
»s
 = 
	`mp_add
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

1013 
	`mp_ş—r
 (&
t
);

1014  
»s
;

1016 
»s
 = 
	`mp_mod
 (&
t
, 
c
, 
d
);

1017 
	`mp_ş—r
 (&
t
);

1018  
»s
;

1019 
	}
}

1029 
	~<tomm©h.h
>

1030 #ifdeà
BN_MP_AND_C


1048 
	$mp_ªd
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

1050 
»s
, 
ix
, 
px
;

1051 
mp_št
 
t
, *
x
;

1053 ià(
a
->
u£d
 > 
b
->used) {

1054 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

1055  
»s
;

1057 
px
 = 
b
->
u£d
;

1058 
x
 = 
b
;

1060 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
b
)è!ğ
MP_OKAY
) {

1061  
»s
;

1063 
px
 = 
a
->
u£d
;

1064 
x
 = 
a
;

1067 
ix
 = 0; ix < 
px
; ix++) {

1068 
t
.
dp
[
ix
] &ğ
x
->dp[ix];

1072 ; 
ix
 < 
t
.
u£d
; ix++) {

1073 
t
.
dp
[
ix
] = 0;

1076 
	`mp_şamp
 (&
t
);

1077 
	`mp_exch
 (
c
, &
t
);

1078 
	`mp_ş—r
 (&
t
);

1079  
MP_OKAY
;

1080 
	}
}

1090 
	~<tomm©h.h
>

1091 #ifdeà
BN_MP_CLAMP_C


1115 
	$mp_şamp
 (
mp_št
 * 
a
)

1120 
a
->
u£d
 > 0 &&‡->
dp
[a->used - 1] == 0) {

1121 --(
a
->
u£d
);

1125 ià(
a
->
u£d
 == 0) {

1126 
a
->
sign
 = 
MP_ZPOS
;

1128 
	}
}

1138 
	~<tomm©h.h
>

1139 #ifdeà
BN_MP_CLEAR_C


1157 
	$mp_ş—r
 (
mp_št
 * 
a
)

1159 
i
;

1162 ià(
a
->
dp
 !ğ
NULL
) {

1164 
i
 = 0; i < 
a
->
u£d
; i++) {

1165 
a
->
dp
[
i
] = 0;

1169 
	`XFREE
(
a
->
dp
);

1172 
a
->
dp
 = 
NULL
;

1173 
a
->
®loc
 =‡->
u£d
 = 0;

1174 
a
->
sign
 = 
MP_ZPOS
;

1176 
	}
}

1186 
	~<tomm©h.h
>

1187 #ifdeà
BN_MP_CLEAR_MULTI_C


1202 
	~<¡d¬g.h
>

1204 
	$mp_ş—r_muÉi
(
mp_št
 *
mp
, ...)

1206 
mp_št
* 
Ãxt_mp
 = 
mp
;

1207 
va_li¡
 
¬gs
;

1208 
	`va_¡¬t
(
¬gs
, 
mp
);

1209 
Ãxt_mp
 !ğ
NULL
) {

1210 
	`mp_ş—r
(
Ãxt_mp
);

1211 
Ãxt_mp
 = 
	`va_¬g
(
¬gs
, 
mp_št
*);

1213 
	`va_’d
(
¬gs
);

1214 
	}
}

1224 
	~<tomm©h.h
>

1225 #ifdeà
BN_MP_CMP_C


1243 
	$mp_cmp
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

1246 ià(
a
->
sign
 !ğ
b
->sign) {

1247 ià(
a
->
sign
 =ğ
MP_NEG
) {

1248  
MP_LT
;

1250  
MP_GT
;

1255 ià(
a
->
sign
 =ğ
MP_NEG
) {

1257  
	`mp_cmp_mag
(
b
, 
a
);

1259  
	`mp_cmp_mag
(
a
, 
b
);

1261 
	}
}

1271 
	~<tomm©h.h
>

1272 #ifdeà
BN_MP_CMP_D_C


1289 
	$mp_cmp_d
(
mp_št
 * 
a
, 
mp_dig™
 
b
)

1292 ià(
a
->
sign
 =ğ
MP_NEG
) {

1293  
MP_LT
;

1297 ià(
a
->
u£d
 > 1) {

1298  
MP_GT
;

1302 ià(
a
->
dp
[0] > 
b
) {

1303  
MP_GT
;

1304 } ià(
a
->
dp
[0] < 
b
) {

1305  
MP_LT
;

1307  
MP_EQ
;

1309 
	}
}

1319 
	~<tomm©h.h
>

1320 #ifdeà
BN_MP_CMP_MAG_C


1337 
	$mp_cmp_mag
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

1339 
n
;

1340 
mp_dig™
 *
tm·
, *
tmpb
;

1343 ià(
a
->
u£d
 > 
b
->used) {

1344  
MP_GT
;

1347 ià(
a
->
u£d
 < 
b
->used) {

1348  
MP_LT
;

1352 
tm·
 = 
a
->
dp
 + (a->
u£d
 - 1);

1355 
tmpb
 = 
b
->
dp
 + (
a
->
u£d
 - 1);

1358 
n
 = 0;‚ < 
a
->
u£d
; ++n, --
tm·
, --
tmpb
) {

1359 ià(*
tm·
 > *
tmpb
) {

1360  
MP_GT
;

1363 ià(*
tm·
 < *
tmpb
) {

1364  
MP_LT
;

1367  
MP_EQ
;

1368 
	}
}

1378 
	~<tomm©h.h
>

1379 #ifdeà
BN_MP_CNT_LSB_C


1395 cÚ¡ 
	gÊz
[16] = {

1400 
	$mp_út_lsb
(
mp_št
 *
a
)

1402 
x
;

1403 
mp_dig™
 
q
, 
qq
;

1406 ià(
	`mp_isz”o
(
a
) == 1) {

1411 
x
 = 0; x < 
a
->
u£d
 &&‡->
dp
[x] == 0; x++);

1412 
q
 = 
a
->
dp
[
x
];

1413 
x
 *ğ
DIGIT_BIT
;

1416 ià((
q
 & 1) == 0) {

1418 
qq
 = 
q
 & 15;

1419 
x
 +ğ
Êz
[
qq
];

1420 
q
 >>= 4;

1421 } 
qq
 == 0);

1423  
x
;

1424 
	}
}

1435 
	~<tomm©h.h
>

1436 #ifdeà
BN_MP_COPY_C


1454 
	$mp_cİy
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

1456 
»s
, 
n
;

1459 ià(
a
 =ğ
b
) {

1460  
MP_OKAY
;

1464 ià(
b
->
®loc
 < 
a
->
u£d
) {

1465 ià((
»s
 = 
	`mp_grow
 (
b
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

1466  
»s
;

1472 
mp_dig™
 *
tm·
, *
tmpb
;

1477 
tm·
 = 
a
->
dp
;

1480 
tmpb
 = 
b
->
dp
;

1483 
n
 = 0;‚ < 
a
->
u£d
;‚++) {

1484 *
tmpb
++ = *
tm·
++;

1488 ; 
n
 < 
b
->
u£d
;‚++) {

1489 *
tmpb
++ = 0;

1494 
b
->
u£d
 = 
a
->used;

1495 
b
->
sign
 = 
a
->sign;

1496  
MP_OKAY
;

1497 
	}
}

1507 
	~<tomm©h.h
>

1508 #ifdeà
BN_MP_COUNT_BITS_C


1526 
	$mp_couÁ_b™s
 (
mp_št
 * 
a
)

1528 
r
;

1529 
mp_dig™
 
q
;

1532 ià(
a
->
u£d
 == 0) {

1537 
r
 = (
a
->
u£d
 - 1è* 
DIGIT_BIT
;

1540 
q
 = 
a
->
dp
[a->
u£d
 - 1];

1541 
q
 > ((
mp_dig™
) 0)) {

1542 ++
r
;

1543 
q
 >>ğ((
mp_dig™
) 1);

1545  
r
;

1546 
	}
}

1556 
	~<tomm©h.h
>

1557 #ifdeà
BN_MP_DIV_C


1573 #ifdeà
BN_MP_DIV_SMALL


1576 
	$mp_div
(
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

1578 
mp_št
 

, 
tb
, 
tq
, 
q
;

1579 
»s
, 
n
, 
n2
;

1582 ià(
	`mp_isz”o
 (
b
) == 1) {

1583  
MP_VAL
;

1587 ià(
	`mp_cmp_mag
 (
a
, 
b
è=ğ
MP_LT
) {

1588 ià(
d
 !ğ
NULL
) {

1589 
»s
 = 
	`mp_cİy
 (
a
, 
d
);

1591 
»s
 = 
MP_OKAY
;

1593 ià(
c
 !ğ
NULL
) {

1594 
	`mp_z”o
 (
c
);

1596  
»s
;

1600 ià((
»s
 = 
	`mp_š™_muÉi
(&

, &
tb
, &
tq
, &
q
, 
NULL
è!ğ
MP_OKAY
)) {

1601  
»s
;

1605 
	`mp_£t
(&
tq
, 1);

1606 
n
 = 
	`mp_couÁ_b™s
(
a
è- mp_couÁ_b™s(
b
);

1607 ià(((
»s
 = 
	`mp_abs
(
a
, &

)è!ğ
MP_OKAY
) ||

1608 ((
»s
 = 
	`mp_abs
(
b
, &
tb
)è!ğ
MP_OKAY
) ||

1609 ((
»s
 = 
	`mp_mul_2d
(&
tb
, 
n
, &tb)è!ğ
MP_OKAY
) ||

1610 ((
»s
 = 
	`mp_mul_2d
(&
tq
, 
n
, &tq)è!ğ
MP_OKAY
)) {

1611 
LBL_ERR
;

1614 
n
-- >= 0) {

1615 ià(
	`mp_cmp
(&
tb
, &

è!ğ
MP_GT
) {

1616 ià(((
»s
 = 
	`mp_sub
(&

, &
tb
, &)è!ğ
MP_OKAY
) ||

1617 ((
»s
 = 
	`mp_add
(&
q
, &
tq
, &q)è!ğ
MP_OKAY
)) {

1618 
LBL_ERR
;

1621 ià(((
»s
 = 
	`mp_div_2d
(&
tb
, 1, &tb, 
NULL
)è!ğ
MP_OKAY
) ||

1622 ((
»s
 = 
	`mp_div_2d
(&
tq
, 1, &tq, 
NULL
)è!ğ
MP_OKAY
)) {

1623 
LBL_ERR
;

1628 
n
 = 
a
->
sign
;

1629 
n2
 = (
a
->
sign
 =ğ
b
->sigÀ? 
MP_ZPOS
 : 
MP_NEG
);

1630 ià(
c
 !ğ
NULL
) {

1631 
	`mp_exch
(
c
, &
q
);

1632 
c
->
sign
 = (
	`mp_isz”o
(cè=ğ
MP_YES
è? 
MP_ZPOS
 : 
n2
;

1634 ià(
d
 !ğ
NULL
) {

1635 
	`mp_exch
(
d
, &

);

1636 
d
->
sign
 = (
	`mp_isz”o
(dè=ğ
MP_YES
è? 
MP_ZPOS
 : 
n
;

1638 
LBL_ERR
:

1639 
	`mp_ş—r_muÉi
(&

, &
tb
, &
tq
, &
q
, 
NULL
);

1640  
»s
;

1641 
	}
}

1658 
	$mp_div
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

1660 
mp_št
 
q
, 
x
, 
y
, 
t1
, 
t2
;

1661 
»s
, 
n
, 
t
, 
i
, 
nÜm
, 
Ãg
;

1664 ià(
	`mp_isz”o
 (
b
) == 1) {

1665  
MP_VAL
;

1669 ià(
	`mp_cmp_mag
 (
a
, 
b
è=ğ
MP_LT
) {

1670 ià(
d
 !ğ
NULL
) {

1671 
»s
 = 
	`mp_cİy
 (
a
, 
d
);

1673 
»s
 = 
MP_OKAY
;

1675 ià(
c
 !ğ
NULL
) {

1676 
	`mp_z”o
 (
c
);

1678  
»s
;

1681 ià((
»s
 = 
	`mp_š™_size
 (&
q
, 
a
->
u£d
 + 2)è!ğ
MP_OKAY
) {

1682  
»s
;

1684 
q
.
u£d
 = 
a
->used + 2;

1686 ià((
»s
 = 
	`mp_š™
 (&
t1
)è!ğ
MP_OKAY
) {

1687 
LBL_Q
;

1690 ià((
»s
 = 
	`mp_š™
 (&
t2
)è!ğ
MP_OKAY
) {

1691 
LBL_T1
;

1694 ià((
»s
 = 
	`mp_š™_cİy
 (&
x
, 
a
)è!ğ
MP_OKAY
) {

1695 
LBL_T2
;

1698 ià((
»s
 = 
	`mp_š™_cİy
 (&
y
, 
b
)è!ğ
MP_OKAY
) {

1699 
LBL_X
;

1703 
Ãg
 = (
a
->
sign
 =ğ
b
->signè? 
MP_ZPOS
 : 
MP_NEG
;

1704 
x
.
sign
 = 
y
.sigÀğ
MP_ZPOS
;

1707 
nÜm
 = 
	`mp_couÁ_b™s
(&
y
è% 
DIGIT_BIT
;

1708 ià(
nÜm
 < ()(
DIGIT_BIT
-1)) {

1709 
nÜm
 = (
DIGIT_BIT
-1) -‚orm;

1710 ià((
»s
 = 
	`mp_mul_2d
 (&
x
, 
nÜm
, &x)è!ğ
MP_OKAY
) {

1711 
LBL_Y
;

1713 ià((
»s
 = 
	`mp_mul_2d
 (&
y
, 
nÜm
, &y)è!ğ
MP_OKAY
) {

1714 
LBL_Y
;

1717 
nÜm
 = 0;

1721 
n
 = 
x
.
u£d
 - 1;

1722 
t
 = 
y
.
u£d
 - 1;

1725 ià((
»s
 = 
	`mp_lshd
 (&
y
, 
n
 - 
t
)è!ğ
MP_OKAY
) {

1726 
LBL_Y
;

1729 
	`mp_cmp
 (&
x
, &
y
è!ğ
MP_LT
) {

1730 ++(
q
.
dp
[
n
 - 
t
]);

1731 ià((
»s
 = 
	`mp_sub
 (&
x
, &
y
, &x)è!ğ
MP_OKAY
) {

1732 
LBL_Y
;

1737 
	`mp_rshd
 (&
y
, 
n
 - 
t
);

1740 
i
 = 
n
; i >ğ(
t
 + 1); i--) {

1741 ià(
i
 > 
x
.
u£d
) {

1747 ià(
x
.
dp
[
i
] =ğ
y
.dp[
t
]) {

1748 
q
.
dp
[
i
 - 
t
 - 1] = ((((
mp_dig™
)1è<< 
DIGIT_BIT
) - 1);

1750 
mp_wÜd
 
tmp
;

1751 
tmp
 = ((
mp_wÜd
è
x
.
dp
[
i
]è<< ((mp_wÜdè
DIGIT_BIT
);

1752 
tmp
 |ğ((
mp_wÜd
è
x
.
dp
[
i
 - 1]);

1753 
tmp
 /ğ((
mp_wÜd
è
y
.
dp
[
t
]);

1754 ià(
tmp
 > (
mp_wÜd
è
MP_MASK
)

1755 
tmp
 = 
MP_MASK
;

1756 
q
.
dp
[
i
 - 
t
 - 1] = (
mp_dig™
è(
tmp
 & (
mp_wÜd
è(
MP_MASK
));

1764 
q
.
dp
[
i
 - 
t
 - 1] = (q.dp[˜- - 1] + 1è& 
MP_MASK
;

1766 
q
.
dp
[
i
 - 
t
 - 1] = (q.dp[˜- - 1] - 1è& 
MP_MASK
;

1769 
	`mp_z”o
 (&
t1
);

1770 
t1
.
dp
[0] = (
t
 - 1 < 0è? 0 : 
y
.dp[t - 1];

1771 
t1
.
dp
[1] = 
y
.dp[
t
];

1772 
t1
.
u£d
 = 2;

1773 ià((
»s
 = 
	`mp_mul_d
 (&
t1
, 
q
.
dp
[
i
 - 
t
 - 1], &t1)è!ğ
MP_OKAY
) {

1774 
LBL_Y
;

1778 
t2
.
dp
[0] = (
i
 - 2 < 0è? 0 : 
x
.dp[i - 2];

1779 
t2
.
dp
[1] = (
i
 - 1 < 0è? 0 : 
x
.dp[i - 1];

1780 
t2
.
dp
[2] = 
x
.dp[
i
];

1781 
t2
.
u£d
 = 3;

1782 } 
	`mp_cmp_mag
(&
t1
, &
t2
è=ğ
MP_GT
);

1785 ià((
»s
 = 
	`mp_mul_d
 (&
y
, 
q
.
dp
[
i
 - 
t
 - 1], &
t1
)è!ğ
MP_OKAY
) {

1786 
LBL_Y
;

1789 ià((
»s
 = 
	`mp_lshd
 (&
t1
, 
i
 - 
t
 - 1)è!ğ
MP_OKAY
) {

1790 
LBL_Y
;

1793 ià((
»s
 = 
	`mp_sub
 (&
x
, &
t1
, &x)è!ğ
MP_OKAY
) {

1794 
LBL_Y
;

1798 ià(
x
.
sign
 =ğ
MP_NEG
) {

1799 ià((
»s
 = 
	`mp_cİy
 (&
y
, &
t1
)è!ğ
MP_OKAY
) {

1800 
LBL_Y
;

1802 ià((
»s
 = 
	`mp_lshd
 (&
t1
, 
i
 - 
t
 - 1)è!ğ
MP_OKAY
) {

1803 
LBL_Y
;

1805 ià((
»s
 = 
	`mp_add
 (&
x
, &
t1
, &x)è!ğ
MP_OKAY
) {

1806 
LBL_Y
;

1809 
q
.
dp
[
i
 - 
t
 - 1] = (q.dp[˜- - 1] - 1ULè& 
MP_MASK
;

1818 
x
.
sign
 = x.
u£d
 =ğ0 ? 
MP_ZPOS
 : 
a
->sign;

1820 ià(
c
 !ğ
NULL
) {

1821 
	`mp_şamp
 (&
q
);

1822 
	`mp_exch
 (&
q
, 
c
);

1823 
c
->
sign
 = 
Ãg
;

1826 ià(
d
 !ğ
NULL
) {

1827 
	`mp_div_2d
 (&
x
, 
nÜm
, &x, 
NULL
);

1828 
	`mp_exch
 (&
x
, 
d
);

1831 
»s
 = 
MP_OKAY
;

1833 
LBL_Y
:
	`mp_ş—r
 (&
y
);

1834 
LBL_X
:
	`mp_ş—r
 (&
x
);

1835 
LBL_T2
:
	`mp_ş—r
 (&
t2
);

1836 
LBL_T1
:
	`mp_ş—r
 (&
t1
);

1837 
LBL_Q
:
	`mp_ş—r
 (&
q
);

1838  
»s
;

1839 
	}
}

1852 
	~<tomm©h.h
>

1853 #ifdeà
BN_MP_DIV_2_C


1870 
	$mp_div_2
(
mp_št
 * 
a
, mp_šˆ* 
b
)

1872 
x
, 
»s
, 
Şdu£d
;

1875 ià(
b
->
®loc
 < 
a
->
u£d
) {

1876 ià((
»s
 = 
	`mp_grow
 (
b
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

1877  
»s
;

1881 
Şdu£d
 = 
b
->
u£d
;

1882 
b
->
u£d
 = 
a
->used;

1884 
mp_dig™
 
r
, 
¼
, *
tm·
, *
tmpb
;

1887 
tm·
 = 
a
->
dp
 + 
b
->
u£d
 - 1;

1890 
tmpb
 = 
b
->
dp
 + b->
u£d
 - 1;

1893 
r
 = 0;

1894 
x
 = 
b
->
u£d
 - 1; x >= 0; x--) {

1896 
¼
 = *
tm·
 & 1;

1899 *
tmpb
-- = (*
tm·
-- >> 1è| (
r
 << (
DIGIT_BIT
 - 1));

1902 
r
 = 
¼
;

1906 
tmpb
 = 
b
->
dp
 + b->
u£d
;

1907 
x
 = 
b
->
u£d
; x < 
Şdu£d
; x++) {

1908 *
tmpb
++ = 0;

1911 
b
->
sign
 = 
a
->sign;

1912 
	`mp_şamp
 (
b
);

1913  
MP_OKAY
;

1914 
	}
}

1924 
	~<tomm©h.h
>

1925 #ifdeà
BN_MP_DIV_2D_C


1942 
	$mp_div_2d
 (
mp_št
 * 
a
, 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

1944 
mp_dig™
 
D
, 
r
, 
¼
;

1945 
x
, 
»s
;

1946 
mp_št
 
t
;

1950 ià(
b
 <= 0) {

1951 
»s
 = 
	`mp_cİy
 (
a
, 
c
);

1952 ià(
d
 !ğ
NULL
) {

1953 
	`mp_z”o
 (
d
);

1955  
»s
;

1958 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

1959  
»s
;

1963 ià(
d
 !ğ
NULL
) {

1964 ià((
»s
 = 
	`mp_mod_2d
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

1965 
	`mp_ş—r
 (&
t
);

1966  
»s
;

1971 ià((
»s
 = 
	`mp_cİy
 (
a
, 
c
)è!ğ
MP_OKAY
) {

1972 
	`mp_ş—r
 (&
t
);

1973  
»s
;

1977 ià(
b
 >ğ()
DIGIT_BIT
) {

1978 
	`mp_rshd
 (
c
, 
b
 / 
DIGIT_BIT
);

1982 
D
 = (
mp_dig™
è(
b
 % 
DIGIT_BIT
);

1983 ià(
D
 != 0) {

1984 
mp_dig™
 *
tmpc
, 
mask
, 
shiá
;

1987 
mask
 = (((
mp_dig™
)1è<< 
D
) - 1;

1990 
shiá
 = 
DIGIT_BIT
 - 
D
;

1993 
tmpc
 = 
c
->
dp
 + (c->
u£d
 - 1);

1996 
r
 = 0;

1997 
x
 = 
c
->
u£d
 - 1; x >= 0; x--) {

1999 
¼
 = *
tmpc
 & 
mask
;

2002 *
tmpc
 = (*tmpø>> 
D
è| (
r
 << 
shiá
);

2003 --
tmpc
;

2006 
r
 = 
¼
;

2009 
	`mp_şamp
 (
c
);

2010 ià(
d
 !ğ
NULL
) {

2011 
	`mp_exch
 (&
t
, 
d
);

2013 
	`mp_ş—r
 (&
t
);

2014  
MP_OKAY
;

2015 
	}
}

2025 
	~<tomm©h.h
>

2026 #ifdeà
BN_MP_DIV_3_C


2044 
	$mp_div_3
 (
mp_št
 * 
a
, mp_šˆ*
c
, 
mp_dig™
 * 
d
)

2046 
mp_št
 
q
;

2047 
mp_wÜd
 
w
, 
t
;

2048 
mp_dig™
 
b
;

2049 
»s
, 
ix
;

2052 
b
 = (((
mp_wÜd
)1è<< ((mp_wÜd)
DIGIT_BIT
)) / ((mp_word)3);

2054 ià((
»s
 = 
	`mp_š™_size
(&
q
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

2055  
»s
;

2058 
q
.
u£d
 = 
a
->used;

2059 
q
.
sign
 = 
a
->sign;

2060 
w
 = 0;

2061 
ix
 = 
a
->
u£d
 - 1; ix >= 0; ix--) {

2062 
w
 = (w << ((
mp_wÜd
)
DIGIT_BIT
)è| ((mp_wÜd)
a
->
dp
[
ix
]);

2064 ià(
w
 >= 3) {

2066 
t
 = (
w
 * ((
mp_wÜd
)
b
)è>> ((mp_wÜd)
DIGIT_BIT
);

2069 
w
 -ğ
t
+t+t;

2074 
w
 >= 3) {

2075 
t
 += 1;

2076 
w
 -= 3;

2079 
t
 = 0;

2081 
q
.
dp
[
ix
] = (
mp_dig™
)
t
;

2085 ià(
d
 !ğ
NULL
) {

2086 *
d
 = (
mp_dig™
)
w
;

2090 ià(
c
 !ğ
NULL
) {

2091 
	`mp_şamp
(&
q
);

2092 
	`mp_exch
(&
q
, 
c
);

2094 
	`mp_ş—r
(&
q
);

2096  
»s
;

2097 
	}
}

2108 
	~<tomm©h.h
>

2109 #ifdeà
BN_MP_DIV_D_C


2125 
	$s_is_pow”_of_two
(
mp_dig™
 
b
, *
p
)

2127 
x
;

2129 
x
 = 1; x < 
DIGIT_BIT
; x++) {

2130 ià(
b
 =ğ(((
mp_dig™
)1)<<
x
)) {

2131 *
p
 = 
x
;

2136 
	}
}

2139 
	$mp_div_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
, mp_dig™ * 
d
)

2141 
mp_št
 
q
;

2142 
mp_wÜd
 
w
;

2143 
mp_dig™
 
t
;

2144 
»s
, 
ix
;

2147 ià(
b
 == 0) {

2148  
MP_VAL
;

2152 ià(
b
 =ğ1 || 
	`mp_isz”o
(
a
) == 1) {

2153 ià(
d
 !ğ
NULL
) {

2154 *
d
 = 0;

2156 ià(
c
 !ğ
NULL
) {

2157  
	`mp_cİy
(
a
, 
c
);

2159  
MP_OKAY
;

2163 ià(
	`s_is_pow”_of_two
(
b
, &
ix
) == 1) {

2164 ià(
d
 !ğ
NULL
) {

2165 *
d
 = 
a
->
dp
[0] & ((((
mp_dig™
)1)<<
ix
) - 1);

2167 ià(
c
 !ğ
NULL
) {

2168  
	`mp_div_2d
(
a
, 
ix
, 
c
, 
NULL
);

2170  
MP_OKAY
;

2173 #ifdeà
BN_MP_DIV_3_C


2175 ià(
b
 == 3) {

2176  
	`mp_div_3
(
a
, 
c
, 
d
);

2181 ià((
»s
 = 
	`mp_š™_size
(&
q
, 
a
->
u£d
)è!ğ
MP_OKAY
) {

2182  
»s
;

2185 
q
.
u£d
 = 
a
->used;

2186 
q
.
sign
 = 
a
->sign;

2187 
w
 = 0;

2188 
ix
 = 
a
->
u£d
 - 1; ix >= 0; ix--) {

2189 
w
 = (w << ((
mp_wÜd
)
DIGIT_BIT
)è| ((mp_wÜd)
a
->
dp
[
ix
]);

2191 ià(
w
 >ğ
b
) {

2192 
t
 = (
mp_dig™
)(
w
 / 
b
);

2193 
w
 -ğ((
mp_wÜd
)
t
è* ((mp_wÜd)
b
);

2195 
t
 = 0;

2197 
q
.
dp
[
ix
] = (
mp_dig™
)
t
;

2200 ià(
d
 !ğ
NULL
) {

2201 *
d
 = (
mp_dig™
)
w
;

2204 ià(
c
 !ğ
NULL
) {

2205 
	`mp_şamp
(&
q
);

2206 
	`mp_exch
(&
q
, 
c
);

2208 
	`mp_ş—r
(&
q
);

2210  
»s
;

2211 
	}
}

2222 
	~<tomm©h.h
>

2223 #ifdeà
BN_MP_DR_IS_MODULUS_C


2240 
	$mp_dr_is_modulus
(
mp_št
 *
a
)

2242 
ix
;

2245 ià(
a
->
u£d
 < 2) {

2252 
ix
 = 1; ix < 
a
->
u£d
; ix++) {

2253 ià(
a
->
dp
[
ix
] !ğ
MP_MASK
) {

2258 
	}
}

2269 
	~<tomm©h.h
>

2270 #ifdeà
BN_MP_DR_REDUCE_C


2301 
	$mp_dr_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
n
, 
mp_dig™
 
k
)

2303 
”r
, 
i
, 
m
;

2304 
mp_wÜd
 
r
;

2305 
mp_dig™
 
mu
, *
tmpx1
, *
tmpx2
;

2308 
m
 = 
n
->
u£d
;

2311 ià(
x
->
®loc
 < 
m
 + m) {

2312 ià((
”r
 = 
	`mp_grow
 (
x
, 
m
 + m)è!ğ
MP_OKAY
) {

2313  
”r
;

2320 
tİ
:

2323 
tmpx1
 = 
x
->
dp
;

2326 
tmpx2
 = 
x
->
dp
 + 
m
;

2329 
mu
 = 0;

2332 
i
 = 0; i < 
m
; i++) {

2333 
r
 = ((
mp_wÜd
)*
tmpx2
++è* ((mp_wÜd)
k
è+ *
tmpx1
 + 
mu
;

2334 *
tmpx1
++ = (
mp_dig™
)(
r
 & 
MP_MASK
);

2335 
mu
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
)
DIGIT_BIT
));

2339 *
tmpx1
++ = 
mu
;

2342 
i
 = 
m
 + 1; i < 
x
->
u£d
; i++) {

2343 *
tmpx1
++ = 0;

2347 
	`mp_şamp
 (
x
);

2352 ià(
	`mp_cmp_mag
 (
x
, 
n
è!ğ
MP_LT
) {

2353 
	`s_mp_sub
(
x
, 
n
, x);

2354 
tİ
;

2356  
MP_OKAY
;

2357 
	}
}

2367 
	~<tomm©h.h
>

2368 #ifdeà
BN_MP_DR_SETUP_C


2385 
	$mp_dr_£tup
(
mp_št
 *
a
, 
mp_dig™
 *
d
)

2390 *
d
 = (
mp_dig™
)((((
mp_wÜd
)1è<< ((mp_wÜd)
DIGIT_BIT
)) -

2391 ((
mp_wÜd
)
a
->
dp
[0]));

2392 
	}
}

2403 
	~<tomm©h.h
>

2404 #ifdeà
BN_MP_EXCH_C


2424 
	$mp_exch
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

2426 
mp_št
 
t
;

2428 
t
 = *
a
;

2429 *
a
 = *
b
;

2430 *
b
 = 
t
;

2431 
	}
}

2441 
	~<tomm©h.h
>

2442 #ifdeà
BN_MP_EXPT_D_C


2459 
	$mp_ex±_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

2461 
»s
, 
x
;

2462 
mp_št
 
g
;

2464 ià((
»s
 = 
	`mp_š™_cİy
 (&
g
, 
a
)è!ğ
MP_OKAY
) {

2465  
»s
;

2469 
	`mp_£t
 (
c
, 1);

2471 
x
 = 0; x < (è
DIGIT_BIT
; x++) {

2473 ià((
»s
 = 
	`mp_sqr
 (
c
, c)è!ğ
MP_OKAY
) {

2474 
	`mp_ş—r
 (&
g
);

2475  
»s
;

2479 ià((
b
 & (
mp_dig™
è(((mp_dig™)1è<< (
DIGIT_BIT
 - 1))) != 0) {

2480 ià((
»s
 = 
	`mp_mul
 (
c
, &
g
, c)è!ğ
MP_OKAY
) {

2481 
	`mp_ş—r
 (&
g
);

2482  
»s
;

2487 
b
 <<= 1;

2490 
	`mp_ş—r
 (&
g
);

2491  
MP_OKAY
;

2492 
	}
}

2502 
	~<tomm©h.h
>

2503 #ifdeà
BN_MP_EXPTMOD_C


2525 
	$mp_ex±mod
 (
mp_št
 * 
G
, mp_šˆ* 
X
, mp_šˆ* 
P
, mp_šˆ* 
Y
)

2527 
dr
;

2530 ià(
P
->
sign
 =ğ
MP_NEG
) {

2531  
MP_VAL
;

2535 ià(
X
->
sign
 =ğ
MP_NEG
) {

2536 #ifdeà
BN_MP_INVMOD_C


2537 
mp_št
 
tmpG
, 
tmpX
;

2538 
”r
;

2541 ià((
”r
 = 
	`mp_š™
(&
tmpG
)è!ğ
MP_OKAY
) {

2542  
”r
;

2544 ià((
”r
 = 
	`mp_švmod
(
G
, 
P
, &
tmpG
)è!ğ
MP_OKAY
) {

2545 
	`mp_ş—r
(&
tmpG
);

2546  
”r
;

2550 ià((
”r
 = 
	`mp_š™
(&
tmpX
)è!ğ
MP_OKAY
) {

2551 
	`mp_ş—r
(&
tmpG
);

2552  
”r
;

2554 ià((
”r
 = 
	`mp_abs
(
X
, &
tmpX
)è!ğ
MP_OKAY
) {

2555 
	`mp_ş—r_muÉi
(&
tmpG
, &
tmpX
, 
NULL
);

2556  
”r
;

2560 
”r
 = 
	`mp_ex±mod
(&
tmpG
, &
tmpX
, 
P
, 
Y
);

2561 
	`mp_ş—r_muÉi
(&
tmpG
, &
tmpX
, 
NULL
);

2562  
”r
;

2565  
MP_VAL
;

2570 #ià
	`defšed
(
BN_MP_REDUCE_IS_2K_L_C
è&& defšed(
BN_MP_REDUCE_2K_L_C
è&& defšed(
BN_S_MP_EXPTMOD_C
)

2571 ià(
	`mp_»duû_is_2k_l
(
P
è=ğ
MP_YES
) {

2572  
	`s_mp_ex±mod
(
G
, 
X
, 
P
, 
Y
, 1);

2576 #ifdeà
BN_MP_DR_IS_MODULUS_C


2578 
dr
 = 
	`mp_dr_is_modulus
(
P
);

2581 
dr
 = 0;

2584 #ifdeà
BN_MP_REDUCE_IS_2K_C


2586 ià(
dr
 == 0) {

2587 
dr
 = 
	`mp_»duû_is_2k
(
P
) << 1;

2592 #ifdeà
BN_MP_EXPTMOD_FAST_C


2593 ià(
	`mp_isodd
 (
P
è=ğ1 || 
dr
 != 0) {

2594  
	`mp_ex±mod_ç¡
 (
G
, 
X
, 
P
, 
Y
, 
dr
);

2597 #ifdeà
BN_S_MP_EXPTMOD_C


2599  
	`s_mp_ex±mod
 (
G
, 
X
, 
P
, 
Y
, 0);

2602  
MP_VAL
;

2604 #ifdeà
BN_MP_EXPTMOD_FAST_C


2607 
	}
}

2618 
	~<tomm©h.h
>

2619 #ifdeà
BN_MP_EXPTMOD_FAST_C


2643 #ifdeà
MP_LOW_MEM


2644 
	#TAB_SIZE
 32

	)

2646 
	#TAB_SIZE
 256

	)

2649 
	$mp_ex±mod_ç¡
 (
mp_št
 * 
G
, mp_šˆ* 
X
, mp_šˆ* 
P
, mp_šˆ* 
Y
, 
»dmode
)

2651 
mp_št
 
M
[
TAB_SIZE
], 
»s
;

2652 
mp_dig™
 
buf
, 
mp
;

2653 
”r
, 
b™buf
, 
b™ıy
, 
b™út
, 
mode
, 
digidx
, 
x
, 
y
, 
wšsize
;

2659 (*
»dux
)(
mp_št
*,mp_št*,
mp_dig™
);

2662 
x
 = 
	`mp_couÁ_b™s
 (
X
);

2663 ià(
x
 <= 7) {

2664 
wšsize
 = 2;

2665 } ià(
x
 <= 36) {

2666 
wšsize
 = 3;

2667 } ià(
x
 <= 140) {

2668 
wšsize
 = 4;

2669 } ià(
x
 <= 450) {

2670 
wšsize
 = 5;

2671 } ià(
x
 <= 1303) {

2672 
wšsize
 = 6;

2673 } ià(
x
 <= 3529) {

2674 
wšsize
 = 7;

2676 
wšsize
 = 8;

2679 #ifdeà
MP_LOW_MEM


2680 ià(
wšsize
 > 5) {

2681 
wšsize
 = 5;

2687 ià((
”r
 = 
	`mp_š™
(&
M
[1])è!ğ
MP_OKAY
) {

2688  
”r
;

2692 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

2693 ià((
”r
 = 
	`mp_š™
(&
M
[
x
])è!ğ
MP_OKAY
) {

2694 
y
 = 1<<(
wšsize
-1); y < 
x
; y++) {

2695 
	`mp_ş—r
 (&
M
[
y
]);

2697 
	`mp_ş—r
(&
M
[1]);

2698  
”r
;

2703 ià(
»dmode
 == 0) {

2704 #ifdeà
BN_MP_MONTGOMERY_SETUP_C


2706 ià((
”r
 = 
	`mp_mÚtgom”y_£tup
 (
P
, &
mp
)è!ğ
MP_OKAY
) {

2707 
LBL_M
;

2710 
”r
 = 
MP_VAL
;

2711 
LBL_M
;

2715 #ifdeà
BN_FAST_MP_MONTGOMERY_REDUCE_C


2716 ià(((
P
->
u£d
 * 2 + 1è< 
MP_WARRAY
) &&

2717 
P
->
u£d
 < (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

2718 
»dux
 = 
ç¡_mp_mÚtgom”y_»duû
;

2722 #ifdeà
BN_MP_MONTGOMERY_REDUCE_C


2724 
»dux
 = 
mp_mÚtgom”y_»duû
;

2726 
”r
 = 
MP_VAL
;

2727 
LBL_M
;

2730 } ià(
»dmode
 == 1) {

2731 #ià
	`defšed
(
BN_MP_DR_SETUP_C
è&& defšed(
BN_MP_DR_REDUCE_C
)

2733 
	`mp_dr_£tup
(
P
, &
mp
);

2734 
»dux
 = 
mp_dr_»duû
;

2736 
”r
 = 
MP_VAL
;

2737 
LBL_M
;

2740 #ià
	`defšed
(
BN_MP_REDUCE_2K_SETUP_C
è&& defšed(
BN_MP_REDUCE_2K_C
)

2742 ià((
”r
 = 
	`mp_»duû_2k_£tup
(
P
, &
mp
)è!ğ
MP_OKAY
) {

2743 
LBL_M
;

2745 
»dux
 = 
mp_»duû_2k
;

2747 
”r
 = 
MP_VAL
;

2748 
LBL_M
;

2753 ià((
”r
 = 
	`mp_š™
 (&
»s
)è!ğ
MP_OKAY
) {

2754 
LBL_M
;

2764 ià(
»dmode
 == 0) {

2765 #ifdeà
BN_MP_MONTGOMERY_CALC_NORMALIZATION_C


2767 ià((
”r
 = 
	`mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
 (&
»s
, 
P
)è!ğ
MP_OKAY
) {

2768 
LBL_RES
;

2771 
”r
 = 
MP_VAL
;

2772 
LBL_RES
;

2776 ià((
”r
 = 
	`mp_mulmod
 (
G
, &
»s
, 
P
, &
M
[1])è!ğ
MP_OKAY
) {

2777 
LBL_RES
;

2780 
	`mp_£t
(&
»s
, 1);

2781 ià((
”r
 = 
	`mp_mod
(
G
, 
P
, &
M
[1])è!ğ
MP_OKAY
) {

2782 
LBL_RES
;

2787 ià((
”r
 = 
	`mp_cİy
 (&
M
[1], &M[1 << (
wšsize
 - 1)])è!ğ
MP_OKAY
) {

2788 
LBL_RES
;

2791 
x
 = 0; x < (
wšsize
 - 1); x++) {

2792 ià((
”r
 = 
	`mp_sqr
 (&
M
[1 << (
wšsize
 - 1)], &M[1 << (wšsiz- 1)])è!ğ
MP_OKAY
) {

2793 
LBL_RES
;

2795 ià((
”r
 = 
	`»dux
 (&
M
[1 << (
wšsize
 - 1)], 
P
, 
mp
)è!ğ
MP_OKAY
) {

2796 
LBL_RES
;

2801 
x
 = (1 << (
wšsize
 - 1)) + 1; x < (1 << winsize); x++) {

2802 ià((
”r
 = 
	`mp_mul
 (&
M
[
x
 - 1], &M[1], &M[x])è!ğ
MP_OKAY
) {

2803 
LBL_RES
;

2805 ià((
”r
 = 
	`»dux
 (&
M
[
x
], 
P
, 
mp
)è!ğ
MP_OKAY
) {

2806 
LBL_RES
;

2811 
mode
 = 0;

2812 
b™út
 = 1;

2813 
buf
 = 0;

2814 
digidx
 = 
X
->
u£d
 - 1;

2815 
b™ıy
 = 0;

2816 
b™buf
 = 0;

2820 ià(--
b™út
 == 0) {

2822 ià(
digidx
 == -1) {

2826 
buf
 = 
X
->
dp
[
digidx
--];

2827 
b™út
 = ()
DIGIT_BIT
;

2831 
y
 = (
mp_dig™
)(
buf
 >> (
DIGIT_BIT
 - 1)) & 1;

2832 
buf
 <<ğ(
mp_dig™
)1;

2839 ià(
mode
 =ğ0 && 
y
 == 0) {

2844 ià(
mode
 =ğ1 && 
y
 == 0) {

2845 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

2846 
LBL_RES
;

2848 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

2849 
LBL_RES
;

2855 
b™buf
 |ğ(
y
 << (
wšsize
 - ++
b™ıy
));

2856 
mode
 = 2;

2858 ià(
b™ıy
 =ğ
wšsize
) {

2861 
x
 = 0; x < 
wšsize
; x++) {

2862 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

2863 
LBL_RES
;

2865 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

2866 
LBL_RES
;

2871 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[
b™buf
], &»s)è!ğ
MP_OKAY
) {

2872 
LBL_RES
;

2874 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

2875 
LBL_RES
;

2879 
b™ıy
 = 0;

2880 
b™buf
 = 0;

2881 
mode
 = 1;

2886 ià(
mode
 =ğ2 && 
b™ıy
 > 0) {

2888 
x
 = 0; x < 
b™ıy
; x++) {

2889 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

2890 
LBL_RES
;

2892 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

2893 
LBL_RES
;

2897 
b™buf
 <<= 1;

2898 ià((
b™buf
 & (1 << 
wšsize
)) != 0) {

2900 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[1], &»s)è!ğ
MP_OKAY
) {

2901 
LBL_RES
;

2903 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

2904 
LBL_RES
;

2910 ià(
»dmode
 == 0) {

2917 ià((
”r
 = 
	`»dux
(&
»s
, 
P
, 
mp
)è!ğ
MP_OKAY
) {

2918 
LBL_RES
;

2923 
	`mp_exch
 (&
»s
, 
Y
);

2924 
”r
 = 
MP_OKAY
;

2925 
LBL_RES
:
	`mp_ş—r
 (&
»s
);

2926 
LBL_M
:

2927 
	`mp_ş—r
(&
M
[1]);

2928 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

2929 
	`mp_ş—r
 (&
M
[
x
]);

2931  
”r
;

2932 
	}
}

2943 
	~<tomm©h.h
>

2944 #ifdeà
BN_MP_EXTEUCLID_C


2963 
	$mp_ex‹uşid
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
U1
, mp_šˆ*
U2
, mp_šˆ*
U3
)

2965 
mp_št
 
u1
,
u2
,
u3
,
v1
,
v2
,
v3
,
t1
,
t2
,
t3
,
q
,
tmp
;

2966 
”r
;

2968 ià((
”r
 = 
	`mp_š™_muÉi
(&
u1
, &
u2
, &
u3
, &
v1
, &
v2
, &
v3
, &
t1
, &
t2
, &
t3
, &
q
, &
tmp
, 
NULL
)è!ğ
MP_OKAY
) {

2969  
”r
;

2973 
	`mp_£t
(&
u1
, 1);

2974 ià((
”r
 = 
	`mp_cİy
(
a
, &
u3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2977 
	`mp_£t
(&
v2
, 1);

2978 ià((
”r
 = 
	`mp_cİy
(
b
, &
v3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2981 
	`mp_isz”o
(&
v3
è=ğ
MP_NO
) {

2983 ià((
”r
 = 
	`mp_div
(&
u3
, &
v3
, &
q
, 
NULL
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2986 ià((
”r
 = 
	`mp_mul
(&
v1
, &
q
, &
tmp
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2987 ià((
”r
 = 
	`mp_sub
(&
u1
, &
tmp
, &
t1
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2988 ià((
”r
 = 
	`mp_mul
(&
v2
, &
q
, &
tmp
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2989 ià((
”r
 = 
	`mp_sub
(&
u2
, &
tmp
, &
t2
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2990 ià((
”r
 = 
	`mp_mul
(&
v3
, &
q
, &
tmp
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2991 ià((
”r
 = 
	`mp_sub
(&
u3
, &
tmp
, &
t3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2994 ià((
”r
 = 
	`mp_cİy
(&
v1
, &
u1
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2995 ià((
”r
 = 
	`mp_cİy
(&
v2
, &
u2
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2996 ià((
”r
 = 
	`mp_cİy
(&
v3
, &
u3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

2999 ià((
”r
 = 
	`mp_cİy
(&
t1
, &
v1
)è!ğ
MP_OKAY
è{ 
_ERR
; }

3000 ià((
”r
 = 
	`mp_cİy
(&
t2
, &
v2
)è!ğ
MP_OKAY
è{ 
_ERR
; }

3001 ià((
”r
 = 
	`mp_cİy
(&
t3
, &
v3
)è!ğ
MP_OKAY
è{ 
_ERR
; }

3005 ià(
u3
.
sign
 =ğ
MP_NEG
) {

3006 
	`mp_Ãg
(&
u1
, &u1);

3007 
	`mp_Ãg
(&
u2
, &u2);

3008 
	`mp_Ãg
(&
u3
, &u3);

3012 ià(
U1
 !ğ
NULL
è{ 
	`mp_exch
(U1, &
u1
); }

3013 ià(
U2
 !ğ
NULL
è{ 
	`mp_exch
(U2, &
u2
); }

3014 ià(
U3
 !ğ
NULL
è{ 
	`mp_exch
(U3, &
u3
); }

3016 
”r
 = 
MP_OKAY
;

3017 
_ERR
: 
	`mp_ş—r_muÉi
(&
u1
, &
u2
, &
u3
, &
v1
, &
v2
, &
v3
, &
t1
, &
t2
, &
t3
, &
q
, &
tmp
, 
NULL
);

3018  
”r
;

3019 
	}
}

3029 
	~<tomm©h.h
>

3030 #ifdeà
BN_MP_FREAD_C


3047 
	$mp_ä—d
(
mp_št
 *
a
, 
¿dix
, 
FILE
 *
¡»am
)

3049 
”r
, 
ch
, 
Ãg
, 
y
;

3052 
	`mp_z”o
(
a
);

3055 
ch
 = 
	`fg‘c
(
¡»am
);

3056 ià(
ch
 == '-') {

3057 
Ãg
 = 
MP_NEG
;

3058 
ch
 = 
	`fg‘c
(
¡»am
);

3060 
Ãg
 = 
MP_ZPOS
;

3065 
y
 = 0; y < 
¿dix
; y++) {

3066 ià(
mp_s_rm­
[
y
] =ğ
ch
) {

3070 ià(
y
 =ğ
¿dix
) {

3075 ià((
”r
 = 
	`mp_mul_d
(
a
, 
¿dix
,‡)è!ğ
MP_OKAY
) {

3076  
”r
;

3078 ià((
”r
 = 
	`mp_add_d
(
a
, 
y
,‡)è!ğ
MP_OKAY
) {

3079  
”r
;

3082 
ch
 = 
	`fg‘c
(
¡»am
);

3084 ià(
	`mp_cmp_d
(
a
, 0è!ğ
MP_EQ
) {

3085 
a
->
sign
 = 
Ãg
;

3088  
MP_OKAY
;

3089 
	}
}

3100 
	~<tomm©h.h
>

3101 #ifdeà
BN_MP_FWRITE_C


3117 
	$mp_fwr™e
(
mp_št
 *
a
, 
¿dix
, 
FILE
 *
¡»am
)

3119 *
buf
;

3120 
”r
, 
Ën
, 
x
;

3122 ià((
”r
 = 
	`mp_¿dix_size
(
a
, 
¿dix
, &
Ën
)è!ğ
MP_OKAY
) {

3123  
”r
;

3126 
buf
 = 
	`OPT_CAST
(è
	`XMALLOC
 (
Ën
);

3127 ià(
buf
 =ğ
NULL
) {

3128  
MP_MEM
;

3131 ià((
”r
 = 
	`mp_tÜadix
(
a
, 
buf
, 
¿dix
)è!ğ
MP_OKAY
) {

3132 
	`XFREE
 (
buf
);

3133  
”r
;

3136 
x
 = 0; x < 
Ën
; x++) {

3137 ià(
	`åutc
(
buf
[
x
], 
¡»am
è=ğ
EOF
) {

3138 
	`XFREE
 (
buf
);

3139  
MP_VAL
;

3143 
	`XFREE
 (
buf
);

3144  
MP_OKAY
;

3145 
	}
}

3156 
	~<tomm©h.h
>

3157 #ifdeà
BN_MP_GCD_C


3174 
	$mp_gcd
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

3176 
mp_št
 
u
, 
v
;

3177 
k
, 
u_lsb
, 
v_lsb
, 
»s
;

3180 ià(
	`mp_isz”o
 (
a
è=ğ
MP_YES
) {

3181  
	`mp_abs
 (
b
, 
c
);

3183 ià(
	`mp_isz”o
 (
b
è=ğ
MP_YES
) {

3184  
	`mp_abs
 (
a
, 
c
);

3188 ià((
»s
 = 
	`mp_š™_cİy
 (&
u
, 
a
)è!ğ
MP_OKAY
) {

3189  
»s
;

3192 ià((
»s
 = 
	`mp_š™_cİy
 (&
v
, 
b
)è!ğ
MP_OKAY
) {

3193 
LBL_U
;

3197 
u
.
sign
 = 
v
.sigÀğ
MP_ZPOS
;

3200 
u_lsb
 = 
	`mp_út_lsb
(&
u
);

3201 
v_lsb
 = 
	`mp_út_lsb
(&
v
);

3202 
k
 = 
	`MIN
(
u_lsb
, 
v_lsb
);

3204 ià(
k
 > 0) {

3206 ià((
»s
 = 
	`mp_div_2d
(&
u
, 
k
, &u, 
NULL
)è!ğ
MP_OKAY
) {

3207 
LBL_V
;

3210 ià((
»s
 = 
	`mp_div_2d
(&
v
, 
k
, &v, 
NULL
)è!ğ
MP_OKAY
) {

3211 
LBL_V
;

3216 ià(
u_lsb
 !ğ
k
) {

3217 ià((
»s
 = 
	`mp_div_2d
(&
u
, 
u_lsb
 - 
k
, &u, 
NULL
)è!ğ
MP_OKAY
) {

3218 
LBL_V
;

3222 ià(
v_lsb
 !ğ
k
) {

3223 ià((
»s
 = 
	`mp_div_2d
(&
v
, 
v_lsb
 - 
k
, &v, 
NULL
)è!ğ
MP_OKAY
) {

3224 
LBL_V
;

3228 
	`mp_isz”o
(&
v
) == 0) {

3230 ià(
	`mp_cmp_mag
(&
u
, &
v
è=ğ
MP_GT
) {

3232 
	`mp_exch
(&
u
, &
v
);

3236 ià((
»s
 = 
	`s_mp_sub
(&
v
, &
u
, &v)è!ğ
MP_OKAY
) {

3237 
LBL_V
;

3241 ià((
»s
 = 
	`mp_div_2d
(&
v
, 
	`mp_út_lsb
(&v), &v, 
NULL
)è!ğ
MP_OKAY
) {

3242 
LBL_V
;

3247 ià((
»s
 = 
	`mp_mul_2d
 (&
u
, 
k
, 
c
)è!ğ
MP_OKAY
) {

3248 
LBL_V
;

3250 
c
->
sign
 = 
MP_ZPOS
;

3251 
»s
 = 
MP_OKAY
;

3252 
LBL_V
:
	`mp_ş—r
 (&
u
);

3253 
LBL_U
:
	`mp_ş—r
 (&
v
);

3254  
»s
;

3255 
	}
}

3265 
	~<tomm©h.h
>

3266 #ifdeà
BN_MP_GET_INT_C


3283 
	$mp_g‘_št
(
mp_št
 * 
a
)

3285 
i
;

3286 
»s
;

3288 ià(
a
->
u£d
 == 0) {

3293 
i
 = 
	`MIN
(
a
->
u£d
,()((()*
CHAR_BIT
+
DIGIT_BIT
-1)/DIGIT_BIT))-1;

3296 
»s
 = 
	`DIGIT
(
a
,
i
);

3298 --
i
 >= 0) {

3299 
»s
 = (» << 
DIGIT_BIT
è| 
	`DIGIT
(
a
,
i
);

3303  
»s
 & 0xFFFFFFFFUL;

3304 
	}
}

3314 
	~<tomm©h.h
>

3315 #ifdeà
BN_MP_GROW_C


3332 
	$mp_grow
 (
mp_št
 * 
a
, 
size
)

3334 
i
;

3335 
mp_dig™
 *
tmp
;

3338 ià(
a
->
®loc
 < 
size
) {

3340 
size
 +ğ(
MP_PREC
 * 2) - (size % MP_PREC);

3348 
tmp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XREALLOC
 (
a
->
dp
,  (mp_dig™è* 
size
);

3349 ià(
tmp
 =ğ
NULL
) {

3351  
MP_MEM
;

3355 
a
->
dp
 = 
tmp
;

3358 
i
 = 
a
->
®loc
;

3359 
a
->
®loc
 = 
size
;

3360 ; 
i
 < 
a
->
®loc
; i++) {

3361 
a
->
dp
[
i
] = 0;

3364  
MP_OKAY
;

3365 
	}
}

3375 
	~<tomm©h.h
>

3376 #ifdeà
BN_MP_INIT_C


3393 
	$mp_š™
 (
mp_št
 * 
a
)

3395 
i
;

3398 
a
->
dp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XMALLOC
 ( (mp_dig™è* 
MP_PREC
);

3399 ià(
a
->
dp
 =ğ
NULL
) {

3400  
MP_MEM
;

3404 
i
 = 0; i < 
MP_PREC
; i++) {

3405 
a
->
dp
[
i
] = 0;

3410 
a
->
u£d
 = 0;

3411 
a
->
®loc
 = 
MP_PREC
;

3412 
a
->
sign
 = 
MP_ZPOS
;

3414  
MP_OKAY
;

3415 
	}
}

3425 
	~<tomm©h.h
>

3426 #ifdeà
BN_MP_INIT_COPY_C


3443 
	$mp_š™_cİy
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

3445 
»s
;

3447 ià((
»s
 = 
	`mp_š™
 (
a
)è!ğ
MP_OKAY
) {

3448  
»s
;

3450  
	`mp_cİy
 (
b
, 
a
);

3451 
	}
}

3461 
	~<tomm©h.h
>

3462 #ifdeà
BN_MP_INIT_MULTI_C


3477 
	~<¡d¬g.h
>

3479 
	$mp_š™_muÉi
(
mp_št
 *
mp
, ...)

3481 
mp_”r
 
»s
 = 
MP_OKAY
;

3482 
n
 = 0;

3483 
mp_št
* 
cur_¬g
 = 
mp
;

3484 
va_li¡
 
¬gs
;

3486 
	`va_¡¬t
(
¬gs
, 
mp
);

3487 
cur_¬g
 !ğ
NULL
) {

3488 ià(
	`mp_š™
(
cur_¬g
è!ğ
MP_OKAY
) {

3492 
va_li¡
 
ş—n_¬gs
;

3495 
	`va_’d
(
¬gs
);

3498 
cur_¬g
 = 
mp
;

3499 
	`va_¡¬t
(
ş—n_¬gs
, 
mp
);

3500 
n
--) {

3501 
	`mp_ş—r
(
cur_¬g
);

3502 
cur_¬g
 = 
	`va_¬g
(
ş—n_¬gs
, 
mp_št
*);

3504 
	`va_’d
(
ş—n_¬gs
);

3505 
»s
 = 
MP_MEM
;

3508 
n
++;

3509 
cur_¬g
 = 
	`va_¬g
(
¬gs
, 
mp_št
*);

3511 
	`va_’d
(
¬gs
);

3512  
»s
;

3513 
	}
}

3524 
	~<tomm©h.h
>

3525 #ifdeà
BN_MP_INIT_SET_C


3542 
	$mp_š™_£t
 (
mp_št
 * 
a
, 
mp_dig™
 
b
)

3544 
”r
;

3545 ià((
”r
 = 
	`mp_š™
(
a
)è!ğ
MP_OKAY
) {

3546  
”r
;

3548 
	`mp_£t
(
a
, 
b
);

3549  
”r
;

3550 
	}
}

3560 
	~<tomm©h.h
>

3561 #ifdeà
BN_MP_INIT_SET_INT_C


3578 
	$mp_š™_£t_št
 (
mp_št
 * 
a
, 
b
)

3580 
”r
;

3581 ià((
”r
 = 
	`mp_š™
(
a
)è!ğ
MP_OKAY
) {

3582  
”r
;

3584  
	`mp_£t_št
(
a
, 
b
);

3585 
	}
}

3595 
	~<tomm©h.h
>

3596 #ifdeà
BN_MP_INIT_SIZE_C


3613 
	$mp_š™_size
 (
mp_št
 * 
a
, 
size
)

3615 
x
;

3618 
size
 +ğ(
MP_PREC
 * 2) - (size % MP_PREC);

3621 
a
->
dp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XMALLOC
 ( (mp_dig™è* 
size
);

3622 ià(
a
->
dp
 =ğ
NULL
) {

3623  
MP_MEM
;

3627 
a
->
u£d
 = 0;

3628 
a
->
®loc
 = 
size
;

3629 
a
->
sign
 = 
MP_ZPOS
;

3632 
x
 = 0; x < 
size
; x++) {

3633 
a
->
dp
[
x
] = 0;

3636  
MP_OKAY
;

3637 
	}
}

3647 
	~<tomm©h.h
>

3648 #ifdeà
BN_MP_INVMOD_C


3665 
	$mp_švmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

3668 ià(
b
->
sign
 =ğ
MP_NEG
 || 
	`mp_isz”o
(b) == 1) {

3669  
MP_VAL
;

3672 #ifdeà
BN_FAST_MP_INVMOD_C


3674 ià(
	`mp_isodd
 (
b
) == 1) {

3675  
	`ç¡_mp_švmod
 (
a
, 
b
, 
c
);

3679 #ifdeà
BN_MP_INVMOD_SLOW_C


3680  
	`mp_švmod_¦ow
(
a
, 
b
, 
c
);

3683  
MP_VAL
;

3684 
	}
}

3694 
	~<tomm©h.h
>

3695 #ifdeà
BN_MP_INVMOD_SLOW_C


3712 
	$mp_švmod_¦ow
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

3714 
mp_št
 
x
, 
y
, 
u
, 
v
, 
A
, 
B
, 
C
, 
D
;

3715 
»s
;

3718 ià(
b
->
sign
 =ğ
MP_NEG
 || 
	`mp_isz”o
(b) == 1) {

3719  
MP_VAL
;

3723 ià((
»s
 = 
	`mp_š™_muÉi
(&
x
, &
y
, &
u
, &
v
,

3724 &
A
, &
B
, &
C
, &
D
, 
NULL
)è!ğ
MP_OKAY
) {

3725  
»s
;

3729 ià((
»s
 = 
	`mp_mod
(
a
, 
b
, &
x
)è!ğ
MP_OKAY
) {

3730 
LBL_ERR
;

3732 ià((
»s
 = 
	`mp_cİy
 (
b
, &
y
)è!ğ
MP_OKAY
) {

3733 
LBL_ERR
;

3737 ià(
	`mp_i£v’
 (&
x
è=ğ1 && mp_i£v’ (&
y
) == 1) {

3738 
»s
 = 
MP_VAL
;

3739 
LBL_ERR
;

3743 ià((
»s
 = 
	`mp_cİy
 (&
x
, &
u
)è!ğ
MP_OKAY
) {

3744 
LBL_ERR
;

3746 ià((
»s
 = 
	`mp_cİy
 (&
y
, &
v
)è!ğ
MP_OKAY
) {

3747 
LBL_ERR
;

3749 
	`mp_£t
 (&
A
, 1);

3750 
	`mp_£t
 (&
D
, 1);

3752 
tİ
:

3754 
	`mp_i£v’
 (&
u
) == 1) {

3756 ià((
»s
 = 
	`mp_div_2
 (&
u
, &u)è!ğ
MP_OKAY
) {

3757 
LBL_ERR
;

3760 ià(
	`mp_isodd
 (&
A
è=ğ1 || mp_isodd (&
B
) == 1) {

3762 ià((
»s
 = 
	`mp_add
 (&
A
, &
y
, &A)è!ğ
MP_OKAY
) {

3763 
LBL_ERR
;

3765 ià((
»s
 = 
	`mp_sub
 (&
B
, &
x
, &B)è!ğ
MP_OKAY
) {

3766 
LBL_ERR
;

3770 ià((
»s
 = 
	`mp_div_2
 (&
A
, &A)è!ğ
MP_OKAY
) {

3771 
LBL_ERR
;

3773 ià((
»s
 = 
	`mp_div_2
 (&
B
, &B)è!ğ
MP_OKAY
) {

3774 
LBL_ERR
;

3779 
	`mp_i£v’
 (&
v
) == 1) {

3781 ià((
»s
 = 
	`mp_div_2
 (&
v
, &v)è!ğ
MP_OKAY
) {

3782 
LBL_ERR
;

3785 ià(
	`mp_isodd
 (&
C
è=ğ1 || mp_isodd (&
D
) == 1) {

3787 ià((
»s
 = 
	`mp_add
 (&
C
, &
y
, &C)è!ğ
MP_OKAY
) {

3788 
LBL_ERR
;

3790 ià((
»s
 = 
	`mp_sub
 (&
D
, &
x
, &D)è!ğ
MP_OKAY
) {

3791 
LBL_ERR
;

3795 ià((
»s
 = 
	`mp_div_2
 (&
C
, &C)è!ğ
MP_OKAY
) {

3796 
LBL_ERR
;

3798 ià((
»s
 = 
	`mp_div_2
 (&
D
, &D)è!ğ
MP_OKAY
) {

3799 
LBL_ERR
;

3804 ià(
	`mp_cmp
 (&
u
, &
v
è!ğ
MP_LT
) {

3806 ià((
»s
 = 
	`mp_sub
 (&
u
, &
v
, &u)è!ğ
MP_OKAY
) {

3807 
LBL_ERR
;

3810 ià((
»s
 = 
	`mp_sub
 (&
A
, &
C
, &A)è!ğ
MP_OKAY
) {

3811 
LBL_ERR
;

3814 ià((
»s
 = 
	`mp_sub
 (&
B
, &
D
, &B)è!ğ
MP_OKAY
) {

3815 
LBL_ERR
;

3819 ià((
»s
 = 
	`mp_sub
 (&
v
, &
u
, &v)è!ğ
MP_OKAY
) {

3820 
LBL_ERR
;

3823 ià((
»s
 = 
	`mp_sub
 (&
C
, &
A
, &C)è!ğ
MP_OKAY
) {

3824 
LBL_ERR
;

3827 ià((
»s
 = 
	`mp_sub
 (&
D
, &
B
, &D)è!ğ
MP_OKAY
) {

3828 
LBL_ERR
;

3833 ià(
	`mp_isz”o
 (&
u
) == 0)

3834 
tİ
;

3839 ià(
	`mp_cmp_d
 (&
v
, 1è!ğ
MP_EQ
) {

3840 
»s
 = 
MP_VAL
;

3841 
LBL_ERR
;

3845 
	`mp_cmp_d
(&
C
, 0è=ğ
MP_LT
) {

3846 ià((
»s
 = 
	`mp_add
(&
C
, 
b
, &C)è!ğ
MP_OKAY
) {

3847 
LBL_ERR
;

3852 
	`mp_cmp_mag
(&
C
, 
b
è!ğ
MP_LT
) {

3853 ià((
»s
 = 
	`mp_sub
(&
C
, 
b
, &C)è!ğ
MP_OKAY
) {

3854 
LBL_ERR
;

3859 
	`mp_exch
 (&
C
, 
c
);

3860 
»s
 = 
MP_OKAY
;

3861 
LBL_ERR
:
	`mp_ş—r_muÉi
 (&
x
, &
y
, &
u
, &
v
, &
A
, &
B
, &
C
, &
D
, 
NULL
);

3862  
»s
;

3863 
	}
}

3873 
	~<tomm©h.h
>

3874 #ifdeà
BN_MP_IS_SQUARE_C


3891 cÚ¡ 
	g»m_128
[128] = {

3902 cÚ¡ 
	g»m_105
[105] = {

3913 
	$mp_is_squ¬e
(
mp_št
 *
¬g
,*
»t
)

3915 
»s
;

3916 
mp_dig™
 
c
;

3917 
mp_št
 
t
;

3918 
r
;

3921 *
»t
 = 
MP_NO
;

3923 ià(
¬g
->
sign
 =ğ
MP_NEG
) {

3924  
MP_VAL
;

3928 ià(
¬g
->
u£d
 == 0) {

3929  
MP_OKAY
;

3933 ià(
»m_128
[127 & 
	`DIGIT
(
¬g
,0)] == 1) {

3934  
MP_OKAY
;

3938 ià((
»s
 = 
	`mp_mod_d
(
¬g
,105,&
c
)è!ğ
MP_OKAY
) {

3939  
»s
;

3941 ià(
»m_105
[
c
] == 1) {

3942  
MP_OKAY
;

3946 ià((
»s
 = 
	`mp_š™_£t_št
(&
t
,11L*13L*17L*19L*23L*29L*31L)è!ğ
MP_OKAY
) {

3947  
»s
;

3949 ià((
»s
 = 
	`mp_mod
(
¬g
,&
t
,&t)è!ğ
MP_OKAY
) {

3950 
ERR
;

3952 
r
 = 
	`mp_g‘_št
(&
t
);

3957 iàĞ(1L<<(
r
%11)è& 0x5C4L ) 
ERR
;

3958 iàĞ(1L<<(
r
%13)è& 0x9E4L ) 
ERR
;

3959 iàĞ(1L<<(
r
%17)è& 0x5CE8L ) 
ERR
;

3960 iàĞ(1L<<(
r
%19)è& 0x4F50CL ) 
ERR
;

3961 iàĞ(1L<<(
r
%23)è& 0x7ACCA0L ) 
ERR
;

3962 iàĞ(1L<<(
r
%29)è& 0xC2EDD0CL ) 
ERR
;

3963 iàĞ(1L<<(
r
%31)è& 0x6DE2B848L ) 
ERR
;

3966 ià((
»s
 = 
	`mp_sq¹
(
¬g
,&
t
)è!ğ
MP_OKAY
) {

3967 
ERR
;

3969 ià((
»s
 = 
	`mp_sqr
(&
t
,&t)è!ğ
MP_OKAY
) {

3970 
ERR
;

3973 *
»t
 = (
	`mp_cmp_mag
(&
t
,
¬g
è=ğ
MP_EQ
è? 
MP_YES
 : 
MP_NO
;

3974 
ERR
:
	`mp_ş—r
(&
t
);

3975  
»s
;

3976 
	}
}

3986 
	~<tomm©h.h
>

3987 #ifdeà
BN_MP_JACOBI_C


4006 
	$mp_jacobi
 (
mp_št
 * 
a
, mp_šˆ* 
p
, *
c
)

4008 
mp_št
 
a1
, 
p1
;

4009 
k
, 
s
, 
r
, 
»s
;

4010 
mp_dig™
 
»sidue
;

4013 ià(
	`mp_cmp_d
(
p
, 0è!ğ
MP_GT
) {

4014  
MP_VAL
;

4018 ià(
	`mp_isz”o
 (
a
) == 1) {

4019 *
c
 = 0;

4020  
MP_OKAY
;

4024 ià(
	`mp_cmp_d
 (
a
, 1è=ğ
MP_EQ
) {

4025 *
c
 = 1;

4026  
MP_OKAY
;

4030 
s
 = 0;

4033 ià((
»s
 = 
	`mp_š™_cİy
 (&
a1
, 
a
)è!ğ
MP_OKAY
) {

4034  
»s
;

4037 ià((
»s
 = 
	`mp_š™
 (&
p1
)è!ğ
MP_OKAY
) {

4038 
LBL_A1
;

4042 
k
 = 
	`mp_út_lsb
(&
a1
);

4043 ià((
»s
 = 
	`mp_div_2d
(&
a1
, 
k
, &a1, 
NULL
)è!ğ
MP_OKAY
) {

4044 
LBL_P1
;

4048 ià((
k
 & 1) == 0) {

4049 
s
 = 1;

4052 
»sidue
 = 
p
->
dp
[0] & 7;

4054 ià(
»sidue
 == 1 ||„esidue == 7) {

4055 
s
 = 1;

4056 } ià(
»sidue
 == 3 ||„esidue == 5) {

4057 
s
 = -1;

4062 iàĞ((
p
->
dp
[0] & 3è=ğ3è&& ((
a1
.dp[0] & 3) == 3)) {

4063 
s
 = -s;

4067 ià(
	`mp_cmp_d
 (&
a1
, 1è=ğ
MP_EQ
) {

4068 *
c
 = 
s
;

4071 ià((
»s
 = 
	`mp_mod
 (
p
, &
a1
, &
p1
)è!ğ
MP_OKAY
) {

4072 
LBL_P1
;

4074 ià((
»s
 = 
	`mp_jacobi
 (&
p1
, &
a1
, &
r
)è!ğ
MP_OKAY
) {

4075 
LBL_P1
;

4077 *
c
 = 
s
 * 
r
;

4081 
»s
 = 
MP_OKAY
;

4082 
LBL_P1
:
	`mp_ş—r
 (&
p1
);

4083 
LBL_A1
:
	`mp_ş—r
 (&
a1
);

4084  
»s
;

4085 
	}
}

4095 
	~<tomm©h.h
>

4096 #ifdeà
BN_MP_KARATSUBA_MUL_C


4141 
	$mp_k¬©suba_mul
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

4143 
mp_št
 
x0
, 
x1
, 
y0
, 
y1
, 
t1
, 
x0y0
, 
x1y1
;

4144 
B
, 
”r
;

4147 
”r
 = 
MP_MEM
;

4150 
B
 = 
	`MIN
 (
a
->
u£d
, 
b
->used);

4153 
B
 = B >> 1;

4156 ià(
	`mp_š™_size
 (&
x0
, 
B
è!ğ
MP_OKAY
)

4157 
ERR
;

4158 ià(
	`mp_š™_size
 (&
x1
, 
a
->
u£d
 - 
B
è!ğ
MP_OKAY
)

4159 
X0
;

4160 ià(
	`mp_š™_size
 (&
y0
, 
B
è!ğ
MP_OKAY
)

4161 
X1
;

4162 ià(
	`mp_š™_size
 (&
y1
, 
b
->
u£d
 - 
B
è!ğ
MP_OKAY
)

4163 
Y0
;

4166 ià(
	`mp_š™_size
 (&
t1
, 
B
 * 2è!ğ
MP_OKAY
)

4167 
Y1
;

4168 ià(
	`mp_š™_size
 (&
x0y0
, 
B
 * 2è!ğ
MP_OKAY
)

4169 
T1
;

4170 ià(
	`mp_š™_size
 (&
x1y1
, 
B
 * 2è!ğ
MP_OKAY
)

4171 
X0Y0
;

4174 
x0
.
u£d
 = 
y0
.u£d = 
B
;

4175 
x1
.
u£d
 = 
a
->u£d - 
B
;

4176 
y1
.
u£d
 = 
b
->u£d - 
B
;

4179 
x
;

4180 
mp_dig™
 *
tm·
, *
tmpb
, *
tmpx
, *
tmpy
;

4185 
tm·
 = 
a
->
dp
;

4186 
tmpb
 = 
b
->
dp
;

4188 
tmpx
 = 
x0
.
dp
;

4189 
tmpy
 = 
y0
.
dp
;

4190 
x
 = 0; x < 
B
; x++) {

4191 *
tmpx
++ = *
tm·
++;

4192 *
tmpy
++ = *
tmpb
++;

4195 
tmpx
 = 
x1
.
dp
;

4196 
x
 = 
B
; x < 
a
->
u£d
; x++) {

4197 *
tmpx
++ = *
tm·
++;

4200 
tmpy
 = 
y1
.
dp
;

4201 
x
 = 
B
; x < 
b
->
u£d
; x++) {

4202 *
tmpy
++ = *
tmpb
++;

4209 
	`mp_şamp
 (&
x0
);

4210 
	`mp_şamp
 (&
y0
);

4214 ià(
	`mp_mul
 (&
x0
, &
y0
, &
x0y0
è!ğ
MP_OKAY
)

4215 
X1Y1
;

4216 ià(
	`mp_mul
 (&
x1
, &
y1
, &
x1y1
è!ğ
MP_OKAY
)

4217 
X1Y1
;

4220 ià(
	`s_mp_add
 (&
x1
, &
x0
, &
t1
è!ğ
MP_OKAY
)

4221 
X1Y1
;

4222 ià(
	`s_mp_add
 (&
y1
, &
y0
, &
x0
è!ğ
MP_OKAY
)

4223 
X1Y1
;

4224 ià(
	`mp_mul
 (&
t1
, &
x0
, &t1è!ğ
MP_OKAY
)

4225 
X1Y1
;

4228 ià(
	`mp_add
 (&
x0y0
, &
x1y1
, &
x0
è!ğ
MP_OKAY
)

4229 
X1Y1
;

4230 ià(
	`s_mp_sub
 (&
t1
, &
x0
, &t1è!ğ
MP_OKAY
)

4231 
X1Y1
;

4234 ià(
	`mp_lshd
 (&
t1
, 
B
è!ğ
MP_OKAY
)

4235 
X1Y1
;

4236 ià(
	`mp_lshd
 (&
x1y1
, 
B
 * 2è!ğ
MP_OKAY
)

4237 
X1Y1
;

4239 ià(
	`mp_add
 (&
x0y0
, &
t1
, &t1è!ğ
MP_OKAY
)

4240 
X1Y1
;

4241 ià(
	`mp_add
 (&
t1
, &
x1y1
, 
c
è!ğ
MP_OKAY
)

4242 
X1Y1
;

4245 
”r
 = 
MP_OKAY
;

4247 
X1Y1
:
	`mp_ş—r
 (&
x1y1
);

4248 
X0Y0
:
	`mp_ş—r
 (&
x0y0
);

4249 
T1
:
	`mp_ş—r
 (&
t1
);

4250 
Y1
:
	`mp_ş—r
 (&
y1
);

4251 
Y0
:
	`mp_ş—r
 (&
y0
);

4252 
X1
:
	`mp_ş—r
 (&
x1
);

4253 
X0
:
	`mp_ş—r
 (&
x0
);

4254 
ERR
:

4255  
”r
;

4256 
	}
}

4266 
	~<tomm©h.h
>

4267 #ifdeà
BN_MP_KARATSUBA_SQR_C


4290 
	$mp_k¬©suba_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

4292 
mp_št
 
x0
, 
x1
, 
t1
, 
t2
, 
x0x0
, 
x1x1
;

4293 
B
, 
”r
;

4295 
”r
 = 
MP_MEM
;

4298 
B
 = 
a
->
u£d
;

4301 
B
 = B >> 1;

4304 ià(
	`mp_š™_size
 (&
x0
, 
B
è!ğ
MP_OKAY
)

4305 
ERR
;

4306 ià(
	`mp_š™_size
 (&
x1
, 
a
->
u£d
 - 
B
è!ğ
MP_OKAY
)

4307 
X0
;

4310 ià(
	`mp_š™_size
 (&
t1
, 
a
->
u£d
 * 2è!ğ
MP_OKAY
)

4311 
X1
;

4312 ià(
	`mp_š™_size
 (&
t2
, 
a
->
u£d
 * 2è!ğ
MP_OKAY
)

4313 
T1
;

4314 ià(
	`mp_š™_size
 (&
x0x0
, 
B
 * 2è!ğ
MP_OKAY
)

4315 
T2
;

4316 ià(
	`mp_š™_size
 (&
x1x1
, (
a
->
u£d
 - 
B
è* 2è!ğ
MP_OKAY
)

4317 
X0X0
;

4320 
x
;

4321 
mp_dig™
 *
d¡
, *
¤c
;

4323 
¤c
 = 
a
->
dp
;

4326 
d¡
 = 
x0
.
dp
;

4327 
x
 = 0; x < 
B
; x++) {

4328 *
d¡
++ = *
¤c
++;

4331 
d¡
 = 
x1
.
dp
;

4332 
x
 = 
B
; x < 
a
->
u£d
; x++) {

4333 *
d¡
++ = *
¤c
++;

4337 
x0
.
u£d
 = 
B
;

4338 
x1
.
u£d
 = 
a
->u£d - 
B
;

4340 
	`mp_şamp
 (&
x0
);

4343 ià(
	`mp_sqr
 (&
x0
, &
x0x0
è!ğ
MP_OKAY
)

4344 
X1X1
;

4345 ià(
	`mp_sqr
 (&
x1
, &
x1x1
è!ğ
MP_OKAY
)

4346 
X1X1
;

4349 ià(
	`s_mp_add
 (&
x1
, &
x0
, &
t1
è!ğ
MP_OKAY
)

4350 
X1X1
;

4351 ià(
	`mp_sqr
 (&
t1
, &t1è!ğ
MP_OKAY
)

4352 
X1X1
;

4355 ià(
	`s_mp_add
 (&
x0x0
, &
x1x1
, &
t2
è!ğ
MP_OKAY
)

4356 
X1X1
;

4357 ià(
	`s_mp_sub
 (&
t1
, &
t2
, &t1è!ğ
MP_OKAY
)

4358 
X1X1
;

4361 ià(
	`mp_lshd
 (&
t1
, 
B
è!ğ
MP_OKAY
)

4362 
X1X1
;

4363 ià(
	`mp_lshd
 (&
x1x1
, 
B
 * 2è!ğ
MP_OKAY
)

4364 
X1X1
;

4366 ià(
	`mp_add
 (&
x0x0
, &
t1
, &t1è!ğ
MP_OKAY
)

4367 
X1X1
;

4368 ià(
	`mp_add
 (&
t1
, &
x1x1
, 
b
è!ğ
MP_OKAY
)

4369 
X1X1
;

4371 
”r
 = 
MP_OKAY
;

4373 
X1X1
:
	`mp_ş—r
 (&
x1x1
);

4374 
X0X0
:
	`mp_ş—r
 (&
x0x0
);

4375 
T2
:
	`mp_ş—r
 (&
t2
);

4376 
T1
:
	`mp_ş—r
 (&
t1
);

4377 
X1
:
	`mp_ş—r
 (&
x1
);

4378 
X0
:
	`mp_ş—r
 (&
x0
);

4379 
ERR
:

4380  
”r
;

4381 
	}
}

4391 
	~<tomm©h.h
>

4392 #ifdeà
BN_MP_LCM_C


4409 
	$mp_lcm
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

4411 
»s
;

4412 
mp_št
 
t1
, 
t2
;

4415 ià((
»s
 = 
	`mp_š™_muÉi
 (&
t1
, &
t2
, 
NULL
)è!ğ
MP_OKAY
) {

4416  
»s
;

4420 ià((
»s
 = 
	`mp_gcd
 (
a
, 
b
, &
t1
)è!ğ
MP_OKAY
) {

4421 
LBL_T
;

4425 ià(
	`mp_cmp_mag
(
a
, 
b
è=ğ
MP_LT
) {

4427 ià((
»s
 = 
	`mp_div
(
a
, &
t1
, &
t2
, 
NULL
)è!ğ
MP_OKAY
) {

4428 
LBL_T
;

4430 
»s
 = 
	`mp_mul
(
b
, &
t2
, 
c
);

4433 ià((
»s
 = 
	`mp_div
(
b
, &
t1
, &
t2
, 
NULL
)è!ğ
MP_OKAY
) {

4434 
LBL_T
;

4436 
»s
 = 
	`mp_mul
(
a
, &
t2
, 
c
);

4440 
c
->
sign
 = 
MP_ZPOS
;

4442 
LBL_T
:

4443 
	`mp_ş—r_muÉi
 (&
t1
, &
t2
, 
NULL
);

4444  
»s
;

4445 
	}
}

4455 
	~<tomm©h.h
>

4456 #ifdeà
BN_MP_LSHD_C


4473 
	$mp_lshd
 (
mp_št
 * 
a
, 
b
)

4475 
x
, 
»s
;

4478 ià(
b
 <= 0) {

4479  
MP_OKAY
;

4483 ià(
a
->
®loc
 <‡->
u£d
 + 
b
) {

4484 ià((
»s
 = 
	`mp_grow
 (
a
,‡->
u£d
 + 
b
)è!ğ
MP_OKAY
) {

4485  
»s
;

4490 
mp_dig™
 *
tİ
, *
bÙtom
;

4493 
a
->
u£d
 +ğ
b
;

4496 
tİ
 = 
a
->
dp
 +‡->
u£d
 - 1;

4499 
bÙtom
 = 
a
->
dp
 +‡->
u£d
 - 1 - 
b
;

4505 
x
 = 
a
->
u£d
 - 1; x >ğ
b
; x--) {

4506 *
tİ
-- = *
bÙtom
--;

4510 
tİ
 = 
a
->
dp
;

4511 
x
 = 0; x < 
b
; x++) {

4512 *
tİ
++ = 0;

4515  
MP_OKAY
;

4516 
	}
}

4526 
	~<tomm©h.h
>

4527 #ifdeà
BN_MP_MOD_C


4545 
	$mp_mod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

4547 
mp_št
 
t
;

4548 
»s
;

4550 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

4551  
»s
;

4554 ià((
»s
 = 
	`mp_div
 (
a
, 
b
, 
NULL
, &
t
)è!ğ
MP_OKAY
) {

4555 
	`mp_ş—r
 (&
t
);

4556  
»s
;

4559 ià(
t
.
sign
 !ğ
b
->sign) {

4560 
»s
 = 
	`mp_add
 (
b
, &
t
, 
c
);

4562 
»s
 = 
MP_OKAY
;

4563 
	`mp_exch
 (&
t
, 
c
);

4566 
	`mp_ş—r
 (&
t
);

4567  
»s
;

4568 
	}
}

4578 
	~<tomm©h.h
>

4579 #ifdeà
BN_MP_MOD_2D_C


4597 
	$mp_mod_2d
 (
mp_št
 * 
a
, 
b
, mp_šˆ* 
c
)

4599 
x
, 
»s
;

4602 ià(
b
 <= 0) {

4603 
	`mp_z”o
 (
c
);

4604  
MP_OKAY
;

4608 ià(
b
 >ğ(è(
a
->
u£d
 * 
DIGIT_BIT
)) {

4609 
»s
 = 
	`mp_cİy
 (
a
, 
c
);

4610  
»s
;

4614 ià((
»s
 = 
	`mp_cİy
 (
a
, 
c
)è!ğ
MP_OKAY
) {

4615  
»s
;

4619 
x
 = (
b
 / 
DIGIT_BIT
è+ ((b % DIGIT_BITè=ğ0 ? 0 : 1); x < 
c
->
u£d
; x++) {

4620 
c
->
dp
[
x
] = 0;

4623 
c
->
dp
[
b
 / 
DIGIT_BIT
] &=

4624 (
mp_dig™
è((((mp_dig™è1è<< (((mp_dig™è
b
è% 
DIGIT_BIT
)) - ((mp_digit) 1));

4625 
	`mp_şamp
 (
c
);

4626  
MP_OKAY
;

4627 
	}
}

4637 
	~<tomm©h.h
>

4638 #ifdeà
BN_MP_MOD_D_C


4655 
	$mp_mod_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_dig™ * 
c
)

4657  
	`mp_div_d
(
a
, 
b
, 
NULL
, 
c
);

4658 
	}
}

4668 
	~<tomm©h.h
>

4669 #ifdeà
BN_MP_MONTGOMERY_CALC_NORMALIZATION_C


4691 
	$mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

4693 
x
, 
b™s
, 
»s
;

4696 
b™s
 = 
	`mp_couÁ_b™s
 (
b
è% 
DIGIT_BIT
;

4698 ià(
b
->
u£d
 > 1) {

4699 ià((
»s
 = 
	`mp_2ex±
 (
a
, (
b
->
u£d
 - 1è* 
DIGIT_BIT
 + 
b™s
 - 1)è!ğ
MP_OKAY
) {

4700  
»s
;

4703 
	`mp_£t
(
a
, 1);

4704 
b™s
 = 1;

4709 
x
 = 
b™s
 - 1; x < ()
DIGIT_BIT
; x++) {

4710 ià((
»s
 = 
	`mp_mul_2
 (
a
,‡)è!ğ
MP_OKAY
) {

4711  
»s
;

4713 ià(
	`mp_cmp_mag
 (
a
, 
b
è!ğ
MP_LT
) {

4714 ià((
»s
 = 
	`s_mp_sub
 (
a
, 
b
,‡)è!ğ
MP_OKAY
) {

4715  
»s
;

4720  
MP_OKAY
;

4721 
	}
}

4731 
	~<tomm©h.h
>

4732 #ifdeà
BN_MP_MONTGOMERY_REDUCE_C


4750 
	$mp_mÚtgom”y_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
n
, 
mp_dig™
 
rho
)

4752 
ix
, 
»s
, 
digs
;

4753 
mp_dig™
 
mu
;

4761 
digs
 = 
n
->
u£d
 * 2 + 1;

4762 ià((
digs
 < 
MP_WARRAY
) &&

4763 
n
->
u£d
 <

4764 (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

4765  
	`ç¡_mp_mÚtgom”y_»duû
 (
x
, 
n
, 
rho
);

4769 ià(
x
->
®loc
 < 
digs
) {

4770 ià((
»s
 = 
	`mp_grow
 (
x
, 
digs
)è!ğ
MP_OKAY
) {

4771  
»s
;

4774 
x
->
u£d
 = 
digs
;

4776 
ix
 = 0; ix < 
n
->
u£d
; ix++) {

4785 
mu
 = (
mp_dig™
è(((
mp_wÜd
)
x
->
dp
[
ix
]è* ((mp_wÜd)
rho
è& 
MP_MASK
);

4789 
iy
;

4790 
mp_dig™
 *
tm²
, *
tmpx
, 
u
;

4791 
mp_wÜd
 
r
;

4794 
tm²
 = 
n
->
dp
;

4797 
tmpx
 = 
x
->
dp
 + 
ix
;

4800 
u
 = 0;

4803 
iy
 = 0; iy < 
n
->
u£d
; iy++) {

4805 
r
 = ((
mp_wÜd
)
mu
è* ((mp_wÜd)*
tm²
++) +

4806 ((
mp_wÜd
è
u
è+ ((mp_wÜdè* 
tmpx
);

4809 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

4812 *
tmpx
++ = (
mp_dig™
)(
r
 & ((
mp_wÜd
è
MP_MASK
));

4818 
u
) {

4819 *
tmpx
 +ğ
u
;

4820 
u
 = *
tmpx
 >> 
DIGIT_BIT
;

4821 *
tmpx
++ &ğ
MP_MASK
;

4834 
	`mp_şamp
(
x
);

4835 
	`mp_rshd
 (
x
, 
n
->
u£d
);

4838 ià(
	`mp_cmp_mag
 (
x
, 
n
è!ğ
MP_LT
) {

4839  
	`s_mp_sub
 (
x
, 
n
, x);

4842  
MP_OKAY
;

4843 
	}
}

4853 
	~<tomm©h.h
>

4854 #ifdeà
BN_MP_MONTGOMERY_SETUP_C


4872 
	$mp_mÚtgom”y_£tup
 (
mp_št
 * 
n
, 
mp_dig™
 * 
rho
)

4874 
mp_dig™
 
x
, 
b
;

4884 
b
 = 
n
->
dp
[0];

4886 ià((
b
 & 1) == 0) {

4887  
MP_VAL
;

4890 
x
 = (((
b
 + 2) & 4) << 1) + b;

4891 
x
 *ğ2 - 
b
 * x;

4892 #ià!
	`defšed
(
MP_8BIT
)

4893 
x
 *ğ2 - 
b
 * x;

4895 #ià
	`defšed
(
MP_64BIT
è|| !(defšed(
MP_8BIT
è|| defšed(
MP_16BIT
))

4896 
x
 *ğ2 - 
b
 * x;

4898 #ifdeà
MP_64BIT


4899 
x
 *ğ2 - 
b
 * x;

4903 *
rho
 = ()(((
mp_wÜd
)1 << ((mp_wÜdè
DIGIT_BIT
)è- 
x
è& 
MP_MASK
;

4905  
MP_OKAY
;

4906 
	}
}

4916 
	~<tomm©h.h
>

4917 #ifdeà
BN_MP_MUL_C


4934 
	$mp_mul
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

4936 
»s
, 
Ãg
;

4937 
Ãg
 = (
a
->
sign
 =ğ
b
->signè? 
MP_ZPOS
 : 
MP_NEG
;

4940 #ifdeà
BN_MP_TOOM_MUL_C


4941 ià(
	`MIN
 (
a
->
u£d
, 
b
->u£dè>ğ
TOOM_MUL_CUTOFF
) {

4942 
»s
 = 
	`mp_toom_mul
(
a
, 
b
, 
c
);

4945 #ifdeà
BN_MP_KARATSUBA_MUL_C


4947 ià(
	`MIN
 (
a
->
u£d
, 
b
->u£dè>ğ
KARATSUBA_MUL_CUTOFF
) {

4948 
»s
 = 
	`mp_k¬©suba_mul
 (
a
, 
b
, 
c
);

4958 
digs
 = 
a
->
u£d
 + 
b
->used + 1;

4960 #ifdeà
BN_FAST_S_MP_MUL_DIGS_C


4961 ià((
digs
 < 
MP_WARRAY
) &&

4962 
	`MIN
(
a
->
u£d
, 
b
->used) <=

4963 (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

4964 
»s
 = 
	`ç¡_s_mp_mul_digs
 (
a
, 
b
, 
c
, 
digs
);

4967 #ifdeà
BN_S_MP_MUL_DIGS_C


4968 
»s
 = 
	`s_mp_mul
 (
a
, 
b
, 
c
);

4970 
»s
 = 
MP_VAL
;

4974 
c
->
sign
 = (c->
u£d
 > 0è? 
Ãg
 : 
MP_ZPOS
;

4975  
»s
;

4976 
	}
}

4986 
	~<tomm©h.h
>

4987 #ifdeà
BN_MP_MUL_2_C


5004 
	$mp_mul_2
(
mp_št
 * 
a
, mp_šˆ* 
b
)

5006 
x
, 
»s
, 
Şdu£d
;

5009 ià(
b
->
®loc
 < 
a
->
u£d
 + 1) {

5010 ià((
»s
 = 
	`mp_grow
 (
b
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

5011  
»s
;

5015 
Şdu£d
 = 
b
->
u£d
;

5016 
b
->
u£d
 = 
a
->used;

5019 
mp_dig™
 
r
, 
¼
, *
tm·
, *
tmpb
;

5022 
tm·
 = 
a
->
dp
;

5025 
tmpb
 = 
b
->
dp
;

5028 
r
 = 0;

5029 
x
 = 0; x < 
a
->
u£d
; x++) {

5034 
¼
 = *
tm·
 >> ((
mp_dig™
)(
DIGIT_BIT
 - 1));

5037 *
tmpb
++ = ((*
tm·
++ << ((
mp_dig™
)1)è| 
r
è& 
MP_MASK
;

5042 
r
 = 
¼
;

5046 ià(
r
 != 0) {

5048 *
tmpb
 = 1;

5049 ++(
b
->
u£d
);

5055 
tmpb
 = 
b
->
dp
 + b->
u£d
;

5056 
x
 = 
b
->
u£d
; x < 
Şdu£d
; x++) {

5057 *
tmpb
++ = 0;

5060 
b
->
sign
 = 
a
->sign;

5061  
MP_OKAY
;

5062 
	}
}

5072 
	~<tomm©h.h
>

5073 #ifdeà
BN_MP_MUL_2D_C


5090 
	$mp_mul_2d
 (
mp_št
 * 
a
, 
b
, mp_šˆ* 
c
)

5092 
mp_dig™
 
d
;

5093 
»s
;

5096 ià(
a
 !ğ
c
) {

5097 ià((
»s
 = 
	`mp_cİy
 (
a
, 
c
)è!ğ
MP_OKAY
) {

5098  
»s
;

5102 ià(
c
->
®loc
 < ()(c->
u£d
 + 
b
/
DIGIT_BIT
 + 1)) {

5103 ià((
»s
 = 
	`mp_grow
 (
c
, c->
u£d
 + 
b
 / 
DIGIT_BIT
 + 1)è!ğ
MP_OKAY
) {

5104  
»s
;

5109 ià(
b
 >ğ()
DIGIT_BIT
) {

5110 ià((
»s
 = 
	`mp_lshd
 (
c
, 
b
 / 
DIGIT_BIT
)è!ğ
MP_OKAY
) {

5111  
»s
;

5116 
d
 = (
mp_dig™
è(
b
 % 
DIGIT_BIT
);

5117 ià(
d
 != 0) {

5118 
mp_dig™
 *
tmpc
, 
shiá
, 
mask
, 
r
, 
¼
;

5119 
x
;

5122 
mask
 = (((
mp_dig™
)1è<< 
d
) - 1;

5125 
shiá
 = 
DIGIT_BIT
 - 
d
;

5128 
tmpc
 = 
c
->
dp
;

5131 
r
 = 0;

5132 
x
 = 0; x < 
c
->
u£d
; x++) {

5134 
¼
 = (*
tmpc
 >> 
shiá
è& 
mask
;

5137 *
tmpc
 = ((*tmpø<< 
d
è| 
r
è& 
MP_MASK
;

5138 ++
tmpc
;

5141 
r
 = 
¼
;

5145 ià(
r
 != 0) {

5146 
c
->
dp
[(c->
u£d
)++] = 
r
;

5149 
	`mp_şamp
 (
c
);

5150  
MP_OKAY
;

5151 
	}
}

5161 
	~<tomm©h.h
>

5162 #ifdeà
BN_MP_MUL_D_C


5180 
	$mp_mul_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

5182 
mp_dig™
 
u
, *
tm·
, *
tmpc
;

5183 
mp_wÜd
 
r
;

5184 
ix
, 
»s
, 
Şdu£
;

5187 ià(
c
->
®loc
 < 
a
->
u£d
 + 1) {

5188 ià((
»s
 = 
	`mp_grow
 (
c
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

5189  
»s
;

5194 
Şdu£
 = 
c
->
u£d
;

5197 
c
->
sign
 = 
a
->sign;

5200 
tm·
 = 
a
->
dp
;

5203 
tmpc
 = 
c
->
dp
;

5206 
u
 = 0;

5209 
ix
 = 0; ix < 
a
->
u£d
; ix++) {

5211 
r
 = ((
mp_wÜd
è
u
è+ ((mp_wÜd)*
tm·
++è* ((mp_wÜd)
b
);

5214 *
tmpc
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

5217 
u
 = (
mp_dig™
è(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

5221 *
tmpc
++ = 
u
;

5222 ++
ix
;

5225 
ix
++ < 
Şdu£
) {

5226 *
tmpc
++ = 0;

5230 
c
->
u£d
 = 
a
->used + 1;

5231 
	`mp_şamp
(
c
);

5233  
MP_OKAY
;

5234 
	}
}

5244 
	~<tomm©h.h
>

5245 #ifdeà
BN_MP_MULMOD_C


5262 
	$mp_mulmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

5264 
»s
;

5265 
mp_št
 
t
;

5267 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

5268  
»s
;

5271 ià((
»s
 = 
	`mp_mul
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

5272 
	`mp_ş—r
 (&
t
);

5273  
»s
;

5275 
»s
 = 
	`mp_mod
 (&
t
, 
c
, 
d
);

5276 
	`mp_ş—r
 (&
t
);

5277  
»s
;

5278 
	}
}

5288 
	~<tomm©h.h
>

5289 #ifdeà
BN_MP_N_ROOT_C


5315 
	$mp_n_roÙ
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

5317 
mp_št
 
t1
, 
t2
, 
t3
;

5318 
»s
, 
Ãg
;

5321 ià((
b
 & 1è=ğ0 && 
a
->
sign
 =ğ
MP_NEG
) {

5322  
MP_VAL
;

5325 ià((
»s
 = 
	`mp_š™
 (&
t1
)è!ğ
MP_OKAY
) {

5326  
»s
;

5329 ià((
»s
 = 
	`mp_š™
 (&
t2
)è!ğ
MP_OKAY
) {

5330 
LBL_T1
;

5333 ià((
»s
 = 
	`mp_š™
 (&
t3
)è!ğ
MP_OKAY
) {

5334 
LBL_T2
;

5338 
Ãg
 = 
a
->
sign
;

5339 
a
->
sign
 = 
MP_ZPOS
;

5342 
	`mp_£t
 (&
t2
, 2);

5346 ià((
»s
 = 
	`mp_cİy
 (&
t2
, &
t1
)è!ğ
MP_OKAY
) {

5347 
LBL_T3
;

5353 ià((
»s
 = 
	`mp_ex±_d
 (&
t1
, 
b
 - 1, &
t3
)è!ğ
MP_OKAY
) {

5354 
LBL_T3
;

5359 ià((
»s
 = 
	`mp_mul
 (&
t3
, &
t1
, &
t2
)è!ğ
MP_OKAY
) {

5360 
LBL_T3
;

5364 ià((
»s
 = 
	`mp_sub
 (&
t2
, 
a
, &t2)è!ğ
MP_OKAY
) {

5365 
LBL_T3
;

5370 ià((
»s
 = 
	`mp_mul_d
 (&
t3
, 
b
, &t3)è!ğ
MP_OKAY
) {

5371 
LBL_T3
;

5375 ià((
»s
 = 
	`mp_div
 (&
t2
, &
t3
, &t3, 
NULL
)è!ğ
MP_OKAY
) {

5376 
LBL_T3
;

5379 ià((
»s
 = 
	`mp_sub
 (&
t1
, &
t3
, &
t2
)è!ğ
MP_OKAY
) {

5380 
LBL_T3
;

5382 } 
	`mp_cmp
 (&
t1
, &
t2
è!ğ
MP_EQ
);

5386 ià((
»s
 = 
	`mp_ex±_d
 (&
t1
, 
b
, &
t2
)è!ğ
MP_OKAY
) {

5387 
LBL_T3
;

5390 ià(
	`mp_cmp
 (&
t2
, 
a
è=ğ
MP_GT
) {

5391 ià((
»s
 = 
	`mp_sub_d
 (&
t1
, 1, &t1)è!ğ
MP_OKAY
) {

5392 
LBL_T3
;

5400 
a
->
sign
 = 
Ãg
;

5403 
	`mp_exch
 (&
t1
, 
c
);

5406 
c
->
sign
 = 
Ãg
;

5408 
»s
 = 
MP_OKAY
;

5410 
LBL_T3
:
	`mp_ş—r
 (&
t3
);

5411 
LBL_T2
:
	`mp_ş—r
 (&
t2
);

5412 
LBL_T1
:
	`mp_ş—r
 (&
t1
);

5413  
»s
;

5414 
	}
}

5424 
	~<tomm©h.h
>

5425 #ifdeà
BN_MP_NEG_C


5442 
	$mp_Ãg
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

5444 
»s
;

5445 ià(
a
 !ğ
b
) {

5446 ià((
»s
 = 
	`mp_cİy
 (
a
, 
b
)è!ğ
MP_OKAY
) {

5447  
»s
;

5451 ià(
	`mp_isz”o
(
b
è!ğ
MP_YES
) {

5452 
b
->
sign
 = (
a
->sigÀ=ğ
MP_ZPOS
è? 
MP_NEG
 : MP_ZPOS;

5454 
b
->
sign
 = 
MP_ZPOS
;

5457  
MP_OKAY
;

5458 
	}
}

5468 
	~<tomm©h.h
>

5469 #ifdeà
BN_MP_OR_C


5486 
	$mp_Ü
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

5488 
»s
, 
ix
, 
px
;

5489 
mp_št
 
t
, *
x
;

5491 ià(
a
->
u£d
 > 
b
->used) {

5492 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

5493  
»s
;

5495 
px
 = 
b
->
u£d
;

5496 
x
 = 
b
;

5498 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
b
)è!ğ
MP_OKAY
) {

5499  
»s
;

5501 
px
 = 
a
->
u£d
;

5502 
x
 = 
a
;

5505 
ix
 = 0; ix < 
px
; ix++) {

5506 
t
.
dp
[
ix
] |ğ
x
->dp[ix];

5508 
	`mp_şamp
 (&
t
);

5509 
	`mp_exch
 (
c
, &
t
);

5510 
	`mp_ş—r
 (&
t
);

5511  
MP_OKAY
;

5512 
	}
}

5522 
	~<tomm©h.h
>

5523 #ifdeà
BN_MP_PRIME_FERMAT_C


5547 
	$mp_´ime_ãrm©
 (
mp_št
 * 
a
, mp_šˆ* 
b
, *
»suÉ
)

5549 
mp_št
 
t
;

5550 
”r
;

5553 *
»suÉ
 = 
MP_NO
;

5556 ià(
	`mp_cmp_d
(
b
, 1è!ğ
MP_GT
) {

5557  
MP_VAL
;

5561 ià((
”r
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

5562  
”r
;

5566 ià((
”r
 = 
	`mp_ex±mod
 (
b
, 
a
,‡, &
t
)è!ğ
MP_OKAY
) {

5567 
LBL_T
;

5571 ià(
	`mp_cmp
 (&
t
, 
b
è=ğ
MP_EQ
) {

5572 *
»suÉ
 = 
MP_YES
;

5575 
”r
 = 
MP_OKAY
;

5576 
LBL_T
:
	`mp_ş—r
 (&
t
);

5577  
”r
;

5578 
	}
}

5588 
	~<tomm©h.h
>

5589 #ifdeà
BN_MP_PRIME_IS_DIVISIBLE_C


5610 
	$mp_´ime_is_divisibË
 (
mp_št
 * 
a
, *
»suÉ
)

5612 
”r
, 
ix
;

5613 
mp_dig™
 
»s
;

5616 *
»suÉ
 = 
MP_NO
;

5618 
ix
 = 0; ix < 
PRIME_SIZE
; ix++) {

5620 ià((
”r
 = 
	`mp_mod_d
 (
a
, 
Ém_´ime_b
[
ix
], &
»s
)è!ğ
MP_OKAY
) {

5621  
”r
;

5625 ià(
»s
 == 0) {

5626 *
»suÉ
 = 
MP_YES
;

5627  
MP_OKAY
;

5631  
MP_OKAY
;

5632 
	}
}

5642 
	~<tomm©h.h
>

5643 #ifdeà
BN_MP_PRIME_IS_PRIME_C


5666 
	$mp_´ime_is_´ime
 (
mp_št
 * 
a
, 
t
, *
»suÉ
)

5668 
mp_št
 
b
;

5669 
ix
, 
”r
, 
»s
;

5672 *
»suÉ
 = 
MP_NO
;

5675 ià(
t
 <ğ0 || > 
PRIME_SIZE
) {

5676  
MP_VAL
;

5680 
ix
 = 0; ix < 
PRIME_SIZE
; ix++) {

5681 ià(
	`mp_cmp_d
(
a
, 
Ém_´ime_b
[
ix
]è=ğ
MP_EQ
) {

5682 *
»suÉ
 = 1;

5683  
MP_OKAY
;

5688 ià((
”r
 = 
	`mp_´ime_is_divisibË
 (
a
, &
»s
)è!ğ
MP_OKAY
) {

5689  
”r
;

5693 ià(
»s
 =ğ
MP_YES
) {

5694  
MP_OKAY
;

5698 ià((
”r
 = 
	`mp_š™
 (&
b
)è!ğ
MP_OKAY
) {

5699  
”r
;

5702 
ix
 = 0; ix < 
t
; ix++) {

5704 
	`mp_£t
 (&
b
, 
Ém_´ime_b
[
ix
]);

5706 ià((
”r
 = 
	`mp_´ime_mËr_¿bš
 (
a
, &
b
, &
»s
)è!ğ
MP_OKAY
) {

5707 
LBL_B
;

5710 ià(
»s
 =ğ
MP_NO
) {

5711 
LBL_B
;

5716 *
»suÉ
 = 
MP_YES
;

5717 
LBL_B
:
	`mp_ş—r
 (&
b
);

5718  
”r
;

5719 
	}
}

5729 
	~<tomm©h.h
>

5730 #ifdeà
BN_MP_PRIME_MILLER_RABIN_C


5753 
	$mp_´ime_mËr_¿bš
 (
mp_št
 * 
a
, mp_šˆ* 
b
, *
»suÉ
)

5755 
mp_št
 
n1
, 
y
, 
r
;

5756 
s
, 
j
, 
”r
;

5759 *
»suÉ
 = 
MP_NO
;

5762 ià(
	`mp_cmp_d
(
b
, 1è!ğ
MP_GT
) {

5763  
MP_VAL
;

5767 ià((
”r
 = 
	`mp_š™_cİy
 (&
n1
, 
a
)è!ğ
MP_OKAY
) {

5768  
”r
;

5770 ià((
”r
 = 
	`mp_sub_d
 (&
n1
, 1, &n1)è!ğ
MP_OKAY
) {

5771 
LBL_N1
;

5775 ià((
”r
 = 
	`mp_š™_cİy
 (&
r
, &
n1
)è!ğ
MP_OKAY
) {

5776 
LBL_N1
;

5782 
s
 = 
	`mp_út_lsb
(&
r
);

5785 ià((
”r
 = 
	`mp_div_2d
 (&
r
, 
s
, &r, 
NULL
)è!ğ
MP_OKAY
) {

5786 
LBL_R
;

5790 ià((
”r
 = 
	`mp_š™
 (&
y
)è!ğ
MP_OKAY
) {

5791 
LBL_R
;

5793 ià((
”r
 = 
	`mp_ex±mod
 (
b
, &
r
, 
a
, &
y
)è!ğ
MP_OKAY
) {

5794 
LBL_Y
;

5798 ià(
	`mp_cmp_d
 (&
y
, 1è!ğ
MP_EQ
 && 
	`mp_cmp
 (&y, &
n1
) != MP_EQ) {

5799 
j
 = 1;

5801 (
j
 <ğ(
s
 - 1)è&& 
	`mp_cmp
 (&
y
, &
n1
è!ğ
MP_EQ
) {

5802 ià((
”r
 = 
	`mp_sqrmod
 (&
y
, 
a
, &y)è!ğ
MP_OKAY
) {

5803 
LBL_Y
;

5807 ià(
	`mp_cmp_d
 (&
y
, 1è=ğ
MP_EQ
) {

5808 
LBL_Y
;

5811 ++
j
;

5815 ià(
	`mp_cmp
 (&
y
, &
n1
è!ğ
MP_EQ
) {

5816 
LBL_Y
;

5821 *
»suÉ
 = 
MP_YES
;

5822 
LBL_Y
:
	`mp_ş—r
 (&
y
);

5823 
LBL_R
:
	`mp_ş—r
 (&
r
);

5824 
LBL_N1
:
	`mp_ş—r
 (&
n1
);

5825  
”r
;

5826 
	}
}

5836 
	~<tomm©h.h
>

5837 #ifdeà
BN_MP_PRIME_NEXT_PRIME_C


5858 
	$mp_´ime_Ãxt_´ime
(
mp_št
 *
a
, 
t
, 
bbs_¡yË
)

5860 
”r
, 
»s
, 
x
, 
y
;

5861 
mp_dig™
 
»s_b
[
PRIME_SIZE
], 
¡•
, 
k¡•
;

5862 
mp_št
 
b
;

5865 ià(
t
 <ğ0 || > 
PRIME_SIZE
) {

5866  
MP_VAL
;

5870 
a
->
sign
 = 
MP_ZPOS
;

5873 ià(
	`mp_cmp_d
(
a
, 
Ém_´ime_b
[
PRIME_SIZE
-1]è=ğ
MP_LT
) {

5875 
x
 = 
PRIME_SIZE
 - 2; x >= 0; x--) {

5876 ià(
	`mp_cmp_d
(
a
, 
Ém_´ime_b
[
x
]è!ğ
MP_LT
) {

5877 ià(
bbs_¡yË
 == 1) {

5884 ià((
Ém_´ime_b
[
x
 + 1] & 3) != 3) {

5886 
y
 = 
x
 + 1; y < 
PRIME_SIZE
; y++) {

5887 ià((
Ém_´ime_b
[
y
] & 3) == 3) {

5888 
	`mp_£t
(
a
, 
Ém_´ime_b
[
y
]);

5889  
MP_OKAY
;

5894 
	`mp_£t
(
a
, 
Ém_´ime_b
[
x
 + 1]);

5895  
MP_OKAY
;

5900 ià(
	`mp_cmp_d
(
a
, 1è=ğ
MP_EQ
) {

5901 
	`mp_£t
(
a
, 2);

5902  
MP_OKAY
;

5908 ià(
bbs_¡yË
 == 1) {

5909 
k¡•
 = 4;

5911 
k¡•
 = 2;

5916 ià(
bbs_¡yË
 == 1) {

5918 ià((
a
->
dp
[0] & 3) != 3) {

5919 ià((
”r
 = 
	`mp_sub_d
(
a
, (a->
dp
[0] & 3è+ 1,‡)è!ğ
MP_OKAY
) { ƒrr; };

5922 ià(
	`mp_i£v’
(
a
) == 1) {

5924 ià((
”r
 = 
	`mp_sub_d
(
a
, 1,‡)è!ğ
MP_OKAY
) {

5925  
”r
;

5931 
x
 = 1; x < 
PRIME_SIZE
; x++) {

5932 ià((
”r
 = 
	`mp_mod_d
(
a
, 
Ém_´ime_b
[
x
], 
»s_b
 + x)è!ğ
MP_OKAY
) {

5933  
”r
;

5938 ià((
”r
 = 
	`mp_š™
(&
b
)è!ğ
MP_OKAY
) {

5939  
”r
;

5944 
¡•
 = 0;

5947 
y
 = 0;

5950 
¡•
 +ğ
k¡•
;

5953 
x
 = 1; x < 
PRIME_SIZE
; x++) {

5955 
»s_b
[
x
] +ğ
k¡•
;

5958 ià(
»s_b
[
x
] >ğ
Ém_´ime_b
[x]) {

5959 
»s_b
[
x
] -ğ
Ém_´ime_b
[x];

5963 ià(
»s_b
[
x
] == 0) {

5964 
y
 = 1;

5967 } 
y
 =ğ1 && 
¡•
 < ((((
mp_dig™
)1)<<
DIGIT_BIT
è- 
k¡•
));

5970 ià((
”r
 = 
	`mp_add_d
(
a
, 
¡•
,‡)è!ğ
MP_OKAY
) {

5971 
LBL_ERR
;

5975 ià(
y
 =ğ1 && 
¡•
 >ğ((((
mp_dig™
)1)<<
DIGIT_BIT
è- 
k¡•
)) {

5980 
x
 = 0; x < 
t
; x++) {

5981 
	`mp_£t
(&
b
, 
Ém_´ime_b
[
t
]);

5982 ià((
”r
 = 
	`mp_´ime_mËr_¿bš
(
a
, &
b
, &
»s
)è!ğ
MP_OKAY
) {

5983 
LBL_ERR
;

5985 ià(
»s
 =ğ
MP_NO
) {

5990 ià(
»s
 =ğ
MP_YES
) {

5995 
”r
 = 
MP_OKAY
;

5996 
LBL_ERR
:

5997 
	`mp_ş—r
(&
b
);

5998  
”r
;

5999 
	}
}

6010 
	~<tomm©h.h
>

6011 #ifdeà
BN_MP_PRIME_RABIN_MILLER_TRIALS_C


6029 
	mk
, 
	mt
;

6030 } 
	gsizes
[] = {

6042 
	$mp_´ime_¿bš_mËr_ŒŸls
(
size
)

6044 
x
;

6046 
x
 = 0; x < ()((
sizes
)/((sizes[0]))); x++) {

6047 ià(
sizes
[
x
].
k
 =ğ
size
) {

6048  
sizes
[
x
].
t
;

6049 } ià(
sizes
[
x
].
k
 > 
size
) {

6050  (
x
 =ğ0è? 
sizes
[0].
t
 : sizes[x - 1].t;

6053  
sizes
[
x
-1].
t
 + 1;

6054 
	}
}

6066 
	~<tomm©h.h
>

6067 #ifdeà
BN_MP_PRIME_RANDOM_EX_C


6099 
	$mp_´ime_¿ndom_ex
(
mp_št
 *
a
, 
t
, 
size
, 
æags
, 
Ém_´ime_ÿÎback
 
cb
, *
d©
)

6101 *
tmp
, 
maskAND
, 
maskOR_msb
, 
maskOR_lsb
;

6102 
»s
, 
”r
, 
bsize
, 
maskOR_msb_off£t
;

6105 ià(
size
 <ğ1 || 
t
 <= 0) {

6106  
MP_VAL
;

6110 ià(
æags
 & 
LTM_PRIME_SAFE
) {

6111 
æags
 |ğ
LTM_PRIME_BBS
;

6115 
bsize
 = (
size
>>3) + ((size&7)?1:0);

6118 
tmp
 = 
	`OPT_CAST
(è
	`XMALLOC
(
bsize
);

6119 ià(
tmp
 =ğ
NULL
) {

6120  
MP_MEM
;

6124 
maskAND
 = ((
size
&7) == 0) ? 0xFF : (0xFF >> (8 - (size & 7)));

6127 
maskOR_msb
 = 0;

6128 
maskOR_msb_off£t
 = ((
size
 & 7) == 1) ? 1 : 0;

6129 ià(
æags
 & 
LTM_PRIME_2MSB_ON
) {

6130 
maskOR_msb
 |ğ0x80 >> ((9 - 
size
) & 7);

6134 
maskOR_lsb
 = 1;

6135 ià(
æags
 & 
LTM_PRIME_BBS
) {

6136 
maskOR_lsb
 |= 3;

6141 ià(
	`cb
(
tmp
, 
bsize
, 
d©
) != bsize) {

6142 
”r
 = 
MP_VAL
;

6143 
”rÜ
;

6147 
tmp
[0] &ğ
maskAND
;

6148 
tmp
[0] |ğ1 << ((
size
 - 1) & 7);

6151 
tmp
[
maskOR_msb_off£t
] |ğ
maskOR_msb
;

6152 
tmp
[
bsize
-1] |ğ
maskOR_lsb
;

6155 ià((
”r
 = 
	`mp_»ad_unsigÃd_bš
(
a
, 
tmp
, 
bsize
)è!ğ
MP_OKAY
è{ 
”rÜ
; }

6158 ià((
”r
 = 
	`mp_´ime_is_´ime
(
a
, 
t
, &
»s
)è!ğ
MP_OKAY
è{ 
”rÜ
; }

6159 ià(
»s
 =ğ
MP_NO
) {

6163 ià(
æags
 & 
LTM_PRIME_SAFE
) {

6165 ià((
”r
 = 
	`mp_sub_d
(
a
, 1,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

6166 ià((
”r
 = 
	`mp_div_2
(
a
,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

6169 ià((
”r
 = 
	`mp_´ime_is_´ime
(
a
, 
t
, &
»s
)è!ğ
MP_OKAY
è{ 
”rÜ
; }

6171 } 
»s
 =ğ
MP_NO
);

6173 ià(
æags
 & 
LTM_PRIME_SAFE
) {

6175 ià((
”r
 = 
	`mp_mul_2
(
a
,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

6176 ià((
”r
 = 
	`mp_add_d
(
a
, 1,‡)è!ğ
MP_OKAY
è{ 
”rÜ
; }

6179 
”r
 = 
MP_OKAY
;

6180 
”rÜ
:

6181 
	`XFREE
(
tmp
);

6182  
”r
;

6183 
	}
}

6195 
	~<tomm©h.h
>

6196 #ifdeà
BN_MP_RADIX_SIZE_C


6213 
	$mp_¿dix_size
 (
mp_št
 * 
a
, 
¿dix
, *
size
)

6215 
»s
, 
digs
;

6216 
mp_št
 
t
;

6217 
mp_dig™
 
d
;

6219 *
size
 = 0;

6222 ià(
¿dix
 == 2) {

6223 *
size
 = 
	`mp_couÁ_b™s
 (
a
è+ (a->
sign
 =ğ
MP_NEG
 ? 1 : 0) + 1;

6224  
MP_OKAY
;

6228 ià(
¿dix
 < 2 ||„adix > 64) {

6229  
MP_VAL
;

6232 ià(
	`mp_isz”o
(
a
è=ğ
MP_YES
) {

6233 *
size
 = 2;

6234  
MP_OKAY
;

6238 
digs
 = 0;

6241 ià(
a
->
sign
 =ğ
MP_NEG
) {

6242 ++
digs
;

6246 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

6247  
»s
;

6251 
t
.
sign
 = 
MP_ZPOS
;

6254 
	`mp_isz”o
 (&
t
è=ğ
MP_NO
) {

6255 ià((
»s
 = 
	`mp_div_d
 (&
t
, (
mp_dig™
è
¿dix
, &t, &
d
)è!ğ
MP_OKAY
) {

6256 
	`mp_ş—r
 (&
t
);

6257  
»s
;

6259 ++
digs
;

6261 
	`mp_ş—r
 (&
t
);

6264 *
size
 = 
digs
 + 1;

6265  
MP_OKAY
;

6266 
	}
}

6277 
	~<tomm©h.h
>

6278 #ifdeà
BN_MP_RADIX_SMAP_C


6295 cÚ¡ *
	gmp_s_rm­
 = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/";

6305 
	~<tomm©h.h
>

6306 #ifdeà
BN_MP_RAND_C


6324 
	$mp_¿nd
 (
mp_št
 * 
a
, 
dig™s
)

6326 
»s
;

6327 
mp_dig™
 
d
;

6329 
	`mp_z”o
 (
a
);

6330 ià(
dig™s
 <= 0) {

6331  
MP_OKAY
;

6336 
d
 = ((
mp_dig™
è
	`abs
 (
	`¿nd
 ())è& 
MP_MASK
;

6337 } 
d
 == 0);

6339 ià((
»s
 = 
	`mp_add_d
 (
a
, 
d
,‡)è!ğ
MP_OKAY
) {

6340  
»s
;

6343 --
dig™s
 > 0) {

6344 ià((
»s
 = 
	`mp_lshd
 (
a
, 1)è!ğ
MP_OKAY
) {

6345  
»s
;

6348 ià((
»s
 = 
	`mp_add_d
 (
a
, ((
mp_dig™
è
	`abs
 (
	`¿nd
 ())),‡)è!ğ
MP_OKAY
) {

6349  
»s
;

6353  
MP_OKAY
;

6354 
	}
}

6364 
	~<tomm©h.h
>

6365 #ifdeà
BN_MP_READ_RADIX_C


6382 
	$mp_»ad_¿dix
 (
mp_št
 * 
a
, cÚ¡ *
¡r
, 
¿dix
)

6384 
y
, 
»s
, 
Ãg
;

6385 
ch
;

6388 
	`mp_z”o
(
a
);

6391 ià(
¿dix
 < 2 ||„adix > 64) {

6392  
MP_VAL
;

6398 ià(*
¡r
 == '-') {

6399 ++
¡r
;

6400 
Ãg
 = 
MP_NEG
;

6402 
Ãg
 = 
MP_ZPOS
;

6406 
	`mp_z”o
 (
a
);

6409 *
¡r
) {

6414 
ch
 = (è((
¿dix
 < 36è? 
	`touµ”
 (*
¡r
) : *str);

6415 
y
 = 0; y < 64; y++) {

6416 ià(
ch
 =ğ
mp_s_rm­
[
y
]) {

6425 ià(
y
 < 
¿dix
) {

6426 ià((
»s
 = 
	`mp_mul_d
 (
a
, (
mp_dig™
è
¿dix
,‡)è!ğ
MP_OKAY
) {

6427  
»s
;

6429 ià((
»s
 = 
	`mp_add_d
 (
a
, (
mp_dig™
è
y
,‡)è!ğ
MP_OKAY
) {

6430  
»s
;

6435 ++
¡r
;

6439 ià(
	`mp_isz”o
(
a
) != 1) {

6440 
a
->
sign
 = 
Ãg
;

6442  
MP_OKAY
;

6443 
	}
}

6453 
	~<tomm©h.h
>

6454 #ifdeà
BN_MP_READ_SIGNED_BIN_C


6471 
	$mp_»ad_sigÃd_bš
 (
mp_št
 * 
a
, cÚ¡ *
b
, 
c
)

6473 
»s
;

6476 ià((
»s
 = 
	`mp_»ad_unsigÃd_bš
 (
a
, 
b
 + 1, 
c
 - 1)è!ğ
MP_OKAY
) {

6477  
»s
;

6481 ià(
b
[0] == 0) {

6482 
a
->
sign
 = 
MP_ZPOS
;

6484 
a
->
sign
 = 
MP_NEG
;

6487  
MP_OKAY
;

6488 
	}
}

6498 
	~<tomm©h.h
>

6499 #ifdeà
BN_MP_READ_UNSIGNED_BIN_C


6516 
	$mp_»ad_unsigÃd_bš
 (
mp_št
 * 
a
, cÚ¡ *
b
, 
c
)

6518 
»s
;

6521 ià(
a
->
®loc
 < 2) {

6522 ià((
»s
 = 
	`mp_grow
(
a
, 2)è!ğ
MP_OKAY
) {

6523  
»s
;

6528 
	`mp_z”o
 (
a
);

6531 
c
-- > 0) {

6532 ià((
»s
 = 
	`mp_mul_2d
 (
a
, 8,‡)è!ğ
MP_OKAY
) {

6533  
»s
;

6536 #iâdeà
MP_8BIT


6537 
a
->
dp
[0] |ğ*
b
++;

6538 
a
->
u£d
 += 1;

6540 
a
->
dp
[0] = (*
b
 & 
MP_MASK
);

6541 
a
->
dp
[1] |ğ((*
b
++ >> 7U) & 1);

6542 
a
->
u£d
 += 2;

6545 
	`mp_şamp
 (
a
);

6546  
MP_OKAY
;

6547 
	}
}

6557 
	~<tomm©h.h
>

6558 #ifdeà
BN_MP_REDUCE_C


6578 
	$mp_»duû
 (
mp_št
 * 
x
, mp_šˆ* 
m
, mp_šˆ* 
mu
)

6580 
mp_št
 
q
;

6581 
»s
, 
um
 = 
m
->
u£d
;

6584 ià((
»s
 = 
	`mp_š™_cİy
 (&
q
, 
x
)è!ğ
MP_OKAY
) {

6585  
»s
;

6589 
	`mp_rshd
 (&
q
, 
um
 - 1);

6592 ià(((è
um
è> (((
mp_dig™
)1è<< (
DIGIT_BIT
 - 1))) {

6593 ià((
»s
 = 
	`mp_mul
 (&
q
, 
mu
, &q)è!ğ
MP_OKAY
) {

6594 
CLEANUP
;

6597 #ifdeà
BN_S_MP_MUL_HIGH_DIGS_C


6598 ià((
»s
 = 
	`s_mp_mul_high_digs
 (&
q
, 
mu
, &q, 
um
)è!ğ
MP_OKAY
) {

6599 
CLEANUP
;

6601 #–ià
	`defšed
(
BN_FAST_S_MP_MUL_HIGH_DIGS_C
)

6602 ià((
»s
 = 
	`ç¡_s_mp_mul_high_digs
 (&
q
, 
mu
, &q, 
um
)è!ğ
MP_OKAY
) {

6603 
CLEANUP
;

6607 
»s
 = 
MP_VAL
;

6608 
CLEANUP
;

6614 
	`mp_rshd
 (&
q
, 
um
 + 1);

6617 ià((
»s
 = 
	`mp_mod_2d
 (
x
, 
DIGIT_BIT
 * (
um
 + 1), x)è!ğ
MP_OKAY
) {

6618 
CLEANUP
;

6622 ià((
»s
 = 
	`s_mp_mul_digs
 (&
q
, 
m
, &q, 
um
 + 1)è!ğ
MP_OKAY
) {

6623 
CLEANUP
;

6627 ià((
»s
 = 
	`mp_sub
 (
x
, &
q
, x)è!ğ
MP_OKAY
) {

6628 
CLEANUP
;

6632 ià(
	`mp_cmp_d
 (
x
, 0è=ğ
MP_LT
) {

6633 
	`mp_£t
 (&
q
, 1);

6634 ià((
»s
 = 
	`mp_lshd
 (&
q
, 
um
 + 1)è!ğ
MP_OKAY
)

6635 
CLEANUP
;

6636 ià((
»s
 = 
	`mp_add
 (
x
, &
q
, x)è!ğ
MP_OKAY
)

6637 
CLEANUP
;

6641 
	`mp_cmp
 (
x
, 
m
è!ğ
MP_LT
) {

6642 ià((
»s
 = 
	`s_mp_sub
 (
x
, 
m
, x)è!ğ
MP_OKAY
) {

6643 
CLEANUP
;

6647 
CLEANUP
:

6648 
	`mp_ş—r
 (&
q
);

6650  
»s
;

6651 
	}
}

6661 
	~<tomm©h.h
>

6662 #ifdeà
BN_MP_REDUCE_2K_C


6679 
	$mp_»duû_2k
(
mp_št
 *
a
, mp_šˆ*
n
, 
mp_dig™
 
d
)

6681 
mp_št
 
q
;

6682 
p
, 
»s
;

6684 ià((
»s
 = 
	`mp_š™
(&
q
)è!ğ
MP_OKAY
) {

6685  
»s
;

6688 
p
 = 
	`mp_couÁ_b™s
(
n
);

6689 
tİ
:

6691 ià((
»s
 = 
	`mp_div_2d
(
a
, 
p
, &
q
,‡)è!ğ
MP_OKAY
) {

6692 
ERR
;

6695 ià(
d
 != 1) {

6697 ià((
»s
 = 
	`mp_mul_d
(&
q
, 
d
, &q)è!ğ
MP_OKAY
) {

6698 
ERR
;

6703 ià((
»s
 = 
	`s_mp_add
(
a
, &
q
,‡)è!ğ
MP_OKAY
) {

6704 
ERR
;

6707 ià(
	`mp_cmp_mag
(
a
, 
n
è!ğ
MP_LT
) {

6708 
	`s_mp_sub
(
a
, 
n
,‡);

6709 
tİ
;

6712 
ERR
:

6713 
	`mp_ş—r
(&
q
);

6714  
»s
;

6715 
	}
}

6726 
	~<tomm©h.h
>

6727 #ifdeà
BN_MP_REDUCE_2K_L_C


6747 
	$mp_»duû_2k_l
(
mp_št
 *
a
, mp_šˆ*
n
, mp_šˆ*
d
)

6749 
mp_št
 
q
;

6750 
p
, 
»s
;

6752 ià((
»s
 = 
	`mp_š™
(&
q
)è!ğ
MP_OKAY
) {

6753  
»s
;

6756 
p
 = 
	`mp_couÁ_b™s
(
n
);

6757 
tİ
:

6759 ià((
»s
 = 
	`mp_div_2d
(
a
, 
p
, &
q
,‡)è!ğ
MP_OKAY
) {

6760 
ERR
;

6764 ià((
»s
 = 
	`mp_mul
(&
q
, 
d
, &q)è!ğ
MP_OKAY
) {

6765 
ERR
;

6769 ià((
»s
 = 
	`s_mp_add
(
a
, &
q
,‡)è!ğ
MP_OKAY
) {

6770 
ERR
;

6773 ià(
	`mp_cmp_mag
(
a
, 
n
è!ğ
MP_LT
) {

6774 
	`s_mp_sub
(
a
, 
n
,‡);

6775 
tİ
;

6778 
ERR
:

6779 
	`mp_ş—r
(&
q
);

6780  
»s
;

6781 
	}
}

6792 
	~<tomm©h.h
>

6793 #ifdeà
BN_MP_REDUCE_2K_SETUP_C


6810 
	$mp_»duû_2k_£tup
(
mp_št
 *
a
, 
mp_dig™
 *
d
)

6812 
»s
, 
p
;

6813 
mp_št
 
tmp
;

6815 ià((
»s
 = 
	`mp_š™
(&
tmp
)è!ğ
MP_OKAY
) {

6816  
»s
;

6819 
p
 = 
	`mp_couÁ_b™s
(
a
);

6820 ià((
»s
 = 
	`mp_2ex±
(&
tmp
, 
p
)è!ğ
MP_OKAY
) {

6821 
	`mp_ş—r
(&
tmp
);

6822  
»s
;

6825 ià((
»s
 = 
	`s_mp_sub
(&
tmp
, 
a
, &tmp)è!ğ
MP_OKAY
) {

6826 
	`mp_ş—r
(&
tmp
);

6827  
»s
;

6830 *
d
 = 
tmp
.
dp
[0];

6831 
	`mp_ş—r
(&
tmp
);

6832  
MP_OKAY
;

6833 
	}
}

6843 
	~<tomm©h.h
>

6844 #ifdeà
BN_MP_REDUCE_2K_SETUP_L_C


6861 
	$mp_»duû_2k_£tup_l
(
mp_št
 *
a
, mp_šˆ*
d
)

6863 
»s
;

6864 
mp_št
 
tmp
;

6866 ià((
»s
 = 
	`mp_š™
(&
tmp
)è!ğ
MP_OKAY
) {

6867  
»s
;

6870 ià((
»s
 = 
	`mp_2ex±
(&
tmp
, 
	`mp_couÁ_b™s
(
a
))è!ğ
MP_OKAY
) {

6871 
ERR
;

6874 ià((
»s
 = 
	`s_mp_sub
(&
tmp
, 
a
, 
d
)è!ğ
MP_OKAY
) {

6875 
ERR
;

6878 
ERR
:

6879 
	`mp_ş—r
(&
tmp
);

6880  
»s
;

6881 
	}
}

6891 
	~<tomm©h.h
>

6892 #ifdeà
BN_MP_REDUCE_IS_2K_C


6909 
	$mp_»duû_is_2k
(
mp_št
 *
a
)

6911 
ix
, 
iy
, 
iw
;

6912 
mp_dig™
 
iz
;

6914 ià(
a
->
u£d
 == 0) {

6915  
MP_NO
;

6916 } ià(
a
->
u£d
 == 1) {

6917  
MP_YES
;

6918 } ià(
a
->
u£d
 > 1) {

6919 
iy
 = 
	`mp_couÁ_b™s
(
a
);

6920 
iz
 = 1;

6921 
iw
 = 1;

6924 
ix
 = 
DIGIT_BIT
; ix < 
iy
; ix++) {

6925 ià((
a
->
dp
[
iw
] & 
iz
) == 0) {

6926  
MP_NO
;

6928 
iz
 <<= 1;

6929 ià(
iz
 > (
mp_dig™
)
MP_MASK
) {

6930 ++
iw
;

6931 
iz
 = 1;

6935  
MP_YES
;

6936 
	}
}

6947 
	~<tomm©h.h
>

6948 #ifdeà
BN_MP_REDUCE_IS_2K_L_C


6965 
	$mp_»duû_is_2k_l
(
mp_št
 *
a
)

6967 
ix
, 
iy
;

6969 ià(
a
->
u£d
 == 0) {

6970  
MP_NO
;

6971 } ià(
a
->
u£d
 == 1) {

6972  
MP_YES
;

6973 } ià(
a
->
u£d
 > 1) {

6975 
iy
 = 
ix
 = 0; ix < 
a
->
u£d
; ix++) {

6976 ià(
a
->
dp
[
ix
] =ğ
MP_MASK
) {

6977 ++
iy
;

6980  (
iy
 >ğ(
a
->
u£d
/2)è? 
MP_YES
 : 
MP_NO
;

6983  
MP_NO
;

6984 
	}
}

6995 
	~<tomm©h.h
>

6996 #ifdeà
BN_MP_REDUCE_SETUP_C


7015 
	$mp_»duû_£tup
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

7017 
»s
;

7019 ià((
»s
 = 
	`mp_2ex±
 (
a
, 
b
->
u£d
 * 2 * 
DIGIT_BIT
)è!ğ
MP_OKAY
) {

7020  
»s
;

7022  
	`mp_div
 (
a
, 
b
,‡, 
NULL
);

7023 
	}
}

7033 
	~<tomm©h.h
>

7034 #ifdeà
BN_MP_RSHD_C


7051 
	$mp_rshd
 (
mp_št
 * 
a
, 
b
)

7053 
x
;

7056 ià(
b
 <= 0) {

7061 ià(
a
->
u£d
 <ğ
b
) {

7062 
	`mp_z”o
 (
a
);

7067 
mp_dig™
 *
bÙtom
, *
tİ
;

7072 
bÙtom
 = 
a
->
dp
;

7075 
tİ
 = 
a
->
dp
 + 
b
;

7087 
x
 = 0; x < (
a
->
u£d
 - 
b
); x++) {

7088 *
bÙtom
++ = *
tİ
++;

7092 ; 
x
 < 
a
->
u£d
; x++) {

7093 *
bÙtom
++ = 0;

7098 
a
->
u£d
 -ğ
b
;

7099 
	}
}

7109 
	~<tomm©h.h
>

7110 #ifdeà
BN_MP_SET_C


7127 
	$mp_£t
 (
mp_št
 * 
a
, 
mp_dig™
 
b
)

7129 
	`mp_z”o
 (
a
);

7130 
a
->
dp
[0] = 
b
 & 
MP_MASK
;

7131 
a
->
u£d
 = (a->
dp
[0] != 0) ? 1 : 0;

7132 
	}
}

7142 
	~<tomm©h.h
>

7143 #ifdeà
BN_MP_SET_INT_C


7160 
	$mp_£t_št
 (
mp_št
 * 
a
, 
b
)

7162 
x
, 
»s
;

7164 
	`mp_z”o
 (
a
);

7167 
x
 = 0; x < 8; x++) {

7169 ià((
»s
 = 
	`mp_mul_2d
 (
a
, 4,‡)è!ğ
MP_OKAY
) {

7170  
»s
;

7174 
a
->
dp
[0] |ğ(
b
 >> 28) & 15;

7177 
b
 <<= 4;

7180 
a
->
u£d
 += 1;

7182 
	`mp_şamp
 (
a
);

7183  
MP_OKAY
;

7184 
	}
}

7194 
	~<tomm©h.h
>

7195 #ifdeà
BN_MP_SHRINK_C


7212 
	$mp_shršk
 (
mp_št
 * 
a
)

7214 
mp_dig™
 *
tmp
;

7215 ià(
a
->
®loc
 !ğa->
u£d
 &&‡->used > 0) {

7216 ià((
tmp
 = 
	`OPT_CAST
(
mp_dig™
è
	`XREALLOC
 (
a
->
dp
,  (mp_dig™è*‡->
u£d
)è=ğ
NULL
) {

7217  
MP_MEM
;

7219 
a
->
dp
 = 
tmp
;

7220 
a
->
®loc
 =‡->
u£d
;

7222  
MP_OKAY
;

7223 
	}
}

7233 
	~<tomm©h.h
>

7234 #ifdeà
BN_MP_SIGNED_BIN_SIZE_C


7251 
	$mp_sigÃd_bš_size
 (
mp_št
 * 
a
)

7253  1 + 
	`mp_unsigÃd_bš_size
 (
a
);

7254 
	}
}

7264 
	~<tomm©h.h
>

7265 #ifdeà
BN_MP_SQR_C


7283 
	$mp_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

7285 
»s
;

7287 #ifdeà
BN_MP_TOOM_SQR_C


7289 ià(
a
->
u£d
 >ğ
TOOM_SQR_CUTOFF
) {

7290 
»s
 = 
	`mp_toom_sqr
(
a
, 
b
);

7294 #ifdeà
BN_MP_KARATSUBA_SQR_C


7295 ià(
a
->
u£d
 >ğ
KARATSUBA_SQR_CUTOFF
) {

7296 
»s
 = 
	`mp_k¬©suba_sqr
 (
a
, 
b
);

7300 #ifdeà
BN_FAST_S_MP_SQR_C


7302 ià((
a
->
u£d
 * 2 + 1è< 
MP_WARRAY
 &&

7303 
a
->
u£d
 <

7304 (1 << ((
mp_wÜd
è* 
CHAR_BIT
 - 2*
DIGIT_BIT
 - 1))) {

7305 
»s
 = 
	`ç¡_s_mp_sqr
 (
a
, 
b
);

7308 #ifdeà
BN_S_MP_SQR_C


7309 
»s
 = 
	`s_mp_sqr
 (
a
, 
b
);

7311 
»s
 = 
MP_VAL
;

7314 
b
->
sign
 = 
MP_ZPOS
;

7315  
»s
;

7316 
	}
}

7326 
	~<tomm©h.h
>

7327 #ifdeà
BN_MP_SQRMOD_C


7345 
	$mp_sqrmod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

7347 
»s
;

7348 
mp_št
 
t
;

7350 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

7351  
»s
;

7354 ià((
»s
 = 
	`mp_sqr
 (
a
, &
t
)è!ğ
MP_OKAY
) {

7355 
	`mp_ş—r
 (&
t
);

7356  
»s
;

7358 
»s
 = 
	`mp_mod
 (&
t
, 
b
, 
c
);

7359 
	`mp_ş—r
 (&
t
);

7360  
»s
;

7361 
	}
}

7371 
	~<tomm©h.h
>

7372 #ifdeà
BN_MP_SQRT_C


7389 
	$mp_sq¹
(
mp_št
 *
¬g
, mp_šˆ*
»t
)

7391 
»s
;

7392 
mp_št
 
t1
,
t2
;

7395 ià(
¬g
->
sign
 =ğ
MP_NEG
) {

7396  
MP_VAL
;

7400 ià(
	`mp_isz”o
(
¬g
è=ğ
MP_YES
) {

7401 
	`mp_z”o
(
»t
);

7402  
MP_OKAY
;

7405 ià((
»s
 = 
	`mp_š™_cİy
(&
t1
, 
¬g
)è!ğ
MP_OKAY
) {

7406  
»s
;

7409 ià((
»s
 = 
	`mp_š™
(&
t2
)è!ğ
MP_OKAY
) {

7410 
E2
;

7414 
	`mp_rshd
 (&
t1
,t1.
u£d
/2);

7417 ià((
»s
 = 
	`mp_div
(
¬g
,&
t1
,&
t2
,
NULL
)è!ğ
MP_OKAY
) {

7418 
E1
;

7420 ià((
»s
 = 
	`mp_add
(&
t1
,&
t2
,&t1)è!ğ
MP_OKAY
) {

7421 
E1
;

7423 ià((
»s
 = 
	`mp_div_2
(&
t1
,&t1)è!ğ
MP_OKAY
) {

7424 
E1
;

7428 ià((
»s
 = 
	`mp_div
(
¬g
,&
t1
,&
t2
,
NULL
)è!ğ
MP_OKAY
) {

7429 
E1
;

7431 ià((
»s
 = 
	`mp_add
(&
t1
,&
t2
,&t1)è!ğ
MP_OKAY
) {

7432 
E1
;

7434 ià((
»s
 = 
	`mp_div_2
(&
t1
,&t1)è!ğ
MP_OKAY
) {

7435 
E1
;

7438 } 
	`mp_cmp_mag
(&
t1
,&
t2
è=ğ
MP_GT
);

7440 
	`mp_exch
(&
t1
,
»t
);

7442 
E1
: 
	`mp_ş—r
(&
t2
);

7443 
E2
: 
	`mp_ş—r
(&
t1
);

7444  
»s
;

7445 
	}
}

7456 
	~<tomm©h.h
>

7457 #ifdeà
BN_MP_SUB_C


7475 
	$mp_sub
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

7477 
§
, 
sb
, 
»s
;

7479 
§
 = 
a
->
sign
;

7480 
sb
 = 
b
->
sign
;

7482 ià(
§
 !ğ
sb
) {

7487 
c
->
sign
 = 
§
;

7488 
»s
 = 
	`s_mp_add
 (
a
, 
b
, 
c
);

7494 ià(
	`mp_cmp_mag
 (
a
, 
b
è!ğ
MP_LT
) {

7496 
c
->
sign
 = 
§
;

7498 
»s
 = 
	`s_mp_sub
 (
a
, 
b
, 
c
);

7502 
c
->
sign
 = (
§
 =ğ
MP_ZPOS
è? 
MP_NEG
 : MP_ZPOS;

7504 
»s
 = 
	`s_mp_sub
 (
b
, 
a
, 
c
);

7507  
»s
;

7508 
	}
}

7519 
	~<tomm©h.h
>

7520 #ifdeà
BN_MP_SUB_D_C


7538 
	$mp_sub_d
 (
mp_št
 * 
a
, 
mp_dig™
 
b
, mp_šˆ* 
c
)

7540 
mp_dig™
 *
tm·
, *
tmpc
, 
mu
;

7541 
»s
, 
ix
, 
Şdu£d
;

7544 ià(
c
->
®loc
 < 
a
->
u£d
 + 1) {

7545 ià((
»s
 = 
	`mp_grow
(
c
, 
a
->
u£d
 + 1)è!ğ
MP_OKAY
) {

7546  
»s
;

7553 ià(
a
->
sign
 =ğ
MP_NEG
) {

7554 
a
->
sign
 = 
MP_ZPOS
;

7555 
»s
 = 
	`mp_add_d
(
a
, 
b
, 
c
);

7556 
a
->
sign
 = 
c
->sigÀğ
MP_NEG
;

7559 
	`mp_şamp
(
c
);

7561  
»s
;

7565 
Şdu£d
 = 
c
->
u£d
;

7566 
tm·
 = 
a
->
dp
;

7567 
tmpc
 = 
c
->
dp
;

7570 ià((
a
->
u£d
 =ğ1 &&‡->
dp
[0] <ğ
b
) ||‡->used == 0) {

7571 ià(
a
->
u£d
 == 1) {

7572 *
tmpc
++ = 
b
 - *
tm·
;

7574 *
tmpc
++ = 
b
;

7576 
ix
 = 1;

7579 
c
->
sign
 = 
MP_NEG
;

7580 
c
->
u£d
 = 1;

7583 
c
->
sign
 = 
MP_ZPOS
;

7584 
c
->
u£d
 = 
a
->used;

7587 *
tmpc
 = *
tm·
++ - 
b
;

7588 
mu
 = *
tmpc
 >> ((
mp_dig™
è* 
CHAR_BIT
 - 1);

7589 *
tmpc
++ &ğ
MP_MASK
;

7592 
ix
 = 1; ix < 
a
->
u£d
; ix++) {

7593 *
tmpc
 = *
tm·
++ - 
mu
;

7594 
mu
 = *
tmpc
 >> ((
mp_dig™
è* 
CHAR_BIT
 - 1);

7595 *
tmpc
++ &ğ
MP_MASK
;

7600 
ix
++ < 
Şdu£d
) {

7601 *
tmpc
++ = 0;

7603 
	`mp_şamp
(
c
);

7604  
MP_OKAY
;

7605 
	}
}

7616 
	~<tomm©h.h
>

7617 #ifdeà
BN_MP_SUBMOD_C


7635 
	$mp_submod
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, mp_šˆ* 
d
)

7637 
»s
;

7638 
mp_št
 
t
;

7641 ià((
»s
 = 
	`mp_š™
 (&
t
)è!ğ
MP_OKAY
) {

7642  
»s
;

7645 ià((
»s
 = 
	`mp_sub
 (
a
, 
b
, &
t
)è!ğ
MP_OKAY
) {

7646 
	`mp_ş—r
 (&
t
);

7647  
»s
;

7649 
»s
 = 
	`mp_mod
 (&
t
, 
c
, 
d
);

7650 
	`mp_ş—r
 (&
t
);

7651  
»s
;

7652 
	}
}

7662 
	~<tomm©h.h
>

7663 #ifdeà
BN_MP_TO_SIGNED_BIN_C


7680 
	$mp_to_sigÃd_bš
 (
mp_št
 * 
a
, *
b
)

7682 
»s
;

7684 ià((
»s
 = 
	`mp_to_unsigÃd_bš
 (
a
, 
b
 + 1)è!ğ
MP_OKAY
) {

7685  
»s
;

7687 
b
[0] = (è((
a
->
sign
 =ğ
MP_ZPOS
) ? 0 : 1);

7688  
MP_OKAY
;

7689 
	}
}

7699 
	~<tomm©h.h
>

7700 #ifdeà
BN_MP_TO_SIGNED_BIN_N_C


7717 
	$mp_to_sigÃd_bš_n
 (
mp_št
 * 
a
, *
b
, *
ou’
)

7719 ià(*
ou’
 < ()
	`mp_sigÃd_bš_size
(
a
)) {

7720  
MP_VAL
;

7722 *
ou’
 = 
	`mp_sigÃd_bš_size
(
a
);

7723  
	`mp_to_sigÃd_bš
(
a
, 
b
);

7724 
	}
}

7734 
	~<tomm©h.h
>

7735 #ifdeà
BN_MP_TO_UNSIGNED_BIN_C


7752 
	$mp_to_unsigÃd_bš
 (
mp_št
 * 
a
, *
b
)

7754 
x
, 
»s
;

7755 
mp_št
 
t
;

7757 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

7758  
»s
;

7761 
x
 = 0;

7762 
	`mp_isz”o
 (&
t
) == 0) {

7763 #iâdeà
MP_8BIT


7764 
b
[
x
++] = (è(
t
.
dp
[0] & 255);

7766 
b
[
x
++] = (è(
t
.
dp
[0] | ((t.dp[1] & 0x01) << 7));

7768 ià((
»s
 = 
	`mp_div_2d
 (&
t
, 8, &t, 
NULL
)è!ğ
MP_OKAY
) {

7769 
	`mp_ş—r
 (&
t
);

7770  
»s
;

7773 
	`bn_»v”£
 (
b
, 
x
);

7774 
	`mp_ş—r
 (&
t
);

7775  
MP_OKAY
;

7776 
	}
}

7786 
	~<tomm©h.h
>

7787 #ifdeà
BN_MP_TO_UNSIGNED_BIN_N_C


7804 
	$mp_to_unsigÃd_bš_n
 (
mp_št
 * 
a
, *
b
, *
ou’
)

7806 ià(*
ou’
 < ()
	`mp_unsigÃd_bš_size
(
a
)) {

7807  
MP_VAL
;

7809 *
ou’
 = 
	`mp_unsigÃd_bš_size
(
a
);

7810  
	`mp_to_unsigÃd_bš
(
a
, 
b
);

7811 
	}
}

7821 
	~<tomm©h.h
>

7822 #ifdeà
BN_MP_TOOM_MUL_C


7845 
	$mp_toom_mul
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
)

7847 
mp_št
 
w0
, 
w1
, 
w2
, 
w3
, 
w4
, 
tmp1
, 
tmp2
, 
a0
, 
a1
, 
a2
, 
b0
, 
b1
, 
b2
;

7848 
»s
, 
B
;

7851 ià((
»s
 = 
	`mp_š™_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
,

7852 &
a0
, &
a1
, &
a2
, &
b0
, &
b1
,

7853 &
b2
, &
tmp1
, &
tmp2
, 
NULL
)è!ğ
MP_OKAY
) {

7854  
»s
;

7858 
B
 = 
	`MIN
(
a
->
u£d
, 
b
->used) / 3;

7861 ià((
»s
 = 
	`mp_mod_2d
(
a
, 
DIGIT_BIT
 * 
B
, &
a0
)è!ğ
MP_OKAY
) {

7862 
ERR
;

7865 ià((
»s
 = 
	`mp_cİy
(
a
, &
a1
)è!ğ
MP_OKAY
) {

7866 
ERR
;

7868 
	`mp_rshd
(&
a1
, 
B
);

7869 
	`mp_mod_2d
(&
a1
, 
DIGIT_BIT
 * 
B
, &a1);

7871 ià((
»s
 = 
	`mp_cİy
(
a
, &
a2
)è!ğ
MP_OKAY
) {

7872 
ERR
;

7874 
	`mp_rshd
(&
a2
, 
B
*2);

7877 ià((
»s
 = 
	`mp_mod_2d
(
b
, 
DIGIT_BIT
 * 
B
, &
b0
)è!ğ
MP_OKAY
) {

7878 
ERR
;

7881 ià((
»s
 = 
	`mp_cİy
(
b
, &
b1
)è!ğ
MP_OKAY
) {

7882 
ERR
;

7884 
	`mp_rshd
(&
b1
, 
B
);

7885 
	`mp_mod_2d
(&
b1
, 
DIGIT_BIT
 * 
B
, &b1);

7887 ià((
»s
 = 
	`mp_cİy
(
b
, &
b2
)è!ğ
MP_OKAY
) {

7888 
ERR
;

7890 
	`mp_rshd
(&
b2
, 
B
*2);

7893 ià((
»s
 = 
	`mp_mul
(&
a0
, &
b0
, &
w0
)è!ğ
MP_OKAY
) {

7894 
ERR
;

7898 ià((
»s
 = 
	`mp_mul
(&
a2
, &
b2
, &
w4
)è!ğ
MP_OKAY
) {

7899 
ERR
;

7903 ià((
»s
 = 
	`mp_mul_2
(&
a0
, &
tmp1
)è!ğ
MP_OKAY
) {

7904 
ERR
;

7906 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

7907 
ERR
;

7909 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

7910 
ERR
;

7912 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a2
, &tmp1)è!ğ
MP_OKAY
) {

7913 
ERR
;

7916 ià((
»s
 = 
	`mp_mul_2
(&
b0
, &
tmp2
)è!ğ
MP_OKAY
) {

7917 
ERR
;

7919 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b1
, &tmp2)è!ğ
MP_OKAY
) {

7920 
ERR
;

7922 ià((
»s
 = 
	`mp_mul_2
(&
tmp2
, &tmp2)è!ğ
MP_OKAY
) {

7923 
ERR
;

7925 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b2
, &tmp2)è!ğ
MP_OKAY
) {

7926 
ERR
;

7929 ià((
»s
 = 
	`mp_mul
(&
tmp1
, &
tmp2
, &
w1
)è!ğ
MP_OKAY
) {

7930 
ERR
;

7934 ià((
»s
 = 
	`mp_mul_2
(&
a2
, &
tmp1
)è!ğ
MP_OKAY
) {

7935 
ERR
;

7937 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

7938 
ERR
;

7940 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

7941 
ERR
;

7943 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

7944 
ERR
;

7947 ià((
»s
 = 
	`mp_mul_2
(&
b2
, &
tmp2
)è!ğ
MP_OKAY
) {

7948 
ERR
;

7950 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b1
, &tmp2)è!ğ
MP_OKAY
) {

7951 
ERR
;

7953 ià((
»s
 = 
	`mp_mul_2
(&
tmp2
, &tmp2)è!ğ
MP_OKAY
) {

7954 
ERR
;

7956 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b0
, &tmp2)è!ğ
MP_OKAY
) {

7957 
ERR
;

7960 ià((
»s
 = 
	`mp_mul
(&
tmp1
, &
tmp2
, &
w3
)è!ğ
MP_OKAY
) {

7961 
ERR
;

7966 ià((
»s
 = 
	`mp_add
(&
a2
, &
a1
, &
tmp1
)è!ğ
MP_OKAY
) {

7967 
ERR
;

7969 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

7970 
ERR
;

7972 ià((
»s
 = 
	`mp_add
(&
b2
, &
b1
, &
tmp2
)è!ğ
MP_OKAY
) {

7973 
ERR
;

7975 ià((
»s
 = 
	`mp_add
(&
tmp2
, &
b0
, &tmp2)è!ğ
MP_OKAY
) {

7976 
ERR
;

7978 ià((
»s
 = 
	`mp_mul
(&
tmp1
, &
tmp2
, &
w2
)è!ğ
MP_OKAY
) {

7979 
ERR
;

7995 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w4
, &w1)è!ğ
MP_OKAY
) {

7996 
ERR
;

7999 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w0
, &w3)è!ğ
MP_OKAY
) {

8000 
ERR
;

8003 ià((
»s
 = 
	`mp_div_2
(&
w1
, &w1)è!ğ
MP_OKAY
) {

8004 
ERR
;

8007 ià((
»s
 = 
	`mp_div_2
(&
w3
, &w3)è!ğ
MP_OKAY
) {

8008 
ERR
;

8011 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w0
, &w2)è!ğ
MP_OKAY
) {

8012 
ERR
;

8014 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w4
, &w2)è!ğ
MP_OKAY
) {

8015 
ERR
;

8018 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

8019 
ERR
;

8022 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

8023 
ERR
;

8026 ià((
»s
 = 
	`mp_mul_2d
(&
w0
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

8027 
ERR
;

8029 ià((
»s
 = 
	`mp_sub
(&
w1
, &
tmp1
, &w1)è!ğ
MP_OKAY
) {

8030 
ERR
;

8033 ià((
»s
 = 
	`mp_mul_2d
(&
w4
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

8034 
ERR
;

8036 ià((
»s
 = 
	`mp_sub
(&
w3
, &
tmp1
, &w3)è!ğ
MP_OKAY
) {

8037 
ERR
;

8040 ià((
»s
 = 
	`mp_mul_d
(&
w2
, 3, &w2)è!ğ
MP_OKAY
) {

8041 
ERR
;

8043 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w1
, &w2)è!ğ
MP_OKAY
) {

8044 
ERR
;

8046 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w3
, &w2)è!ğ
MP_OKAY
) {

8047 
ERR
;

8050 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

8051 
ERR
;

8054 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

8055 
ERR
;

8058 ià((
»s
 = 
	`mp_div_3
(&
w1
, &w1, 
NULL
)è!ğ
MP_OKAY
) {

8059 
ERR
;

8062 ià((
»s
 = 
	`mp_div_3
(&
w3
, &w3, 
NULL
)è!ğ
MP_OKAY
) {

8063 
ERR
;

8067 ià((
»s
 = 
	`mp_lshd
(&
w1
, 1*
B
)è!ğ
MP_OKAY
) {

8068 
ERR
;

8070 ià((
»s
 = 
	`mp_lshd
(&
w2
, 2*
B
)è!ğ
MP_OKAY
) {

8071 
ERR
;

8073 ià((
»s
 = 
	`mp_lshd
(&
w3
, 3*
B
)è!ğ
MP_OKAY
) {

8074 
ERR
;

8076 ià((
»s
 = 
	`mp_lshd
(&
w4
, 4*
B
)è!ğ
MP_OKAY
) {

8077 
ERR
;

8080 ià((
»s
 = 
	`mp_add
(&
w0
, &
w1
, 
c
)è!ğ
MP_OKAY
) {

8081 
ERR
;

8083 ià((
»s
 = 
	`mp_add
(&
w2
, &
w3
, &
tmp1
)è!ğ
MP_OKAY
) {

8084 
ERR
;

8086 ià((
»s
 = 
	`mp_add
(&
w4
, &
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

8087 
ERR
;

8089 ià((
»s
 = 
	`mp_add
(&
tmp1
, 
c
, c)è!ğ
MP_OKAY
) {

8090 
ERR
;

8093 
ERR
:

8094 
	`mp_ş—r_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
,

8095 &
a0
, &
a1
, &
a2
, &
b0
, &
b1
,

8096 &
b2
, &
tmp1
, &
tmp2
, 
NULL
);

8097  
»s
;

8098 
	}
}

8109 
	~<tomm©h.h
>

8110 #ifdeà
BN_MP_TOOM_SQR_C


8128 
	$mp_toom_sqr
(
mp_št
 *
a
, mp_šˆ*
b
)

8130 
mp_št
 
w0
, 
w1
, 
w2
, 
w3
, 
w4
, 
tmp1
, 
a0
, 
a1
, 
a2
;

8131 
»s
, 
B
;

8134 ià((
»s
 = 
	`mp_š™_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
, &
a0
, &
a1
, &
a2
, &
tmp1
, 
NULL
)è!ğ
MP_OKAY
) {

8135  
»s
;

8139 
B
 = 
a
->
u£d
 / 3;

8142 ià((
»s
 = 
	`mp_mod_2d
(
a
, 
DIGIT_BIT
 * 
B
, &
a0
)è!ğ
MP_OKAY
) {

8143 
ERR
;

8146 ià((
»s
 = 
	`mp_cİy
(
a
, &
a1
)è!ğ
MP_OKAY
) {

8147 
ERR
;

8149 
	`mp_rshd
(&
a1
, 
B
);

8150 
	`mp_mod_2d
(&
a1
, 
DIGIT_BIT
 * 
B
, &a1);

8152 ià((
»s
 = 
	`mp_cİy
(
a
, &
a2
)è!ğ
MP_OKAY
) {

8153 
ERR
;

8155 
	`mp_rshd
(&
a2
, 
B
*2);

8158 ià((
»s
 = 
	`mp_sqr
(&
a0
, &
w0
)è!ğ
MP_OKAY
) {

8159 
ERR
;

8163 ià((
»s
 = 
	`mp_sqr
(&
a2
, &
w4
)è!ğ
MP_OKAY
) {

8164 
ERR
;

8168 ià((
»s
 = 
	`mp_mul_2
(&
a0
, &
tmp1
)è!ğ
MP_OKAY
) {

8169 
ERR
;

8171 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

8172 
ERR
;

8174 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

8175 
ERR
;

8177 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a2
, &tmp1)è!ğ
MP_OKAY
) {

8178 
ERR
;

8181 ià((
»s
 = 
	`mp_sqr
(&
tmp1
, &
w1
)è!ğ
MP_OKAY
) {

8182 
ERR
;

8186 ià((
»s
 = 
	`mp_mul_2
(&
a2
, &
tmp1
)è!ğ
MP_OKAY
) {

8187 
ERR
;

8189 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a1
, &tmp1)è!ğ
MP_OKAY
) {

8190 
ERR
;

8192 ià((
»s
 = 
	`mp_mul_2
(&
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

8193 
ERR
;

8195 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

8196 
ERR
;

8199 ià((
»s
 = 
	`mp_sqr
(&
tmp1
, &
w3
)è!ğ
MP_OKAY
) {

8200 
ERR
;

8205 ià((
»s
 = 
	`mp_add
(&
a2
, &
a1
, &
tmp1
)è!ğ
MP_OKAY
) {

8206 
ERR
;

8208 ià((
»s
 = 
	`mp_add
(&
tmp1
, &
a0
, &tmp1)è!ğ
MP_OKAY
) {

8209 
ERR
;

8211 ià((
»s
 = 
	`mp_sqr
(&
tmp1
, &
w2
)è!ğ
MP_OKAY
) {

8212 
ERR
;

8227 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w4
, &w1)è!ğ
MP_OKAY
) {

8228 
ERR
;

8231 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w0
, &w3)è!ğ
MP_OKAY
) {

8232 
ERR
;

8235 ià((
»s
 = 
	`mp_div_2
(&
w1
, &w1)è!ğ
MP_OKAY
) {

8236 
ERR
;

8239 ià((
»s
 = 
	`mp_div_2
(&
w3
, &w3)è!ğ
MP_OKAY
) {

8240 
ERR
;

8243 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w0
, &w2)è!ğ
MP_OKAY
) {

8244 
ERR
;

8246 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w4
, &w2)è!ğ
MP_OKAY
) {

8247 
ERR
;

8250 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

8251 
ERR
;

8254 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

8255 
ERR
;

8258 ià((
»s
 = 
	`mp_mul_2d
(&
w0
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

8259 
ERR
;

8261 ià((
»s
 = 
	`mp_sub
(&
w1
, &
tmp1
, &w1)è!ğ
MP_OKAY
) {

8262 
ERR
;

8265 ià((
»s
 = 
	`mp_mul_2d
(&
w4
, 3, &
tmp1
)è!ğ
MP_OKAY
) {

8266 
ERR
;

8268 ià((
»s
 = 
	`mp_sub
(&
w3
, &
tmp1
, &w3)è!ğ
MP_OKAY
) {

8269 
ERR
;

8272 ià((
»s
 = 
	`mp_mul_d
(&
w2
, 3, &w2)è!ğ
MP_OKAY
) {

8273 
ERR
;

8275 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w1
, &w2)è!ğ
MP_OKAY
) {

8276 
ERR
;

8278 ià((
»s
 = 
	`mp_sub
(&
w2
, &
w3
, &w2)è!ğ
MP_OKAY
) {

8279 
ERR
;

8282 ià((
»s
 = 
	`mp_sub
(&
w1
, &
w2
, &w1)è!ğ
MP_OKAY
) {

8283 
ERR
;

8286 ià((
»s
 = 
	`mp_sub
(&
w3
, &
w2
, &w3)è!ğ
MP_OKAY
) {

8287 
ERR
;

8290 ià((
»s
 = 
	`mp_div_3
(&
w1
, &w1, 
NULL
)è!ğ
MP_OKAY
) {

8291 
ERR
;

8294 ià((
»s
 = 
	`mp_div_3
(&
w3
, &w3, 
NULL
)è!ğ
MP_OKAY
) {

8295 
ERR
;

8299 ià((
»s
 = 
	`mp_lshd
(&
w1
, 1*
B
)è!ğ
MP_OKAY
) {

8300 
ERR
;

8302 ià((
»s
 = 
	`mp_lshd
(&
w2
, 2*
B
)è!ğ
MP_OKAY
) {

8303 
ERR
;

8305 ià((
»s
 = 
	`mp_lshd
(&
w3
, 3*
B
)è!ğ
MP_OKAY
) {

8306 
ERR
;

8308 ià((
»s
 = 
	`mp_lshd
(&
w4
, 4*
B
)è!ğ
MP_OKAY
) {

8309 
ERR
;

8312 ià((
»s
 = 
	`mp_add
(&
w0
, &
w1
, 
b
)è!ğ
MP_OKAY
) {

8313 
ERR
;

8315 ià((
»s
 = 
	`mp_add
(&
w2
, &
w3
, &
tmp1
)è!ğ
MP_OKAY
) {

8316 
ERR
;

8318 ià((
»s
 = 
	`mp_add
(&
w4
, &
tmp1
, &tmp1)è!ğ
MP_OKAY
) {

8319 
ERR
;

8321 ià((
»s
 = 
	`mp_add
(&
tmp1
, 
b
, b)è!ğ
MP_OKAY
) {

8322 
ERR
;

8325 
ERR
:

8326 
	`mp_ş—r_muÉi
(&
w0
, &
w1
, &
w2
, &
w3
, &
w4
, &
a0
, &
a1
, &
a2
, &
tmp1
, 
NULL
);

8327  
»s
;

8328 
	}
}

8339 
	~<tomm©h.h
>

8340 #ifdeà
BN_MP_TORADIX_C


8357 
	$mp_tÜadix
 (
mp_št
 * 
a
, *
¡r
, 
¿dix
)

8359 
»s
, 
digs
;

8360 
mp_št
 
t
;

8361 
mp_dig™
 
d
;

8362 *
_s
 = 
¡r
;

8365 ià(
¿dix
 < 2 ||„adix > 64) {

8366  
MP_VAL
;

8370 ià(
	`mp_isz”o
(
a
) == 1) {

8371 *
¡r
++ = '0';

8372 *
¡r
 = '\0';

8373  
MP_OKAY
;

8376 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

8377  
»s
;

8381 ià(
t
.
sign
 =ğ
MP_NEG
) {

8382 ++
_s
;

8383 *
¡r
++ = '-';

8384 
t
.
sign
 = 
MP_ZPOS
;

8387 
digs
 = 0;

8388 
	`mp_isz”o
 (&
t
) == 0) {

8389 ià((
»s
 = 
	`mp_div_d
 (&
t
, (
mp_dig™
è
¿dix
, &t, &
d
)è!ğ
MP_OKAY
) {

8390 
	`mp_ş—r
 (&
t
);

8391  
»s
;

8393 *
¡r
++ = 
mp_s_rm­
[
d
];

8394 ++
digs
;

8400 
	`bn_»v”£
 ((*)
_s
, 
digs
);

8403 *
¡r
 = '\0';

8405 
	`mp_ş—r
 (&
t
);

8406  
MP_OKAY
;

8407 
	}
}

8418 
	~<tomm©h.h
>

8419 #ifdeà
BN_MP_TORADIX_N_C


8439 
	$mp_tÜadix_n
(
mp_št
 * 
a
, *
¡r
, 
¿dix
, 
maxËn
)

8441 
»s
, 
digs
;

8442 
mp_št
 
t
;

8443 
mp_dig™
 
d
;

8444 *
_s
 = 
¡r
;

8447 ià(
maxËn
 < 2 || 
¿dix
 < 2 ||„adix > 64) {

8448  
MP_VAL
;

8452 ià(
	`mp_isz”o
(
a
è=ğ
MP_YES
) {

8453 *
¡r
++ = '0';

8454 *
¡r
 = '\0';

8455  
MP_OKAY
;

8458 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

8459  
»s
;

8463 ià(
t
.
sign
 =ğ
MP_NEG
) {

8465 ++
_s
;

8468 *
¡r
++ = '-';

8469 
t
.
sign
 = 
MP_ZPOS
;

8472 --
maxËn
;

8475 
digs
 = 0;

8476 
	`mp_isz”o
 (&
t
) == 0) {

8477 ià(--
maxËn
 < 1) {

8481 ià((
»s
 = 
	`mp_div_d
 (&
t
, (
mp_dig™
è
¿dix
, &t, &
d
)è!ğ
MP_OKAY
) {

8482 
	`mp_ş—r
 (&
t
);

8483  
»s
;

8485 *
¡r
++ = 
mp_s_rm­
[
d
];

8486 ++
digs
;

8492 
	`bn_»v”£
 ((*)
_s
, 
digs
);

8495 *
¡r
 = '\0';

8497 
	`mp_ş—r
 (&
t
);

8498  
MP_OKAY
;

8499 
	}
}

8510 
	~<tomm©h.h
>

8511 #ifdeà
BN_MP_UNSIGNED_BIN_SIZE_C


8528 
	$mp_unsigÃd_bš_size
 (
mp_št
 * 
a
)

8530 
size
 = 
	`mp_couÁ_b™s
 (
a
);

8531  (
size
 / 8 + ((size & 7) != 0 ? 1 : 0));

8532 
	}
}

8542 
	~<tomm©h.h
>

8543 #ifdeà
BN_MP_XOR_C


8561 
	$mp_xÜ
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

8563 
»s
, 
ix
, 
px
;

8564 
mp_št
 
t
, *
x
;

8566 ià(
a
->
u£d
 > 
b
->used) {

8567 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
a
)è!ğ
MP_OKAY
) {

8568  
»s
;

8570 
px
 = 
b
->
u£d
;

8571 
x
 = 
b
;

8573 ià((
»s
 = 
	`mp_š™_cİy
 (&
t
, 
b
)è!ğ
MP_OKAY
) {

8574  
»s
;

8576 
px
 = 
a
->
u£d
;

8577 
x
 = 
a
;

8580 
ix
 = 0; ix < 
px
; ix++) {

8581 
t
.
dp
[
ix
] ^ğ
x
->dp[ix];

8583 
	`mp_şamp
 (&
t
);

8584 
	`mp_exch
 (
c
, &
t
);

8585 
	`mp_ş—r
 (&
t
);

8586  
MP_OKAY
;

8587 
	}
}

8597 
	~<tomm©h.h
>

8598 #ifdeà
BN_MP_ZERO_C


8615 
	$mp_z”o
 (
mp_št
 * 
a
)

8617 
n
;

8618 
mp_dig™
 *
tmp
;

8620 
a
->
sign
 = 
MP_ZPOS
;

8621 
a
->
u£d
 = 0;

8623 
tmp
 = 
a
->
dp
;

8624 
n
 = 0;‚ < 
a
->
®loc
;‚++) {

8625 *
tmp
++ = 0;

8627 
	}
}

8637 
	~<tomm©h.h
>

8638 #ifdeà
BN_PRIME_TAB_C


8653 cÚ¡ 
mp_dig™
 
	gÉm_´ime_b
[] = {

8658 #iâdeà
MP_8BIT


8702 
	~<tomm©h.h
>

8703 #ifdeà
BN_REVERSE_C


8721 
	$bn_»v”£
 (*
s
, 
Ën
)

8723 
ix
, 
iy
;

8724 
t
;

8726 
ix
 = 0;

8727 
iy
 = 
Ën
 - 1;

8728 
ix
 < 
iy
) {

8729 
t
 = 
s
[
ix
];

8730 
s
[
ix
] = s[
iy
];

8731 
s
[
iy
] = 
t
;

8732 ++
ix
;

8733 --
iy
;

8735 
	}
}

8745 
	~<tomm©h.h
>

8746 #ifdeà
BN_S_MP_ADD_C


8764 
	$s_mp_add
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

8766 
mp_št
 *
x
;

8767 
Şdu£
, 
»s
, 
mš
, 
max
;

8772 ià(
a
->
u£d
 > 
b
->used) {

8773 
mš
 = 
b
->
u£d
;

8774 
max
 = 
a
->
u£d
;

8775 
x
 = 
a
;

8777 
mš
 = 
a
->
u£d
;

8778 
max
 = 
b
->
u£d
;

8779 
x
 = 
b
;

8783 ià(
c
->
®loc
 < 
max
 + 1) {

8784 ià((
»s
 = 
	`mp_grow
 (
c
, 
max
 + 1)è!ğ
MP_OKAY
) {

8785  
»s
;

8790 
Şdu£
 = 
c
->
u£d
;

8791 
c
->
u£d
 = 
max
 + 1;

8794 
mp_dig™
 
u
, *
tm·
, *
tmpb
, *
tmpc
;

8795 
i
;

8800 
tm·
 = 
a
->
dp
;

8803 
tmpb
 = 
b
->
dp
;

8806 
tmpc
 = 
c
->
dp
;

8809 
u
 = 0;

8810 
i
 = 0; i < 
mš
; i++) {

8812 *
tmpc
 = *
tm·
++ + *
tmpb
++ + 
u
;

8815 
u
 = *
tmpc
 >> ((
mp_dig™
)
DIGIT_BIT
);

8818 *
tmpc
++ &ğ
MP_MASK
;

8824 ià(
mš
 !ğ
max
) {

8825 ; 
i
 < 
max
; i++) {

8827 *
tmpc
 = 
x
->
dp
[
i
] + 
u
;

8830 
u
 = *
tmpc
 >> ((
mp_dig™
)
DIGIT_BIT
);

8833 *
tmpc
++ &ğ
MP_MASK
;

8838 *
tmpc
++ = 
u
;

8841 
i
 = 
c
->
u£d
; i < 
Şdu£
; i++) {

8842 *
tmpc
++ = 0;

8846 
	`mp_şamp
 (
c
);

8847  
MP_OKAY
;

8848 
	}
}

8858 
	~<tomm©h.h
>

8859 #ifdeà
BN_S_MP_EXPTMOD_C


8874 #ifdeà
MP_LOW_MEM


8875 
	#TAB_SIZE
 32

	)

8877 
	#TAB_SIZE
 256

	)

8880 
	$s_mp_ex±mod
 (
mp_št
 * 
G
, mp_šˆ* 
X
, mp_šˆ* 
P
, mp_šˆ* 
Y
, 
»dmode
)

8882 
mp_št
 
M
[
TAB_SIZE
], 
»s
, 
mu
;

8883 
mp_dig™
 
buf
;

8884 
”r
, 
b™buf
, 
b™ıy
, 
b™út
, 
mode
, 
digidx
, 
x
, 
y
, 
wšsize
;

8885 (*
»dux
)(
mp_št
*,mp_int*,mp_int*);

8888 
x
 = 
	`mp_couÁ_b™s
 (
X
);

8889 ià(
x
 <= 7) {

8890 
wšsize
 = 2;

8891 } ià(
x
 <= 36) {

8892 
wšsize
 = 3;

8893 } ià(
x
 <= 140) {

8894 
wšsize
 = 4;

8895 } ià(
x
 <= 450) {

8896 
wšsize
 = 5;

8897 } ià(
x
 <= 1303) {

8898 
wšsize
 = 6;

8899 } ià(
x
 <= 3529) {

8900 
wšsize
 = 7;

8902 
wšsize
 = 8;

8905 #ifdeà
MP_LOW_MEM


8906 ià(
wšsize
 > 5) {

8907 
wšsize
 = 5;

8913 ià((
”r
 = 
	`mp_š™
(&
M
[1])è!ğ
MP_OKAY
) {

8914  
”r
;

8918 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

8919 ià((
”r
 = 
	`mp_š™
(&
M
[
x
])è!ğ
MP_OKAY
) {

8920 
y
 = 1<<(
wšsize
-1); y < 
x
; y++) {

8921 
	`mp_ş—r
 (&
M
[
y
]);

8923 
	`mp_ş—r
(&
M
[1]);

8924  
”r
;

8929 ià((
”r
 = 
	`mp_š™
 (&
mu
)è!ğ
MP_OKAY
) {

8930 
LBL_M
;

8933 ià(
»dmode
 == 0) {

8934 ià((
”r
 = 
	`mp_»duû_£tup
 (&
mu
, 
P
)è!ğ
MP_OKAY
) {

8935 
LBL_MU
;

8937 
»dux
 = 
mp_»duû
;

8939 ià((
”r
 = 
	`mp_»duû_2k_£tup_l
 (
P
, &
mu
)è!ğ
MP_OKAY
) {

8940 
LBL_MU
;

8942 
»dux
 = 
mp_»duû_2k_l
;

8953 ià((
”r
 = 
	`mp_mod
 (
G
, 
P
, &
M
[1])è!ğ
MP_OKAY
) {

8954 
LBL_MU
;

8960 ià((
”r
 = 
	`mp_cİy
 (&
M
[1], &M[1 << (
wšsize
 - 1)])è!ğ
MP_OKAY
) {

8961 
LBL_MU
;

8964 
x
 = 0; x < (
wšsize
 - 1); x++) {

8966 ià((
”r
 = 
	`mp_sqr
 (&
M
[1 << (
wšsize
 - 1)],

8967 &
M
[1 << (
wšsize
 - 1)])è!ğ
MP_OKAY
) {

8968 
LBL_MU
;

8972 ià((
”r
 = 
	`»dux
 (&
M
[1 << (
wšsize
 - 1)], 
P
, &
mu
)è!ğ
MP_OKAY
) {

8973 
LBL_MU
;

8980 
x
 = (1 << (
wšsize
 - 1)) + 1; x < (1 << winsize); x++) {

8981 ià((
”r
 = 
	`mp_mul
 (&
M
[
x
 - 1], &M[1], &M[x])è!ğ
MP_OKAY
) {

8982 
LBL_MU
;

8984 ià((
”r
 = 
	`»dux
 (&
M
[
x
], 
P
, &
mu
)è!ğ
MP_OKAY
) {

8985 
LBL_MU
;

8990 ià((
”r
 = 
	`mp_š™
 (&
»s
)è!ğ
MP_OKAY
) {

8991 
LBL_MU
;

8993 
	`mp_£t
 (&
»s
, 1);

8996 
mode
 = 0;

8997 
b™út
 = 1;

8998 
buf
 = 0;

8999 
digidx
 = 
X
->
u£d
 - 1;

9000 
b™ıy
 = 0;

9001 
b™buf
 = 0;

9005 ià(--
b™út
 == 0) {

9007 ià(
digidx
 == -1) {

9011 
buf
 = 
X
->
dp
[
digidx
--];

9012 
b™út
 = (è
DIGIT_BIT
;

9016 
y
 = (
buf
 >> (
mp_dig™
)(
DIGIT_BIT
 - 1)) & 1;

9017 
buf
 <<ğ(
mp_dig™
)1;

9024 ià(
mode
 =ğ0 && 
y
 == 0) {

9029 ià(
mode
 =ğ1 && 
y
 == 0) {

9030 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

9031 
LBL_RES
;

9033 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

9034 
LBL_RES
;

9040 
b™buf
 |ğ(
y
 << (
wšsize
 - ++
b™ıy
));

9041 
mode
 = 2;

9043 ià(
b™ıy
 =ğ
wšsize
) {

9046 
x
 = 0; x < 
wšsize
; x++) {

9047 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

9048 
LBL_RES
;

9050 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

9051 
LBL_RES
;

9056 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[
b™buf
], &»s)è!ğ
MP_OKAY
) {

9057 
LBL_RES
;

9059 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

9060 
LBL_RES
;

9064 
b™ıy
 = 0;

9065 
b™buf
 = 0;

9066 
mode
 = 1;

9071 ià(
mode
 =ğ2 && 
b™ıy
 > 0) {

9073 
x
 = 0; x < 
b™ıy
; x++) {

9074 ià((
”r
 = 
	`mp_sqr
 (&
»s
, &»s)è!ğ
MP_OKAY
) {

9075 
LBL_RES
;

9077 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

9078 
LBL_RES
;

9081 
b™buf
 <<= 1;

9082 ià((
b™buf
 & (1 << 
wšsize
)) != 0) {

9084 ià((
”r
 = 
	`mp_mul
 (&
»s
, &
M
[1], &»s)è!ğ
MP_OKAY
) {

9085 
LBL_RES
;

9087 ià((
”r
 = 
	`»dux
 (&
»s
, 
P
, &
mu
)è!ğ
MP_OKAY
) {

9088 
LBL_RES
;

9094 
	`mp_exch
 (&
»s
, 
Y
);

9095 
”r
 = 
MP_OKAY
;

9096 
LBL_RES
:
	`mp_ş—r
 (&
»s
);

9097 
LBL_MU
:
	`mp_ş—r
 (&
mu
);

9098 
LBL_M
:

9099 
	`mp_ş—r
(&
M
[1]);

9100 
x
 = 1<<(
wšsize
-1); x < (1 << winsize); x++) {

9101 
	`mp_ş—r
 (&
M
[
x
]);

9103  
”r
;

9104 
	}
}

9114 
	~<tomm©h.h
>

9115 #ifdeà
BN_S_MP_MUL_DIGS_C


9135 
	$s_mp_mul_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

9137 
mp_št
 
t
;

9138 
»s
, 
·
, 
pb
, 
ix
, 
iy
;

9139 
mp_dig™
 
u
;

9140 
mp_wÜd
 
r
;

9141 
mp_dig™
 
tmpx
, *
tm±
, *
tmpy
;

9144 ià(((
digs
è< 
MP_WARRAY
) &&

9145 
	`MIN
 (
a
->
u£d
, 
b
->used) <

9146 (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

9147  
	`ç¡_s_mp_mul_digs
 (
a
, 
b
, 
c
, 
digs
);

9150 ià((
»s
 = 
	`mp_š™_size
 (&
t
, 
digs
)è!ğ
MP_OKAY
) {

9151  
»s
;

9153 
t
.
u£d
 = 
digs
;

9156 
·
 = 
a
->
u£d
;

9157 
ix
 = 0; ix < 
·
; ix++) {

9159 
u
 = 0;

9162 
pb
 = 
	`MIN
 (
b
->
u£d
, 
digs
 - 
ix
);

9166 
tmpx
 = 
a
->
dp
[
ix
];

9169 
tm±
 = 
t
.
dp
 + 
ix
;

9172 
tmpy
 = 
b
->
dp
;

9175 
iy
 = 0; iy < 
pb
; iy++) {

9177 
r
 = ((
mp_wÜd
)*
tm±
) +

9178 ((
mp_wÜd
)
tmpx
è* ((mp_wÜd)*
tmpy
++) +

9179 ((
mp_wÜd
è
u
);

9182 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

9185 
u
 = (
mp_dig™
è(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

9188 ià(
ix
 + 
iy
 < 
digs
) {

9189 *
tm±
 = 
u
;

9193 
	`mp_şamp
 (&
t
);

9194 
	`mp_exch
 (&
t
, 
c
);

9196 
	`mp_ş—r
 (&
t
);

9197  
MP_OKAY
;

9198 
	}
}

9208 
	~<tomm©h.h
>

9209 #ifdeà
BN_S_MP_MUL_HIGH_DIGS_C


9229 
	$s_mp_mul_high_digs
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
, 
digs
)

9231 
mp_št
 
t
;

9232 
»s
, 
·
, 
pb
, 
ix
, 
iy
;

9233 
mp_dig™
 
u
;

9234 
mp_wÜd
 
r
;

9235 
mp_dig™
 
tmpx
, *
tm±
, *
tmpy
;

9238 #ifdeà
BN_FAST_S_MP_MUL_HIGH_DIGS_C


9239 ià(((
a
->
u£d
 + 
b
->u£d + 1è< 
MP_WARRAY
)

9240 && 
	`MIN
 (
a
->
u£d
, 
b
->u£dè< (1 << ((
CHAR_BIT
 *  (
mp_wÜd
)è- (2 * 
DIGIT_BIT
)))) {

9241  
	`ç¡_s_mp_mul_high_digs
 (
a
, 
b
, 
c
, 
digs
);

9245 ià((
»s
 = 
	`mp_š™_size
 (&
t
, 
a
->
u£d
 + 
b
->u£d + 1)è!ğ
MP_OKAY
) {

9246  
»s
;

9248 
t
.
u£d
 = 
a
->u£d + 
b
->used + 1;

9250 
·
 = 
a
->
u£d
;

9251 
pb
 = 
b
->
u£d
;

9252 
ix
 = 0; ix < 
·
; ix++) {

9254 
u
 = 0;

9257 
tmpx
 = 
a
->
dp
[
ix
];

9260 
tm±
 = &(
t
.
dp
[
digs
]);

9263 
tmpy
 = 
b
->
dp
 + (
digs
 - 
ix
);

9265 
iy
 = 
digs
 - 
ix
; iy < 
pb
; iy++) {

9267 
r
 = ((
mp_wÜd
)*
tm±
) +

9268 ((
mp_wÜd
)
tmpx
è* ((mp_wÜd)*
tmpy
++) +

9269 ((
mp_wÜd
è
u
);

9272 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

9275 
u
 = (
mp_dig™
è(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

9277 *
tm±
 = 
u
;

9279 
	`mp_şamp
 (&
t
);

9280 
	`mp_exch
 (&
t
, 
c
);

9281 
	`mp_ş—r
 (&
t
);

9282  
MP_OKAY
;

9283 
	}
}

9293 
	~<tomm©h.h
>

9294 #ifdeà
BN_S_MP_SQR_C


9311 
	$s_mp_sqr
 (
mp_št
 * 
a
, mp_šˆ* 
b
)

9313 
mp_št
 
t
;

9314 
»s
, 
ix
, 
iy
, 
·
;

9315 
mp_wÜd
 
r
;

9316 
mp_dig™
 
u
, 
tmpx
, *
tm±
;

9318 
·
 = 
a
->
u£d
;

9319 ià((
»s
 = 
	`mp_š™_size
 (&
t
, 2*
·
 + 1)è!ğ
MP_OKAY
) {

9320  
»s
;

9324 
t
.
u£d
 = 2*
·
 + 1;

9326 
ix
 = 0; ix < 
·
; ix++) {

9329 
r
 = ((
mp_wÜd
è
t
.
dp
[2*
ix
]) +

9330 ((
mp_wÜd
)
a
->
dp
[
ix
])*((mp_word)a->dp[ix]);

9333 
t
.
dp
[
ix
+ix] = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

9336 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

9339 
tmpx
 = 
a
->
dp
[
ix
];

9342 
tm±
 = 
t
.
dp
 + (2*
ix
 + 1);

9344 
iy
 = 
ix
 + 1; iy < 
·
; iy++) {

9346 
r
 = ((
mp_wÜd
)
tmpx
è* ((mp_wÜd)
a
->
dp
[
iy
]);

9351 
r
 = ((
mp_wÜd
è*
tm±
è+„ +„ + ((mp_wÜdè
u
);

9354 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

9357 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

9360 
u
 !ğ((
mp_dig™
) 0)) {

9361 
r
 = ((
mp_wÜd
è*
tm±
è+ ((mp_wÜdè
u
);

9362 *
tm±
++ = (
mp_dig™
è(
r
 & ((
mp_wÜd
è
MP_MASK
));

9363 
u
 = (
mp_dig™
)(
r
 >> ((
mp_wÜd
è
DIGIT_BIT
));

9367 
	`mp_şamp
 (&
t
);

9368 
	`mp_exch
 (&
t
, 
b
);

9369 
	`mp_ş—r
 (&
t
);

9370  
MP_OKAY
;

9371 
	}
}

9381 
	~<tomm©h.h
>

9382 #ifdeà
BN_S_MP_SUB_C


9400 
	$s_mp_sub
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
)

9402 
Şdu£
, 
»s
, 
mš
, 
max
;

9405 
mš
 = 
b
->
u£d
;

9406 
max
 = 
a
->
u£d
;

9409 ià(
c
->
®loc
 < 
max
) {

9410 ià((
»s
 = 
	`mp_grow
 (
c
, 
max
)è!ğ
MP_OKAY
) {

9411  
»s
;

9414 
Şdu£
 = 
c
->
u£d
;

9415 
c
->
u£d
 = 
max
;

9418 
mp_dig™
 
u
, *
tm·
, *
tmpb
, *
tmpc
;

9419 
i
;

9422 
tm·
 = 
a
->
dp
;

9423 
tmpb
 = 
b
->
dp
;

9424 
tmpc
 = 
c
->
dp
;

9427 
u
 = 0;

9428 
i
 = 0; i < 
mš
; i++) {

9430 *
tmpc
 = *
tm·
++ - *
tmpb
++ - 
u
;

9437 
u
 = *
tmpc
 >> ((
mp_dig™
)(
CHAR_BIT
 *  (mp_digit) - 1));

9440 *
tmpc
++ &ğ
MP_MASK
;

9444 ; 
i
 < 
max
; i++) {

9446 *
tmpc
 = *
tm·
++ - 
u
;

9449 
u
 = *
tmpc
 >> ((
mp_dig™
)(
CHAR_BIT
 *  (mp_digit) - 1));

9452 *
tmpc
++ &ğ
MP_MASK
;

9456 
i
 = 
c
->
u£d
; i < 
Şdu£
; i++) {

9457 *
tmpc
++ = 0;

9461 
	`mp_şamp
 (
c
);

9462  
MP_OKAY
;

9463 
	}
}

9474 
	~<tomm©h.h
>

9475 #ifdeà
BNCORE_C


9500 
	gKARATSUBA_MUL_CUTOFF
 = 80,

9501 
	gKARATSUBA_SQR_CUTOFF
 = 120,

9503 
	gTOOM_MUL_CUTOFF
 = 350,

9504 
	gTOOM_SQR_CUTOFF
 = 400;

	@libtommath/tommath.h

15 #iâdeà
BN_H_


16 
	#BN_H_


	)

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<¡dlib.h
>

21 
	~<ùy³.h
>

22 
	~<lim™s.h
>

24 
	~"tomm©h_şass.h
"

26 #iâdeà
MIN


27 
	#MIN
(
x
,
y
è((x)<(y)?(x):(y))

	)

30 #iâdeà
MAX


31 
	#MAX
(
x
,
y
è((x)>(y)?(x):(y))

	)

34 #ifdeà
__ılu¥lus


38 
	#OPT_CAST
(
x
è(x *)

	)

43 
	#OPT_CAST
(
x
)

	)

49 #ià
defšed
(
__x86_64__
)

50 #ià!(
defšed
(
MP_64BIT
è&& defšed(
MP_16BIT
è&& defšed(
MP_8BIT
))

51 
	#MP_64BIT


	)

63 #ifdeà
MP_8BIT


64 
	tmp_dig™
;

65 
	tmp_wÜd
;

66 #–ià
defšed
(
MP_16BIT
)

67 
	tmp_dig™
;

68 
	tmp_wÜd
;

69 #–ià
defšed
(
MP_64BIT
)

71 #iâdeà
CRYPT


72 
	tulÚg64
;

73 sigÃd 
	tlÚg64
;

76 
	tmp_dig™
;

77 
	tmp_wÜd
 
	t__©Œibu‹__
 ((
	tmode
(
	tTI
)));

79 
	#DIGIT_BIT
 60

	)

84 #iâdeà
CRYPT


85 #ià
defšed
(
_MSC_VER
è|| defšed(
__BORLANDC__
)

86 
	t__št64
 
	tulÚg64
;

87 sigÃd 
	t__št64
 
	tlÚg64
;

89 
	tulÚg64
;

90 sigÃd 
	tlÚg64
;

94 
	tmp_dig™
;

95 
ulÚg64
 
	tmp_wÜd
;

97 #ifdeà
MP_31BIT


99 
	#DIGIT_BIT
 31

	)

102 
	#DIGIT_BIT
 28

	)

103 
	#MP_28BIT


	)

108 #iâdeà
CRYPT


110 #iâdeà
XMALLOC


111 
	#XMALLOC
 
m®loc


	)

112 
	#XFREE
 
ä“


	)

113 
	#XREALLOC
 
»®loc


	)

114 
	#XCALLOC
 
ÿÎoc


	)

117 *
XMALLOC
(
size_t
 
n
);

118 *
XREALLOC
(*
p
, 
size_t
 
n
);

119 *
XCALLOC
(
size_t
 
n
, size_ˆ
s
);

120 
XFREE
(*
p
);

126 #iâdeà
DIGIT_BIT


127 
	#DIGIT_BIT
 (()((
CHAR_BIT
 * (
mp_dig™
è- 1))è

	)

130 
	#MP_DIGIT_BIT
 
DIGIT_BIT


	)

131 
	#MP_MASK
 ((((
mp_dig™
)1)<<((mp_dig™)
DIGIT_BIT
))-((mp_dig™)1))

	)

132 
	#MP_DIGIT_MAX
 
MP_MASK


	)

135 
	#MP_LT
 -1

	)

136 
	#MP_EQ
 0

	)

137 
	#MP_GT
 1

	)

139 
	#MP_ZPOS
 0

	)

140 
	#MP_NEG
 1

	)

142 
	#MP_OKAY
 0

	)

143 
	#MP_MEM
 -2

	)

144 
	#MP_VAL
 -3

	)

145 
	#MP_RANGE
 
MP_VAL


	)

147 
	#MP_YES
 1

	)

148 
	#MP_NO
 0

	)

151 
	#LTM_PRIME_BBS
 0x0001

	)

152 
	#LTM_PRIME_SAFE
 0x0002

	)

153 
	#LTM_PRIME_2MSB_ON
 0x0008

	)

155 
	tmp_”r
;

158 
KARATSUBA_MUL_CUTOFF
,

159 
KARATSUBA_SQR_CUTOFF
,

160 
TOOM_MUL_CUTOFF
,

161 
TOOM_SQR_CUTOFF
;

167 #iâdeà
MP_PREC


168 #iâdeà
MP_LOW_MEM


169 
	#MP_PREC
 32

	)

171 
	#MP_PREC
 8

	)

176 
	#MP_WARRAY
 (1 << ((
mp_wÜd
è* 
CHAR_BIT
 - 2 * 
DIGIT_BIT
 + 1))

	)

180 
	gu£d
, 
	g®loc
, 
	gsign
;

181 
mp_dig™
 *
	gdp
;

182 } 
	tmp_št
;

185 
	tÉm_´ime_ÿÎback
(*
	td¡
, 
	tËn
, *
	td©
);

188 
	#USED
(
m
è((m)->
u£d
)

	)

189 
	#DIGIT
(
m
,
k
è((m)->
dp
[(k)])

	)

190 
	#SIGN
(
m
è((m)->
sign
)

	)

193 *
mp_”rÜ_to_¡ršg
(
code
);

197 
mp_š™
(
mp_št
 *
a
);

200 
mp_ş—r
(
mp_št
 *
a
);

203 
mp_š™_muÉi
(
mp_št
 *
mp
, ...);

206 
mp_ş—r_muÉi
(
mp_št
 *
mp
, ...);

209 
mp_exch
(
mp_št
 *
a
, mp_šˆ*
b
);

212 
mp_shršk
(
mp_št
 *
a
);

215 
mp_grow
(
mp_št
 *
a
, 
size
);

218 
mp_š™_size
(
mp_št
 *
a
, 
size
);

221 
	#mp_isz”o
(
a
è((×)->
u£d
 =ğ0è? 
MP_YES
 : 
MP_NO
)

	)

222 
	#mp_i£v’
(
a
è((×)->
u£d
 > 0 && ((×)->
dp
[0] & 1è=ğ0)è? 
MP_YES
 : 
MP_NO
)

	)

223 
	#mp_isodd
(
a
è((×)->
u£d
 > 0 && ((×)->
dp
[0] & 1è=ğ1)è? 
MP_YES
 : 
MP_NO
)

	)

226 
mp_z”o
(
mp_št
 *
a
);

229 
mp_£t
(
mp_št
 *
a
, 
mp_dig™
 
b
);

232 
mp_£t_št
(
mp_št
 *
a
, 
b
);

235 
mp_g‘_št
(
mp_št
 * 
a
);

238 
mp_š™_£t
 (
mp_št
 * 
a
, 
mp_dig™
 
b
);

241 
mp_š™_£t_št
 (
mp_št
 * 
a
, 
b
);

244 
mp_cİy
(
mp_št
 *
a
, mp_šˆ*
b
);

247 
mp_š™_cİy
(
mp_št
 *
a
, mp_šˆ*
b
);

250 
mp_şamp
(
mp_št
 *
a
);

255 
mp_rshd
(
mp_št
 *
a
, 
b
);

258 
mp_lshd
(
mp_št
 *
a
, 
b
);

261 
mp_div_2d
(
mp_št
 *
a
, 
b
, mp_šˆ*
c
, mp_šˆ*
d
);

264 
mp_div_2
(
mp_št
 *
a
, mp_šˆ*
b
);

267 
mp_mul_2d
(
mp_št
 *
a
, 
b
, mp_šˆ*
c
);

270 
mp_mul_2
(
mp_št
 *
a
, mp_šˆ*
b
);

273 
mp_mod_2d
(
mp_št
 *
a
, 
b
, mp_šˆ*
c
);

276 
mp_2ex±
(
mp_št
 *
a
, 
b
);

279 
mp_út_lsb
(
mp_št
 *
a
);

284 
mp_¿nd
(
mp_št
 *
a
, 
dig™s
);

288 
mp_xÜ
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

291 
mp_Ü
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

294 
mp_ªd
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

299 
mp_Ãg
(
mp_št
 *
a
, mp_šˆ*
b
);

302 
mp_abs
(
mp_št
 *
a
, mp_šˆ*
b
);

305 
mp_cmp
(
mp_št
 *
a
, mp_šˆ*
b
);

308 
mp_cmp_mag
(
mp_št
 *
a
, mp_šˆ*
b
);

311 
mp_add
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

314 
mp_sub
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

317 
mp_mul
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

320 
mp_sqr
(
mp_št
 *
a
, mp_šˆ*
b
);

323 
mp_div
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, mp_šˆ*
d
);

326 
mp_mod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

331 
mp_cmp_d
(
mp_št
 *
a
, 
mp_dig™
 
b
);

334 
mp_add_d
(
mp_št
 *
a
, 
mp_dig™
 
b
, mp_šˆ*
c
);

337 
mp_sub_d
(
mp_št
 *
a
, 
mp_dig™
 
b
, mp_šˆ*
c
);

340 
mp_mul_d
(
mp_št
 *
a
, 
mp_dig™
 
b
, mp_šˆ*
c
);

343 
mp_div_d
(
mp_št
 *
a
, 
mp_dig™
 
b
, mp_šˆ*
c
, mp_dig™ *
d
);

346 
mp_div_3
(
mp_št
 *
a
, mp_šˆ*
c
, 
mp_dig™
 *
d
);

349 
mp_ex±_d
(
mp_št
 *
a
, 
mp_dig™
 
b
, mp_šˆ*
c
);

352 
mp_mod_d
(
mp_št
 *
a
, 
mp_dig™
 
b
, mp_dig™ *
c
);

357 
mp_addmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, mp_šˆ*
d
);

360 
mp_submod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, mp_šˆ*
d
);

363 
mp_mulmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, mp_šˆ*
d
);

366 
mp_sqrmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

369 
mp_švmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

372 
mp_gcd
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

375 
mp_ex‹uşid
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
U1
, mp_šˆ*
U2
, mp_šˆ*
U3
);

378 
mp_lcm
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

384 
mp_n_roÙ
(
mp_št
 *
a
, 
mp_dig™
 
b
, mp_šˆ*
c
);

387 
mp_sq¹
(
mp_št
 *
¬g
, mp_šˆ*
»t
);

390 
mp_is_squ¬e
(
mp_št
 *
¬g
, *
»t
);

393 
mp_jacobi
(
mp_št
 *
a
, mp_šˆ*
n
, *
c
);

396 
mp_»duû_£tup
(
mp_št
 *
a
, mp_šˆ*
b
);

403 
mp_»duû
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

406 
mp_mÚtgom”y_£tup
(
mp_št
 *
a
, 
mp_dig™
 *
mp
);

411 
mp_mÚtgom”y_ÿlc_nÜm®iz©iÚ
(
mp_št
 *
a
, mp_šˆ*
b
);

414 
mp_mÚtgom”y_»duû
(
mp_št
 *
a
, mp_šˆ*
m
, 
mp_dig™
 
mp
);

417 
mp_dr_is_modulus
(
mp_št
 *
a
);

420 
mp_dr_£tup
(
mp_št
 *
a
, 
mp_dig™
 *
d
);

423 
mp_dr_»duû
(
mp_št
 *
a
, mp_šˆ*
b
, 
mp_dig™
 
mp
);

426 
mp_»duû_is_2k
(
mp_št
 *
a
);

429 
mp_»duû_2k_£tup
(
mp_št
 *
a
, 
mp_dig™
 *
d
);

432 
mp_»duû_2k
(
mp_št
 *
a
, mp_šˆ*
n
, 
mp_dig™
 
d
);

435 
mp_»duû_is_2k_l
(
mp_št
 *
a
);

438 
mp_»duû_2k_£tup_l
(
mp_št
 *
a
, mp_šˆ*
d
);

441 
mp_»duû_2k_l
(
mp_št
 *
a
, mp_šˆ*
n
, mp_šˆ*
d
);

444 
mp_ex±mod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, mp_šˆ*
d
);

449 #ifdeà
MP_8BIT


450 
	#PRIME_SIZE
 31

	)

452 
	#PRIME_SIZE
 256

	)

456 cÚ¡ 
mp_dig™
 
Ém_´ime_b
[];

459 
mp_´ime_is_divisibË
(
mp_št
 *
a
, *
»suÉ
);

464 
mp_´ime_ãrm©
(
mp_št
 *
a
, mp_šˆ*
b
, *
»suÉ
);

469 
mp_´ime_mËr_¿bš
(
mp_št
 *
a
, mp_šˆ*
b
, *
»suÉ
);

474 
mp_´ime_¿bš_mËr_ŒŸls
(
size
);

483 
mp_´ime_is_´ime
(
mp_št
 *
a
, 
t
, *
»suÉ
);

490 
mp_´ime_Ãxt_´ime
(
mp_št
 *
a
, 
t
, 
bbs_¡yË
);

501 
	#mp_´ime_¿ndom
(
a
, 
t
, 
size
, 
bbs
, 
cb
, 
d©
è
	`mp_´ime_¿ndom_ex
×,, ((sizeè* 8è+ 1, (bbs==1)?
LTM_PRIME_BBS
:0, cb, d©)

	)

517 
mp_´ime_¿ndom_ex
(
mp_št
 *
a
, 
t
, 
size
, 
æags
, 
Ém_´ime_ÿÎback
 
cb
, *
d©
);

520 
mp_couÁ_b™s
(
mp_št
 *
a
);

522 
mp_unsigÃd_bš_size
(
mp_št
 *
a
);

523 
mp_»ad_unsigÃd_bš
(
mp_št
 *
a
, cÚ¡ *
b
, 
c
);

524 
mp_to_unsigÃd_bš
(
mp_št
 *
a
, *
b
);

525 
mp_to_unsigÃd_bš_n
 (
mp_št
 * 
a
, *
b
, *
ou’
);

527 
mp_sigÃd_bš_size
(
mp_št
 *
a
);

528 
mp_»ad_sigÃd_bš
(
mp_št
 *
a
, cÚ¡ *
b
, 
c
);

529 
mp_to_sigÃd_bš
(
mp_št
 *
a
, *
b
);

530 
mp_to_sigÃd_bš_n
 (
mp_št
 * 
a
, *
b
, *
ou’
);

532 
mp_»ad_¿dix
(
mp_št
 *
a
, cÚ¡ *
¡r
, 
¿dix
);

533 
mp_tÜadix
(
mp_št
 *
a
, *
¡r
, 
¿dix
);

534 
mp_tÜadix_n
(
mp_št
 * 
a
, *
¡r
, 
¿dix
, 
maxËn
);

535 
mp_¿dix_size
(
mp_št
 *
a
, 
¿dix
, *
size
);

537 
mp_ä—d
(
mp_št
 *
a
, 
¿dix
, 
FILE
 *
¡»am
);

538 
mp_fwr™e
(
mp_št
 *
a
, 
¿dix
, 
FILE
 *
¡»am
);

540 
	#mp_»ad_¿w
(
mp
, 
¡r
, 
Ën
è
	`mp_»ad_sigÃd_bš
((mp), (¡r), (Ën))

	)

541 
	#mp_¿w_size
(
mp
è
	`mp_sigÃd_bš_size
(mp)

	)

542 
	#mp_tÜaw
(
mp
, 
¡r
è
	`mp_to_sigÃd_bš
((mp), (¡r))

	)

543 
	#mp_»ad_mag
(
mp
, 
¡r
, 
Ën
è
	`mp_»ad_unsigÃd_bš
((mp), (¡r), (Ën))

	)

544 
	#mp_mag_size
(
mp
è
	`mp_unsigÃd_bš_size
(mp)

	)

545 
	#mp_tomag
(
mp
, 
¡r
è
	`mp_to_unsigÃd_bš
((mp), (¡r))

	)

547 
	#mp_tobš¬y
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 2)

	)

548 
	#mp_tooù®
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 8)

	)

549 
	#mp_todecim®
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 10)

	)

550 
	#mp_tohex
(
M
, 
S
è
	`mp_tÜadix
((M), (S), 16)

	)

553 
s_mp_add
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

554 
s_mp_sub
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

555 
	#s_mp_mul
(
a
, 
b
, 
c
è
	`s_mp_mul_digs
×, b, c, (a)->
u£d
 + (b)->u£d + 1)

	)

556 
ç¡_s_mp_mul_digs
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, 
digs
);

557 
s_mp_mul_digs
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, 
digs
);

558 
ç¡_s_mp_mul_high_digs
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, 
digs
);

559 
s_mp_mul_high_digs
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
, 
digs
);

560 
ç¡_s_mp_sqr
(
mp_št
 *
a
, mp_šˆ*
b
);

561 
s_mp_sqr
(
mp_št
 *
a
, mp_šˆ*
b
);

562 
mp_k¬©suba_mul
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

563 
mp_toom_mul
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

564 
mp_k¬©suba_sqr
(
mp_št
 *
a
, mp_šˆ*
b
);

565 
mp_toom_sqr
(
mp_št
 *
a
, mp_šˆ*
b
);

566 
ç¡_mp_švmod
(
mp_št
 *
a
, mp_šˆ*
b
, mp_šˆ*
c
);

567 
mp_švmod_¦ow
 (
mp_št
 * 
a
, mp_šˆ* 
b
, mp_šˆ* 
c
);

568 
ç¡_mp_mÚtgom”y_»duû
(
mp_št
 *
a
, mp_šˆ*
m
, 
mp_dig™
 
mp
);

569 
mp_ex±mod_ç¡
(
mp_št
 *
G
, mp_šˆ*
X
, mp_šˆ*
P
, mp_šˆ*
Y
, 
mode
);

570 
s_mp_ex±mod
 (
mp_št
 * 
G
, mp_šˆ* 
X
, mp_šˆ* 
P
, mp_šˆ* 
Y
, 
mode
);

571 
bn_»v”£
(*
s
, 
Ën
);

573 cÚ¡ *
mp_s_rm­
;

575 #ifdeà
__ılu¥lus


	@libtommath/tommath_class.h

1 #ià!(
defšed
(
LTM1
è&& defšed(
LTM2
è&& defšed(
LTM3
))

2 #ià
defšed
(
LTM2
)

3 
	#LTM3


	)

5 #ià
defšed
(
LTM1
)

6 
	#LTM2


	)

8 
	#LTM1


	)

10 #ià
defšed
(
LTM_ALL
)

11 
	#BN_ERROR_C


	)

12 
	#BN_FAST_MP_INVMOD_C


	)

13 
	#BN_FAST_MP_MONTGOMERY_REDUCE_C


	)

14 
	#BN_FAST_S_MP_MUL_DIGS_C


	)

15 
	#BN_FAST_S_MP_MUL_HIGH_DIGS_C


	)

16 
	#BN_FAST_S_MP_SQR_C


	)

17 
	#BN_MP_2EXPT_C


	)

18 
	#BN_MP_ABS_C


	)

19 
	#BN_MP_ADD_C


	)

20 
	#BN_MP_ADD_D_C


	)

21 
	#BN_MP_ADDMOD_C


	)

22 
	#BN_MP_AND_C


	)

23 
	#BN_MP_CLAMP_C


	)

24 
	#BN_MP_CLEAR_C


	)

25 
	#BN_MP_CLEAR_MULTI_C


	)

26 
	#BN_MP_CMP_C


	)

27 
	#BN_MP_CMP_D_C


	)

28 
	#BN_MP_CMP_MAG_C


	)

29 
	#BN_MP_CNT_LSB_C


	)

30 
	#BN_MP_COPY_C


	)

31 
	#BN_MP_COUNT_BITS_C


	)

32 
	#BN_MP_DIV_C


	)

33 
	#BN_MP_DIV_2_C


	)

34 
	#BN_MP_DIV_2D_C


	)

35 
	#BN_MP_DIV_3_C


	)

36 
	#BN_MP_DIV_D_C


	)

37 
	#BN_MP_DR_IS_MODULUS_C


	)

38 
	#BN_MP_DR_REDUCE_C


	)

39 
	#BN_MP_DR_SETUP_C


	)

40 
	#BN_MP_EXCH_C


	)

41 
	#BN_MP_EXPT_D_C


	)

42 
	#BN_MP_EXPTMOD_C


	)

43 
	#BN_MP_EXPTMOD_FAST_C


	)

44 
	#BN_MP_EXTEUCLID_C


	)

45 
	#BN_MP_FREAD_C


	)

46 
	#BN_MP_FWRITE_C


	)

47 
	#BN_MP_GCD_C


	)

48 
	#BN_MP_GET_INT_C


	)

49 
	#BN_MP_GROW_C


	)

50 
	#BN_MP_INIT_C


	)

51 
	#BN_MP_INIT_COPY_C


	)

52 
	#BN_MP_INIT_MULTI_C


	)

53 
	#BN_MP_INIT_SET_C


	)

54 
	#BN_MP_INIT_SET_INT_C


	)

55 
	#BN_MP_INIT_SIZE_C


	)

56 
	#BN_MP_INVMOD_C


	)

57 
	#BN_MP_INVMOD_SLOW_C


	)

58 
	#BN_MP_IS_SQUARE_C


	)

59 
	#BN_MP_JACOBI_C


	)

60 
	#BN_MP_KARATSUBA_MUL_C


	)

61 
	#BN_MP_KARATSUBA_SQR_C


	)

62 
	#BN_MP_LCM_C


	)

63 
	#BN_MP_LSHD_C


	)

64 
	#BN_MP_MOD_C


	)

65 
	#BN_MP_MOD_2D_C


	)

66 
	#BN_MP_MOD_D_C


	)

67 
	#BN_MP_MONTGOMERY_CALC_NORMALIZATION_C


	)

68 
	#BN_MP_MONTGOMERY_REDUCE_C


	)

69 
	#BN_MP_MONTGOMERY_SETUP_C


	)

70 
	#BN_MP_MUL_C


	)

71 
	#BN_MP_MUL_2_C


	)

72 
	#BN_MP_MUL_2D_C


	)

73 
	#BN_MP_MUL_D_C


	)

74 
	#BN_MP_MULMOD_C


	)

75 
	#BN_MP_N_ROOT_C


	)

76 
	#BN_MP_NEG_C


	)

77 
	#BN_MP_OR_C


	)

78 
	#BN_MP_PRIME_FERMAT_C


	)

79 
	#BN_MP_PRIME_IS_DIVISIBLE_C


	)

80 
	#BN_MP_PRIME_IS_PRIME_C


	)

81 
	#BN_MP_PRIME_MILLER_RABIN_C


	)

82 
	#BN_MP_PRIME_NEXT_PRIME_C


	)

83 
	#BN_MP_PRIME_RABIN_MILLER_TRIALS_C


	)

84 
	#BN_MP_PRIME_RANDOM_EX_C


	)

85 
	#BN_MP_RADIX_SIZE_C


	)

86 
	#BN_MP_RADIX_SMAP_C


	)

87 
	#BN_MP_RAND_C


	)

88 
	#BN_MP_READ_RADIX_C


	)

89 
	#BN_MP_READ_SIGNED_BIN_C


	)

90 
	#BN_MP_READ_UNSIGNED_BIN_C


	)

91 
	#BN_MP_REDUCE_C


	)

92 
	#BN_MP_REDUCE_2K_C


	)

93 
	#BN_MP_REDUCE_2K_L_C


	)

94 
	#BN_MP_REDUCE_2K_SETUP_C


	)

95 
	#BN_MP_REDUCE_2K_SETUP_L_C


	)

96 
	#BN_MP_REDUCE_IS_2K_C


	)

97 
	#BN_MP_REDUCE_IS_2K_L_C


	)

98 
	#BN_MP_REDUCE_SETUP_C


	)

99 
	#BN_MP_RSHD_C


	)

100 
	#BN_MP_SET_C


	)

101 
	#BN_MP_SET_INT_C


	)

102 
	#BN_MP_SHRINK_C


	)

103 
	#BN_MP_SIGNED_BIN_SIZE_C


	)

104 
	#BN_MP_SQR_C


	)

105 
	#BN_MP_SQRMOD_C


	)

106 
	#BN_MP_SQRT_C


	)

107 
	#BN_MP_SUB_C


	)

108 
	#BN_MP_SUB_D_C


	)

109 
	#BN_MP_SUBMOD_C


	)

110 
	#BN_MP_TO_SIGNED_BIN_C


	)

111 
	#BN_MP_TO_SIGNED_BIN_N_C


	)

112 
	#BN_MP_TO_UNSIGNED_BIN_C


	)

113 
	#BN_MP_TO_UNSIGNED_BIN_N_C


	)

114 
	#BN_MP_TOOM_MUL_C


	)

115 
	#BN_MP_TOOM_SQR_C


	)

116 
	#BN_MP_TORADIX_C


	)

117 
	#BN_MP_TORADIX_N_C


	)

118 
	#BN_MP_UNSIGNED_BIN_SIZE_C


	)

119 
	#BN_MP_XOR_C


	)

120 
	#BN_MP_ZERO_C


	)

121 
	#BN_PRIME_TAB_C


	)

122 
	#BN_REVERSE_C


	)

123 
	#BN_S_MP_ADD_C


	)

124 
	#BN_S_MP_EXPTMOD_C


	)

125 
	#BN_S_MP_MUL_DIGS_C


	)

126 
	#BN_S_MP_MUL_HIGH_DIGS_C


	)

127 
	#BN_S_MP_SQR_C


	)

128 
	#BN_S_MP_SUB_C


	)

129 
	#BNCORE_C


	)

132 #ià
defšed
(
BN_ERROR_C
)

133 
	#BN_MP_ERROR_TO_STRING_C


	)

136 #ià
defšed
(
BN_FAST_MP_INVMOD_C
)

137 
	#BN_MP_ISEVEN_C


	)

138 
	#BN_MP_INIT_MULTI_C


	)

139 
	#BN_MP_COPY_C


	)

140 
	#BN_MP_MOD_C


	)

141 
	#BN_MP_SET_C


	)

142 
	#BN_MP_DIV_2_C


	)

143 
	#BN_MP_ISODD_C


	)

144 
	#BN_MP_SUB_C


	)

145 
	#BN_MP_CMP_C


	)

146 
	#BN_MP_ISZERO_C


	)

147 
	#BN_MP_CMP_D_C


	)

148 
	#BN_MP_ADD_C


	)

149 
	#BN_MP_EXCH_C


	)

150 
	#BN_MP_CLEAR_MULTI_C


	)

153 #ià
defšed
(
BN_FAST_MP_MONTGOMERY_REDUCE_C
)

154 
	#BN_MP_GROW_C


	)

155 
	#BN_MP_RSHD_C


	)

156 
	#BN_MP_CLAMP_C


	)

157 
	#BN_MP_CMP_MAG_C


	)

158 
	#BN_S_MP_SUB_C


	)

161 #ià
defšed
(
BN_FAST_S_MP_MUL_DIGS_C
)

162 
	#BN_MP_GROW_C


	)

163 
	#BN_MP_CLAMP_C


	)

166 #ià
defšed
(
BN_FAST_S_MP_MUL_HIGH_DIGS_C
)

167 
	#BN_MP_GROW_C


	)

168 
	#BN_MP_CLAMP_C


	)

171 #ià
defšed
(
BN_FAST_S_MP_SQR_C
)

172 
	#BN_MP_GROW_C


	)

173 
	#BN_MP_CLAMP_C


	)

176 #ià
defšed
(
BN_MP_2EXPT_C
)

177 
	#BN_MP_ZERO_C


	)

178 
	#BN_MP_GROW_C


	)

181 #ià
defšed
(
BN_MP_ABS_C
)

182 
	#BN_MP_COPY_C


	)

185 #ià
defšed
(
BN_MP_ADD_C
)

186 
	#BN_S_MP_ADD_C


	)

187 
	#BN_MP_CMP_MAG_C


	)

188 
	#BN_S_MP_SUB_C


	)

191 #ià
defšed
(
BN_MP_ADD_D_C
)

192 
	#BN_MP_GROW_C


	)

193 
	#BN_MP_SUB_D_C


	)

194 
	#BN_MP_CLAMP_C


	)

197 #ià
defšed
(
BN_MP_ADDMOD_C
)

198 
	#BN_MP_INIT_C


	)

199 
	#BN_MP_ADD_C


	)

200 
	#BN_MP_CLEAR_C


	)

201 
	#BN_MP_MOD_C


	)

204 #ià
defšed
(
BN_MP_AND_C
)

205 
	#BN_MP_INIT_COPY_C


	)

206 
	#BN_MP_CLAMP_C


	)

207 
	#BN_MP_EXCH_C


	)

208 
	#BN_MP_CLEAR_C


	)

211 #ià
defšed
(
BN_MP_CLAMP_C
)

214 #ià
defšed
(
BN_MP_CLEAR_C
)

217 #ià
defšed
(
BN_MP_CLEAR_MULTI_C
)

218 
	#BN_MP_CLEAR_C


	)

221 #ià
defšed
(
BN_MP_CMP_C
)

222 
	#BN_MP_CMP_MAG_C


	)

225 #ià
defšed
(
BN_MP_CMP_D_C
)

228 #ià
defšed
(
BN_MP_CMP_MAG_C
)

231 #ià
defšed
(
BN_MP_CNT_LSB_C
)

232 
	#BN_MP_ISZERO_C


	)

235 #ià
defšed
(
BN_MP_COPY_C
)

236 
	#BN_MP_GROW_C


	)

239 #ià
defšed
(
BN_MP_COUNT_BITS_C
)

242 #ià
defšed
(
BN_MP_DIV_C
)

243 
	#BN_MP_ISZERO_C


	)

244 
	#BN_MP_CMP_MAG_C


	)

245 
	#BN_MP_COPY_C


	)

246 
	#BN_MP_ZERO_C


	)

247 
	#BN_MP_INIT_MULTI_C


	)

248 
	#BN_MP_SET_C


	)

249 
	#BN_MP_COUNT_BITS_C


	)

250 
	#BN_MP_ABS_C


	)

251 
	#BN_MP_MUL_2D_C


	)

252 
	#BN_MP_CMP_C


	)

253 
	#BN_MP_SUB_C


	)

254 
	#BN_MP_ADD_C


	)

255 
	#BN_MP_DIV_2D_C


	)

256 
	#BN_MP_EXCH_C


	)

257 
	#BN_MP_CLEAR_MULTI_C


	)

258 
	#BN_MP_INIT_SIZE_C


	)

259 
	#BN_MP_INIT_C


	)

260 
	#BN_MP_INIT_COPY_C


	)

261 
	#BN_MP_LSHD_C


	)

262 
	#BN_MP_RSHD_C


	)

263 
	#BN_MP_MUL_D_C


	)

264 
	#BN_MP_CLAMP_C


	)

265 
	#BN_MP_CLEAR_C


	)

268 #ià
defšed
(
BN_MP_DIV_2_C
)

269 
	#BN_MP_GROW_C


	)

270 
	#BN_MP_CLAMP_C


	)

273 #ià
defšed
(
BN_MP_DIV_2D_C
)

274 
	#BN_MP_COPY_C


	)

275 
	#BN_MP_ZERO_C


	)

276 
	#BN_MP_INIT_C


	)

277 
	#BN_MP_MOD_2D_C


	)

278 
	#BN_MP_CLEAR_C


	)

279 
	#BN_MP_RSHD_C


	)

280 
	#BN_MP_CLAMP_C


	)

281 
	#BN_MP_EXCH_C


	)

284 #ià
defšed
(
BN_MP_DIV_3_C
)

285 
	#BN_MP_INIT_SIZE_C


	)

286 
	#BN_MP_CLAMP_C


	)

287 
	#BN_MP_EXCH_C


	)

288 
	#BN_MP_CLEAR_C


	)

291 #ià
defšed
(
BN_MP_DIV_D_C
)

292 
	#BN_MP_ISZERO_C


	)

293 
	#BN_MP_COPY_C


	)

294 
	#BN_MP_DIV_2D_C


	)

295 
	#BN_MP_DIV_3_C


	)

296 
	#BN_MP_INIT_SIZE_C


	)

297 
	#BN_MP_CLAMP_C


	)

298 
	#BN_MP_EXCH_C


	)

299 
	#BN_MP_CLEAR_C


	)

302 #ià
defšed
(
BN_MP_DR_IS_MODULUS_C
)

305 #ià
defšed
(
BN_MP_DR_REDUCE_C
)

306 
	#BN_MP_GROW_C


	)

307 
	#BN_MP_CLAMP_C


	)

308 
	#BN_MP_CMP_MAG_C


	)

309 
	#BN_S_MP_SUB_C


	)

312 #ià
defšed
(
BN_MP_DR_SETUP_C
)

315 #ià
defšed
(
BN_MP_EXCH_C
)

318 #ià
defšed
(
BN_MP_EXPT_D_C
)

319 
	#BN_MP_INIT_COPY_C


	)

320 
	#BN_MP_SET_C


	)

321 
	#BN_MP_SQR_C


	)

322 
	#BN_MP_CLEAR_C


	)

323 
	#BN_MP_MUL_C


	)

326 #ià
defšed
(
BN_MP_EXPTMOD_C
)

327 
	#BN_MP_INIT_C


	)

328 
	#BN_MP_INVMOD_C


	)

329 
	#BN_MP_CLEAR_C


	)

330 
	#BN_MP_ABS_C


	)

331 
	#BN_MP_CLEAR_MULTI_C


	)

332 
	#BN_MP_REDUCE_IS_2K_L_C


	)

333 
	#BN_S_MP_EXPTMOD_C


	)

334 
	#BN_MP_DR_IS_MODULUS_C


	)

335 
	#BN_MP_REDUCE_IS_2K_C


	)

336 
	#BN_MP_ISODD_C


	)

337 
	#BN_MP_EXPTMOD_FAST_C


	)

340 #ià
defšed
(
BN_MP_EXPTMOD_FAST_C
)

341 
	#BN_MP_COUNT_BITS_C


	)

342 
	#BN_MP_INIT_C


	)

343 
	#BN_MP_CLEAR_C


	)

344 
	#BN_MP_MONTGOMERY_SETUP_C


	)

345 
	#BN_FAST_MP_MONTGOMERY_REDUCE_C


	)

346 
	#BN_MP_MONTGOMERY_REDUCE_C


	)

347 
	#BN_MP_DR_SETUP_C


	)

348 
	#BN_MP_DR_REDUCE_C


	)

349 
	#BN_MP_REDUCE_2K_SETUP_C


	)

350 
	#BN_MP_REDUCE_2K_C


	)

351 
	#BN_MP_MONTGOMERY_CALC_NORMALIZATION_C


	)

352 
	#BN_MP_MULMOD_C


	)

353 
	#BN_MP_SET_C


	)

354 
	#BN_MP_MOD_C


	)

355 
	#BN_MP_COPY_C


	)

356 
	#BN_MP_SQR_C


	)

357 
	#BN_MP_MUL_C


	)

358 
	#BN_MP_EXCH_C


	)

361 #ià
defšed
(
BN_MP_EXTEUCLID_C
)

362 
	#BN_MP_INIT_MULTI_C


	)

363 
	#BN_MP_SET_C


	)

364 
	#BN_MP_COPY_C


	)

365 
	#BN_MP_ISZERO_C


	)

366 
	#BN_MP_DIV_C


	)

367 
	#BN_MP_MUL_C


	)

368 
	#BN_MP_SUB_C


	)

369 
	#BN_MP_NEG_C


	)

370 
	#BN_MP_EXCH_C


	)

371 
	#BN_MP_CLEAR_MULTI_C


	)

374 #ià
defšed
(
BN_MP_FREAD_C
)

375 
	#BN_MP_ZERO_C


	)

376 
	#BN_MP_S_RMAP_C


	)

377 
	#BN_MP_MUL_D_C


	)

378 
	#BN_MP_ADD_D_C


	)

379 
	#BN_MP_CMP_D_C


	)

382 #ià
defšed
(
BN_MP_FWRITE_C
)

383 
	#BN_MP_RADIX_SIZE_C


	)

384 
	#BN_MP_TORADIX_C


	)

387 #ià
defšed
(
BN_MP_GCD_C
)

388 
	#BN_MP_ISZERO_C


	)

389 
	#BN_MP_ABS_C


	)

390 
	#BN_MP_ZERO_C


	)

391 
	#BN_MP_INIT_COPY_C


	)

392 
	#BN_MP_CNT_LSB_C


	)

393 
	#BN_MP_DIV_2D_C


	)

394 
	#BN_MP_CMP_MAG_C


	)

395 
	#BN_MP_EXCH_C


	)

396 
	#BN_S_MP_SUB_C


	)

397 
	#BN_MP_MUL_2D_C


	)

398 
	#BN_MP_CLEAR_C


	)

401 #ià
defšed
(
BN_MP_GET_INT_C
)

404 #ià
defšed
(
BN_MP_GROW_C
)

407 #ià
defšed
(
BN_MP_INIT_C
)

410 #ià
defšed
(
BN_MP_INIT_COPY_C
)

411 
	#BN_MP_COPY_C


	)

414 #ià
defšed
(
BN_MP_INIT_MULTI_C
)

415 
	#BN_MP_ERR_C


	)

416 
	#BN_MP_INIT_C


	)

417 
	#BN_MP_CLEAR_C


	)

420 #ià
defšed
(
BN_MP_INIT_SET_C
)

421 
	#BN_MP_INIT_C


	)

422 
	#BN_MP_SET_C


	)

425 #ià
defšed
(
BN_MP_INIT_SET_INT_C
)

426 
	#BN_MP_INIT_C


	)

427 
	#BN_MP_SET_INT_C


	)

430 #ià
defšed
(
BN_MP_INIT_SIZE_C
)

431 
	#BN_MP_INIT_C


	)

434 #ià
defšed
(
BN_MP_INVMOD_C
)

435 
	#BN_MP_ISZERO_C


	)

436 
	#BN_MP_ISODD_C


	)

437 
	#BN_FAST_MP_INVMOD_C


	)

438 
	#BN_MP_INVMOD_SLOW_C


	)

441 #ià
defšed
(
BN_MP_INVMOD_SLOW_C
)

442 
	#BN_MP_ISZERO_C


	)

443 
	#BN_MP_INIT_MULTI_C


	)

444 
	#BN_MP_MOD_C


	)

445 
	#BN_MP_COPY_C


	)

446 
	#BN_MP_ISEVEN_C


	)

447 
	#BN_MP_SET_C


	)

448 
	#BN_MP_DIV_2_C


	)

449 
	#BN_MP_ISODD_C


	)

450 
	#BN_MP_ADD_C


	)

451 
	#BN_MP_SUB_C


	)

452 
	#BN_MP_CMP_C


	)

453 
	#BN_MP_CMP_D_C


	)

454 
	#BN_MP_CMP_MAG_C


	)

455 
	#BN_MP_EXCH_C


	)

456 
	#BN_MP_CLEAR_MULTI_C


	)

459 #ià
defšed
(
BN_MP_IS_SQUARE_C
)

460 
	#BN_MP_MOD_D_C


	)

461 
	#BN_MP_INIT_SET_INT_C


	)

462 
	#BN_MP_MOD_C


	)

463 
	#BN_MP_GET_INT_C


	)

464 
	#BN_MP_SQRT_C


	)

465 
	#BN_MP_SQR_C


	)

466 
	#BN_MP_CMP_MAG_C


	)

467 
	#BN_MP_CLEAR_C


	)

470 #ià
defšed
(
BN_MP_JACOBI_C
)

471 
	#BN_MP_CMP_D_C


	)

472 
	#BN_MP_ISZERO_C


	)

473 
	#BN_MP_INIT_COPY_C


	)

474 
	#BN_MP_CNT_LSB_C


	)

475 
	#BN_MP_DIV_2D_C


	)

476 
	#BN_MP_MOD_C


	)

477 
	#BN_MP_CLEAR_C


	)

480 #ià
defšed
(
BN_MP_KARATSUBA_MUL_C
)

481 
	#BN_MP_MUL_C


	)

482 
	#BN_MP_INIT_SIZE_C


	)

483 
	#BN_MP_CLAMP_C


	)

484 
	#BN_MP_SUB_C


	)

485 
	#BN_MP_ADD_C


	)

486 
	#BN_MP_LSHD_C


	)

487 
	#BN_MP_CLEAR_C


	)

490 #ià
defšed
(
BN_MP_KARATSUBA_SQR_C
)

491 
	#BN_MP_INIT_SIZE_C


	)

492 
	#BN_MP_CLAMP_C


	)

493 
	#BN_MP_SQR_C


	)

494 
	#BN_MP_SUB_C


	)

495 
	#BN_S_MP_ADD_C


	)

496 
	#BN_MP_LSHD_C


	)

497 
	#BN_MP_ADD_C


	)

498 
	#BN_MP_CLEAR_C


	)

501 #ià
defšed
(
BN_MP_LCM_C
)

502 
	#BN_MP_INIT_MULTI_C


	)

503 
	#BN_MP_GCD_C


	)

504 
	#BN_MP_CMP_MAG_C


	)

505 
	#BN_MP_DIV_C


	)

506 
	#BN_MP_MUL_C


	)

507 
	#BN_MP_CLEAR_MULTI_C


	)

510 #ià
defšed
(
BN_MP_LSHD_C
)

511 
	#BN_MP_GROW_C


	)

512 
	#BN_MP_RSHD_C


	)

515 #ià
defšed
(
BN_MP_MOD_C
)

516 
	#BN_MP_INIT_C


	)

517 
	#BN_MP_DIV_C


	)

518 
	#BN_MP_CLEAR_C


	)

519 
	#BN_MP_ADD_C


	)

520 
	#BN_MP_EXCH_C


	)

523 #ià
defšed
(
BN_MP_MOD_2D_C
)

524 
	#BN_MP_ZERO_C


	)

525 
	#BN_MP_COPY_C


	)

526 
	#BN_MP_CLAMP_C


	)

529 #ià
defšed
(
BN_MP_MOD_D_C
)

530 
	#BN_MP_DIV_D_C


	)

533 #ià
defšed
(
BN_MP_MONTGOMERY_CALC_NORMALIZATION_C
)

534 
	#BN_MP_COUNT_BITS_C


	)

535 
	#BN_MP_2EXPT_C


	)

536 
	#BN_MP_SET_C


	)

537 
	#BN_MP_MUL_2_C


	)

538 
	#BN_MP_CMP_MAG_C


	)

539 
	#BN_S_MP_SUB_C


	)

542 #ià
defšed
(
BN_MP_MONTGOMERY_REDUCE_C
)

543 
	#BN_FAST_MP_MONTGOMERY_REDUCE_C


	)

544 
	#BN_MP_GROW_C


	)

545 
	#BN_MP_CLAMP_C


	)

546 
	#BN_MP_RSHD_C


	)

547 
	#BN_MP_CMP_MAG_C


	)

548 
	#BN_S_MP_SUB_C


	)

551 #ià
defšed
(
BN_MP_MONTGOMERY_SETUP_C
)

554 #ià
defšed
(
BN_MP_MUL_C
)

555 
	#BN_MP_TOOM_MUL_C


	)

556 
	#BN_MP_KARATSUBA_MUL_C


	)

557 
	#BN_FAST_S_MP_MUL_DIGS_C


	)

558 
	#BN_S_MP_MUL_C


	)

559 
	#BN_S_MP_MUL_DIGS_C


	)

562 #ià
defšed
(
BN_MP_MUL_2_C
)

563 
	#BN_MP_GROW_C


	)

566 #ià
defšed
(
BN_MP_MUL_2D_C
)

567 
	#BN_MP_COPY_C


	)

568 
	#BN_MP_GROW_C


	)

569 
	#BN_MP_LSHD_C


	)

570 
	#BN_MP_CLAMP_C


	)

573 #ià
defšed
(
BN_MP_MUL_D_C
)

574 
	#BN_MP_GROW_C


	)

575 
	#BN_MP_CLAMP_C


	)

578 #ià
defšed
(
BN_MP_MULMOD_C
)

579 
	#BN_MP_INIT_C


	)

580 
	#BN_MP_MUL_C


	)

581 
	#BN_MP_CLEAR_C


	)

582 
	#BN_MP_MOD_C


	)

585 #ià
defšed
(
BN_MP_N_ROOT_C
)

586 
	#BN_MP_INIT_C


	)

587 
	#BN_MP_SET_C


	)

588 
	#BN_MP_COPY_C


	)

589 
	#BN_MP_EXPT_D_C


	)

590 
	#BN_MP_MUL_C


	)

591 
	#BN_MP_SUB_C


	)

592 
	#BN_MP_MUL_D_C


	)

593 
	#BN_MP_DIV_C


	)

594 
	#BN_MP_CMP_C


	)

595 
	#BN_MP_SUB_D_C


	)

596 
	#BN_MP_EXCH_C


	)

597 
	#BN_MP_CLEAR_C


	)

600 #ià
defšed
(
BN_MP_NEG_C
)

601 
	#BN_MP_COPY_C


	)

602 
	#BN_MP_ISZERO_C


	)

605 #ià
defšed
(
BN_MP_OR_C
)

606 
	#BN_MP_INIT_COPY_C


	)

607 
	#BN_MP_CLAMP_C


	)

608 
	#BN_MP_EXCH_C


	)

609 
	#BN_MP_CLEAR_C


	)

612 #ià
defšed
(
BN_MP_PRIME_FERMAT_C
)

613 
	#BN_MP_CMP_D_C


	)

614 
	#BN_MP_INIT_C


	)

615 
	#BN_MP_EXPTMOD_C


	)

616 
	#BN_MP_CMP_C


	)

617 
	#BN_MP_CLEAR_C


	)

620 #ià
defšed
(
BN_MP_PRIME_IS_DIVISIBLE_C
)

621 
	#BN_MP_MOD_D_C


	)

624 #ià
defšed
(
BN_MP_PRIME_IS_PRIME_C
)

625 
	#BN_MP_CMP_D_C


	)

626 
	#BN_MP_PRIME_IS_DIVISIBLE_C


	)

627 
	#BN_MP_INIT_C


	)

628 
	#BN_MP_SET_C


	)

629 
	#BN_MP_PRIME_MILLER_RABIN_C


	)

630 
	#BN_MP_CLEAR_C


	)

633 #ià
defšed
(
BN_MP_PRIME_MILLER_RABIN_C
)

634 
	#BN_MP_CMP_D_C


	)

635 
	#BN_MP_INIT_COPY_C


	)

636 
	#BN_MP_SUB_D_C


	)

637 
	#BN_MP_CNT_LSB_C


	)

638 
	#BN_MP_DIV_2D_C


	)

639 
	#BN_MP_EXPTMOD_C


	)

640 
	#BN_MP_CMP_C


	)

641 
	#BN_MP_SQRMOD_C


	)

642 
	#BN_MP_CLEAR_C


	)

645 #ià
defšed
(
BN_MP_PRIME_NEXT_PRIME_C
)

646 
	#BN_MP_CMP_D_C


	)

647 
	#BN_MP_SET_C


	)

648 
	#BN_MP_SUB_D_C


	)

649 
	#BN_MP_ISEVEN_C


	)

650 
	#BN_MP_MOD_D_C


	)

651 
	#BN_MP_INIT_C


	)

652 
	#BN_MP_ADD_D_C


	)

653 
	#BN_MP_PRIME_MILLER_RABIN_C


	)

654 
	#BN_MP_CLEAR_C


	)

657 #ià
defšed
(
BN_MP_PRIME_RABIN_MILLER_TRIALS_C
)

660 #ià
defšed
(
BN_MP_PRIME_RANDOM_EX_C
)

661 
	#BN_MP_READ_UNSIGNED_BIN_C


	)

662 
	#BN_MP_PRIME_IS_PRIME_C


	)

663 
	#BN_MP_SUB_D_C


	)

664 
	#BN_MP_DIV_2_C


	)

665 
	#BN_MP_MUL_2_C


	)

666 
	#BN_MP_ADD_D_C


	)

669 #ià
defšed
(
BN_MP_RADIX_SIZE_C
)

670 
	#BN_MP_COUNT_BITS_C


	)

671 
	#BN_MP_INIT_COPY_C


	)

672 
	#BN_MP_ISZERO_C


	)

673 
	#BN_MP_DIV_D_C


	)

674 
	#BN_MP_CLEAR_C


	)

677 #ià
defšed
(
BN_MP_RADIX_SMAP_C
)

678 
	#BN_MP_S_RMAP_C


	)

681 #ià
defšed
(
BN_MP_RAND_C
)

682 
	#BN_MP_ZERO_C


	)

683 
	#BN_MP_ADD_D_C


	)

684 
	#BN_MP_LSHD_C


	)

687 #ià
defšed
(
BN_MP_READ_RADIX_C
)

688 
	#BN_MP_ZERO_C


	)

689 
	#BN_MP_S_RMAP_C


	)

690 
	#BN_MP_RADIX_SMAP_C


	)

691 
	#BN_MP_MUL_D_C


	)

692 
	#BN_MP_ADD_D_C


	)

693 
	#BN_MP_ISZERO_C


	)

696 #ià
defšed
(
BN_MP_READ_SIGNED_BIN_C
)

697 
	#BN_MP_READ_UNSIGNED_BIN_C


	)

700 #ià
defšed
(
BN_MP_READ_UNSIGNED_BIN_C
)

701 
	#BN_MP_GROW_C


	)

702 
	#BN_MP_ZERO_C


	)

703 
	#BN_MP_MUL_2D_C


	)

704 
	#BN_MP_CLAMP_C


	)

707 #ià
defšed
(
BN_MP_REDUCE_C
)

708 
	#BN_MP_REDUCE_SETUP_C


	)

709 
	#BN_MP_INIT_COPY_C


	)

710 
	#BN_MP_RSHD_C


	)

711 
	#BN_MP_MUL_C


	)

712 
	#BN_S_MP_MUL_HIGH_DIGS_C


	)

713 
	#BN_FAST_S_MP_MUL_HIGH_DIGS_C


	)

714 
	#BN_MP_MOD_2D_C


	)

715 
	#BN_S_MP_MUL_DIGS_C


	)

716 
	#BN_MP_SUB_C


	)

717 
	#BN_MP_CMP_D_C


	)

718 
	#BN_MP_SET_C


	)

719 
	#BN_MP_LSHD_C


	)

720 
	#BN_MP_ADD_C


	)

721 
	#BN_MP_CMP_C


	)

722 
	#BN_S_MP_SUB_C


	)

723 
	#BN_MP_CLEAR_C


	)

726 #ià
defšed
(
BN_MP_REDUCE_2K_C
)

727 
	#BN_MP_INIT_C


	)

728 
	#BN_MP_COUNT_BITS_C


	)

729 
	#BN_MP_DIV_2D_C


	)

730 
	#BN_MP_MUL_D_C


	)

731 
	#BN_S_MP_ADD_C


	)

732 
	#BN_MP_CMP_MAG_C


	)

733 
	#BN_S_MP_SUB_C


	)

734 
	#BN_MP_CLEAR_C


	)

737 #ià
defšed
(
BN_MP_REDUCE_2K_L_C
)

738 
	#BN_MP_INIT_C


	)

739 
	#BN_MP_COUNT_BITS_C


	)

740 
	#BN_MP_DIV_2D_C


	)

741 
	#BN_MP_MUL_C


	)

742 
	#BN_S_MP_ADD_C


	)

743 
	#BN_MP_CMP_MAG_C


	)

744 
	#BN_S_MP_SUB_C


	)

745 
	#BN_MP_CLEAR_C


	)

748 #ià
defšed
(
BN_MP_REDUCE_2K_SETUP_C
)

749 
	#BN_MP_INIT_C


	)

750 
	#BN_MP_COUNT_BITS_C


	)

751 
	#BN_MP_2EXPT_C


	)

752 
	#BN_MP_CLEAR_C


	)

753 
	#BN_S_MP_SUB_C


	)

756 #ià
defšed
(
BN_MP_REDUCE_2K_SETUP_L_C
)

757 
	#BN_MP_INIT_C


	)

758 
	#BN_MP_2EXPT_C


	)

759 
	#BN_MP_COUNT_BITS_C


	)

760 
	#BN_S_MP_SUB_C


	)

761 
	#BN_MP_CLEAR_C


	)

764 #ià
defšed
(
BN_MP_REDUCE_IS_2K_C
)

765 
	#BN_MP_REDUCE_2K_C


	)

766 
	#BN_MP_COUNT_BITS_C


	)

769 #ià
defšed
(
BN_MP_REDUCE_IS_2K_L_C
)

772 #ià
defšed
(
BN_MP_REDUCE_SETUP_C
)

773 
	#BN_MP_2EXPT_C


	)

774 
	#BN_MP_DIV_C


	)

777 #ià
defšed
(
BN_MP_RSHD_C
)

778 
	#BN_MP_ZERO_C


	)

781 #ià
defšed
(
BN_MP_SET_C
)

782 
	#BN_MP_ZERO_C


	)

785 #ià
defšed
(
BN_MP_SET_INT_C
)

786 
	#BN_MP_ZERO_C


	)

787 
	#BN_MP_MUL_2D_C


	)

788 
	#BN_MP_CLAMP_C


	)

791 #ià
defšed
(
BN_MP_SHRINK_C
)

794 #ià
defšed
(
BN_MP_SIGNED_BIN_SIZE_C
)

795 
	#BN_MP_UNSIGNED_BIN_SIZE_C


	)

798 #ià
defšed
(
BN_MP_SQR_C
)

799 
	#BN_MP_TOOM_SQR_C


	)

800 
	#BN_MP_KARATSUBA_SQR_C


	)

801 
	#BN_FAST_S_MP_SQR_C


	)

802 
	#BN_S_MP_SQR_C


	)

805 #ià
defšed
(
BN_MP_SQRMOD_C
)

806 
	#BN_MP_INIT_C


	)

807 
	#BN_MP_SQR_C


	)

808 
	#BN_MP_CLEAR_C


	)

809 
	#BN_MP_MOD_C


	)

812 #ià
defšed
(
BN_MP_SQRT_C
)

813 
	#BN_MP_N_ROOT_C


	)

814 
	#BN_MP_ISZERO_C


	)

815 
	#BN_MP_ZERO_C


	)

816 
	#BN_MP_INIT_COPY_C


	)

817 
	#BN_MP_RSHD_C


	)

818 
	#BN_MP_DIV_C


	)

819 
	#BN_MP_ADD_C


	)

820 
	#BN_MP_DIV_2_C


	)

821 
	#BN_MP_CMP_MAG_C


	)

822 
	#BN_MP_EXCH_C


	)

823 
	#BN_MP_CLEAR_C


	)

826 #ià
defšed
(
BN_MP_SUB_C
)

827 
	#BN_S_MP_ADD_C


	)

828 
	#BN_MP_CMP_MAG_C


	)

829 
	#BN_S_MP_SUB_C


	)

832 #ià
defšed
(
BN_MP_SUB_D_C
)

833 
	#BN_MP_GROW_C


	)

834 
	#BN_MP_ADD_D_C


	)

835 
	#BN_MP_CLAMP_C


	)

838 #ià
defšed
(
BN_MP_SUBMOD_C
)

839 
	#BN_MP_INIT_C


	)

840 
	#BN_MP_SUB_C


	)

841 
	#BN_MP_CLEAR_C


	)

842 
	#BN_MP_MOD_C


	)

845 #ià
defšed
(
BN_MP_TO_SIGNED_BIN_C
)

846 
	#BN_MP_TO_UNSIGNED_BIN_C


	)

849 #ià
defšed
(
BN_MP_TO_SIGNED_BIN_N_C
)

850 
	#BN_MP_SIGNED_BIN_SIZE_C


	)

851 
	#BN_MP_TO_SIGNED_BIN_C


	)

854 #ià
defšed
(
BN_MP_TO_UNSIGNED_BIN_C
)

855 
	#BN_MP_INIT_COPY_C


	)

856 
	#BN_MP_ISZERO_C


	)

857 
	#BN_MP_DIV_2D_C


	)

858 
	#BN_MP_CLEAR_C


	)

861 #ià
defšed
(
BN_MP_TO_UNSIGNED_BIN_N_C
)

862 
	#BN_MP_UNSIGNED_BIN_SIZE_C


	)

863 
	#BN_MP_TO_UNSIGNED_BIN_C


	)

866 #ià
defšed
(
BN_MP_TOOM_MUL_C
)

867 
	#BN_MP_INIT_MULTI_C


	)

868 
	#BN_MP_MOD_2D_C


	)

869 
	#BN_MP_COPY_C


	)

870 
	#BN_MP_RSHD_C


	)

871 
	#BN_MP_MUL_C


	)

872 
	#BN_MP_MUL_2_C


	)

873 
	#BN_MP_ADD_C


	)

874 
	#BN_MP_SUB_C


	)

875 
	#BN_MP_DIV_2_C


	)

876 
	#BN_MP_MUL_2D_C


	)

877 
	#BN_MP_MUL_D_C


	)

878 
	#BN_MP_DIV_3_C


	)

879 
	#BN_MP_LSHD_C


	)

880 
	#BN_MP_CLEAR_MULTI_C


	)

883 #ià
defšed
(
BN_MP_TOOM_SQR_C
)

884 
	#BN_MP_INIT_MULTI_C


	)

885 
	#BN_MP_MOD_2D_C


	)

886 
	#BN_MP_COPY_C


	)

887 
	#BN_MP_RSHD_C


	)

888 
	#BN_MP_SQR_C


	)

889 
	#BN_MP_MUL_2_C


	)

890 
	#BN_MP_ADD_C


	)

891 
	#BN_MP_SUB_C


	)

892 
	#BN_MP_DIV_2_C


	)

893 
	#BN_MP_MUL_2D_C


	)

894 
	#BN_MP_MUL_D_C


	)

895 
	#BN_MP_DIV_3_C


	)

896 
	#BN_MP_LSHD_C


	)

897 
	#BN_MP_CLEAR_MULTI_C


	)

900 #ià
defšed
(
BN_MP_TORADIX_C
)

901 
	#BN_MP_ISZERO_C


	)

902 
	#BN_MP_INIT_COPY_C


	)

903 
	#BN_MP_DIV_D_C


	)

904 
	#BN_MP_CLEAR_C


	)

905 
	#BN_MP_S_RMAP_C


	)

908 #ià
defšed
(
BN_MP_TORADIX_N_C
)

909 
	#BN_MP_ISZERO_C


	)

910 
	#BN_MP_INIT_COPY_C


	)

911 
	#BN_MP_DIV_D_C


	)

912 
	#BN_MP_CLEAR_C


	)

913 
	#BN_MP_S_RMAP_C


	)

916 #ià
defšed
(
BN_MP_UNSIGNED_BIN_SIZE_C
)

917 
	#BN_MP_COUNT_BITS_C


	)

920 #ià
defšed
(
BN_MP_XOR_C
)

921 
	#BN_MP_INIT_COPY_C


	)

922 
	#BN_MP_CLAMP_C


	)

923 
	#BN_MP_EXCH_C


	)

924 
	#BN_MP_CLEAR_C


	)

927 #ià
defšed
(
BN_MP_ZERO_C
)

930 #ià
defšed
(
BN_PRIME_TAB_C
)

933 #ià
defšed
(
BN_REVERSE_C
)

936 #ià
defšed
(
BN_S_MP_ADD_C
)

937 
	#BN_MP_GROW_C


	)

938 
	#BN_MP_CLAMP_C


	)

941 #ià
defšed
(
BN_S_MP_EXPTMOD_C
)

942 
	#BN_MP_COUNT_BITS_C


	)

943 
	#BN_MP_INIT_C


	)

944 
	#BN_MP_CLEAR_C


	)

945 
	#BN_MP_REDUCE_SETUP_C


	)

946 
	#BN_MP_REDUCE_C


	)

947 
	#BN_MP_REDUCE_2K_SETUP_L_C


	)

948 
	#BN_MP_REDUCE_2K_L_C


	)

949 
	#BN_MP_MOD_C


	)

950 
	#BN_MP_COPY_C


	)

951 
	#BN_MP_SQR_C


	)

952 
	#BN_MP_MUL_C


	)

953 
	#BN_MP_SET_C


	)

954 
	#BN_MP_EXCH_C


	)

957 #ià
defšed
(
BN_S_MP_MUL_DIGS_C
)

958 
	#BN_FAST_S_MP_MUL_DIGS_C


	)

959 
	#BN_MP_INIT_SIZE_C


	)

960 
	#BN_MP_CLAMP_C


	)

961 
	#BN_MP_EXCH_C


	)

962 
	#BN_MP_CLEAR_C


	)

965 #ià
defšed
(
BN_S_MP_MUL_HIGH_DIGS_C
)

966 
	#BN_FAST_S_MP_MUL_HIGH_DIGS_C


	)

967 
	#BN_MP_INIT_SIZE_C


	)

968 
	#BN_MP_CLAMP_C


	)

969 
	#BN_MP_EXCH_C


	)

970 
	#BN_MP_CLEAR_C


	)

973 #ià
defšed
(
BN_S_MP_SQR_C
)

974 
	#BN_MP_INIT_SIZE_C


	)

975 
	#BN_MP_CLAMP_C


	)

976 
	#BN_MP_EXCH_C


	)

977 
	#BN_MP_CLEAR_C


	)

980 #ià
defšed
(
BN_S_MP_SUB_C
)

981 
	#BN_MP_GROW_C


	)

982 
	#BN_MP_CLAMP_C


	)

985 #ià
defšed
(
BNCORE_C
)

988 #ifdeà
LTM3


989 
	#LTM_LAST


	)

991 
	~"tomm©h_su³rşass.h
"

992 
	~"tomm©h_şass.h
"

994 
	#LTM_LAST


	)

998 #undeà
BN_MP_KARATSUBA_MUL_C


999 #undeà
BN_MP_KARATSUBA_SQR_C


1000 #undeà
BN_MP_TOOM_MUL_C


1001 #undeà
BN_MP_TOOM_SQR_C


	@libtommath/tommath_superclass.h

4 
	#LTM_ALL


	)

16 #ifdeà
SC_RSA_1


17 
	#BN_MP_SHRINK_C


	)

18 
	#BN_MP_LCM_C


	)

19 
	#BN_MP_PRIME_RANDOM_EX_C


	)

20 
	#BN_MP_INVMOD_C


	)

21 
	#BN_MP_GCD_C


	)

22 
	#BN_MP_MOD_C


	)

23 
	#BN_MP_MULMOD_C


	)

24 
	#BN_MP_ADDMOD_C


	)

25 
	#BN_MP_EXPTMOD_C


	)

26 
	#BN_MP_SET_INT_C


	)

27 
	#BN_MP_INIT_MULTI_C


	)

28 
	#BN_MP_CLEAR_MULTI_C


	)

29 
	#BN_MP_UNSIGNED_BIN_SIZE_C


	)

30 
	#BN_MP_TO_UNSIGNED_BIN_C


	)

31 
	#BN_MP_MOD_D_C


	)

32 
	#BN_MP_PRIME_RABIN_MILLER_TRIALS_C


	)

33 
	#BN_REVERSE_C


	)

34 
	#BN_PRIME_TAB_C


	)

37 
	#BN_MP_DIV_SMALL


	)

43 #ifdeà
LTM_LAST


44 #undeà
BN_MP_TOOM_MUL_C


45 #undeà
BN_MP_TOOM_SQR_C


46 #undeà
BN_MP_KARATSUBA_MUL_C


47 #undeà
BN_MP_KARATSUBA_SQR_C


48 #undeà
BN_MP_REDUCE_C


49 #undeà
BN_MP_REDUCE_SETUP_C


50 #undeà
BN_MP_DR_IS_MODULUS_C


51 #undeà
BN_MP_DR_SETUP_C


52 #undeà
BN_MP_DR_REDUCE_C


53 #undeà
BN_MP_REDUCE_IS_2K_C


54 #undeà
BN_MP_REDUCE_2K_SETUP_C


55 #undeà
BN_MP_REDUCE_2K_C


56 #undeà
BN_S_MP_EXPTMOD_C


57 #undeà
BN_MP_DIV_3_C


58 #undeà
BN_S_MP_MUL_HIGH_DIGS_C


59 #undeà
BN_FAST_S_MP_MUL_HIGH_DIGS_C


60 #undeà
BN_FAST_MP_INVMOD_C


67 #undeà
BN_S_MP_MUL_DIGS_C


68 #undeà
BN_S_MP_SQR_C


69 #undeà
BN_MP_MONTGOMERY_REDUCE_C


	@list.c

1 
	~"İtiÚs.h
"

2 
	~"dbut.h
"

3 
	~"li¡.h
"

5 
	$li¡_­³nd
(
m_li¡
 *
li¡
, *
™em
) {

6 
m_li¡_–em
 *
–em
;

8 
–em
 = 
	`m_m®loc
((*elem));

9 
–em
->
™em
 = item;

10 
–em
->
li¡
 =†ist;

11 
–em
->
Ãxt
 = 
NULL
;

12 ià(!
li¡
->
fœ¡
) {

13 
li¡
->
fœ¡
 = 
–em
;

14 
–em
->
´ev
 = 
NULL
;

16 
–em
->
´ev
 = 
li¡
->
Ï¡
;

17 
li¡
->
Ï¡
->
Ãxt
 = 
–em
;

19 
li¡
->
Ï¡
 = 
–em
;

20 
	}
}

22 
m_li¡
 * 
	$li¡_Ãw
() {

23 
m_li¡
 *
»t
 = 
	`m_m®loc
((m_list));

24 
»t
->
fœ¡
 =„‘->
Ï¡
 = 
NULL
;

25  
»t
;

26 
	}
}

28 * 
	$li¡_»move
(
m_li¡_–em
 *
–em
) {

29 *
™em
 = 
–em
->item;

30 
m_li¡
 *
li¡
 = 
–em
->list;

31 ià(
li¡
->
fœ¡
 =ğ
–em
)

33 
li¡
->
fœ¡
 = 
–em
->
Ãxt
;

35 ià(
li¡
->
Ï¡
 =ğ
–em
)

37 
li¡
->
Ï¡
 = 
–em
->
´ev
;

39 ià(
–em
->
´ev
)

41 
–em
->
´ev
->
Ãxt
 =ƒlem->next;

43 ià(
–em
->
Ãxt
)

45 
–em
->
Ãxt
->
´ev
 =ƒlem->prev;

47 
	`m_ä“
(
–em
);

48  
™em
;

49 
	}
}

	@list.h

1 #iâdeà
_DROPBEAR_LIST_H


2 
	#_DROPBEAR_LIST_H


	)

4 
	g_m_li¡
;

6 
	s_m_li¡_–em
 {

7 *
	m™em
;

8 
_m_li¡_–em
 *
	mÃxt
;

9 
_m_li¡_–em
 *
	m´ev
;

10 
_m_li¡
 *
	mli¡
;

13 
_m_li¡_–em
 
	tm_li¡_–em
;

15 
	s_m_li¡
 {

16 
m_li¡_–em
 *
	mfœ¡
;

17 
m_li¡_–em
 *
	mÏ¡
;

20 
_m_li¡
 
	tm_li¡
;

22 
m_li¡
 * 
li¡_Ãw
();

23 
li¡_­³nd
(
m_li¡
 *
li¡
, *
™em
);

25 * 
li¡_»move
(
m_li¡_–em
 *
–em
);

	@listener.c

25 
	~"šşudes.h
"

26 
	~"li¡’”.h
"

27 
	~"£ssiÚ.h
"

28 
	~"dbut.h
"

30 
	$li¡’”s_š™Ÿli£
() {

33 
£s
.
li¡’”s
 = (
Li¡’”
**)
	`m_m®loc
((Listener*));

34 
£s
.
li¡’size
 = 1;

35 
£s
.
li¡’”s
[0] = 
NULL
;

37 
	}
}

39 
	$£t_li¡’”_fds
(
fd_£t
 * 
»adfds
) {

41 
i
, 
j
;

42 
Li¡’”
 *
li¡’”
;

45 
i
 = 0; i < 
£s
.
li¡’size
; i++) {

46 
li¡’”
 = 
£s
.
li¡’”s
[
i
];

47 ià(
li¡’”
 !ğ
NULL
) {

48 
j
 = 0; j < 
li¡’”
->
nsocks
; j++) {

49 
	`FD_SET
(
li¡’”
->
socks
[
j
], 
»adfds
);

53 
	}
}

56 
	$hªdË_li¡’”s
(
fd_£t
 * 
»adfds
) {

58 
i
, 
j
;

59 
Li¡’”
 *
li¡’”
;

60 
sock
;

63 
i
 = 0; i < 
£s
.
li¡’size
; i++) {

64 
li¡’”
 = 
£s
.
li¡’”s
[
i
];

65 ià(
li¡’”
 !ğ
NULL
) {

66 
j
 = 0; j < 
li¡’”
->
nsocks
; j++) {

67 
sock
 = 
li¡’”
->
socks
[
j
];

68 ià(
	`FD_ISSET
(
sock
, 
»adfds
)) {

69 
li¡’”
->
	`acû±Ü
Öi¡’”, 
sock
);

74 
	}
}

79 
Li¡’”
* 
Ãw_li¡’”
(
socks
[], 
nsocks
,

80 
ty³
, * 
ty³d©a
,

81 (*
acû±Ü
)(
Li¡’”
* 
li¡’”
, 
sock
),

82 (*
ş—nup
)(
Li¡’”
*)) {

84 
i
, 
j
;

85 
Li¡’”
 *
Ãwli¡’
 = 
NULL
;

87 
i
 = 0; i < 
£s
.
li¡’size
; i++) {

88 ià(
£s
.
li¡’”s
[
i
] =ğ
NULL
) {

94 ià(
i
 =ğ
£s
.
li¡’size
) {

95 ià(
£s
.
li¡’size
 > 
MAX_LISTENERS
) {

96 
	`TRACE
(("leave‚ewlistener:oo many‡lready"))

97 
j
 = 0; j < 
nsocks
; j++) {

98 
	`şo£
(
socks
[
i
]);

100  
NULL
;

103 
£s
.
li¡’”s
 = (
Li¡’”
**)
	`m_»®loc
(ses.listeners,

104 (
£s
.
li¡’size
+
LISTENER_EXTEND_SIZE
)

105 *(
Li¡’”
*));

107 
£s
.
li¡’size
 +ğ
LISTENER_EXTEND_SIZE
;

109 
j
 = 
i
; j < 
£s
.
li¡’size
; j++) {

110 
£s
.
li¡’”s
[
j
] = 
NULL
;

114 
j
 = 0; j < 
nsocks
; j++) {

115 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
socks
[
j
]);

118 
	`TRACE
(("Ãw†i¡’”‚um %d ", 
i
))

120 
Ãwli¡’
 = (
Li¡’”
*)
	`m_m®loc
((Listener));

121 
Ãwli¡’
->
šdex
 = 
i
;

122 
Ãwli¡’
->
ty³
 =ype;

123 
Ãwli¡’
->
ty³d©a
 =ypedata;

124 
Ãwli¡’
->
nsocks
 =‚socks;

125 
	`memıy
(
Ãwli¡’
->
socks
, socks, 
nsocks
 * ());

126 
Ãwli¡’
->
acû±Ü
 =‡cceptor;

127 
Ãwli¡’
->
ş—nup
 = cleanup;

129 
£s
.
li¡’”s
[
i
] = 
Ãwli¡’
;

130  
Ãwli¡’
;

131 
	}
}

135 
Li¡’”
 * 
g‘_li¡’”
(
ty³
, * 
ty³d©a
,

136 (*
m©ch
)(*, *)) {

138 
i
;

139 
Li¡’”
* 
li¡’”
;

141 
i
 = 0, 
li¡’”
 = 
£s
.
li¡’”s
[i]; i < ses.
li¡’size
; i++) {

142 ià(
li¡’”
->
ty³
 ==ype

143 && 
	`m©ch
(
ty³d©a
, 
li¡’”
->typedata)) {

144  
li¡’”
;

148  
NULL
;

149 
	}
}

151 
	$»move_li¡’”
(
Li¡’”
* 
li¡’”
) {

153 
j
;

155 ià(
li¡’”
->
ş—nup
) {

156 
li¡’”
->
	`ş—nup
(listener);

159 
j
 = 0; j < 
li¡’”
->
nsocks
; j++) {

160 
	`şo£
(
li¡’”
->
socks
[
j
]);

162 
£s
.
li¡’”s
[
li¡’”
->
šdex
] = 
NULL
;

163 
	`m_ä“
(
li¡’”
);

165 
	}
}

	@listener.h

25 #iâdeà
_LISTENER_H


26 
	#_LISTENER_H


	)

28 
	#MAX_LISTENERS
 20

	)

29 
	#LISTENER_EXTEND_SIZE
 1

	)

31 
	sLi¡’”
 {

33 
	msocks
[
DROPBEAR_MAX_SOCKS
];

34 
	mnsocks
;

36 
	mšdex
;

38 (*
	macû±Ü
)(
	mLi¡’”
*, 
	msock
);

39 (*
	mş—nup
)(
	mLi¡’”
*);

41 
	mty³
;

45 *
	mty³d©a
;

49 
li¡’”s_š™Ÿli£
();

50 
hªdË_li¡’”s
(
fd_£t
 * 
»adfds
);

51 
£t_li¡’”_fds
(
fd_£t
 * 
»adfds
);

53 
Li¡’”
* 
Ãw_li¡’”
(
socks
[], 
nsocks
,

54 
ty³
, * 
ty³d©a
,

55 (*
acû±Ü
)(
Li¡’”
* 
li¡’”
, 
sock
),

56 (*
ş—nup
)(
Li¡’”
*));

58 
Li¡’”
 * 
	`g‘_li¡’”
(
ty³
, * 
ty³d©a
,

59 (*
m©ch
)(*, *));

61 
	`»move_li¡’”
(
Li¡’”
* 
li¡’”
);

	@loginrec.c

156 
	~"šşudes.h
"

157 
	~"logš»c.h
"

158 
	~"dbut.h
"

159 
	~"©omicio.h
"

160 
	#DEAD_PROCESS
 8

	)

166 #ià
HAVE_UTMP_H


167 
£t_utmp_time
(
logššfo
 *
li
, 
utmp
 *
ut
);

168 
cÚ¡ruù_utmp
(
logššfo
 *
li
, 
utmp
 *
ut
);

171 #ifdeà
HAVE_UTMPX_H


172 
£t_utmpx_time
(
logššfo
 *
li
, 
utmpx
 *
ut
);

173 
cÚ¡ruù_utmpx
(
logššfo
 *
li
, 
utmpx
 *
ut
);

176 
utmp_wr™e_’Œy
(
logššfo
 *
li
);

177 
utmpx_wr™e_’Œy
(
logššfo
 *
li
);

178 
wtmp_wr™e_’Œy
(
logššfo
 *
li
);

179 
wtmpx_wr™e_’Œy
(
logššfo
 *
li
);

180 
Ï¡log_wr™e_’Œy
(
logššfo
 *
li
);

181 
sy¦ogš_wr™e_’Œy
(
logššfo
 *
li
);

183 
wtmp_g‘_’Œy
(
logššfo
 *
li
);

184 
wtmpx_g‘_’Œy
(
logššfo
 *
li
);

187 
	#MIN_SIZEOF
(
s1
,
s2
èĞ(s1è< (s2è? (s1è: (s2è)

	)

203 
	$logš_logš
 (
logššfo
 *
li
)

205 
li
->
ty³
 = 
LTYPE_LOGIN
;

206  
	`logš_wr™e
(
li
);

207 
	}
}

219 
	$logš_logout
(
logššfo
 *
li
)

221 
li
->
ty³
 = 
LTYPE_LOGOUT
;

222  
	`logš_wr™e
(
li
);

223 
	}
}

236 
logššfo
 *
	$logš_®loc_’Œy
(
pid
, cÚ¡ *
u£ºame
,

237 cÚ¡ *
ho¡Çme
, cÚ¡ *
lše
)

239 
logššfo
 *
Ãwli
;

241 
Ãwli
 = (
logššfo
 *è
	`m_m®loc
 ((*newli));

242 ()
	`logš_š™_’Œy
(
Ãwli
, 
pid
, 
u£ºame
, 
ho¡Çme
, 
lše
);

243  
Ãwli
;

244 
	}
}

249 
	$logš_ä“_’Œy
(
logššfo
 *
li
)

251 
	`m_ä“
(
li
);

252 
	}
}

264 
	$logš_š™_’Œy
(
logššfo
 *
li
, 
pid
, cÚ¡ *
u£ºame
,

265 cÚ¡ *
ho¡Çme
, cÚ¡ *
lše
)

267 
·sswd
 *
pw
;

269 
	`mem£t
(
li
, 0, (*li));

271 
li
->
pid
 =…id;

274 ià(
lše
)

275 
	`lše_fuÎÇme
(
li
->
lše
,†ine, (li->line));

277 ià(
u£ºame
) {

278 
	`¡¾ıy
(
li
->
u£ºame
, username, (li->username));

279 
pw
 = 
	`g‘pwÇm
(
li
->
u£ºame
);

280 ià(
pw
 =ğ
NULL
)

281 
	`drİb—r_ex™
("login_init_entry: Cannot find user \"%s\"",

282 
li
->
u£ºame
);

283 
li
->
uid
 = 
pw
->
pw_uid
;

286 ià(
ho¡Çme
)

287 
	`¡¾ıy
(
li
->
ho¡Çme
, hostname, (li->hostname));

290 
	}
}

299 
	$logš_£t_cu¼’t_time
(
logššfo
 *
li
)

301 
timev®
 
tv
;

303 
	`g‘timeofday
(&
tv
, 
NULL
);

305 
li
->
tv_£c
 = 
tv
.tv_sec;

306 
li
->
tv_u£c
 = 
tv
.tv_usec;

307 
	}
}

311 
	$logš_£t_addr
(
logššfo
 *
li
, cÚ¡ 
sockaddr
 *
§
,

312 cÚ¡ 
§_size
)

314 
bufsize
 = 
§_size
;

317 ià((
li
->
ho¡addr
è< 
§_size
)

318 
bufsize
 = (
li
->
ho¡addr
);

320 
	`memıy
((*)&(
li
->
ho¡addr
.
§
), (cÚ¡ *)§, 
bufsize
);

321 
	}
}

329 
	$logš_wr™e
 (
logššfo
 *
li
)

331 #iâdeà
HAVE_CYGWIN


332 ià(()
	`g‘euid
() != 0) {

333 
	`drİb—r_log
(
LOG_WARNING
,

340 
	`logš_£t_cu¼’t_time
(
li
);

341 #ifdeà
USE_LOGIN


342 
	`sy¦ogš_wr™e_’Œy
(
li
);

344 #ifdeà
USE_LASTLOG


345 ià(
li
->
ty³
 =ğ
LTYPE_LOGIN
) {

346 
	`Ï¡log_wr™e_’Œy
(
li
);

349 #ifdeà
USE_UTMP


350 
	`utmp_wr™e_’Œy
(
li
);

352 #ifdeà
USE_WTMP


353 
	`wtmp_wr™e_’Œy
(
li
);

355 #ifdeà
USE_UTMPX


356 
	`utmpx_wr™e_’Œy
(
li
);

358 #ifdeà
USE_WTMPX


359 
	`wtmpx_wr™e_’Œy
(
li
);

362 
	}
}

364 #ifdeà
LOGIN_NEEDS_UTMPX


366 
	$logš_utmp_Úly
(
logššfo
 *
li
)

368 
li
->
ty³
 = 
LTYPE_LOGIN
;

369 
	`logš_£t_cu¼’t_time
(
li
);

370 #ifdeà
USE_UTMP


371 
	`utmp_wr™e_’Œy
(
li
);

373 #ifdeà
USE_WTMP


374 
	`wtmp_wr™e_’Œy
(
li
);

376 #ifdeà
USE_UTMPX


377 
	`utmpx_wr™e_’Œy
(
li
);

379 #ifdeà
USE_WTMPX


380 
	`wtmpx_wr™e_’Œy
(
li
);

383 
	}
}

408 
	$lše_fuÎÇme
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
d¡size
)

410 
	`mem£t
(
d¡
, '\0', 
d¡size
);

411 ià((
	`¡ºcmp
(
¤c
, "/dev/", 5è=ğ0è|| (
d¡size
 < (
	`¡¾’
(src) + 5))) {

412 
	`¡¾ıy
(
d¡
, 
¤c
, 
d¡size
);

414 
	`¡¾ıy
(
d¡
, "/dev/", 
d¡size
);

415 
	`¡¾ÿt
(
d¡
, 
¤c
, 
d¡size
);

417  
d¡
;

418 
	}
}

422 
	$lše_¡rÇme
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
d¡size
)

424 
	`mem£t
(
d¡
, '\0', 
d¡size
);

425 ià(
	`¡ºcmp
(
¤c
, "/dev/", 5) == 0)

426 
	`¡¾ıy
(
d¡
, 
¤c
 + 5, 
d¡size
);

428 
	`¡¾ıy
(
d¡
, 
¤c
, 
d¡size
);

429  
d¡
;

430 
	}
}

439 
	$lše_abb»vÇme
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
d¡size
)

441 
size_t
 
Ën
;

443 
	`mem£t
(
d¡
, '\0', 
d¡size
);

446 ià(
	`¡ºcmp
(
¤c
, "/dev/", 5) == 0)

447 
¤c
 += 5;

449 #ifdeà
WITH_ABBREV_NO_TTY


450 ià(
	`¡ºcmp
(
¤c
, "tty", 3) == 0)

451 
¤c
 += 3;

454 
Ën
 = 
	`¡¾’
(
¤c
);

456 ià(
Ën
 > 0) {

457 ià((()
Ën
 - 
d¡size
) > 0)

458 
¤c
 +ğ(()
Ën
 - 
d¡size
);

461 
	`¡ºıy
(
d¡
, 
¤c
, (
size_t
)
d¡size
);

464  
d¡
;

465 
	}
}

474 #ià
defšed
(
USE_UTMP
è|| defšed (
USE_WTMP
è|| defšed (
USE_LOGIN
)

478 
	$£t_utmp_time
(
logššfo
 *
li
, 
utmp
 *
ut
)

480 #ifdeà
HAVE_STRUCT_UTMP_UT_TV


481 
ut
->
ut_tv
.
tv_£c
 = 
li
->tv_sec;

482 
ut
->
ut_tv
.
tv_u£c
 = 
li
->tv_usec;

484 #ifdeà
HAVE_STRUCT_UTMP_UT_TIME


485 
ut
->
ut_time
 = 
li
->
tv_£c
;

488 
	}
}

491 
	$cÚ¡ruù_utmp
(
logššfo
 *
li
,

492 
utmp
 *
ut
)

494 #ifdeà
HAVE_ADDR_V6_IN_UTMP


495 
sockaddr_š6
 *
§6
;

497 
	`mem£t
(
ut
, '\0', (*ut));

501 #ifdeà
HAVE_STRUCT_UTMP_UT_ID


502 
	`lše_abb»vÇme
(
ut
->
ut_id
, 
li
->
lše
, (ut->ut_id));

505 #ifdeà
HAVE_STRUCT_UTMP_UT_TYPE


507 
li
->
ty³
) {

508 
LTYPE_LOGIN
:

509 
ut
->
ut_ty³
 = 
USER_PROCESS
;

510 #ifdeà
_UNICOS


511 
	`üay_£t_tmpdœ
(
ut
);

514 
LTYPE_LOGOUT
:

515 
ut
->
ut_ty³
 = 
DEAD_PROCESS
;

516 #ifdeà
_UNICOS


517 
	`üay_»š_utmp
(
ut
, 
li
->
pid
);

522 
	`£t_utmp_time
(
li
, 
ut
);

524 
	`lše_¡rÇme
(
ut
->
ut_lše
, 
li
->
lše
, (ut->ut_line));

526 #ifdeà
HAVE_STRUCT_UTMP_UT_PID


527 
ut
->
ut_pid
 = 
li
->
pid
;

531 ià(
li
->
ty³
 =ğ
LTYPE_LOGOUT
)

540 
	`¡ºıy
(
ut
->
ut_Çme
, 
li
->
u£ºame
, 
	`MIN_SIZEOF
(ut->ut_name,†i->username));

541 #ifdeà
HAVE_STRUCT_UTMP_UT_HOST


542 
	`¡ºıy
(
ut
->
ut_ho¡
, 
li
->
ho¡Çme
, 
	`MIN_SIZEOF
(ut->ut_host,†i->hostname));

544 #ifdeà
HAVE_STRUCT_UTMP_UT_ADDR


546 ià(
li
->
ho¡addr
.
§
.
§_çmy
 =ğ
AF_INET
)

547 
ut
->
ut_addr
 = 
li
->
ho¡addr
.
§_š
.
sš_addr
.
s_addr
;

549 #ifdeà
HAVE_ADDR_V6_IN_UTMP


551 ià(
li
->
ho¡addr
.
§
.
§_çmy
 =ğ
AF_INET6
) {

552 
§6
 = ((
sockaddr_š6
 *)&
li
->
ho¡addr
.
§
);

553 
	`memıy
(
ut
->
ut_addr_v6
, 
§6
->
sš6_addr
.
s6_addr
, 16);

554 ià(
	`IN6_IS_ADDR_V4MAPPED
(&
§6
->
sš6_addr
)) {

555 
ut
->
ut_addr_v6
[0] = ut->ut_addr_v6[3];

556 
ut
->
ut_addr_v6
[1] = 0;

557 
ut
->
ut_addr_v6
[2] = 0;

558 
ut
->
ut_addr_v6
[3] = 0;

562 
	}
}

572 #ià
defšed
(
USE_UTMPX
è|| defšed (
USE_WTMPX
)

575 
	$£t_utmpx_time
(
logššfo
 *
li
, 
utmpx
 *
utx
)

577 #ifdeà
HAVE_STRUCT_UTMPX_UT_TV


578 
utx
->
ut_tv
.
tv_£c
 = 
li
->tv_sec;

579 
utx
->
ut_tv
.
tv_u£c
 = 
li
->tv_usec;

581 #ifdeà
HAVE_STRUCT_UTMPX_UT_TIME


582 
utx
->
ut_time
 = 
li
->
tv_£c
;

585 
	}
}

588 
	$cÚ¡ruù_utmpx
(
logššfo
 *
li
, 
utmpx
 *
utx
)

590 #ifdeà
HAVE_ADDR_V6_IN_UTMP


591 
sockaddr_š6
 *
§6
;

593 
	`mem£t
(
utx
, '\0', (*utx));

594 #ifdeà
HAVE_STRUCT_UTMPX_UT_ID


595 
	`lše_abb»vÇme
(
utx
->
ut_id
, 
li
->
lše
, (utx->ut_id));

599 
li
->
ty³
) {

600 
LTYPE_LOGIN
:

601 
utx
->
ut_ty³
 = 
USER_PROCESS
;

603 
LTYPE_LOGOUT
:

604 
utx
->
ut_ty³
 = 
DEAD_PROCESS
;

607 
	`lše_¡rÇme
(
utx
->
ut_lše
, 
li
->
lše
, (utx->ut_line));

608 
	`£t_utmpx_time
(
li
, 
utx
);

609 
utx
->
ut_pid
 = 
li
->
pid
;

611 
	`¡ºıy
(
utx
->
ut_Çme
, 
li
->
u£ºame
, 
	`MIN_SIZEOF
(utx->ut_name,†i->username));

613 ià(
li
->
ty³
 =ğ
LTYPE_LOGOUT
)

621 #ifdeà
HAVE_STRUCT_UTMPX_UT_HOST


622 
	`¡ºıy
(
utx
->
ut_ho¡
, 
li
->
ho¡Çme
, 
	`MIN_SIZEOF
(utx->ut_host,†i->hostname));

624 #ifdeà
HAVE_STRUCT_UTMPX_UT_ADDR


626 ià(
li
->
ho¡addr
.
§
.
§_çmy
 =ğ
AF_INET
)

627 
utx
->
ut_addr
 = 
li
->
ho¡addr
.
§_š
.
sš_addr
.
s_addr
;

629 #ifdeà
HAVE_ADDR_V6_IN_UTMP


631 ià(
li
->
ho¡addr
.
§
.
§_çmy
 =ğ
AF_INET6
) {

632 
§6
 = ((
sockaddr_š6
 *)&
li
->
ho¡addr
.
§
);

633 
	`memıy
(
ut
->
ut_addr_v6
, 
§6
->
sš6_addr
.
s6_addr
, 16);

634 ià(
	`IN6_IS_ADDR_V4MAPPED
(&
§6
->
sš6_addr
)) {

635 
ut
->
ut_addr_v6
[0] = ut->ut_addr_v6[3];

636 
ut
->
ut_addr_v6
[1] = 0;

637 
ut
->
ut_addr_v6
[2] = 0;

638 
ut
->
ut_addr_v6
[3] = 0;

642 #ifdeà
HAVE_STRUCT_UTMPX_UT_SYSLEN


644 
utx
->
ut_sy¦’
 = 
	`MIN
(
	`¡¾’
(
li
->
ho¡Çme
), (utx->
ut_ho¡
));

646 
	}
}

654 #ifdeà
USE_UTMP


657 #ià!
defšed
(
DISABLE_PUTUTLINE
è&& defšed(
HAVE_SETUTENT
) && \

658 
	$defšed
(
HAVE_PUTUTLINE
)

659 
	#UTMP_USE_LIBRARY


	)

664 #ifdeà
UTMP_USE_LIBRARY


666 
	$utmp_wr™e_lib¿ry
(
logššfo
 *
li
, 
utmp
 *
ut
)

668 
	`£tu‹Á
();

669 
	`putuše
(
ut
);

671 #ifdeà
HAVE_ENDUTENT


672 
	`’du‹Á
();

675 
	}
}

681 
	$utmp_wr™e_dœeù
(
logššfo
 *
li
, 
utmp
 *
ut
)

685 
utmp
 
Şd_ut
;

686 
fd
;

687 
‰y
;

691 #ià
	`defšed
(
HAVE_GETTTYENT
)

692 
‰y’t
 *
ty
;

694 
‰y
=0;

696 
	`£‰ty’t
();

697 (
‰y’t
 *)0 !ğ(
ty
 = 
	`g‘‰y’t
())) {

698 
‰y
++;

699 ià(!
	`¡ºcmp
(
ty
->
ty_Çme
, 
ut
->
ut_lše
, (ut->ut_line)))

702 
	`’d‰y’t
();

704 if((
‰y’t
 *)0 =ğ
ty
) {

705 
	`drİb—r_log
(
LOG_WARNING
, "utmp_write_entry:ty‚ot found");

710 
‰y
 = 
	`‰y¦Ù
();

714 ià(
‰y
 > 0 && (
fd
 = 
	`İ’
(
UTMP_FILE
, 
O_RDWR
|
O_CREAT
, 0644)) >= 0) {

715 ()
	`l£ek
(
fd
, (
off_t
)(
‰y
 * (
utmp
)), 
SEEK_SET
);

721 ià(
	`©omicio
(
»ad
, 
fd
, &
Şd_ut
, (old_ut)) == (old_ut) &&

722 (
ut
->
ut_ho¡
[0] =ğ'\0'è&& (
Şd_ut
.ut_host[0] != '\0') &&

723 (
	`¡ºcmp
(
Şd_ut
.
ut_lše
, 
ut
->ut_line, (ut->ut_line)) == 0) &&

724 (
	`¡ºcmp
(
Şd_ut
.
ut_Çme
, 
ut
->ut_name, (ut->ut_name)) == 0)) {

725 ()
	`memıy
(
ut
->
ut_ho¡
, 
Şd_ut
.ut_host, (ut->ut_host));

728 ()
	`l£ek
(
fd
, (
off_t
)(
‰y
 * (
utmp
)), 
SEEK_SET
);

729 ià(
	`©omicio
(
wr™e
, 
fd
, 
ut
, (*ut)) != (*ut))

730 
	`drİb—r_log
(
LOG_WARNING
, "utmp_write_direct:ƒrror writing %s: %s",

731 
UTMP_FILE
, 
	`¡»¼Ü
(
”ºo
));

733 ()
	`şo£
(
fd
);

739 
	}
}

743 
	$utmp_³rfÜm_logš
(
logššfo
 *
li
)

745 
utmp
 
ut
;

747 
	`cÚ¡ruù_utmp
(
li
, &
ut
);

748 #ifdeà
UTMP_USE_LIBRARY


749 ià(!
	`utmp_wr™e_lib¿ry
(
li
, &
ut
)) {

750 
	`drİb—r_log
(
LOG_WARNING
, "utmp_perform_login: utmp_write_library() failed");

754 ià(!
	`utmp_wr™e_dœeù
(
li
, &
ut
)) {

755 
	`drİb—r_log
(
LOG_WARNING
, "utmp_perform_login: utmp_write_direct() failed");

760 
	}
}

764 
	$utmp_³rfÜm_logout
(
logššfo
 *
li
)

766 
utmp
 
ut
;

768 
	`cÚ¡ruù_utmp
(
li
, &
ut
);

769 #ifdeà
UTMP_USE_LIBRARY


770 ià(!
	`utmp_wr™e_lib¿ry
(
li
, &
ut
)) {

771 
	`drİb—r_log
(
LOG_WARNING
, "utmp_perform_logout: utmp_write_library() failed");

775 ià(!
	`utmp_wr™e_dœeù
(
li
, &
ut
)) {

776 
	`drİb—r_log
(
LOG_WARNING
, "utmp_perform_logout: utmp_write_direct() failed");

781 
	}
}

785 
	$utmp_wr™e_’Œy
(
logššfo
 *
li
)

787 
li
->
ty³
) {

788 
LTYPE_LOGIN
:

789  
	`utmp_³rfÜm_logš
(
li
);

791 
LTYPE_LOGOUT
:

792  
	`utmp_³rfÜm_logout
(
li
);

795 
	`drİb—r_log
(
LOG_WARNING
, "utmp_write_entry: invalidype field");

798 
	}
}

807 #ifdeà
USE_UTMPX


810 #ià!
defšed
(
DISABLE_PUTUTXLINE
è&& defšed(
HAVE_SETUTXENT
) && \

811 
	$defšed
(
HAVE_PUTUTXLINE
)

812 
	#UTMPX_USE_LIBRARY


	)

817 #ifdeà
UTMPX_USE_LIBRARY


819 
	$utmpx_wr™e_lib¿ry
(
logššfo
 *
li
, 
utmpx
 *
utx
)

821 
	`£tutx’t
();

822 
	`pututxlše
(
utx
);

824 #ifdeà
HAVE_ENDUTXENT


825 
	`’dutx’t
();

828 
	}
}

834 
	$utmpx_wr™e_dœeù
(
logššfo
 *
li
, 
utmpx
 *
utx
)

836 
	`drİb—r_log
(
LOG_WARNING
, "utmpx_write_direct:‚ot implemented!");

838 
	}
}

842 
	$utmpx_³rfÜm_logš
(
logššfo
 *
li
)

844 
utmpx
 
utx
;

846 
	`cÚ¡ruù_utmpx
(
li
, &
utx
);

847 #ifdeà
UTMPX_USE_LIBRARY


848 ià(!
	`utmpx_wr™e_lib¿ry
(
li
, &
utx
)) {

849 
	`drİb—r_log
(
LOG_WARNING
, "utmpx_perform_login: utmp_write_library() failed");

853 ià(!
	`utmpx_wr™e_dœeù
(
li
, &
ut
)) {

854 
	`drİb—r_log
(
LOG_WARNING
, "utmpx_perform_login: utmp_write_direct() failed");

859 
	}
}

863 
	$utmpx_³rfÜm_logout
(
logššfo
 *
li
)

865 
utmpx
 
utx
;

867 
	`cÚ¡ruù_utmpx
(
li
, &
utx
);

868 #ifdeà
HAVE_STRUCT_UTMPX_UT_ID


869 
	`lše_abb»vÇme
(
utx
.
ut_id
, 
li
->
lše
, (utx.ut_id));

871 #ifdeà
HAVE_STRUCT_UTMPX_UT_TYPE


872 
utx
.
ut_ty³
 = 
DEAD_PROCESS
;

875 #ifdeà
UTMPX_USE_LIBRARY


876 
	`utmpx_wr™e_lib¿ry
(
li
, &
utx
);

878 
	`utmpx_wr™e_dœeù
(
li
, &
utx
);

881 
	}
}

884 
	$utmpx_wr™e_’Œy
(
logššfo
 *
li
)

886 
li
->
ty³
) {

887 
LTYPE_LOGIN
:

888  
	`utmpx_³rfÜm_logš
(
li
);

889 
LTYPE_LOGOUT
:

890  
	`utmpx_³rfÜm_logout
(
li
);

892 
	`drİb—r_log
(
LOG_WARNING
, "utmpx_write_entry: invalidype field");

895 
	}
}

903 #ifdeà
USE_WTMP


908 
	$wtmp_wr™e
(
logššfo
 *
li
, 
utmp
 *
ut
)

910 
¡©
 
buf
;

911 
fd
, 
»t
 = 1;

913 ià((
fd
 = 
	`İ’
(
WTMP_FILE
, 
O_WRONLY
|
O_APPEND
, 0)) < 0) {

914 
	`drİb—r_log
(
LOG_WARNING
, "wtmp_write:…roblem writing %s: %s",

915 
WTMP_FILE
, 
	`¡»¼Ü
(
”ºo
));

918 ià(
	`f¡©
(
fd
, &
buf
) == 0)

919 ià(
	`©omicio
(
wr™e
, 
fd
, 
ut
, (*ut)) != (*ut)) {

920 
	`árunÿ‹
(
fd
, 
buf
.
¡_size
);

921 
	`drİb—r_log
(
LOG_WARNING
, "wtmp_write:…roblem writing %s: %s",

922 
WTMP_FILE
, 
	`¡»¼Ü
(
”ºo
));

923 
»t
 = 0;

925 ()
	`şo£
(
fd
);

926  
»t
;

927 
	}
}

930 
	$wtmp_³rfÜm_logš
(
logššfo
 *
li
)

932 
utmp
 
ut
;

934 
	`cÚ¡ruù_utmp
(
li
, &
ut
);

935  
	`wtmp_wr™e
(
li
, &
ut
);

936 
	}
}

940 
	$wtmp_³rfÜm_logout
(
logššfo
 *
li
)

942 
utmp
 
ut
;

944 
	`cÚ¡ruù_utmp
(
li
, &
ut
);

945  
	`wtmp_wr™e
(
li
, &
ut
);

946 
	}
}

950 
	$wtmp_wr™e_’Œy
(
logššfo
 *
li
)

952 
li
->
ty³
) {

953 
LTYPE_LOGIN
:

954  
	`wtmp_³rfÜm_logš
(
li
);

955 
LTYPE_LOGOUT
:

956  
	`wtmp_³rfÜm_logout
(
li
);

958 
	`drİb—r_log
(
LOG_WARNING
, "wtmp_write_entry: invalidype field");

961 
	}
}

982 
	$wtmp_i¦ogš
(
logššfo
 *
li
, 
utmp
 *
ut
)

984 ià(
	`¡ºcmp
(
li
->
u£ºame
, 
ut
->
ut_Çme
,

985 
	`MIN_SIZEOF
(
li
->
u£ºame
, 
ut
->
ut_Çme
)) == 0) {

986 #ifdeà
HAVE_STRUCT_UTMP_UT_TYPE


987 ià(
ut
->
ut_ty³
 & 
USER_PROCESS
)

994 
	}
}

997 
	$wtmp_g‘_’Œy
(
logššfo
 *
li
)

999 
¡©
 
¡
;

1000 
utmp
 
ut
;

1001 
fd
, 
found
=0;

1004 
li
->
tv_£c
 =†i->
tv_u£c
 = 0;

1006 ià((
fd
 = 
	`İ’
(
WTMP_FILE
, 
O_RDONLY
)) < 0) {

1007 
	`drİb—r_log
(
LOG_WARNING
, "wtmp_get_entry:…roblem opening %s: %s",

1008 
WTMP_FILE
, 
	`¡»¼Ü
(
”ºo
));

1011 ià(
	`f¡©
(
fd
, &
¡
) != 0) {

1012 
	`drİb—r_log
(
LOG_WARNING
, "wtmp_get_entry: couldn't stat %s: %s",

1013 
WTMP_FILE
, 
	`¡»¼Ü
(
”ºo
));

1014 
	`şo£
(
fd
);

1019 ià(
	`l£ek
(
fd
, -(
off_t
)(
utmp
), 
SEEK_END
) == -1) {

1021 
	`şo£
(
fd
);

1025 !
found
) {

1026 ià(
	`©omicio
(
»ad
, 
fd
, &
ut
, (ut)) != (ut)) {

1027 
	`drİb—r_log
(
LOG_WARNING
, "wtmp_get_entry:„ead of %s failed: %s",

1028 
WTMP_FILE
, 
	`¡»¼Ü
(
”ºo
));

1029 
	`şo£
 (
fd
);

1032 iàĞ
	`wtmp_i¦ogš
(
li
, &
ut
) ) {

1033 
found
 = 1;

1036 #ifdeà
HAVE_STRUCT_UTMP_UT_TIME


1037 
li
->
tv_£c
 = 
ut
.
ut_time
;

1039 #ià
HAVE_STRUCT_UTMP_UT_TV


1040 
li
->
tv_£c
 = 
ut
.
ut_tv
.tv_sec;

1043 
	`lše_fuÎÇme
(
li
->
lše
, 
ut
.
ut_lše
,

1044 
	`MIN_SIZEOF
(
li
->
lše
, 
ut
.
ut_lše
));

1045 #ifdeà
HAVE_STRUCT_UTMP_UT_HOST


1046 
	`¡¾ıy
(
li
->
ho¡Çme
, 
ut
.
ut_ho¡
,

1047 
	`MIN_SIZEOF
(
li
->
ho¡Çme
, 
ut
.
ut_ho¡
));

1052 ià(
	`l£ek
(
fd
, -(
off_t
)(2 * (
utmp
)), 
SEEK_CUR
) == -1) {

1054 
	`şo£
 (
fd
);

1060 
	`şo£
(
fd
);

1062 
	}
}

1070 #ifdeà
USE_WTMPX


1074 
	$wtmpx_wr™e
(
logššfo
 *
li
, 
utmpx
 *
utx
)

1076 
¡©
 
buf
;

1077 
fd
, 
»t
 = 1;

1079 ià((
fd
 = 
	`İ’
(
WTMPX_FILE
, 
O_WRONLY
|
O_APPEND
, 0)) < 0) {

1080 
	`drİb—r_log
(
LOG_WARNING
, "wtmpx_write:…roblem opening %s: %s",

1081 
WTMPX_FILE
, 
	`¡»¼Ü
(
”ºo
));

1085 ià(
	`f¡©
(
fd
, &
buf
) == 0)

1086 ià(
	`©omicio
(
wr™e
, 
fd
, 
utx
, (*utx)) != (*utx)) {

1087 
	`árunÿ‹
(
fd
, 
buf
.
¡_size
);

1088 
	`drİb—r_log
(
LOG_WARNING
, "wtmpx_write:…roblem writing %s: %s",

1089 
WTMPX_FILE
, 
	`¡»¼Ü
(
”ºo
));

1090 
»t
 = 0;

1092 ()
	`şo£
(
fd
);

1094  
»t
;

1095 
	}
}

1099 
	$wtmpx_³rfÜm_logš
(
logššfo
 *
li
)

1101 
utmpx
 
utx
;

1103 
	`cÚ¡ruù_utmpx
(
li
, &
utx
);

1104  
	`wtmpx_wr™e
(
li
, &
utx
);

1105 
	}
}

1109 
	$wtmpx_³rfÜm_logout
(
logššfo
 *
li
)

1111 
utmpx
 
utx
;

1113 
	`cÚ¡ruù_utmpx
(
li
, &
utx
);

1114  
	`wtmpx_wr™e
(
li
, &
utx
);

1115 
	}
}

1119 
	$wtmpx_wr™e_’Œy
(
logššfo
 *
li
)

1121 
li
->
ty³
) {

1122 
LTYPE_LOGIN
:

1123  
	`wtmpx_³rfÜm_logš
(
li
);

1124 
LTYPE_LOGOUT
:

1125  
	`wtmpx_³rfÜm_logout
(
li
);

1127 
	`drİb—r_log
(
LOG_WARNING
, "wtmpx_write_entry: invalidype field");

1130 
	}
}

1137 
	$wtmpx_i¦ogš
(
logššfo
 *
li
, 
utmpx
 *
utx
)

1139 iàĞ
	`¡ºcmp
(
li
->
u£ºame
, 
utx
->
ut_Çme
,

1140 
	`MIN_SIZEOF
(
li
->
u£ºame
, 
utx
->
ut_Çme
)) == 0 ) {

1141 #ifdeà
HAVE_STRUCT_UTMPX_UT_TYPE


1142 ià(
utx
->
ut_ty³
 =ğ
USER_PROCESS
)

1149 
	}
}

1153 
	$wtmpx_g‘_’Œy
(
logššfo
 *
li
)

1155 
¡©
 
¡
;

1156 
utmpx
 
utx
;

1157 
fd
, 
found
=0;

1160 
li
->
tv_£c
 =†i->
tv_u£c
 = 0;

1162 ià((
fd
 = 
	`İ’
(
WTMPX_FILE
, 
O_RDONLY
)) < 0) {

1163 
	`drİb—r_log
(
LOG_WARNING
, "wtmpx_get_entry:…roblem opening %s: %s",

1164 
WTMPX_FILE
, 
	`¡»¼Ü
(
”ºo
));

1167 ià(
	`f¡©
(
fd
, &
¡
) != 0) {

1168 
	`drİb—r_log
(
LOG_WARNING
, "wtmpx_get_entry: couldn't stat %s: %s",

1169 
WTMPX_FILE
, 
	`¡»¼Ü
(
”ºo
));

1170 
	`şo£
(
fd
);

1175 ià(
	`l£ek
(
fd
, -(
off_t
)(
utmpx
), 
SEEK_END
) == -1 ) {

1177 
	`şo£
(
fd
);

1181 !
found
) {

1182 ià(
	`©omicio
(
»ad
, 
fd
, &
utx
, (utx)) != (utx)) {

1183 
	`drİb—r_log
(
LOG_WARNING
, "wtmpx_get_entry:„ead of %s failed: %s",

1184 
WTMPX_FILE
, 
	`¡»¼Ü
(
”ºo
));

1185 
	`şo£
 (
fd
);

1190 iàĞ
	`wtmpx_i¦ogš
(
li
, &
utx
) ) {

1191 
found
 = 1;

1192 #ifdeà
HAVE_STRUCT_UTMPX_UT_TV


1193 
li
->
tv_£c
 = 
utx
.
ut_tv
.tv_sec;

1195 #ifdeà
HAVE_STRUCT_UTMPX_UT_TIME


1196 
li
->
tv_£c
 = 
utx
.
ut_time
;

1199 
	`lše_fuÎÇme
(
li
->
lše
, 
utx
.
ut_lše
, (li->line));

1200 #ifdeà
HAVE_STRUCT_UTMPX_UT_HOST


1201 
	`¡¾ıy
(
li
->
ho¡Çme
, 
utx
.
ut_ho¡
,

1202 
	`MIN_SIZEOF
(
li
->
ho¡Çme
, 
utx
.
ut_ho¡
));

1206 ià(
	`l£ek
(
fd
, -(
off_t
)(2 * (
utmpx
)), 
SEEK_CUR
) == -1) {

1207 
	`şo£
 (
fd
);

1212 
	`şo£
(
fd
);

1214 
	}
}

1221 #ifdeà
USE_LOGIN


1223 
	$sy¦ogš_³rfÜm_logš
(
logššfo
 *
li
)

1225 
utmp
 *
ut
;

1227 ià(! (
ut
 = (
utmp
 *)
	`m®loc
((*ut)))) {

1228 
	`drİb—r_log
(
LOG_WARNING
, "syslogin_perform_login: couldn't malloc()");

1231 
	`cÚ¡ruù_utmp
(
li
, 
ut
);

1232 
	`logš
(
ut
);

1233 
	`ä“
(
ut
);

1236 
	}
}

1239 
	$sy¦ogš_³rfÜm_logout
(
logššfo
 *
li
)

1241 #ifdeà
HAVE_LOGOUT


1242 
lše
[8];

1244 ()
	`lše_¡rÇme
(
lše
, 
li
->line, (line));

1246 ià(!
	`logout
(
lše
)) {

1247 
	`drİb—r_log
(
LOG_WARNING
, "sy¦ogš_³rfÜm_logout:†ogout(%sè»tuºed‡À”rÜ: %s", 
lše
, 
	`¡»¼Ü
(
”ºo
));

1248 #ifdeà
HAVE_LOGWTMP


1250 
	`logwtmp
(
lše
, "", "");

1259 
	}
}

1262 
	$sy¦ogš_wr™e_’Œy
(
logššfo
 *
li
)

1264 
li
->
ty³
) {

1265 
LTYPE_LOGIN
:

1266  
	`sy¦ogš_³rfÜm_logš
(
li
);

1267 
LTYPE_LOGOUT
:

1268  
	`sy¦ogš_³rfÜm_logout
(
li
);

1270 
	`drİb—r_log
(
LOG_WARNING
, "syslogin_write_entry: Invalidype field");

1273 
	}
}

1282 #ifdeà
USE_LASTLOG


1283 
	#LL_FILE
 1

	)

1284 
	#LL_DIR
 2

	)

1285 
	#LL_OTHER
 3

	)

1288 
	$Ï¡log_cÚ¡ruù
(
logššfo
 *
li
, 
Ï¡log
 *
Ï¡
)

1291 
	`mem£t
(
Ï¡
, '\0', (*last));

1293 ()
	`lše_¡rÇme
(
Ï¡
->
Î_lše
, 
li
->
lše
, (last->ll_line));

1294 
	`¡¾ıy
(
Ï¡
->
Î_ho¡
, 
li
->
ho¡Çme
,

1295 
	`MIN_SIZEOF
(
Ï¡
->
Î_ho¡
, 
li
->
ho¡Çme
));

1296 
Ï¡
->
Î_time
 = 
li
->
tv_£c
;

1297 
	}
}

1300 
	$Ï¡log_f‘y³
(*
f’ame
)

1302 
¡©
 
¡
;

1304 ià(
	`¡©
(
f’ame
, &
¡
) != 0) {

1305 
	`drİb—r_log
(
LOG_WARNING
, "Ï¡log_³rfÜm_logš: Couldn'ˆ¡© %s: %s", 
f’ame
,

1306 
	`¡»¼Ü
(
”ºo
));

1309 ià(
	`S_ISDIR
(
¡
.
¡_mode
))

1310  
LL_DIR
;

1311 ià(
	`S_ISREG
(
¡
.
¡_mode
))

1312  
LL_FILE
;

1314  
LL_OTHER
;

1315 
	}
}

1320 
	$Ï¡log_İ’£ek
(
logššfo
 *
li
, *
fd
, 
femode
)

1322 
off_t
 
off£t
;

1323 
ty³
;

1324 
Ï¡log_fe
[1024];

1326 
ty³
 = 
	`Ï¡log_f‘y³
(
LASTLOG_FILE
);

1327 
ty³
) {

1328 
LL_FILE
:

1329 
	`¡¾ıy
(
Ï¡log_fe
, 
LASTLOG_FILE
, (lastlog_file));

1331 
LL_DIR
:

1332 
	`¢´štf
(
Ï¡log_fe
, (lastlog_file), "%s/%s",

1333 
LASTLOG_FILE
, 
li
->
u£ºame
);

1336 
	`drİb—r_log
(
LOG_WARNING
, "lastlog_openseek: %.100s is‚ot‡ file or directory!",

1337 
LASTLOG_FILE
);

1341 *
fd
 = 
	`İ’
(
Ï¡log_fe
, 
femode
, 0600);

1342 iàĞ*
fd
 < 0) {

1343 
	`drİb—r_log
(
LOG_INFO
, "lastlog_openseek: Couldn't open %s: %s",

1344 
Ï¡log_fe
, 
	`¡»¼Ü
(
”ºo
));

1348 ià(
ty³
 =ğ
LL_FILE
) {

1350 
off£t
 = (
off_t
è(()
li
->
uid
 * (
Ï¡log
));

1352 iàĞ
	`l£ek
(*
fd
, 
off£t
, 
SEEK_SET
) != offset ) {

1353 
	`drİb—r_log
(
LOG_WARNING
, "lastlog_openseek: %s->lseek(): %s",

1354 
Ï¡log_fe
, 
	`¡»¼Ü
(
”ºo
));

1360 
	}
}

1363 
	$Ï¡log_³rfÜm_logš
(
logššfo
 *
li
)

1365 
Ï¡log
 
Ï¡
;

1366 
fd
;

1369 
	`Ï¡log_cÚ¡ruù
(
li
, &
Ï¡
);

1371 ià(!
	`Ï¡log_İ’£ek
(
li
, &
fd
, 
O_RDWR
|
O_CREAT
))

1375 ià(
	`©omicio
(
wr™e
, 
fd
, &
Ï¡
, (last)) != (last)) {

1376 
	`şo£
(
fd
);

1377 
	`drİb—r_log
(
LOG_WARNING
, "lastlog_write_filemode: Error writingo %s: %s",

1378 
LASTLOG_FILE
, 
	`¡»¼Ü
(
”ºo
));

1382 
	`şo£
(
fd
);

1384 
	}
}

1387 
	$Ï¡log_wr™e_’Œy
(
logššfo
 *
li
)

1389 
li
->
ty³
) {

1390 
LTYPE_LOGIN
:

1391  
	`Ï¡log_³rfÜm_logš
(
li
);

1393 
	`drİb—r_log
(
LOG_WARNING
, "lastlog_write_entry: Invalidype field");

1396 
	}
}

	@loginrec.h

1 #iâdeà
_HAVE_LOGINREC_H_


2 
	#_HAVE_LOGINREC_H_


	)

32 
	~"šşudes.h
"

39 #iâdeà
UTMP_FILE


40 #ifdeà
_PATH_UTMP


41 
	#UTMP_FILE
 
_PATH_UTMP


	)

43 #ifdeà
CONF_UTMP_FILE


44 
	#UTMP_FILE
 
CONF_UTMP_FILE


	)

48 #iâdeà
WTMP_FILE


49 #ifdeà
_PATH_WTMP


50 
	#WTMP_FILE
 
_PATH_WTMP


	)

52 #ifdeà
CONF_WTMP_FILE


53 
	#WTMP_FILE
 
CONF_WTMP_FILE


	)

58 #iâdeà
LASTLOG_FILE


59 #ifdeà
_PATH_LASTLOG


60 
	#LASTLOG_FILE
 
_PATH_LASTLOG


	)

62 #ifdeà
CONF_LASTLOG_FILE


63 
	#LASTLOG_FILE
 
CONF_LASTLOG_FILE


	)

70 #ià
defšed
(
HAVE_LOGIN
è&& !defšed(
DISABLE_LOGIN
)

71 
	#USE_LOGIN


	)

76 #ià
defšed
(
UTMPX_FILE
è&& !defšed(
DISABLE_UTMPX
)

77 
	#USE_UTMPX


	)

79 #ià
defšed
(
UTMP_FILE
è&& !defšed(
DISABLE_UTMP
)

80 
	#USE_UTMP


	)

82 #ià
defšed
(
WTMPX_FILE
è&& !defšed(
DISABLE_WTMPX
)

83 
	#USE_WTMPX


	)

85 #ià
defšed
(
WTMP_FILE
è&& !defšed(
DISABLE_WTMP
)

86 
	#USE_WTMP


	)

92 #ià
defšed
(
LASTLOG_FILE
è&& !defšed(
DISABLE_LASTLOG
)

93 
	#USE_LASTLOG


	)

105 
	ulogš_Ãtšfo
 {

106 
sockaddr
 
	m§
;

107 
sockaddr_š
 
	m§_š
;

108 #ifdeà
HAVE_STRUCT_SOCKADDR_STORAGE


109 
sockaddr_¡Üage
 
	m§_¡Üage
;

118 
	#LTYPE_LOGIN
 7

	)

119 
	#LTYPE_LOGOUT
 8

	)

122 
	#LINFO_PROGSIZE
 64

	)

123 
	#LINFO_LINESIZE
 64

	)

124 
	#LINFO_NAMESIZE
 64

	)

125 
	#LINFO_HOSTSIZE
 256

	)

127 
	slogššfo
 {

128 
	m´ogÇme
[
LINFO_PROGSIZE
];

129 
	m´ogÇme_nuÎ
;

130 
	mty³
;

131 
	mpid
;

132 
	muid
;

133 
	mlše
[
LINFO_LINESIZE
];

134 
	mu£ºame
[
LINFO_NAMESIZE
];

135 
	mho¡Çme
[
LINFO_HOSTSIZE
];

137 
	mex™
;

138 
	m‹rmš©iÚ
;

142 
	mtv_£c
;

143 
	mtv_u£c
;

144 
logš_Ãtšfo
 
	mho¡addr
;

153 
logššfo
 *
logš_®loc_’Œy
(
pid
, cÚ¡ *
u£ºame
,

154 cÚ¡ *
ho¡Çme
, cÚ¡ *
lše
);

156 
logš_ä“_’Œy
(
logššfo
 *
li
);

158 
logš_š™_’Œy
(
logššfo
 *
li
, 
pid
, cÚ¡ *
u£ºame
,

159 cÚ¡ *
ho¡Çme
, cÚ¡ *
lše
);

161 
logš_£t_cu¼’t_time
(
logššfo
 *
li
);

164 
logš_logš
 (
logššfo
 *
li
);

165 
logš_logout
(
logššfo
 *
li
);

166 #ifdeà
LOGIN_NEEDS_UTMPX


167 
logš_utmp_Úly
(
logššfo
 *
li
);

173 
logš_wr™e
 (
logššfo
 *
li
);

174 
logš_log_’Œy
(
logššfo
 *
li
);

177 
logš_£t_addr
(
logššfo
 *
li
, cÚ¡ 
sockaddr
 *
§
,

178 cÚ¡ 
§_size
);

181 *
lše_fuÎÇme
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
d¡size
);

182 *
lše_¡rÇme
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
d¡size
);

183 *
lše_abb»vÇme
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
d¡size
);

	@netbsd_getpass.c

33 
	~<sys/cdefs.h
>

34 #ià
defšed
(
LIBC_SCCS
è&& !defšed(
lšt
)

36 
	gsccsid
[] = "@(#)getpass.c 8.1 (Berkeley) 6/4/93";

38 
__RCSID
("$NetBSD: getpass.c,v 1.15 2003/08/07 16:42:50‡gc Exp $");

42 
	~"Çme¥aû.h
"

45 
	~<as£¹.h
>

46 
	~<·ths.h
>

47 
	~<pwd.h
>

48 
	~<sigÇl.h
>

49 
	~<¡dio.h
>

50 
	~<‹rmios.h
>

51 
	~<uni¡d.h
>

54 #ifdeà
__w—k_®Ÿs


55 
	$__w—k_®Ÿs
(
g‘·ss
,
_g‘·ss
)

60 
	$g‘·ss
(
´om±
)

61 cÚ¡ *
´om±
;

63 
‹rmios
 
‹rm
;

64 
ch
;

65 *
p
;

66 
FILE
 *
å
, *
outå
;

67 
echo
;

68 
buf
[
_PASSWORD_LEN
 + 1];

69 
sig£t_t
 
o£t
, 
n£t
;

72 
	`_DIAGASSERT
(
´om±
 !ğ
NULL
);

79 ià((
outå
 = 
å
 = 
	`fİ’
(
_PATH_TTY
, "w+")è=ğ
NULL
) {

80 
outå
 = 
¡d”r
;

81 
å
 = 
¡dš
;

88 
	`sigem±y£t
(&
n£t
);

89 
	`sigadd£t
(&
n£t
, 
SIGINT
);

90 
	`sigadd£t
(&
n£t
, 
SIGTSTP
);

91 ()
	`sig´ocmask
(
SIG_BLOCK
, &
n£t
, &
o£t
);

93 ()
	`tcg‘©Œ
(
	`f’o
(
å
), &
‹rm
);

94 ià((
echo
 = (
‹rm
.
c_læag
 & 
ECHO
)) != 0) {

95 
‹rm
.
c_læag
 &ğ~
ECHO
;

96 ()
	`tc£‰r
(
	`f’o
(
å
), 
TCSAFLUSH
 , &
‹rm
);

98 ià(
´om±
 !ğ
NULL
)

99 ()
	`åuts
(
´om±
, 
outå
);

100 
	`»wšd
(
outå
);

101 
p
 = 
buf
; (
ch
 = 
	`g‘c
(
å
)è!ğ
EOF
 && ch != '\n';)

102 ià(
p
 < 
buf
 + 
_PASSWORD_LEN
)

103 *
p
++ = 
ch
;

104 *
p
 = '\0';

105 ()
	`wr™e
(
	`f’o
(
outå
), "\n", 1);

106 ià(
echo
) {

107 
‹rm
.
c_læag
 |ğ
ECHO
;

108 ()
	`tc£‰r
(
	`f’o
(
å
), 
TCSAFLUSH
 , &
‹rm
);

110 ()
	`sig´ocmask
(
SIG_SETMASK
, &
o£t
, 
NULL
);

111 ià(
å
 !ğ
¡dš
)

112 ()
	`fşo£
(
å
);

113 (
buf
);

114 
	}
}

	@options.h

5 #iâdeà
_OPTIONS_H_


6 
	#_OPTIONS_H_


	)

13 #iâdeà
DROPBEAR_DEFPORT


14 
	#DROPBEAR_DEFPORT
 "2223"

	)

17 #iâdeà
DROPBEAR_DEFADDRESS


19 
	#DROPBEAR_DEFADDRESS
 ""

	)

22 #iâdeà
DROPBEAR_HOME


23 
	#DROPBEAR_HOME
 "/sy¡em/‘c/drİb—r"

	)

27 #iâdeà
DSS_PRIV_FILENAME


28 
	#DSS_PRIV_FILENAME
 
DROPBEAR_HOME
 "/drİb—r_dss_ho¡_key"

	)

30 #iâdeà
RSA_PRIV_FILENAME


31 
	#RSA_PRIV_FILENAME
 
DROPBEAR_HOME
 "/drİb—r_r§_ho¡_key"

	)

44 
	#NON_INETD_MODE


	)

45 
	#INETD_MODE


	)

59 
	#ENABLE_X11FWD


	)

67 
	#ENABLE_CLI_LOCALTCPFWD


	)

68 
	#ENABLE_CLI_REMOTETCPFWD


	)

70 
	#ENABLE_SVR_LOCALTCPFWD


	)

71 
	#ENABLE_SVR_REMOTETCPFWD


	)

74 
	#ENABLE_SVR_AGENTFWD


	)

75 
	#ENABLE_CLI_AGENTFWD


	)

83 
	#ENABLE_CLI_PROXYCMD


	)

87 
	#ENABLE_CLI_NETCAT


	)

93 
	#DROPBEAR_AES128


	)

94 
	#DROPBEAR_3DES


	)

95 
	#DROPBEAR_AES256


	)

98 
	#DROPBEAR_TWOFISH256


	)

99 
	#DROPBEAR_TWOFISH128


	)

104 
	#DROPBEAR_ENABLE_CTR_MODE


	)

118 
	#DROPBEAR_SHA1_HMAC


	)

119 
	#DROPBEAR_SHA1_96_HMAC


	)

120 
	#DROPBEAR_MD5_HMAC


	)

126 
	#DROPBEAR_RSA


	)

127 
	#DROPBEAR_DSS


	)

132 
	#RSA_BLINDING


	)

148 #iâdeà
DROPBEAR_ZLIB_WINDOW_BITS


149 
	#DROPBEAR_ZLIB_WINDOW_BITS
 15

	)

153 
	#DO_HOST_LOOKUP


	)

157 
	#DO_MOTD


	)

160 #iâdeà
MOTD_FILENAME


161 
	#MOTD_FILENAME
 "/‘c/mÙd"

	)

173 
	#ENABLE_SVR_MASTER_PASSWORD


	)

174 
	#ENABLE_SVR_PASSWORD_AUTH


	)

177 
	#ENABLE_SVR_PUBKEY_AUTH


	)

181 #ifdeà
ENABLE_SVR_PUBKEY_AUTH


182 
	#ENABLE_SVR_PUBKEY_OPTIONS


	)

185 
	#ENABLE_CLI_PASSWORD_AUTH


	)

186 
	#ENABLE_CLI_PUBKEY_AUTH


	)

187 
	#ENABLE_CLI_INTERACT_AUTH


	)

195 
	#DROPBEAR_PASSWORD_ENV
 "DROPBEAR_PASSWORD"

	)

214 
	#DROPBEAR_RANDOM_DEV
 "/dev/u¿ndom"

	)

222 #iâdeà
MAX_UNAUTH_PER_IP


223 
	#MAX_UNAUTH_PER_IP
 5

	)

228 #iâdeà
MAX_UNAUTH_CLIENTS


229 
	#MAX_UNAUTH_CLIENTS
 30

	)

233 #iâdeà
MAX_AUTH_TRIES


234 
	#MAX_AUTH_TRIES
 10

	)

239 #iâdeà
DROPBEAR_PIDFILE


240 
	#DROPBEAR_PIDFILE
 "/d©a/drİb—r/drİb—r.pid"

	)

245 #iâdeà
XAUTH_COMMAND


246 
	#XAUTH_COMMAND
 "/u¤/bš/X11/xauth -q"

	)

252 #iâdeà
SFTPSERVER_PATH


253 
	#SFTPSERVER_PATH
 "/sy¡em/xbš/sáp-£rv”"

	)

258 
	#_PATH_SSH_PROGRAM
 "/sy¡em/xbš/ssh"

	)

272 #iâdeà
DEFAULT_RECV_WINDOW


273 
	#DEFAULT_RECV_WINDOW
 24576

	)

277 #iâdeà
RECV_MAX_PAYLOAD_LEN


278 
	#RECV_MAX_PAYLOAD_LEN
 32768

	)

282 #iâdeà
TRANS_MAX_PAYLOAD_LEN


283 
	#TRANS_MAX_PAYLOAD_LEN
 16384

	)

288 
	#DEFAULT_KEEPALIVE
 0

	)

292 
	#DEFAULT_IDLE_TIMEOUT
 0

	)

295 
	#DEFAULT_PATH
 "/u¤/bš:/u¤/sbš:/bš:/sbš:/sy¡em/sbš:/sy¡em/bš:/sy¡em/xbš:/sy¡em/xbš/bb:/d©a/loÿl/bš"

	)

297 
	#ALLOW_BLANK_PASSWORDS
 1

	)

301 
	~"sysİtiÚs.h
"

	@packet.c

25 
	~"šşudes.h
"

26 
	~"·ck‘.h
"

27 
	~"£ssiÚ.h
"

28 
	~"dbut.h
"

29 
	~"ssh.h
"

30 
	~"®go.h
"

31 
	~"bufãr.h
"

32 
	~"kex.h
"

33 
	~"¿ndom.h
"

34 
	~"£rviû.h
"

35 
	~"auth.h
"

36 
	~"chªÃl.h
"

38 
»ad_·ck‘_š™
();

39 
make_mac
(
£qno
, cÚ¡ 
key_cÚ‹xt_dœeùiÚ®
 * 
key_¡©e
,

40 
bufãr
 * 
ş—r_buf
, 
ş—r_Ën
,

41 *
ouut_mac
);

42 
checkmac
();

44 
	#ZLIB_COMPRESS_INCR
 100

	)

45 
	#ZLIB_DECOMPRESS_INCR
 100

	)

46 #iâdeà
DISABLE_ZLIB


47 
bufãr
* 
buf_decom´ess
(bufãr* 
buf
, 
Ën
);

48 
buf_com´ess
(
bufãr
 * 
de¡
, bufã¸* 
¤c
, 
Ën
);

52 
	$wr™e_·ck‘
() {

54 
Ën
, 
wr™‹n
;

55 
bufãr
 * 
wr™ebuf
 = 
NULL
;

56 
time_t
 
now
;

57 
·ck‘_ty³
;

59 
	`TRACE
(("enter write_packet"))

60 
	`drİb—r_as£¹
(!
	`i£m±y
(&
£s
.
wr™equeue
));

63 
wr™ebuf
 = (
bufãr
*)
	`examše
(&
£s
.
wr™equeue
);

67 
·ck‘_ty³
 = 
wr™ebuf
->
d©a
[wr™ebuf->
Ën
-1];

68 
Ën
 = 
wr™ebuf
->ËÀ- 1 - wr™ebuf->
pos
;

69 
	`drİb—r_as£¹
(
Ën
 > 0);

71 
wr™‹n
 = 
	`wr™e
(
£s
.
sock_out
, 
	`buf_g‘±r
(
wr™ebuf
, 
Ën
),†en);

73 ià(
wr™‹n
 < 0) {

74 ià(
”ºo
 =ğ
EINTR
) {

75 
	`TRACE
(("leave writepacket: EINTR"))

78 
	`drİb—r_ex™
("Error writing");

82 
now
 = 
	`time
(
NULL
);

83 
£s
.
Ï¡_Œx_·ck‘_time
 = 
now
;

85 ià(
·ck‘_ty³
 !ğ
SSH_MSG_IGNORE
) {

86 
£s
.
Ï¡_·ck‘_time
 = 
now
;

89 ià(
wr™‹n
 == 0) {

90 
£s
.
	`»mÙeşo£d
();

93 ià(
wr™‹n
 =ğ
Ën
) {

95 
	`dequeue
(&
£s
.
wr™equeue
);

96 
	`buf_ä“
(
wr™ebuf
);

97 
wr™ebuf
 = 
NULL
;

100 
	`buf_šüpos
(
wr™ebuf
, 
wr™‹n
);

103 
	`TRACE
(("leave write_packet"))

104 
	}
}

109 
	$»ad_·ck‘
() {

111 
Ën
;

112 
maxËn
;

113 
blocksize
;

115 
	`TRACE
(("enter„ead_packet"))

116 
blocksize
 = 
£s
.
keys
->
»cv
.
®go_üy±
->blocksize;

118 ià(
£s
.
»adbuf
 =ğ
NULL
 || ses.»adbuf->
Ën
 < 
blocksize
) {

119 
»t
;

124 
»t
 = 
	`»ad_·ck‘_š™
();

126 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

128 
	`TRACE
(("leave„ead_packet:…acketinit done"))

135 
maxËn
 = 
£s
.
»adbuf
->
Ën
 - ses.»adbuf->
pos
;

136 
Ën
 = 
	`»ad
(
£s
.
sock_š
, 
	`buf_g‘±r
(£s.
»adbuf
, 
maxËn
), maxlen);

138 ià(
Ën
 == 0) {

139 
£s
.
	`»mÙeşo£d
();

142 ià(
Ën
 < 0) {

143 ià(
”ºo
 =ğ
EINTR
 ||ƒ¼nØ=ğ
EAGAIN
) {

144 
	`TRACE
(("leave„ead_packet: EINTR or EAGAIN"))

147 
	`drİb—r_ex™
("E¼Ü„—dšg: %s", 
	`¡»¼Ü
(
”ºo
));

151 
	`buf_šüpos
(
£s
.
»adbuf
, 
Ën
);

153 ià(()
Ën
 =ğ
maxËn
) {

155 
	`deüy±_·ck‘
();

159 
	`TRACE
(("leave„ead_packet"))

160 
	}
}

166 
	$»ad_·ck‘_š™
() {

168 
maxËn
;

169 
¦’
;

170 
Ën
;

171 
blocksize
;

172 
macsize
;

175 
blocksize
 = 
£s
.
keys
->
»cv
.
®go_üy±
->blocksize;

176 
macsize
 = 
£s
.
keys
->
»cv
.
®go_mac
->
hashsize
;

178 ià(
£s
.
»adbuf
 =ğ
NULL
) {

180 
£s
.
»adbuf
 = 
	`buf_Ãw
(
INIT_READBUF
);

183 
maxËn
 = 
blocksize
 - 
£s
.
»adbuf
->
pos
;

186 
¦’
 = 
	`»ad
(
£s
.
sock_š
, 
	`buf_g‘wr™•Œ
(£s.
»adbuf
, 
maxËn
),

187 
maxËn
);

188 ià(
¦’
 == 0) {

189 
£s
.
	`»mÙeşo£d
();

191 ià(
¦’
 < 0) {

192 ià(
”ºo
 =ğ
EINTR
) {

193 
	`TRACE
(("leave„ead_packet_init: EINTR"))

194  
DROPBEAR_FAILURE
;

196 
	`drİb—r_ex™
("E¼Ü„—dšg: %s", 
	`¡»¼Ü
(
”ºo
));

199 
	`buf_šüwr™•os
(
£s
.
»adbuf
, 
¦’
);

201 ià(()
¦’
 !ğ
maxËn
) {

203  
DROPBEAR_FAILURE
;

208 
	`buf_£os
(
£s
.
»adbuf
, 0);

209 ià(
£s
.
keys
->
»cv
.
üy±_mode
->
	`deüy±
(
	`buf_g‘±r
(£s.
»adbuf
, 
blocksize
),

210 
	`buf_g‘wr™•Œ
(
£s
.
»adbuf
, 
blocksize
),

211 
blocksize
,

212 &
£s
.
keys
->
»cv
.
ch”_¡©e
è!ğ
CRYPT_OK
) {

213 
	`drİb—r_ex™
("Error decrypting");

215 
Ën
 = 
	`buf_g‘št
(
£s
.
»adbuf
è+ 4 + 
macsize
;

217 
	`TRACE
(("·ck‘ sizi %d, block %d maø%d", 
Ën
, 
blocksize
, 
macsize
))

221 ià((
Ën
 > 
RECV_MAX_PACKET_LEN
) ||

222 (
Ën
 < 
MIN_PACKET_LEN
 + 
macsize
) ||

223 ((
Ën
 - 
macsize
è% 
blocksize
 != 0)) {

224 
	`drİb—r_ex™
("IÁegr™yƒ¼Ü (bad…ack‘ siz%d)", 
Ën
);

227 ià(
Ën
 > 
£s
.
»adbuf
->
size
) {

228 
	`buf_»size
(
£s
.
»adbuf
, 
Ën
);

230 
	`buf_£’
(
£s
.
»adbuf
, 
Ën
);

231 
	`buf_£os
(
£s
.
»adbuf
, 
blocksize
);

232  
DROPBEAR_SUCCESS
;

233 
	}
}

236 
	$deüy±_·ck‘
() {

238 
blocksize
;

239 
macsize
;

240 
·dËn
;

241 
Ën
;

243 
	`TRACE
(("enter decrypt_packet"))

244 
blocksize
 = 
£s
.
keys
->
»cv
.
®go_üy±
->blocksize;

245 
macsize
 = 
£s
.
keys
->
»cv
.
®go_mac
->
hashsize
;

247 
£s
.
kex¡©e
.
d©¬ecv
 +ğ£s.
»adbuf
->
Ën
;

250 
	`buf_£os
(
£s
.
»adbuf
, 
blocksize
);

253 
Ën
 = 
£s
.
»adbuf
->ËÀ- 
macsize
 - ses.»adbuf->
pos
;

254 ià(
£s
.
keys
->
»cv
.
üy±_mode
->
	`deüy±
(

255 
	`buf_g‘±r
(
£s
.
»adbuf
, 
Ën
),

256 
	`buf_g‘wr™•Œ
(
£s
.
»adbuf
, 
Ën
),

257 
Ën
,

258 &
£s
.
keys
->
»cv
.
ch”_¡©e
è!ğ
CRYPT_OK
) {

259 
	`drİb—r_ex™
("Error decrypting");

261 
	`buf_šüpos
(
£s
.
»adbuf
, 
Ën
);

264 ià(
	`checkmac
(è!ğ
DROPBEAR_SUCCESS
) {

265 
	`drİb—r_ex™
("Integrityƒrror");

269 
	`buf_£os
(
£s
.
»adbuf
, 
PACKET_PADDING_OFF
);

270 
·dËn
 = 
	`buf_g‘by‹
(
£s
.
»adbuf
);

274 
Ën
 = 
£s
.
»adbuf
->ËÀ- 
·dËn
 - 4 - 1 - 
macsize
;

275 ià((
Ën
 > 
RECV_MAX_PAYLOAD_LEN
) || (len < 1)) {

276 
	`drİb—r_ex™
("Bad…ack‘ siz%d", 
Ën
);

279 
	`buf_£os
(
£s
.
»adbuf
, 
PACKET_PAYLOAD_OFF
);

281 #iâdeà
DISABLE_ZLIB


282 ià(
	`is_com´ess_»cv
()) {

284 
£s
.
·ylßd
 = 
	`buf_decom´ess
(£s.
»adbuf
, 
Ën
);

289 
£s
.
·ylßd
 = 
	`buf_Ãw
(
Ën
);

290 
	`memıy
(
£s
.
·ylßd
->
d©a
, 
	`buf_g‘±r
(£s.
»adbuf
, 
Ën
),†en);

291 
	`buf_šüËn
(
£s
.
·ylßd
, 
Ën
);

294 
	`buf_ä“
(
£s
.
»adbuf
);

295 
£s
.
»adbuf
 = 
NULL
;

296 
	`buf_£os
(
£s
.
·ylßd
, 0);

298 
£s
.
»cv£q
++;

300 
	`TRACE
(("leave decrypt_packet"))

301 
	}
}

305 
	$checkmac
() {

307 
mac_by‹s
[
MAX_MAC_LEN
];

308 
mac_size
, 
cÚ‹Ás_Ën
;

310 
mac_size
 = 
£s
.
keys
->
Œªs
.
®go_mac
->
hashsize
;

311 
cÚ‹Ás_Ën
 = 
£s
.
»adbuf
->
Ën
 - 
mac_size
;

313 
	`buf_£os
(
£s
.
»adbuf
, 0);

314 
	`make_mac
(
£s
.
»cv£q
, &£s.
keys
->
»cv
, ses.
»adbuf
, 
cÚ‹Ás_Ën
, 
mac_by‹s
);

317 
	`buf_£os
(
£s
.
»adbuf
, 
cÚ‹Ás_Ën
);

318 ià(
	`memcmp
(
mac_by‹s
, 
	`buf_g‘±r
(
£s
.
»adbuf
, 
mac_size
), mac_size) != 0) {

319  
DROPBEAR_FAILURE
;

321  
DROPBEAR_SUCCESS
;

323 
	}
}

325 #iâdeà
DISABLE_ZLIB


327 
bufãr
* 
	$buf_decom´ess
(
bufãr
* 
buf
, 
Ën
) {

329 
»suÉ
;

330 
bufãr
 * 
»t
;

331 
z_¡»amp
 
z¡»am
;

333 
z¡»am
 = 
£s
.
keys
->
»cv
.zstream;

334 
»t
 = 
	`buf_Ãw
(
Ën
);

336 
z¡»am
->
ava_š
 = 
Ën
;

337 
z¡»am
->
Ãxt_š
 = 
	`buf_g‘±r
(
buf
, 
Ën
);

342 
z¡»am
->
ava_out
 = 
»t
->
size
 -„‘->
pos
;

343 
z¡»am
->
Ãxt_out
 = 
	`buf_g‘wr™•Œ
(
»t
, z¡»am->
ava_out
);

345 
»suÉ
 = 
	`šæ©e
(
z¡»am
, 
Z_SYNC_FLUSH
);

347 
	`buf_£’
(
»t
,„‘->
size
 - 
z¡»am
->
ava_out
);

348 
	`buf_£os
(
»t
,„‘->
Ën
);

350 ià(
»suÉ
 !ğ
Z_BUF_ERROR
 &&„esuÉ !ğ
Z_OK
) {

351 
	`drİb—r_ex™
("zlibƒrror");

354 ià(
z¡»am
->
ava_š
 == 0 &&

355 (
z¡»am
->
ava_out
 !ğ0 || 
»suÉ
 =ğ
Z_BUF_ERROR
)) {

358  
»t
;

361 ià(
z¡»am
->
ava_out
 == 0) {

362 
	`buf_»size
(
»t
,„‘->
size
 + 
ZLIB_DECOMPRESS_INCR
);

365 
	}
}

370 
	$·ck‘_is_okay_kex
(
ty³
) {

371 ià(
ty³
 >ğ
SSH_MSG_USERAUTH_REQUEST
) {

374 ià(
ty³
 =ğ
SSH_MSG_SERVICE_REQUEST
 ||y³ =ğ
SSH_MSG_SERVICE_ACCEPT
) {

377 ià(
ty³
 =ğ
SSH_MSG_KEXINIT
) {

382 
	}
}

384 
	$’queue_»¶y_·ck‘
() {

385 
·ck‘li¡
 * 
Ãw_™em
 = 
NULL
;

386 
Ãw_™em
 = 
	`m_m®loc
((
·ck‘li¡
));

387 
Ãw_™em
->
Ãxt
 = 
NULL
;

389 
Ãw_™em
->
·ylßd
 = 
	`buf_Ãwcİy
(
£s
.
wr™•aylßd
);

390 
	`buf_£os
(
£s
.
wr™•aylßd
, 0);

391 
	`buf_£’
(
£s
.
wr™•aylßd
, 0);

393 ià(
£s
.
»¶y_queue_
) {

394 
£s
.
»¶y_queue_
->
Ãxt
 = 
Ãw_™em
;

396 
£s
.
»¶y_queue_h—d
 = 
Ãw_™em
;

398 
£s
.
»¶y_queue_
 = 
Ãw_™em
;

399 
	`TRACE
(("leaveƒnqueue_reply_packet"))

400 
	}
}

402 
	$maybe_æush_»¶y_queue
() {

403 
·ck‘li¡
 *
tmp_™em
 = 
NULL
, *
cu¼_™em
 = NULL;

404 ià(!
£s
.
d©¯Îowed
)

406 
	`TRACE
(("maybe_empty_reply_queue -‚o data‡llowed"))

410 
cu¼_™em
 = 
£s
.
»¶y_queue_h—d
; curr_item; ) {

411 
	`CHECKCLEARTOWRITE
();

412 
	`buf_putby‹s
(
£s
.
wr™•aylßd
,

413 
cu¼_™em
->
·ylßd
->
d©a
, cu¼_™em->·ylßd->
Ën
);

415 
	`buf_ä“
(
cu¼_™em
->
·ylßd
);

416 
tmp_™em
 = 
cu¼_™em
;

417 
cu¼_™em
 = cu¼_™em->
Ãxt
;

418 
	`m_ä“
(
tmp_™em
);

419 
	`’üy±_·ck‘
();

421 
£s
.
»¶y_queue_h—d
 = ses.
»¶y_queue_
 = 
NULL
;

422 
	}
}

426 
	$’üy±_·ck‘
() {

428 
·dËn
;

429 
blocksize
, 
mac_size
;

430 
bufãr
 * 
wr™ebuf
;

432 
·ck‘_ty³
;

433 
Ën
, 
’üy±_buf_size
;

434 
mac_by‹s
[
MAX_MAC_LEN
];

436 
	`TRACE
(("enterƒncrypt_packet()"))

438 
	`buf_£os
(
£s
.
wr™•aylßd
, 0);

439 
·ck‘_ty³
 = 
	`buf_g‘by‹
(
£s
.
wr™•aylßd
);

440 
	`buf_£os
(
£s
.
wr™•aylßd
, 0);

442 
	`TRACE
(("’üy±_·ck‘y³ i %d", 
·ck‘_ty³
))

444 ià(!
£s
.
d©¯Îowed
 && !
	`·ck‘_is_okay_kex
(
·ck‘_ty³
)) {

448 
	`’queue_»¶y_·ck‘
();

452 
blocksize
 = 
£s
.
keys
->
Œªs
.
®go_üy±
->blocksize;

453 
mac_size
 = 
£s
.
keys
->
Œªs
.
®go_mac
->
hashsize
;

458 
’üy±_buf_size
 = (
£s
.
wr™•aylßd
->
Ën
+4+1)

459 + 
	`MAX
(
MIN_PACKET_LEN
, 
blocksize
) + 3

461 + 
mac_size


462 #iâdeà
DISABLE_ZLIB


464 + 
ZLIB_COMPRESS_INCR


470 
wr™ebuf
 = 
	`buf_Ãw
(
’üy±_buf_size
);

471 
	`buf_£’
(
wr™ebuf
, 
PACKET_PAYLOAD_OFF
);

472 
	`buf_£os
(
wr™ebuf
, 
PACKET_PAYLOAD_OFF
);

474 #iâdeà
DISABLE_ZLIB


476 ià(
	`is_com´ess_Œªs
()) {

477 
com´ess_d–
;

478 
	`buf_com´ess
(
wr™ebuf
, 
£s
.
wr™•aylßd
, ses.wr™•aylßd->
Ën
);

479 
com´ess_d–
 = (
wr™ebuf
->
Ën
 - 
PACKET_PAYLOAD_OFF
è- 
£s
.
wr™•aylßd
->len;

482 ià(
com´ess_d–
 > 
ZLIB_COMPRESS_INCR
) {

483 
	`buf_»size
(
wr™ebuf
, wr™ebuf->
size
 + 
com´ess_d–
);

488 
	`memıy
(
	`buf_g‘wr™•Œ
(
wr™ebuf
, 
£s
.
wr™•aylßd
->
Ën
),

489 
	`buf_g‘±r
(
£s
.
wr™•aylßd
, ses.wr™•aylßd->
Ën
),

490 
£s
.
wr™•aylßd
->
Ën
);

491 
	`buf_šüwr™•os
(
wr™ebuf
, 
£s
.
wr™•aylßd
->
Ën
);

495 
	`buf_£os
(
£s
.
wr™•aylßd
, 0);

496 
	`buf_£’
(
£s
.
wr™•aylßd
, 0);

500 
·dËn
 = 
blocksize
 - (
wr™ebuf
->
Ën
) % blocksize;

501 ià(
·dËn
 < 4) {

502 
·dËn
 +ğ
blocksize
;

505 ià(
wr™ebuf
->
Ën
 + 
·dËn
 < 
MIN_PACKET_LEN
) {

506 
·dËn
 +ğ
blocksize
;

509 
	`buf_£os
(
wr™ebuf
, 0);

511 
	`buf_putšt
(
wr™ebuf
, wr™ebuf->
Ën
 + 
·dËn
 - 4);

514 
	`buf_putby‹
(
wr™ebuf
, 
·dËn
);

516 
	`buf_£os
(
wr™ebuf
, wr™ebuf->
Ën
);

517 
	`buf_šüËn
(
wr™ebuf
, 
·dËn
);

518 
	`g’¿ndom
(
	`buf_g‘±r
(
wr™ebuf
, 
·dËn
),…adlen);

520 
	`make_mac
(
£s
.
Œªs£q
, &£s.
keys
->
Œªs
, 
wr™ebuf
, wr™ebuf->
Ën
, 
mac_by‹s
);

523 
	`buf_£os
(
wr™ebuf
, 0);

525 
Ën
 = 
wr™ebuf
->len;

526 ià(
£s
.
keys
->
Œªs
.
üy±_mode
->
	`’üy±
(

527 
	`buf_g‘±r
(
wr™ebuf
, 
Ën
),

528 
	`buf_g‘wr™•Œ
(
wr™ebuf
, 
Ën
),

529 
Ën
,

530 &
£s
.
keys
->
Œªs
.
ch”_¡©e
è!ğ
CRYPT_OK
) {

531 
	`drİb—r_ex™
("Errorƒncrypting");

533 
	`buf_šüpos
(
wr™ebuf
, 
Ën
);

536 
	`buf_putby‹s
(
wr™ebuf
, 
mac_by‹s
, 
mac_size
);

540 
	`buf_putby‹
(
wr™ebuf
, 
·ck‘_ty³
);

542 
	`buf_£os
(
wr™ebuf
, 0);

543 
	`’queue
(&
£s
.
wr™equeue
, (*)
wr™ebuf
);

546 
£s
.
kex¡©e
.
d©©¿ns
 +ğ
wr™ebuf
->
Ën
;

547 
£s
.
Œªs£q
++;

549 
	`TRACE
(("leaveƒncrypt_packet()"))

550 
	}
}

555 
	$make_mac
(
£qno
, cÚ¡ 
key_cÚ‹xt_dœeùiÚ®
 * 
key_¡©e
,

556 
bufãr
 * 
ş—r_buf
, 
ş—r_Ën
,

557 *
ouut_mac
) {

558 
£qbuf
[4];

559 
bufsize
;

560 
hmac_¡©e
 
hmac
;

562 
	`TRACE
(("enter writemac"))

564 ià(
key_¡©e
->
®go_mac
->
hashsize
 > 0) {

566 ià(
	`hmac_š™
(&
hmac
,

567 
key_¡©e
->
hash_šdex
,

568 
key_¡©e
->
mackey
,

569 
key_¡©e
->
®go_mac
->
keysize
è!ğ
CRYPT_OK
) {

570 
	`drİb—r_ex™
("HMACƒrror");

574 
	`STORE32H
(
£qno
, 
£qbuf
);

575 ià(
	`hmac_´oûss
(&
hmac
, 
£qbuf
, 4è!ğ
CRYPT_OK
) {

576 
	`drİb—r_ex™
("HMACƒrror");

580 
	`buf_£os
(
ş—r_buf
, 0);

581 ià(
	`hmac_´oûss
(&
hmac
,

582 
	`buf_g‘±r
(
ş—r_buf
, 
ş—r_Ën
),

583 
ş—r_Ën
è!ğ
CRYPT_OK
) {

584 
	`drİb—r_ex™
("HMACƒrror");

587 
bufsize
 = 
MAX_MAC_LEN
;

588 ià(
	`hmac_dÚe
(&
hmac
, 
ouut_mac
, &
bufsize
è!ğ
CRYPT_OK
) {

589 
	`drİb—r_ex™
("HMACƒrror");

592 
	`TRACE
(("leave writemac"))

593 
	}
}

595 #iâdeà
DISABLE_ZLIB


598 
	$buf_com´ess
(
bufãr
 * 
de¡
, bufã¸* 
¤c
, 
Ën
) {

600 
’dpos
 = 
¤c
->
pos
 + 
Ën
;

601 
»suÉ
;

603 
	`TRACE
(("enter buf_compress"))

607 
£s
.
keys
->
Œªs
.
z¡»am
->
ava_š
 = 
’dpos
 - 
¤c
->
pos
;

608 
£s
.
keys
->
Œªs
.
z¡»am
->
Ãxt_š
 =

609 
	`buf_g‘±r
(
¤c
, 
£s
.
keys
->
Œªs
.
z¡»am
->
ava_š
);

611 
£s
.
keys
->
Œªs
.
z¡»am
->
ava_out
 = 
de¡
->
size
 - de¡->
pos
;

612 
£s
.
keys
->
Œªs
.
z¡»am
->
Ãxt_out
 =

613 
	`buf_g‘wr™•Œ
(
de¡
, 
£s
.
keys
->
Œªs
.
z¡»am
->
ava_out
);

615 
»suÉ
 = 
	`deæ©e
(
£s
.
keys
->
Œªs
.
z¡»am
, 
Z_SYNC_FLUSH
);

617 
	`buf_£os
(
¤c
, 
’dpos
 - 
£s
.
keys
->
Œªs
.
z¡»am
->
ava_š
);

618 
	`buf_£’
(
de¡
, de¡->
size
 - 
£s
.
keys
->
Œªs
.
z¡»am
->
ava_out
);

619 
	`buf_£os
(
de¡
, de¡->
Ën
);

621 ià(
»suÉ
 !ğ
Z_OK
) {

622 
	`drİb—r_ex™
("zlibƒrror");

625 ià(
£s
.
keys
->
Œªs
.
z¡»am
->
ava_š
 == 0) {

629 
	`drİb—r_as£¹
(
£s
.
keys
->
Œªs
.
z¡»am
->
ava_out
 == 0);

634 
	`buf_»size
(
de¡
, de¡->
size
 + 
ZLIB_COMPRESS_INCR
);

637 
	`TRACE
(("leave buf_compress"))

638 
	}
}

	@packet.h

25 #iâdeà
_PACKET_H_


27 
	#_PACKET_H_


	)

29 
	~"šşudes.h
"

31 
wr™e_·ck‘
();

32 
»ad_·ck‘
();

33 
deüy±_·ck‘
();

34 
’üy±_·ck‘
();

36 
´oûss_·ck‘
();

38 
maybe_æush_»¶y_queue
();

39 
	sPack‘Ty³
 {

40 
	mty³
;

41 (*
	mhªdËr
)();

42 } 
	t·ck‘ty³
;

44 
	#PACKET_PADDING_OFF
 4

	)

45 
	#PACKET_PAYLOAD_OFF
 5

	)

47 
	#INIT_READBUF
 128

	)

	@process-packet.c

25 
	~"šşudes.h
"

26 
	~"·ck‘.h
"

27 
	~"£ssiÚ.h
"

28 
	~"dbut.h
"

29 
	~"ssh.h
"

30 
	~"®go.h
"

31 
	~"bufãr.h
"

32 
	~"kex.h
"

33 
	~"¿ndom.h
"

34 
	~"£rviû.h
"

35 
	~"auth.h
"

36 
	~"chªÃl.h
"

38 
	#MAX_UNAUTH_PACKET_TYPE
 
SSH_MSG_USERAUTH_PK_OK


	)

40 
»cv_unim¶em’‹d
();

43 
	$´oûss_·ck‘
() {

45 
ty³
;

46 
i
;

48 
	`TRACE
(("enter…rocess_packet"))

50 
ty³
 = 
	`buf_g‘by‹
(
£s
.
·ylßd
);

51 
	`TRACE
(("´oûss_·ck‘:…ack‘y³ = %d", 
ty³
))

53 
£s
.
Ï¡·ck‘
 = 
ty³
;

55 
£s
.
Ï¡_·ck‘_time
 = 
	`time
(
NULL
);

58 
ty³
) {

60 
SSH_MSG_IGNORE
:

61 
out
;

62 
SSH_MSG_DEBUG
:

63 
out
;

65 
SSH_MSG_UNIMPLEMENTED
:

67 
	`TRACE
(("SSH_MSG_UNIMPLEMENTED"))

68 
	`drİb—r_ex™
("Received SSH_MSG_UNIMPLEMENTED");

70 
SSH_MSG_DISCONNECT
:

72 
	`drİb—r_şo£
("Disconnect„eceived");

77 ià(
£s
.
»quœ’ext
 != 0) {

78 ià(
£s
.
»quœ’ext
 !ğ
ty³
) {

80 
	`drİb—r_ex™
("UÃx³ùed…ack‘y³ %d,ƒx³ùed %d", 
ty³
,

81 
£s
.
»quœ’ext
);

84 
£s
.
»quœ’ext
 = 0;

90 ià(
£s
.
ignÜ’ext
) {

91 
	`TRACE
(("IgnÜšg…ack‘,y³ = %d", 
ty³
))

92 
£s
.
ignÜ’ext
 = 0;

93 
out
;

101 iàĞ!
£s
.
auth¡©e
.
authdÚe
 && 
ty³
 > 
MAX_UNAUTH_PACKET_TYPE
 ) {

102 
	`drİb—r_ex™
("Reûived mes§g%d befÜu£¿uth", 
ty³
);

105 
i
 = 0; ; i++) {

106 ià(
£s
.
·ck‘ty³s
[
i
].
ty³
 == 0) {

111 ià(
£s
.
·ck‘ty³s
[
i
].
ty³
 ==ype) {

112 
£s
.
·ck‘ty³s
[
i
].
	`hªdËr
();

113 
out
;

119 
	`TRACE
(("preauth unknown…acket"))

120 
	`»cv_unim¶em’‹d
();

122 
out
:

123 
	`buf_ä“
(
£s
.
·ylßd
);

124 
£s
.
·ylßd
 = 
NULL
;

126 
	`TRACE
(("leave…rocess_packet"))

127 
	}
}

135 
	$»cv_unim¶em’‹d
() {

137 
	`CHECKCLEARTOWRITE
();

139 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_UNIMPLEMENTED
);

142 
	`buf_putšt
(
£s
.
wr™•aylßd
, ses.
»cv£q
 - 1);

144 
	`’üy±_·ck‘
();

145 
	}
}

	@progressmeter.c

1 #ifdeà
PROGRESS_METER


26 
	~"šşudes.h
"

29 
	~"´og»ssm‘”.h
"

30 
	~"©omicio.h
"

31 
	~"sımisc.h
"

33 
	#DEFAULT_WINSIZE
 80

	)

34 
	#MAX_WINSIZE
 512

	)

35 
	#PADDING
 1

	)

36 
	#UPDATE_INTERVAL
 1

	)

37 
	#STALL_TIME
 5

	)

40 
ÿn_ouut
();

43 
fÜm©_size
(*, , 
off_t
);

44 
fÜm©_¿‹
(*, , 
off_t
);

47 
sig_wšch
();

48 
£tsü“nsize
();

51 
»äesh_´og»ss_m‘”
();

54 
upd©e_´og»ss_m‘”
();

56 
time_t
 
	g¡¬t
;

57 
time_t
 
	gÏ¡_upd©e
;

58 *
	gfe
;

59 
off_t
 
	g’d_pos
;

60 
off_t
 
	gcur_pos
;

61 vŞ©
off_t
 *
	gcouÁ”
;

62 
	g¡®Ëd
;

63 
	gby‹s_³r_£cÚd
;

64 
	gwš_size
;

65 vŞ©
sig_©omic_t
 
	gwš_»sized
;

68 cÚ¡ 
	gun™
[] = " KMGT";

71 
	$ÿn_ouut
()

73  (
	`g‘pg½
(è=ğ
	`tcg‘pg½
(
STDOUT_FILENO
));

74 
	}
}

77 
	$fÜm©_¿‹
(*
buf
, 
size
, 
off_t
 
by‹s
)

79 
i
;

81 
by‹s
 *= 100;

82 
i
 = 0; 
by‹s
 >ğ100*1000 && 
un™
[i] != 'T'; i++)

83 
by‹s
 = (bytes + 512) / 1024;

84 ià(
i
 == 0) {

85 
i
++;

86 
by‹s
 = (bytes + 512) / 1024;

88 
	`¢´štf
(
buf
, 
size
, "%3lld.%1lld%c%s",

89 (è(
by‹s
 + 5) / 100,

90 (è(
by‹s
 + 5) / 10 % 10,

91 
un™
[
i
],

92 
i
 ? "B" : " ");

93 
	}
}

96 
	$fÜm©_size
(*
buf
, 
size
, 
off_t
 
by‹s
)

98 
i
;

100 
i
 = 0; 
by‹s
 >ğ10000 && 
un™
[i] != 'T'; i++)

101 
by‹s
 = (bytes + 512) / 1024;

102 
	`¢´štf
(
buf
, 
size
, "%4lld%c%s",

103 (è
by‹s
,

104 
un™
[
i
],

105 
i
 ? "B" : " ");

106 
	}
}

109 
	$»äesh_´og»ss_m‘”
()

111 
buf
[
MAX_WINSIZE
 + 1];

112 
time_t
 
now
;

113 
off_t
 
Œªsã¼ed
;

114 
–­£d
;

115 
³rûÁ
;

116 
off_t
 
by‹s_Ëá
;

117 
cur_¥“d
;

118 
hours
, 
mšu‹s
, 
£cÚds
;

119 
i
, 
Ën
;

120 
fe_Ën
;

122 
Œªsã¼ed
 = *
couÁ”
 - 
cur_pos
;

123 
cur_pos
 = *
couÁ”
;

124 
now
 = 
	`time
(
NULL
);

125 
by‹s_Ëá
 = 
’d_pos
 - 
cur_pos
;

127 ià(
by‹s_Ëá
 > 0)

128 
–­£d
 = 
now
 - 
Ï¡_upd©e
;

130 
–­£d
 = 
now
 - 
¡¬t
;

132 
Œªsã¼ed
 = 
’d_pos
;

133 
by‹s_³r_£cÚd
 = 0;

137 ià(
–­£d
 != 0)

138 
cur_¥“d
 = (
Œªsã¼ed
 / 
–­£d
);

140 
cur_¥“d
 = 
Œªsã¼ed
;

142 
	#AGE_FACTOR
 0.9

	)

143 ià(
by‹s_³r_£cÚd
 != 0) {

144 
by‹s_³r_£cÚd
 = (by‹s_³r_£cÚd * 
AGE_FACTOR
) +

145 (
cur_¥“d
 * (1.0 - 
AGE_FACTOR
));

147 
by‹s_³r_£cÚd
 = 
cur_¥“d
;

150 
buf
[0] = '\0';

151 
fe_Ën
 = 
wš_size
 - 35;

152 ià(
fe_Ën
 > 0) {

153 
Ën
 = 
	`¢´štf
(
buf
, 
fe_Ën
 + 1, "\r%s", 
fe
);

154 ià(
Ën
 < 0)

155 
Ën
 = 0;

156 ià(
Ën
 >ğ
fe_Ën
 + 1)

157 
Ën
 = 
fe_Ën
;

158 
i
 = 
Ën
; i < 
fe_Ën
; i++ )

159 
buf
[
i
] = ' ';

160 
buf
[
fe_Ën
] = '\0';

164 ià(
’d_pos
 != 0)

165 
³rûÁ
 = (()
cur_pos
 / 
’d_pos
) * 100;

167 
³rûÁ
 = 100;

168 
	`¢´štf
(
buf
 + 
	`¡¾’
(buf), 
wš_size
 - strlen(buf),

169 " %3d%% ", 
³rûÁ
);

172 
	`fÜm©_size
(
buf
 + 
	`¡¾’
(buf), 
wš_size
 - strlen(buf),

173 
cur_pos
);

174 
	`¡¾ÿt
(
buf
, " ", 
wš_size
);

177 
	`fÜm©_¿‹
(
buf
 + 
	`¡¾’
(buf), 
wš_size
 - strlen(buf),

178 (
off_t
)
by‹s_³r_£cÚd
);

179 
	`¡¾ÿt
(
buf
, "/ ", 
wš_size
);

182 ià(!
Œªsã¼ed
)

183 
¡®Ëd
 +ğ
–­£d
;

185 
¡®Ëd
 = 0;

187 ià(
¡®Ëd
 >ğ
STALL_TIME
)

188 
	`¡¾ÿt
(
buf
, "- sÎed -", 
wš_size
);

189 ià(
by‹s_³r_£cÚd
 =ğ0 && 
by‹s_Ëá
)

190 
	`¡¾ÿt
(
buf
, " --:-- ETA", 
wš_size
);

192 ià(
by‹s_Ëá
 > 0)

193 
£cÚds
 = 
by‹s_Ëá
 / 
by‹s_³r_£cÚd
;

195 
£cÚds
 = 
–­£d
;

197 
hours
 = 
£cÚds
 / 3600;

198 
£cÚds
 -ğ
hours
 * 3600;

199 
mšu‹s
 = 
£cÚds
 / 60;

200 
£cÚds
 -ğ
mšu‹s
 * 60;

202 ià(
hours
 != 0)

203 
	`¢´štf
(
buf
 + 
	`¡¾’
(buf), 
wš_size
 - strlen(buf),

204 "%d:%02d:%02d", 
hours
, 
mšu‹s
, 
£cÚds
);

206 
	`¢´štf
(
buf
 + 
	`¡¾’
(buf), 
wš_size
 - strlen(buf),

207 " %02d:%02d", 
mšu‹s
, 
£cÚds
);

209 ià(
by‹s_Ëá
 > 0)

210 
	`¡¾ÿt
(
buf
, " ETA", 
wš_size
);

212 
	`¡¾ÿt
(
buf
, " ", 
wš_size
);

215 
	`©omicio
(
vwr™e
, 
STDOUT_FILENO
, 
buf
, 
wš_size
 - 1);

216 
Ï¡_upd©e
 = 
now
;

217 
	}
}

220 
	$upd©e_´og»ss_m‘”
(
ignÜe
)

222 
§ve_”ºo
;

224 
§ve_”ºo
 = 
”ºo
;

226 ià(
wš_»sized
) {

227 
	`£tsü“nsize
();

228 
wš_»sized
 = 0;

230 ià(
	`ÿn_ouut
())

231 
	`»äesh_´og»ss_m‘”
();

233 
	`sigÇl
(
SIGALRM
, 
upd©e_´og»ss_m‘”
);

234 
	`®¬m
(
UPDATE_INTERVAL
);

235 
”ºo
 = 
§ve_”ºo
;

236 
	}
}

239 
	$¡¬t_´og»ss_m‘”
(*
f
, 
off_t
 
fesize
, off_ˆ*
ùr
)

241 
¡¬t
 = 
Ï¡_upd©e
 = 
	`time
(
NULL
);

242 
fe
 = 
f
;

243 
’d_pos
 = 
fesize
;

244 
cur_pos
 = 0;

245 
couÁ”
 = 
ùr
;

246 
¡®Ëd
 = 0;

247 
by‹s_³r_£cÚd
 = 0;

249 
	`£tsü“nsize
();

250 ià(
	`ÿn_ouut
())

251 
	`»äesh_´og»ss_m‘”
();

253 
	`sigÇl
(
SIGALRM
, 
upd©e_´og»ss_m‘”
);

254 
	`sigÇl
(
SIGWINCH
, 
sig_wšch
);

255 
	`®¬m
(
UPDATE_INTERVAL
);

256 
	}
}

259 
	$¡İ_´og»ss_m‘”
()

261 
	`®¬m
(0);

263 ià(!
	`ÿn_ouut
())

267 ià(
cur_pos
 !ğ
’d_pos
)

268 
	`»äesh_´og»ss_m‘”
();

270 
	`©omicio
(
vwr™e
, 
STDOUT_FILENO
, "\n", 1);

271 
	}
}

274 
	$sig_wšch
(
sig
)

276 
wš_»sized
 = 1;

277 
	}
}

280 
	$£tsü“nsize
()

282 
wšsize
 winsize;

284 ià(
	`ioùl
(
STDOUT_FILENO
, 
TIOCGWINSZ
, &
wšsize
) != -1 &&

285 
wšsize
.
ws_cŞ
 != 0) {

286 ià(
wšsize
.
ws_cŞ
 > 
MAX_WINSIZE
)

287 
wš_size
 = 
MAX_WINSIZE
;

289 
wš_size
 = 
wšsize
.
ws_cŞ
;

291 
wš_size
 = 
DEFAULT_WINSIZE
;

292 
wš_size
 += 1;

293 
	}
}

	@progressmeter.h

26 
¡¬t_´og»ss_m‘”
(*, 
off_t
, off_t *);

27 
¡İ_´og»ss_m‘”
();

	@queue.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"queue.h
"

29 
	$š™queue
(
Queue
* 
queue
) {

31 
queue
->
h—d
 = 
NULL
;

32 
queue
->

 = 
NULL
;

33 
queue
->
couÁ
 = 0;

34 
	}
}

36 
	$i£m±y
(
Queue
* 
queue
) {

38  (
queue
->
h—d
 =ğ
NULL
);

39 
	}
}

41 * 
	$dequeue
(
Queue
* 
queue
) {

43 * 
»t
;

44 
Lšk
* 
Şdh—d
;

45 
	`drİb—r_as£¹
(!
	`i£m±y
(
queue
));

47 
»t
 = 
queue
->
h—d
->
™em
;

48 
Şdh—d
 = 
queue
->
h—d
;

50 ià(
Şdh—d
->
lšk
 !ğ
NULL
) {

51 
queue
->
h—d
 = 
Şdh—d
->
lšk
;

53 
queue
->
h—d
 = 
NULL
;

54 
queue
->

 = 
NULL
;

55 
	`TRACE
(("empty queue dequeing"))

58 
	`m_ä“
(
Şdh—d
);

59 
queue
->
couÁ
--;

60  
»t
;

61 
	}
}

63 *
	$examše
(
Queue
* 
queue
) {

65 
	`drİb—r_as£¹
(!
	`i£m±y
(
queue
));

66  
queue
->
h—d
->
™em
;

67 
	}
}

69 
	$’queue
(
Queue
* 
queue
, * 
™em
) {

71 
Lšk
* 
Ãwlšk
;

73 
	`TRACE
(("enterƒnqueue"))

74 
Ãwlšk
 = (
Lšk
*)
	`m_m®loc
((Link));

76 
Ãwlšk
->
™em
 = item;

77 
Ãwlšk
->
lšk
 = 
NULL
;

79 ià(
queue
->

 !ğ
NULL
) {

80 
queue
->

->
lšk
 = 
Ãwlšk
;

82 
queue
->

 = 
Ãwlšk
;

84 ià(
queue
->
h—d
 =ğ
NULL
) {

85 
queue
->
h—d
 = 
Ãwlšk
;

87 
queue
->
couÁ
++;

88 
	`TRACE
(("leaveƒnqueue"))

89 
	}
}

	@queue.h

25 #iâdeà
_QUEUE_H_


26 
	#_QUEUE_H_


	)

28 
	sLšk
 {

30 * 
	m™em
;

31 
Lšk
* 
	mlšk
;

35 
	sQueue
 {

37 
Lšk
* 
	mh—d
;

38 
Lšk
* 
	m
;

39 
	mcouÁ
;

43 
š™queue
(
Queue
* 
queue
);

44 
i£m±y
(
Queue
* 
queue
);

45 * 
dequeue
(
Queue
* 
queue
);

46 *
examše
(
Queue
* 
queue
);

47 
’queue
(
Queue
* 
queue
, * 
™em
);

	@random.c

25 
	~"šşudes.h
"

26 
	~"bufãr.h
"

27 
	~"dbut.h
"

28 
	~"bignum.h
"

30 
	gdÚ”ªdš™
 = 0;

33 
ušt32_t
 
	gcouÁ”
 = 0;

35 
	#MAX_COUNTER
 1<<30

	)

37 
	ghashpoŞ
[
SHA1_HASH_SIZE
];

39 
	#INIT_SEED_SIZE
 32

	)

41 
»ad¿nd
(* 
buf
, 
buæ’
);

53 
	$»ad¿nd
(* 
buf
, 
buæ’
) {

55 
®»ady_blocked
 = 0;

56 
»adfd
;

57 
»adpos
;

58 
»adËn
;

59 #ifdeà
DROPBEAR_PRNGD_SOCKET


60 
sockaddr_un
 
egdsock
;

61 
egdcmd
[2];

64 #ifdeà
DROPBEAR_RANDOM_DEV


65 
»adfd
 = 
	`İ’
(
DROPBEAR_RANDOM_DEV
, 
O_RDONLY
);

66 ià(
»adfd
 < 0) {

67 
	`drİb—r_ex™
("Couldn't open„andom device");

71 #ifdeà
DROPBEAR_PRNGD_SOCKET


72 
»adfd
 = 
	`cÚÃù_unix
(
DROPBEAR_PRNGD_SOCKET
);

74 ià(
»adfd
 < 0) {

75 
	`drİb—r_ex™
("Couldn't open„andom device");

78 ià(
buæ’
 > 255)

79 
	`drİb—r_ex™
("Can't„equest morehan 255 bytes fromƒgd");

80 
egdcmd
[0] = 0x02;

81 
egdcmd
[1] = ()
buæ’
;

82 ià(
	`wr™e
(
»adfd
, 
egdcmd
, 2) < 0)

83 
	`drİb—r_ex™
("Can't send commandoƒgd");

87 
»adpos
 = 0;

89 ià(!
®»ady_blocked
)

91 
»t
;

92 
timev®
 
timeout
;

93 
fd_£t
 
»ad_fds
;

95 
timeout
.
tv_£c
 = 2;

96 
timeout
.
tv_u£c
 = 0;

98 
	`FD_ZERO
(&
»ad_fds
);

99 
	`FD_SET
(
»adfd
, &
»ad_fds
);

100 
»t
 = 
	`£Ëù
(
»adfd
 + 1, &
»ad_fds
, 
NULL
, NULL, &
timeout
);

101 ià(
»t
 == 0)

103 
	`drİb—r_log
(
LOG_INFO
, "Warning: Readinghe„andom source seemso have blocked.\nIf youƒxperience…roblems, you…robably‚eedo find‡ betterƒntropy source.");

104 
®»ady_blocked
 = 1;

107 
»adËn
 = 
	`»ad
(
»adfd
, &
buf
[
»adpos
], 
buæ’
 -„eadpos);

108 ià(
»adËn
 <= 0) {

109 ià(
»adËn
 < 0 && 
”ºo
 =ğ
EINTR
) {

112 
	`drİb—r_ex™
("Error„eading„andom source");

114 
»adpos
 +ğ
»adËn
;

115 } 
»adpos
 < 
buæ’
);

117 
	`şo£
 (
»adfd
);

118 
	}
}

121 
	$£ed¿ndom
() {

123 
»adbuf
[
INIT_SEED_SIZE
];

125 
hash_¡©e
 
hs
;

129 ià(!
dÚ”ªdš™
) {

130 
	`m_buº
(
hashpoŞ
, (hashpool));

134 
	`»ad¿nd
(
»adbuf
, (readbuf));

137 
	`sha1_š™
(&
hs
);

138 
	`sha1_´oûss
(&
hs
, (*)
hashpoŞ
, (hashpool));

139 
	`sha1_´oûss
(&
hs
, (*)
»adbuf
, (readbuf));

140 
	`sha1_dÚe
(&
hs
, 
hashpoŞ
);

142 
couÁ”
 = 0;

143 
dÚ”ªdš™
 = 1;

144 
	}
}

149 
	$»£ed¿ndom
() {

151 
pid_t
 
pid
;

152 
hash_¡©e
 
hs
;

153 
timev®
 
tv
;

155 ià(!
dÚ”ªdš™
) {

156 
	`drİb—r_ex™
("seedrandom‚ot done");

159 
pid
 = 
	`g‘pid
();

160 
	`g‘timeofday
(&
tv
, 
NULL
);

162 
	`sha1_š™
(&
hs
);

163 
	`sha1_´oûss
(&
hs
, (*)
hashpoŞ
, (hashpool));

164 
	`sha1_´oûss
(&
hs
, (*)&
pid
, (pid));

165 
	`sha1_´oûss
(&
hs
, (*)&
tv
, (tv));

166 
	`sha1_dÚe
(&
hs
, 
hashpoŞ
);

167 
	}
}

170 
	$g’¿ndom
(* 
buf
, 
Ën
) {

172 
hash_¡©e
 
hs
;

173 
hash
[
SHA1_HASH_SIZE
];

174 
cİyËn
;

176 ià(!
dÚ”ªdš™
) {

177 
	`drİb—r_ex™
("seedrandom‚ot done");

180 
Ën
 > 0) {

181 
	`sha1_š™
(&
hs
);

182 
	`sha1_´oûss
(&
hs
, (*)
hashpoŞ
, (hashpool));

183 
	`sha1_´oûss
(&
hs
, (*)&
couÁ”
, (counter));

184 
	`sha1_dÚe
(&
hs
, 
hash
);

186 
couÁ”
++;

187 ià(
couÁ”
 > 
MAX_COUNTER
) {

188 
	`£ed¿ndom
();

191 
cİyËn
 = 
	`MIN
(
Ën
, 
SHA1_HASH_SIZE
);

192 
	`memıy
(
buf
, 
hash
, 
cİyËn
);

193 
Ën
 -ğ
cİyËn
;

194 
buf
 +ğ
cİyËn
;

196 
	`m_buº
(
hash
, (hash));

197 
	}
}

204 
	$g’_¿ndom_mpšt
(
mp_št
 *
max
, mp_šˆ*
¿nd
) {

206 *
¿ndbuf
 = 
NULL
;

207 
Ën
 = 0;

208 cÚ¡ 
masks
[] = {0xff, 0x01, 0x03, 0x07, 0x0f, 0x1f, 0x3f, 0x7f};

210 cÚ¡ 
size_b™s
 = 
	`mp_couÁ_b™s
(
max
);

212 
Ën
 = 
size_b™s
 / 8;

213 ià((
size_b™s
 % 8) != 0) {

214 
Ën
 += 1;

217 
¿ndbuf
 = (*)
	`m_m®loc
(
Ën
);

219 
	`g’¿ndom
(
¿ndbuf
, 
Ën
);

222 
¿ndbuf
[0] &ğ
masks
[
size_b™s
 % 8];

224 
	`by‹s_to_mp
(
¿nd
, 
¿ndbuf
, 
Ën
);

228 } 
	`mp_cmp
(
¿nd
, 
max
è!ğ
MP_LT
);

229 
	`m_buº
(
¿ndbuf
, 
Ën
);

230 
	`m_ä“
(
¿ndbuf
);

231 
	}
}

	@random.h

25 #iâdeà
_RANDOM_H_


26 
	#_RANDOM_H_


	)

28 
	gmp_št
;

30 
£ed¿ndom
();

31 
»£ed¿ndom
();

32 
g’¿ndom
(* 
buf
, 
Ën
);

33 
add¿ndom
(* 
buf
, 
Ën
);

34 
g’_¿ndom_mpšt
(
mp_št
 *
max
, mp_šˆ*
¿nd
);

	@rsa.c

31 
	~"šşudes.h
"

32 
	~"dbut.h
"

33 
	~"bignum.h
"

34 
	~"r§.h
"

35 
	~"bufãr.h
"

36 
	~"ssh.h
"

37 
	~"¿ndom.h
"

39 #ifdeà
DROPBEAR_RSA


41 
r§_·d_em
(
drİb—r_r§_key
 * 
key
,

42 cÚ¡ * 
d©a
, 
Ën
,

43 
mp_št
 * 
r§_em
);

49 
	$buf_g‘_r§_pub_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
) {

51 
»t
 = 
DROPBEAR_FAILURE
;

52 
	`TRACE
(("enter buf_get_rsa_pub_key"))

53 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

54 
key
->
e
 = 
	`m_m®loc
((
mp_št
));

55 
key
->
n
 = 
	`m_m®loc
((
mp_št
));

56 
	`m_mp_š™_muÉi
(
key
->
e
, key->
n
, 
NULL
);

57 
key
->
d
 = 
NULL
;

58 
key
->
p
 = 
NULL
;

59 
key
->
q
 = 
NULL
;

61 
	`buf_šüpos
(
buf
, 4+
SSH_SIGNKEY_RSA_LEN
);

63 ià(
	`buf_g‘mpšt
(
buf
, 
key
->
e
è=ğ
DROPBEAR_FAILURE


64 || 
	`buf_g‘mpšt
(
buf
, 
key
->
n
è=ğ
DROPBEAR_FAILURE
) {

65 
	`TRACE
(("leave buf_get_rsa_pub_key: failure"))

66 
out
;

69 ià(
	`mp_couÁ_b™s
(
key
->
n
è< 
MIN_RSA_KEYLEN
) {

70 
	`drİb—r_log
(
LOG_WARNING
, "RSA keyoo short");

71 
out
;

74 
	`TRACE
(("leave buf_get_rsa_pub_key: success"))

75 
»t
 = 
DROPBEAR_SUCCESS
;

76 
out
:

77 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

78 
	`m_ä“
(
key
->
e
);

79 
	`m_ä“
(
key
->
n
);

81  
»t
;

82 
	}
}

87 
	$buf_g‘_r§_´iv_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
) {

88 
»t
 = 
DROPBEAR_FAILURE
;

90 
	`TRACE
(("enter buf_get_rsa_priv_key"))

91 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

93 ià(
	`buf_g‘_r§_pub_key
(
buf
, 
key
è=ğ
DROPBEAR_FAILURE
) {

94 
	`TRACE
(("leave buf_get_rsa_priv_key:…ub:„et == DROPBEAR_FAILURE"))

95  
DROPBEAR_FAILURE
;

98 
key
->
d
 = 
NULL
;

99 
key
->
p
 = 
NULL
;

100 
key
->
q
 = 
NULL
;

102 
key
->
d
 = 
	`m_m®loc
((
mp_št
));

103 
	`m_mp_š™
(
key
->
d
);

104 ià(
	`buf_g‘mpšt
(
buf
, 
key
->
d
è=ğ
DROPBEAR_FAILURE
) {

105 
	`TRACE
(("leave buf_get_rsa_priv_key: d:„et == DROPBEAR_FAILURE"))

106 
out
;

109 ià(
buf
->
pos
 =ğbuf->
Ën
) {

112 
key
->
p
 = 
	`m_m®loc
((
mp_št
));

113 
key
->
q
 = 
	`m_m®loc
((
mp_št
));

114 
	`m_mp_š™_muÉi
(
key
->
p
, key->
q
, 
NULL
);

116 ià(
	`buf_g‘mpšt
(
buf
, 
key
->
p
è=ğ
DROPBEAR_FAILURE
) {

117 
	`TRACE
(("leave buf_get_rsa_priv_key:…:„et == DROPBEAR_FAILURE"))

118 
out
;

121 ià(
	`buf_g‘mpšt
(
buf
, 
key
->
q
è=ğ
DROPBEAR_FAILURE
) {

122 
	`TRACE
(("leave buf_get_rsa_priv_key: q:„et == DROPBEAR_FAILURE"))

123 
out
;

127 
»t
 = 
DROPBEAR_SUCCESS
;

128 
out
:

129 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

130 
	`m_ä“
(
key
->
d
);

131 
	`m_ä“
(
key
->
p
);

132 
	`m_ä“
(
key
->
q
);

134 
	`TRACE
(("leave buf_get_rsa_priv_key"))

135  
»t
;

136 
	}
}

140 
	$r§_key_ä“
(
drİb—r_r§_key
 *
key
) {

142 
	`TRACE
(("enter„sa_key_free"))

144 ià(
key
 =ğ
NULL
) {

145 
	`TRACE
(("leave„sa_key_free: key == NULL"))

148 ià(
key
->
d
) {

149 
	`mp_ş—r
(
key
->
d
);

150 
	`m_ä“
(
key
->
d
);

152 ià(
key
->
e
) {

153 
	`mp_ş—r
(
key
->
e
);

154 
	`m_ä“
(
key
->
e
);

156 ià(
key
->
n
) {

157 
	`mp_ş—r
(
key
->
n
);

158 
	`m_ä“
(
key
->
n
);

160 ià(
key
->
p
) {

161 
	`mp_ş—r
(
key
->
p
);

162 
	`m_ä“
(
key
->
p
);

164 ià(
key
->
q
) {

165 
	`mp_ş—r
(
key
->
q
);

166 
	`m_ä“
(
key
->
q
);

168 
	`m_ä“
(
key
);

169 
	`TRACE
(("leave„sa_key_free"))

170 
	}
}

178 
	$buf_put_r§_pub_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
) {

180 
	`TRACE
(("enter buf_put_rsa_pub_key"))

181 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

183 
	`buf_put¡ršg
(
buf
, 
SSH_SIGNKEY_RSA
, 
SSH_SIGNKEY_RSA_LEN
);

184 
	`buf_putmpšt
(
buf
, 
key
->
e
);

185 
	`buf_putmpšt
(
buf
, 
key
->
n
);

187 
	`TRACE
(("leave buf_put_rsa_pub_key"))

189 
	}
}

192 
	$buf_put_r§_´iv_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
) {

194 
	`TRACE
(("enter buf_put_rsa_priv_key"))

196 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

197 
	`buf_put_r§_pub_key
(
buf
, 
key
);

198 
	`buf_putmpšt
(
buf
, 
key
->
d
);

201 ià(
key
->
p
) {

202 
	`buf_putmpšt
(
buf
, 
key
->
p
);

204 ià(
key
->
q
) {

205 
	`buf_putmpšt
(
buf
, 
key
->
q
);

209 
	`TRACE
(("leave buf_put_rsa_priv_key"))

211 
	}
}

213 #ifdeà
DROPBEAR_SIGNKEY_VERIFY


216 
	$buf_r§_v”ify
(
bufãr
 * 
buf
, 
drİb—r_r§_key
 *
key
, cÚ¡ * 
d©a
,

217 
Ën
) {

219 
¦’
;

220 
	`DEF_MP_INT
(
r§_s
);

221 
	`DEF_MP_INT
(
r§_mdash
);

222 
	`DEF_MP_INT
(
r§_em
);

223 
»t
 = 
DROPBEAR_FAILURE
;

225 
	`TRACE
(("enter buf_rsa_verify"))

227 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

229 
	`m_mp_š™_muÉi
(&
r§_mdash
, &
r§_s
, &
r§_em
, 
NULL
);

231 
¦’
 = 
	`buf_g‘št
(
buf
);

232 ià(
¦’
 !ğ()
	`mp_unsigÃd_bš_size
(
key
->
n
)) {

233 
	`TRACE
(("bad size"))

234 
out
;

237 ià(
	`mp_»ad_unsigÃd_bš
(&
r§_s
, 
	`buf_g‘±r
(
buf
, buf->
Ën
 - buf->
pos
),

238 
buf
->
Ën
 - buf->
pos
è!ğ
MP_OKAY
) {

239 
	`TRACE
(("failed„eading„sa_s"))

240 
out
;

244 ià(
	`mp_cmp
(&
r§_s
, 
key
->
n
è!ğ
MP_LT
) {

245 
	`TRACE
(("s >‚-1"))

246 
out
;

250 
	`r§_·d_em
(
key
, 
d©a
, 
Ën
, &
r§_em
);

252 ià(
	`mp_ex±mod
(&
r§_s
, 
key
->
e
, key->
n
, &
r§_mdash
è!ğ
MP_OKAY
) {

253 
	`TRACE
(("failedƒxptmod„sa_s"))

254 
out
;

257 ià(
	`mp_cmp
(&
r§_em
, &
r§_mdash
è=ğ
MP_EQ
) {

259 
	`TRACE
(("success!"))

260 
»t
 = 
DROPBEAR_SUCCESS
;

263 
out
:

264 
	`mp_ş—r_muÉi
(&
r§_mdash
, &
r§_s
, &
r§_em
, 
NULL
);

265 
	`TRACE
(("Ëavbuf_r§_v”ify:„‘ %d", 
»t
))

266  
»t
;

267 
	}
}

273 
	$buf_put_r§_sign
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
, cÚ¡ * 
d©a
,

274 
Ën
) {

276 
nsize
, 
ssize
;

277 
i
;

278 
	`DEF_MP_INT
(
r§_s
);

279 
	`DEF_MP_INT
(
r§_tmp1
);

280 
	`DEF_MP_INT
(
r§_tmp2
);

281 
	`DEF_MP_INT
(
r§_tmp3
);

283 
	`TRACE
(("enter buf_put_rsa_sign"))

284 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

286 
	`m_mp_š™_muÉi
(&
r§_s
, &
r§_tmp1
, &
r§_tmp2
, &
r§_tmp3
, 
NULL
);

288 
	`r§_·d_em
(
key
, 
d©a
, 
Ën
, &
r§_tmp1
);

292 #ifdeà
RSA_BLINDING


298 
	`g’_¿ndom_mpšt
(
key
->
n
, &
r§_tmp2
);

304 ià(
	`mp_ex±mod
(&
r§_tmp2
, 
key
->
e
, key->
n
, &
r§_s
è!ğ
MP_OKAY
) {

305 
	`drİb—r_ex™
("RSAƒrror");

307 ià(
	`mp_švmod
(&
r§_tmp2
, 
key
->
n
, &
r§_tmp3
è!ğ
MP_OKAY
) {

308 
	`drİb—r_ex™
("RSAƒrror");

310 ià(
	`mp_mulmod
(&
r§_tmp1
, &
r§_s
, 
key
->
n
, &
r§_tmp2
è!ğ
MP_OKAY
) {

311 
	`drİb—r_ex™
("RSAƒrror");

316 ià(
	`mp_ex±mod
(&
r§_tmp2
, 
key
->
d
, key->
n
, &
r§_tmp1
è!ğ
MP_OKAY
) {

317 
	`drİb—r_ex™
("RSAƒrror");

323 ià(
	`mp_mulmod
(&
r§_tmp1
, &
r§_tmp3
, 
key
->
n
, &
r§_s
è!ğ
MP_OKAY
) {

324 
	`drİb—r_ex™
("RSAƒrror");

331 ià(
	`mp_ex±mod
(&
r§_tmp1
, 
key
->
d
, key->
n
, &
r§_s
è!ğ
MP_OKAY
) {

332 
	`drİb—r_ex™
("RSAƒrror");

337 
	`mp_ş—r_muÉi
(&
r§_tmp1
, &
r§_tmp2
, &
r§_tmp3
, 
NULL
);

340 
	`buf_put¡ršg
(
buf
, 
SSH_SIGNKEY_RSA
, 
SSH_SIGNKEY_RSA_LEN
);

342 
nsize
 = 
	`mp_unsigÃd_bš_size
(
key
->
n
);

345 
	`buf_putšt
(
buf
, 
nsize
);

347 
ssize
 = 
	`mp_unsigÃd_bš_size
(&
r§_s
);

348 
	`drİb—r_as£¹
(
ssize
 <ğ
nsize
);

349 
i
 = 0; i < 
nsize
-
ssize
; i++) {

350 
	`buf_putby‹
(
buf
, 0x00);

353 ià(
	`mp_to_unsigÃd_bš
(&
r§_s
, 
	`buf_g‘wr™•Œ
(
buf
, 
ssize
)è!ğ
MP_OKAY
) {

354 
	`drİb—r_ex™
("RSAƒrror");

356 
	`buf_šüwr™•os
(
buf
, 
ssize
);

357 
	`mp_ş—r
(&
r§_s
);

359 #ià
	`defšed
(
DEBUG_RSA
è&& defšed(
DEBUG_TRACE
)

360 
	`´šthex
("RSA sig", 
buf
->
d©a
, buf->
Ën
);

364 
	`TRACE
(("leave buf_put_rsa_sign"))

365 
	}
}

379 
	$r§_·d_em
(
drİb—r_r§_key
 * 
key
,

380 cÚ¡ * 
d©a
, 
Ën
,

381 
mp_št
 * 
r§_em
) {

384 cÚ¡ 
r§_a¢1_magic
[] =

387 cÚ¡ 
RSA_ASN1_MAGIC_LEN
 = 16;

389 
bufãr
 * 
r§_EM
 = 
NULL
;

390 
hash_¡©e
 
hs
;

391 
nsize
;

393 
	`drİb—r_as£¹
(
key
 !ğ
NULL
);

394 
	`drİb—r_as£¹
(
d©a
 !ğ
NULL
);

395 
nsize
 = 
	`mp_unsigÃd_bš_size
(
key
->
n
);

397 
r§_EM
 = 
	`buf_Ãw
(
nsize
-1);

399 
	`buf_putby‹
(
r§_EM
, 0x01);

401 
r§_EM
->
pos
 !ğr§_EM->
size
 - 
RSA_ASN1_MAGIC_LEN
 - 
SHA1_HASH_SIZE
) {

402 
	`buf_putby‹
(
r§_EM
, 0xff);

405 
	`memıy
(
	`buf_g‘wr™•Œ
(
r§_EM
, 
RSA_ASN1_MAGIC_LEN
),

406 
r§_a¢1_magic
, 
RSA_ASN1_MAGIC_LEN
);

407 
	`buf_šüwr™•os
(
r§_EM
, 
RSA_ASN1_MAGIC_LEN
);

410 
	`sha1_š™
(&
hs
);

411 
	`sha1_´oûss
(&
hs
, 
d©a
, 
Ën
);

412 
	`sha1_dÚe
(&
hs
, 
	`buf_g‘wr™•Œ
(
r§_EM
, 
SHA1_HASH_SIZE
));

413 
	`buf_šüwr™•os
(
r§_EM
, 
SHA1_HASH_SIZE
);

415 
	`drİb—r_as£¹
(
r§_EM
->
pos
 =ğr§_EM->
size
);

418 
	`buf_£os
(
r§_EM
, 0);

419 
	`by‹s_to_mp
(
r§_em
, 
	`buf_g‘±r
(
r§_EM
,„§_EM->
size
),

420 
r§_EM
->
size
);

421 
	`buf_ä“
(
r§_EM
);

422 
	}
}

	@rsa.h

25 #iâdeà
_RSA_H_


26 
	#_RSA_H_


	)

28 
	~"šşudes.h
"

29 
	~"bufãr.h
"

31 #ifdeà
DROPBEAR_RSA


33 
	#RSA_SIGNATURE_SIZE
 4+7+4+40

	)

37 
mp_št
* 
	mn
;

38 
mp_št
* 
	me
;

40 
mp_št
* 
	md
;

41 
mp_št
* 
	mp
;

42 
mp_št
* 
	mq
;

44 } 
	tdrİb—r_r§_key
;

46 
buf_put_r§_sign
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
, cÚ¡ * 
d©a
,

47 
Ën
);

48 #ifdeà
DROPBEAR_SIGNKEY_VERIFY


49 
buf_r§_v”ify
(
bufãr
 * 
buf
, 
drİb—r_r§_key
 *
key
, cÚ¡ * 
d©a
,

50 
Ën
);

52 
buf_g‘_r§_pub_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
);

53 
buf_g‘_r§_´iv_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
);

54 
buf_put_r§_pub_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
);

55 
buf_put_r§_´iv_key
(
bufãr
* 
buf
, 
drİb—r_r§_key
 *
key
);

56 
r§_key_ä“
(
drİb—r_r§_key
 *
key
);

	@runopts.h

25 #iâdeà
_RUNOPTS_H_


26 
	#_RUNOPTS_H_


	)

28 
	~"šşudes.h
"

29 
	~"signkey.h
"

30 
	~"bufãr.h
"

31 
	~"auth.h
"

32 
	~"tıfwd.h
"

34 
	srunİts
 {

36 #ià
defšed
(
ENABLE_SVR_REMOTETCPFWD
è|| defšed(
ENABLE_CLI_LOCALTCPFWD
)

37 
	mli¡’_fwd_®l
;

39 
	m»cv_wšdow
;

40 
time_t
 
	mk“·live_£cs
;

41 
time_t
 
	midË_timeout_£cs
;

43 #iâdeà
DISABLE_ZLIB


47 
	m’abË_com´ess
;

51 } 
	trunİts
;

53 
runİts
 
İts
;

55 
»adho¡key
(cÚ¡ * 
f’ame
, 
sign_key
 * 
ho¡key
, *
ty³
);

57 
	ssvr_runİts
 {

59 * 
	mr§keyfe
;

60 * 
	mdsskeyfe
;

61 * 
	mbªÃrfe
;

62 #ifdeà
ENABLE_SVR_MASTER_PASSWORD


63 * 
	mma¡”_·sswÜd
;

66 
	mfÜkbg
;

67 
	musšgsy¦og
;

70 *
	mpÜts
[
DROPBEAR_MAX_PORTS
];

71 
	mpÜtcouÁ
;

72 *
	madd»s£s
[
DROPBEAR_MAX_PORTS
];

74 
	mš‘dmode
;

82 #ifdeà
DO_MOTD


84 
	mdomÙd
;

87 
	mnÜoÙlogš
;

89 
	mnßuth·ss
;

90 
	mnÜoÙ·ss
;

92 #ifdeà
ENABLE_SVR_REMOTETCPFWD


93 
	mnÜemÙ‘ı
;

95 #ifdeà
ENABLE_SVR_LOCALTCPFWD


96 
	mnŞoÿÉı
;

99 
sign_key
 *
	mho¡key
;

100 
bufãr
 * 
	mbªÃr
;

101 * 
	mpidfe
;

103 } 
	tsvr_runİts
;

105 
svr_runİts
 
svr_İts
;

107 
svr_g‘İts
(
¬gc
, ** 
¬gv
);

108 
lßdho¡keys
();

110 
	sşi_runİts
 {

112 *
	m´ogÇme
;

113 *
	m»mÙeho¡
;

114 *
	m»mÙ•Üt
;

116 *
	mown_u£r
;

117 *
	mu£ºame
;

119 *
	mcmd
;

120 
	mwªty
;

121 
	m®ways_acû±_key
;

122 
	mno_cmd
;

123 
	mbackgrounded
;

124 
	mis_subsy¡em
;

125 #ifdeà
ENABLE_CLI_PUBKEY_AUTH


126 
m_li¡
 *
	m´ivkeys
;

128 #ifdeà
ENABLE_CLI_REMOTETCPFWD


129 
m_li¡
 * 
	m»mÙefwds
;

131 #ifdeà
ENABLE_CLI_LOCALTCPFWD


132 
m_li¡
 * 
	mloÿlfwds
;

134 #ifdeà
ENABLE_CLI_AGENTFWD


135 
	mag’t_fwd
;

136 
	mag’t_keys_lßded
;

138 
	mag’t_fd
;

142 #ifdeà
ENABLE_CLI_NETCAT


143 *
	mÃtÿt_ho¡
;

144 
	mÃtÿt_pÜt
;

146 #ifdeà
ENABLE_CLI_PROXYCMD


147 *
	m´oxycmd
;

149 } 
	tşi_runİts
;

151 
şi_runİts
 
şi_İts
;

152 
şi_g‘İts
(
¬gc
, ** 
¬gv
);

	@scp.c

72 
	#S_IWRITE
 0200

	)

73 
	~"šşudes.h
"

76 
	~"©omicio.h
"

77 
	~"com·t.h
"

78 
	~"sımisc.h
"

79 
	~"´og»ssm‘”.h
"

83 
¬gli¡
 
	g¬gs
;

86 
off_t
 
	glim™_¿‹
 = 0;

89 *
	gcurfe
;

92 
	gv”bo£_mode
 = 0;

95 
	gshow´og»ss
 = 1;

98 *
	gssh_´og¿m
 = 
_PATH_SSH_PROGRAM
;

101 
pid_t
 
	gdo_cmd_pid
 = -1;

104 
	$klchd
(
signo
)

106 ià(
do_cmd_pid
 > 1) {

107 
	`kl
(
do_cmd_pid
, 
signo
 ? signØ: 
SIGTERM
);

108 
	`wa™pid
(
do_cmd_pid
, 
NULL
, 0);

111 ià(
signo
)

112 
	`_ex™
(1);

113 
	`ex™
(1);

114 
	}
}

117 
	$do_loÿl_cmd
(
¬gli¡
 *
a
)

119 
u_št
 
i
;

120 
¡©us
;

121 
pid_t
 
pid
;

123 ià(
a
->
num
 == 0)

124 
	`çl
("do_local_cmd:‚o‡rguments");

126 ià(
v”bo£_mode
) {

127 
	`årštf
(
¡d”r
, "Executing:");

128 
i
 = 0; i < 
a
->
num
; i++)

129 
	`årštf
(
¡d”r
, " %s", 
a
->
li¡
[
i
]);

130 
	`årštf
(
¡d”r
, "\n");

132 #ifdeà
__uClšux__


133 
pid
 = 
	`vfÜk
();

135 
pid
 = 
	`fÜk
();

137 ià(
pid
 == -1)

138 
	`çl
("do_loÿl_cmd: fÜk: %s", 
	`¡»¼Ü
(
”ºo
));

140 ià(
pid
 == 0) {

141 
	`execvp
(
a
->
li¡
[0],‡->list);

142 
	`³¼Ü
(
a
->
li¡
[0]);

143 #ifdeà
__uClšux__


144 
	`_ex™
(1);

146 
	`ex™
(1);

150 
do_cmd_pid
 = 
pid
;

151 
	`sigÇl
(
SIGTERM
, 
klchd
);

152 
	`sigÇl
(
SIGINT
, 
klchd
);

153 
	`sigÇl
(
SIGHUP
, 
klchd
);

155 
	`wa™pid
(
pid
, &
¡©us
, 0) == -1)

156 ià(
”ºo
 !ğ
EINTR
)

157 
	`çl
("do_loÿl_cmd: wa™pid: %s", 
	`¡»¼Ü
(
”ºo
));

159 
do_cmd_pid
 = -1;

161 ià(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0)

165 
	}
}

174 
	$do_cmd
(*
ho¡
, *
»mu£r
, *
cmd
, *
fdš
, *
fdout
, 
¬gc
)

176 
pš
[2], 
pout
[2], 
»£rved
[2];

178 ià(
v”bo£_mode
)

179 
	`årštf
(
¡d”r
,

181 
ssh_´og¿m
, 
ho¡
,

182 
»mu£r
 ?„emu£¸: "(un¥ecif›d)", 
cmd
);

188 
	`pe
(
»£rved
);

191 ià(
	`pe
(
pš
) < 0)

192 
	`çl
("pe: %s", 
	`¡»¼Ü
(
”ºo
));

193 ià(
	`pe
(
pout
) < 0)

194 
	`çl
("pe: %s", 
	`¡»¼Ü
(
”ºo
));

197 
	`şo£
(
»£rved
[0]);

198 
	`şo£
(
»£rved
[1]);

202 #ifdeà
__uClšux__


203 
	`»¶aû¬g
(&
¬gs
, 0, "%s", 
ssh_´og¿m
);

204 ià(
»mu£r
 !ğ
NULL
)

205 
	`add¬gs
(&
¬gs
, "-l%s", 
»mu£r
);

206 
	`add¬gs
(&
¬gs
, "%s", 
ho¡
);

207 
	`add¬gs
(&
¬gs
, "%s", 
cmd
);

211 #ifdeà
__uClšux__


212 
do_cmd_pid
 = 
	`vfÜk
();

214 
do_cmd_pid
 = 
	`fÜk
();

217 ià(
do_cmd_pid
 == 0) {

219 
	`şo£
(
pš
[1]);

220 
	`şo£
(
pout
[0]);

221 
	`dup2
(
pš
[0], 0);

222 
	`dup2
(
pout
[1], 1);

223 
	`şo£
(
pš
[0]);

224 
	`şo£
(
pout
[1]);

226 #iâdeà
__uClšux__


227 
	`»¶aû¬g
(&
¬gs
, 0, "%s", 
ssh_´og¿m
);

228 ià(
»mu£r
 !ğ
NULL
)

229 
	`add¬gs
(&
¬gs
, "-l%s", 
»mu£r
);

230 
	`add¬gs
(&
¬gs
, "%s", 
ho¡
);

231 
	`add¬gs
(&
¬gs
, "%s", 
cmd
);

234 
	`execvp
(
ssh_´og¿m
, 
¬gs
.
li¡
);

235 
	`³¼Ü
(
ssh_´og¿m
);

236 #iâdeà
__uClšux__


237 
	`ex™
(1);

239 
	`_ex™
(1);

241 } ià(
do_cmd_pid
 == -1) {

242 
	`çl
("fÜk: %s", 
	`¡»¼Ü
(
”ºo
));

246 #ifdeà
__uClšux__


249 
	`xä“
(
¬gs
.
li¡
[¬gs.
num
-1]);

250 
¬gs
.
li¡
[¬gs.
num
-1]=
NULL
;

251 
¬gs
.
num
--;

253 
	`xä“
(
¬gs
.
li¡
[¬gs.
num
-1]);

254 
¬gs
.
li¡
[¬gs.
num
-1]=
NULL
;

255 
¬gs
.
num
--;

257 ià(
»mu£r
 !ğ
NULL
) {

258 
	`xä“
(
¬gs
.
li¡
[¬gs.
num
-1]);

259 
¬gs
.
li¡
[¬gs.
num
-1]=
NULL
;

260 
¬gs
.
num
--;

265 
	`şo£
(
pš
[0]);

266 *
fdout
 = 
pš
[1];

267 
	`şo£
(
pout
[1]);

268 *
fdš
 = 
pout
[0];

269 
	`sigÇl
(
SIGTERM
, 
klchd
);

270 
	`sigÇl
(
SIGINT
, 
klchd
);

271 
	`sigÇl
(
SIGHUP
, 
klchd
);

273 
	}
}

276 
size_t
 
	mút
;

277 *
	mbuf
;

278 } 
	tBUF
;

280 
BUF
 *
®locbuf
(BUF *, , );

281 
lo¡cÚn
();

282 
no¥aû
();

283 
okÇme
(*);

284 
run_”r
(const *,...);

285 
v”ifydœ
(*);

287 
·sswd
 *
	gpwd
;

288 
uid_t
 
	gu£rid
;

289 
	g”rs
, 
	g»mš
, 
	g»mout
;

290 
	gpæag
, 
	gŸm»mÙe
, 
	gŸm»cursive
, 
	grg‘shouldbedœeùÜy
;

292 
	#CMDNEEDS
 64

	)

293 
	gcmd
[
CMDNEEDS
];

295 
»¥Ú£
();

296 
rsourû
(*, 
¡©
 *);

297 
sšk
(, *[]);

298 
sourû
(, *[]);

299 
tŞoÿl
(, *[]);

300 
tÜemÙe
(*, , *[]);

301 
u§ge
();

303 #ià
defšed
(
DBMULTI_sı
è|| !defšed(
DROPBEAR_MULTI
)

304 #ià
defšed
(
DBMULTI_sı
è&& defšed(
DROPBEAR_MULTI
)

305 
	$sı_maš
(
¬gc
, **
¬gv
)

308 
	$maš
(
¬gc
, **
¬gv
)

311 
ch
, 
fæag
, 
tæag
, 
¡©us
;

312 
¥“d
;

313 *
rg
, *
’dp
;

314 *
İrg
;

315 
İtšd
;

318 
	`§n™i£_¡dfd
();

320 
	`mem£t
(&
¬gs
, '\0', (args));

321 
¬gs
.
li¡
 = 
NULL
;

322 
	`add¬gs
(&
¬gs
, "%s", 
ssh_´og¿m
);

324 
fæag
 = 
tæag
 = 0;

325 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "dfl:prtvBCc:i:P:q1246S:o:F:")) != -1)

326 
ch
) {

333 
	`add¬gs
(&
¬gs
, "-%c", 
ch
);

339 
	`add¬gs
(&
¬gs
, "-%c%s", 
ch
, 
İrg
);

342 
	`add¬gs
(&
¬gs
, "-p%s", 
İrg
);

345 
	`årštf
(
¡d”r
, "Note: -B option is disabled inhis version of scp");

348 
¥“d
 = 
	`¡¹od
(
İrg
, &
’dp
);

349 ià(
¥“d
 <ğ0 || *
’dp
 != '\0')

350 
	`u§ge
();

351 
lim™_¿‹
 = 
¥“d
 * 1024;

354 
pæag
 = 1;

357 
Ÿm»cursive
 = 1;

360 
ssh_´og¿m
 = 
	`x¡rdup
(
İrg
);

363 
	`add¬gs
(&
¬gs
, "-v");

364 
v”bo£_mode
 = 1;

366 #ifdeà
PROGRESS_METER


368 
	`add¬gs
(&
¬gs
, "-q");

369 
show´og»ss
 = 0;

375 
rg‘shouldbedœeùÜy
 = 1;

378 
Ÿm»mÙe
 = 1;

379 
fæag
 = 1;

382 
Ÿm»mÙe
 = 1;

383 
tæag
 = 1;

384 #ifdeà
HAVE_CYGWIN


385 
	`£tmode
(0, 
O_BINARY
);

389 
	`u§ge
();

391 
¬gc
 -ğ
İtšd
;

392 
¬gv
 +ğ
İtšd
;

394 ià((
pwd
 = 
	`g‘pwuid
(
u£rid
 = 
	`g‘uid
())è=ğ
NULL
)

395 
	`çl
("unknowÀu£¸%u", (
u_št
è
u£rid
);

397 ià(!
	`i§‰y
(
STDERR_FILENO
))

398 
show´og»ss
 = 0;

400 
»mš
 = 
STDIN_FILENO
;

401 
»mout
 = 
STDOUT_FILENO
;

403 ià(
fæag
) {

405 (è
	`»¥Ú£
();

406 
	`sourû
(
¬gc
, 
¬gv
);

407 
	`ex™
(
”rs
 != 0);

409 ià(
tæag
) {

411 
	`sšk
(
¬gc
, 
¬gv
);

412 
	`ex™
(
”rs
 != 0);

414 ià(
¬gc
 < 2)

415 
	`u§ge
();

416 ià(
¬gc
 > 2)

417 
rg‘shouldbedœeùÜy
 = 1;

419 
»mš
 = 
»mout
 = -1;

420 
do_cmd_pid
 = -1;

422 (è
	`¢´štf
(
cmd
,  cmd, "scp%s%s%s%s",

423 
v”bo£_mode
 ? " -v" : "",

424 
Ÿm»cursive
 ? " -r" : "", 
pæag
 ? " -p" : "",

425 
rg‘shouldbedœeùÜy
 ? " -d" : "");

427 (è
	`sigÇl
(
SIGPIPE
, 
lo¡cÚn
);

429 ià((
rg
 = 
	`cŞÚ
(
¬gv
[
¬gc
 - 1])))

430 
	`tÜemÙe
(
rg
, 
¬gc
, 
¬gv
);

432 ià(
rg‘shouldbedœeùÜy
)

433 
	`v”ifydœ
(
¬gv
[
¬gc
 - 1]);

434 
	`tŞoÿl
(
¬gc
, 
¬gv
);

440 ià(
do_cmd_pid
 !ğ-1 && 
”rs
 == 0) {

441 ià(
»mš
 != -1)

442 (è
	`şo£
(
»mš
);

443 ià(
»mout
 != -1)

444 (è
	`şo£
(
»mout
);

445 ià(
	`wa™pid
(
do_cmd_pid
, &
¡©us
, 0) == -1)

446 
”rs
 = 1;

448 ià(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0)

449 
”rs
 = 1;

452 
	`ex™
(
”rs
 != 0);

453 
	}
}

457 
	$tÜemÙe
(*
rg
, 
¬gc
, **
¬gv
)

459 
i
, 
Ën
;

460 *
bp
, *
ho¡
, *
¤c
, *
su£r
, *
tho¡
, *
tu£r
, *
¬g
;

461 
¬gli¡
 
®i¡
;

463 
	`mem£t
(&
®i¡
, '\0', (alist));

464 
®i¡
.
li¡
 = 
NULL
;

466 *
rg
++ = 0;

467 ià(*
rg
 == 0)

468 
rg
 = ".";

470 
¬g
 = 
	`x¡rdup
(
¬gv
[
¬gc
 - 1]);

471 ià((
tho¡
 = 
	`¡¼chr
(
¬g
, '@'))) {

473 *
tho¡
++ = 0;

474 
tu£r
 = 
¬g
;

475 ià(*
tu£r
 == '\0')

476 
tu£r
 = 
NULL
;

478 
tho¡
 = 
¬g
;

479 
tu£r
 = 
NULL
;

482 ià(
tu£r
 !ğ
NULL
 && !
	`okÇme
(tuser)) {

483 
	`xä“
(
¬g
);

487 
i
 = 0; i < 
¬gc
 - 1; i++) {

488 
¤c
 = 
	`cŞÚ
(
¬gv
[
i
]);

489 ià(
¤c
) {

490 
	`ä“¬gs
(&
®i¡
);

491 
	`add¬gs
(&
®i¡
, "%s", 
ssh_´og¿m
);

492 ià(
v”bo£_mode
)

493 
	`add¬gs
(&
®i¡
, "-v");

497 
	`add¬gs
(&
®i¡
, "-x");

498 
	`add¬gs
(&
®i¡
, "-oClearAllForwardings yes");

499 
	`add¬gs
(&
®i¡
, "-n");

502 *
¤c
++ = 0;

503 ià(*
¤c
 == 0)

504 
¤c
 = ".";

505 
ho¡
 = 
	`¡¼chr
(
¬gv
[
i
], '@');

507 ià(
ho¡
) {

508 *
ho¡
++ = 0;

509 
ho¡
 = 
	`ş—nho¡Çme
(host);

510 
su£r
 = 
¬gv
[
i
];

511 ià(*
su£r
 == '\0')

512 
su£r
 = 
pwd
->
pw_Çme
;

513 ià(!
	`okÇme
(
su£r
))

515 
	`add¬gs
(&
®i¡
, "-l");

516 
	`add¬gs
(&
®i¡
, "%s", 
su£r
);

518 
ho¡
 = 
	`ş—nho¡Çme
(
¬gv
[
i
]);

520 
	`add¬gs
(&
®i¡
, "%s", 
ho¡
);

521 
	`add¬gs
(&
®i¡
, "%s", 
cmd
);

522 
	`add¬gs
(&
®i¡
, "%s", 
¤c
);

523 
	`add¬gs
(&
®i¡
, "%s%s%s:%s",

524 
tu£r
 ?user : "",user ? "@" : "",

525 
tho¡
, 
rg
);

526 ià(
	`do_loÿl_cmd
(&
®i¡
) != 0)

527 
”rs
 = 1;

529 ià(
»mš
 == -1) {

530 
Ën
 = 
	`¡¾’
(
rg
è+ 
CMDNEEDS
 + 20;

531 
bp
 = 
	`xm®loc
(
Ën
);

532 (è
	`¢´štf
(
bp
, 
Ën
, "% -ˆ%s", 
cmd
, 
rg
);

533 
ho¡
 = 
	`ş—nho¡Çme
(
tho¡
);

534 ià(
	`do_cmd
(
ho¡
, 
tu£r
, 
bp
, &
»mš
,

535 &
»mout
, 
¬gc
) < 0)

536 
	`ex™
(1);

537 ià(
	`»¥Ú£
() < 0)

538 
	`ex™
(1);

539 (è
	`xä“
(
bp
);

541 
	`sourû
(1, 
¬gv
 + 
i
);

544 
	}
}

547 
	$tŞoÿl
(
¬gc
, **
¬gv
)

549 
i
, 
Ën
;

550 *
bp
, *
ho¡
, *
¤c
, *
su£r
;

551 
¬gli¡
 
®i¡
;

553 
	`mem£t
(&
®i¡
, '\0', (alist));

554 
®i¡
.
li¡
 = 
NULL
;

556 
i
 = 0; i < 
¬gc
 - 1; i++) {

557 ià(!(
¤c
 = 
	`cŞÚ
(
¬gv
[
i
]))) {

558 
	`ä“¬gs
(&
®i¡
);

559 
	`add¬gs
(&
®i¡
, "%s", 
_PATH_CP
);

560 ià(
Ÿm»cursive
)

561 
	`add¬gs
(&
®i¡
, "-r");

562 ià(
pæag
)

563 
	`add¬gs
(&
®i¡
, "-p");

564 
	`add¬gs
(&
®i¡
, "%s", 
¬gv
[
i
]);

565 
	`add¬gs
(&
®i¡
, "%s", 
¬gv
[
¬gc
-1]);

566 ià(
	`do_loÿl_cmd
(&
®i¡
))

567 ++
”rs
;

570 *
¤c
++ = 0;

571 ià(*
¤c
 == 0)

572 
¤c
 = ".";

573 ià((
ho¡
 = 
	`¡¼chr
(
¬gv
[
i
], '@')è=ğ
NULL
) {

574 
ho¡
 = 
¬gv
[
i
];

575 
su£r
 = 
NULL
;

577 *
ho¡
++ = 0;

578 
su£r
 = 
¬gv
[
i
];

579 ià(*
su£r
 == '\0')

580 
su£r
 = 
pwd
->
pw_Çme
;

582 
ho¡
 = 
	`ş—nho¡Çme
(host);

583 
Ën
 = 
	`¡¾’
(
¤c
è+ 
CMDNEEDS
 + 20;

584 
bp
 = 
	`xm®loc
(
Ën
);

585 (è
	`¢´štf
(
bp
, 
Ën
, "% -à%s", 
cmd
, 
¤c
);

586 ià(
	`do_cmd
(
ho¡
, 
su£r
, 
bp
, &
»mš
, &
»mout
, 
¬gc
) < 0) {

587 (è
	`xä“
(
bp
);

588 ++
”rs
;

591 
	`xä“
(
bp
);

592 
	`sšk
(1, 
¬gv
 + 
¬gc
 - 1);

593 (è
	`şo£
(
»mš
);

594 
»mš
 = 
»mout
 = -1;

596 
	}
}

599 
	$sourû
(
¬gc
, **
¬gv
)

601 
¡©
 
¡b
;

602 
BUF
 
bufãr
;

603 
BUF
 *
bp
;

604 
off_t
 
i
, 
amt
, 
¡©by‹s
;

605 
size_t
 
»suÉ
;

606 
fd
 = -1, 
had”r
, 
šdx
;

607 *
Ï¡
, *
Çme
, 
buf
[2048];

608 
Ën
;

610 
šdx
 = 0; indx < 
¬gc
; ++indx) {

611 
Çme
 = 
¬gv
[
šdx
];

612 
¡©by‹s
 = 0;

613 
Ën
 = 
	`¡¾’
(
Çme
);

614 
Ën
 > 1 && 
Çme
[len-1] == '/')

615 
Çme
[--
Ën
] = '\0';

616 ià(
	`¡rchr
(
Çme
, '\n'è!ğ
NULL
) {

617 
	`run_”r
("%s: skipping, filename contains‡‚ewline",

618 
Çme
);

619 
Ãxt
;

621 ià((
fd
 = 
	`İ’
(
Çme
, 
O_RDONLY
, 0)) < 0)

622 
sy£¼
;

623 ià(
	`f¡©
(
fd
, &
¡b
) < 0) {

624 
sy£¼
: 
	`run_”r
("%s: %s", 
Çme
, 
	`¡»¼Ü
(
”ºo
));

625 
Ãxt
;

627 
¡b
.
¡_mode
 & 
S_IFMT
) {

628 
S_IFREG
:

630 
S_IFDIR
:

631 ià(
Ÿm»cursive
) {

632 
	`rsourû
(
Çme
, &
¡b
);

633 
Ãxt
;

637 
	`run_”r
("%s:‚Ù‡„eguÏ¸fe", 
Çme
);

638 
Ãxt
;

640 ià((
Ï¡
 = 
	`¡¼chr
(
Çme
, '/')è=ğ
NULL
)

641 
Ï¡
 = 
Çme
;

643 ++
Ï¡
;

644 
curfe
 = 
Ï¡
;

645 ià(
pæag
) {

650 (è
	`¢´štf
(
buf
,  buf, "T%lu 0 %lu 0\n",

651 (
u_lÚg
è
¡b
.
¡_mtime
,

652 (
u_lÚg
è
¡b
.
¡_©ime
);

653 (è
	`©omicio
(
vwr™e
, 
»mout
, 
buf
, 
	`¡¾’
(buf));

654 ià(
	`»¥Ú£
() < 0)

655 
Ãxt
;

657 
	#FILEMODEMASK
 (
S_ISUID
|
S_ISGID
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

658 
	`¢´štf
(
buf
,  buf, "C%04o %lld %s\n",

659 (
u_št
è(
¡b
.
¡_mode
 & 
FILEMODEMASK
),

660 ()
¡b
.
¡_size
, 
Ï¡
);

661 ià(
v”bo£_mode
) {

662 
	`årštf
(
¡d”r
, "S’dšg fmodes: %s", 
buf
);

664 (è
	`©omicio
(
vwr™e
, 
»mout
, 
buf
, 
	`¡¾’
(buf));

665 ià(
	`»¥Ú£
() < 0)

666 
Ãxt
;

667 ià((
bp
 = 
	`®locbuf
(&
bufãr
, 
fd
, 2048)è=ğ
NULL
) {

668 
Ãxt
: ià(
fd
 != -1) {

669 (è
	`şo£
(
fd
);

670 
fd
 = -1;

674 #ià
PROGRESS_METER


675 ià(
show´og»ss
)

676 
	`¡¬t_´og»ss_m‘”
(
curfe
, 
¡b
.
¡_size
, &
¡©by‹s
);

679 
had”r
 = 
i
 = 0; i < 
¡b
.
¡_size
; i +ğ
bp
->
út
) {

680 
amt
 = 
bp
->
út
;

681 ià(
i
 + 
amt
 > 
¡b
.
¡_size
)

682 
amt
 = 
¡b
.
¡_size
 - 
i
;

683 ià(!
had”r
) {

684 
»suÉ
 = 
	`©omicio
(
»ad
, 
fd
, 
bp
->
buf
, 
amt
);

685 ià(
»suÉ
 !ğ
amt
)

686 
had”r
 = 
”ºo
;

688 ià(
had”r
)

689 (è
	`©omicio
(
vwr™e
, 
»mout
, 
bp
->
buf
, 
amt
);

691 
»suÉ
 = 
	`©omicio
(
vwr™e
, 
»mout
, 
bp
->
buf
, 
amt
);

692 ià(
»suÉ
 !ğ
amt
)

693 
had”r
 = 
”ºo
;

694 
¡©by‹s
 +ğ
»suÉ
;

697 #ifdeà
PROGRESS_METER


698 ià(
show´og»ss
)

699 
	`¡İ_´og»ss_m‘”
();

702 ià(
fd
 != -1) {

703 ià(
	`şo£
(
fd
è< 0 && !
had”r
)

704 
had”r
 = 
”ºo
;

705 
fd
 = -1;

707 ià(!
had”r
)

708 (è
	`©omicio
(
vwr™e
, 
»mout
, "", 1);

710 
	`run_”r
("%s: %s", 
Çme
, 
	`¡»¼Ü
(
had”r
));

711 (è
	`»¥Ú£
();

713 
	}
}

716 
	$rsourû
(*
Çme
, 
¡©
 *
¡©p
)

718 
DIR
 *
dœp
;

719 
dœ’t
 *
dp
;

720 *
Ï¡
, *
veù
[1], 
·th
[1100];

722 ià(!(
dœp
 = 
	`İ’dœ
(
Çme
))) {

723 
	`run_”r
("%s: %s", 
Çme
, 
	`¡»¼Ü
(
”ºo
));

726 
Ï¡
 = 
	`¡¼chr
(
Çme
, '/');

727 ià(
Ï¡
 == 0)

728 
Ï¡
 = 
Çme
;

730 
Ï¡
++;

731 ià(
pæag
) {

732 (è
	`¢´štf
(
·th
, (path), "T%lu 0 %lu 0\n",

733 (
u_lÚg
è
¡©p
->
¡_mtime
,

734 (
u_lÚg
è
¡©p
->
¡_©ime
);

735 (è
	`©omicio
(
vwr™e
, 
»mout
, 
·th
, 
	`¡¾’
(path));

736 ià(
	`»¥Ú£
() < 0) {

737 
	`şo£dœ
(
dœp
);

741 (è
	`¢´štf
(
·th
, …ath, "D%04o %d %.1024s\n",

742 (
u_št
è(
¡©p
->
¡_mode
 & 
FILEMODEMASK
), 0, 
Ï¡
);

743 ià(
v”bo£_mode
)

744 
	`årštf
(
¡d”r
, "EÁ”šg dœeùÜy: %s", 
·th
);

745 (è
	`©omicio
(
vwr™e
, 
»mout
, 
·th
, 
	`¡¾’
(path));

746 ià(
	`»¥Ú£
() < 0) {

747 
	`şo£dœ
(
dœp
);

750 (
dp
 = 
	`»addœ
(
dœp
)è!ğ
NULL
) {

751 ià(
dp
->
d_šo
 == 0)

753 ià(!
	`¡rcmp
(
dp
->
d_Çme
, ".") || !strcmp(dp->d_name, ".."))

755 ià(
	`¡¾’
(
Çme
è+ 1 + sŒËn(
dp
->
d_Çme
è>ğ(
·th
) - 1) {

756 
	`run_”r
("%s/%s:‚amtoØlÚg", 
Çme
, 
dp
->
d_Çme
);

759 (è
	`¢´štf
(
·th
, …©h, "%s/%s", 
Çme
, 
dp
->
d_Çme
);

760 
veù
[0] = 
·th
;

761 
	`sourû
(1, 
veù
);

763 (è
	`şo£dœ
(
dœp
);

764 (è
	`©omicio
(
vwr™e
, 
»mout
, "E\n", 2);

765 (è
	`»¥Ú£
();

766 
	}
}

769 
	$sšk
(
¬gc
, **
¬gv
)

771 
BUF
 
bufãr
;

772 
¡©
 
¡b
;

774 
YES
, 
NO
, 
DISPLAYED


775 } 
w»¼
;

776 
BUF
 *
bp
;

777 
off_t
 
i
;

778 
size_t
 
j
, 
couÁ
;

779 
amt
, 
exi¡s
, 
fœ¡
, 
mask
, 
mode
, 
ofd
, 
omode
;

780 
off_t
 
size
, 
¡©by‹s
;

781 
£times
, 
rgisdœ
, 
w»¼no
 = 0;

782 
ch
, *
ı
, *
Å
, *
rg
, *
why
, *
veù
[1], 
buf
[2048];

783 
timev®
 
tv
[2];

785 
	#©ime
 
tv
[0]

	)

786 
	#mtime
 
tv
[1]

	)

787 
	#SCREWUP
(
¡r
è{ 
why
 = sŒ; 
süewup
; }

	)

789 
£times
 = 
rgisdœ
 = 0;

790 
mask
 = 
	`umask
(0);

791 ià(!
pæag
)

792 (è
	`umask
(
mask
);

793 ià(
¬gc
 != 1) {

794 
	`run_”r
("ambiguousarget");

795 
	`ex™
(1);

797 
rg
 = *
¬gv
;

798 ià(
rg‘shouldbedœeùÜy
)

799 
	`v”ifydœ
(
rg
);

801 (è
	`©omicio
(
vwr™e
, 
»mout
, "", 1);

802 ià(
	`¡©
(
rg
, &
¡b
è=ğ0 && 
	`S_ISDIR
(¡b.
¡_mode
))

803 
rgisdœ
 = 1;

804 
fœ¡
 = 1;; first = 0) {

805 
ı
 = 
buf
;

806 ià(
	`©omicio
(
»ad
, 
»mš
, 
ı
, 1) != 1)

808 ià(*
ı
++ == '\n')

809 
	`SCREWUP
("unexpected <newline>");

811 ià(
	`©omicio
(
»ad
, 
»mš
, &
ch
, (ch)) != (ch))

812 
	`SCREWUP
("lost connection");

813 *
ı
++ = 
ch
;

814 } 
ı
 < &
buf
[(bufè- 1] && 
ch
 != '\n');

815 *
ı
 = 0;

816 ià(
v”bo£_mode
)

817 
	`årštf
(
¡d”r
, "Sšk: %s", 
buf
);

819 ià(
buf
[0] == '\01' || buf[0] == '\02') {

820 ià(
Ÿm»mÙe
 == 0)

821 (è
	`©omicio
(
vwr™e
, 
STDERR_FILENO
,

822 
buf
 + 1, 
	`¡¾’
(buf + 1));

823 ià(
buf
[0] == '\02')

824 
	`ex™
(1);

825 ++
”rs
;

828 ià(
buf
[0] == 'E') {

829 (è
	`©omicio
(
vwr™e
, 
»mout
, "", 1);

832 ià(
ch
 == '\n')

833 *--
ı
 = 0;

835 
ı
 = 
buf
;

836 ià(*
ı
 == 'T') {

837 
£times
++;

838 
ı
++;

839 
mtime
.
tv_£c
 = 
	`¡¹Ş
(
ı
, &cp, 10);

840 ià(!
ı
 || *cp++ != ' ')

841 
	`SCREWUP
("mtime.sec‚ot delimited");

842 
mtime
.
tv_u£c
 = 
	`¡¹Ş
(
ı
, &cp, 10);

843 ià(!
ı
 || *cp++ != ' ')

844 
	`SCREWUP
("mtime.usec‚ot delimited");

845 
©ime
.
tv_£c
 = 
	`¡¹Ş
(
ı
, &cp, 10);

846 ià(!
ı
 || *cp++ != ' ')

847 
	`SCREWUP
("atime.sec‚ot delimited");

848 
©ime
.
tv_u£c
 = 
	`¡¹Ş
(
ı
, &cp, 10);

849 ià(!
ı
 || *cp++ != '\0')

850 
	`SCREWUP
("atime.usec‚ot delimited");

851 (è
	`©omicio
(
vwr™e
, 
»mout
, "", 1);

854 ià(*
ı
 != 'C' && *cp != 'D') {

862 ià(
fœ¡
) {

863 
	`run_”r
("%s", 
ı
);

864 
	`ex™
(1);

866 
	`SCREWUP
("expected control„ecord");

868 
mode
 = 0;

869 ++
ı
; c°< 
buf
 + 5; cp++) {

870 ià(*
ı
 < '0' || *cp > '7')

871 
	`SCREWUP
("bad mode");

872 
mode
 = (mod<< 3è| (*
ı
 - '0');

874 ià(*
ı
++ != ' ')

875 
	`SCREWUP
("mode‚ot delimited");

877 
size
 = 0; 
	`isdig™
(*
ı
);)

878 
size
 = siz* 10 + (*
ı
++ - '0');

879 ià(*
ı
++ != ' ')

880 
	`SCREWUP
("size‚ot delimited");

881 ià((
	`¡rchr
(
ı
, '/'è!ğ
NULL
è|| (
	`¡rcmp
(cp, "..") == 0)) {

882 
	`run_”r
("”rÜ: uÃx³ùed f’ame: %s", 
ı
);

883 
	`ex™
(1);

885 ià(
rgisdœ
) {

886 *
Çmebuf
;

887 
size_t
 
cursize
;

888 
size_t
 
Ãed
;

890 
Ãed
 = 
	`¡¾’
(
rg
è+ sŒËn(
ı
) + 250;

891 ià(
Ãed
 > 
cursize
) {

892 ià(
Çmebuf
)

893 
	`xä“
(
Çmebuf
);

894 
Çmebuf
 = 
	`xm®loc
(
Ãed
);

895 
cursize
 = 
Ãed
;

897 (è
	`¢´štf
(
Çmebuf
, 
Ãed
, "%s%s%s", 
rg
,

898 
	`¡rcmp
(
rg
, "/"è? "/" : "", 
ı
);

899 
Å
 = 
Çmebuf
;

901 
Å
 = 
rg
;

902 
curfe
 = 
ı
;

903 
exi¡s
 = 
	`¡©
(
Å
, &
¡b
) == 0;

904 ià(
buf
[0] == 'D') {

905 
mod_æag
 = 
pæag
;

906 ià(!
Ÿm»cursive
)

907 
	`SCREWUP
("received directory without -r");

908 ià(
exi¡s
) {

909 ià(!
	`S_ISDIR
(
¡b
.
¡_mode
)) {

910 
”ºo
 = 
ENOTDIR
;

911 
bad
;

913 ià(
pæag
)

914 (è
	`chmod
(
Å
, 
mode
);

918 
mod_æag
 = 1;

919 ià(
	`mkdœ
(
Å
, 
mode
 | 
S_IRWXU
) < 0)

920 
bad
;

922 
veù
[0] = 
	`x¡rdup
(
Å
);

923 
	`sšk
(1, 
veù
);

924 ià(
£times
) {

925 
£times
 = 0;

926 ià(
	`utimes
(
veù
[0], 
tv
) < 0)

927 
	`run_”r
("%s: setimes: %s",

928 
veù
[0], 
	`¡»¼Ü
(
”ºo
));

930 ià(
mod_æag
)

931 (è
	`chmod
(
veù
[0], 
mode
);

932 ià(
veù
[0])

933 
	`xä“
(
veù
[0]);

936 
omode
 = 
mode
;

937 
mode
 |ğ
S_IWRITE
;

938 ià((
ofd
 = 
	`İ’
(
Å
, 
O_WRONLY
|
O_CREAT
, 
mode
)) < 0) {

939 
bad
: 
	`run_”r
("%s: %s", 
Å
, 
	`¡»¼Ü
(
”ºo
));

942 (è
	`©omicio
(
vwr™e
, 
»mout
, "", 1);

943 ià((
bp
 = 
	`®locbuf
(&
bufãr
, 
ofd
, 4096)è=ğ
NULL
) {

944 (è
	`şo£
(
ofd
);

947 
ı
 = 
bp
->
buf
;

948 
w»¼
 = 
NO
;

950 
¡©by‹s
 = 0;

951 #ifdeà
PROGRESS_METER


952 ià(
show´og»ss
)

953 
	`¡¬t_´og»ss_m‘”
(
curfe
, 
size
, &
¡©by‹s
);

955 
couÁ
 = 
i
 = 0; i < 
size
; i += 4096) {

956 
amt
 = 4096;

957 ià(
i
 + 
amt
 > 
size
)

958 
amt
 = 
size
 - 
i
;

959 
couÁ
 +ğ
amt
;

961 
j
 = 
	`©omicio
(
»ad
, 
»mš
, 
ı
, 
amt
);

962 ià(
j
 == 0) {

963 
	`run_”r
("%s", 
j
 ? 
	`¡»¼Ü
(
”ºo
) :

965 
	`ex™
(1);

967 
amt
 -ğ
j
;

968 
ı
 +ğ
j
;

969 
¡©by‹s
 +ğ
j
;

970 } 
amt
 > 0);

972 ià(
couÁ
 =ğ
bp
->
út
) {

974 ià(
w»¼
 =ğ
NO
) {

975 ià(
	`©omicio
(
vwr™e
, 
ofd
, 
bp
->
buf
,

976 
couÁ
) != count) {

977 
w»¼
 = 
YES
;

978 
w»¼no
 = 
”ºo
;

981 
couÁ
 = 0;

982 
ı
 = 
bp
->
buf
;

985 #ifdeà
PROGRESS_METER


986 ià(
show´og»ss
)

987 
	`¡İ_´og»ss_m‘”
();

989 ià(
couÁ
 !ğ0 && 
w»¼
 =ğ
NO
 &&

990 
	`©omicio
(
vwr™e
, 
ofd
, 
bp
->
buf
, 
couÁ
) != count) {

991 
w»¼
 = 
YES
;

992 
w»¼no
 = 
”ºo
;

994 ià(
w»¼
 =ğ
NO
 && 
	`árunÿ‹
(
ofd
, 
size
) != 0) {

995 
	`run_”r
("%s:runÿ‹: %s", 
Å
, 
	`¡»¼Ü
(
”ºo
));

996 
w»¼
 = 
DISPLAYED
;

998 ià(
pæag
) {

999 ià(
exi¡s
 || 
omode
 !ğ
mode
)

1000 #ifdeà
HAVE_FCHMOD


1001 ià(
	`fchmod
(
ofd
, 
omode
)) {

1003 ià(
	`chmod
(
Å
, 
omode
)) {

1005 
	`run_”r
("%s: set mode: %s",

1006 
Å
, 
	`¡»¼Ü
(
”ºo
));

1007 
w»¼
 = 
DISPLAYED
;

1010 ià(!
exi¡s
 && 
omode
 !ğ
mode
)

1011 #ifdeà
HAVE_FCHMOD


1012 ià(
	`fchmod
(
ofd
, 
omode
 & ~
mask
)) {

1014 ià(
	`chmod
(
Å
, 
omode
 & ~
mask
)) {

1016 
	`run_”r
("%s: set mode: %s",

1017 
Å
, 
	`¡»¼Ü
(
”ºo
));

1018 
w»¼
 = 
DISPLAYED
;

1021 ià(
	`şo£
(
ofd
) == -1) {

1022 
w»¼
 = 
YES
;

1023 
w»¼no
 = 
”ºo
;

1025 (è
	`»¥Ú£
();

1026 ià(
£times
 && 
w»¼
 =ğ
NO
) {

1027 
£times
 = 0;

1028 ià(
	`utimes
(
Å
, 
tv
) < 0) {

1029 
	`run_”r
("%s: setimes: %s",

1030 
Å
, 
	`¡»¼Ü
(
”ºo
));

1031 
w»¼
 = 
DISPLAYED
;

1034 
w»¼
) {

1035 
YES
:

1036 
	`run_”r
("%s: %s", 
Å
, 
	`¡»¼Ü
(
w»¼no
));

1038 
NO
:

1039 (è
	`©omicio
(
vwr™e
, 
»mout
, "", 1);

1041 
DISPLAYED
:

1045 
süewup
:

1046 
	`run_”r
("´ÙocŞƒ¼Ü: %s", 
why
);

1047 
	`ex™
(1);

1048 
	}
}

1051 
	$»¥Ú£
()

1053 
ch
, *
ı
, 
»¥
, 
rbuf
[2048];

1055 ià(
	`©omicio
(
»ad
, 
»mš
, &
»¥
, (resp)) != (resp))

1056 
	`lo¡cÚn
(0);

1058 
ı
 = 
rbuf
;

1059 
»¥
) {

1063 *
ı
++ = 
»¥
;

1068 ià(
	`©omicio
(
»ad
, 
»mš
, &
ch
, (ch)) != (ch))

1069 
	`lo¡cÚn
(0);

1070 *
ı
++ = 
ch
;

1071 } 
ı
 < &
rbuf
[Ôbufè- 1] && 
ch
 != '\n');

1073 ià(!
Ÿm»mÙe
)

1074 (è
	`©omicio
(
vwr™e
, 
STDERR_FILENO
, 
rbuf
, 
ı
 -„buf);

1075 ++
”rs
;

1076 ià(
»¥
 == 1)

1078 
	`ex™
(1);

1081 
	}
}

1084 
	$u§ge
()

1086 (è
	`årštf
(
¡d”r
,

1090 
	`ex™
(1);

1091 
	}
}

1094 
	$run_”r
(cÚ¡ *
fmt
,...)

1096 
FILE
 *
å
;

1097 
va_li¡
 
­
;

1099 ++
”rs
;

1100 ià(
å
 =ğ
NULL
 && !(å = 
	`fdİ’
(
»mout
, "w")))

1102 (è
	`årštf
(
å
, "%c", 0x01);

1103 (è
	`årštf
(
å
, "scp: ");

1104 
	`va_¡¬t
(
­
, 
fmt
);

1105 (è
	`vårštf
(
å
, 
fmt
, 
­
);

1106 
	`va_’d
(
­
);

1107 (è
	`årštf
(
å
, "\n");

1108 (è
	`fæush
(
å
);

1110 ià(!
Ÿm»mÙe
) {

1111 
	`va_¡¬t
(
­
, 
fmt
);

1112 
	`vårštf
(
¡d”r
, 
fmt
, 
­
);

1113 
	`va_’d
(
­
);

1114 
	`årštf
(
¡d”r
, "\n");

1116 
	}
}

1119 
	$v”ifydœ
(*
ı
)

1121 
¡©
 
¡b
;

1123 ià(!
	`¡©
(
ı
, &
¡b
)) {

1124 ià(
	`S_ISDIR
(
¡b
.
¡_mode
))

1126 
”ºo
 = 
ENOTDIR
;

1128 
	`run_”r
("%s: %s", 
ı
, 
	`¡»¼Ü
(
”ºo
));

1129 
	`klchd
(0);

1130 
	}
}

1133 
	$okÇme
(*
ı0
)

1135 
c
;

1136 *
ı
;

1138 
ı
 = 
ı0
;

1140 
c
 = ()*
ı
;

1141 ià(
c
 & 0200)

1142 
bad
;

1143 ià(!
	`i§Íha
(
c
è&& !
	`isdig™
(c)) {

1144 
c
) {

1150 
bad
;

1155 } *++
ı
);

1158 
bad
: 
	`årštf
(
¡d”r
, "%s: inv®id u£¸Çme\n", 
ı0
);

1160 
	}
}

1162 
BUF
 *

1163 
	$®locbuf
(
BUF
 *
bp
, 
fd
, 
blksize
)

1165 
size_t
 
size
;

1166 #ifdeà
HAVE_STRUCT_STAT_ST_BLKSIZE


1167 
¡©
 
¡b
;

1169 ià(
	`f¡©
(
fd
, &
¡b
) < 0) {

1170 
	`run_”r
("f¡©: %s", 
	`¡»¼Ü
(
”ºo
));

1173 
size
 = 
	`roundup
(
¡b
.
¡_blksize
, 
blksize
);

1174 ià(
size
 == 0)

1175 
size
 = 
blksize
;

1177 
size
 = 
blksize
;

1179 ià(
bp
->
út
 >ğ
size
)

1180  (
bp
);

1181 ià(
bp
->
buf
 =ğ
NULL
)

1182 
bp
->
buf
 = 
	`xm®loc
(
size
);

1184 
bp
->
buf
 = 
	`x»®loc
(bp->buf, 
size
);

1185 
	`mem£t
(
bp
->
buf
, 0, 
size
);

1186 
bp
->
út
 = 
size
;

1187  (
bp
);

1188 
	}
}

1191 
	$lo¡cÚn
(
signo
)

1193 ià(!
Ÿm»mÙe
)

1194 
	`wr™e
(
STDERR_FILENO
, "lost connection\n", 16);

1195 ià(
signo
)

1196 
	`_ex™
(1);

1198 
	`ex™
(1);

1199 
	}
}

	@scpmisc.c

43 
	~"šşudes.h
"

44 
	~"sımisc.h
"

47 
	$xm®loc
(
size_t
 
size
)

49 *
±r
;

51 ià(
size
 == 0) {

52 
	`årštf
(
¡d”r
, "xmalloc: zero size\n");

53 
	`ex™
(
EXIT_FAILURE
);

55 
±r
 = 
	`m®loc
(
size
);

56 ià(
±r
 =ğ
NULL
) {

57 
	`årštf
(
¡d”r
, "xm®loc: ouˆoàmemÜy (®loÿtšg %lu by‹s)\n", (
u_lÚg
è
size
);

58 
	`ex™
(
EXIT_FAILURE
);

60  
±r
;

61 
	}
}

64 
	$x»®loc
(*
±r
, 
size_t
 
Ãw_size
)

66 *
Ãw_±r
;

68 ià(
Ãw_size
 == 0) {

69 
	`årštf
(
¡d”r
, "xrealloc: zero size\n");

70 
	`ex™
(
EXIT_FAILURE
);

72 ià(
±r
 =ğ
NULL
)

73 
Ãw_±r
 = 
	`m®loc
(
Ãw_size
);

75 
Ãw_±r
 = 
	`»®loc
(
±r
, 
Ãw_size
);

76 ià(
Ãw_±r
 =ğ
NULL
) {

77 
	`årštf
(
¡d”r
, "x»®loc: ouˆoàmemÜy (Ãw_siz%lu by‹s)\n", (
u_lÚg
è
Ãw_size
);

78 
	`ex™
(
EXIT_FAILURE
);

80  
Ãw_±r
;

81 
	}
}

84 
	$xä“
(*
±r
)

86 ià(
±r
 =ğ
NULL
) {

87 
	`årštf
(
¡d”r
, "xfree: NULL…ointer given‡s‡rgument\n");

88 
	`ex™
(
EXIT_FAILURE
);

90 
	`ä“
(
±r
);

91 
	}
}

94 
	$x¡rdup
(cÚ¡ *
¡r
)

96 
size_t
 
Ën
;

97 *
ı
;

99 
Ën
 = 
	`¡¾’
(
¡r
) + 1;

100 
ı
 = 
	`xm®loc
(
Ën
);

101 
	`¡ºıy
(
ı
, 
¡r
, 
Ën
);

102  
ı
;

103 
	}
}

106 
	$ş—nho¡Çme
(*
ho¡
)

108 ià(*
ho¡
 =ğ'[' && ho¡[
	`¡¾’
(host) - 1] == ']') {

109 
ho¡
[
	`¡¾’
(host) - 1] = '\0';

110  (
ho¡
 + 1);

112  
ho¡
;

113 
	}
}

116 
	$cŞÚ
(*
ı
)

118 
æag
 = 0;

120 ià(*
ı
 == ':')

122 ià(*
ı
 == '[')

123 
æag
 = 1;

125 ; *
ı
; ++cp) {

126 ià(*
ı
 == '@' && *(cp+1) == '[')

127 
æag
 = 1;

128 ià(*
ı
 =ğ']' && *(ı+1è=ğ':' && 
æag
)

129  (
ı
+1);

130 ià(*
ı
 =ğ':' && !
æag
)

131  (
ı
);

132 ià(*
ı
 == '/')

136 
	}
}

140 
	$add¬gs
(
¬gli¡
 *
¬gs
, *
fmt
, ...)

142 
va_li¡
 
­
;

143 *
ı
;

144 
u_št
 
ÇÎoc
;

145 
r
;

147 
	`va_¡¬t
(
­
, 
fmt
);

148 
r
 = 
	`va¥rštf
(&
ı
, 
fmt
, 
­
);

149 
	`va_’d
(
­
);

150 ià(
r
 == -1)

151 
	`çl
("addargs:‡rgumentoo†ong");

153 
ÇÎoc
 = 
¬gs
->nalloc;

154 ià(
¬gs
->
li¡
 =ğ
NULL
) {

155 
ÇÎoc
 = 32;

156 
¬gs
->
num
 = 0;

157 } ià(
¬gs
->
num
+2 >ğ
ÇÎoc
)

158 
ÇÎoc
 *= 2;

160 
¬gs
->
li¡
 = 
	`x»®loc
×rgs->li¡, 
ÇÎoc
 * (*));

161 
¬gs
->
ÇÎoc
 =‚alloc;

162 
¬gs
->
li¡
[¬gs->
num
++] = 
ı
;

163 
¬gs
->
li¡
[¬gs->
num
] = 
NULL
;

164 
	}
}

167 
	$»¶aû¬g
(
¬gli¡
 *
¬gs
, 
u_št
 
which
, *
fmt
, ...)

169 
va_li¡
 
­
;

170 *
ı
;

171 
r
;

173 
	`va_¡¬t
(
­
, 
fmt
);

174 
r
 = 
	`va¥rštf
(&
ı
, 
fmt
, 
­
);

175 
	`va_’d
(
­
);

176 ià(
r
 == -1)

177 
	`çl
("replacearg:‡rgumentoo†ong");

179 ià(
which
 >ğ
¬gs
->
num
)

180 
	`çl
("replacearg:riedo„eplace invalid‡rg %d >= %d",

181 
which
, 
¬gs
->
num
);

182 
	`xä“
(
¬gs
->
li¡
[
which
]);

183 
¬gs
->
li¡
[
which
] = 
ı
;

184 
	}
}

187 
	$ä“¬gs
(
¬gli¡
 *
¬gs
)

189 
u_št
 
i
;

191 ià(
¬gs
->
li¡
 !ğ
NULL
) {

192 
i
 = 0; i < 
¬gs
->
num
; i++)

193 
	`xä“
(
¬gs
->
li¡
[
i
]);

194 
	`xä“
(
¬gs
->
li¡
);

195 
¬gs
->
ÇÎoc
 =‡rgs->
num
 = 0;

196 
¬gs
->
li¡
 = 
NULL
;

198 
	}
}

204 *
	$ssh_g‘_´ogÇme
(*
¬gv0
)

206 *
p
;

208 ià(
¬gv0
 =ğ
NULL
)

210 
p
 = 
	`¡¼chr
(
¬gv0
, '/');

211 ià(
p
 =ğ
NULL
)

212 
p
 = 
¬gv0
;

214 
p
++;

216  (
	`x¡rdup
(
p
));

217 
	}
}

219 
	$çl
(* 
fmt
,...)

221 
va_li¡
 
¬gs
;

222 
	`va_¡¬t
(
¬gs
, 
fmt
);

223 
	`vårštf
(
¡d”r
, 
fmt
, 
¬gs
);

224 
	`va_’d
(
¬gs
);

225 
	`ex™
(255);

226 
	}
}

229 
	$§n™i£_¡dfd
()

231 
nuÎfd
, 
dupfd
;

233 ià((
nuÎfd
 = 
dupfd
 = 
	`İ’
(
_PATH_DEVNULL
, 
O_RDWR
)) == -1) {

234 
	`årštf
(
¡d”r
, "Couldn'ˆİ’ /dev/nuÎ: %s", 
	`¡»¼Ü
(
”ºo
));

235 
	`ex™
(1);

237 ++
dupfd
 <= 2) {

239 ià(
	`fú
(
dupfd
, 
F_GETFL
, 0) >= 0)

241 ià(
	`dup2
(
nuÎfd
, 
dupfd
) == -1) {

242 
	`årštf
(
¡d”r
, "dup2: %s", 
	`¡»¼Ü
(
”ºo
));

243 
	`ex™
(1);

246 ià(
nuÎfd
 > 2)

247 
	`şo£
(
nuÎfd
);

248 
	}
}

	@scpmisc.h

16 
	#vwr™e
 (
	`ssize_t
 (*)(, *, 
size_t
))
wr™e


	)

18 *
chİ
(*);

19 *
¡rd–im
(**);

20 
£t_nÚblock
();

21 
un£t_nÚblock
();

22 
£t_nod–ay
();

23 
a2pÜt
(const *);

24 *
ş—nho¡Çme
(*);

25 *
cŞÚ
(*);

26 
cÚvtime
(const *);

28 
·sswd
 *
pwcİy
(passwd *);

30 
¬gli¡
 
	t¬gli¡
;

31 
	s¬gli¡
 {

32 **
	mli¡
;

33 
	mnum
;

34 
	mÇÎoc
;

36 
add¬gs
(
¬gli¡
 *, *, ...);

37 
»¶aû¬g
(
¬gli¡
 *, 
u_št
, *, ...);

38 
ä“¬gs
(
¬gli¡
 *);

41 *
xm®loc
(
size_t
);

42 *
x»®loc
(*, 
size_t
);

43 
xä“
(*);

44 *
x¡rdup
(const *);

46 *
ssh_g‘_´ogÇme
(*);

47 
çl
(* 
fmt
,...);

48 
§n™i£_¡dfd
();

51 #iâdeà
tim”sub


52 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

54 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

55 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

56 ià((
»suÉ
)->
tv_u£c
 < 0) { \

57 --(
»suÉ
)->
tv_£c
; \

58 (
»suÉ
)->
tv_u£c
 += 1000000; \

60 } 0)

	)

63 #iâdeà
TIMEVAL_TO_TIMESPEC


64 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

65 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

66 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

67 }

	)

	@service.h

25 #iâdeà
_SERVICE_H_


26 
	#_SERVICE_H_


	)

28 
»cv_msg_£rviû_»que¡
();

29 
£nd_msg_£rviû_»que¡
();

30 
»cv_msg_£rviû_acû±
();

	@session.h

25 #iâdeà
_SESSION_H_


26 
	#_SESSION_H_


	)

28 
	~"šşudes.h
"

29 
	~"İtiÚs.h
"

30 
	~"bufãr.h
"

31 
	~"signkey.h
"

32 
	~"kex.h
"

33 
	~"auth.h
"

34 
	~"chªÃl.h
"

35 
	~"queue.h
"

36 
	~"li¡’”.h
"

37 
	~"·ck‘.h
"

38 
	~"tıfwd.h
"

39 
	~"chª£ssiÚ.h
"

41 
£ssš™dÚe
;

42 
ex™æag
;

44 
commÚ_£ssiÚ_š™
(
sock_š
, 
sock_out
);

45 
£ssiÚ_loİ
((*
loİhªdËr
)());

46 
commÚ_£ssiÚ_ş—nup
();

47 
£ssiÚ_id’tifiÿtiÚ
();

48 
£nd_msg_ignÜe
();

50 cÚ¡ * 
g‘_u£r_sh–l
();

51 
fl_·sswd
(cÚ¡ * 
u£ºame
);

54 
svr_£ssiÚ
(
sock
, 
chdpe
);

55 
svr_drİb—r_ex™
(
ex™code
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
);

56 
svr_drİb—r_log
(
´iÜ™y
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
);

59 
şi_£ssiÚ
(
sock_š
, 
sock_out
);

60 
şi_£ssiÚ_ş—nup
();

61 
ş—Áext
(* 
dœty‹xt
);

64 
	skey_cÚ‹xt_dœeùiÚ®
 {

65 cÚ¡ 
drİb—r_ch”
 *
	m®go_üy±
;

66 cÚ¡ 
drİb—r_ch”_mode
 *
	müy±_mode
;

67 cÚ¡ 
drİb—r_hash
 *
	m®go_mac
;

68 
	mhash_šdex
;

69 
	m®go_comp
;

70 #iâdeà
DISABLE_ZLIB


71 
z_¡»amp
 
	mz¡»am
;

75 
symm‘ric_CBC
 
	mcbc
;

76 #ifdeà
DROPBEAR_ENABLE_CTR_MODE


77 
symm‘ric_CTR
 
	mùr
;

79 } 
	mch”_¡©e
;

80 
	mmackey
[
MAX_MAC_KEY
];

83 
	skey_cÚ‹xt
 {

85 
key_cÚ‹xt_dœeùiÚ®
 
	m»cv
;

86 
key_cÚ‹xt_dœeùiÚ®
 
	mŒªs
;

88 
	m®go_kex
;

89 
	m®go_ho¡key
;

91 
	m®low_com´ess
;

95 
	g·ck‘li¡
;

96 
	s·ck‘li¡
 {

97 
·ck‘li¡
 *
	mÃxt
;

98 
bufãr
 * 
	m·ylßd
;

101 
	sssh£ssiÚ
 {

104 
	mis£rv”
;

106 
time_t
 
	mcÚÃù_time
;

110 
	msock_š
;

111 
	msock_out
;

113 *
	m»mÙeid’t
;

115 
	mmaxfd
;

119 
bufãr
 *
	mwr™•aylßd
;

122 
Queue
 
	mwr™equeue
;

123 
bufãr
 *
	m»adbuf
;

124 
bufãr
 *
	m·ylßd
;

125 
	mŒªs£q
, 
	m»cv£q
;

128 cÚ¡ 
·ck‘ty³
 * 
	m·ck‘ty³s
;

131 
	md©¯Îowed
 : 1;

134 
	m»quœ’ext
;

137 
	mignÜ’ext
;

140 
	mÏ¡·ck‘
;

142 
	msigÇl_pe
[2];

145 
time_t
 
	mÏ¡_Œx_·ck‘_time
;

148 
time_t
 
	mÏ¡_·ck‘_time
;

153 
KEXS‹
 
	mkex¡©e
;

154 
key_cÚ‹xt
 *
	mkeys
;

155 
key_cÚ‹xt
 *
	mÃwkeys
;

156 *
	m£ssiÚ_id
;

158 
mp_št
 * 
	mdh_K
;

159 
	mhash
[
SHA1_HASH_SIZE
];

160 
bufãr
* 
	mkexhashbuf
;

161 
bufãr
* 
	mŒªskexš™
;

165 
®go_ty³
 *
	mcom´ess_®gos
;

169 
·ck‘li¡
 *
	m»¶y_queue_h—d
, *
	m»¶y_queue_
;

171 
	m®go_ty³
*(*
	mbuf_m©ch_®go
)(
bufãr
*
	mbuf
, 
®go_ty³
 
	mloÿÏlgos
[],

172 *
	mgoodguess
);

177 (*
	m»mÙeşo£d
)();

181 
AuthS‹
 
	mauth¡©e
;

185 
ChªÃl
 ** 
	mchªÃls
;

186 
	mchªsize
;

187 
	mchªcouÁ
;

188 cÚ¡ 
ChªTy³
 **
	mchªty³s
;

192 
Li¡’”
 ** 
	mli¡’”s
;

193 
	mli¡’size
;

197 
	m®low´ivpÜt
;

201 
	s£rv”£ssiÚ
 {

204 
	mchdpe
;

207 
ChdPid
 * 
	mchdpids
;

208 
	mchdpidsize
;

212 
ex™šfo
 
	mÏ¡ex™
;

215 * 
	maddr¡ršg
;

218 *
	m»mÙeho¡
;

220 #ifdeà
__uClšux__


221 
pid_t
 
	m£rv”_pid
;

227 
	mKEX_NOTHING
,

228 
	mKEXINIT_RCVD
,

229 
	mKEXDH_INIT_SENT
,

230 
	mKEXDONE


231 } 
	tşi_kex_¡©e
;

234 
	mSTATE_NOTHING
,

235 
	mSERVICE_AUTH_REQ_SENT
,

236 
	mSERVICE_AUTH_ACCEPT_RCVD
,

237 
	mSERVICE_CONN_REQ_SENT
,

238 
	mSERVICE_CONN_ACCEPT_RCVD
,

239 
	mUSERAUTH_REQ_SENT
,

240 
	mUSERAUTH_FAIL_RCVD
,

241 
	mUSERAUTH_SUCCESS_RCVD
,

242 
	mSESSION_RUNNING


243 } 
	tşi_¡©e
;

245 
	sş›Á£ssiÚ
 {

247 
mp_št
 *
	mdh_e
, *
	mdh_x
;

248 
şi_kex_¡©e
 
	mkex_¡©e
;

249 
şi_¡©e
 
	m¡©e
;

250 
	mdÚefœ¡kex
 : 1;

252 
	m‰y_¿w_mode
;

253 
‹rmios
 
	m§ved_tio
;

254 
	m¡dšcİy
;

255 
	m¡dšæags
;

256 
	m¡doutcİy
;

257 
	m¡doutæags
;

258 
	m¡d”rcİy
;

259 
	m¡d”ræags
;

261 
	mwšchªge
;

263 
	mÏ¡authty³
;

265 #ifdeà
ENABLE_CLI_INTERACT_AUTH


266 
	mauth_š‹¿ù_çed
;

268 
	mš‹¿ù_»que¡_»ûived
;

272 
sign_key
 *
	mÏ¡´ivkey
;

274 
	m»tv®
;

276 
TODO


277 
Ag’tkeyLi¡
 *
	mag’tkeys
;

283 
ssh£ssiÚ
 
£s
;

285 #ifdeà
DROPBEAR_SERVER


286 
£rv”£ssiÚ
 
svr_£s
;

289 #ifdeà
DROPBEAR_CLIENT


290 
ş›Á£ssiÚ
 
şi_£s
;

	@sftp-server/addrmatch.c

19 
	~"šşudes.h
"

21 
	~<sys/ty³s.h
>

22 
	~<sys/sock‘.h
>

23 
	~<Ãtš‘/š.h
>

24 
	~<¬·/š‘.h
>

26 
	~<Ãtdb.h
>

27 
	~<¡ršg.h
>

28 
	~<¡dlib.h
>

29 
	~<¡dio.h
>

30 
	~<¡d¬g.h
>

32 
	~"m©ch.h
"

33 
	~"log.h
"

34 
	~"xm®loc.h
"

36 
	sxaddr
 {

37 
§_çmy_t
 
	maf
;

39 
š_addr
 
	mv4
;

40 
š6_addr
 
	mv6
;

41 
u_št8_t
 
	maddr8
[16];

42 
u_št32_t
 
	maddr32
[4];

43 } 
	mxa
;

44 
u_št32_t
 
	mscİe_id
;

45 
	#v4
 
xa
.
v4


	)

46 
	#v6
 
xa
.
v6


	)

47 
	#addr8
 
xa
.
addr8


	)

48 
	#addr32
 
xa
.
addr32


	)

52 
	$addr_uniÿ¡_maskËn
(
af
)

54 
af
) {

55 
AF_INET
:

57 
AF_INET6
:

62 
	}
}

64 
šlše
 

65 
	$maskËn_v®id
(
af
, 
u_št
 
maskËn
)

67 
af
) {

68 
AF_INET
:

69  
maskËn
 <= 32 ? 0 : -1;

70 
AF_INET6
:

71  
maskËn
 <= 128 ? 0 : -1;

75 
	}
}

82 
	$addr_§_to_xaddr
(
sockaddr
 *
§
, 
sockËn_t
 
¦’
, 
xaddr
 *
xa
)

84 
sockaddr_š
 *
š4
 = (sockaddr_š *)
§
;

85 
sockaddr_š6
 *
š6
 = (sockaddr_š6 *)
§
;

87 
	`mem£t
(
xa
, '\0', (*xa));

89 
§
->
§_çmy
) {

90 
AF_INET
:

91 ià(
¦’
 < (*
š4
))

93 
xa
->
af
 = 
AF_INET
;

94 
	`memıy
(&
xa
->
v4
, &
š4
->
sš_addr
, (xa->v4));

96 
AF_INET6
:

97 ià(
¦’
 < (*
š6
))

99 
xa
->
af
 = 
AF_INET6
;

100 
	`memıy
(&
xa
->
v6
, &
š6
->
sš6_addr
, (xa->v6));

101 #ifdeà
HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID


102 
xa
->
scİe_id
 = 
š6
->
sš6_scİe_id
;

110 
	}
}

118 
	$addr_Ãtmask
(
af
, 
u_št
 
l
, 
xaddr
 *
n
)

120 
i
;

122 ià(
	`maskËn_v®id
(
af
, 
l
è!ğ0 || 
n
 =ğ
NULL
)

125 
	`mem£t
(
n
, '\0', (*n));

126 
af
) {

127 
AF_INET
:

128 
n
->
af
 = 
AF_INET
;

129 ià(
l
 == 0)

131 
n
->
v4
.
s_addr
 = 
	`htÚl
((0xfffffffà<< (32 - 
l
)) & 0xffffffff);

133 
AF_INET6
:

134 
n
->
af
 = 
AF_INET6
;

135 
i
 = 0; i < 4 && 
l
 >= 32; i++,† -= 32)

136 
n
->
addr32
[
i
] = 0xffffffffU;

137 ià(
i
 < 4 && 
l
 != 0)

138 
n
->
addr32
[
i
] = 
	`htÚl
((0xfffffffà<< (32 - 
l
)) &

144 
	}
}

151 
	$addr_ªd
(
xaddr
 *
d¡
, cÚ¡ xadd¸*
a
, cÚ¡ xadd¸*
b
)

153 
i
;

155 ià(
d¡
 =ğ
NULL
 || 
a
 =ğNULL || 
b
 =ğNULL ||‡->
af
 != b->af)

158 
	`memıy
(
d¡
, 
a
, (*dst));

159 
a
->
af
) {

160 
AF_INET
:

161 
d¡
->
v4
.
s_addr
 &ğ
b
->v4.s_addr;

163 
AF_INET6
:

164 
d¡
->
scİe_id
 = 
a
->scope_id;

165 
i
 = 0; i < 4; i++)

166 
d¡
->
addr32
[
i
] &ğ
b
->addr32[i];

171 
	}
}

178 
	$addr_cmp
(cÚ¡ 
xaddr
 *
a
, cÚ¡ xadd¸*
b
)

180 
i
;

182 ià(
a
->
af
 !ğ
b
->af)

183  
a
->
af
 =ğ
AF_INET6
 ? 1 : -1;

185 
a
->
af
) {

186 
AF_INET
:

187 ià(
a
->
v4
.
s_addr
 =ğ
b
->v4.s_addr)

189  
	`Áohl
(
a
->
v4
.
s_addr
è>‚tohl(
b
->v4.s_addr) ? 1 : -1;

190 
AF_INET6
:

191 
i
 = 0; i < 16; i++)

192 ià(
a
->
addr8
[
i
] - 
b
->addr8[i] != 0)

193  
a
->
addr8
[
i
] > 
b
->addr8[i] ? 1 : -1;

194 ià(
a
->
scİe_id
 =ğ
b
->scope_id)

196  
a
->
scİe_id
 > 
b
->scope_id ? 1 : -1;

200 
	}
}

207 
	$addr_±Ú
(cÚ¡ *
p
, 
xaddr
 *
n
)

209 
addršfo
 
hšts
, *
ai
;

211 
	`mem£t
(&
hšts
, '\0', (hints));

212 
hšts
.
ai_æags
 = 
AI_NUMERICHOST
;

214 ià(
p
 =ğ
NULL
 || 
	`g‘addršfo
Õ, NULL, &
hšts
, &
ai
) != 0)

217 ià(
ai
 =ğ
NULL
 ||‡i->
ai_addr
 == NULL)

220 ià(
n
 !ğ
NULL
 &&

221 
	`addr_§_to_xaddr
(
ai
->
ai_addr
,‡i->
ai_add¾’
, 
n
) == -1) {

222 
	`ä“addršfo
(
ai
);

226 
	`ä“addršfo
(
ai
);

228 
	}
}

235 
	$addr_šv”t
(
xaddr
 *
n
)

237 
i
;

239 ià(
n
 =ğ
NULL
)

242 
n
->
af
) {

243 
AF_INET
:

244 
n
->
v4
.
s_addr
 = ~n->v4.s_addr;

246 
AF_INET6
:

247 
i
 = 0; i < 4; i++)

248 
n
->
addr32
[
i
] = ~n->addr32[i];

253 
	}
}

261 
	$addr_ho¡mask
(
af
, 
u_št
 
l
, 
xaddr
 *
n
)

263 ià(
	`addr_Ãtmask
(
af
, 
l
, 
n
è=ğ-1 || 
	`addr_šv”t
(n) == -1)

266 
	}
}

273 
	$addr_is_®l0s
(cÚ¡ 
xaddr
 *
a
)

275 
i
;

277 
a
->
af
) {

278 
AF_INET
:

279  (
a
->
v4
.
s_addr
 == 0 ? 0 : -1);

280 
AF_INET6
:;

281 
i
 = 0; i < 4; i++)

282 ià(
a
->
addr32
[
i
] != 0)

288 
	}
}

297 
	$addr_ho¡_is_®l0s
(cÚ¡ 
xaddr
 *
a
, 
u_št
 
maskËn
)

299 
xaddr
 
tmp_addr
, 
tmp_mask
, 
tmp_»suÉ
;

301 
	`memıy
(&
tmp_addr
, 
a
, (tmp_addr));

302 ià(
	`addr_ho¡mask
(
a
->
af
, 
maskËn
, &
tmp_mask
) == -1)

304 ià(
	`addr_ªd
(&
tmp_»suÉ
, &
tmp_addr
, &
tmp_mask
) == -1)

306  (
	`addr_is_®l0s
(&
tmp_»suÉ
));

307 
	}
}

314 
	$addr_±Ú_cidr
(cÚ¡ *
p
, 
xaddr
 *
n
, 
u_št
 *
l
)

316 
xaddr
 
tmp
;

317 
maskËn
 = 999;

318 
addrbuf
[64], *
mp
, *
ı
;

321 ià(
p
 =ğ
NULL
 || 
	`¡¾ıy
(
addrbuf
,…, (addrbuf)) > (addrbuf))

324 ià((
mp
 = 
	`¡rchr
(
addrbuf
, '/')è!ğ
NULL
) {

325 *
mp
 = '\0';

326 
mp
++;

327 
maskËn
 = 
	`¡¹oul
(
mp
, &
ı
, 10);

328 ià(*
mp
 =ğ'\0' || *
ı
 !ğ'\0' || 
maskËn
 > 128)

332 ià(
	`addr_±Ú
(
addrbuf
, &
tmp
) == -1)

335 ià(
mp
 =ğ
NULL
)

336 
maskËn
 = 
	`addr_uniÿ¡_maskËn
(
tmp
.
af
);

337 ià(
	`maskËn_v®id
(
tmp
.
af
, 
maskËn
) == -1)

339 ià(
	`addr_ho¡_is_®l0s
(&
tmp
, 
maskËn
) != 0)

342 ià(
n
 !ğ
NULL
)

343 
	`memıy
(
n
, &
tmp
, (*n));

344 ià(
l
 !ğ
NULL
)

345 *
l
 = 
maskËn
;

348 
	}
}

351 
	$addr_Ãtm©ch
(cÚ¡ 
xaddr
 *
ho¡
, cÚ¡ xadd¸*
Ãt
, 
u_št
 
maskËn
)

353 
xaddr
 
tmp_mask
, 
tmp_»suÉ
;

355 ià(
ho¡
->
af
 !ğ
Ãt
->af)

358 ià(
	`addr_Ãtmask
(
ho¡
->
af
, 
maskËn
, &
tmp_mask
) == -1)

360 ià(
	`addr_ªd
(&
tmp_»suÉ
, 
ho¡
, &
tmp_mask
) == -1)

362  
	`addr_cmp
(&
tmp_»suÉ
, 
Ãt
);

363 
	}
}

378 
	$addr_m©ch_li¡
(cÚ¡ *
addr
, cÚ¡ *
_li¡
)

380 *
li¡
, *
ı
, *
o
;

381 
xaddr
 
Œy_addr
, 
m©ch_addr
;

382 
u_št
 
maskËn
, 
Ãg
;

383 
»t
 = 0, 
r
;

385 ià(
addr
 !ğ
NULL
 && 
	`addr_±Ú
×ddr, &
Œy_addr
) != 0) {

386 
	`debug2
("%s: couldn'ˆ·r£‡dd»s %.100s", 
__func__
, 
addr
);

389 ià((
o
 = 
li¡
 = 
	`¡rdup
(
_li¡
)è=ğ
NULL
)

391 (
ı
 = 
	`¡r£p
(&
li¡
, ",")è!ğ
NULL
) {

392 
Ãg
 = *
ı
 == '!';

393 ià(
Ãg
)

394 
ı
++;

395 ià(*
ı
 == '\0') {

396 
»t
 = -2;

400 
r
 = 
	`addr_±Ú_cidr
(
ı
, &
m©ch_addr
, &
maskËn
);

401 ià(
r
 == -2) {

402 
	`”rÜ
("Inconsistent mask†ength for "

403 "ÃtwÜk \"%.100s\"", 
ı
);

404 
»t
 = -2;

406 } ià(
r
 == 0) {

407 ià(
addr
 !ğ
NULL
 && 
	`addr_Ãtm©ch
(&
Œy_addr
,

408 &
m©ch_addr
, 
maskËn
) == 0) {

409 
found™
:

410 ià(
Ãg
) {

411 
»t
 = -1;

414 
»t
 = 1;

419 ià(
addr
 !ğ
NULL
 && 
	`m©ch_·‰”n
×ddr, 
ı
) == 1)

420 
found™
;

423 
	`xä“
(
o
);

425  
»t
;

426 
	}
}

438 
	$addr_m©ch_cidr_li¡
(cÚ¡ *
addr
, cÚ¡ *
_li¡
)

440 *
li¡
, *
ı
, *
o
;

441 
xaddr
 
Œy_addr
, 
m©ch_addr
;

442 
u_št
 
maskËn
;

443 
»t
 = 0, 
r
;

445 ià(
addr
 !ğ
NULL
 && 
	`addr_±Ú
×ddr, &
Œy_addr
) != 0) {

446 
	`debug2
("%s: couldn'ˆ·r£‡dd»s %.100s", 
__func__
, 
addr
);

449 ià((
o
 = 
li¡
 = 
	`¡rdup
(
_li¡
)è=ğ
NULL
)

451 (
ı
 = 
	`¡r£p
(&
li¡
, ",")è!ğ
NULL
) {

452 ià(*
ı
 == '\0') {

453 
	`”rÜ
("%s:ƒmptyƒntry in†ist \"%.100s\"",

454 
__func__
, 
o
);

455 
»t
 = -1;

466 ià(
	`¡¾’
(
ı
è> 
INET6_ADDRSTRLEN
 + 3) {

467 
	`”rÜ
("%s:†istƒntry \"%.100s\"oo†ong",

468 
__func__
, 
ı
);

469 
»t
 = -1;

472 
	#VALID_CIDR_CHARS
 "0123456789abcdefABCDEF.:/"

	)

473 ià(
	`¡r¥n
(
ı
, 
VALID_CIDR_CHARS
è!ğ
	`¡¾’
(cp)) {

474 
	`”rÜ
("%s:†istƒntry \"%.100s\" contains invalid "

475 "ch¬aù”s", 
__func__
, 
ı
);

476 
»t
 = -1;

480 
r
 = 
	`addr_±Ú_cidr
(
ı
, &
m©ch_addr
, &
maskËn
);

481 ià(
r
 == -1) {

482 
	`”rÜ
("Inv®id‚‘wÜkƒÁry \"%.100s\"", 
ı
);

483 
»t
 = -1;

485 } ià(
r
 == -2) {

486 
	`”rÜ
("Inconsistent mask†ength for "

487 "ÃtwÜk \"%.100s\"", 
ı
);

488 
»t
 = -1;

490 } ià(
r
 =ğ0 && 
addr
 !ğ
NULL
) {

491 ià(
	`addr_Ãtm©ch
(&
Œy_addr
, &
m©ch_addr
,

492 
maskËn
) == 0)

493 
»t
 = 1;

497 
	`xä“
(
o
);

499  
»t
;

500 
	}
}

	@sftp-server/bufaux.c

40 
	~"šşudes.h
"

42 
	~<sys/ty³s.h
>

44 
	~<İ’s¦/bn.h
>

46 
	~<¡ršg.h
>

47 
	~<¡d¬g.h
>

49 
	~"xm®loc.h
"

50 
	~"bufãr.h
"

51 
	~"log.h
"

52 
	~"misc.h
"

59 
	$bufãr_g‘_shÜt_»t
(
u_shÜt
 *
»t
, 
Bufãr
 *
bufãr
)

61 
u_ch¬
 
buf
[2];

63 ià(
	`bufãr_g‘_»t
(
bufãr
, (*è
buf
, 2) == -1)

65 *
»t
 = 
	`g‘_u16
(
buf
);

67 
	}
}

69 
u_shÜt


70 
	$bufãr_g‘_shÜt
(
Bufãr
 *
bufãr
)

72 
u_shÜt
 
»t
;

74 ià(
	`bufãr_g‘_shÜt_»t
(&
»t
, 
bufãr
) == -1)

75 
	`çl
("buffer_get_short: bufferƒrror");

77  (
»t
);

78 
	}
}

81 
	$bufãr_g‘_št_»t
(
u_št
 *
»t
, 
Bufãr
 *
bufãr
)

83 
u_ch¬
 
buf
[4];

85 ià(
	`bufãr_g‘_»t
(
bufãr
, (*è
buf
, 4) == -1)

87 *
»t
 = 
	`g‘_u32
(
buf
);

89 
	}
}

91 
u_št


92 
	$bufãr_g‘_št
(
Bufãr
 *
bufãr
)

94 
u_št
 
»t
;

96 ià(
	`bufãr_g‘_št_»t
(&
»t
, 
bufãr
) == -1)

97 
	`çl
("buffer_get_int: bufferƒrror");

99  (
»t
);

100 
	}
}

103 
	$bufãr_g‘_št64_»t
(
u_št64_t
 *
»t
, 
Bufãr
 *
bufãr
)

105 
u_ch¬
 
buf
[8];

107 ià(
	`bufãr_g‘_»t
(
bufãr
, (*è
buf
, 8) == -1)

109 *
»t
 = 
	`g‘_u64
(
buf
);

111 
	}
}

113 
u_št64_t


114 
	$bufãr_g‘_št64
(
Bufãr
 *
bufãr
)

116 
u_št64_t
 
»t
;

118 ià(
	`bufãr_g‘_št64_»t
(&
»t
, 
bufãr
) == -1)

119 
	`çl
("buffer_get_int: bufferƒrror");

121  (
»t
);

122 
	}
}

128 
	$bufãr_put_shÜt
(
Bufãr
 *
bufãr
, 
u_shÜt
 
v®ue
)

130 
buf
[2];

132 
	`put_u16
(
buf
, 
v®ue
);

133 
	`bufãr_­³nd
(
bufãr
, 
buf
, 2);

134 
	}
}

137 
	$bufãr_put_št
(
Bufãr
 *
bufãr
, 
u_št
 
v®ue
)

139 
buf
[4];

141 
	`put_u32
(
buf
, 
v®ue
);

142 
	`bufãr_­³nd
(
bufãr
, 
buf
, 4);

143 
	}
}

146 
	$bufãr_put_št64
(
Bufãr
 *
bufãr
, 
u_št64_t
 
v®ue
)

148 
buf
[8];

150 
	`put_u64
(
buf
, 
v®ue
);

151 
	`bufãr_­³nd
(
bufãr
, 
buf
, 8);

152 
	}
}

163 
	$bufãr_g‘_¡ršg_»t
(
Bufãr
 *
bufãr
, 
u_št
 *
Ëngth_±r
)

165 
u_ch¬
 *
v®ue
;

166 
u_št
 
Ën
;

169 ià(
	`bufãr_g‘_št_»t
(&
Ën
, 
bufãr
) != 0) {

170 
	`”rÜ
("buffer_get_string_ret: cannotƒxtract†ength");

171  (
NULL
);

173 ià(
Ën
 > 256 * 1024) {

174 
	`”rÜ
("bufãr_g‘_¡ršg_»t: bad sŒšg†’gth %u", 
Ën
);

175  (
NULL
);

178 
v®ue
 = 
	`xm®loc
(
Ën
 + 1);

180 ià(
	`bufãr_g‘_»t
(
bufãr
, 
v®ue
, 
Ën
) == -1) {

181 
	`”rÜ
("buffer_get_string_ret: buffer_get failed");

182 
	`xä“
(
v®ue
);

183  (
NULL
);

186 
v®ue
[
Ën
] = '\0';

188 ià(
Ëngth_±r
)

189 *
Ëngth_±r
 = 
Ën
;

190  (
v®ue
);

191 
	}
}

194 
	$bufãr_g‘_¡ršg
(
Bufãr
 *
bufãr
, 
u_št
 *
Ëngth_±r
)

196 *
»t
;

198 ià((
»t
 = 
	`bufãr_g‘_¡ršg_»t
(
bufãr
, 
Ëngth_±r
)è=ğ
NULL
)

199 
	`çl
("buffer_get_string: bufferƒrror");

200  (
»t
);

201 
	}
}

204 
	$bufãr_g‘_¡ršg_±r_»t
(
Bufãr
 *
bufãr
, 
u_št
 *
Ëngth_±r
)

206 *
±r
;

207 
u_št
 
Ën
;

209 ià(
	`bufãr_g‘_št_»t
(&
Ën
, 
bufãr
) != 0)

210  
NULL
;

211 ià(
Ën
 > 256 * 1024) {

212 
	`”rÜ
("bufãr_g‘_¡ršg_±r: bad sŒšg†’gth %u", 
Ën
);

213  
NULL
;

215 
±r
 = 
	`bufãr_±r
(
bufãr
);

216 
	`bufãr_cÚsume
(
bufãr
, 
Ën
);

217 ià(
Ëngth_±r
)

218 *
Ëngth_±r
 = 
Ën
;

219  (
±r
);

220 
	}
}

223 
	$bufãr_g‘_¡ršg_±r
(
Bufãr
 *
bufãr
, 
u_št
 *
Ëngth_±r
)

225 *
»t
;

227 ià((
»t
 = 
	`bufãr_g‘_¡ršg_±r_»t
(
bufãr
, 
Ëngth_±r
)è=ğ
NULL
)

228 
	`çl
("buffer_get_string_ptr: bufferƒrror");

229  (
»t
);

230 
	}
}

236 
	$bufãr_put_¡ršg
(
Bufãr
 *
bufãr
, cÚ¡ *
buf
, 
u_št
 
Ën
)

238 
	`bufãr_put_št
(
bufãr
, 
Ën
);

239 
	`bufãr_­³nd
(
bufãr
, 
buf
, 
Ën
);

240 
	}
}

242 
	$bufãr_put_c¡ršg
(
Bufãr
 *
bufãr
, cÚ¡ *
s
)

244 ià(
s
 =ğ
NULL
)

245 
	`çl
("buffer_put_cstring: s == NULL");

246 
	`bufãr_put_¡ršg
(
bufãr
, 
s
, 
	`¡¾’
(s));

247 
	}
}

253 
	$bufãr_g‘_ch¬_»t
(*
»t
, 
Bufãr
 *
bufãr
)

255 ià(
	`bufãr_g‘_»t
(
bufãr
, 
»t
, 1) == -1) {

256 
	`”rÜ
("buffer_get_char_ret: buffer_get_ret failed");

260 
	}
}

263 
	$bufãr_g‘_ch¬
(
Bufãr
 *
bufãr
)

265 
ch
;

267 ià(
	`bufãr_g‘_ch¬_»t
(&
ch
, 
bufãr
) == -1)

268 
	`çl
("buffer_get_char: bufferƒrror");

269  (
u_ch¬
è
ch
;

270 
	}
}

276 
	$bufãr_put_ch¬
(
Bufãr
 *
bufãr
, 
v®ue
)

278 
ch
 = 
v®ue
;

280 
	`bufãr_­³nd
(
bufãr
, &
ch
, 1);

281 
	}
}

	@sftp-server/buffer.c

15 
	~"šşudes.h
"

17 
	~<sys/·¿m.h
>

19 
	~<¡dio.h
>

20 
	~<¡ršg.h
>

21 
	~<¡d¬g.h
>

23 
	~"xm®loc.h
"

24 
	~"bufãr.h
"

25 
	~"log.h
"

27 
	#BUFFER_MAX_CHUNK
 0x100000

	)

28 
	#BUFFER_MAX_LEN
 0xa00000

	)

29 
	#BUFFER_ALLOCSZ
 0x008000

	)

34 
	$bufãr_š™
(
Bufãr
 *
bufãr
)

36 cÚ¡ 
u_št
 
Ën
 = 4096;

38 
bufãr
->
®loc
 = 0;

39 
bufãr
->
buf
 = 
	`xm®loc
(
Ën
);

40 
bufãr
->
®loc
 = 
Ën
;

41 
bufãr
->
off£t
 = 0;

42 
bufãr
->
’d
 = 0;

43 
	}
}

48 
	$bufãr_ä“
(
Bufãr
 *
bufãr
)

50 ià(
bufãr
->
®loc
 > 0) {

51 
	`mem£t
(
bufãr
->
buf
, 0, bufãr->
®loc
);

52 
bufãr
->
®loc
 = 0;

53 
	`xä“
(
bufãr
->
buf
);

55 
	}
}

63 
	$bufãr_ş—r
(
Bufãr
 *
bufãr
)

65 
bufãr
->
off£t
 = 0;

66 
bufãr
->
’d
 = 0;

67 
	}
}

72 
	$bufãr_­³nd
(
Bufãr
 *
bufãr
, cÚ¡ *
d©a
, 
u_št
 
Ën
)

74 *
p
;

75 
p
 = 
	`bufãr_­³nd_¥aû
(
bufãr
, 
Ën
);

76 
	`memıy
(
p
, 
d©a
, 
Ën
);

77 
	}
}

80 
	$bufãr_com·ù
(
Bufãr
 *
bufãr
)

86 ià(
bufãr
->
off£t
 > 
	`MIN
(bufãr->
®loc
, 
BUFFER_MAX_CHUNK
)) {

87 
	`memmove
(
bufãr
->
buf
, bufãr->buà+ bufãr->
off£t
,

88 
bufãr
->
’d
 - bufãr->
off£t
);

89 
bufãr
->
’d
 -ğbufãr->
off£t
;

90 
bufãr
->
off£t
 = 0;

94 
	}
}

103 
	$bufãr_­³nd_¥aû
(
Bufãr
 *
bufãr
, 
u_št
 
Ën
)

105 
u_št
 
ÃwËn
;

106 *
p
;

108 ià(
Ën
 > 
BUFFER_MAX_CHUNK
)

109 
	`çl
("bufãr_­³nd_¥aû:†’ %u‚Ù suµÜ‹d", 
Ën
);

112 ià(
bufãr
->
off£t
 =ğbufãr->
’d
) {

113 
bufãr
->
off£t
 = 0;

114 
bufãr
->
’d
 = 0;

116 
»¡¬t
:

118 ià(
bufãr
->
’d
 + 
Ën
 < bufãr->
®loc
) {

119 
p
 = 
bufãr
->
buf
 + bufãr->
’d
;

120 
bufãr
->
’d
 +ğ
Ën
;

121  
p
;

125 ià(
	`bufãr_com·ù
(
bufãr
))

126 
»¡¬t
;

129 
ÃwËn
 = 
	`roundup
(
bufãr
->
®loc
 + 
Ën
, 
BUFFER_ALLOCSZ
);

130 ià(
ÃwËn
 > 
BUFFER_MAX_LEN
)

131 
	`çl
("buffer_append_space:‡lloc %u‚ot supported",

132 
ÃwËn
);

133 
bufãr
->
buf
 = 
	`x»®loc
(bufãr->buf, 1, 
ÃwËn
);

134 
bufãr
->
®loc
 = 
ÃwËn
;

135 
»¡¬t
;

137 
	}
}

144 
	$bufãr_check_®loc
(
Bufãr
 *
bufãr
, 
u_št
 
Ën
)

146 ià(
bufãr
->
off£t
 =ğbufãr->
’d
) {

147 
bufãr
->
off£t
 = 0;

148 
bufãr
->
’d
 = 0;

150 
»¡¬t
:

151 ià(
bufãr
->
’d
 + 
Ën
 < bufãr->
®loc
)

153 ià(
	`bufãr_com·ù
(
bufãr
))

154 
»¡¬t
;

155 ià(
	`roundup
(
bufãr
->
®loc
 + 
Ën
, 
BUFFER_ALLOCSZ
è<ğ
BUFFER_MAX_LEN
)

158 
	}
}

162 
u_št


163 
	$bufãr_Ën
(cÚ¡ 
Bufãr
 *
bufãr
)

165  
bufãr
->
’d
 - bufãr->
off£t
;

166 
	}
}

171 
	$bufãr_g‘_»t
(
Bufãr
 *
bufãr
, *
buf
, 
u_št
 
Ën
)

173 ià(
Ën
 > 
bufãr
->
’d
 - bufãr->
off£t
) {

174 
	`”rÜ
("buffer_get_ret:ryingo get more bytes %dhan in buffer %d",

175 
Ën
, 
bufãr
->
’d
 - bufãr->
off£t
);

178 
	`memıy
(
buf
, 
bufãr
->buà+ bufãr->
off£t
, 
Ën
);

179 
bufãr
->
off£t
 +ğ
Ën
;

181 
	}
}

184 
	$bufãr_g‘
(
Bufãr
 *
bufãr
, *
buf
, 
u_št
 
Ën
)

186 ià(
	`bufãr_g‘_»t
(
bufãr
, 
buf
, 
Ën
) == -1)

187 
	`çl
("buffer_get: bufferƒrror");

188 
	}
}

193 
	$bufãr_cÚsume_»t
(
Bufãr
 *
bufãr
, 
u_št
 
by‹s
)

195 ià(
by‹s
 > 
bufãr
->
’d
 - bufãr->
off£t
) {

196 
	`”rÜ
("buffer_consume_ret:ryingo get more byteshan in buffer");

199 
bufãr
->
off£t
 +ğ
by‹s
;

201 
	}
}

204 
	$bufãr_cÚsume
(
Bufãr
 *
bufãr
, 
u_št
 
by‹s
)

206 ià(
	`bufãr_cÚsume_»t
(
bufãr
, 
by‹s
) == -1)

207 
	`çl
("buffer_consume: bufferƒrror");

208 
	}
}

213 
	$bufãr_cÚsume_’d_»t
(
Bufãr
 *
bufãr
, 
u_št
 
by‹s
)

215 ià(
by‹s
 > 
bufãr
->
’d
 - bufãr->
off£t
)

217 
bufãr
->
’d
 -ğ
by‹s
;

219 
	}
}

222 
	$bufãr_cÚsume_’d
(
Bufãr
 *
bufãr
, 
u_št
 
by‹s
)

224 ià(
	`bufãr_cÚsume_’d_»t
(
bufãr
, 
by‹s
) == -1)

225 
	`çl
("buffer_consume_end:ryingo get more byteshan in buffer");

226 
	}
}

231 
	$bufãr_±r
(cÚ¡ 
Bufãr
 *
bufãr
)

233  
bufãr
->
buf
 + bufãr->
off£t
;

234 
	}
}

239 
	$bufãr_dump
(cÚ¡ 
Bufãr
 *
bufãr
)

241 
u_št
 
i
;

242 
u_ch¬
 *
uı
 = 
bufãr
->
buf
;

244 
i
 = 
bufãr
->
off£t
; i < bufãr->
’d
; i++) {

245 
	`årštf
(
¡d”r
, "%02x", 
uı
[
i
]);

246 ià((
i
-
bufãr
->
off£t
)%16==15)

247 
	`årštf
(
¡d”r
, "\r\n");

248 ià((
i
-
bufãr
->
off£t
)%2==1)

249 
	`årštf
(
¡d”r
, " ");

251 
	`årštf
(
¡d”r
, "\r\n");

252 
	}
}

	@sftp-server/buffer.h

16 #iâdeà
BUFFER_H


17 
	#BUFFER_H


	)

20 
u_ch¬
 *
	mbuf
;

21 
u_št
 
	m®loc
;

22 
u_št
 
	moff£t
;

23 
u_št
 
	m’d
;

24 } 
	tBufãr
;

26 
bufãr_š™
(
Bufãr
 *);

27 
bufãr_ş—r
(
Bufãr
 *);

28 
bufãr_ä“
(
Bufãr
 *);

30 
u_št
 
bufãr_Ën
(cÚ¡ 
Bufãr
 *);

31 *
bufãr_±r
(cÚ¡ 
Bufãr
 *);

33 
bufãr_­³nd
(
Bufãr
 *, cÚ¡ *, 
u_št
);

34 *
bufãr_­³nd_¥aû
(
Bufãr
 *, 
u_št
);

36 
bufãr_check_®loc
(
Bufãr
 *, 
u_št
);

38 
bufãr_g‘
(
Bufãr
 *, *, 
u_št
);

40 
bufãr_cÚsume
(
Bufãr
 *, 
u_št
);

41 
bufãr_cÚsume_’d
(
Bufãr
 *, 
u_št
);

43 
bufãr_dump
(cÚ¡ 
Bufãr
 *);

45 
bufãr_g‘_»t
(
Bufãr
 *, *, 
u_št
);

46 
bufãr_cÚsume_»t
(
Bufãr
 *, 
u_št
);

47 
bufãr_cÚsume_’d_»t
(
Bufãr
 *, 
u_št
);

49 
	~<İ’s¦/bn.h
>

51 
bufãr_put_bignum
(
Bufãr
 *, cÚ¡ 
BIGNUM
 *);

52 
bufãr_put_bignum2
(
Bufãr
 *, cÚ¡ 
BIGNUM
 *);

53 
bufãr_g‘_bignum
(
Bufãr
 *, 
BIGNUM
 *);

54 
bufãr_g‘_bignum2
(
Bufãr
 *, 
BIGNUM
 *);

56 
u_shÜt
 
bufãr_g‘_shÜt
(
Bufãr
 *);

57 
bufãr_put_shÜt
(
Bufãr
 *, 
u_shÜt
);

59 
u_št
 
bufãr_g‘_št
(
Bufãr
 *);

60 
bufãr_put_št
(
Bufãr
 *, 
u_št
);

62 
u_št64_t
 
bufãr_g‘_št64
(
Bufãr
 *);

63 
bufãr_put_št64
(
Bufãr
 *, 
u_št64_t
);

65 
bufãr_g‘_ch¬
(
Bufãr
 *);

66 
bufãr_put_ch¬
(
Bufãr
 *, );

68 *
bufãr_g‘_¡ršg
(
Bufãr
 *, 
u_št
 *);

69 *
bufãr_g‘_¡ršg_±r
(
Bufãr
 *, 
u_št
 *);

70 
bufãr_put_¡ršg
(
Bufãr
 *, cÚ¡ *, 
u_št
);

71 
bufãr_put_c¡ršg
(
Bufãr
 *, const *);

73 
	#bufãr_sk_¡ršg
(
b
) \

74 dØ{ 
u_št
 
l
 = 
	`bufãr_g‘_št
(
b
); 
	`bufãr_cÚsume
(b,†); } 0)

	)

76 
bufãr_put_bignum_»t
(
Bufãr
 *, cÚ¡ 
BIGNUM
 *);

77 
bufãr_g‘_bignum_»t
(
Bufãr
 *, 
BIGNUM
 *);

78 
bufãr_put_bignum2_»t
(
Bufãr
 *, cÚ¡ 
BIGNUM
 *);

79 
bufãr_g‘_bignum2_»t
(
Bufãr
 *, 
BIGNUM
 *);

80 
bufãr_g‘_shÜt_»t
(
u_shÜt
 *, 
Bufãr
 *);

81 
bufãr_g‘_št_»t
(
u_št
 *, 
Bufãr
 *);

82 
bufãr_g‘_št64_»t
(
u_št64_t
 *, 
Bufãr
 *);

83 *
bufãr_g‘_¡ršg_»t
(
Bufãr
 *, 
u_št
 *);

84 *
bufãr_g‘_¡ršg_±r_»t
(
Bufãr
 *, 
u_št
 *);

85 
bufãr_g‘_ch¬_»t
(*, 
Bufãr
 *);

	@sftp-server/channels.h

38 #iâdeà
CHANNEL_H


39 
	#CHANNEL_H


	)

42 
	#SSH_CHANNEL_X11_LISTENER
 1

	)

43 
	#SSH_CHANNEL_PORT_LISTENER
 2

	)

44 
	#SSH_CHANNEL_OPENING
 3

	)

45 
	#SSH_CHANNEL_OPEN
 4

	)

46 
	#SSH_CHANNEL_CLOSED
 5

	)

47 
	#SSH_CHANNEL_AUTH_SOCKET
 6

	)

48 
	#SSH_CHANNEL_X11_OPEN
 7

	)

49 
	#SSH_CHANNEL_INPUT_DRAINING
 8

	)

50 
	#SSH_CHANNEL_OUTPUT_DRAINING
 9

	)

51 
	#SSH_CHANNEL_LARVAL
 10

	)

52 
	#SSH_CHANNEL_RPORT_LISTENER
 11

	)

53 
	#SSH_CHANNEL_CONNECTING
 12

	)

54 
	#SSH_CHANNEL_DYNAMIC
 13

	)

55 
	#SSH_CHANNEL_ZOMBIE
 14

	)

56 
	#SSH_CHANNEL_MUX_LISTENER
 15

	)

57 
	#SSH_CHANNEL_MUX_CLIENT
 16

	)

58 
	#SSH_CHANNEL_MAX_TYPE
 17

	)

60 
	gChªÃl
;

61 
ChªÃl
 
	tChªÃl
;

63 
	tchªÃl_ÿÎback_â
(, *);

64 
	tchªÃl_šf‹r_â
(
	tChªÃl
 *, *, );

65 
	tchªÃl_f‹r_ş—nup_â
(, *);

66 
u_ch¬
 *
	tchªÃl_outf‹r_â
(
	tChªÃl
 *, 
	tu_ch¬
 **, 
	tu_št
 *);

69 
	tchªÃl_cÚfœm_cb
(, 
	tChªÃl
 *, *);

70 
	tchªÃl_cÚfœm_abªdÚ_cb
(
	tChªÃl
 *, *);

71 
	schªÃl_cÚfœm
 {

72 
TAILQ_ENTRY
(
chªÃl_cÚfœm
è
	m’Œy
;

73 
chªÃl_cÚfœm_cb
 *
	mcb
;

74 
chªÃl_cÚfœm_abªdÚ_cb
 *
	mabªdÚ_cb
;

75 *
	mùx
;

77 
TAILQ_HEAD
(
chªÃl_cÚfœms
, 
chªÃl_cÚfœm
);

80 
	schªÃl_cÚÃù
 {

81 *
	mho¡
;

82 
	mpÜt
;

83 
addršfo
 *
	mai
, *
	ma™İ
;

87 
	tmux_ÿÎback_â
(
	tChªÃl
 *);

89 
	sChªÃl
 {

90 
	mty³
;

91 
	m£lf
;

92 
	m»mÙe_id
;

93 
u_št
 
	mi¡©e
;

94 
u_št
 
	mo¡©e
;

95 
	mæags
;

96 
	mrfd
;

97 
	mwfd
;

98 
	mefd
;

99 
	msock
;

100 
	mùl_chª
;

101 
	mi§‰y
;

102 
	mwfd_i§‰y
;

103 
	mş›Á_‰y
;

104 
	mfÜû_d¿š
;

105 
	md–ayed
;

110 
Bufãr
 
	mšput
;

112 
Bufãr
 
	mouut
;

114 
Bufãr
 
	mex‹nded
;

115 *
	m·th
;

117 
	mli¡’šg_pÜt
;

118 
	mho¡_pÜt
;

119 *
	m»mÙe_Çme
;

121 
u_št
 
	m»mÙe_wšdow
;

122 
u_št
 
	m»mÙe_max·ck‘
;

123 
u_št
 
	mloÿl_wšdow
;

124 
u_št
 
	mloÿl_wšdow_max
;

125 
u_št
 
	mloÿl_cÚsumed
;

126 
u_št
 
	mloÿl_max·ck‘
;

127 
	mex‹nded_u§ge
;

128 
	msšgË_cÚÃùiÚ
;

130 *
	mùy³
;

133 
chªÃl_ÿÎback_â
 *
	mİ’_cÚfœm
;

134 *
	mİ’_cÚfœm_ùx
;

135 
chªÃl_ÿÎback_â
 *
	md‘ach_u£r
;

136 
	md‘ach_şo£
;

137 
chªÃl_cÚfœms
 
	m¡©us_cÚfœms
;

140 
chªÃl_šf‹r_â
 *
	mšput_f‹r
;

141 
chªÃl_outf‹r_â
 *
	mouut_f‹r
;

142 *
	mf‹r_ùx
;

143 
chªÃl_f‹r_ş—nup_â
 *
	mf‹r_ş—nup
;

146 
	md©ag¿m
;

149 
chªÃl_cÚÃù
 
	mcÚÃù_ùx
;

152 
mux_ÿÎback_â
 *
	mmux_rcb
;

153 *
	mmux_ùx
;

156 
	#CHAN_EXTENDED_IGNORE
 0

	)

157 
	#CHAN_EXTENDED_READ
 1

	)

158 
	#CHAN_EXTENDED_WRITE
 2

	)

161 
	#CHAN_SES_PACKET_DEFAULT
 (32*1024)

	)

162 
	#CHAN_SES_WINDOW_DEFAULT
 (64*
CHAN_SES_PACKET_DEFAULT
)

	)

163 
	#CHAN_TCP_PACKET_DEFAULT
 (32*1024)

	)

164 
	#CHAN_TCP_WINDOW_DEFAULT
 (64*
CHAN_TCP_PACKET_DEFAULT
)

	)

165 
	#CHAN_X11_PACKET_DEFAULT
 (16*1024)

	)

166 
	#CHAN_X11_WINDOW_DEFAULT
 (4*
CHAN_X11_PACKET_DEFAULT
)

	)

169 
	#CHAN_INPUT_OPEN
 0

	)

170 
	#CHAN_INPUT_WAIT_DRAIN
 1

	)

171 
	#CHAN_INPUT_WAIT_OCLOSE
 2

	)

172 
	#CHAN_INPUT_CLOSED
 3

	)

175 
	#CHAN_OUTPUT_OPEN
 0

	)

176 
	#CHAN_OUTPUT_WAIT_DRAIN
 1

	)

177 
	#CHAN_OUTPUT_WAIT_IEOF
 2

	)

178 
	#CHAN_OUTPUT_CLOSED
 3

	)

180 
	#CHAN_CLOSE_SENT
 0x01

	)

181 
	#CHAN_CLOSE_RCVD
 0x02

	)

182 
	#CHAN_EOF_SENT
 0x04

	)

183 
	#CHAN_EOF_RCVD
 0x08

	)

184 
	#CHAN_LOCAL
 0x10

	)

186 
	#CHAN_RBUF
 16*1024

	)

189 
	#CHANNEL_EFD_INPUT_ACTIVE
(
c
) \

190 (
com·t20
 && 
c
->
ex‹nded_u§ge
 =ğ
CHAN_EXTENDED_READ
 && \

191 (
c
->
efd
 != -1 || \

192 
	`bufãr_Ën
(&
c
->
ex‹nded
è> 0))

	)

193 
	#CHANNEL_EFD_OUTPUT_ACTIVE
(
c
) \

194 (
com·t20
 && 
c
->
ex‹nded_u§ge
 =ğ
CHAN_EXTENDED_WRITE
 && \

195 
c
->
efd
 !ğ-1 && (!(c->
æags
 & (
CHAN_EOF_RCVD
|
CHAN_CLOSE_RCVD
)) || \

196 
	`bufãr_Ën
(&
c
->
ex‹nded
è> 0))

	)

200 
ChªÃl
 *
chªÃl_by_id
();

201 
ChªÃl
 *
chªÃl_lookup
();

202 
ChªÃl
 *
chªÃl_Ãw
(*, , , , , 
u_št
, u_int, , *, );

203 
chªÃl_£t_fds
(, , , , , , , 
u_št
);

204 
chªÃl_ä“
(
ChªÃl
 *);

205 
chªÃl_ä“_®l
();

206 
chªÃl_¡İ_li¡’šg
();

208 
chªÃl_£nd_İ’
();

209 
chªÃl_»que¡_¡¬t
(, *, );

210 
chªÃl_»gi¡”_ş—nup
(, 
chªÃl_ÿÎback_â
 *, );

211 
chªÃl_»gi¡”_İ’_cÚfœm
(, 
chªÃl_ÿÎback_â
 *, *);

212 
chªÃl_»gi¡”_f‹r
(, 
chªÃl_šf‹r_â
 *,

213 
chªÃl_outf‹r_â
 *, 
chªÃl_f‹r_ş—nup_â
 *, *);

214 
chªÃl_»gi¡”_¡©us_cÚfœm
(, 
chªÃl_cÚfœm_cb
 *,

215 
chªÃl_cÚfœm_abªdÚ_cb
 *, *);

216 
chªÃl_ÿnûl_ş—nup
();

217 
chªÃl_şo£_fd
(*);

218 
chªÃl_£nd_wšdow_chªges
();

222 
chªÃl_šput_şo£
(, 
u_št32_t
, *);

223 
chªÃl_šput_şo£_cÚfœm©iÚ
(, 
u_št32_t
, *);

224 
chªÃl_šput_d©a
(, 
u_št32_t
, *);

225 
chªÃl_šput_ex‹nded_d©a
(, 
u_št32_t
, *);

226 
chªÃl_šput_›of
(, 
u_št32_t
, *);

227 
chªÃl_šput_oşo£
(, 
u_št32_t
, *);

228 
chªÃl_šput_İ’_cÚfœm©iÚ
(, 
u_št32_t
, *);

229 
chªÃl_šput_İ’_çu»
(, 
u_št32_t
, *);

230 
chªÃl_šput_pÜt_İ’
(, 
u_št32_t
, *);

231 
chªÃl_šput_wšdow_adju¡
(, 
u_št32_t
, *);

232 
chªÃl_šput_¡©us_cÚfœm
(, 
u_št32_t
, *);

236 
chªÃl_´•¬e_£Ëù
(
fd_£t
 **, fd_£ˆ**, *, 
u_št
*, );

237 
chªÃl_aá”_£Ëù
(
fd_£t
 *, fd_set *);

238 
chªÃl_ouut_pŞl
();

240 
chªÃl_nÙ_v”y_much_bufã»d_d©a
();

241 
chªÃl_şo£_®l
();

242 
chªÃl_¡l_İ’
();

243 *
chªÃl_İ’_mes§ge
();

244 
chªÃl_fšd_İ’
();

247 
chªÃl_£t_af
(
af
);

248 
chªÃl_³rm™_®l_İ’s
();

249 
chªÃl_add_³rm™‹d_İ’s
(*, );

250 
chªÃl_add_adm_³rm™‹d_İ’s
(*, );

251 
chªÃl_ş—r_³rm™‹d_İ’s
();

252 
chªÃl_ş—r_adm_³rm™‹d_İ’s
();

253 
chªÃl_´št_adm_³rm™‹d_İ’s
();

254 
chªÃl_šput_pÜt_fÜw¬d_»que¡
(, );

255 
ChªÃl
 *
chªÃl_cÚÃù_to
(cÚ¡ *, 
u_shÜt
, *, *);

256 
ChªÃl
 *
chªÃl_cÚÃù_¡dio_fwd
(cÚ¡ *, 
u_shÜt
, , );

257 
ChªÃl
 *
chªÃl_cÚÃù_by_li¡’_add»ss
(
u_shÜt
, *, *);

258 
chªÃl_»que¡_»mÙe_fÜw¬dšg
(cÚ¡ *, 
u_shÜt
,

259 cÚ¡ *, 
u_shÜt
);

260 
chªÃl_£tup_loÿl_fwd_li¡’”
(cÚ¡ *, 
u_shÜt
,

261 cÚ¡ *, 
u_shÜt
, );

262 
chªÃl_»que¡_rfÜw¬d_ÿnûl
(cÚ¡ *
ho¡
, 
u_shÜt
 
pÜt
);

263 
chªÃl_£tup_»mÙe_fwd_li¡’”
(cÚ¡ *, 
u_shÜt
, *, );

264 
chªÃl_ÿnûl_½Üt_li¡’”
(cÚ¡ *, 
u_shÜt
);

268 
x11_cÚÃù_di¥Ïy
();

269 
x11_ü—‹_di¥Ïy_š‘
(, , , 
u_št
 *, **);

270 
x11_šput_İ’
(, 
u_št32_t
, *);

271 
x11_»que¡_fÜw¬dšg_w™h_¥oofšg
(, const *, const *,

273 
d’y_šput_İ’
(, 
u_št32_t
, *);

277 
auth_»que¡_fÜw¬dšg
();

281 
chª_is_d—d
(
ChªÃl
 *, );

282 
chª_m¬k_d—d
(
ChªÃl
 *);

286 
chª_rcvd_oşo£
(
ChªÃl
 *);

287 
chª_rcvd_eow
(
ChªÃl
 *);

288 
chª_»ad_çed
(
ChªÃl
 *);

289 
chª_ibuf_em±y
(
ChªÃl
 *);

291 
chª_rcvd_›of
(
ChªÃl
 *);

292 
chª_wr™e_çed
(
ChªÃl
 *);

293 
chª_obuf_em±y
(
ChªÃl
 *);

	@sftp-server/compat.c

26 
	~"šşudes.h
"

28 
	~<sys/ty³s.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<¡d¬g.h
>

34 
	~"xm®loc.h
"

35 
	~"bufãr.h
"

36 
	~"·ck‘.h
"

37 
	~"com·t.h
"

38 
	~"log.h
"

39 
	~"m©ch.h
"

41 
	gcom·t13
 = 0;

42 
	gcom·t20
 = 0;

43 
	gd©aãÎows
 = 0;

46 
	$’abË_com·t20
()

48 
	`debug
("Enabling compatibility mode for…rotocol 2.0");

49 
com·t20
 = 1;

50 
	}
}

52 
	$’abË_com·t13
()

54 
	`debug
("Enabling compatibility mode for…rotocol 1.3");

55 
com·t13
 = 1;

56 
	}
}

59 
	$com·t_d©aãÎows
(cÚ¡ *
v”siÚ
)

61 
i
;

63 *
·t
;

64 
bugs
;

65 } 
check
[] = {

69 "O³nSSH_2.2*", 
SSH_OLD_SESSIONID
|
SSH_BUG_BANNER
|

70 
SSH_OLD_DHGEX
|
SSH_BUG_NOREKEY
|

71 
SSH_BUG_EXTEOF
|
SSH_OLD_FORWARD_ADDR
},

72 { "O³nSSH_2.3.0*", 
SSH_BUG_BANNER
|
SSH_BUG_BIGENDIANAES
|

73 
SSH_OLD_DHGEX
|
SSH_BUG_NOREKEY
|

74 
SSH_BUG_EXTEOF
|
SSH_OLD_FORWARD_ADDR
},

75 { "O³nSSH_2.3.*", 
SSH_BUG_BIGENDIANAES
|
SSH_OLD_DHGEX
|

76 
SSH_BUG_NOREKEY
|
SSH_BUG_EXTEOF
|

77 
SSH_OLD_FORWARD_ADDR
},

80 
SSH_BUG_BIGENDIANAES
|
SSH_OLD_DHGEX
|

81 
SSH_BUG_NOREKEY
|
SSH_BUG_EXTEOF
|

82 
SSH_OLD_FORWARD_ADDR
},

85 "O³nSSH_2.5.2*", 
SSH_OLD_DHGEX
|
SSH_BUG_NOREKEY
|

86 
SSH_BUG_EXTEOF
|
SSH_OLD_FORWARD_ADDR
},

87 { "O³nSSH_2.5.3*", 
SSH_BUG_NOREKEY
|
SSH_BUG_EXTEOF
|

88 
SSH_OLD_FORWARD_ADDR
},

91 "O³nSSH_3.1*", 
SSH_BUG_EXTEOF
|
SSH_OLD_FORWARD_ADDR
},

92 { "O³nSSH_3.*", 
SSH_OLD_FORWARD_ADDR
 },

93 { "Sun_SSH_1.0*", 
SSH_BUG_NOREKEY
|
SSH_BUG_EXTEOF
},

95 { "O³nSSH*", 
SSH_NEW_OPENSSH
 },

97 { "2.1.0*", 
SSH_BUG_SIGBLOB
|
SSH_BUG_HMAC
|

98 
SSH_OLD_SESSIONID
|
SSH_BUG_DEBUG
|

99 
SSH_BUG_RSASIGMD5
|
SSH_BUG_HBSERVICE
|

100 
SSH_BUG_FIRSTKEX
 },

101 { "2.1 *", 
SSH_BUG_SIGBLOB
|
SSH_BUG_HMAC
|

102 
SSH_OLD_SESSIONID
|
SSH_BUG_DEBUG
|

103 
SSH_BUG_RSASIGMD5
|
SSH_BUG_HBSERVICE
|

104 
SSH_BUG_FIRSTKEX
 },

111 "2.0.19*", 
SSH_BUG_SIGBLOB
|
SSH_BUG_HMAC
|

112 
SSH_OLD_SESSIONID
|
SSH_BUG_DEBUG
|

113 
SSH_BUG_PKSERVICE
|
SSH_BUG_X11FWD
|

114 
SSH_BUG_PKOK
|
SSH_BUG_RSASIGMD5
|

115 
SSH_BUG_HBSERVICE
|
SSH_BUG_OPENFAILURE
|

116 
SSH_BUG_DUMMYCHAN
|
SSH_BUG_FIRSTKEX
 },

118 "2.0.12*", 
SSH_BUG_SIGBLOB
|
SSH_BUG_HMAC
|

119 
SSH_OLD_SESSIONID
|
SSH_BUG_DEBUG
|

120 
SSH_BUG_PKSERVICE
|
SSH_BUG_X11FWD
|

121 
SSH_BUG_PKAUTH
|
SSH_BUG_PKOK
|

122 
SSH_BUG_RSASIGMD5
|
SSH_BUG_OPENFAILURE
|

123 
SSH_BUG_DUMMYCHAN
|
SSH_BUG_FIRSTKEX
 },

124 { "2.0.*", 
SSH_BUG_SIGBLOB
|
SSH_BUG_HMAC
|

125 
SSH_OLD_SESSIONID
|
SSH_BUG_DEBUG
|

126 
SSH_BUG_PKSERVICE
|
SSH_BUG_X11FWD
|

127 
SSH_BUG_PKAUTH
|
SSH_BUG_PKOK
|

128 
SSH_BUG_RSASIGMD5
|
SSH_BUG_OPENFAILURE
|

129 
SSH_BUG_DERIVEKEY
|
SSH_BUG_DUMMYCHAN
|

130 
SSH_BUG_FIRSTKEX
 },

132 "2.3.0*", 
SSH_BUG_HMAC
|
SSH_BUG_DEBUG
|

133 
SSH_BUG_RSASIGMD5
|
SSH_BUG_FIRSTKEX
 },

134 { "2.3.*", 
SSH_BUG_DEBUG
|
SSH_BUG_RSASIGMD5
|

135 
SSH_BUG_FIRSTKEX
 },

136 { "2.4", 
SSH_OLD_SESSIONID
 },

137 { "2.*", 
SSH_BUG_DEBUG
|
SSH_BUG_FIRSTKEX
|

138 
SSH_BUG_RFWD_ADDR
 },

139 { "3.0.*", 
SSH_BUG_DEBUG
 },

140 { "3.0 Secu»CRT*", 
SSH_OLD_SESSIONID
 },

141 { "1.7 Secu»FX*", 
SSH_OLD_SESSIONID
 },

146 "1.2.22*", 
SSH_BUG_IGNOREMSG
 },

148 
SSH_BUG_IGNOREMSG
 },

150 
SSH_BUG_PASSWORDPAD
 },

159 "OSU_1.5®pha3*", 
SSH_BUG_PASSWORDPAD
 },

161 
SSH_BUG_SCANNER
 },

163 
SSH_BUG_PROBE
 },

164 { 
NULL
, 0 }

168 
i
 = 0; 
check
[i].
·t
; i++) {

169 ià(
	`m©ch_·‰”n_li¡
(
v”siÚ
, 
check
[
i
].
·t
,

170 
	`¡¾’
(
check
[
i
].
·t
), 0) == 1) {

171 
	`debug
("m©ch: % ·ˆ%s", 
v”siÚ
, 
check
[
i
].
·t
);

172 
d©aãÎows
 = 
check
[
i
].
bugs
;

176 
	`debug
("nØm©ch: %s", 
v”siÚ
);

177 
	}
}

179 
	#SEP
 ","

	)

181 
	$´Ùo_¥ec
(cÚ¡ *
¥ec
)

183 *
s
, *
p
, *
q
;

184 
»t
 = 
SSH_PROTO_UNKNOWN
;

186 ià(
¥ec
 =ğ
NULL
)

187  
»t
;

188 
q
 = 
s
 = 
	`x¡rdup
(
¥ec
);

189 (
p
 = 
	`¡r£p
(&
q
, 
SEP
));… && *p != '\0'; (p = strsep(&q, SEP))) {

190 
	`©oi
(
p
)) {

192 ià(
»t
 =ğ
SSH_PROTO_UNKNOWN
)

193 
»t
 |ğ
SSH_PROTO_1_PREFERRED
;

194 
»t
 |ğ
SSH_PROTO_1
;

197 
»t
 |ğ
SSH_PROTO_2
;

200 
	`log™
("ignÜšg bad…rÙØ¥ec: '%s'.", 
p
);

204 
	`xä“
(
s
);

205  
»t
;

206 
	}
}

209 
	$com·t_ch”_´İo§l
(*
ch”_´İ
)

211 
Bufãr
 
b
;

212 *
Üig_´İ
, *
fix_ch”s
;

213 *
ı
, *
tmp
;

215 ià(!(
d©aãÎows
 & 
SSH_BUG_BIGENDIANAES
))

216 (
ch”_´İ
);

218 
	`bufãr_š™
(&
b
);

219 
tmp
 = 
Üig_´İ
 = 
	`x¡rdup
(
ch”_´İ
);

220 (
ı
 = 
	`¡r£p
(&
tmp
, ",")è!ğ
NULL
) {

221 ià(
	`¡ºcmp
(
ı
, "aes", 3) != 0) {

222 ià(
	`bufãr_Ën
(&
b
) > 0)

223 
	`bufãr_­³nd
(&
b
, ",", 1);

224 
	`bufãr_­³nd
(&
b
, 
ı
, 
	`¡¾’
(cp));

227 
	`bufãr_­³nd
(&
b
, "\0", 1);

228 
fix_ch”s
 = 
	`x¡rdup
(
	`bufãr_±r
(&
b
));

229 
	`bufãr_ä“
(&
b
);

230 
	`xä“
(
Üig_´İ
);

231 
	`debug2
("Origš® ch”…rİo§l: %s", 
ch”_´İ
);

232 
	`debug2
("Com·ˆch”…rİo§l: %s", 
fix_ch”s
);

233 ià(!*
fix_ch”s
)

234 
	`çl
("No‡vailable ciphers found.");

236 (
fix_ch”s
);

237 
	}
}

	@sftp-server/compat.h

27 #iâdeà
COMPAT_H


28 
	#COMPAT_H


	)

30 
	#SSH_PROTO_UNKNOWN
 0x00

	)

31 
	#SSH_PROTO_1
 0x01

	)

32 
	#SSH_PROTO_1_PREFERRED
 0x02

	)

33 
	#SSH_PROTO_2
 0x04

	)

35 
	#SSH_BUG_SIGBLOB
 0x00000001

	)

36 
	#SSH_BUG_PKSERVICE
 0x00000002

	)

37 
	#SSH_BUG_HMAC
 0x00000004

	)

38 
	#SSH_BUG_X11FWD
 0x00000008

	)

39 
	#SSH_OLD_SESSIONID
 0x00000010

	)

40 
	#SSH_BUG_PKAUTH
 0x00000020

	)

41 
	#SSH_BUG_DEBUG
 0x00000040

	)

42 
	#SSH_BUG_BANNER
 0x00000080

	)

43 
	#SSH_BUG_IGNOREMSG
 0x00000100

	)

44 
	#SSH_BUG_PKOK
 0x00000200

	)

45 
	#SSH_BUG_PASSWORDPAD
 0x00000400

	)

46 
	#SSH_BUG_SCANNER
 0x00000800

	)

47 
	#SSH_BUG_BIGENDIANAES
 0x00001000

	)

48 
	#SSH_BUG_RSASIGMD5
 0x00002000

	)

49 
	#SSH_OLD_DHGEX
 0x00004000

	)

50 
	#SSH_BUG_NOREKEY
 0x00008000

	)

51 
	#SSH_BUG_HBSERVICE
 0x00010000

	)

52 
	#SSH_BUG_OPENFAILURE
 0x00020000

	)

53 
	#SSH_BUG_DERIVEKEY
 0x00040000

	)

54 
	#SSH_BUG_DUMMYCHAN
 0x00100000

	)

55 
	#SSH_BUG_EXTEOF
 0x00200000

	)

56 
	#SSH_BUG_PROBE
 0x00400000

	)

57 
	#SSH_BUG_FIRSTKEX
 0x00800000

	)

58 
	#SSH_OLD_FORWARD_ADDR
 0x01000000

	)

59 
	#SSH_BUG_RFWD_ADDR
 0x02000000

	)

60 
	#SSH_NEW_OPENSSH
 0x04000000

	)

62 
’abË_com·t13
();

63 
’abË_com·t20
();

64 
com·t_d©aãÎows
(const *);

65 
´Ùo_¥ec
(const *);

66 *
com·t_ch”_´İo§l
(*);

68 
com·t13
;

69 
com·t20
;

70 
d©aãÎows
;

	@sftp-server/config.h

121 
	#DISABLE_WTMPX
 1

	)

124 
	#ENABLE_PKCS11


	)

127 
	#ENTROPY_TIMEOUT_MSEC
 200

	)

136 
	#GETPGRP_VOID
 1

	)

142 
	#GLOB_HAS_ALTDIRFUNC
 1

	)

151 
	#HAS_SHADOW_EXPIRE
 1

	)

157 
	#HAVE_ADDR_IN_UTMP
 1

	)

160 
	#HAVE_ADDR_IN_UTMPX
 1

	)

163 
	#HAVE_ADDR_V6_IN_UTMP
 1

	)

166 
	#HAVE_ADDR_V6_IN_UTMPX
 1

	)

178 
	#HAVE_ASPRINTF
 1

	)

184 
	#HAVE_ATTRIBUTE__NONNULL__
 1

	)

199 
	#HAVE_BASENAME
 1

	)

202 
	#HAVE_BCOPY
 1

	)

214 
	#HAVE_CLOCK
 1

	)

217 
	#HAVE_CLOCK_T
 1

	)

223 
	#HAVE_CONST_GAI_STRERROR_PROTO
 1

	)

226 
	#HAVE_CONTROL_IN_MSGHDR
 1

	)

238 
	#HAVE_DAEMON
 1

	)

246 
	#HAVE_DECL_GLOB_NOMATCH
 1

	)

250 
	#HAVE_DECL_H_ERRNO
 1

	)

266 
	#HAVE_DECL_MAXSYMLINKS
 1

	)

270 
	#HAVE_DECL_OFFSETOF
 1

	)

274 
	#HAVE_DECL_O_NONBLOCK
 1

	)

286 
	#HAVE_DECL_SHUT_RD
 1

	)

290 
	#HAVE_DECL_WRITEV
 1

	)

294 
	#HAVE_DECL__GETLONG
 0

	)

298 
	#HAVE_DECL__GETSHORT
 0

	)

307 
	#HAVE_DIRENT_H
 1

	)

310 
	#HAVE_DIRFD
 1

	)

313 
	#HAVE_DIRNAME
 1

	)

319 
	#HAVE_ENDUTENT
 1

	)

322 
	#HAVE_ENDUTXENT
 1

	)

328 
	#HAVE_EVP_SHA256
 1

	)

331 
	#HAVE_EXIT_IN_UTMP
 1

	)

334 
	#HAVE_FCHMOD
 1

	)

337 
	#HAVE_FCHOWN
 1

	)

343 
	#HAVE_FCNTL_H
 1

	)

346 
	#HAVE_FEATURES_H
 1

	)

355 
	#HAVE_FREEADDRINFO
 1

	)

358 
	#HAVE_FSBLKCNT_T
 1

	)

361 
	#HAVE_FSFILCNT_T
 1

	)

370 
	#HAVE_GAI_STRERROR
 1

	)

373 
	#HAVE_GETADDRINFO
 1

	)

382 
	#HAVE_GETCWD
 1

	)

397 
	#HAVE_GETNAMEINFO
 1

	)

400 
	#HAVE_GETOPT
 1

	)

403 
	#HAVE_GETOPT_H
 1

	)

409 
	#HAVE_GETPAGESIZE
 1

	)

421 
	#HAVE_GETRLIMIT
 1

	)

433 
	#HAVE_GETTIMEOFDAY
 1

	)

439 
	#HAVE_GETUTENT
 1

	)

442 
	#HAVE_GETUTID
 1

	)

445 
	#HAVE_GETUTLINE
 1

	)

448 
	#HAVE_GETUTXENT
 1

	)

451 
	#HAVE_GETUTXID
 1

	)

454 
	#HAVE_GETUTXLINE
 1

	)

463 
	#HAVE_GLOB
 1

	)

466 
	#HAVE_GLOB_H
 1

	)

490 
	#HAVE_HEADER_AD
 1

	)

493 
	#HAVE_HOST_IN_UTMP
 1

	)

496 
	#HAVE_HOST_IN_UTMPX
 1

	)

505 
	#HAVE_ID_IN_UTMP
 1

	)

508 
	#HAVE_ID_IN_UTMPX
 1

	)

511 
	#HAVE_INET_ATON
 1

	)

514 
	#HAVE_INET_NTOA
 1

	)

517 
	#HAVE_INET_NTOP
 1

	)

520 
	#HAVE_INNETGR
 1

	)

523 
	#HAVE_INT64_T
 1

	)

526 
	#HAVE_INTTYPES_H
 1

	)

529 
	#HAVE_INTXX_T
 1

	)

532 
	#HAVE_IN_ADDR_T
 1

	)

538 
	#HAVE_LASTLOG_H
 1

	)

550 
	#HAVE_LIBGEN_H
 1

	)

559 
	#HAVE_LIBNSL
 1

	)

577 
	#HAVE_LIMITS_H
 1

	)

580 
	#HAVE_LINUX_IF_TUN_H
 1

	)

583 
	#HAVE_LOGIN
 1

	)

595 
	#HAVE_LOGOUT
 1

	)

598 
	#HAVE_LOGWTMP
 1

	)

601 
	#HAVE_LONG_DOUBLE
 1

	)

604 
	#HAVE_LONG_LONG
 1

	)

616 
	#HAVE_MEMMOVE
 1

	)

619 
	#HAVE_MEMORY_H
 1

	)

622 
	#HAVE_MKDTEMP
 1

	)

625 
	#HAVE_MMAP
 1

	)

628 
	#HAVE_MODE_T
 1

	)

631 
	#HAVE_NANOSLEEP
 1

	)

637 
	#HAVE_NETDB_H
 1

	)

665 
	#HAVE_OPENPTY
 1

	)

683 
	#HAVE_PATHS_H
 1

	)

686 
	#HAVE_PID_IN_UTMP
 1

	)

689 
	#HAVE_PID_T
 1

	)

692 
	#HAVE_POLL
 1

	)

695 
	#HAVE_POLL_H
 1

	)

698 
	#HAVE_PRCTL
 1

	)

701 
	#HAVE_PROC_PID
 1

	)

707 
	#HAVE_PTY_H
 1

	)

710 
	#HAVE_PUTUTLINE
 1

	)

713 
	#HAVE_PUTUTXLINE
 1

	)

731 
	#HAVE_REALPATH
 1

	)

734 
	#HAVE_RECVMSG
 1

	)

740 
	#HAVE_RRESVPORT_AF
 1

	)

743 
	#HAVE_SA_FAMILY_T
 1

	)

752 
	#HAVE_SENDMSG
 1

	)

761 
	#HAVE_SETEGID
 1

	)

764 
	#HAVE_SETENV
 1

	)

767 
	#HAVE_SETEUID
 1

	)

773 
	#HAVE_SETGROUPS
 1

	)

791 
	#HAVE_SETREGID
 1

	)

794 
	#HAVE_SETRESGID
 1

	)

797 
	#HAVE_SETRESUID
 1

	)

800 
	#HAVE_SETREUID
 1

	)

803 
	#HAVE_SETRLIMIT
 1

	)

806 
	#HAVE_SETSID
 1

	)

809 
	#HAVE_SETUTENT
 1

	)

815 
	#HAVE_SETUTXENT
 1

	)

818 
	#HAVE_SETVBUF
 1

	)

824 
	#HAVE_SHA256_UPDATE
 1

	)

830 
	#HAVE_SHADOW_H
 1

	)

833 
	#HAVE_SIGACTION
 1

	)

836 
	#HAVE_SIGVEC
 1

	)

839 
	#HAVE_SIG_ATOMIC_T
 1

	)

842 
	#HAVE_SIZE_T
 1

	)

845 
	#HAVE_SNPRINTF
 1

	)

848 
	#HAVE_SOCKETPAIR
 1

	)

851 
	#HAVE_SO_PEERCRED
 1

	)

854 
	#HAVE_SSIZE_T
 1

	)

857 
	#HAVE_SS_FAMILY_IN_SS
 1

	)

860 
	#HAVE_STATFS
 1

	)

866 
	#HAVE_STDDEF_H
 1

	)

869 
	#HAVE_STDINT_H
 1

	)

872 
	#HAVE_STDLIB_H
 1

	)

875 
	#HAVE_STRDUP
 1

	)

878 
	#HAVE_STRERROR
 1

	)

881 
	#HAVE_STRFTIME
 1

	)

884 
	#HAVE_STRICT_MKSTEMP
 1

	)

887 
	#HAVE_STRINGS_H
 1

	)

890 
	#HAVE_STRING_H
 1

	)

905 
	#HAVE_STRSEP
 1

	)

908 
	#HAVE_STRTOLL
 1

	)

914 
	#HAVE_STRTOUL
 1

	)

917 
	#HAVE_STRUCT_ADDRINFO
 1

	)

920 
	#HAVE_STRUCT_IN6_ADDR
 1

	)

923 
	#HAVE_STRUCT_SOCKADDR_IN6
 1

	)

926 
	#HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID
 1

	)

929 
	#HAVE_STRUCT_SOCKADDR_STORAGE
 1

	)

932 
	#HAVE_STRUCT_STAT_ST_BLKSIZE
 1

	)

935 
	#HAVE_STRUCT_TIMESPEC
 1

	)

938 
	#HAVE_STRUCT_TIMEVAL
 1

	)

944 
	#HAVE_SYSCONF
 1

	)

959 
	#HAVE_SYS_CDEFS_H
 1

	)

962 
	#HAVE_SYS_DIR_H
 1

	)

965 
	#HAVE_SYS_ERRLIST
 1

	)

968 
	#HAVE_SYS_MMAN_H
 1

	)

971 
	#HAVE_SYS_MOUNT_H
 1

	)

977 
	#HAVE_SYS_NERR
 1

	)

980 
	#HAVE_SYS_POLL_H
 1

	)

983 
	#HAVE_SYS_PRCTL_H
 1

	)

992 
	#HAVE_SYS_SELECT_H
 1

	)

998 
	#HAVE_SYS_STAT_H
 1

	)

1004 
	#HAVE_SYS_STROPTS_H
 1

	)

1013 
	#HAVE_SYS_SYSMACROS_H
 1

	)

1019 
	#HAVE_SYS_TIME_H
 1

	)

1022 
	#HAVE_SYS_TYPES_H
 1

	)

1025 
	#HAVE_SYS_UN_H
 1

	)

1028 
	#HAVE_TCGETPGRP
 1

	)

1031 
	#HAVE_TCSENDBREAK
 1

	)

1034 
	#HAVE_TIME
 1

	)

1037 
	#HAVE_TIME_H
 1

	)

1070 
	#HAVE_UINTXX_T
 1

	)

1073 
	#HAVE_UNISTD_H
 1

	)

1076 
	#HAVE_UNSETENV
 1

	)

1079 
	#HAVE_UNSIGNED_LONG_LONG
 1

	)

1082 
	#HAVE_UPDWTMP
 1

	)

1085 
	#HAVE_UPDWTMPX
 1

	)

1097 
	#HAVE_UTIMES
 1

	)

1100 
	#HAVE_UTIME_H
 1

	)

1115 
	#HAVE_U_CHAR
 1

	)

1118 
	#HAVE_U_INT
 1

	)

1121 
	#HAVE_U_INT64_T
 1

	)

1124 
	#HAVE_U_INTXX_T
 1

	)

1127 
	#HAVE_VASPRINTF
 1

	)

1130 
	#HAVE_VA_COPY
 1

	)

1133 
	#HAVE_VHANGUP
 1

	)

1139 
	#HAVE_VSNPRINTF
 1

	)

1142 
	#HAVE_WAITPID
 1

	)

1145 
	#HAVE__GETLONG
 1

	)

1151 
	#HAVE__GETSHORT
 1

	)

1154 
	#HAVE__RES_EXTERN
 1

	)

1163 
	#HAVE___FUNCTION__
 1

	)

1166 
	#HAVE___PROGNAME
 1

	)

1172 
	#HAVE___VA_COPY
 1

	)

1175 
	#HAVE___func__
 1

	)

1184 
	#IPV4_IN_IPV6
 1

	)

1200 
	#LINK_OPNOTSUPP_ERRNO
 
EPERM


	)

1203 
	#LINUX_OOM_ADJUST
 1

	)

1212 
	#LOCKED_PASSWD_PREFIX
 "!"

	)

1231 
	#LOGIN_PROGRAM_FALLBACK
 "/bš/logš"

	)

1237 
	#MISSING_FD_MASK
 1

	)

1240 
	#MISSING_HOWMANY
 1

	)

1267 
	#PACKAGE_BUGREPORT
 "İ’ssh-unix-dev@mšdrÙ.Üg"

	)

1270 
	#PACKAGE_NAME
 "O³nSSH"

	)

1273 
	#PACKAGE_STRING
 "O³nSSH PÜbË"

	)

1276 
	#PACKAGE_TARNAME
 "İ’ssh"

	)

1279 
	#PACKAGE_VERSION
 "PÜbË"

	)

1286 
	#PAM_TTY_KLUDGE
 1

	)

1304 
	#SIZEOF_CHAR
 1

	)

1307 
	#SIZEOF_INT
 4

	)

1310 
	#SIZEOF_LONG_INT
 4

	)

1313 
	#SIZEOF_LONG_LONG_INT
 8

	)

1316 
	#SIZEOF_SHORT_INT
 2

	)

1325 
	#SNPRINTF_CONST
 cÚ¡

	)

1329 
	#SPT_TYPE
 
SPT_REUSEARGV


	)

1344 
	#SSH_PRIVSEP_USER
 "sshd"

	)

1347 
	#SSH_TUN_COMPAT_AF
 1

	)

1353 
	#SSH_TUN_LINUX
 1

	)

1362 
	#SSH_TUN_PREPEND_AF
 1

	)

1365 
	#STDC_HEADERS
 1

	)

1377 
	#USER_PATH
 "/u¤/bš:/bš:/u¤/sbš:/sbš:/u¤/loÿl/bš"

	)

1386 
	#USE_BTMP
 1

	)

1430 
	#XAUTH_PATH
 "/u¤/bš/xauth"

	)

1433 
	#_FILE_OFFSET_BITS
 64

	)

1439 
	#_PATH_BTMP
 "/v¬/log/btmp"

	)

1442 
	#_PATH_PASSWD_PROG
 "/u¤/bš/·sswd"

	)

1445 
	#_PATH_SSH_PIDDIR
 "/v¬/run"

	)

1452 #iâdeà
__ılu¥lus


	@sftp-server/defines.h

25 #iâdeà
_DEFINES_H


26 
	#_DEFINES_H


	)

33 #ià
defšed
(
HAVE_DECL_SHUT_RD
) && HAVE_DECL_SHUT_RD == 0

36 
	mSHUT_RD
 = 0,

37 
	mSHUT_WR
,

38 
	mSHUT_RDWR


40 
	#SHUT_RD
 
SHUT_RD


	)

41 
	#SHUT_WR
 
SHUT_WR


	)

42 
	#SHUT_RDWR
 
SHUT_RDWR


	)

45 #iâdeà
IPTOS_LOWDELAY


46 
	#IPTOS_LOWDELAY
 0x10

	)

47 
	#IPTOS_THROUGHPUT
 0x08

	)

48 
	#IPTOS_RELIABILITY
 0x04

	)

49 
	#IPTOS_LOWCOST
 0x02

	)

50 
	#IPTOS_MINCOST
 
IPTOS_LOWCOST


	)

53 #iâdeà
MAXPATHLEN


54 #ifdeà
PATH_MAX


55 
	#MAXPATHLEN
 
PATH_MAX


	)

57 
	#MAXPATHLEN
 64

	)

59 #iâdeà
BROKEN_REALPATH


60 
	#BROKEN_REALPATH
 1

	)

65 #iâdeà
PATH_MAX


66 #ifdeà
_POSIX_PATH_MAX


67 
	#PATH_MAX
 
_POSIX_PATH_MAX


	)

71 #ià
defšed
(
HAVE_DECL_MAXSYMLINKS
) && HAVE_DECL_MAXSYMLINKS == 0

72 
	#MAXSYMLINKS
 5

	)

75 #iâdeà
STDIN_FILENO


76 
	#STDIN_FILENO
 0

	)

78 #iâdeà
STDOUT_FILENO


79 
	#STDOUT_FILENO
 1

	)

81 #iâdeà
STDERR_FILENO


82 
	#STDERR_FILENO
 2

	)

85 #iâdeà
NGROUPS_MAX


86 #ifdeà
NGROUPS


87 
	#NGROUPS_MAX
 
NGROUPS


	)

89 
	#NGROUPS_MAX
 0

	)

93 #ià
defšed
(
HAVE_DECL_O_NONBLOCK
) && HAVE_DECL_O_NONBLOCK == 0

94 
	#O_NONBLOCK
 00004

	)

97 #iâdeà
S_ISDIR


98 
	#S_ISDIR
(
mode
è(((modeè& (
_S_IFMT
)è=ğ(
_S_IFDIR
))

	)

101 #iâdeà
S_ISREG


102 
	#S_ISREG
(
mode
è(((modeè& (
_S_IFMT
)è=ğ(
_S_IFREG
))

	)

105 #iâdeà
S_ISLNK


106 
	#S_ISLNK
(
mode
è(((modeè& 
S_IFMT
è=ğ
S_IFLNK
)

	)

109 #iâdeà
S_IXUSR


110 
	#S_IXUSR
 0000100

	)

111 
	#S_IXGRP
 0000010

	)

112 
	#S_IXOTH
 0000001

	)

113 
	#_S_IWUSR
 0000200

	)

114 
	#S_IWUSR
 
_S_IWUSR


	)

115 
	#S_IWGRP
 0000020

	)

116 
	#S_IWOTH
 0000002

	)

117 
	#S_IRUSR
 0000400

	)

118 
	#S_IRGRP
 0000040

	)

119 
	#S_IROTH
 0000004

	)

120 
	#S_IRWXU
 0000700

	)

121 
	#S_IRWXG
 0000070

	)

122 
	#S_IRWXO
 0000007

	)

125 #ià!
defšed
(
MAP_ANON
è&& defšed(
MAP_ANONYMOUS
)

126 
	#MAP_ANON
 
MAP_ANONYMOUS


	)

129 #iâdeà
MAP_FAILED


130 
	#MAP_FAILED
 ((*)-1)

	)

134 #ifdeà
MISSING_NFDBITS


135 
	#NFDBITS
 (8 * ())

	)

142 #iâdeà
INADDR_LOOPBACK


143 
	#INADDR_LOOPBACK
 ((
u_lÚg
)0x7f000001)

	)

151 #iâdeà
HAVE_U_INT


152 
	tu_št
;

155 #iâdeà
HAVE_INTXX_T


156 #ià(
SIZEOF_CHAR
 == 1)

157 
	tšt8_t
;

161 #ià(
SIZEOF_SHORT_INT
 == 2)

162 
	tšt16_t
;

164 #ifdeà
_UNICOS


165 #ià(
SIZEOF_SHORT_INT
 == 4)

166 
	tšt16_t
;

168 
	tšt16_t
;

174 #ià(
SIZEOF_INT
 == 4)

175 
	tšt32_t
;

177 #ifdeà
_UNICOS


178 
	tšt32_t
;

186 #iâdeà
HAVE_U_INTXX_T


187 #ifdeà
HAVE_UINTXX_T


188 
ušt8_t
 
	tu_št8_t
;

189 
ušt16_t
 
	tu_št16_t
;

190 
ušt32_t
 
	tu_št32_t
;

191 
	#HAVE_U_INTXX_T
 1

	)

193 #ià(
SIZEOF_CHAR
 == 1)

194 
	tu_št8_t
;

198 #ià(
SIZEOF_SHORT_INT
 == 2)

199 
	tu_št16_t
;

201 #ifdeà
_UNICOS


202 #ià(
SIZEOF_SHORT_INT
 == 4)

203 
	tu_št16_t
;

205 
	tu_št16_t
;

211 #ià(
SIZEOF_INT
 == 4)

212 
	tu_št32_t
;

214 #ifdeà
_UNICOS


215 
	tu_št32_t
;

221 
	#__BIT_TYPES_DEFINED__


	)

225 #iâdeà
HAVE_INT64_T


226 #ià(
SIZEOF_LONG_INT
 == 8)

227 
	tšt64_t
;

229 #ià(
SIZEOF_LONG_LONG_INT
 == 8)

230 
	tšt64_t
;

234 #iâdeà
HAVE_U_INT64_T


235 #ià(
SIZEOF_LONG_INT
 == 8)

236 
	tu_št64_t
;

238 #ià(
SIZEOF_LONG_LONG_INT
 == 8)

239 
	tu_št64_t
;

244 #iâdeà
HAVE_U_CHAR


245 
	tu_ch¬
;

246 
	#HAVE_U_CHAR


	)

249 #iâdeà
SIZE_T_MAX


250 
	#SIZE_T_MAX
 
ULONG_MAX


	)

253 #iâdeà
HAVE_SIZE_T


254 
	tsize_t
;

255 
	#HAVE_SIZE_T


	)

256 
	#SIZE_T_MAX
 
UINT_MAX


	)

259 #iâdeà
HAVE_SSIZE_T


260 
	tssize_t
;

261 
	#HAVE_SSIZE_T


	)

264 #iâdeà
HAVE_CLOCK_T


265 
	tşock_t
;

266 
	#HAVE_CLOCK_T


	)

269 #iâdeà
HAVE_SA_FAMILY_T


270 
	t§_çmy_t
;

271 
	#HAVE_SA_FAMILY_T


	)

274 #iâdeà
HAVE_PID_T


275 
	tpid_t
;

276 
	#HAVE_PID_T


	)

279 #iâdeà
HAVE_SIG_ATOMIC_T


280 
	tsig_©omic_t
;

281 
	#HAVE_SIG_ATOMIC_T


	)

284 #iâdeà
HAVE_MODE_T


285 
	tmode_t
;

286 
	#HAVE_MODE_T


	)

289 #ià!
defšed
(
HAVE_SS_FAMILY_IN_SS
è&& defšed(
HAVE___SS_FAMILY_IN_SS
)

290 
	#ss_çmy
 
__ss_çmy


	)

293 #iâdeà
HAVE_SYS_UN_H


294 
	ssockaddr_un
 {

295 
	msun_çmy
;

296 
	msun_·th
[108];

300 #iâdeà
HAVE_IN_ADDR_T


301 
u_št32_t
 
	tš_addr_t
;

303 #iâdeà
HAVE_IN_PORT_T


304 
u_št16_t
 
	tš_pÜt_t
;

307 #ià
defšed
(
BROKEN_SYS_TERMIO_H
è&& !defšed(
_STRUCT_WINSIZE
)

308 
	#_STRUCT_WINSIZE


	)

309 
	swšsize
 {

310 
	mws_row
;

311 
	mws_cŞ
;

312 
	mws_xpix–
;

313 
	mws_ypix–
;

318 #ifdeà
MISSING_FD_MASK


319 
	tfd_mask
;

324 #iâdeà
_PATH_BSHELL


325 
	#_PATH_BSHELL
 "/bš/sh"

	)

328 #ifdeà
USER_PATH


329 #ifdeà
_PATH_STDPATH


330 #undeà
_PATH_STDPATH


332 
	#_PATH_STDPATH
 
USER_PATH


	)

335 #iâdeà
_PATH_STDPATH


336 
	#_PATH_STDPATH
 "/u¤/bš:/bš:/u¤/sbš:/sbš"

	)

339 #iâdeà
SUPERUSER_PATH


340 
	#SUPERUSER_PATH
 
_PATH_STDPATH


	)

343 #iâdeà
_PATH_DEVNULL


344 
	#_PATH_DEVNULL
 "/dev/nuÎ"

	)

347 #iâdeà
MAIL_DIRECTORY


348 
	#MAIL_DIRECTORY
 "/v¬/¥oŞ/ma"

	)

351 #iâdeà
MAILDIR


352 
	#MAILDIR
 
MAIL_DIRECTORY


	)

355 #ià!
defšed
(
_PATH_MAILDIR
è&& defšed(
MAILDIR
)

356 
	#_PATH_MAILDIR
 
MAILDIR


	)

359 #iâdeà
_PATH_NOLOGIN


360 
	#_PATH_NOLOGIN
 "/‘c/nŞogš"

	)

364 #ifdeà
XAUTH_PATH


365 
	#_PATH_XAUTH
 
XAUTH_PATH


	)

369 #iâdeà
X_UNIX_PATH


370 #ifdeà
__hpux


371 
	#X_UNIX_PATH
 "/v¬/¥oŞ/sock‘s/X11/%u"

	)

373 
	#X_UNIX_PATH
 "/tmp/.X11-unix/X%u"

	)

376 
	#_PATH_UNIX_X
 
X_UNIX_PATH


	)

378 #iâdeà
_PATH_TTY


379 
	#_PATH_TTY
 "/dev/‰y"

	)

384 #ià
defšed
(
HAVE_LOGIN_GETCAPBOOL
è&& defšed(
HAVE_LOGIN_CAP_H
)

385 
	#HAVE_LOGIN_CAP


	)

388 #iâdeà
MAX


389 
	#MAX
(
a
,
b
è((×)>(b))?×):(b))

	)

390 
	#MIN
(
a
,
b
è((×)<(b))?×):(b))

	)

393 #iâdeà
roundup


394 
	#roundup
(
x
, 
y
è((((x)+((y)-1))/(y))*(y))

	)

397 #iâdeà
tim”sub


398 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

400 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

401 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

402 ià((
»suÉ
)->
tv_u£c
 < 0) { \

403 --(
»suÉ
)->
tv_£c
; \

404 (
»suÉ
)->
tv_u£c
 += 1000000; \

406 } 0)

	)

409 #iâdeà
TIMEVAL_TO_TIMESPEC


410 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

411 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

412 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

413 }

	)

416 #iâdeà
TIMESPEC_TO_TIMEVAL


417 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

418 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

419 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

420 }

	)

423 #iâdeà
__P


424 
	#__P
(
x
è
	)
x

427 #ià!
defšed
(
IN6_IS_ADDR_V4MAPPED
)

428 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

429 ((((
u_št32_t
 *è(
a
))[0] == 0) && (((u_int32_t *) (a))[1] == 0) && \

430 (((
u_št32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

433 #ià!
defšed
(
__GNUC__
) || (__GNUC__ < 2)

434 
	#__©Œibu‹__
(
x
)

	)

437 #ià!
defšed
(
HAVE_ATTRIBUTE__SENTINEL__
è&& !defšed(
__£Áš–__
)

438 
	#__£Áš–__


	)

441 #ià!
defšed
(
HAVE_ATTRIBUTE__BOUNDED__
è&& !defšed(
__bounded__
)

442 
	#__bounded__
(
x
, 
y
, 
z
)

	)

445 #ià!
defšed
(
HAVE_ATTRIBUTE__NONNULL__
è&& !defšed(
__nÚnuÎ__
)

446 
	#__nÚnuÎ__
(
x
)

	)

450 #ifdeà
MISSING_HOWMANY


451 
	#howmªy
(
x
,
y
è(((x)+((y)-1))/(y))

	)

454 #iâdeà
OSSH_ALIGNBYTES


455 
	#OSSH_ALIGNBYTES
 ((è- 1)

	)

457 #iâdeà
__CMSG_ALIGN


458 
	#__CMSG_ALIGN
(
p
è(((
u_št
)Õè+ 
OSSH_ALIGNBYTES
è&~ OSSH_ALIGNBYTES)

	)

462 #iâdeà
CMSG_LEN


463 
	#CMSG_LEN
(
Ën
è(
	`__CMSG_ALIGN
((
cmsghdr
)è+ (Ën))

	)

467 #iâdeà
CMSG_SPACE


468 
	#CMSG_SPACE
(
Ën
è(
	`__CMSG_ALIGN
((
cmsghdr
)è+ __CMSG_ALIGNÖ’))

	)

472 #iâdeà
CMSG_DATA


473 
	#CMSG_DATA
(
cmsg
è((
u_ch¬
 *)(cmsgè+ 
	`__CMSG_ALIGN
((
cmsghdr
)))

	)

480 #iâdeà
CMSG_FIRSTHDR


481 
	#CMSG_FIRSTHDR
(
mhdr
) \

482 ((
mhdr
)->
msg_cÚŒŞËn
 >ğ(
cmsghdr
) ? \

483 (
cmsghdr
 *)(
mhdr
)->
msg_cÚŒŞ
 : \

484 (
cmsghdr
 *)
NULL
)

	)

487 #ià
defšed
(
HAVE_DECL_OFFSETOF
) && HAVE_DECL_OFFSETOF == 0

488 
	#off£tof
(
ty³
, 
memb”
è((
size_t
è&(Ñy³ *)0)->memb”)

	)

493 #iâdeà
BYTE_ORDER


494 #iâdeà
LITTLE_ENDIAN


495 
	#LITTLE_ENDIAN
 1234

	)

497 #iâdeà
BIG_ENDIAN


498 
	#BIG_ENDIAN
 4321

	)

500 #ifdeà
WORDS_BIGENDIAN


501 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

503 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

509 #ià!
defšed
(
HAVE_GETADDRINFO
è&& (defšed(
HAVE_OGETADDRINFO
è|| defšed(
HAVE_NGETADDRINFO
))

510 
	#HAVE_GETADDRINFO


	)

513 #iâdeà
HAVE_GETOPT_OPTRESET


514 #undeà
g‘İt


515 #undeà
İ‹¼


516 #undeà
İtšd


517 #undeà
İtİt


518 #undeà
İŒe£t


519 #undeà
İrg


520 
	#g‘İt
(
ac
, 
av
, 
o
è
	`BSDg‘İt
×c,‡v, o)

	)

521 
	#İ‹¼
 
BSDİ‹¼


	)

522 
	#İtšd
 
BSDİtšd


	)

523 
	#İtİt
 
BSDİtİt


	)

524 
	#İŒe£t
 
BSDİŒe£t


	)

525 
	#İrg
 
BSDİrg


	)

528 #ià
defšed
(
BROKEN_GETADDRINFO
è&& defšed(
HAVE_GETADDRINFO
)

529 #undeà
HAVE_GETADDRINFO


531 #ià
defšed
(
BROKEN_GETADDRINFO
è&& defšed(
HAVE_FREEADDRINFO
)

532 #undeà
HAVE_FREEADDRINFO


534 #ià
defšed
(
BROKEN_GETADDRINFO
è&& defšed(
HAVE_GAI_STRERROR
)

535 #undeà
HAVE_GAI_STRERROR


538 #ià
defšed
(
BROKEN_UPDWTMPX
è&& defšed(
HAVE_UPDWTMPX
)

539 #undeà
HAVE_UPDWTMPX


542 #ià
defšed
(
BROKEN_SHADOW_EXPIRE
è&& defšed(
HAS_SHADOW_EXPIRE
)

543 #undeà
HAS_SHADOW_EXPIRE


546 #ià
defšed
(
HAVE_OPENLOG_R
è&& defšed(
SYSLOG_DATA_INIT
) && \

547 
	$defšed
(
SYSLOG_R_SAFE_IN_SIGHAND
)

548 
	#DO_LOG_SAFE_IN_SIGHAND


	)

551 #ià!
	`defšed
(
HAVE_MEMMOVE
è&& defšed(
HAVE_BCOPY
)

552 
	#memmove
(
s1
, 
s2
, 
n
è
	`bcİy
((s2), (s1), (n))

	)

555 #ià
	`defšed
(
HAVE_VHANGUP
è&& !defšed(
HAVE_DEV_PTMX
)

556 
	#USE_VHANGUP


	)

559 #iâdeà
GETPGRP_VOID


560 
	~<uni¡d.h
>

561 
	#g‘pg½
(è
	`g‘pg½
(0)

	)

564 #ifdeà
USE_BSM_AUDIT


565 
	#SSH_AUDIT_EVENTS


	)

566 
	#CUSTOM_SSH_AUDIT_EVENTS


	)

569 #ià!
	`defšed
(
HAVE___func__
è&& defšed(
HAVE___FUNCTION__
)

570 
	#__func__
 
__FUNCTION__


	)

571 #–ià!
	`defšed
(
HAVE___func__
)

572 
	#__func__
 ""

	)

575 #ià
	`defšed
(
KRB5
è&& !defšed(
HEIMDAL
)

576 
	#krb5_g‘_”r_‹xt
(
cÚ‹xt
,
code
è
	`”rÜ_mes§ge
(code)

	)

579 #ià
	`defšed
(
SKEYCHALLENGE_4ARG
)

580 
	#_com·t_skeych®Ënge
(
a
,
b
,
c
,
d
è
	`skeych®Ënge
×,b,c,d)

	)

582 
	#_com·t_skeych®Ënge
(
a
,
b
,
c
,
d
è
	`skeych®Ënge
×,b,c)

	)

586 #ifdeà
HAVE_SYSCONF


587 
	#SSH_SYSFDMAX
 
	`syscÚf
(
_SC_OPEN_MAX
)

	)

589 
	#SSH_SYSFDMAX
 10000

	)

592 #ifdeà
FSID_HAS_VAL


594 
	#FSID_TO_ULONG
(
f
) \

595 ((((
u_št64_t
)(
f
).
v®
[0] & 0xffffffffUL) << 32) | \

596 ((
f
).
v®
[1] & 0xffffffffUL))

	)

597 #–ià
	`defšed
(
FSID_HAS___VAL
)

598 
	#FSID_TO_ULONG
(
f
) \

599 ((((
u_št64_t
)(
f
).
__v®
[0] & 0xffffffffUL) << 32) | \

600 ((
f
).
__v®
[1] & 0xffffffffUL))

	)

602 
	#FSID_TO_ULONG
(
f
è((f))

	)

605 #ià
	`defšed
(
__Lynx__
)

610 
	#ALIGNBYTES
 ((è- 1)

	)

611 
	#ALIGN
(
p
è(((í + 
ALIGNBYTES
è& ~ALIGNBYTES)

	)

613 
	`¢´štf
 (*, 
size_t
, const *, ...);

614 
	`mk¡emp
 (*);

615 *
	`üy±
 (const *, const *);

616 
	`£‹uid
 (
uid_t
);

617 
	`£‹gid
 (
gid_t
);

618 *
	`mkd‹mp
 (*);

619 
	`¼esvpÜt_af
 (*, 
§_çmy_t
);

620 
	`šÃtgr
 (const *, const *, const *, const *);

637 #iâdeà
UTMP_FILE


638 #ifdeà
_PATH_UTMP


639 
	#UTMP_FILE
 
_PATH_UTMP


	)

641 #ifdeà
CONF_UTMP_FILE


642 
	#UTMP_FILE
 
CONF_UTMP_FILE


	)

646 #iâdeà
WTMP_FILE


647 #ifdeà
_PATH_WTMP


648 
	#WTMP_FILE
 
_PATH_WTMP


	)

650 #ifdeà
CONF_WTMP_FILE


651 
	#WTMP_FILE
 
CONF_WTMP_FILE


	)

656 #iâdeà
LASTLOG_FILE


657 #ifdeà
_PATH_LASTLOG


658 
	#LASTLOG_FILE
 
_PATH_LASTLOG


	)

660 #ifdeà
CONF_LASTLOG_FILE


661 
	#LASTLOG_FILE
 
CONF_LASTLOG_FILE


	)

666 #ià
	`defšed
(
HAVE_SHADOW_H
è&& !defšed(
DISABLE_SHADOW
)

667 
	#USE_SHADOW


	)

671 #ià
	`defšed
(
HAVE_LOGIN
è&& !defšed(
DISABLE_LOGIN
)

672 
	#USE_LOGIN


	)

677 #ià!
	`defšed
(
DISABLE_UTMPX
)

678 
	#USE_UTMPX


	)

680 #ià
	`defšed
(
UTMP_FILE
è&& !defšed(
DISABLE_UTMP
)

681 
	#USE_UTMP


	)

683 #ià
	`defšed
(
WTMPX_FILE
è&& !defšed(
DISABLE_WTMPX
)

684 
	#USE_WTMPX


	)

686 #ià
	`defšed
(
WTMP_FILE
è&& !defšed(
DISABLE_WTMP
)

687 
	#USE_WTMP


	)

692 #iâdeà
UT_LINESIZE


693 
	#UT_LINESIZE
 8

	)

697 #ià
	`defšed
(
LASTLOG_FILE
è&& !defšed(
DISABLE_LASTLOG
)

698 
	#USE_LASTLOG


	)

701 #ifdeà
HAVE_OSF_SIA


702 #ifdeà
USE_SHADOW


703 #undeà
USE_SHADOW


705 
	#CUSTOM_SYS_AUTH_PASSWD
 1

	)

708 #ià
	`defšed
(
HAVE_LIBIAF
è&& defšed(
HAVE_SET_ID
è&& !defšed(
HAVE_SECUREWARE
)

709 
	#CUSTOM_SYS_AUTH_PASSWD
 1

	)

711 #ià
	`defšed
(
HAVE_LIBIAF
è&& defšed(
HAVE_SET_ID
è&& !defšed(
BROKEN_LIBIAF
)

712 
	#USE_LIBIAF


	)

716 #ifdeà
BTMP_FILE


717 
	#_PATH_BTMP
 
BTMP_FILE


	)

720 #ià
	`defšed
(
USE_BTMP
è&& defšed(
_PATH_BTMP
)

721 
	#CUSTOM_FAILED_LOGIN


	)

726 #ifdeà
BROKEN_GETGROUPS


727 
	#g‘groups
(
a
,
b
è(×)==0 && (b)==
NULL
 ? 
NGROUPS_MAX
 : 
	`g‘groups
(×),(b)))

	)

730 #ià
	`defšed
(
HAVE_MMAP
è&& defšed(
BROKEN_MMAP
)

731 #undeà
HAVE_MMAP


734 #iâdeà
IOV_MAX


735 #ià
	`defšed
(
_XOPEN_IOV_MAX
)

736 
	#IOV_MAX
 
_XOPEN_IOV_MAX


	)

737 #–ià
	`defšed
(
DEF_IOV_MAX
)

738 
	#IOV_MAX
 
DEF_IOV_MAX


	)

740 
	#IOV_MAX
 16

	)

744 #iâdeà
EWOULDBLOCK


745 
	#EWOULDBLOCK
 
EAGAIN


	)

748 #iâdeà
INET6_ADDRSTRLEN


749 
	#INET6_ADDRSTRLEN
 46

	)

752 #iâdeà
SSH_IOBUFSZ


753 
	#SSH_IOBUFSZ
 8192

	)

756 #iâdeà
_NSIG


757 #ifdeà
NSIG


758 
	#_NSIG
 
NSIG


	)

760 
	#_NSIG
 128

	)

	@sftp-server/entropy.h

27 #iâdeà
_RANDOMS_H


28 
	#_RANDOMS_H


	)

30 
	~"bufãr.h
"

32 
£ed_ºg
();

33 
š™_ºg
();

35 
»xec_£nd_ºg_£ed
(
Bufãr
 *);

36 
»xec_»cv_ºg_£ed
(
Bufãr
 *);

	@sftp-server/includes.h

16 #iâdeà
INCLUDES_H


17 
	#INCLUDES_H


	)

19 
	~"cÚfig.h
"

21 
	#_GNU_SOURCE


	)

23 
	~<sys/ty³s.h
>

24 
	~<sys/sock‘.h
>

26 #ifdeà
HAVE_LIMITS_H


27 
	~<lim™s.h
>

29 #ifdeà
HAVE_BSTRING_H


30 
	~<b¡ršg.h
>

32 #ià
defšed
(
HAVE_GLOB_H
è&& defšed(
GLOB_HAS_ALTDIRFUNC
) && \

33 
defšed
(
GLOB_HAS_GL_MATCHC
) && \

34 
defšed
(
HAVE_DECL_GLOB_NOMATCH
è&& 
	gHAVE_DECL_GLOB_NOMATCH
 != 0 && \

35 !
	$defšed
(
BROKEN_GLOB
)

36 
	~<glob.h
>

38 #ifdeà
HAVE_ENDIAN_H


39 
	~<’dŸn.h
>

41 #ifdeà
HAVE_TTYENT_H


42 
	~<‰y’t.h
>

44 #ifdeà
HAVE_UTIME_H


45 
	~<utime.h
>

47 #ifdeà
HAVE_MAILLOCK_H


48 
	~<malock.h
>

50 #ifdeà
HAVE_NEXT


51 
	~<libc.h
>

53 #ifdeà
HAVE_PATHS_H


54 
	~<·ths.h
>

60 #ifdeà
HAVE_STRINGS_H


61 
	~<¡ršgs.h
>

63 #ifdeà
HAVE_LOGIN_H


64 
	~<logš.h
>

67 #ifdeà
HAVE_UTMP_H


68 
	~<utmp.h
>

70 #ifdeà
HAVE_UTMPX_H


71 
	~<utmpx.h
>

73 #ifdeà
HAVE_LASTLOG_H


74 
	~<Ï¡log.h
>

77 #ifdeà
HAVE_SYS_SELECT_H


78 
	~<sys/£Ëù.h
>

80 #ifdeà
HAVE_SYS_BSDTTY_H


81 
	~<sys/bsd‰y.h
>

83 #ifdeà
HAVE_STDINT_H


84 
	~<¡dšt.h
>

86 
	~<‹rmios.h
>

87 #ifdeà
HAVE_SYS_BITYPES_H


88 
	~<sys/b™y³s.h
>

90 #ifdeà
HAVE_SYS_CDEFS_H


91 
	~<sys/cdefs.h
>

93 #ifdeà
HAVE_SYS_STAT_H


94 
	~<sys/¡©.h
>

96 #ifdeà
HAVE_SYS_SYSMACROS_H


97 
	~<sys/sysmaüos.h
>

99 #ifdeà
HAVE_SYS_MMAN_H


100 
	~<sys/mmª.h
>

102 #ifdeà
HAVE_SYS_STRTIO_H


103 
	~<sys/¡¹io.h
>

105 #ià
	`defšed
(
HAVE_SYS_PTMS_H
è&& defšed(
HAVE_DEV_PTMX
)

106 #ià
	`defšed
(
HAVE_SYS_STREAM_H
)

107 
	~<sys/¡»am.h
>

109 
	~<sys/±ms.h
>

112 
	~<Ãtš‘/š.h
>

113 
	~<Ãtš‘/š_sy¡m.h
>

114 #ifdeà
HAVE_RPC_TYPES_H


115 
	~<½c/ty³s.h
>

117 #ifdeà
USE_PAM


118 #ià
	`defšed
(
HAVE_SECURITY_PAM_APPL_H
)

119 
	~<£cur™y/·m_­¶.h
>

120 #–ià
	`defšed
 (
HAVE_PAM_PAM_APPL_H
)

121 
	~<·m/·m_­¶.h
>

124 #ifdeà
HAVE_READPASSPHRASE_H


125 
	~<»ad·s¥h¿£.h
>

128 #ifdeà
HAVE_IA_H


129 
	~<Ÿ.h
>

132 #ifdeà
HAVE_IAF_H


133 
	~<Ÿf.h
>

136 #ifdeà
HAVE_TMPDIR_H


137 
	~<tmpdœ.h
>

140 #ifdeà
HAVE_LIBUTIL_H


141 
	~<libut.h
>

144 #ià
	`defšed
(
KRB5
è&& defšed(
USE_AFS
)

145 
	~<krb5.h
>

146 
	~<kafs.h
>

149 #ià
	`defšed
(
HAVE_SYS_SYSLOG_H
)

150 
	~<sys/sy¦og.h
>

153 
	~<”ºo.h
>

159 #ifdeà
GETSPNAM_CONFLICTING_DEFS


160 #ifdeà
_INCLUDE__STDC__


161 #undeà
_INCLUDE__STDC__


165 
	~<İ’s¦/İ’s¦v.h
>

167 
	~"defšes.h
"

169 
	~"¶©fÜm.h
"

170 
	~"İ’bsd-com·t/İ’bsd-com·t.h
"

171 
	~"İ’bsd-com·t/bsd-Ãxt¡•.h
"

173 
	~"’Œİy.h
"

	@sftp-server/log.c

37 
	~"šşudes.h
"

39 
	~<sys/ty³s.h
>

41 
	~<¡d¬g.h
>

42 
	~<¡dio.h
>

43 
	~<¡dlib.h
>

44 
	~<¡ršg.h
>

45 
	~<sy¦og.h
>

46 
	~<uni¡d.h
>

47 
	~<”ºo.h
>

48 #ià
defšed
(
HAVE_STRNVIS
è&& defšed(
HAVE_VIS_H
)

49 
	~<vis.h
>

52 
	~"xm®loc.h
"

53 
	~"log.h
"

55 
LogLev–
 
	glog_Ëv–
 = 
SYSLOG_LEVEL_INFO
;

56 
	glog_Ú_¡d”r
 = 1;

57 
	glog_çc™y
 = 
LOG_AUTH
;

58 *
	g¬gv0
;

60 *
__´ogÇme
;

62 
	#LOG_SYSLOG_VIS
 (
VIS_CSTYLE
|
VIS_NL
|
VIS_TAB
|
VIS_OCTAL
)

	)

63 
	#LOG_STDERR_VIS
 (
VIS_SAFE
|
VIS_OCTAL
)

	)

68 cÚ¡ *
	mÇme
;

69 
Sy¦ogFac™y
 
	mv®
;

70 } 
	glog_çc™›s
[] = {

71 { "DAEMON", 
SYSLOG_FACILITY_DAEMON
 },

72 { "USER", 
SYSLOG_FACILITY_USER
 },

73 { "AUTH", 
SYSLOG_FACILITY_AUTH
 },

74 #ifdeà
LOG_AUTHPRIV


75 { "AUTHPRIV", 
SYSLOG_FACILITY_AUTHPRIV
 },

77 { "LOCAL0", 
SYSLOG_FACILITY_LOCAL0
 },

78 { "LOCAL1", 
SYSLOG_FACILITY_LOCAL1
 },

79 { "LOCAL2", 
SYSLOG_FACILITY_LOCAL2
 },

80 { "LOCAL3", 
SYSLOG_FACILITY_LOCAL3
 },

81 { "LOCAL4", 
SYSLOG_FACILITY_LOCAL4
 },

82 { "LOCAL5", 
SYSLOG_FACILITY_LOCAL5
 },

83 { "LOCAL6", 
SYSLOG_FACILITY_LOCAL6
 },

84 { "LOCAL7", 
SYSLOG_FACILITY_LOCAL7
 },

85 { 
NULL
, 
SYSLOG_FACILITY_NOT_SET
 }

89 cÚ¡ *
	mÇme
;

90 
LogLev–
 
	mv®
;

91 } 
	glog_Ëv–s
[] =

93 { "QUIET", 
SYSLOG_LEVEL_QUIET
 },

94 { "FATAL", 
SYSLOG_LEVEL_FATAL
 },

95 { "ERROR", 
SYSLOG_LEVEL_ERROR
 },

96 { "INFO", 
SYSLOG_LEVEL_INFO
 },

97 { "VERBOSE", 
SYSLOG_LEVEL_VERBOSE
 },

98 { "DEBUG", 
SYSLOG_LEVEL_DEBUG1
 },

99 { "DEBUG1", 
SYSLOG_LEVEL_DEBUG1
 },

100 { "DEBUG2", 
SYSLOG_LEVEL_DEBUG2
 },

101 { "DEBUG3", 
SYSLOG_LEVEL_DEBUG3
 },

102 { 
NULL
, 
SYSLOG_LEVEL_NOT_SET
 }

105 
Sy¦ogFac™y


106 
	$log_çc™y_numb”
(*
Çme
)

108 
i
;

110 ià(
Çme
 !ğ
NULL
)

111 
i
 = 0; 
log_çc™›s
[i].
Çme
; i++)

112 ià(
	`¡rÿ£cmp
(
log_çc™›s
[
i
].
Çme
,‚ame) == 0)

113  
log_çc™›s
[
i
].
v®
;

114  
SYSLOG_FACILITY_NOT_SET
;

115 
	}
}

118 
	$log_çc™y_Çme
(
Sy¦ogFac™y
 
çc™y
)

120 
u_št
 
i
;

122 
i
 = 0; 
log_çc™›s
[i].
Çme
; i++)

123 ià(
log_çc™›s
[
i
].
v®
 =ğ
çc™y
)

124  
log_çc™›s
[
i
].
Çme
;

125  
NULL
;

126 
	}
}

128 
LogLev–


129 
	$log_Ëv–_numb”
(*
Çme
)

131 
i
;

133 ià(
Çme
 !ğ
NULL
)

134 
i
 = 0; 
log_Ëv–s
[i].
Çme
; i++)

135 ià(
	`¡rÿ£cmp
(
log_Ëv–s
[
i
].
Çme
,‚ame) == 0)

136  
log_Ëv–s
[
i
].
v®
;

137  
SYSLOG_LEVEL_NOT_SET
;

138 
	}
}

141 
	$log_Ëv–_Çme
(
LogLev–
 
Ëv–
)

143 
u_št
 
i
;

145 
i
 = 0; 
log_Ëv–s
[i].
Çme
 !ğ
NULL
; i++)

146 ià(
log_Ëv–s
[
i
].
v®
 =ğ
Ëv–
)

147  
log_Ëv–s
[
i
].
Çme
;

148  
NULL
;

149 
	}
}

154 
	$”rÜ
(cÚ¡ *
fmt
,...)

156 
va_li¡
 
¬gs
;

158 
	`va_¡¬t
(
¬gs
, 
fmt
);

159 
	`do_log
(
SYSLOG_LEVEL_ERROR
, 
fmt
, 
¬gs
);

160 
	`va_’d
(
¬gs
);

161 
	}
}

164 
	$sigd›
(cÚ¡ *
fmt
,...)

166 #ifdeà
DO_LOG_SAFE_IN_SIGHAND


167 
va_li¡
 
¬gs
;

169 
	`va_¡¬t
(
¬gs
, 
fmt
);

170 
	`do_log
(
SYSLOG_LEVEL_FATAL
, 
fmt
, 
¬gs
);

171 
	`va_’d
(
¬gs
);

173 
	`_ex™
(1);

174 
	}
}

180 
	$log™
(cÚ¡ *
fmt
,...)

182 
va_li¡
 
¬gs
;

184 
	`va_¡¬t
(
¬gs
, 
fmt
);

185 
	`do_log
(
SYSLOG_LEVEL_INFO
, 
fmt
, 
¬gs
);

186 
	`va_’d
(
¬gs
);

187 
	}
}

192 
	$v”bo£
(cÚ¡ *
fmt
,...)

194 
va_li¡
 
¬gs
;

196 
	`va_¡¬t
(
¬gs
, 
fmt
);

197 
	`do_log
(
SYSLOG_LEVEL_VERBOSE
, 
fmt
, 
¬gs
);

198 
	`va_’d
(
¬gs
);

199 
	}
}

204 
	$debug
(cÚ¡ *
fmt
,...)

206 
va_li¡
 
¬gs
;

208 
	`va_¡¬t
(
¬gs
, 
fmt
);

209 
	`do_log
(
SYSLOG_LEVEL_DEBUG1
, 
fmt
, 
¬gs
);

210 
	`va_’d
(
¬gs
);

211 
	}
}

214 
	$debug2
(cÚ¡ *
fmt
,...)

216 
va_li¡
 
¬gs
;

218 
	`va_¡¬t
(
¬gs
, 
fmt
);

219 
	`do_log
(
SYSLOG_LEVEL_DEBUG2
, 
fmt
, 
¬gs
);

220 
	`va_’d
(
¬gs
);

221 
	}
}

224 
	$debug3
(cÚ¡ *
fmt
,...)

226 
va_li¡
 
¬gs
;

228 
	`va_¡¬t
(
¬gs
, 
fmt
);

229 
	`do_log
(
SYSLOG_LEVEL_DEBUG3
, 
fmt
, 
¬gs
);

230 
	`va_’d
(
¬gs
);

231 
	}
}

238 
	$log_š™
(*
av0
, 
LogLev–
 
Ëv–
, 
Sy¦ogFac™y
 
çc™y
, 
Ú_¡d”r
)

240 #ià
	`defšed
(
HAVE_OPENLOG_R
è&& defšed(
SYSLOG_DATA_INIT
)

241 
sy¦og_d©a
 
sd©a
 = 
SYSLOG_DATA_INIT
;

244 
¬gv0
 = 
av0
;

246 
Ëv–
) {

247 
SYSLOG_LEVEL_QUIET
:

248 
SYSLOG_LEVEL_FATAL
:

249 
SYSLOG_LEVEL_ERROR
:

250 
SYSLOG_LEVEL_INFO
:

251 
SYSLOG_LEVEL_VERBOSE
:

252 
SYSLOG_LEVEL_DEBUG1
:

253 
SYSLOG_LEVEL_DEBUG2
:

254 
SYSLOG_LEVEL_DEBUG3
:

255 
log_Ëv–
 = 
Ëv–
;

258 
	`årštf
(
¡d”r
, "Unrecognized internal syslog†evel code %d\n",

259 (è
Ëv–
);

260 
	`ex™
(1);

263 
log_Ú_¡d”r
 = 
Ú_¡d”r
;

264 ià(
Ú_¡d”r
)

267 
çc™y
) {

268 
SYSLOG_FACILITY_DAEMON
:

269 
log_çc™y
 = 
LOG_DAEMON
;

271 
SYSLOG_FACILITY_USER
:

272 
log_çc™y
 = 
LOG_USER
;

274 
SYSLOG_FACILITY_AUTH
:

275 
log_çc™y
 = 
LOG_AUTH
;

277 #ifdeà
LOG_AUTHPRIV


278 
SYSLOG_FACILITY_AUTHPRIV
:

279 
log_çc™y
 = 
LOG_AUTHPRIV
;

282 
SYSLOG_FACILITY_LOCAL0
:

283 
log_çc™y
 = 
LOG_LOCAL0
;

285 
SYSLOG_FACILITY_LOCAL1
:

286 
log_çc™y
 = 
LOG_LOCAL1
;

288 
SYSLOG_FACILITY_LOCAL2
:

289 
log_çc™y
 = 
LOG_LOCAL2
;

291 
SYSLOG_FACILITY_LOCAL3
:

292 
log_çc™y
 = 
LOG_LOCAL3
;

294 
SYSLOG_FACILITY_LOCAL4
:

295 
log_çc™y
 = 
LOG_LOCAL4
;

297 
SYSLOG_FACILITY_LOCAL5
:

298 
log_çc™y
 = 
LOG_LOCAL5
;

300 
SYSLOG_FACILITY_LOCAL6
:

301 
log_çc™y
 = 
LOG_LOCAL6
;

303 
SYSLOG_FACILITY_LOCAL7
:

304 
log_çc™y
 = 
LOG_LOCAL7
;

307 
	`årštf
(
¡d”r
,

309 (è
çc™y
);

310 
	`ex™
(1);

318 #ià
	`defšed
(
HAVE_OPENLOG_R
è&& defšed(
SYSLOG_DATA_INIT
)

319 
	`İ’log_r
(
¬gv0
 ?‡rgv0 : 
__´ogÇme
, 
LOG_PID
, 
log_çc™y
, &
sd©a
);

320 
	`şo£log_r
(&
sd©a
);

322 
	`İ’log
(
¬gv0
 ?‡rgv0 : 
__´ogÇme
, 
LOG_PID
, 
log_çc™y
);

323 
	`şo£log
();

325 
	}
}

327 
	#MSGBUFSIZ
 1024

	)

330 
	$do_log
(
LogLev–
 
Ëv–
, cÚ¡ *
fmt
, 
va_li¡
 
¬gs
)

332 #ià
	`defšed
(
HAVE_OPENLOG_R
è&& defšed(
SYSLOG_DATA_INIT
)

333 
sy¦og_d©a
 
sd©a
 = 
SYSLOG_DATA_INIT
;

335 
msgbuf
[
MSGBUFSIZ
];

336 
fmtbuf
[
MSGBUFSIZ
];

337 *
txt
 = 
NULL
;

338 
´i
 = 
LOG_INFO
;

339 
§ved_”ºo
 = 
”ºo
;

341 ià(
Ëv–
 > 
log_Ëv–
)

344 
Ëv–
) {

345 
SYSLOG_LEVEL_FATAL
:

346 ià(!
log_Ú_¡d”r
)

347 
txt
 = "fatal";

348 
´i
 = 
LOG_CRIT
;

350 
SYSLOG_LEVEL_ERROR
:

351 ià(!
log_Ú_¡d”r
)

352 
txt
 = "error";

353 
´i
 = 
LOG_ERR
;

355 
SYSLOG_LEVEL_INFO
:

356 
´i
 = 
LOG_INFO
;

358 
SYSLOG_LEVEL_VERBOSE
:

359 
´i
 = 
LOG_INFO
;

361 
SYSLOG_LEVEL_DEBUG1
:

362 
txt
 = "debug1";

363 
´i
 = 
LOG_DEBUG
;

365 
SYSLOG_LEVEL_DEBUG2
:

366 
txt
 = "debug2";

367 
´i
 = 
LOG_DEBUG
;

369 
SYSLOG_LEVEL_DEBUG3
:

370 
txt
 = "debug3";

371 
´i
 = 
LOG_DEBUG
;

374 
txt
 = "internalƒrror";

375 
´i
 = 
LOG_ERR
;

378 ià(
txt
 !ğ
NULL
) {

379 
	`¢´štf
(
fmtbuf
, (fmtbuf), "%s: %s", 
txt
, 
fmt
);

380 
	`v¢´štf
(
msgbuf
, (msgbuf), 
fmtbuf
, 
¬gs
);

382 
	`v¢´štf
(
msgbuf
, (msgbuf), 
fmt
, 
¬gs
);

384 
	`¡ºvis
(
fmtbuf
, 
msgbuf
, (fmtbuf),

385 
log_Ú_¡d”r
 ? 
LOG_STDERR_VIS
 : 
LOG_SYSLOG_VIS
);

386 ià(
log_Ú_¡d”r
) {

387 
	`¢´štf
(
msgbuf
,  msgbuf, "%s\r\n", 
fmtbuf
);

388 
	`wr™e
(
STDERR_FILENO
, 
msgbuf
, 
	`¡¾’
(msgbuf));

390 #ià
	`defšed
(
HAVE_OPENLOG_R
è&& defšed(
SYSLOG_DATA_INIT
)

391 
	`İ’log_r
(
¬gv0
 ?‡rgv0 : 
__´ogÇme
, 
LOG_PID
, 
log_çc™y
, &
sd©a
);

392 
	`sy¦og_r
(
´i
, &
sd©a
, "%.500s", 
fmtbuf
);

393 
	`şo£log_r
(&
sd©a
);

395 
	`İ’log
(
¬gv0
 ?‡rgv0 : 
__´ogÇme
, 
LOG_PID
, 
log_çc™y
);

396 
	`sy¦og
(
´i
, "%.500s", 
fmtbuf
);

397 
	`şo£log
();

400 
”ºo
 = 
§ved_”ºo
;

401 
	}
}

404 
	$çl
(cÚ¡ *
fmt
,...)

406 
va_li¡
 
¬gs
;

408 
	`va_¡¬t
(
¬gs
, 
fmt
);

409 
	`do_log
(
SYSLOG_LEVEL_FATAL
, 
fmt
, 
¬gs
);

410 
	`va_’d
(
¬gs
);

411 
	`ex™
(255);

412 
	}
}

	@sftp-server/log.h

15 #iâdeà
SSH_LOG_H


16 
	#SSH_LOG_H


	)

20 
	mSYSLOG_FACILITY_DAEMON
,

21 
	mSYSLOG_FACILITY_USER
,

22 
	mSYSLOG_FACILITY_AUTH
,

23 #ifdeà
LOG_AUTHPRIV


24 
	mSYSLOG_FACILITY_AUTHPRIV
,

26 
	mSYSLOG_FACILITY_LOCAL0
,

27 
	mSYSLOG_FACILITY_LOCAL1
,

28 
	mSYSLOG_FACILITY_LOCAL2
,

29 
	mSYSLOG_FACILITY_LOCAL3
,

30 
	mSYSLOG_FACILITY_LOCAL4
,

31 
	mSYSLOG_FACILITY_LOCAL5
,

32 
	mSYSLOG_FACILITY_LOCAL6
,

33 
	mSYSLOG_FACILITY_LOCAL7
,

34 
	mSYSLOG_FACILITY_NOT_SET
 = -1

35 } 
	tSy¦ogFac™y
;

38 
	mSYSLOG_LEVEL_QUIET
,

39 
	mSYSLOG_LEVEL_FATAL
,

40 
	mSYSLOG_LEVEL_ERROR
,

41 
	mSYSLOG_LEVEL_INFO
,

42 
	mSYSLOG_LEVEL_VERBOSE
,

43 
	mSYSLOG_LEVEL_DEBUG1
,

44 
	mSYSLOG_LEVEL_DEBUG2
,

45 
	mSYSLOG_LEVEL_DEBUG3
,

46 
	mSYSLOG_LEVEL_NOT_SET
 = -1

47 } 
	tLogLev–
;

49 
log_š™
(*, 
LogLev–
, 
Sy¦ogFac™y
, );

51 
Sy¦ogFac™y
 
log_çc™y_numb”
(*);

52 cÚ¡ * 
log_çc™y_Çme
(
Sy¦ogFac™y
);

53 
LogLev–
 
log_Ëv–_numb”
(*);

54 cÚ¡ * 
log_Ëv–_Çme
(
LogLev–
);

56 
	$çl
(cÚ¡ *, ...è
	`__©Œibu‹__
((
nÜ‘uº
))

57 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

58 
	$”rÜ
(cÚ¡ *, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

59 
	$sigd›
(cÚ¡ *, ...è
	`__©Œibu‹__
((
nÜ‘uº
))

60 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

61 
	$log™
(cÚ¡ *, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

62 
	$v”bo£
(cÚ¡ *, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

63 
	$debug
(cÚ¡ *, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

64 
	$debug2
(cÚ¡ *, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

65 
	$debug3
(cÚ¡ *, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

67 
	`do_log
(
LogLev–
, cÚ¡ *, 
va_li¡
);

68 
	$ş—nup_ex™
(è
	`__©Œibu‹__
((
nÜ‘uº
));

	@sftp-server/match.c

38 
	~"šşudes.h
"

40 
	~<sys/ty³s.h
>

42 
	~<ùy³.h
>

43 
	~<¡ršg.h
>

45 
	~"xm®loc.h
"

46 
	~"m©ch.h
"

54 
	$m©ch_·‰”n
(cÚ¡ *
s
, cÚ¡ *
·‰”n
)

58 ià(!*
·‰”n
)

59  !*
s
;

61 ià(*
·‰”n
 == '*') {

63 
·‰”n
++;

66 ià(!*
·‰”n
)

70 ià(*
·‰”n
 != '?' && *pattern != '*') {

76 ; *
s
; s++)

77 ià(*
s
 =ğ*
·‰”n
 &&

78 
	`m©ch_·‰”n
(
s
 + 1, 
·‰”n
 + 1))

87 ; *
s
; s++)

88 ià(
	`m©ch_·‰”n
(
s
, 
·‰”n
))

97 ià(!*
s
)

101 ià(*
·‰”n
 !ğ'?' && *·‰”À!ğ*
s
)

105 
s
++;

106 
·‰”n
++;

109 
	}
}

119 
	$m©ch_·‰”n_li¡
(cÚ¡ *
¡ršg
, cÚ¡ *
·‰”n
, 
u_št
 
Ën
,

120 
dŞow”
)

122 
sub
[1024];

123 
Ãg©ed
;

124 
gÙ_pos™ive
;

125 
u_št
 
i
, 
subi
;

127 
gÙ_pos™ive
 = 0;

128 
i
 = 0; i < 
Ën
;) {

130 ià(
·‰”n
[
i
] == '!') {

131 
Ãg©ed
 = 1;

132 
i
++;

134 
Ãg©ed
 = 0;

140 
subi
 = 0;

141 
i
 < 
Ën
 && 
subi
 < (
sub
è- 1 && 
·‰”n
[i] != ',';

142 
subi
++, 
i
++)

143 
sub
[
subi
] = 
dŞow”
 && 
	`isuµ”
(
·‰”n
[
i
]) ?

144 ()
	`tŞow”
(
·‰”n
[
i
]) :…attern[i];

146 ià(
subi
 >ğ(
sub
) - 1)

150 ià(
i
 < 
Ën
 && 
·‰”n
[i] == ',')

151 
i
++;

154 
sub
[
subi
] = '\0';

157 ià(
	`m©ch_·‰”n
(
¡ršg
, 
sub
)) {

158 ià(
Ãg©ed
)

161 
gÙ_pos™ive
 = 1;

169  
gÙ_pos™ive
;

170 
	}
}

179 
	$m©ch_ho¡Çme
(cÚ¡ *
ho¡
, cÚ¡ *
·‰”n
, 
u_št
 
Ën
)

181  
	`m©ch_·‰”n_li¡
(
ho¡
, 
·‰”n
, 
Ën
, 1);

182 
	}
}

190 
	$m©ch_ho¡_ªd_
(cÚ¡ *
ho¡
, cÚ¡ *
addr
,

191 cÚ¡ *
·‰”ns
)

193 
mho¡
, 
m
;

196 ià((
m
 = 
	`addr_m©ch_li¡
(
addr
, 
·‰”ns
)) == -2)

198 ià(
m
 == -1)

202 ià((
mho¡
 = 
	`m©ch_ho¡Çme
(
ho¡
, 
·‰”ns
, 
	`¡¾’
(patterns))) == -1)

205 ià(
mho¡
 =ğ0 && 
m
 == 0)

208 
	}
}

214 
	$m©ch_u£r
(cÚ¡ *
u£r
, cÚ¡ *
ho¡
, cÚ¡ *
addr
,

215 cÚ¡ *
·‰”n
)

217 *
p
, *
·t
;

218 
»t
;

220 ià((
p
 = 
	`¡rchr
(
·‰”n
,'@')è=ğ
NULL
)

221  
	`m©ch_·‰”n
(
u£r
, 
·‰”n
);

223 
·t
 = 
	`x¡rdup
(
·‰”n
);

224 
p
 = 
	`¡rchr
(
·t
, '@');

225 *
p
++ = '\0';

227 ià((
»t
 = 
	`m©ch_·‰”n
(
u£r
, 
·t
)) == 1)

228 
»t
 = 
	`m©ch_ho¡_ªd_
(
ho¡
, 
addr
, 
p
);

229 
	`xä“
(
·t
);

231  
»t
;

232 
	}
}

238 
	#MAX_PROP
 40

	)

239 
	#SEP
 ","

	)

241 
	$m©ch_li¡
(cÚ¡ *
ş›Á
, cÚ¡ *
£rv”
, 
u_št
 *
Ãxt
)

243 *
¥rİo§ls
[
MAX_PROP
];

244 *
c
, *
s
, *
p
, *
»t
, *
ı
, *
¥
;

245 
i
, 
j
, 
Årİo§ls
;

247 
c
 = 
ı
 = 
	`x¡rdup
(
ş›Á
);

248 
s
 = 
¥
 = 
	`x¡rdup
(
£rv”
);

250 (
p
 = 
	`¡r£p
(&
¥
, 
SEP
)), 
i
=0;… && *p != '\0';

251 (
p
 = 
	`¡r£p
(&
¥
, 
SEP
)), 
i
++) {

252 ià(
i
 < 
MAX_PROP
)

253 
¥rİo§ls
[
i
] = 
p
;

257 
Årİo§ls
 = 
i
;

259 (
p
 = 
	`¡r£p
(&
ı
, 
SEP
)), 
i
=0;… && *p != '\0';

260 (
p
 = 
	`¡r£p
(&
ı
, 
SEP
)), 
i
++) {

261 
j
 = 0; j < 
Årİo§ls
; j++) {

262 ià(
	`¡rcmp
(
p
, 
¥rİo§ls
[
j
]) == 0) {

263 
»t
 = 
	`x¡rdup
(
p
);

264 ià(
Ãxt
 !ğ
NULL
)

265 *
Ãxt
 = (
ı
 =ğ
NULL
) ?

266 
	`¡¾’
(
c
è: (
u_št
)(
ı
 - c);

267 
	`xä“
(
c
);

268 
	`xä“
(
s
);

269  
»t
;

273 ià(
Ãxt
 !ğ
NULL
)

274 *
Ãxt
 = 
	`¡¾’
(
c
);

275 
	`xä“
(
c
);

276 
	`xä“
(
s
);

277  
NULL
;

278 
	}
}

	@sftp-server/match.h

14 #iâdeà
MATCH_H


15 
	#MATCH_H


	)

17 
m©ch_·‰”n
(const *, const *);

18 
m©ch_·‰”n_li¡
(cÚ¡ *, cÚ¡ *, 
u_št
, );

19 
m©ch_ho¡Çme
(cÚ¡ *, cÚ¡ *, 
u_št
);

20 
m©ch_ho¡_ªd_
(const *, const *, const *);

21 
m©ch_u£r
(const *, const *, const *, const *);

22 *
m©ch_li¡
(cÚ¡ *, cÚ¡ *, 
u_št
 *);

25 
addr_m©ch_li¡
(const *, const *);

26 
addr_m©ch_cidr_li¡
(const *, const *);

	@sftp-server/misc.c

27 
	~"šşudes.h
"

29 
	~<sys/ty³s.h
>

30 
	~<sys/ioùl.h
>

31 
	~<sys/sock‘.h
>

32 
	~<sys/·¿m.h
>

34 
	~<¡d¬g.h
>

35 
	~<¡dio.h
>

36 
	~<¡dlib.h
>

37 
	~<¡ršg.h
>

38 
	~<uni¡d.h
>

40 
	~<Ãtš‘/š.h
>

41 
	~<Ãtš‘/tı.h
>

43 
	~<”ºo.h
>

44 
	~<fú.h
>

45 
	~<Ãtdb.h
>

46 #ifdeà
HAVE_PATHS_H


47 
	~<·ths.h
>

48 
	~<pwd.h
>

50 #ifdeà
SSH_TUN_OPENBSD


51 
	~<Ãt/if.h
>

54 
	~"xm®loc.h
"

55 
	~"misc.h
"

56 
	~"log.h
"

57 
	~"ssh.h
"

61 
	$chİ
(*
s
)

63 *
t
 = 
s
;

64 *
t
) {

65 ià(*
t
 == '\n' || *t == '\r') {

66 *
t
 = '\0';

67  
s
;

69 
t
++;

71  
s
;

73 
	}
}

77 
	$£t_nÚblock
(
fd
)

79 
v®
;

81 
v®
 = 
	`fú
(
fd
, 
F_GETFL
, 0);

82 ià(
v®
 < 0) {

83 
	`”rÜ
("fú(%d, F_GETFL, 0): %s", 
fd
, 
	`¡»¼Ü
(
”ºo
));

86 ià(
v®
 & 
O_NONBLOCK
) {

87 
	`debug3
("fd %d i O_NONBLOCK", 
fd
);

90 
	`debug2
("fd %d s‘tšg O_NONBLOCK", 
fd
);

91 
v®
 |ğ
O_NONBLOCK
;

92 ià(
	`fú
(
fd
, 
F_SETFL
, 
v®
) == -1) {

93 
	`debug
("fú(%d, F_SETFL, O_NONBLOCK): %s", 
fd
,

94 
	`¡»¼Ü
(
”ºo
));

98 
	}
}

101 
	$un£t_nÚblock
(
fd
)

103 
v®
;

105 
v®
 = 
	`fú
(
fd
, 
F_GETFL
, 0);

106 ià(
v®
 < 0) {

107 
	`”rÜ
("fú(%d, F_GETFL, 0): %s", 
fd
, 
	`¡»¼Ü
(
”ºo
));

110 ià(!(
v®
 & 
O_NONBLOCK
)) {

111 
	`debug3
("fd %d i nÙ O_NONBLOCK", 
fd
);

114 
	`debug
("fd %d cË¬šg O_NONBLOCK", 
fd
);

115 
v®
 &ğ~
O_NONBLOCK
;

116 ià(
	`fú
(
fd
, 
F_SETFL
, 
v®
) == -1) {

117 
	`debug
("fcntl(%d, F_SETFL, ~O_NONBLOCK): %s",

118 
fd
, 
	`¡»¼Ü
(
”ºo
));

122 
	}
}

125 
	$ssh_gai_¡»¼Ü
(
ga›¼
)

127 ià(
ga›¼
 =ğ
EAI_SYSTEM
)

128  
	`¡»¼Ü
(
”ºo
);

129  
	`gai_¡»¼Ü
(
ga›¼
);

130 
	}
}

134 
	$£t_nod–ay
(
fd
)

136 
İt
;

137 
sockËn_t
 
İ’
;

139 
İ’
 =  
İt
;

140 ià(
	`g‘sockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
, &
İt
, &
İ’
) == -1) {

141 
	`debug
("g‘sockİˆTCP_NODELAY: %.100s", 
	`¡»¼Ü
(
”ºo
));

144 ià(
İt
 == 1) {

145 
	`debug2
("fd %d i TCP_NODELAY", 
fd
);

148 
İt
 = 1;

149 
	`debug2
("fd %d s‘tšg TCP_NODELAY", 
fd
);

150 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
, &
İt
,  opt) == -1)

151 
	`”rÜ
("£tsockİˆTCP_NODELAY: %.100s", 
	`¡»¼Ü
(
”ºo
));

152 
	}
}

155 
	#WHITESPACE
 " \t\r\n"

	)

156 
	#QUOTE
 "\""

	)

160 
	$¡rd–im
(**
s
)

162 *
Şd
;

163 
w¥aû
 = 0;

165 ià(*
s
 =ğ
NULL
)

166  
NULL
;

168 
Şd
 = *
s
;

170 *
s
 = 
	`¡½brk
(*s, 
WHITESPACE
 
QUOTE
 "=");

171 ià(*
s
 =ğ
NULL
)

172  (
Şd
);

174 ià(*
s
[0] == '\"') {

175 
	`memmove
(*
s
, * + 1, 
	`¡¾’
(*s));

177 ià((*
s
 = 
	`¡½brk
(*s, 
QUOTE
)è=ğ
NULL
) {

178  (
NULL
);

180 *
s
[0] = '\0';

181  (
Şd
);

186 ià(*
s
[0] == '=')

187 
w¥aû
 = 1;

188 *
s
[0] = '\0';

191 *
s
 +ğ
	`¡r¥n
(* + 1, 
WHITESPACE
) + 1;

192 ià(*
s
[0] =ğ'=' && !
w¥aû
)

193 *
s
 +ğ
	`¡r¥n
(* + 1, 
WHITESPACE
) + 1;

195  (
Şd
);

196 
	}
}

198 
·sswd
 *

199 
	$pwcİy
(
·sswd
 *
pw
)

201 
·sswd
 *
cİy
 = 
	`xÿÎoc
(1, (*copy));

203 
cİy
->
pw_Çme
 = 
	`x¡rdup
(
pw
->pw_name);

204 
cİy
->
pw_·sswd
 = 
	`x¡rdup
(
pw
->pw_passwd);

205 #ifdeà
HAVE_GECOS


206 
cİy
->
pw_gecos
 = 
	`x¡rdup
(
pw
->pw_gecos);

208 
cİy
->
pw_uid
 = 
pw
->pw_uid;

209 
cİy
->
pw_gid
 = 
pw
->pw_gid;

210 #ifdeà
HAVE_PW_EXPIRE_IN_PASSWD


211 
cİy
->
pw_expœe
 = 
pw
->pw_expire;

213 #ifdeà
HAVE_PW_CHANGE_IN_PASSWD


214 
cİy
->
pw_chªge
 = 
pw
->pw_change;

216 #ifdeà
HAVE_PW_CLASS_IN_PASSWD


217 
cİy
->
pw_şass
 = 
	`x¡rdup
(
pw
->pw_class);

219 
cİy
->
pw_dœ
 = 
	`x¡rdup
(
pw
->pw_dir);

220 
cİy
->
pw_sh–l
 = 
	`x¡rdup
(
pw
->pw_shell);

221  
cİy
;

222 
	}
}

230 
	$a2pÜt
(cÚ¡ *
s
)

232 
pÜt
;

233 cÚ¡ *
”r¡r
;

235 
pÜt
 = 
	`¡¹Úum
(
s
, 0, 65535, &
”r¡r
);

236 ià(
”r¡r
 !ğ
NULL
)

238  ()
pÜt
;

239 
	}
}

242 
	$a2tun
(cÚ¡ *
s
, *
»mÙe
)

244 cÚ¡ *
”r¡r
 = 
NULL
;

245 *
¥
, *
•
;

246 
tun
;

248 ià(
»mÙe
 !ğ
NULL
) {

249 *
»mÙe
 = 
SSH_TUNID_ANY
;

250 
¥
 = 
	`x¡rdup
(
s
);

251 ià((
•
 = 
	`¡rchr
(
¥
, ':')è=ğ
NULL
) {

252 
	`xä“
(
¥
);

253  (
	`a2tun
(
s
, 
NULL
));

255 
•
[0] = '\0';ƒp++;

256 *
»mÙe
 = 
	`a2tun
(
•
, 
NULL
);

257 
tun
 = 
	`a2tun
(
¥
, 
NULL
);

258 
	`xä“
(
¥
);

259  (*
»mÙe
 =ğ
SSH_TUNID_ERR
 ? *»mÙ: 
tun
);

262 ià(
	`¡rÿ£cmp
(
s
, "any") == 0)

263  (
SSH_TUNID_ANY
);

265 
tun
 = 
	`¡¹Úum
(
s
, 0, 
SSH_TUNID_MAX
, &
”r¡r
);

266 ià(
”r¡r
 !ğ
NULL
)

267  (
SSH_TUNID_ERR
);

269  (
tun
);

270 
	}
}

272 
	#SECONDS
 1

	)

273 
	#MINUTES
 (
SECONDS
 * 60)

	)

274 
	#HOURS
 (
MINUTES
 * 60)

	)

275 
	#DAYS
 (
HOURS
 * 24)

	)

276 
	#WEEKS
 (
DAYS
 * 7)

	)

300 
	$cÚvtime
(cÚ¡ *
s
)

302 
tÙ®
, 
£cs
;

303 cÚ¡ *
p
;

304 *
’dp
;

306 
”ºo
 = 0;

307 
tÙ®
 = 0;

308 
p
 = 
s
;

310 ià(
p
 =ğ
NULL
 || *p == '\0')

313 *
p
) {

314 
£cs
 = 
	`¡¹Ş
(
p
, &
’dp
, 10);

315 ià(
p
 =ğ
’dp
 ||

316 (
”ºo
 =ğ
ERANGE
 && (
£cs
 =ğ
LONG_MIN
 || sec =ğ
LONG_MAX
)) ||

317 
£cs
 < 0)

320 *
’dp
++) {

322 
’dp
--;

329 
£cs
 *ğ
MINUTES
;

333 
£cs
 *ğ
HOURS
;

337 
£cs
 *ğ
DAYS
;

341 
£cs
 *ğ
WEEKS
;

346 
tÙ®
 +ğ
£cs
;

347 ià(
tÙ®
 < 0)

349 
p
 = 
’dp
;

352  
tÙ®
;

353 
	}
}

360 
	$put_ho¡_pÜt
(cÚ¡ *
ho¡
, 
u_shÜt
 
pÜt
)

362 *
ho¡¡r
;

364 ià(
pÜt
 =ğ0 ||…Üˆ=ğ
SSH_DEFAULT_PORT
)

365 (
	`x¡rdup
(
ho¡
));

366 ià(
	`a¥rštf
(&
ho¡¡r
, "[%s]:%d", 
ho¡
, ()
pÜt
) < 0)

367 
	`çl
("put_ho¡_pÜt:‡¥rštf: %s", 
	`¡»¼Ü
(
”ºo
));

368 
	`debug3
("put_ho¡_pÜt: %s", 
ho¡¡r
);

369  
ho¡¡r
;

370 
	}
}

380 
	$hpd–im
(**
ı
)

382 *
s
, *
Şd
;

384 ià(
ı
 =ğ
NULL
 || *cp == NULL)

385  
NULL
;

387 
Şd
 = 
s
 = *
ı
;

388 ià(*
s
 == '[') {

389 ià((
s
 = 
	`¡rchr
(s, ']')è=ğ
NULL
)

390  
NULL
;

392 
s
++;

393 } ià((
s
 = 
	`¡½brk
(s, ":/")è=ğ
NULL
)

394 
s
 = *
ı
 + 
	`¡¾’
(*cp);

396 *
s
) {

398 *
ı
 = 
NULL
;

403 *
s
 = '\0';

404 *
ı
 = 
s
 + 1;

408  
NULL
;

411  
Şd
;

412 
	}
}

415 
	$ş—nho¡Çme
(*
ho¡
)

417 ià(*
ho¡
 =ğ'[' && ho¡[
	`¡¾’
(host) - 1] == ']') {

418 
ho¡
[
	`¡¾’
(host) - 1] = '\0';

419  (
ho¡
 + 1);

421  
ho¡
;

422 
	}
}

425 
	$cŞÚ
(*
ı
)

427 
æag
 = 0;

429 ià(*
ı
 == ':')

431 ià(*
ı
 == '[')

432 
æag
 = 1;

434 ; *
ı
; ++cp) {

435 ià(*
ı
 == '@' && *(cp+1) == '[')

436 
æag
 = 1;

437 ià(*
ı
 =ğ']' && *(ı+1è=ğ':' && 
æag
)

438  (
ı
+1);

439 ià(*
ı
 =ğ':' && !
æag
)

440  (
ı
);

441 ià(*
ı
 == '/')

445 
	}
}

449 
	$add¬gs
(
¬gli¡
 *
¬gs
, *
fmt
, ...)

451 
va_li¡
 
­
;

452 *
ı
;

453 
u_št
 
ÇÎoc
;

454 
r
;

456 
	`va_¡¬t
(
­
, 
fmt
);

457 
r
 = 
	`va¥rštf
(&
ı
, 
fmt
, 
­
);

458 
	`va_’d
(
­
);

459 ià(
r
 == -1)

460 
	`çl
("addargs:‡rgumentoo†ong");

462 
ÇÎoc
 = 
¬gs
->nalloc;

463 ià(
¬gs
->
li¡
 =ğ
NULL
) {

464 
ÇÎoc
 = 32;

465 
¬gs
->
num
 = 0;

466 } ià(
¬gs
->
num
+2 >ğ
ÇÎoc
)

467 
ÇÎoc
 *= 2;

469 
¬gs
->
li¡
 = 
	`x»®loc
×rgs->li¡, 
ÇÎoc
, (*));

470 
¬gs
->
ÇÎoc
 =‚alloc;

471 
¬gs
->
li¡
[¬gs->
num
++] = 
ı
;

472 
¬gs
->
li¡
[¬gs->
num
] = 
NULL
;

473 
	}
}

476 
	$»¶aû¬g
(
¬gli¡
 *
¬gs
, 
u_št
 
which
, *
fmt
, ...)

478 
va_li¡
 
­
;

479 *
ı
;

480 
r
;

482 
	`va_¡¬t
(
­
, 
fmt
);

483 
r
 = 
	`va¥rštf
(&
ı
, 
fmt
, 
­
);

484 
	`va_’d
(
­
);

485 ià(
r
 == -1)

486 
	`çl
("replacearg:‡rgumentoo†ong");

488 ià(
which
 >ğ
¬gs
->
num
)

489 
	`çl
("replacearg:riedo„eplace invalid‡rg %d >= %d",

490 
which
, 
¬gs
->
num
);

491 
	`xä“
(
¬gs
->
li¡
[
which
]);

492 
¬gs
->
li¡
[
which
] = 
ı
;

493 
	}
}

496 
	$ä“¬gs
(
¬gli¡
 *
¬gs
)

498 
u_št
 
i
;

500 ià(
¬gs
->
li¡
 !ğ
NULL
) {

501 
i
 = 0; i < 
¬gs
->
num
; i++)

502 
	`xä“
(
¬gs
->
li¡
[
i
]);

503 
	`xä“
(
¬gs
->
li¡
);

504 
¬gs
->
ÇÎoc
 =‡rgs->
num
 = 0;

505 
¬gs
->
li¡
 = 
NULL
;

507 
	}
}

514 
	$tde_ex·nd_f’ame
(cÚ¡ *
f’ame
, 
uid_t
 
uid
)

516 cÚ¡ *
·th
;

517 
u£r
[128], 
»t
[
MAXPATHLEN
];

518 
·sswd
 *
pw
;

519 
u_št
 
Ën
, 
¦ash
;

521 ià(*
f’ame
 != '~')

522  (
	`x¡rdup
(
f’ame
));

523 
f’ame
++;

525 
·th
 = 
	`¡rchr
(
f’ame
, '/');

526 ià(
·th
 !ğ
NULL
 &&…©h > 
f’ame
) {

527 
¦ash
 = 
·th
 - 
f’ame
;

528 ià(
¦ash
 > (
u£r
) - 1)

529 
	`çl
("tilde_expand_filename: ~usernameoo†ong");

530 
	`memıy
(
u£r
, 
f’ame
, 
¦ash
);

531 
u£r
[
¦ash
] = '\0';

532 ià((
pw
 = 
	`g‘pwÇm
(
u£r
)è=ğ
NULL
)

533 
	`çl
("tde_ex·nd_f’ame: NØsuch u£¸%s", 
u£r
);

534 } ià((
pw
 = 
	`g‘pwuid
(
uid
)è=ğ
NULL
)

535 
	`çl
("tde_ex·nd_f’ame: NØsuch uid %ld", ()
uid
);

537 ià(
	`¡¾ıy
(
»t
, 
pw
->
pw_dœ
, (ret)) >= (ret))

538 
	`çl
("tilde_expand_filename: Pathoo†ong");

541 
Ën
 = 
	`¡¾’
(
pw
->
pw_dœ
);

542 ià((
Ën
 =ğ0 || 
pw
->
pw_dœ
[len - 1] != '/') &&

543 
	`¡¾ÿt
(
»t
, "/", (ret)) >= (ret))

544 
	`çl
("tilde_expand_filename: Pathoo†ong");

547 ià(
·th
 !ğ
NULL
)

548 
f’ame
 = 
·th
 + 1;

549 ià(
	`¡¾ÿt
(
»t
, 
f’ame
, (ret)) >= (ret))

550 
	`çl
("tilde_expand_filename: Pathoo†ong");

552  (
	`x¡rdup
(
»t
));

553 
	}
}

562 
	$³rûÁ_ex·nd
(cÚ¡ *
¡ršg
, ...)

564 
	#EXPAND_MAX_KEYS
 16

	)

565 
u_št
 
num_keys
, 
i
, 
j
;

567 cÚ¡ *
key
;

568 cÚ¡ *
»¶
;

569 } 
keys
[
EXPAND_MAX_KEYS
];

570 
buf
[4096];

571 
va_li¡
 
­
;

574 
	`va_¡¬t
(
­
, 
¡ršg
);

575 
num_keys
 = 0;‚um_key < 
EXPAND_MAX_KEYS
;‚um_keys++) {

576 
keys
[
num_keys
].
key
 = 
	`va_¬g
(
­
, *);

577 ià(
keys
[
num_keys
].
key
 =ğ
NULL
)

579 
keys
[
num_keys
].
»¶
 = 
	`va_¬g
(
­
, *);

580 ià(
keys
[
num_keys
].
»¶
 =ğ
NULL
)

581 
	`çl
("%s: NULL„•Ïûm’t", 
__func__
);

583 ià(
num_keys
 =ğ
EXPAND_MAX_KEYS
 && 
	`va_¬g
(
­
, *è!ğ
NULL
)

584 
	`çl
("%s:oØmªy keys", 
__func__
);

585 
	`va_’d
(
­
);

588 *
buf
 = '\0';

589 
i
 = 0; *
¡ršg
 != '\0'; string++) {

590 ià(*
¡ršg
 != '%') {

591 
­³nd
:

592 
buf
[
i
++] = *
¡ršg
;

593 ià(
i
 >ğ(
buf
))

594 
	`çl
("%s: sŒšgoØlÚg", 
__func__
);

595 
buf
[
i
] = '\0';

598 
¡ršg
++;

600 ià(*
¡ršg
 == '%')

601 
­³nd
;

602 
j
 = 0; j < 
num_keys
; j++) {

603 ià(
	`¡rchr
(
keys
[
j
].
key
, *
¡ršg
è!ğ
NULL
) {

604 
i
 = 
	`¡¾ÿt
(
buf
, 
keys
[
j
].
»¶
, (buf));

605 ià(
i
 >ğ(
buf
))

606 
	`çl
("%s: sŒšgoØlÚg", 
__func__
);

610 ià(
j
 >ğ
num_keys
)

611 
	`çl
("%s: unknowÀkey %%%c", 
__func__
, *
¡ršg
);

613  (
	`x¡rdup
(
buf
));

614 #undeà
EXPAND_MAX_KEYS


615 
	}
}

622 
	$»ad_keyfe_lše
(
FILE
 *
f
, cÚ¡ *
f’ame
, *
buf
, 
size_t
 
bufsz
,

623 
u_lÚg
 *
lš’o
)

625 
	`fg‘s
(
buf
, 
bufsz
, 
f
è!ğ
NULL
) {

626 ià(
buf
[0] == '\0')

628 (*
lš’o
)++;

629 ià(
buf
[
	`¡¾’
(bufè- 1] =ğ'\n' || 
	`ãof
(
f
)) {

632 
	`debug
("%s: % lš%luƒxûed sizlim™", 
__func__
,

633 
f’ame
, *
lš’o
);

635 
	`fg‘c
(
f
è!ğ'\n' && !
	`ãof
(f))

640 
	}
}

643 
	$tun_İ’
(
tun
, 
mode
)

645 #ià
	`defšed
(
CUSTOM_SYS_TUN_OPEN
)

646  (
	`sys_tun_İ’
(
tun
, 
mode
));

647 #–ià
	`defšed
(
SSH_TUN_OPENBSD
)

648 
iäeq
 
iä
;

649 
Çme
[100];

650 
fd
 = -1, 
sock
;

653 ià(
tun
 <ğ
SSH_TUNID_MAX
) {

654 
	`¢´štf
(
Çme
, Òame), "/dev/tun%d", 
tun
);

655 
fd
 = 
	`İ’
(
Çme
, 
O_RDWR
);

656 } ià(
tun
 =ğ
SSH_TUNID_ANY
) {

657 
tun
 = 100;un >= 0;un--) {

658 
	`¢´štf
(
Çme
, Òame), "/dev/tun%d", 
tun
);

659 ià((
fd
 = 
	`İ’
(
Çme
, 
O_RDWR
)) >= 0)

663 
	`debug
("%s: inv®iduÂ– %u", 
__func__
, 
tun
);

667 ià(
fd
 < 0) {

668 
	`debug
("%s: % İ’ faed: %s", 
__func__
, 
Çme
, 
	`¡»¼Ü
(
”ºo
));

672 
	`debug
("%s: % mod%d fd %d", 
__func__
, 
Çme
, 
mode
, 
fd
);

675 
	`¢´štf
(
iä
.
iä_Çme
, (iä.iä_Çme), "tun%d", 
tun
);

676 ià((
sock
 = 
	`sock‘
(
PF_UNIX
, 
SOCK_STREAM
, 0)) == -1)

677 
çed
;

679 ià(
	`ioùl
(
sock
, 
SIOCGIFFLAGS
, &
iä
) == -1)

680 
çed
;

683 
iä
.
iä_æags
 &ğ~
IFF_UP
;

684 ià(
mode
 =ğ
SSH_TUNMODE_ETHERNET
)

685 
iä
.
iä_æags
 |ğ
IFF_LINK0
;

687 
iä
.
iä_æags
 &ğ~
IFF_LINK0
;

688 ià(
	`ioùl
(
sock
, 
SIOCSIFFLAGS
, &
iä
) == -1)

689 
çed
;

692 
iä
.
iä_æags
 |ğ
IFF_UP
;

693 ià(
	`ioùl
(
sock
, 
SIOCSIFFLAGS
, &
iä
) == -1)

694 
çed
;

696 
	`şo£
(
sock
);

697  (
fd
);

699 
çed
:

700 ià(
fd
 >= 0)

701 
	`şo£
(
fd
);

702 ià(
sock
 >= 0)

703 
	`şo£
(
sock
);

704 
	`debug
("%s: faedØ£ˆ% mod%d: %s", 
__func__
, 
Çme
,

705 
mode
, 
	`¡»¼Ü
(
”ºo
));

708 
	`”rÜ
("Tunnel interfaces‡re‚ot supported onhis…latform");

711 
	}
}

714 
	$§n™i£_¡dfd
()

716 
nuÎfd
, 
dupfd
;

718 ià((
nuÎfd
 = 
dupfd
 = 
	`İ’
(
_PATH_DEVNULL
, 
O_RDWR
)) == -1) {

719 
	`årštf
(
¡d”r
, "Couldn't open /dev/null: %s\n",

720 
	`¡»¼Ü
(
”ºo
));

721 
	`ex™
(1);

723 ++
dupfd
 <= 2) {

725 ià(
	`fú
(
dupfd
, 
F_GETFL
, 0) >= 0)

727 ià(
	`dup2
(
nuÎfd
, 
dupfd
) == -1) {

728 
	`årštf
(
¡d”r
, "dup2: %s\n", 
	`¡»¼Ü
(
”ºo
));

729 
	`ex™
(1);

732 ià(
nuÎfd
 > 2)

733 
	`şo£
(
nuÎfd
);

734 
	}
}

737 
	$tohex
(cÚ¡ *
vp
, 
size_t
 
l
)

739 cÚ¡ 
u_ch¬
 *
p
 = (cÚ¡ u_ch¬ *)
vp
;

740 
b
[3], *
r
;

741 
size_t
 
i
, 
hl
;

743 ià(
l
 > 65536)

744  
	`x¡rdup
("tohex:†ength > 65536");

746 
hl
 = 
l
 * 2 + 1;

747 
r
 = 
	`xÿÎoc
(1, 
hl
);

748 
i
 = 0; i < 
l
; i++) {

749 
	`¢´štf
(
b
, (b), "%02x", 
p
[
i
]);

750 
	`¡¾ÿt
(
r
, 
b
, 
hl
);

752  (
r
);

753 
	}
}

755 
u_št64_t


756 
	$g‘_u64
(cÚ¡ *
vp
)

758 cÚ¡ 
u_ch¬
 *
p
 = (cÚ¡ u_ch¬ *)
vp
;

759 
u_št64_t
 
v
;

761 
v
 = (
u_št64_t
)
p
[0] << 56;

762 
v
 |ğ(
u_št64_t
)
p
[1] << 48;

763 
v
 |ğ(
u_št64_t
)
p
[2] << 40;

764 
v
 |ğ(
u_št64_t
)
p
[3] << 32;

765 
v
 |ğ(
u_št64_t
)
p
[4] << 24;

766 
v
 |ğ(
u_št64_t
)
p
[5] << 16;

767 
v
 |ğ(
u_št64_t
)
p
[6] << 8;

768 
v
 |ğ(
u_št64_t
)
p
[7];

770  (
v
);

771 
	}
}

773 
u_št32_t


774 
	$g‘_u32
(cÚ¡ *
vp
)

776 cÚ¡ 
u_ch¬
 *
p
 = (cÚ¡ u_ch¬ *)
vp
;

777 
u_št32_t
 
v
;

779 
v
 = (
u_št32_t
)
p
[0] << 24;

780 
v
 |ğ(
u_št32_t
)
p
[1] << 16;

781 
v
 |ğ(
u_št32_t
)
p
[2] << 8;

782 
v
 |ğ(
u_št32_t
)
p
[3];

784  (
v
);

785 
	}
}

787 
u_št16_t


788 
	$g‘_u16
(cÚ¡ *
vp
)

790 cÚ¡ 
u_ch¬
 *
p
 = (cÚ¡ u_ch¬ *)
vp
;

791 
u_št16_t
 
v
;

793 
v
 = (
u_št16_t
)
p
[0] << 8;

794 
v
 |ğ(
u_št16_t
)
p
[1];

796  (
v
);

797 
	}
}

800 
	$put_u64
(*
vp
, 
u_št64_t
 
v
)

802 
u_ch¬
 *
p
 = (u_ch¬ *)
vp
;

804 
p
[0] = (
u_ch¬
)(
v
 >> 56) & 0xff;

805 
p
[1] = (
u_ch¬
)(
v
 >> 48) & 0xff;

806 
p
[2] = (
u_ch¬
)(
v
 >> 40) & 0xff;

807 
p
[3] = (
u_ch¬
)(
v
 >> 32) & 0xff;

808 
p
[4] = (
u_ch¬
)(
v
 >> 24) & 0xff;

809 
p
[5] = (
u_ch¬
)(
v
 >> 16) & 0xff;

810 
p
[6] = (
u_ch¬
)(
v
 >> 8) & 0xff;

811 
p
[7] = (
u_ch¬
)
v
 & 0xff;

812 
	}
}

815 
	$put_u32
(*
vp
, 
u_št32_t
 
v
)

817 
u_ch¬
 *
p
 = (u_ch¬ *)
vp
;

819 
p
[0] = (
u_ch¬
)(
v
 >> 24) & 0xff;

820 
p
[1] = (
u_ch¬
)(
v
 >> 16) & 0xff;

821 
p
[2] = (
u_ch¬
)(
v
 >> 8) & 0xff;

822 
p
[3] = (
u_ch¬
)
v
 & 0xff;

823 
	}
}

827 
	$put_u16
(*
vp
, 
u_št16_t
 
v
)

829 
u_ch¬
 *
p
 = (u_ch¬ *)
vp
;

831 
p
[0] = (
u_ch¬
)(
v
 >> 8) & 0xff;

832 
p
[1] = (
u_ch¬
)
v
 & 0xff;

833 
	}
}

836 
	$ms_subŒaù_diff
(
timev®
 *
¡¬t
, *
ms
)

838 
timev®
 
diff
, 
fšish
;

840 
	`g‘timeofday
(&
fšish
, 
NULL
);

841 
	`tim”sub
(&
fšish
, 
¡¬t
, &
diff
);

842 *
ms
 -ğ(
diff
.
tv_£c
 * 1000è+ (diff.
tv_u£c
 / 1000);

843 
	}
}

846 
	$ms_to_timev®
(
timev®
 *
tv
, 
ms
)

848 ià(
ms
 < 0)

849 
ms
 = 0;

850 
tv
->
tv_£c
 = 
ms
 / 1000;

851 
tv
->
tv_u£c
 = (
ms
 % 1000) * 1000;

852 
	}
}

855 
	$sock_£t_v6Úly
(
s
)

857 #ifdeà
IPV6_V6ONLY


858 
Ú
 = 1;

860 
	`debug3
("%s: s‘ sock‘ %d IPV6_V6ONLY", 
__func__
, 
s
);

861 ià(
	`£tsockİt
(
s
, 
IPPROTO_IPV6
, 
IPV6_V6ONLY
, &
Ú
, (on)) == -1)

862 
	`”rÜ
("£tsockİˆIPV6_V6ONLY: %s", 
	`¡»¼Ü
(
”ºo
));

864 
	}
}

	@sftp-server/misc.h

15 #iâdeà
_MISC_H


16 
	#_MISC_H


	)

20 *
chİ
(*);

21 *
¡rd–im
(**);

22 
£t_nÚblock
();

23 
un£t_nÚblock
();

24 
£t_nod–ay
();

25 
a2pÜt
(const *);

26 
a2tun
(const *, *);

27 *
put_ho¡_pÜt
(cÚ¡ *, 
u_shÜt
);

28 *
hpd–im
(**);

29 *
ş—nho¡Çme
(*);

30 *
cŞÚ
(*);

31 
cÚvtime
(const *);

32 *
tde_ex·nd_f’ame
(cÚ¡ *, 
uid_t
);

33 *
	$³rûÁ_ex·nd
(cÚ¡ *, ...è
	`__©Œibu‹__
((
__£Áš–__
));

34 *
	`tohex
(cÚ¡ *, 
size_t
);

35 
	`§n™i£_¡dfd
();

36 
	`ms_subŒaù_diff
(
timev®
 *, *);

37 
	`ms_to_timev®
(
timev®
 *, );

38 
	`sock_£t_v6Úly
();

40 
·sswd
 *
	`pwcİy
(passwd *);

41 cÚ¡ *
	`ssh_gai_¡»¼Ü
();

43 
¬gli¡
 
	t¬gli¡
;

44 
	s¬gli¡
 {

45 **
li¡
;

46 
u_št
 
num
;

47 
u_št
 
ÇÎoc
;

49 
	$add¬gs
(
¬gli¡
 *, *, ...)

50 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 2, 3)));

51 
	$»¶aû¬g
(
¬gli¡
 *, 
u_št
, *, ...)

52 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 3, 4)));

53 
	`ä“¬gs
(
¬gli¡
 *);

55 
	`tun_İ’
(, );

58 
	#SSH_TUNMODE_NO
 0x00

	)

59 
	#SSH_TUNMODE_POINTOPOINT
 0x01

	)

60 
	#SSH_TUNMODE_ETHERNET
 0x02

	)

61 
	#SSH_TUNMODE_DEFAULT
 
SSH_TUNMODE_POINTOPOINT


	)

62 
	#SSH_TUNMODE_YES
 (
SSH_TUNMODE_POINTOPOINT
|
SSH_TUNMODE_ETHERNET
)

	)

64 
	#SSH_TUNID_ANY
 0x7fffffff

	)

65 
	#SSH_TUNID_ERR
 (
SSH_TUNID_ANY
 - 1)

	)

66 
	#SSH_TUNID_MAX
 (
SSH_TUNID_ANY
 - 2)

	)

69 
u_št64_t
 
	$g‘_u64
(const *)

70 
	`__©Œibu‹__
((
	`__bounded__
Ğ
__mšby‹s__
, 1, 8)));

71 
u_št32_t
 
	$g‘_u32
(const *)

72 
	`__©Œibu‹__
((
	`__bounded__
Ğ
__mšby‹s__
, 1, 4)));

73 
u_št16_t
 
	$g‘_u16
(const *)

74 
	`__©Œibu‹__
((
	`__bounded__
Ğ
__mšby‹s__
, 1, 2)));

75 
	$put_u64
(*, 
u_št64_t
)

76 
	`__©Œibu‹__
((
	`__bounded__
Ğ
__mšby‹s__
, 1, 8)));

77 
	$put_u32
(*, 
u_št32_t
)

78 
	`__©Œibu‹__
((
	`__bounded__
Ğ
__mšby‹s__
, 1, 4)));

79 
	$put_u16
(*, 
u_št16_t
)

80 
	`__©Œibu‹__
((
	`__bounded__
Ğ
__mšby‹s__
, 1, 2)));

85 
	#RP_ECHO
 0x0001

	)

86 
	#RP_ALLOW_STDIN
 0x0002

	)

87 
	#RP_ALLOW_EOF
 0x0004

	)

88 
	#RP_USE_ASKPASS
 0x0008

	)

90 *
	`»ad_·s¥h¿£
(const *, );

91 
	$ask_³rmissiÚ
(cÚ¡ *, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

92 
	`»ad_keyfe_lše
(
FILE
 *, cÚ¡ *, *, 
size_t
, 
u_lÚg
 *);

	@sftp-server/openbsd-compat/base64.h

45 #iâdeà
_BSD_BASE64_H


46 
	#_BSD_BASE64_H


	)

48 
	~"šşudes.h
"

50 #iâdeà
HAVE___B64_NTOP


51 #iâdeà
HAVE_B64_NTOP


52 
b64_Áİ
(
u_ch¬
 cÚ¡ *
¤c
, 
size_t
 
¤ş’gth
, *
rg‘
,

53 
size_t
 
rgsize
);

55 
	#__b64_Áİ
(
a
,
b
,
c
,
d
è
	`b64_Áİ
×,b,c,d)

	)

58 #iâdeà
HAVE___B64_PTON


59 #iâdeà
HAVE_B64_PTON


60 
b64_±Ú
(cÚ¡ *
¤c
, 
u_ch¬
 *
rg‘
, 
size_t
 
rgsize
);

62 
	#__b64_±Ú
(
a
,
b
,
c
è
	`b64_±Ú
×,b,c)

	)

	@sftp-server/openbsd-compat/bsd-cray.h

36 #iâdeà
_BSD_CRAY_H


37 
	#_BSD_CRAY_H


	)

39 #ifdeà
_UNICOS


41 
üay_š™_job
(
·sswd
 *);

42 
üay_job_‹rmš©iÚ_hªdËr
();

43 
üay_logš_çu»
(*, );

44 
üay_acûss_d’›d
(*);

45 
üay_tmpdœ
[];

47 
	#CUSTOM_FAILED_LOGIN
 1

	)

49 #iâdeà
IA_SSHD


50 
	#IA_SSHD
 
IA_LOGIN


	)

52 #iâdeà
MAXHOSTNAMELEN


53 
	#MAXHOSTNAMELEN
 64

	)

55 #iâdeà
_CRAYT3E


56 
	#TIOCGPGRP
 (
tIOC
|20)

	)

	@sftp-server/openbsd-compat/bsd-cygwin_util.h

32 #iâdeà
_BSD_CYGWIN_UTIL_H


33 
	#_BSD_CYGWIN_UTIL_H


	)

35 #ifdeà
HAVE_CYGWIN


37 #undeà
ERROR


39 
	~<wšdows.h
>

40 
	~<sys/cygwš.h
>

41 
	~<io.h
>

43 
bš¬y_İ’
(const *, , ...);

44 
bš¬y_pe
(
fd
[2]);

45 
check_Á£c
(const *);

46 **
ãtch_wšdows_’vœÚm’t
();

47 
ä“_wšdows_’vœÚm’t
(**);

49 
	#İ’
 
bš¬y_İ’


	)

50 
	#pe
 
bš¬y_pe


	)

	@sftp-server/openbsd-compat/bsd-misc.c

18 
	~"šşudes.h
"

20 
	~<sys/ty³s.h
>

21 #ifdeà
HAVE_SYS_SELECT_H


22 
	~<sys/£Ëù.h
>

24 #ifdeà
HAVE_SYS_TIME_H


25 
	~<sys/time.h
>

28 
	~<¡ršg.h
>

29 
	~<sigÇl.h
>

30 
	~<¡dlib.h
>

31 
	~<uni¡d.h
>

32 
	~<fú.h
>

34 
	~"xm®loc.h
"

36 #iâdeà
HAVE___PROGNAME


37 *
	g__´ogÇme
;

44 *
	$ssh_g‘_´ogÇme
(*
¬gv0
)

46 #ifdeà
HAVE___PROGNAME


47 *
__´ogÇme
;

49  
	`x¡rdup
(
__´ogÇme
);

51 *
p
;

53 ià(
¬gv0
 =ğ
NULL
)

55 
p
 = 
	`¡¼chr
(
¬gv0
, '/');

56 ià(
p
 =ğ
NULL
)

57 
p
 = 
¬gv0
;

59 
p
++;

61  (
	`x¡rdup
(
p
));

63 
	}
}

65 #iâdeà
HAVE_SETLOGIN


66 
	$£ogš
(cÚ¡ *
Çme
)

69 
	}
}

72 #iâdeà
HAVE_INNETGR


73 
	$šÃtgr
(cÚ¡ *
Ãtgroup
, cÚ¡ *
ho¡
,

74 cÚ¡ *
u£r
, cÚ¡ *
domaš
)

77 
	}
}

80 #ià!
defšed
(
HAVE_SETEUID
è&& defšed(
HAVE_SETREUID
)

81 
	$£‹uid
(
uid_t
 
euid
)

83  (
	`£Œeuid
(-1, 
euid
));

84 
	}
}

87 #ià!
defšed
(
HAVE_SETEGID
è&& defšed(
HAVE_SETRESGID
)

88 
	$£‹gid
(
uid_t
 
egid
)

90 (
	`£Œesgid
(-1, 
egid
, -1));

91 
	}
}

94 #ià!
defšed
(
HAVE_STRERROR
è&& defšed(
HAVE_SYS_ERRLIST
è&& defšed(
HAVE_SYS_NERR
)

95 cÚ¡ *
	$¡»¼Ü
(
e
)

97 
sys_Ã¼
;

98 *
sys_”¾i¡
[];

100 ià((
e
 >ğ0è&& (< 
sys_Ã¼
))

101  (
sys_”¾i¡
[
e
]);

104 
	}
}

107 #iâdeà
HAVE_UTIMES


108 
	$utimes
(*
f’ame
, 
timev®
 *
tvp
)

110 
utimbuf
 
ub
;

112 
ub
.
aùime
 = 
tvp
[0].
tv_£c
;

113 
ub
.
modtime
 = 
tvp
[1].
tv_£c
;

115  (
	`utime
(
f’ame
, &
ub
));

116 
	}
}

119 #iâdeà
HAVE_TRUNCATE


120 
	$Œunÿ‹
(cÚ¡ *
·th
, 
off_t
 
Ëngth
)

122 
fd
, 
»t
, 
§v”ºo
;

124 
fd
 = 
	`İ’
(
·th
, 
O_WRONLY
);

125 ià(
fd
 < 0)

128 
»t
 = 
	`árunÿ‹
(
fd
, 
Ëngth
);

129 
§v”ºo
 = 
”ºo
;

130 
	`şo£
(
fd
);

131 ià(
»t
 == -1)

132 
”ºo
 = 
§v”ºo
;

134 (
»t
);

135 
	}
}

138 #ià!
defšed
(
HAVE_NANOSLEEP
è&& !defšed(
HAVE_NSLEEP
)

139 
	$Çno¦“p
(cÚ¡ 
time¥ec
 *
»q
, time¥eø*
»m
)

141 
rc
, 
§v”ºo
;

142 
”ºo
;

143 
timev®
 
t¡¬t
, 
t¡İ
, 
Œemaš
, 
time2wa™
;

145 
	`TIMESPEC_TO_TIMEVAL
(&
time2wa™
, 
»q
)

146 (è
	`g‘timeofday
(&
t¡¬t
, 
NULL
);

147 
rc
 = 
	`£Ëù
(0, 
NULL
, NULL, NULL, &
time2wa™
);

148 ià(
rc
 == -1) {

149 
§v”ºo
 = 
”ºo
;

150 (è
	`g‘timeofday
 (&
t¡İ
, 
NULL
);

151 
”ºo
 = 
§v”ºo
;

152 
Œemaš
.
tv_£c
 = 
time2wa™
.tv_sec -

153 (
t¡İ
.
tv_£c
 - 
t¡¬t
.tv_sec);

154 
Œemaš
.
tv_u£c
 = 
time2wa™
.tv_usec -

155 (
t¡İ
.
tv_u£c
 - 
t¡¬t
.tv_usec);

156 
Œemaš
.
tv_£c
 +ğŒemaš.
tv_u£c
 / 1000000L;

157 
Œemaš
.
tv_u£c
 %= 1000000L;

159 
Œemaš
.
tv_£c
 = 0;

160 
Œemaš
.
tv_u£c
 = 0;

162 ià(
»m
 !ğ
NULL
)

163 
	`TIMEVAL_TO_TIMESPEC
(&
Œemaš
, 
»m
)

165 (
rc
);

166 
	}
}

169 #iâdeà
HAVE_TCGETPGRP


170 
pid_t


171 
	$tcg‘pg½
(
fd
)

173 
ùty_pg½
;

175 ià(
	`ioùl
(
fd
, 
TIOCGPGRP
, &
ùty_pg½
) == -1)

178 (
ùty_pg½
);

179 
	}
}

182 #iâdeà
HAVE_TCSENDBREAK


184 
	$tc£ndb»ak
(
fd
, 
du¿tiÚ
)

186 #ià
	`defšed
(
TIOCSBRK
è&& defšed(
TIOCCBRK
)

187 
timev®
 
¦“pytime
;

189 
¦“pytime
.
tv_£c
 = 0;

190 
¦“pytime
.
tv_u£c
 = 400000;

191 ià(
	`ioùl
(
fd
, 
TIOCSBRK
, 0) == -1)

193 ()
	`£Ëù
(0, 0, 0, 0, &
¦“pytime
);

194 ià(
	`ioùl
(
fd
, 
TIOCCBRK
, 0) == -1)

200 
	}
}

233 #iâdeà
HAVE_STRDUP


235 
	$¡rdup
(cÚ¡ *
¡r
)

237 
size_t
 
Ën
;

238 *
ı
;

240 
Ën
 = 
	`¡¾’
(
¡r
) + 1;

241 
ı
 = 
	`m®loc
(
Ën
);

242 ià(
ı
 !ğ
NULL
)

243 (
	`memıy
(
ı
, 
¡r
, 
Ën
));

244  
NULL
;

245 
	}
}

	@sftp-server/openbsd-compat/bsd-misc.h

19 #iâdeà
_BSD_MISC_H


20 
	#_BSD_MISC_H


	)

22 
	~"šşudes.h
"

24 *
ssh_g‘_´ogÇme
(*);

26 #iâdeà
HAVE_SETSID


27 
	#£tsid
(è
	`£g½
(0, 
	`g‘pid
())

	)

30 #iâdeà
HAVE_SETENV


31 
£‹nv
(const *, const *, );

34 #iâdeà
HAVE_SETLOGIN


35 
£ogš
(const *);

38 #iâdeà
HAVE_INNETGR


39 
šÃtgr
(const *, const *, const *, const *);

42 #ià!
defšed
(
HAVE_SETEUID
è&& defšed(
HAVE_SETREUID
)

43 
£‹uid
(
uid_t
);

46 #ià!
defšed
(
HAVE_SETEGID
è&& defšed(
HAVE_SETRESGID
)

47 
£‹gid
(
uid_t
);

50 #ià!
defšed
(
HAVE_STRERROR
è&& defšed(
HAVE_SYS_ERRLIST
è&& defšed(
HAVE_SYS_NERR
)

51 cÚ¡ *
¡»¼Ü
();

55 #iâdeà
HAVE_UTIMES


56 #iâdeà
HAVE_STRUCT_TIMEVAL


57 
	stimev®
 {

58 
	mtv_£c
;

59 
	mtv_u£c
;

63 
utimes
(*, 
timev®
 *);

66 #iâdeà
HAVE_TRUNCATE


67 
Œunÿ‹
 (cÚ¡ *, 
off_t
);

70 #ià!
defšed
(
HAVE_NANOSLEEP
è&& !defšed(
HAVE_NSLEEP
)

71 #iâdeà
HAVE_STRUCT_TIMESPEC


72 
	stime¥ec
 {

73 
time_t
 
	mtv_£c
;

74 
	mtv_n£c
;

77 
Çno¦“p
(cÚ¡ 
time¥ec
 *, timespec *);

80 #iâdeà
HAVE_TCGETPGRP


81 
pid_t
 
tcg‘pg½
();

84 #iâdeà
HAVE_TCSENDBREAK


85 
tc£ndb»ak
(, );

88 #iâdeà
HAVE_UNSETENV


89 
un£‹nv
(const *);

	@sftp-server/openbsd-compat/bsd-nextstep.h

28 #iâdeà
_NEXT_POSIX_H


29 
	#_NEXT_POSIX_H


	)

31 #ifdeà
HAVE_NEXT


32 
	~<sys/dœ.h
>

35 #undeà
NGROUPS_MAX


36 
	#NGROUPS_MAX
 
NGROUPS


	)

39 
	#dœ’t
 
dœeù


	)

42 
pid_t
 
posix_wa™
(*);

43 
	#wa™
(
a
è
	`posix_wa™
×)

	)

46 
pid_t
 
g‘µid
();

47 
vhªgup
();

48 
šÃtgr
(const *, const *, const *, const *);

51 
tcg‘©Œ
(, 
‹rmios
 *);

52 
tc£‰r
(, , cÚ¡ 
‹rmios
 *);

53 
tc£g½
(, 
pid_t
);

54 
¥“d_t
 
cfg‘o¥“d
(cÚ¡ 
‹rmios
 *);

55 
¥“d_t
 
cfg‘i¥“d
(cÚ¡ 
‹rmios
 *);

56 
cf£to¥“d
(
‹rmios
 *, );

57 
cf£ti¥“d
(
‹rmios
 *, );

	@sftp-server/openbsd-compat/bsd-poll.h

30 #ià!
defšed
(
HAVE_POLL
è&& !defšed(
HAVE_POLL_H
)

31 #iâdef 
_COMPAT_POLL_H_


32 
	#_COMPAT_POLL_H_


	)

34 
	spŞlfd
 {

35 
	mfd
;

36 
	mev’ts
;

37 
	m»v’ts
;

38 } 
	tpŞlfd_t
;

40 
	tnfds_t
;

42 
	#POLLIN
 0x0001

	)

43 
	#POLLOUT
 0x0004

	)

44 
	#POLLERR
 0x0008

	)

47 
	#POLLPRI
 0x0002

	)

48 
	#POLLHUP
 0x0010

	)

49 
	#POLLNVAL
 0x0020

	)

50 
	#POLLRDNORM
 0x0040

	)

51 
	#POLLNORM
 
POLLRDNORM


	)

52 
	#POLLWRNORM
 
POLLOUT


	)

53 
	#POLLRDBAND
 0x0080

	)

54 
	#POLLWRBAND
 0x0100

	)

57 
	#INFTIM
 (-1è

	)

59 
pŞl
(
pŞlfd
 *, 
nfds_t
, );

	@sftp-server/openbsd-compat/bsd-statvfs.c

19 
	~"šşudes.h
"

21 
	~<”ºo.h
>

23 #iâdeà
HAVE_STATVFS


24 
	$¡©vfs
(cÚ¡ *
·th
, 
¡©vfs
 *
buf
)

26 
”ºo
 = 
ENOSYS
;

28 
	}
}

31 #iâdeà
HAVE_FSTATVFS


32 
	$f¡©vfs
(
fd
, 
¡©vfs
 *
buf
)

34 
”ºo
 = 
ENOSYS
;

36 
	}
}

	@sftp-server/openbsd-compat/bsd-statvfs.h

19 
	~"šşudes.h
"

21 
	~<sys/ty³s.h
>

23 #ifdeà
HAVE_SYS_STATFS_H


24 
	~<sys/¡©fs.h
>

27 #iâdeà
HAVE_STATVFS


29 #iâdeà
HAVE_FSBLKCNT_T


30 
	tfsblkút_t
;

32 #iâdeà
HAVE_FSFILCNT_T


33 
	tfsfút_t
;

36 #iâdeà
ST_RDONLY


37 
	#ST_RDONLY
 1

	)

39 #iâdeà
ST_NOSUID


40 
	#ST_NOSUID
 2

	)

44 
	s¡©vfs
 {

45 
	mf_bsize
;

46 
	mf_äsize
;

47 
fsblkút_t
 
	mf_blocks
;

49 
fsblkút_t
 
	mf_bä“
;

50 
fsblkút_t
 
	mf_bava
;

52 
fsfút_t
 
	mf_fes
;

53 
fsfút_t
 
	mf_fä“
;

54 
fsfút_t
 
	mf_çva
;

56 
	mf_fsid
;

57 
	mf_æag
;

58 
	mf_Çmemax
;

62 #iâdeà
HAVE_STATVFS


63 
¡©vfs
(const *, statvfs *);

66 #iâdeà
HAVE_FSTATVFS


67 
f¡©vfs
(, 
¡©vfs
 *);

	@sftp-server/openbsd-compat/bsd-waitpid.h

28 #iâdeà
_BSD_WAITPID_H


29 
	#_BSD_WAITPID_H


	)

31 #iâdeà
HAVE_WAITPID


33 #undeà
WIFEXITED


34 #undeà
WIFSTOPPED


35 #undeà
WIFSIGNALED


38 
	#_W_INT
(
w
è(*(*)&(w)è

	)

39 
	#WIFEXITED
(
w
è(!((
	`_W_INT
(w)è& 0377))

	)

40 
	#WIFSTOPPED
(
w
è((
	`_W_INT
(w)è& 0100)

	)

41 
	#WIFSIGNALED
(
w
è(!
	`WIFEXITED
(wè&& !
	`WIFSTOPPED
(w))

	)

42 
	#WEXITSTATUS
(
w
è()(
	`WIFEXITED
(wè? ((
	`_W_INT
(wè>> 8è& 0377è: -1)

	)

43 
	#WTERMSIG
(
w
è()(
	`WIFSIGNALED
(wè? (
	`_W_INT
(wè& 0177è: -1)

	)

44 
	#WCOREFLAG
 0x80

	)

45 
	#WCOREDUMP
(
w
è((
	`_W_INT
(w)è& 
WCOREFLAG
)

	)

48 
pid_t
 
wa™pid
(, *, );

	@sftp-server/openbsd-compat/fake-rfc2553.h

40 #iâdeà
_FAKE_RFC2553_H


41 
	#_FAKE_RFC2553_H


	)

43 
	~"šşudes.h
"

44 
	~<sys/ty³s.h
>

45 #ià
defšed
(
HAVE_NETDB_H
)

46 
	~<Ãtdb.h
>

52 #iâdeà
HAVE_STRUCT_SOCKADDR_STORAGE


53 
	#_SS_MAXSIZE
 128

	)

54 
	#_SS_PADSIZE
 (
_SS_MAXSIZE
 -  (
sockaddr
))

	)

55 
	ssockaddr_¡Üage
 {

56 
sockaddr
 
	mss_§
;

57 
	m__ss_·d2
[
_SS_PADSIZE
];

59 
	#ss_çmy
 
ss_§
.
§_çmy


	)

62 #iâdeà
IN6_IS_ADDR_LOOPBACK


63 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

64 (((
u_št32_t
 *)(
a
))[0] == 0 && ((u_int32_t *)(a))[1] == 0 && \

65 ((
u_št32_t
 *)(
a
))[2] =ğ0 && ((u_št32_ˆ*)×))[3] =ğ
	`htÚl
(1))

	)

68 #iâdeà
HAVE_STRUCT_IN6_ADDR


69 
	sš6_addr
 {

70 
u_št8_t
 
	ms6_addr
[16];

74 #iâdeà
HAVE_STRUCT_SOCKADDR_IN6


75 
	ssockaddr_š6
 {

76 
	msš6_çmy
;

77 
u_št16_t
 
	msš6_pÜt
;

78 
u_št32_t
 
	msš6_æowšfo
;

79 
š6_addr
 
	msš6_addr
;

80 
u_št32_t
 
	msš6_scİe_id
;

84 #iâdeà
AF_INET6


86 
	#AF_INET6
 
AF_MAX


	)

93 #iâdeà
NI_NUMERICHOST


94 
	#NI_NUMERICHOST
 (1)

	)

96 #iâdeà
NI_NAMEREQD


97 
	#NI_NAMEREQD
 (1<<1)

	)

99 #iâdeà
NI_NUMERICSERV


100 
	#NI_NUMERICSERV
 (1<<2)

	)

103 #iâdeà
AI_PASSIVE


104 
	#AI_PASSIVE
 (1)

	)

106 #iâdeà
AI_CANONNAME


107 
	#AI_CANONNAME
 (1<<1)

	)

109 #iâdeà
AI_NUMERICHOST


110 
	#AI_NUMERICHOST
 (1<<2)

	)

113 #iâdeà
NI_MAXSERV


114 
	#NI_MAXSERV
 32

	)

116 #iâdeà
NI_MAXHOST


117 
	#NI_MAXHOST
 1025

	)

120 #iâdeà
EAI_NODATA


121 
	#EAI_NODATA
 (
INT_MAX
 - 1)

	)

123 #iâdeà
EAI_MEMORY


124 
	#EAI_MEMORY
 (
INT_MAX
 - 2)

	)

126 #iâdeà
EAI_NONAME


127 
	#EAI_NONAME
 (
INT_MAX
 - 3)

	)

129 #iâdeà
EAI_SYSTEM


130 
	#EAI_SYSTEM
 (
INT_MAX
 - 4)

	)

132 #iâdeà
EAI_FAMILY


133 
	#EAI_FAMILY
 (
INT_MAX
 - 5)

	)

136 #iâdeà
HAVE_STRUCT_ADDRINFO


137 
	saddršfo
 {

138 
	mai_æags
;

139 
	mai_çmy
;

140 
	mai_sockty³
;

141 
	mai_´ÙocŞ
;

142 
size_t
 
	mai_add¾’
;

143 *
	mai_ÿnÚÇme
;

144 
sockaddr
 *
	mai_addr
;

145 
addršfo
 *
	mai_Ãxt
;

149 #iâdeà
HAVE_GETADDRINFO


150 #ifdeà
g‘addršfo


151 #undeà
g‘addršfo


153 
	#g‘addršfo
(
a
,
b
,
c
,
d
è(
	`ssh_g‘addršfo
×,b,c,d))

	)

154 
g‘addršfo
(const *, const *,

155 cÚ¡ 
addršfo
 *, addrinfo **);

158 #ià!
defšed
(
HAVE_GAI_STRERROR
è&& !defšed(
HAVE_CONST_GAI_STRERROR_PROTO
)

159 
	#gai_¡»¼Ü
(
a
è(
	`_ssh_com·t_gai_¡»¼Ü
×))

	)

160 *
gai_¡»¼Ü
();

163 #iâdeà
HAVE_FREEADDRINFO


164 
	#ä“addršfo
(
a
è(
	`ssh_ä“addršfo
×))

	)

165 
ä“addršfo
(
addršfo
 *);

168 #iâdeà
HAVE_GETNAMEINFO


169 
	#g‘Çmešfo
(
a
,
b
,
c
,
d
,
e
,
f
,
g
è(
	`ssh_g‘Çmešfo
×,b,c,d,e,f,g))

	)

170 
g‘Çmešfo
(cÚ¡ 
sockaddr
 *, 
size_t
, *, size_t,

171 *, 
size_t
, );

	@sftp-server/openbsd-compat/fmt_scaled.c

41 
	~"šşudes.h
"

43 #iâdeà
HAVE_FMT_SCALED


45 
	~<¡dio.h
>

46 
	~<¡dlib.h
>

47 
	~<”ºo.h
>

48 
	~<¡ršg.h
>

49 
	~<ùy³.h
>

50 
	~<lim™s.h
>

53 
	mNONE
 = 0, 
	mKILO
 = 1, 
	mMEGA
 = 2, 
	mGIGA
 = 3, 
	mTERA
 = 4, 
	mPETA
 = 5, 
	mEXA
 = 6

54 } 
	tun™_ty³
;

57 
un™_ty³
 
	gun™s
[] = { 
NONE
, 
KILO
, 
MEGA
, 
GIGA
, 
TERA
, 
PETA
, 
EXA
 };

58 
	gsÿË_ch¬s
[] = "BKMGTPE";

59 
	gsÿË_çùÜs
[] = {

68 
	#SCALE_LENGTH
 ((
un™s
)/(un™s[0]))

	)

70 
	#MAX_DIGITS
 (
SCALE_LENGTH
 * 3è

	)

76 
	$sÿn_sÿËd
(*
sÿËd
, *
»suÉ
)

78 *
p
 = 
sÿËd
;

79 
sign
 = 0;

80 
i
, 
ndig™s
 = 0, 
äaù_dig™s
 = 0;

81 
sÿË_çù
 = 1, 
whŞe
 = 0, 
å¬t
 = 0;

84 
	`i§scii
(*
p
è&& 
	`is¥aû
(*p))

85 ++
p
;

88 *
p
 == '-' || *p == '+') {

89 ià(*
p
 == '-') {

90 ià(
sign
) {

91 
”ºo
 = 
EINVAL
;

94 
sign
 = -1;

95 ++
p
;

96 } ià(*
p
 == '+') {

97 ià(
sign
) {

98 
”ºo
 = 
EINVAL
;

101 
sign
 = +1;

102 ++
p
;

111 ; 
	`i§scii
(*
p
è&& (
	`isdig™
(*p) || *p=='.'); ++p) {

112 ià(*
p
 == '.') {

113 ià(
äaù_dig™s
 > 0) {

114 
”ºo
 = 
EINVAL
;

117 
äaù_dig™s
 = 1;

121 
i
 = (*
p
) - '0';

122 ià(
äaù_dig™s
 > 0) {

123 ià(
äaù_dig™s
 >ğ
MAX_DIGITS
-1)

126 
äaù_dig™s
++;

127 
å¬t
 *= 10;

128 
å¬t
 +ğ
i
;

130 ià(++
ndig™s
 >ğ
MAX_DIGITS
) {

131 
”ºo
 = 
ERANGE
;

134 
whŞe
 *= 10;

135 
whŞe
 +ğ
i
;

139 ià(
sign
) {

140 
whŞe
 *ğ
sign
;

141 
å¬t
 *ğ
sign
;

145 ià(!*
p
) {

146 *
»suÉ
 = 
whŞe
;

151 
i
 = 0; i < 
SCALE_LENGTH
; i++) {

154 ià(*
p
 =ğ
sÿË_ch¬s
[
i
] ||

155 *
p
 =ğ
	`tŞow”
(
sÿË_ch¬s
[
i
])) {

158 ià(
	`i§Êum
(*(
p
+1))) {

159 
”ºo
 = 
EINVAL
;

162 
sÿË_çù
 = 
sÿË_çùÜs
[
i
];

165 
whŞe
 *ğ
sÿË_çù
;

170 
å¬t
 >ğ
LLONG_MAX
 / 
sÿË_çù
) {

171 
å¬t
 /= 10;

172 
äaù_dig™s
--;

174 
å¬t
 *ğ
sÿË_çù
;

175 ià(
äaù_dig™s
 > 0) {

176 
i
 = 0; i < 
äaù_dig™s
 -1; i++)

177 
å¬t
 /= 10;

179 
whŞe
 +ğ
å¬t
;

180 *
»suÉ
 = 
whŞe
;

184 
”ºo
 = 
ERANGE
;

186 
	}
}

193 
	$fmt_sÿËd
(
numb”
, *
»suÉ
)

195 
abv®
, 
äaù
 = 0;

196 
i
;

197 
un™_ty³
 
un™
 = 
NONE
;

199 
abv®
 = (
numb”
 < 0LL) ? -number :‚umber;

204 ià(
abv®
 < 0 ||‡bv® / 1024 >ğ
sÿË_çùÜs
[
SCALE_LENGTH
-1]) {

205 
”ºo
 = 
ERANGE
;

210 
i
 = 0; i < 
SCALE_LENGTH
; i++) {

211 ià(
abv®
/1024 < 
sÿË_çùÜs
[
i
]) {

212 
un™
 = 
un™s
[
i
];

213 
äaù
 = (
i
 =ğ0è? 0 : 
abv®
 % 
sÿË_çùÜs
[i];

214 
numb”
 /ğ
sÿË_çùÜs
[
i
];

215 ià(
i
 > 0)

216 
äaù
 /ğ
sÿË_çùÜs
[
i
 - 1];

221 
äaù
 = (10 * fract + 512) / 1024;

223 ià(
äaù
 == 10) {

224 ià(
numb”
 >= 0)

225 
numb”
++;

227 
numb”
--;

228 
äaù
 = 0;

231 ià(
numb”
 == 0)

232 
	`¡¾ıy
(
»suÉ
, "0B", 
FMT_SCALED_STRSIZE
);

233 ià(
un™
 =ğ
NONE
 || 
numb”
 >= 100 ||‚umber <= -100) {

234 ià(
äaù
 >= 5) {

235 ià(
numb”
 >= 0)

236 
numb”
++;

238 
numb”
--;

240 ()
	`¢´štf
(
»suÉ
, 
FMT_SCALED_STRSIZE
, "%lld%c",

241 
numb”
, 
sÿË_ch¬s
[
un™
]);

243 ()
	`¢´štf
(
»suÉ
, 
FMT_SCALED_STRSIZE
, "%lld.%1lld%c",

244 
numb”
, 
äaù
, 
sÿË_ch¬s
[
un™
]);

247 
	}
}

249 #ifdef 
MAIN


255 
	$maš
(
¬gc
, **
¬gv
)

257 *
cšput
 = "1.5K", 
buf
[
FMT_SCALED_STRSIZE
];

258 
nšput
 = 10483892, 
»suÉ
;

260 ià(
	`sÿn_sÿËd
(
cšput
, &
»suÉ
) == 0)

261 
	`´štf
("\"%s\" -> %Îd\n", 
cšput
, 
»suÉ
);

263 
	`³¼Ü
(
cšput
);

265 ià(
	`fmt_sÿËd
(
nšput
, 
buf
) == 0)

266 
	`´štf
("%Îd -> \"%s\"\n", 
nšput
, 
buf
);

268 
	`årštf
(
¡d”r
, "%Îd inv®id (%s)\n", 
nšput
, 
	`¡»¼Ü
(
”ºo
));

271 
	}
}

	@sftp-server/openbsd-compat/getopt.c

32 
	~"šşudes.h
"

33 #ià!
defšed
(
HAVE_GETOPT
è|| !defšed(
HAVE_GETOPT_OPTRESET
)

35 #ià
defšed
(
LIBC_SCCS
è&& !defšed(
lšt
)

36 *
	grcsid
 = "$OpenBSD: getopt.c,v 1.5 2003/06/02 20:18:37 millert Exp $";

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~<¡ršg.h
>

43 
	gBSDİ‹¼
 = 1,

44 
	gBSDİtšd
 = 1,

45 
	gBSDİtİt
,

46 
	gBSDİŒe£t
;

47 *
	gBSDİrg
;

49 
	#BADCH
 ()'?'

	)

50 
	#BADARG
 ()':'

	)

51 
	#EMSG
 ""

	)

58 
	$BSDg‘İt
(
Çrgc
, 
Çrgv
, 
o¡r
)

59 
Çrgc
;

60 * cÚ¡ *
Çrgv
;

61 cÚ¡ *
o¡r
;

63 *
__´ogÇme
;

64 *
¶aû
 = 
EMSG
;

65 *
Şi
;

67 ià(
o¡r
 =ğ
NULL
)

70 ià(
BSDİŒe£t
 || !*
¶aû
) {

71 
BSDİŒe£t
 = 0;

72 ià(
BSDİtšd
 >ğ
Çrgc
 || *(
¶aû
 = 
Çrgv
[BSDoptind]) != '-') {

73 
¶aû
 = 
EMSG
;

76 ià(
¶aû
[1] && *++place == '-') {

77 ++
BSDİtšd
;

78 
¶aû
 = 
EMSG
;

82 ià((
BSDİtİt
 = ()*
¶aû
++) == ()':' ||

83 !(
Şi
 = 
	`¡rchr
(
o¡r
, 
BSDİtİt
))) {

88 ià(
BSDİtİt
 == ()'-')

90 ià(!*
¶aû
)

91 ++
BSDİtšd
;

92 ià(
BSDİ‹¼
 && *
o¡r
 != ':')

93 ()
	`årštf
(
¡d”r
,

94 "%s: iÎeg® o±iÚ -- %c\n", 
__´ogÇme
, 
BSDİtİt
);

95  (
BADCH
);

97 ià(*++
Şi
 != ':') {

98 
BSDİrg
 = 
NULL
;

99 ià(!*
¶aû
)

100 ++
BSDİtšd
;

103 ià(*
¶aû
)

104 
BSDİrg
 = 
¶aû
;

105 ià(
Çrgc
 <ğ++
BSDİtšd
) {

106 
¶aû
 = 
EMSG
;

107 ià(*
o¡r
 == ':')

108  (
BADARG
);

109 ià(
BSDİ‹¼
)

110 ()
	`årštf
(
¡d”r
,

112 
__´ogÇme
, 
BSDİtİt
);

113  (
BADCH
);

116 
BSDİrg
 = 
Çrgv
[
BSDİtšd
];

117 
¶aû
 = 
EMSG
;

118 ++
BSDİtšd
;

120  (
BSDİtİt
);

121 
	}
}

	@sftp-server/openbsd-compat/getrrsetbyname.h

48 #iâdeà
_GETRRSETBYNAME_H


49 
	#_GETRRSETBYNAME_H


	)

51 
	~"šşudes.h
"

53 #iâdeà
HAVE_GETRRSETBYNAME


55 
	~<sys/ty³s.h
>

56 
	~<Ãtš‘/š.h
>

57 
	~<¬·/Çme£r.h
>

58 
	~<Ãtdb.h
>

59 
	~<»sŞv.h
>

61 #iâdeà
HFIXEDSZ


62 
	#HFIXEDSZ
 12

	)

65 #iâdeà
T_RRSIG


66 
	#T_RRSIG
 46

	)

72 #iâdeà
RRSET_VALIDATED


73 
	#RRSET_VALIDATED
 1

	)

79 #iâdeà
ERRSET_SUCCESS


80 
	#ERRSET_SUCCESS
 0

	)

81 
	#ERRSET_NOMEMORY
 1

	)

82 
	#ERRSET_FAIL
 2

	)

83 
	#ERRSET_INVAL
 3

	)

84 
	#ERRSET_NONAME
 4

	)

85 
	#ERRSET_NODATA
 5

	)

88 
	srd©ašfo
 {

89 
	mrdi_Ëngth
;

90 *
	mrdi_d©a
;

93 
	s¼£tšfo
 {

94 
	m¼i_æags
;

95 
	m¼i_rdşass
;

96 
	m¼i_rdty³
;

97 
	m¼i_‰l
;

98 
	m¼i_Äd©as
;

99 
	m¼i_nsigs
;

100 *
	m¼i_Çme
;

101 
rd©ašfo
 *
	m¼i_rd©as
;

102 
rd©ašfo
 *
	m¼i_sigs
;

105 
g‘¼£tbyÇme
(cÚ¡ *, , , , 
¼£tšfo
 **);

106 
ä“¼£t
(
¼£tšfo
 *);

	@sftp-server/openbsd-compat/glob.h

40 #ià!
defšed
(
HAVE_GLOB_H
è|| !defšed(
GLOB_HAS_ALTDIRFUNC
) || \

41 !
defšed
(
GLOB_HAS_GL_MATCHC
) || \

42 !
defšed
(
HAVE_DECL_GLOB_NOMATCH
è|| 
	gHAVE_DECL_GLOB_NOMATCH
 == 0 || \

43 
	$defšed
(
BROKEN_GLOB
)

45 #iâdeà
_GLOB_H_


46 
	#_GLOB_H_


	)

48 
¡©
;

50 
gl_·thc
;

51 
gl_m©chc
;

52 
gl_offs
;

53 
gl_æags
;

54 **
gl_·thv
;

56 (*
gl_”rfunc
)(const *, );

63 (*
gl_şo£dœ
)(*);

64 
dœ’t
 *(*
gl_»addœ
)(*);

65 *(*
gl_İ’dœ
)(const *);

66 (*
gl_l¡©
)(cÚ¡ *, 
¡©
 *);

67 (*
gl_¡©
)(cÚ¡ *, 
¡©
 *);

68 } 
	tglob_t
;

70 
	#GLOB_APPEND
 0x0001

	)

71 
	#GLOB_DOOFFS
 0x0002

	)

72 
	#GLOB_ERR
 0x0004

	)

73 
	#GLOB_MARK
 0x0008

	)

74 
	#GLOB_NOCHECK
 0x0010

	)

75 
	#GLOB_NOSORT
 0x0020

	)

76 
	#GLOB_NOESCAPE
 0x1000

	)

79 
	#GLOB_NOSPACE
 (-1è

	)

80 
	#GLOB_ABORTED
 (-2è

	)

81 
	#GLOB_NOMATCH
 (-3è

	)

82 
	#GLOB_NOSYS
 (-4è

	)

83 
	#GLOB_ABEND
 
GLOB_ABORTED


	)

85 
	#GLOB_ALTDIRFUNC
 0x0040

	)

86 
	#GLOB_BRACE
 0x0080

	)

87 
	#GLOB_MAGCHAR
 0x0100

	)

88 
	#GLOB_NOMAGIC
 0x0200

	)

89 
	#GLOB_QUOTE
 0x0400

	)

90 
	#GLOB_TILDE
 0x0800

	)

91 
	#GLOB_LIMIT
 0x2000

	)

93 
	`glob
(cÚ¡ *, , (*)(cÚ¡ *, ), 
glob_t
 *);

94 
	`globä“
(
glob_t
 *);

99 !
	`defšed
(
GLOB_HAS_GL_MATCHC
 */

	@sftp-server/openbsd-compat/openbsd-compat.h

29 #iâdeà
_OPENBSD_COMPAT_H


30 
	#_OPENBSD_COMPAT_H


	)

32 
	~"šşudes.h
"

34 
	~<sys/ty³s.h
>

35 
	~<pwd.h
>

37 
	~<sys/sock‘.h
>

40 
	~"ba£64.h
"

41 
	~"sigaù.h
"

42 
	~"glob.h
"

43 
	~"»ad·s¥h¿£.h
"

44 
	~"vis.h
"

45 
	~"g‘¼£tbyÇme.h
"

46 
	~"sha2.h
"

48 #iâdeà
HAVE_BASENAME


49 *
ba£Çme
(cÚ¡ *
·th
);

52 #iâdeà
HAVE_BINDRESVPORT_SA


53 
bšd»svpÜt_§
(
sd
, 
sockaddr
 *
§
);

56 #iâdeà
HAVE_CLOSEFROM


57 
şo£äom
();

60 #iâdeà
HAVE_GETCWD


61 *
g‘cwd
(*
±
, 
size_t
 
size
);

64 #ià!
defšed
(
HAVE_REALPATH
è|| defšed(
BROKEN_REALPATH
)

65 *
»®·th
(cÚ¡ *
·th
, *
»sŞved
);

68 #iâdeà
HAVE_RRESVPORT_AF


69 
¼esvpÜt_af
(*
®pÜt
, 
§_çmy_t
 
af
);

72 #iâdeà
HAVE_STRLCPY


74 
size_t
 
¡¾ıy
(*
d¡
, cÚ¡ *
¤c
, size_ˆ
siz
);

77 #iâdeà
HAVE_STRLCAT


79 
size_t
 
¡¾ÿt
(*
d¡
, cÚ¡ *
¤c
, size_ˆ
siz
);

82 #iâdeà
HAVE_SETENV


83 
£‹nv
(cÚ¡ *
Çme
, cÚ¡ *
v®ue
, 
»wr™e
);

86 #iâdeà
HAVE_STRMODE


87 
¡rmode
(
mode
, *
p
);

90 #ià!
defšed
(
HAVE_MKDTEMP
è|| defšed(
HAVE_STRICT_MKSTEMP
)

91 
mk¡emps
(*
·th
, 
¦’
);

92 
mk¡emp
(*
·th
);

93 *
mkd‹mp
(*
·th
);

96 #iâdeà
HAVE_DAEMON


97 
d«mÚ
(
nochdœ
, 
noşo£
);

100 #iâdeà
HAVE_DIRNAME


101 *
dœÇme
(cÚ¡ *
·th
);

104 #iâdeà
HAVE_FMT_SCALED


105 
	#FMT_SCALED_STRSIZE
 7

	)

106 
fmt_sÿËd
(
numb”
, *
»suÉ
);

109 #ià
defšed
(
BROKEN_INET_NTOA
è|| !defšed(
HAVE_INET_NTOA
)

110 *
š‘_Áß
(
š_addr
 
š
);

113 #iâdeà
HAVE_INET_NTOP


114 cÚ¡ *
š‘_Áİ
(
af
, cÚ¡ *
¤c
, *
d¡
, 
size_t
 
size
);

117 #iâdeà
HAVE_INET_ATON


118 
š‘_©Ú
(cÚ¡ *
ı
, 
š_addr
 *
addr
);

121 #iâdeà
HAVE_STRSEP


122 *
¡r£p
(**
¡ršgp
, cÚ¡ *
d–im
);

125 #iâdeà
HAVE_SETPROCTITLE


126 
£roù™Ë
(cÚ¡ *
fmt
, ...);

127 
com·t_š™_£roù™Ë
(
¬gc
, *
¬gv
[]);

130 #iâdeà
HAVE_GETGROUPLIST


132 
g‘grou¶i¡
(cÚ¡ *, 
gid_t
, gid_t *, *);

135 #ià!
defšed
(
HAVE_GETOPT
è|| !defšed(
HAVE_GETOPT_OPTRESET
)

136 
BSDg‘İt
(
¬gc
, * cÚ¡ *
¬gv
, cÚ¡ *
İts
);

139 #ià
defšed
(
HAVE_DECL_WRITEV
) && HAVE_DECL_WRITEV == 0

140 
	~<sys/ty³s.h
>

141 
	~<sys/uio.h
>

142 
wr™ev
(, 
iovec
 *, );

146 
	~"bsd-misc.h
"

147 
	~"bsd-¡©vfs.h
"

148 
	~"bsd-wa™pid.h
"

149 
	~"bsd-pŞl.h
"

151 #iâdeà
HAVE_GETPEEREID


152 
g‘³”eid
(, 
uid_t
 *, 
gid_t
 *);

155 #iâdeà
HAVE_ARC4RANDOM


156 
¬c4¿ndom
();

157 
¬c4¿ndom_¡œ
();

160 #iâdeà
HAVE_ARC4RANDOM_BUF


161 
¬c4¿ndom_buf
(*, 
size_t
);

164 #iâdeà
HAVE_ARC4RANDOM_UNIFORM


165 
u_št32_t
 
¬c4¿ndom_unifÜm
(u_int32_t);

168 #iâdeà
HAVE_ASPRINTF


169 
a¥rštf
(**, const *, ...);

172 #iâdeà
HAVE_OPENPTY


173 
	~<sys/ioùl.h
>

174 
İ’±y
(*, *, *, 
‹rmios
 *, 
wšsize
 *);

179 #iâdeà
HAVE_SNPRINTF


180 
¢´štf
(*, 
size_t
, 
SNPRINTF_CONST
 *, ...);

183 #iâdeà
HAVE_STRTOLL


184 
¡¹Şl
(const *, **, );

187 #iâdeà
HAVE_STRTONUM


188 
¡¹Úum
(const *, , , const **);

191 #ià!
defšed
(
HAVE_VASPRINTF
è|| !defšed(
HAVE_VSNPRINTF
)

192 
	~<¡d¬g.h
>

195 #iâdeà
HAVE_VASPRINTF


196 
va¥rštf
(**, cÚ¡ *, 
va_li¡
);

199 #iâdeà
HAVE_VSNPRINTF


200 
v¢´štf
(*, 
size_t
, cÚ¡ *, 
va_li¡
);

203 #iâdeà
HAVE_USER_FROM_UID


204 *
u£r_äom_uid
(
uid_t
, );

207 #iâdeà
HAVE_GROUP_FROM_GID


208 *
group_äom_gid
(
gid_t
, );

211 *
xmm­
(
size_t
 
size
);

212 *
xüy±
(cÚ¡ *
·sswÜd
, cÚ¡ *
§É
);

213 *
shadow_pw
(
·sswd
 *
pw
);

216 
	~"çke-rfc2553.h
"

219 
	~"bsd-üay.h
"

220 
	~"bsd-cygwš_ut.h
"

222 
	~"pÜt-aix.h
"

223 
	~"pÜt-œix.h
"

224 
	~"pÜt-lšux.h
"

225 
	~"pÜt-sŞ¬is.h
"

226 
	~"pÜt-tun.h
"

227 
	~"pÜt-uw.h
"

	@sftp-server/openbsd-compat/port-aix.h

29 #ifdeà
_AIX


31 #ifdeà
HAVE_SYS_SOCKET_H


32 
	~<sys/sock‘.h
>

35 
	~"bufãr.h
"

38 
u¤šfo
(, *, );

39 #ià
defšed
(
HAVE_DECL_SETAUTHDB
) && (HAVE_DECL_SETAUTHDB == 0)

40 
£uthdb
(const *, *);

43 #ià
defšed
(
HAVE_DECL_AUTHENTICATE
) && (HAVE_DECL_AUTHENTICATE == 0)

44 
auth’tiÿ‹
(*, *, *, **);

46 #ià
defšed
(
HAVE_DECL_LOGINFAILED
) && (HAVE_DECL_LOGINFAILED == 0)

47 
logšçed
(*, *, *);

49 #ià
defšed
(
HAVE_DECL_LOGINRESTRICTIONS
) && (HAVE_DECL_LOGINRESTRICTIONS == 0)

50 
logš»¡riùiÚs
(*, , *, **);

52 #ià
defšed
(
HAVE_DECL_LOGINSUCCESS
) && (HAVE_DECL_LOGINSUCCESS == 0)

53 
logšsucûss
(*, *, *, **);

55 #ià
defšed
(
HAVE_DECL_PASSWDEXPIRED
) && (HAVE_DECL_PASSWDEXPIRED == 0)

56 
·sswdexpœed
(*, **);

60 #ifdeà
r_ty³


61 #undeà
r_ty³


65 #ià!
defšed
(
HAVE_NANOSLEEP
è&& defšed(
HAVE_NSLEEP
)

66 
	#Çno¦“p
(
a
,
b
è
	`n¦“p
×,b)

	)

70 #ifdeà
HAVE_SYS_TIMERS_H


71 
	~<sys/tim”s.h
>

75 #ifdeà
HAVE_USERSEC_H


76 
	~<u£r£c.h
>

83 #ifdeà
HAVE_SETAUTHDB


84 
	#REGISTRY_SIZE
 16

	)

87 
aix_u¤šfo
(
·sswd
 *);

89 #ifdeà
WITH_AIXAUTHENTICATE


90 
	#CUSTOM_SYS_AUTH_PASSWD
 1

	)

91 
	#CUSTOM_SYS_AUTH_ALLOWED_USER
 1

	)

92 
sys_auth_®lowed_u£r
(
·sswd
 *, 
Bufãr
 *);

93 
	#CUSTOM_SYS_AUTH_RECORD_LOGIN
 1

	)

94 
sys_auth_»cÜd_logš
(cÚ¡ *, cÚ¡ *, cÚ¡ *, 
Bufãr
 *);

95 
	#CUSTOM_SYS_AUTH_GET_LASTLOGIN_MSG


	)

96 *
sys_auth_g‘_Ï¡logš_msg
(cÚ¡ *, 
uid_t
);

97 
	#CUSTOM_FAILED_LOGIN
 1

	)

98 #ià
defšed
(
S_AUTHDOMAIN
è&& defšed (
S_AUTHNAME
)

99 
	#USE_AIX_KRB_NAME


	)

100 *
aix_krb5_g‘_´šc®_Çme
(*);

104 
aix_£uthdb
(const *);

105 
aix_»¡Ü—uthdb
();

106 
aix_»move_embedded_Ãwlšes
(*);

108 #ià
defšed
(
AIX_GETNAMEINFO_HACK
è&& !defšed(
BROKEN_GETADDRINFO
)

109 #ifdeà
g‘Çmešfo


110 #undeà
g‘Çmešfo


112 
sshaix_g‘Çmešfo
(cÚ¡ 
sockaddr
 *, 
size_t
, *, size_t,

113 *, 
size_t
, );

114 
	#g‘Çmešfo
(
a
,
b
,
c
,
d
,
e
,
f
,
g
è(
	`sshaix_g‘Çmešfo
×,b,c,d,e,f,g))

	)

121 #ià!
defšed
(
HAVE_GETGROUPLIST
è&& defšed(
HAVE_GETGRSET
)

122 
	#HAVE_GETGROUPLIST


	)

123 
	#USE_GETGRSET


	)

124 
g‘grou¶i¡
(cÚ¡ *, 
gid_t
, gid_t *, *);

	@sftp-server/openbsd-compat/port-irix.h

28 #iâdeà
_PORT_IRIX_H


29 
	#_PORT_IRIX_H


	)

31 #ià
defšed
(
WITH_IRIX_PROJECT
) || \

32 
defšed
(
WITH_IRIX_JOBS
) || \

33 
	$defšed
(
WITH_IRIX_ARRAY
)

35 
	`œix_£tu£rcÚ‹xt
(
·sswd
 *
pw
);

	@sftp-server/openbsd-compat/port-linux.h

19 #iâdeà
_PORT_LINUX_H


20 
	#_PORT_LINUX_H


	)

22 #ifdeà
WITH_SELINUX


23 
ssh_£lšux_’abËd
();

24 
ssh_£lšux_£tup_±y
(*, const *);

25 
ssh_£lšux_£tup_exec_cÚ‹xt
(*);

26 
ssh_£lšux_chªge_cÚ‹xt
(const *);

29 #ifdeà
LINUX_OOM_ADJUST


30 
oom_adju¡_»¡Üe
();

31 
oom_adju¡_£tup
();

	@sftp-server/openbsd-compat/port-solaris.h

19 #iâdeà
_PORT_SOLARIS_H


21 
	~<sys/ty³s.h
>

23 
sŞ¬is_cÚŒaù_´e_fÜk
();

24 
sŞ¬is_cÚŒaù_po¡_fÜk_chd
();

25 
sŞ¬is_cÚŒaù_po¡_fÜk_·»Á
(
pid_t
 
pid
);

	@sftp-server/openbsd-compat/port-tun.c

17 
	~"šşudes.h
"

19 
	~<sys/ty³s.h
>

20 
	~<sys/ioùl.h
>

22 
	~<Ãtš‘/š.h
>

23 
	~<¬·/š‘.h
>

24 
	~<Ãtš‘/.h
>

26 
	~<”ºo.h
>

27 
	~<fú.h
>

28 
	~<¡d¬g.h
>

29 
	~<¡ršg.h
>

30 
	~<uni¡d.h
>

32 
	~"İ’bsd-com·t/sys-queue.h
"

33 
	~"log.h
"

34 
	~"misc.h
"

35 
	~"bufãr.h
"

36 
	~"chªÃls.h
"

53 #ià
defšed
(
SSH_TUN_LINUX
)

54 
	~<lšux/if.h
>

55 
	~<lšux/if_tun.h
>

58 
	$sys_tun_İ’
(
tun
, 
mode
)

60 
iäeq
 
iä
;

61 
fd
 = -1;

62 cÚ¡ *
Çme
 = 
NULL
;

64 ià((
fd
 = 
	`İ’
("/dev/Ãt/tun", 
O_RDWR
)) == -1) {

65 
	`debug
("%s: failedo openunnel control interface: %s",

66 
__func__
, 
	`¡»¼Ü
(
”ºo
));

70 
	`bz”o
(&
iä
, (ifr));

72 ià(
mode
 =ğ
SSH_TUNMODE_ETHERNET
) {

73 
iä
.
iä_æags
 = 
IFF_TAP
;

74 
Çme
 = "tap%d";

76 
iä
.
iä_æags
 = 
IFF_TUN
;

77 
Çme
 = "tun%d";

79 
iä
.
iä_æags
 |ğ
IFF_NO_PI
;

81 ià(
tun
 !ğ
SSH_TUNID_ANY
) {

82 ià(
tun
 > 
SSH_TUNID_MAX
) {

83 
	`debug
("%s: inv®iduÂ– id %x: %s", 
__func__
,

84 
tun
, 
	`¡»¼Ü
(
”ºo
));

85 
çed
;

87 
	`¢´štf
(
iä
.
iä_Çme
, (iä.iä_Çme), 
Çme
, 
tun
);

90 ià(
	`ioùl
(
fd
, 
TUNSETIFF
, &
iä
) == -1) {

91 
	`debug
("%s: faedØcÚfigu»uÂ– (mod%d): %s", 
__func__
,

92 
mode
, 
	`¡»¼Ü
(
”ºo
));

93 
çed
;

96 ià(
tun
 =ğ
SSH_TUNID_ANY
)

97 
	`debug
("%s:uÂ– mod%d fd %d", 
__func__
, 
mode
, 
fd
);

99 
	`debug
("%s: % mod%d fd %d", 
__func__
, 
iä
.
iä_Çme
, 
mode
, 
fd
);

101  (
fd
);

103 
çed
:

104 
	`şo£
(
fd
);

106 
	}
}

109 #ifdeà
SSH_TUN_FREEBSD


110 
	~<sys/sock‘.h
>

111 
	~<Ãt/if.h
>

113 #ifdeà
HAVE_NET_IF_TUN_H


114 
	~<Ãt/if_tun.h
>

118 
	$sys_tun_İ’
(
tun
, 
mode
)

120 
iäeq
 
iä
;

121 
Çme
[100];

122 
fd
 = -1, 
sock
, 
æag
;

123 cÚ¡ *
tunba£
 = "tun";

125 ià(
mode
 =ğ
SSH_TUNMODE_ETHERNET
) {

126 #ifdeà
SSH_TUN_NO_L2


127 
	`debug
("%s:‚ØÏy” 2uÂ–lšg suµÜt", 
__func__
);

130 
tunba£
 = "tap";

135 ià(
tun
 <ğ
SSH_TUNID_MAX
) {

136 
	`¢´štf
(
Çme
, Òame), "/dev/%s%d", 
tunba£
, 
tun
);

137 
fd
 = 
	`İ’
(
Çme
, 
O_RDWR
);

138 } ià(
tun
 =ğ
SSH_TUNID_ANY
) {

139 
tun
 = 100;un >= 0;un--) {

140 
	`¢´štf
(
Çme
, (name), "/dev/%s%d",

141 
tunba£
, 
tun
);

142 ià((
fd
 = 
	`İ’
(
Çme
, 
O_RDWR
)) >= 0)

146 
	`debug
("%s: inv®iduÂ– %u\n", 
__func__
, 
tun
);

150 ià(
fd
 < 0) {

151 
	`debug
("%s: % İ’ faed: %s", 
__func__
, 
Çme
,

152 
	`¡»¼Ü
(
”ºo
));

157 
æag
 = 1;

158 #ià
	`defšed
(
TUNSIFHEAD
è&& !defšed(
SSH_TUN_PREPEND_AF
)

159 ià(
mode
 !ğ
SSH_TUNMODE_ETHERNET
 &&

160 
	`ioùl
(
fd
, 
TUNSIFHEAD
, &
æag
) == -1) {

161 
	`debug
("%s: ioùl(%d, TUNSIFHEAD, 1): %s", 
__func__
, 
fd
,

162 
	`¡»¼Ü
(
”ºo
));

163 
	`şo£
(
fd
);

167 
	`debug
("%s: % mod%d fd %d", 
__func__
, 
Çme
, 
mode
, 
fd
);

170 
	`¢´štf
(
iä
.
iä_Çme
, (iä.iä_Çme), "%s%d", 
tunba£
, 
tun
);

171 ià((
sock
 = 
	`sock‘
(
PF_UNIX
, 
SOCK_STREAM
, 0)) == -1)

172 
çed
;

174 ià(
	`ioùl
(
sock
, 
SIOCGIFFLAGS
, &
iä
) == -1)

175 
çed
;

176 
iä
.
iä_æags
 |ğ
IFF_UP
;

177 ià(
	`ioùl
(
sock
, 
SIOCSIFFLAGS
, &
iä
) == -1)

178 
çed
;

180 
	`şo£
(
sock
);

181  (
fd
);

183 
çed
:

184 ià(
fd
 >= 0)

185 
	`şo£
(
fd
);

186 ià(
sock
 >= 0)

187 
	`şo£
(
sock
);

188 
	`debug
("%s: faedØ£ˆ% mod%d: %s", 
__func__
, 
Çme
,

189 
mode
, 
	`¡»¼Ü
(
”ºo
));

191 
	}
}

198 #ià
defšed
(
SSH_TUN_FILTER
)

199 
	#OPENBSD_AF_INET
 2

	)

200 
	#OPENBSD_AF_INET6
 24

	)

203 
	$sys_tun_šf‹r
(
ChªÃl
 *
c
, *
buf
, 
Ën
)

205 #ià
	`defšed
(
SSH_TUN_PREPEND_AF
)

206 
rbuf
[
CHAN_RBUF
];

207 

 *
h
;

209 
u_št32_t
 *
af
;

210 *
±r
 = 
buf
;

212 #ià
	`defšed
(
SSH_TUN_PREPEND_AF
)

213 ià(
Ën
 <ğ0 ||†’ > ()((
rbuf
è- (*
af
)))

215 
±r
 = (*)&
rbuf
[0];

216 
	`bcİy
(
buf
, 
±r
 + (
u_št32_t
), 
Ën
);

217 
Ën
 +ğ(
u_št32_t
);

218 
af
 = (
u_št32_t
 *)
±r
;

220 
h
 = (

 *)(
±r
 + (
u_št32_t
));

221 
h
->
_v
) {

223 *
af
 = 
AF_INET6
;

227 *
af
 = 
AF_INET
;

232 #ià
	`defšed
(
SSH_TUN_COMPAT_AF
)

233 ià(
Ën
 < ()(
u_št32_t
))

236 
af
 = (
u_št32_t
 *)
±r
;

237 ià(*
af
 =ğ
	`htÚl
(
AF_INET6
))

238 *
af
 = 
	`htÚl
(
OPENBSD_AF_INET6
);

240 *
af
 = 
	`htÚl
(
OPENBSD_AF_INET
);

243 
	`bufãr_put_¡ršg
(&
c
->
šput
, 
±r
, 
Ën
);

245 
	}
}

247 
u_ch¬
 *

248 
	$sys_tun_outf‹r
(
ChªÃl
 *
c
, 
u_ch¬
 **
d©a
, 
u_št
 *
dËn
)

250 
u_ch¬
 *
buf
;

251 
u_št32_t
 *
af
;

253 *
d©a
 = 
	`bufãr_g‘_¡ršg
(&
c
->
ouut
, 
dËn
);

254 ià(*
dËn
 < (*
af
))

255  (
NULL
);

256 
buf
 = *
d©a
;

258 #ià
	`defšed
(
SSH_TUN_PREPEND_AF
)

259 *
dËn
 -ğ(
u_št32_t
);

260 
buf
 = *
d©a
 + (
u_št32_t
);

261 #–ià
	`defšed
(
SSH_TUN_COMPAT_AF
)

262 
af
 = 
	`Áohl
(*(
u_št32_t
 *)
buf
);

263 ià(*
af
 =ğ
OPENBSD_AF_INET6
)

264 *
af
 = 
	`htÚl
(
AF_INET6
);

266 *
af
 = 
	`htÚl
(
AF_INET
);

269  (
buf
);

270 
	}
}

	@sftp-server/openbsd-compat/port-tun.h

17 #iâdeà
_PORT_TUN_H


18 
	#_PORT_TUN_H


	)

20 
	gChªÃl
;

22 #ià
defšed
(
SSH_TUN_LINUX
è|| defšed(
SSH_TUN_FREEBSD
)

23 
	#CUSTOM_SYS_TUN_OPEN


	)

24 
sys_tun_İ’
(, );

27 #ià
defšed
(
SSH_TUN_COMPAT_AF
è|| defšed(
SSH_TUN_PREPEND_AF
)

28 
	#SSH_TUN_FILTER


	)

29 
sys_tun_šf‹r
(
ChªÃl
 *, *, );

30 
u_ch¬
 *
sys_tun_outf‹r
(
ChªÃl
 *, u_ch¬ **, 
u_št
 *);

	@sftp-server/openbsd-compat/port-uw.h

25 
	~"šşudes.h
"

27 #ifdeà
USE_LIBIAF


28 * 
g‘_Ÿf_·sswÜd
(
·sswd
 *
pw
);

	@sftp-server/openbsd-compat/pwcache.c

33 
	~"šşudes.h
"

35 
	~<sys/ty³s.h
>

37 
	~<g½.h
>

38 
	~<pwd.h
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~<¡ršg.h
>

43 
	#NCACHE
 64

	)

44 
	#MASK
 (
NCACHE
 - 1è

	)

46 #iâdeà
HAVE_USER_FROM_UID


48 
	$u£r_äom_uid
(
uid_t
 
uid
, 
nou£r
)

50 
	snÿche
 {

51 
uid_t
 
uid
;

52 *
Çme
;

53 } 
c_uid
[
NCACHE
];

54 
pwİ’
;

55 
nbuf
[15];

56 
·sswd
 *
pw
;

57 
nÿche
 *
ı
;

59 
ı
 = 
c_uid
 + (
uid
 & 
MASK
);

60 ià(
ı
->
uid
 !ğuid || cp->
Çme
 =ğ
NULL
) {

61 ià(
pwİ’
 == 0) {

62 #ifdeà
HAVE_SETPASSENT


63 
	`£as£Á
(1);

65 
pwİ’
 = 1;

67 ià((
pw
 = 
	`g‘pwuid
(
uid
)è=ğ
NULL
) {

68 ià(
nou£r
)

69  (
NULL
);

70 ()
	`¢´štf
(
nbuf
, Òbuf), "%u", 
uid
);

72 
ı
->
uid
 = uid;

73 ià(
ı
->
Çme
 !ğ
NULL
)

74 
	`ä“
(
ı
->
Çme
);

75 
ı
->
Çme
 = 
	`¡rdup
(
pw
 ?…w->
pw_Çme
 : 
nbuf
);

77  (
ı
->
Çme
);

78 
	}
}

81 #iâdeà
HAVE_GROUP_FROM_GID


83 
	$group_äom_gid
(
gid_t
 
gid
, 
nogroup
)

85 
	snÿche
 {

86 
gid_t
 
gid
;

87 *
Çme
;

88 } 
c_gid
[
NCACHE
];

89 
grİ’
;

90 
nbuf
[15];

91 
group
 *
gr
;

92 
nÿche
 *
ı
;

94 
ı
 = 
c_gid
 + (
gid
 & 
MASK
);

95 ià(
ı
->
gid
 !ğgid || cp->
Çme
 =ğ
NULL
) {

96 ià(
grİ’
 == 0) {

97 #ifdeà
HAVE_SETGROUPENT


98 
	`£tgrou³Á
(1);

100 
grİ’
 = 1;

102 ià((
gr
 = 
	`g‘grgid
(
gid
)è=ğ
NULL
) {

103 ià(
nogroup
)

104  (
NULL
);

105 ()
	`¢´štf
(
nbuf
, Òbuf), "%u", 
gid
);

107 
ı
->
gid
 = gid;

108 ià(
ı
->
Çme
 !ğ
NULL
)

109 
	`ä“
(
ı
->
Çme
);

110 
ı
->
Çme
 = 
	`¡rdup
(
gr
 ? gr->
gr_Çme
 : 
nbuf
);

112  (
ı
->
Çme
);

113 
	}
}

	@sftp-server/openbsd-compat/readpassphrase.h

25 #iâdeà
_READPASSPHRASE_H_


26 
	#_READPASSPHRASE_H_


	)

28 
	~"šşudes.h
"

30 #iâdeà
HAVE_READPASSPHRASE


32 
	#RPP_ECHO_OFF
 0x00

	)

33 
	#RPP_ECHO_ON
 0x01

	)

34 
	#RPP_REQUIRE_TTY
 0x02

	)

35 
	#RPP_FORCELOWER
 0x04

	)

36 
	#RPP_FORCEUPPER
 0x08

	)

37 
	#RPP_SEVENBIT
 0x10

	)

38 
	#RPP_STDIN
 0x20

	)

40 * 
»ad·s¥h¿£
(cÚ¡ *, *, 
size_t
, );

	@sftp-server/openbsd-compat/sha2.h

39 #iâdeà
_SSHSHA2_H


40 
	#_SSHSHA2_H


	)

42 
	~"šşudes.h
"

44 
	~<İ’s¦/İ’s¦v.h
>

46 #ià!
defšed
(
HAVE_EVP_SHA256
è&& !defšed(
HAVE_SHA256_UPDATE
) && \

47 (
	gOPENSSL_VERSION_NUMBER
 >= 0x00907000L)

50 
	#SHA256_BLOCK_LENGTH
 64

	)

51 
	#SHA256_DIGEST_LENGTH
 32

	)

52 
	#SHA256_DIGEST_STRING_LENGTH
 (
SHA256_DIGEST_LENGTH
 * 2 + 1)

	)

53 
	#SHA384_BLOCK_LENGTH
 128

	)

54 
	#SHA384_DIGEST_LENGTH
 48

	)

55 
	#SHA384_DIGEST_STRING_LENGTH
 (
SHA384_DIGEST_LENGTH
 * 2 + 1)

	)

56 
	#SHA512_BLOCK_LENGTH
 128

	)

57 
	#SHA512_DIGEST_LENGTH
 64

	)

58 
	#SHA512_DIGEST_STRING_LENGTH
 (
SHA512_DIGEST_LENGTH
 * 2 + 1)

	)

62 
	s_SHA256_CTX
 {

63 
u_št32_t
 
¡©e
[8];

64 
u_št64_t
 
	mb™couÁ
;

65 
u_št8_t
 
	mbufãr
[
SHA256_BLOCK_LENGTH
];

66 } 
	tSHA256_CTX
;

67 
	s_SHA512_CTX
 {

68 
u_št64_t
 
	m¡©e
[8];

69 
u_št64_t
 
	mb™couÁ
[2];

70 
u_št8_t
 
	mbufãr
[
SHA512_BLOCK_LENGTH
];

71 } 
	tSHA512_CTX
;

74 
SHA512_CTX
 
	tSHA384_CTX
;

77 
SHA256_In™
(
SHA256_CTX
 *);

78 
SHA256_T¿nsfÜm
(
u_št32_t
 
¡©e
[8], cÚ¡ 
u_št8_t
 [
SHA256_BLOCK_LENGTH
]);

79 
	$SHA256_Upd©e
(
SHA256_CTX
 *, cÚ¡ 
u_št8_t
 *, 
size_t
)

80 
	`__©Œibu‹__
((
	`__bounded__
(
__¡ršg__
,2,3)));

81 
	`SHA256_Pad
(
SHA256_CTX
 *);

82 
	$SHA256_Fš®
(
u_št8_t
 [
SHA256_DIGEST_LENGTH
], 
SHA256_CTX
 *)

83 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,1,
SHA256_DIGEST_LENGTH
)));

84 *
	$SHA256_End
(
SHA256_CTX
 *, *)

85 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA256_DIGEST_STRING_LENGTH
)));

86 *
	$SHA256_Fe
(const *, *)

87 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA256_DIGEST_STRING_LENGTH
)));

88 *
	$SHA256_FeChunk
(cÚ¡ *, *, 
off_t
, off_t)

89 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA256_DIGEST_STRING_LENGTH
)));

90 *
	$SHA256_D©a
(cÚ¡ 
u_št8_t
 *, 
size_t
, *)

91 
	`__©Œibu‹__
((
	$__bounded__
(
__¡ršg__
,1,2)))

92 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,3,
SHA256_DIGEST_STRING_LENGTH
)));

95 
	`SHA384_In™
(
SHA384_CTX
 *);

96 
	`SHA384_T¿nsfÜm
(
u_št64_t
 
¡©e
[8], cÚ¡ 
u_št8_t
 [
SHA384_BLOCK_LENGTH
]);

97 
	$SHA384_Upd©e
(
SHA384_CTX
 *, cÚ¡ 
u_št8_t
 *, 
size_t
)

98 
	`__©Œibu‹__
((
	`__bounded__
(
__¡ršg__
,2,3)));

99 
	`SHA384_Pad
(
SHA384_CTX
 *);

100 
	$SHA384_Fš®
(
u_št8_t
 [
SHA384_DIGEST_LENGTH
], 
SHA384_CTX
 *)

101 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,1,
SHA384_DIGEST_LENGTH
)));

102 *
	$SHA384_End
(
SHA384_CTX
 *, *)

103 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA384_DIGEST_STRING_LENGTH
)));

104 *
	$SHA384_Fe
(const *, *)

105 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA384_DIGEST_STRING_LENGTH
)));

106 *
	$SHA384_FeChunk
(cÚ¡ *, *, 
off_t
, off_t)

107 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA384_DIGEST_STRING_LENGTH
)));

108 *
	$SHA384_D©a
(cÚ¡ 
u_št8_t
 *, 
size_t
, *)

109 
	`__©Œibu‹__
((
	$__bounded__
(
__¡ršg__
,1,2)))

110 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,3,
SHA384_DIGEST_STRING_LENGTH
)));

113 
	`SHA512_In™
(
SHA512_CTX
 *);

114 
	`SHA512_T¿nsfÜm
(
u_št64_t
 
¡©e
[8], cÚ¡ 
u_št8_t
 [
SHA512_BLOCK_LENGTH
]);

115 
	$SHA512_Upd©e
(
SHA512_CTX
 *, cÚ¡ 
u_št8_t
 *, 
size_t
)

116 
	`__©Œibu‹__
((
	`__bounded__
(
__¡ršg__
,2,3)));

117 
	`SHA512_Pad
(
SHA512_CTX
 *);

118 
	$SHA512_Fš®
(
u_št8_t
 [
SHA512_DIGEST_LENGTH
], 
SHA512_CTX
 *)

119 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,1,
SHA512_DIGEST_LENGTH
)));

120 *
	$SHA512_End
(
SHA512_CTX
 *, *)

121 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA512_DIGEST_STRING_LENGTH
)));

122 *
	$SHA512_Fe
(const *, *)

123 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA512_DIGEST_STRING_LENGTH
)));

124 *
	$SHA512_FeChunk
(cÚ¡ *, *, 
off_t
, off_t)

125 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,2,
SHA512_DIGEST_STRING_LENGTH
)));

126 *
	$SHA512_D©a
(cÚ¡ 
u_št8_t
 *, 
size_t
, *)

127 
	`__©Œibu‹__
((
	$__bounded__
(
__¡ršg__
,1,2)))

128 
	`__©Œibu‹__
((
	`__bounded__
(
__mšby‹s__
,3,
SHA512_DIGEST_STRING_LENGTH
)));

131 (
OPENSSL_VERSION_NUMBER
 >= 0x00907000L) */

	@sftp-server/openbsd-compat/sigact.h

45 #iâdeà
_SIGACTION_H


46 
	#_SIGACTION_H


	)

48 #ià!
defšed
(
HAVE_SIGACTION
è&& defšed(
HAVE_SIGVEC
)

50 #undeà
SIG_BLOCK


51 
	#SIG_BLOCK
 00

	)

53 #undeà
SIG_UNBLOCK


54 
	#SIG_UNBLOCK
 01

	)

56 #undeà
SIG_SETMASK


57 
	#SIG_SETMASK
 02

	)

63 #ià
HAVE_BSD_SIGNAL_H


64 
	~<bsd/sigÇl.h
>

67 
	ssigaùiÚ


69 
sigvec
 
	msv
;

72 
	tsig£t_t
;

74 #undeà
§_mask


75 
	#§_mask
 
sv
.
sv_mask


	)

76 #undeà
§_hªdËr


77 
	#§_hªdËr
 
sv
.
sv_hªdËr


	)

78 #undeà
§_æags


79 
	#§_æags
 
sv
.
sv_æags


	)

81 
sigaùiÚ
(
sig
, sigaùiÚ *
sigaù
, sigaùiÚ *
osigaù
);

82 
sig´ocmask
 (
how
, 
sig£t_t
 *
mask
, sig£t_ˆ*
omask
);

83 
sigem±y£t
 (
sig£t_t
 *
mask
);

84 
sigsu¥’d
 (
sig£t_t
 *
mask
);

85 
sigd–£t
 (
sig£t_t
 *
mask
, 
sig
);

86 
sigadd£t
 (
sig£t_t
 *
mask
, 
sig
);

	@sftp-server/openbsd-compat/strmode.c

33 
	~"šşudes.h
"

34 #iâdeà
HAVE_STRMODE


36 
	~<sys/ty³s.h
>

37 
	~<sys/¡©.h
>

38 
	~<¡ršg.h
>

43 
	$¡rmode
(
mode
, *
p
)

46 
mode
 & 
S_IFMT
) {

47 
S_IFDIR
:

48 *
p
++ = 'd';

50 
S_IFCHR
:

51 *
p
++ = 'c';

53 
S_IFBLK
:

54 *
p
++ = 'b';

56 
S_IFREG
:

57 *
p
++ = '-';

59 
S_IFLNK
:

60 *
p
++ = 'l';

62 #ifdeà
S_IFSOCK


63 
S_IFSOCK
:

64 *
p
++ = 's';

67 #ifdeà
S_IFIFO


68 
S_IFIFO
:

69 *
p
++ = 'p';

73 *
p
++ = '?';

77 ià(
mode
 & 
S_IRUSR
)

78 *
p
++ = 'r';

80 *
p
++ = '-';

81 ià(
mode
 & 
S_IWUSR
)

82 *
p
++ = 'w';

84 *
p
++ = '-';

85 
mode
 & (
S_IXUSR
 | 
S_ISUID
)) {

87 *
p
++ = '-';

89 
S_IXUSR
:

90 *
p
++ = 'x';

92 
S_ISUID
:

93 *
p
++ = 'S';

95 
S_IXUSR
 | 
S_ISUID
:

96 *
p
++ = 's';

100 ià(
mode
 & 
S_IRGRP
)

101 *
p
++ = 'r';

103 *
p
++ = '-';

104 ià(
mode
 & 
S_IWGRP
)

105 *
p
++ = 'w';

107 *
p
++ = '-';

108 
mode
 & (
S_IXGRP
 | 
S_ISGID
)) {

110 *
p
++ = '-';

112 
S_IXGRP
:

113 *
p
++ = 'x';

115 
S_ISGID
:

116 *
p
++ = 'S';

118 
S_IXGRP
 | 
S_ISGID
:

119 *
p
++ = 's';

123 ià(
mode
 & 
S_IROTH
)

124 *
p
++ = 'r';

126 *
p
++ = '-';

127 ià(
mode
 & 
S_IWOTH
)

128 *
p
++ = 'w';

130 *
p
++ = '-';

131 
mode
 & (
S_IXOTH
 | 
S_ISVTX
)) {

133 *
p
++ = '-';

135 
S_IXOTH
:

136 *
p
++ = 'x';

138 
S_ISVTX
:

139 *
p
++ = 'T';

141 
S_IXOTH
 | 
S_ISVTX
:

142 *
p
++ = 't';

145 *
p
++ = ' ';

146 *
p
 = '\0';

147 
	}
}

	@sftp-server/openbsd-compat/strtonum.c

22 
	~"šşudes.h
"

24 #iâdeà
HAVE_STRTONUM


25 
	~<¡dlib.h
>

26 
	~<lim™s.h
>

27 
	~<”ºo.h
>

29 
	#INVALID
 1

	)

30 
	#TOOSMALL
 2

	)

31 
	#TOOLARGE
 3

	)

34 
	$¡¹Úum
(cÚ¡ *
num¡r
, 
mšv®
, 
maxv®
,

35 cÚ¡ **
”r¡½
)

37 
Î
 = 0;

38 *
•
;

39 
”rÜ
 = 0;

40 
	s”rv®
 {

41 cÚ¡ *
”r¡r
;

42 
”r
;

43 } 
ev
[4] = {

44 { 
NULL
, 0 },

45 { "šv®id", 
EINVAL
 },

46 { "toØsm®l", 
ERANGE
 },

47 { "toØÏrge", 
ERANGE
 },

50 
ev
[0].
”r
 = 
”ºo
;

51 
”ºo
 = 0;

52 ià(
mšv®
 > 
maxv®
)

53 
”rÜ
 = 
INVALID
;

55 
Î
 = 
	`¡¹Şl
(
num¡r
, &
•
, 10);

56 ià(
num¡r
 =ğ
•
 || *ep != '\0')

57 
”rÜ
 = 
INVALID
;

58 ià((
Î
 =ğ
LLONG_MIN
 && 
”ºo
 =ğ
ERANGE
è||†È< 
mšv®
)

59 
”rÜ
 = 
TOOSMALL
;

60 ià((
Î
 =ğ
LLONG_MAX
 && 
”ºo
 =ğ
ERANGE
è||†È> 
maxv®
)

61 
”rÜ
 = 
TOOLARGE
;

63 ià(
”r¡½
 !ğ
NULL
)

64 *
”r¡½
 = 
ev
[
”rÜ
].
”r¡r
;

65 
”ºo
 = 
ev
[
”rÜ
].
”r
;

66 ià(
”rÜ
)

67 
Î
 = 0;

69  (
Î
);

70 
	}
}

	@sftp-server/openbsd-compat/sys-queue.h

37 #iâdef 
_FAKE_QUEUE_H_


38 
	#_FAKE_QUEUE_H_


	)

44 #undeà
SLIST_HEAD


45 #undeà
SLIST_HEAD_INITIALIZER


46 #undeà
SLIST_ENTRY


47 #undeà
SLIST_FOREACH_PREVPTR


48 #undeà
SLIST_FIRST


49 #undeà
SLIST_END


50 #undeà
SLIST_EMPTY


51 #undeà
SLIST_NEXT


52 #undeà
SLIST_FOREACH


53 #undeà
SLIST_INIT


54 #undeà
SLIST_INSERT_AFTER


55 #undeà
SLIST_INSERT_HEAD


56 #undeà
SLIST_REMOVE_HEAD


57 #undeà
SLIST_REMOVE


58 #undeà
SLIST_REMOVE_NEXT


59 #undeà
LIST_HEAD


60 #undeà
LIST_HEAD_INITIALIZER


61 #undeà
LIST_ENTRY


62 #undeà
LIST_FIRST


63 #undeà
LIST_END


64 #undeà
LIST_EMPTY


65 #undeà
LIST_NEXT


66 #undeà
LIST_FOREACH


67 #undeà
LIST_INIT


68 #undeà
LIST_INSERT_AFTER


69 #undeà
LIST_INSERT_BEFORE


70 #undeà
LIST_INSERT_HEAD


71 #undeà
LIST_REMOVE


72 #undeà
LIST_REPLACE


73 #undeà
SIMPLEQ_HEAD


74 #undeà
SIMPLEQ_HEAD_INITIALIZER


75 #undeà
SIMPLEQ_ENTRY


76 #undeà
SIMPLEQ_FIRST


77 #undeà
SIMPLEQ_END


78 #undeà
SIMPLEQ_EMPTY


79 #undeà
SIMPLEQ_NEXT


80 #undeà
SIMPLEQ_FOREACH


81 #undeà
SIMPLEQ_INIT


82 #undeà
SIMPLEQ_INSERT_HEAD


83 #undeà
SIMPLEQ_INSERT_TAIL


84 #undeà
SIMPLEQ_INSERT_AFTER


85 #undeà
SIMPLEQ_REMOVE_HEAD


86 #undeà
TAILQ_HEAD


87 #undeà
TAILQ_HEAD_INITIALIZER


88 #undeà
TAILQ_ENTRY


89 #undeà
TAILQ_FIRST


90 #undeà
TAILQ_END


91 #undeà
TAILQ_NEXT


92 #undeà
TAILQ_LAST


93 #undeà
TAILQ_PREV


94 #undeà
TAILQ_EMPTY


95 #undeà
TAILQ_FOREACH


96 #undeà
TAILQ_FOREACH_REVERSE


97 #undeà
TAILQ_INIT


98 #undeà
TAILQ_INSERT_HEAD


99 #undeà
TAILQ_INSERT_TAIL


100 #undeà
TAILQ_INSERT_AFTER


101 #undeà
TAILQ_INSERT_BEFORE


102 #undeà
TAILQ_REMOVE


103 #undeà
TAILQ_REPLACE


104 #undeà
CIRCLEQ_HEAD


105 #undeà
CIRCLEQ_HEAD_INITIALIZER


106 #undeà
CIRCLEQ_ENTRY


107 #undeà
CIRCLEQ_FIRST


108 #undeà
CIRCLEQ_LAST


109 #undeà
CIRCLEQ_END


110 #undeà
CIRCLEQ_NEXT


111 #undeà
CIRCLEQ_PREV


112 #undeà
CIRCLEQ_EMPTY


113 #undeà
CIRCLEQ_FOREACH


114 #undeà
CIRCLEQ_FOREACH_REVERSE


115 #undeà
CIRCLEQ_INIT


116 #undeà
CIRCLEQ_INSERT_AFTER


117 #undeà
CIRCLEQ_INSERT_BEFORE


118 #undeà
CIRCLEQ_INSERT_HEAD


119 #undeà
CIRCLEQ_INSERT_TAIL


120 #undeà
CIRCLEQ_REMOVE


121 #undeà
CIRCLEQ_REPLACE


170 #ià
defšed
(
QUEUE_MACRO_DEBUG
è|| (defšed(
_KERNEL
è&& defšed(
DIAGNOSTIC
))

171 
	#_Q_INVALIDATE
(
a
è×èğ((*)-1)

	)

173 
	#_Q_INVALIDATE
(
a
)

	)

179 
	#SLIST_HEAD
(
Çme
, 
ty³
) \

180 
	sÇme
 { \

181 
ty³
 *
¦h_fœ¡
; \

182 }

	)

184 
	#SLIST_HEAD_INITIALIZER
(
h—d
) \

185 { 
NULL
 }

	)

187 
	#SLIST_ENTRY
(
ty³
) \

189 
ty³
 *
¦e_Ãxt
; \

190 }

	)

195 
	#SLIST_FIRST
(
h—d
è((h—d)->
¦h_fœ¡
)

	)

196 
	#SLIST_END
(
h—d
è
NULL


	)

197 
	#SLIST_EMPTY
(
h—d
è(
	`SLIST_FIRST
(h—dè=ğ
	`SLIST_END
(h—d))

	)

198 
	#SLIST_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
¦e_Ãxt
)

	)

200 
	#SLIST_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

201 (
v¬
èğ
	`SLIST_FIRST
(
h—d
); \

202 (
v¬
è!ğ
	`SLIST_END
(
h—d
); \

203 (
v¬
èğ
	`SLIST_NEXT
(v¬, 
f›ld
))

	)

205 
	#SLIST_FOREACH_PREVPTR
(
v¬
, 
v¬p
, 
h—d
, 
f›ld
) \

206 (
v¬p
èğ&
	`SLIST_FIRST
((
h—d
)); \

207 ((
v¬
èğ*(
v¬p
)è!ğ
	`SLIST_END
(
h—d
); \

208 (
v¬p
èğ&
	`SLIST_NEXT
((
v¬
), 
f›ld
))

	)

213 
	#SLIST_INIT
(
h—d
) { \

214 
	`SLIST_FIRST
(
h—d
èğ
	`SLIST_END
(head); \

215 }

	)

217 
	#SLIST_INSERT_AFTER
(
¦i¡–m
, 
–m
, 
f›ld
) do { \

218 (
–m
)->
f›ld
.
¦e_Ãxt
 = (
¦i¡–m
)->field.sle_next; \

219 (
¦i¡–m
)->
f›ld
.
¦e_Ãxt
 = (
–m
); \

220 } 0)

	)

222 
	#SLIST_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

223 (
–m
)->
f›ld
.
¦e_Ãxt
 = (
h—d
)->
¦h_fœ¡
; \

224 (
h—d
)->
¦h_fœ¡
 = (
–m
); \

225 } 0)

	)

227 
	#SLIST_REMOVE_NEXT
(
h—d
, 
–m
, 
f›ld
) do { \

228 (
–m
)->
f›ld
.
¦e_Ãxt
 = (elm)->field.sle_next->field.sle_next; \

229 } 0)

	)

231 
	#SLIST_REMOVE_HEAD
(
h—d
, 
f›ld
) do { \

232 (
h—d
)->
¦h_fœ¡
 = (h—d)->¦h_fœ¡->
f›ld
.
¦e_Ãxt
; \

233 } 0)

	)

235 
	#SLIST_REMOVE
(
h—d
, 
–m
, 
ty³
, 
f›ld
) do { \

236 ià((
h—d
)->
¦h_fœ¡
 =ğ(
–m
)) { \

237 
	`SLIST_REMOVE_HEAD
((
h—d
), 
f›ld
); \

239 
ty³
 *
cu»lm
 = (
h—d
)->
¦h_fœ¡
; \

241 
cu»lm
->
f›ld
.
¦e_Ãxt
 !ğ(
–m
)) \

242 
cu»lm
 = cu»lm->
f›ld
.
¦e_Ãxt
; \

243 
cu»lm
->
f›ld
.
¦e_Ãxt
 = \

244 
cu»lm
->
f›ld
.
¦e_Ãxt
->field.sle_next; \

245 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
¦e_Ãxt
); \

247 } 0)

	)

252 
	#LIST_HEAD
(
Çme
, 
ty³
) \

253 
	sÇme
 { \

254 
ty³
 *
lh_fœ¡
; \

255 }

	)

257 
	#LIST_HEAD_INITIALIZER
(
h—d
) \

258 { 
NULL
 }

	)

260 
	#LIST_ENTRY
(
ty³
) \

262 
ty³
 *
Ë_Ãxt
; \

263 
ty³
 **
Ë_´ev
; \

264 }

	)

269 
	#LIST_FIRST
(
h—d
è((h—d)->
lh_fœ¡
)

	)

270 
	#LIST_END
(
h—d
è
NULL


	)

271 
	#LIST_EMPTY
(
h—d
è(
	`LIST_FIRST
(h—dè=ğ
	`LIST_END
(h—d))

	)

272 
	#LIST_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
Ë_Ãxt
)

	)

274 
	#LIST_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

275 (
v¬
èğ
	`LIST_FIRST
(
h—d
); \

276 (
v¬
)!ğ
	`LIST_END
(
h—d
); \

277 (
v¬
èğ
	`LIST_NEXT
(v¬, 
f›ld
))

	)

282 
	#LIST_INIT
(
h—d
) do { \

283 
	`LIST_FIRST
(
h—d
èğ
	`LIST_END
(head); \

284 } 0)

	)

286 
	#LIST_INSERT_AFTER
(
li¡–m
, 
–m
, 
f›ld
) do { \

287 ià(((
–m
)->
f›ld
.
Ë_Ãxt
 = (
li¡–m
)->f›ld.Ë_Ãxtè!ğ
NULL
) \

288 (
li¡–m
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

289 &(
–m
)->
f›ld
.
Ë_Ãxt
; \

290 (
li¡–m
)->
f›ld
.
Ë_Ãxt
 = (
–m
); \

291 (
–m
)->
f›ld
.
Ë_´ev
 = &(
li¡–m
)->f›ld.
Ë_Ãxt
; \

292 } 0)

	)

294 
	#LIST_INSERT_BEFORE
(
li¡–m
, 
–m
, 
f›ld
) do { \

295 (
–m
)->
f›ld
.
Ë_´ev
 = (
li¡–m
)->field.le_prev; \

296 (
–m
)->
f›ld
.
Ë_Ãxt
 = (
li¡–m
); \

297 *(
li¡–m
)->
f›ld
.
Ë_´ev
 = (
–m
); \

298 (
li¡–m
)->
f›ld
.
Ë_´ev
 = &(
–m
)->f›ld.
Ë_Ãxt
; \

299 } 0)

	)

301 
	#LIST_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

302 ià(((
–m
)->
f›ld
.
Ë_Ãxt
 = (
h—d
)->
lh_fœ¡
è!ğ
NULL
) \

303 (
h—d
)->
lh_fœ¡
->
f›ld
.
Ë_´ev
 = &(
–m
)->f›ld.
Ë_Ãxt
;\

304 (
h—d
)->
lh_fœ¡
 = (
–m
); \

305 (
–m
)->
f›ld
.
Ë_´ev
 = &(
h—d
)->
lh_fœ¡
; \

306 } 0)

	)

308 
	#LIST_REMOVE
(
–m
, 
f›ld
) do { \

309 ià((
–m
)->
f›ld
.
Ë_Ãxt
 !ğ
NULL
) \

310 (
–m
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

311 (
–m
)->
f›ld
.
Ë_´ev
; \

312 *(
–m
)->
f›ld
.
Ë_´ev
 = (–m)->f›ld.
Ë_Ãxt
; \

313 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_´ev
); \

314 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_Ãxt
); \

315 } 0)

	)

317 
	#LIST_REPLACE
(
–m
, 
–m2
, 
f›ld
) do { \

318 ià(((
–m2
)->
f›ld
.
Ë_Ãxt
 = (
–m
)->f›ld.Ë_Ãxtè!ğ
NULL
) \

319 (
–m2
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

320 &(
–m2
)->
f›ld
.
Ë_Ãxt
; \

321 (
–m2
)->
f›ld
.
Ë_´ev
 = (
–m
)->field.le_prev; \

322 *(
–m2
)->
f›ld
.
Ë_´ev
 = (elm2); \

323 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_´ev
); \

324 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_Ãxt
); \

325 } 0)

	)

330 
	#SIMPLEQ_HEAD
(
Çme
, 
ty³
) \

331 
	sÇme
 { \

332 
ty³
 *
sqh_fœ¡
; \

333 
ty³
 **
sqh_Ï¡
; \

334 }

	)

336 
	#SIMPLEQ_HEAD_INITIALIZER
(
h—d
) \

337 { 
NULL
, &(
h—d
).
sqh_fœ¡
 }

	)

339 
	#SIMPLEQ_ENTRY
(
ty³
) \

341 
ty³
 *
sqe_Ãxt
; \

342 }

	)

347 
	#SIMPLEQ_FIRST
(
h—d
è((h—d)->
sqh_fœ¡
)

	)

348 
	#SIMPLEQ_END
(
h—d
è
NULL


	)

349 
	#SIMPLEQ_EMPTY
(
h—d
è(
	`SIMPLEQ_FIRST
(h—dè=ğ
	`SIMPLEQ_END
(h—d))

	)

350 
	#SIMPLEQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
sqe_Ãxt
)

	)

352 
	#SIMPLEQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

353 (
v¬
èğ
	`SIMPLEQ_FIRST
(
h—d
); \

354 (
v¬
è!ğ
	`SIMPLEQ_END
(
h—d
); \

355 (
v¬
èğ
	`SIMPLEQ_NEXT
(v¬, 
f›ld
))

	)

360 
	#SIMPLEQ_INIT
(
h—d
) do { \

361 (
h—d
)->
sqh_fœ¡
 = 
NULL
; \

362 (
h—d
)->
sqh_Ï¡
 = &(h—d)->
sqh_fœ¡
; \

363 } 0)

	)

365 
	#SIMPLEQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

366 ià(((
–m
)->
f›ld
.
sqe_Ãxt
 = (
h—d
)->
sqh_fœ¡
è=ğ
NULL
) \

367 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

368 (
h—d
)->
sqh_fœ¡
 = (
–m
); \

369 } 0)

	)

371 
	#SIMPLEQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

372 (
–m
)->
f›ld
.
sqe_Ãxt
 = 
NULL
; \

373 *(
h—d
)->
sqh_Ï¡
 = (
–m
); \

374 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

375 } 0)

	)

377 
	#SIMPLEQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

378 ià(((
–m
)->
f›ld
.
sqe_Ãxt
 = (
li¡–m
)->f›ld.sqe_Ãxtè=ğ
NULL
)\

379 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

380 (
li¡–m
)->
f›ld
.
sqe_Ãxt
 = (
–m
); \

381 } 0)

	)

383 
	#SIMPLEQ_REMOVE_HEAD
(
h—d
, 
f›ld
) do { \

384 ià(((
h—d
)->
sqh_fœ¡
 = (h—d)->sqh_fœ¡->
f›ld
.
sqe_Ãxt
è=ğ
NULL
) \

385 (
h—d
)->
sqh_Ï¡
 = &(h—d)->
sqh_fœ¡
; \

386 } 0)

	)

391 
	#TAILQ_HEAD
(
Çme
, 
ty³
) \

392 
	sÇme
 { \

393 
ty³
 *
tqh_fœ¡
; \

394 
ty³
 **
tqh_Ï¡
; \

395 }

	)

397 
	#TAILQ_HEAD_INITIALIZER
(
h—d
) \

398 { 
NULL
, &(
h—d
).
tqh_fœ¡
 }

	)

400 
	#TAILQ_ENTRY
(
ty³
) \

402 
ty³
 *
tqe_Ãxt
; \

403 
ty³
 **
tqe_´ev
; \

404 }

	)

409 
	#TAILQ_FIRST
(
h—d
è((h—d)->
tqh_fœ¡
)

	)

410 
	#TAILQ_END
(
h—d
è
NULL


	)

411 
	#TAILQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
tqe_Ãxt
)

	)

412 
	#TAILQ_LAST
(
h—d
, 
h—dÇme
) \

413 (*(((
h—dÇme
 *)((
h—d
)->
tqh_Ï¡
))->tqh_Ï¡))

	)

415 
	#TAILQ_PREV
(
–m
, 
h—dÇme
, 
f›ld
) \

416 (*(((
h—dÇme
 *)((
–m
)->
f›ld
.
tqe_´ev
))->
tqh_Ï¡
))

	)

417 
	#TAILQ_EMPTY
(
h—d
) \

418 (
	`TAILQ_FIRST
(
h—d
è=ğ
	`TAILQ_END
(h—d))

	)

420 
	#TAILQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

421 (
v¬
èğ
	`TAILQ_FIRST
(
h—d
); \

422 (
v¬
è!ğ
	`TAILQ_END
(
h—d
); \

423 (
v¬
èğ
	`TAILQ_NEXT
(v¬, 
f›ld
))

	)

425 
	#TAILQ_FOREACH_REVERSE
(
v¬
, 
h—d
, 
h—dÇme
, 
f›ld
) \

426 (
v¬
èğ
	`TAILQ_LAST
(
h—d
, 
h—dÇme
); \

427 (
v¬
è!ğ
	`TAILQ_END
(
h—d
); \

428 (
v¬
èğ
	`TAILQ_PREV
(v¬, 
h—dÇme
, 
f›ld
))

	)

433 
	#TAILQ_INIT
(
h—d
) do { \

434 (
h—d
)->
tqh_fœ¡
 = 
NULL
; \

435 (
h—d
)->
tqh_Ï¡
 = &(h—d)->
tqh_fœ¡
; \

436 } 0)

	)

438 
	#TAILQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

439 ià(((
–m
)->
f›ld
.
tqe_Ãxt
 = (
h—d
)->
tqh_fœ¡
è!ğ
NULL
) \

440 (
h—d
)->
tqh_fœ¡
->
f›ld
.
tqe_´ev
 = \

441 &(
–m
)->
f›ld
.
tqe_Ãxt
; \

443 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

444 (
h—d
)->
tqh_fœ¡
 = (
–m
); \

445 (
–m
)->
f›ld
.
tqe_´ev
 = &(
h—d
)->
tqh_fœ¡
; \

446 } 0)

	)

448 
	#TAILQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

449 (
–m
)->
f›ld
.
tqe_Ãxt
 = 
NULL
; \

450 (
–m
)->
f›ld
.
tqe_´ev
 = (
h—d
)->
tqh_Ï¡
; \

451 *(
h—d
)->
tqh_Ï¡
 = (
–m
); \

452 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

453 } 0)

	)

455 
	#TAILQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

456 ià(((
–m
)->
f›ld
.
tqe_Ãxt
 = (
li¡–m
)->f›ld.tqe_Ãxtè!ğ
NULL
)\

457 (
–m
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

458 &(
–m
)->
f›ld
.
tqe_Ãxt
; \

460 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

461 (
li¡–m
)->
f›ld
.
tqe_Ãxt
 = (
–m
); \

462 (
–m
)->
f›ld
.
tqe_´ev
 = &(
li¡–m
)->f›ld.
tqe_Ãxt
; \

463 } 0)

	)

465 
	#TAILQ_INSERT_BEFORE
(
li¡–m
, 
–m
, 
f›ld
) do { \

466 (
–m
)->
f›ld
.
tqe_´ev
 = (
li¡–m
)->field.tqe_prev; \

467 (
–m
)->
f›ld
.
tqe_Ãxt
 = (
li¡–m
); \

468 *(
li¡–m
)->
f›ld
.
tqe_´ev
 = (
–m
); \

469 (
li¡–m
)->
f›ld
.
tqe_´ev
 = &(
–m
)->f›ld.
tqe_Ãxt
; \

470 } 0)

	)

472 
	#TAILQ_REMOVE
(
h—d
, 
–m
, 
f›ld
) do { \

473 ià(((
–m
)->
f›ld
.
tqe_Ãxt
è!ğ
NULL
) \

474 (
–m
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

475 (
–m
)->
f›ld
.
tqe_´ev
; \

477 (
h—d
)->
tqh_Ï¡
 = (
–m
)->
f›ld
.
tqe_´ev
; \

478 *(
–m
)->
f›ld
.
tqe_´ev
 = (–m)->f›ld.
tqe_Ãxt
; \

479 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_´ev
); \

480 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_Ãxt
); \

481 } 0)

	)

483 
	#TAILQ_REPLACE
(
h—d
, 
–m
, 
–m2
, 
f›ld
) do { \

484 ià(((
–m2
)->
f›ld
.
tqe_Ãxt
 = (
–m
)->f›ld.tqe_Ãxtè!ğ
NULL
) \

485 (
–m2
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

486 &(
–m2
)->
f›ld
.
tqe_Ãxt
; \

488 (
h—d
)->
tqh_Ï¡
 = &(
–m2
)->
f›ld
.
tqe_Ãxt
; \

489 (
–m2
)->
f›ld
.
tqe_´ev
 = (
–m
)->field.tqe_prev; \

490 *(
–m2
)->
f›ld
.
tqe_´ev
 = (elm2); \

491 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_´ev
); \

492 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_Ãxt
); \

493 } 0)

	)

498 
	#CIRCLEQ_HEAD
(
Çme
, 
ty³
) \

499 
	sÇme
 { \

500 
ty³
 *
cqh_fœ¡
; \

501 
ty³
 *
cqh_Ï¡
; \

502 }

	)

504 
	#CIRCLEQ_HEAD_INITIALIZER
(
h—d
) \

505 { 
	`CIRCLEQ_END
(&
h—d
), CIRCLEQ_END(&h—dè}

	)

507 
	#CIRCLEQ_ENTRY
(
ty³
) \

509 
ty³
 *
cqe_Ãxt
; \

510 
ty³
 *
cqe_´ev
; \

511 }

	)

516 
	#CIRCLEQ_FIRST
(
h—d
è((h—d)->
cqh_fœ¡
)

	)

517 
	#CIRCLEQ_LAST
(
h—d
è((h—d)->
cqh_Ï¡
)

	)

518 
	#CIRCLEQ_END
(
h—d
è((*)(h—d))

	)

519 
	#CIRCLEQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
cqe_Ãxt
)

	)

520 
	#CIRCLEQ_PREV
(
–m
, 
f›ld
è(Ólm)->f›ld.
cqe_´ev
)

	)

521 
	#CIRCLEQ_EMPTY
(
h—d
) \

522 (
	`CIRCLEQ_FIRST
(
h—d
è=ğ
	`CIRCLEQ_END
(h—d))

	)

524 
	#CIRCLEQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

525 (
v¬
èğ
	`CIRCLEQ_FIRST
(
h—d
); \

526 (
v¬
è!ğ
	`CIRCLEQ_END
(
h—d
); \

527 (
v¬
èğ
	`CIRCLEQ_NEXT
(v¬, 
f›ld
))

	)

529 
	#CIRCLEQ_FOREACH_REVERSE
(
v¬
, 
h—d
, 
f›ld
) \

530 (
v¬
èğ
	`CIRCLEQ_LAST
(
h—d
); \

531 (
v¬
è!ğ
	`CIRCLEQ_END
(
h—d
); \

532 (
v¬
èğ
	`CIRCLEQ_PREV
(v¬, 
f›ld
))

	)

537 
	#CIRCLEQ_INIT
(
h—d
) do { \

538 (
h—d
)->
cqh_fœ¡
 = 
	`CIRCLEQ_END
(head); \

539 (
h—d
)->
cqh_Ï¡
 = 
	`CIRCLEQ_END
(head); \

540 } 0)

	)

542 
	#CIRCLEQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

543 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
li¡–m
)->field.cqe_next; \

544 (
–m
)->
f›ld
.
cqe_´ev
 = (
li¡–m
); \

545 ià((
li¡–m
)->
f›ld
.
cqe_Ãxt
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

546 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

548 (
li¡–m
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = (
–m
); \

549 (
li¡–m
)->
f›ld
.
cqe_Ãxt
 = (
–m
); \

550 } 0)

	)

552 
	#CIRCLEQ_INSERT_BEFORE
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

553 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
li¡–m
); \

554 (
–m
)->
f›ld
.
cqe_´ev
 = (
li¡–m
)->field.cqe_prev; \

555 ià((
li¡–m
)->
f›ld
.
cqe_´ev
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

556 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

558 (
li¡–m
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = (
–m
); \

559 (
li¡–m
)->
f›ld
.
cqe_´ev
 = (
–m
); \

560 } 0)

	)

562 
	#CIRCLEQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

563 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
h—d
)->
cqh_fœ¡
; \

564 (
–m
)->
f›ld
.
cqe_´ev
 = 
	`CIRCLEQ_END
(
h—d
); \

565 ià((
h—d
)->
cqh_Ï¡
 =ğ
	`CIRCLEQ_END
(head)) \

566 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

568 (
h—d
)->
cqh_fœ¡
->
f›ld
.
cqe_´ev
 = (
–m
); \

569 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

570 } 0)

	)

572 
	#CIRCLEQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

573 (
–m
)->
f›ld
.
cqe_Ãxt
 = 
	`CIRCLEQ_END
(
h—d
); \

574 (
–m
)->
f›ld
.
cqe_´ev
 = (
h—d
)->
cqh_Ï¡
; \

575 ià((
h—d
)->
cqh_fœ¡
 =ğ
	`CIRCLEQ_END
(head)) \

576 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

578 (
h—d
)->
cqh_Ï¡
->
f›ld
.
cqe_Ãxt
 = (
–m
); \

579 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

580 } 0)

	)

582 
	#CIRCLEQ_REMOVE
(
h—d
, 
–m
, 
f›ld
) do { \

583 ià((
–m
)->
f›ld
.
cqe_Ãxt
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

584 (
h—d
)->
cqh_Ï¡
 = (
–m
)->
f›ld
.
cqe_´ev
; \

586 (
–m
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = \

587 (
–m
)->
f›ld
.
cqe_´ev
; \

588 ià((
–m
)->
f›ld
.
cqe_´ev
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

589 (
h—d
)->
cqh_fœ¡
 = (
–m
)->
f›ld
.
cqe_Ãxt
; \

591 (
–m
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = \

592 (
–m
)->
f›ld
.
cqe_Ãxt
; \

593 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_´ev
); \

594 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_Ãxt
); \

595 } 0)

	)

597 
	#CIRCLEQ_REPLACE
(
h—d
, 
–m
, 
–m2
, 
f›ld
) do { \

598 ià(((
–m2
)->
f›ld
.
cqe_Ãxt
 = (
–m
)->field.cqe_next) == \

599 
	`CIRCLEQ_END
(
h—d
)) \

600 (
h—d
).
cqh_Ï¡
 = (
–m2
); \

602 (
–m2
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = (elm2); \

603 ià(((
–m2
)->
f›ld
.
cqe_´ev
 = (
–m
)->field.cqe_prev) == \

604 
	`CIRCLEQ_END
(
h—d
)) \

605 (
h—d
).
cqh_fœ¡
 = (
–m2
); \

607 (
–m2
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = (elm2); \

608 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_´ev
); \

609 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_Ãxt
); \

610 } 0)

	)

	@sftp-server/openbsd-compat/vis.c

33 
	~"šşudes.h
"

34 #ià!
defšed
(
HAVE_STRNVIS
)

36 
	~<ùy³.h
>

37 
	~<¡ršg.h
>

39 
	~"vis.h
"

41 
	#isoù®
(
c
è(((
u_ch¬
)(c)è>ğ'0' && ((u_ch¬)(c)è<ğ'7')

	)

42 
	#isvisibË
(
c
) \

43 (((
u_št
)(
c
è<ğ
UCHAR_MAX
 && 
	`i§scii
((
u_ch¬
)(c)) && \

44 (((
c
) != '*' && (c) != '?' && (c) != '[' && (c) != '#') || \

45 (
æag
 & 
VIS_GLOB
è=ğ0è&& 
	`isg¿ph
((
u_ch¬
)(
c
))) || \

46 ((
æag
 & 
VIS_SP
è=ğ0 && (
c
) == ' ') || \

47 ((
æag
 & 
VIS_TAB
è=ğ0 && (
c
) == '\t') || \

48 ((
æag
 & 
VIS_NL
è=ğ0 && (
c
) == '\n') || \

49 ((
æag
 & 
VIS_SAFE
è&& ((
c
) == '\b' || \

50 (
c
) == '\007' || (c) == '\r' || \

51 
	`isg¿ph
((
u_ch¬
)(
c
)))))

	)

57 
	$vis
(*
d¡
, 
c
, 
æag
, 
Ãxtc
)

59 ià(
	`isvisibË
(
c
)) {

60 *
d¡
++ = 
c
;

61 ià(
c
 =ğ'\\' && (
æag
 & 
VIS_NOSLASH
) == 0)

62 *
d¡
++ = '\\';

63 *
d¡
 = '\0';

64  (
d¡
);

67 ià(
æag
 & 
VIS_CSTYLE
) {

68 
c
) {

70 *
d¡
++ = '\\';

71 *
d¡
++ = 'n';

72 
dÚe
;

74 *
d¡
++ = '\\';

75 *
d¡
++ = 'r';

76 
dÚe
;

78 *
d¡
++ = '\\';

79 *
d¡
++ = 'b';

80 
dÚe
;

82 *
d¡
++ = '\\';

83 *
d¡
++ = 'a';

84 
dÚe
;

86 *
d¡
++ = '\\';

87 *
d¡
++ = 'v';

88 
dÚe
;

90 *
d¡
++ = '\\';

91 *
d¡
++ = 't';

92 
dÚe
;

94 *
d¡
++ = '\\';

95 *
d¡
++ = 'f';

96 
dÚe
;

98 *
d¡
++ = '\\';

99 *
d¡
++ = 's';

100 
dÚe
;

102 *
d¡
++ = '\\';

103 *
d¡
++ = '0';

104 ià(
	`isoù®
(
Ãxtc
)) {

105 *
d¡
++ = '0';

106 *
d¡
++ = '0';

108 
dÚe
;

111 ià(((
c
 & 0177è=ğ' 'è|| (
æag
 & 
VIS_OCTAL
) ||

112 ((
æag
 & 
VIS_GLOB
è&& (
c
 == '*' || c == '?' || c == '[' || c == '#'))) {

113 *
d¡
++ = '\\';

114 *
d¡
++ = ((
u_ch¬
)
c
 >> 6 & 07) + '0';

115 *
d¡
++ = ((
u_ch¬
)
c
 >> 3 & 07) + '0';

116 *
d¡
++ = ((
u_ch¬
)
c
 & 07) + '0';

117 
dÚe
;

119 ià((
æag
 & 
VIS_NOSLASH
) == 0)

120 *
d¡
++ = '\\';

121 ià(
c
 & 0200) {

122 
c
 &= 0177;

123 *
d¡
++ = 'M';

125 ià(
	`isúŒl
((
u_ch¬
)
c
)) {

126 *
d¡
++ = '^';

127 ià(
c
 == 0177)

128 *
d¡
++ = '?';

130 *
d¡
++ = 
c
 + '@';

132 *
d¡
++ = '-';

133 *
d¡
++ = 
c
;

135 
dÚe
:

136 *
d¡
 = '\0';

137  (
d¡
);

138 
	}
}

154 
	$¡rvis
(*
d¡
, cÚ¡ *
¤c
, 
æag
)

156 
c
;

157 *
¡¬t
;

159 
¡¬t
 = 
d¡
; (
c
 = *
¤c
);)

160 
d¡
 = 
	`vis
(d¡, 
c
, 
æag
, *++
¤c
);

161 *
d¡
 = '\0';

162  (
d¡
 - 
¡¬t
);

163 
	}
}

166 
	$¡ºvis
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
siz
, 
æag
)

168 *
¡¬t
, *
’d
;

169 
tbuf
[5];

170 
c
, 
i
;

172 
i
 = 0;

173 
¡¬t
 = 
d¡
, 
’d
 = s¹ + 
siz
 - 1; (
c
 = *
¤c
) && dst <ƒnd; ) {

174 ià(
	`isvisibË
(
c
)) {

175 
i
 = 1;

176 *
d¡
++ = 
c
;

177 ià(
c
 =ğ'\\' && (
æag
 & 
VIS_NOSLASH
) == 0) {

179 ià(
d¡
 < 
’d
)

180 *
d¡
++ = '\\';

182 
d¡
--;

183 
i
 = 2;

187 
¤c
++;

189 
i
 = 
	`vis
(
tbuf
, 
c
, 
æag
, *++
¤c
) -buf;

190 ià(
d¡
 + 
i
 <ğ
’d
) {

191 
	`memıy
(
d¡
, 
tbuf
, 
i
);

192 
d¡
 +ğ
i
;

194 
¤c
--;

199 ià(
siz
 > 0)

200 *
d¡
 = '\0';

201 ià(
d¡
 + 
i
 > 
’d
) {

203 (
c
 = *
¤c
))

204 
d¡
 +ğ
	`vis
(
tbuf
, 
c
, 
æag
, *++
¤c
) -buf;

206  (
d¡
 - 
¡¬t
);

207 
	}
}

210 
	$¡rvisx
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
Ën
, 
æag
)

212 
c
;

213 *
¡¬t
;

215 
¡¬t
 = 
d¡
; 
Ën
 > 1;†en--) {

216 
c
 = *
¤c
;

217 
d¡
 = 
	`vis
(d¡, 
c
, 
æag
, *++
¤c
);

219 ià(
Ën
)

220 
d¡
 = 
	`vis
(d¡, *
¤c
, 
æag
, '\0');

221 *
d¡
 = '\0';

222  (
d¡
 - 
¡¬t
);

223 
	}
}

	@sftp-server/openbsd-compat/vis.h

37 
	~"šşudes.h
"

38 #ià!
defšed
(
HAVE_STRNVIS
)

40 #iâdeà
_VIS_H_


41 
	#_VIS_H_


	)

43 
	~<sys/ty³s.h
>

44 
	~<lim™s.h
>

49 
	#VIS_OCTAL
 0x01

	)

50 
	#VIS_CSTYLE
 0x02

	)

56 
	#VIS_SP
 0x04

	)

57 
	#VIS_TAB
 0x08

	)

58 
	#VIS_NL
 0x10

	)

59 
	#VIS_WHITE
 (
VIS_SP
 | 
VIS_TAB
 | 
VIS_NL
)

	)

60 
	#VIS_SAFE
 0x20

	)

65 
	#VIS_NOSLASH
 0x40

	)

66 
	#VIS_GLOB
 0x100

	)

71 
	#UNVIS_VALID
 1

	)

72 
	#UNVIS_VALIDPUSH
 2

	)

73 
	#UNVIS_NOCHAR
 3

	)

74 
	#UNVIS_SYNBAD
 -1

	)

75 
	#UNVIS_ERROR
 -2

	)

80 
	#UNVIS_END
 1

	)

82 *
vis
(*, , , );

83 
¡rvis
(*, const *, );

84 
	$¡ºvis
(*, cÚ¡ *, 
size_t
, )

85 
	`__©Œibu‹__
 ((
	`__bounded__
(
__¡ršg__
,1,3)));

86 
	$¡rvisx
(*, cÚ¡ *, 
size_t
, )

87 
	`__©Œibu‹__
 ((
	`__bounded__
(
__¡ršg__
,1,3)));

88 
	`¡runvis
(*, const *);

89 
	`unvis
(*, , *, );

90 
ssize_t
 
	$¡ºunvis
(*, cÚ¡ *, 
size_t
)

91 
	`__©Œibu‹__
 ((
	`__bounded__
(
__¡ršg__
,1,3)));

	@sftp-server/openssl/bn.h

1 
	#BIGNUM
 

	)

	@sftp-server/openssl/opensslv.h

	@sftp-server/packet.h

16 #iâdeà
PACKET_H


17 
	#PACKET_H


	)

19 
	~<‹rmios.h
>

21 
	~<İ’s¦/bn.h
>

23 
·ck‘_£t_cÚÃùiÚ
(, );

24 
·ck‘_£t_timeout
(, );

25 
·ck‘_£t_nÚblockšg
();

26 
·ck‘_g‘_cÚÃùiÚ_š
();

27 
·ck‘_g‘_cÚÃùiÚ_out
();

28 
·ck‘_şo£
();

29 
·ck‘_£t_’üy±iÚ_key
(cÚ¡ 
u_ch¬
 *, 
u_št
, );

30 
u_št
 
·ck‘_g‘_’üy±iÚ_key
(
u_ch¬
 *);

31 
·ck‘_£t_´ÙocŞ_æags
(
u_št
);

32 
u_št
 
·ck‘_g‘_´ÙocŞ_æags
();

33 
·ck‘_¡¬t_com´essiÚ
();

34 
·ck‘_£t_š‹¿ùive
();

35 
·ck‘_is_š‹¿ùive
();

36 
·ck‘_£t_£rv”
();

37 
·ck‘_£t_auth’tiÿ‹d
();

39 
·ck‘_¡¬t
(
u_ch¬
);

40 
·ck‘_put_ch¬
(
ch
);

41 
·ck‘_put_št
(
u_št
 
v®ue
);

42 
·ck‘_put_št64
(
u_št64_t
 
v®ue
);

43 
·ck‘_put_¡ršg
(cÚ¡ *
buf
, 
u_št
 
Ën
);

44 
·ck‘_put_c¡ršg
(cÚ¡ *
¡r
);

45 
·ck‘_put_¿w
(cÚ¡ *
buf
, 
u_št
 
Ën
);

46 
·ck‘_£nd
();

48 
·ck‘_»ad
();

49 
·ck‘_»ad_ex³ù
(
ty³
);

50 
·ck‘_»ad_pŞl
();

51 
·ck‘_´oûss_šcomšg
(cÚ¡ *
buf
, 
u_št
 
Ën
);

52 
·ck‘_»ad_£qÄ
(
u_št32_t
 *
£qÄ_p
);

53 
·ck‘_»ad_pŞl_£qÄ
(
u_št32_t
 *
£qÄ_p
);

55 
u_št
 
·ck‘_g‘_ch¬
();

56 
u_št
 
·ck‘_g‘_št
();

57 
u_št64_t
 
·ck‘_g‘_št64
();

58 
·ck‘_g‘_bignum
(
BIGNUM
 * 
v®ue
);

59 
·ck‘_g‘_bignum2
(
BIGNUM
 * 
v®ue
);

60 *
·ck‘_g‘_¿w
(
u_št
 *
Ëngth_±r
);

61 *
·ck‘_g‘_¡ršg
(
u_št
 *
Ëngth_±r
);

62 *
·ck‘_g‘_¡ršg_±r
(
u_št
 *
Ëngth_±r
);

63 
	$·ck‘_discÚÃù
(cÚ¡ *
fmt
,...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

64 
	$·ck‘_£nd_debug
(cÚ¡ *
fmt
,...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 1, 2)));

66 
	`£t_Ãwkeys
(
mode
);

67 
	`·ck‘_g‘_keyiv_Ën
();

68 
	`·ck‘_g‘_keyiv
(, 
u_ch¬
 *, 
u_št
);

69 
	`·ck‘_g‘_keycÚ‹xt
(, 
u_ch¬
 *);

70 
	`·ck‘_£t_keycÚ‹xt
(, 
u_ch¬
 *);

71 
	`·ck‘_g‘_¡©e
(, 
u_št32_t
 *, 
u_št64_t
 *, u_int32_t *, u_int64_t *);

72 
	`·ck‘_£t_¡©e
(, 
u_št32_t
, 
u_št64_t
, u_int32_t, u_int64_t);

73 
	`·ck‘_g‘_ssh1_ch”
();

74 
	`·ck‘_£t_iv
(, 
u_ch¬
 *);

75 *
	`·ck‘_g‘_Ãwkeys
();

77 
	`·ck‘_wr™e_pŞl
();

78 
	`·ck‘_wr™e_wa™
();

79 
	`·ck‘_have_d©a_to_wr™e
();

80 
	`·ck‘_nÙ_v”y_much_d©a_to_wr™e
();

82 
	`·ck‘_cÚÃùiÚ_is_Ú_sock‘
();

83 
	`·ck‘_cÚÃùiÚ_is_v4
();

84 
	`·ck‘_»maššg
();

85 
	`·ck‘_£nd_ignÜe
();

86 
	`·ck‘_add_·ddšg
(
u_ch¬
);

88 
	`‰y_make_modes
(, 
‹rmios
 *);

89 
	`‰y_·r£_modes
(, *);

91 
	`·ck‘_£t_®ive_timeouts
();

92 
	`·ck‘_šc_®ive_timeouts
();

93 
	`·ck‘_£t_maxsize
(
u_št
);

94 
u_št
 
	`·ck‘_g‘_maxsize
();

97 
	#·ck‘_check_eom
() \

99 
_Ën
 = 
	`·ck‘_»maššg
(); \

100 ià(
_Ën
 > 0) { \

101 
	`log™
("Packet integrityƒrror (%d bytes„emaining)‡t %s:%d", \

102 
_Ën
 ,
__FILE__
, 
__LINE__
); \

103 
	`·ck‘_discÚÃù
("Packet integrityƒrror."); \

105 
	}
} 0)

	)

107 
·ck‘_Ãed_»keyšg
();

108 
·ck‘_£t_»key_lim™
(
u_št32_t
);

110 
·ck‘_backup_¡©e
();

111 
·ck‘_»¡Üe_¡©e
();

113 *
·ck‘_g‘_šput
();

114 *
·ck‘_g‘_ouut
();

	@sftp-server/platform.h

19 
	~<sys/ty³s.h
>

21 
¶©fÜm_´e_li¡’
();

22 
¶©fÜm_´e_fÜk
();

23 
¶©fÜm_po¡_fÜk_·»Á
(
pid_t
 
chd_pid
);

24 
¶©fÜm_po¡_fÜk_chd
();

25 *
¶©fÜm_g‘_krb5_ş›Á
(const *);

26 *
¶©fÜm_krb5_g‘_´šc®_Çme
(const *);

	@sftp-server/sftp-client.h

21 #iâdeà
_SFTP_CLIENT_H


22 
	#_SFTP_CLIENT_H


	)

24 
SFTP_DIRENT
 
	tSFTP_DIRENT
;

26 
	sSFTP_DIRENT
 {

27 *
	mf’ame
;

28 *
	mlÚgÇme
;

29 
A‰rib
 
	ma
;

36 
	ssáp_¡©vfs
 {

37 
u_št64_t
 
	mf_bsize
;

38 
u_št64_t
 
	mf_äsize
;

39 
u_št64_t
 
	mf_blocks
;

40 
u_št64_t
 
	mf_bä“
;

41 
u_št64_t
 
	mf_bava
;

42 
u_št64_t
 
	mf_fes
;

43 
u_št64_t
 
	mf_fä“
;

44 
u_št64_t
 
	mf_çva
;

45 
u_št64_t
 
	mf_fsid
;

46 
u_št64_t
 
	mf_æag
;

47 
u_št64_t
 
	mf_Çmemax
;

54 
sáp_cÚn
 *
do_š™
(, , 
u_št
, u_int);

56 
u_št
 
sáp_´Ùo_v”siÚ
(
sáp_cÚn
 *);

59 
do_şo£
(
sáp_cÚn
 *, *, 
u_št
);

62 
do_»addœ
(
sáp_cÚn
 *, *, 
SFTP_DIRENT
 ***);

65 
ä“_sáp_dœ’ts
(
SFTP_DIRENT
 **);

68 
do_rm
(
sáp_cÚn
 *, *);

71 
do_mkdœ
(
sáp_cÚn
 *, *, 
A‰rib
 *, );

74 
do_rmdœ
(
sáp_cÚn
 *, *);

77 
A‰rib
 *
do_¡©
(
sáp_cÚn
 *, *, );

80 
A‰rib
 *
do_l¡©
(
sáp_cÚn
 *, *, );

83 
do_£t¡©
(
sáp_cÚn
 *, *, 
A‰rib
 *);

86 
do_f£t¡©
(
sáp_cÚn
 *, *, 
u_št
, 
A‰rib
 *);

89 *
do_»®·th
(
sáp_cÚn
 *, *);

92 
do_¡©vfs
(
sáp_cÚn
 *, cÚ¡ *, 
sáp_¡©vfs
 *, );

95 
do_»Çme
(
sáp_cÚn
 *, *, *);

98 
do_symlšk
(
sáp_cÚn
 *, *, *);

106 
do_dowÆßd
(
sáp_cÚn
 *, *, *, 
A‰rib
 *, );

112 
dowÆßd_dœ
(
sáp_cÚn
 *, *, *, 
A‰rib
 *, , );

118 
do_u¶ßd
(
sáp_cÚn
 *, *, *, );

124 
u¶ßd_dœ
(
sáp_cÚn
 *, *, *, , );

127 *
·th_­³nd
(*, *);

	@sftp-server/sftp-common.c

27 
	~"šşudes.h
"

29 
	~<sys/ty³s.h
>

30 
	~<sys/¡©.h
>

31 
	~<sys/·¿m.h
>

33 
	~<g½.h
>

34 
	~<pwd.h
>

35 
	~<¡dio.h
>

36 
	~<¡ršg.h
>

37 
	~<time.h
>

38 
	~<¡d¬g.h
>

39 #ifdeà
HAVE_UTIL_H


40 
	~<ut.h
>

43 
	~"xm®loc.h
"

44 
	~"bufãr.h
"

45 
	~"log.h
"

47 
	~"sáp.h
"

48 
	~"sáp-commÚ.h
"

52 
	$©Œib_ş—r
(
A‰rib
 *
a
)

54 
a
->
æags
 = 0;

55 
a
->
size
 = 0;

56 
a
->
uid
 = 0;

57 
a
->
gid
 = 0;

58 
a
->
³rm
 = 0;

59 
a
->
©ime
 = 0;

60 
a
->
mtime
 = 0;

61 
	}
}

65 
	$¡©_to_©Œib
(cÚ¡ 
¡©
 *
¡
, 
A‰rib
 *
a
)

67 
	`©Œib_ş—r
(
a
);

68 
a
->
æags
 = 0;

69 
a
->
æags
 |ğ
SSH2_FILEXFER_ATTR_SIZE
;

70 
a
->
size
 = 
¡
->
¡_size
;

71 
a
->
æags
 |ğ
SSH2_FILEXFER_ATTR_UIDGID
;

72 
a
->
uid
 = 
¡
->
¡_uid
;

73 
a
->
gid
 = 
¡
->
¡_gid
;

74 
a
->
æags
 |ğ
SSH2_FILEXFER_ATTR_PERMISSIONS
;

75 
a
->
³rm
 = 
¡
->
¡_mode
;

76 
a
->
æags
 |ğ
SSH2_FILEXFER_ATTR_ACMODTIME
;

77 
a
->
©ime
 = 
¡
->
¡_©ime
;

78 
a
->
mtime
 = 
¡
->
¡_mtime
;

79 
	}
}

83 
	$©Œib_to_¡©
(cÚ¡ 
A‰rib
 *
a
, 
¡©
 *
¡
)

85 
	`mem£t
(
¡
, 0, (*st));

87 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_SIZE
)

88 
¡
->
¡_size
 = 
a
->
size
;

89 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_UIDGID
) {

90 
¡
->
¡_uid
 = 
a
->
uid
;

91 
¡
->
¡_gid
 = 
a
->
gid
;

93 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_PERMISSIONS
)

94 
¡
->
¡_mode
 = 
a
->
³rm
;

95 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_ACMODTIME
) {

96 
¡
->
¡_©ime
 = 
a
->
©ime
;

97 
¡
->
¡_mtime
 = 
a
->
mtime
;

99 
	}
}

102 
A‰rib
 *

103 
	$decode_©Œib
(
Bufãr
 *
b
)

105 
A‰rib
 
a
;

107 
	`©Œib_ş—r
(&
a
);

108 
a
.
æags
 = 
	`bufãr_g‘_št
(
b
);

109 ià(
a
.
æags
 & 
SSH2_FILEXFER_ATTR_SIZE
)

110 
a
.
size
 = 
	`bufãr_g‘_št64
(
b
);

111 ià(
a
.
æags
 & 
SSH2_FILEXFER_ATTR_UIDGID
) {

112 
a
.
uid
 = 
	`bufãr_g‘_št
(
b
);

113 
a
.
gid
 = 
	`bufãr_g‘_št
(
b
);

115 ià(
a
.
æags
 & 
SSH2_FILEXFER_ATTR_PERMISSIONS
)

116 
a
.
³rm
 = 
	`bufãr_g‘_št
(
b
);

117 ià(
a
.
æags
 & 
SSH2_FILEXFER_ATTR_ACMODTIME
) {

118 
a
.
©ime
 = 
	`bufãr_g‘_št
(
b
);

119 
a
.
mtime
 = 
	`bufãr_g‘_št
(
b
);

122 ià(
a
.
æags
 & 
SSH2_FILEXFER_ATTR_EXTENDED
) {

123 *
ty³
, *
d©a
;

124 
i
, 
couÁ
;

126 
couÁ
 = 
	`bufãr_g‘_št
(
b
);

127 
i
 = 0; i < 
couÁ
; i++) {

128 
ty³
 = 
	`bufãr_g‘_¡ršg
(
b
, 
NULL
);

129 
d©a
 = 
	`bufãr_g‘_¡ršg
(
b
, 
NULL
);

130 
	`debug3
("GÙ f©Œibu‹ \"%s\"", 
ty³
);

131 
	`xä“
(
ty³
);

132 
	`xä“
(
d©a
);

135  &
a
;

136 
	}
}

140 
	$’code_©Œib
(
Bufãr
 *
b
, cÚ¡ 
A‰rib
 *
a
)

142 
	`bufãr_put_št
(
b
, 
a
->
æags
);

143 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_SIZE
)

144 
	`bufãr_put_št64
(
b
, 
a
->
size
);

145 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_UIDGID
) {

146 
	`bufãr_put_št
(
b
, 
a
->
uid
);

147 
	`bufãr_put_št
(
b
, 
a
->
gid
);

149 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_PERMISSIONS
)

150 
	`bufãr_put_št
(
b
, 
a
->
³rm
);

151 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_ACMODTIME
) {

152 
	`bufãr_put_št
(
b
, 
a
->
©ime
);

153 
	`bufãr_put_št
(
b
, 
a
->
mtime
);

155 
	}
}

159 
	$fx2txt
(
¡©us
)

161 
¡©us
) {

162 
SSH2_FX_OK
:

164 
SSH2_FX_EOF
:

166 
SSH2_FX_NO_SUCH_FILE
:

168 
SSH2_FX_PERMISSION_DENIED
:

170 
SSH2_FX_FAILURE
:

172 
SSH2_FX_BAD_MESSAGE
:

174 
SSH2_FX_NO_CONNECTION
:

176 
SSH2_FX_CONNECTION_LOST
:

178 
SSH2_FX_OP_UNSUPPORTED
:

184 
	}
}

190 
	$ls_fe
(cÚ¡ *
Çme
, cÚ¡ 
¡©
 *
¡
, 
»mÙe
, 
si_un™s
)

192 
uËn
, 
gËn
, 
sz
 = 0;

193 
tm
 *
Éime
 = 
	`loÿÉime
(&
¡
->
¡_mtime
);

194 *
u£r
, *
group
;

195 
buf
[1024], 
mode
[11+1], 
tbuf
[12+1], 
ubuf
[11+1], 
gbuf
[11+1];

196 
sbuf
[
FMT_SCALED_STRSIZE
];

198 
	`¡rmode
(
¡
->
¡_mode
, 
mode
);

199 ià(!
»mÙe
) {

200 
u£r
 = 
	`u£r_äom_uid
(
¡
->
¡_uid
, 0);

202 
	`¢´štf
(
ubuf
,  ubuf, "%u", (
u_št
)
¡
->
¡_uid
);

203 
u£r
 = 
ubuf
;

205 ià(!
»mÙe
) {

206 
group
 = 
	`group_äom_gid
(
¡
->
¡_gid
, 0);

208 
	`¢´štf
(
gbuf
,  gbuf, "%u", (
u_št
)
¡
->
¡_gid
);

209 
group
 = 
gbuf
;

211 ià(
Éime
 !ğ
NULL
) {

212 ià(
	`time
(
NULL
è- 
¡
->
¡_mtime
 < (365*24*60*60)/2)

213 
sz
 = 
	`¡ráime
(
tbuf
, buf, "%b %%H:%M", 
Éime
);

215 
sz
 = 
	`¡ráime
(
tbuf
, buf, "%b % %Y", 
Éime
);

217 ià(
sz
 == 0)

218 
tbuf
[0] = '\0';

219 
uËn
 = 
	`MAX
(
	`¡¾’
(
u£r
), 8);

220 
gËn
 = 
	`MAX
(
	`¡¾’
(
group
), 8);

221 ià(
si_un™s
) {

222 
	`fmt_sÿËd
(()
¡
->
¡_size
, 
sbuf
);

223 
	`¢´štf
(
buf
,  buf, "% %3u %-* %-* %8 % %s", 
mode
,

224 (
u_št
)
¡
->
¡_Æšk
, 
uËn
, 
u£r
, 
gËn
, 
group
,

225 
sbuf
, 
tbuf
, 
Çme
);

227 
	`¢´štf
(
buf
,  buf, "% %3u %-* %-* %8Îu % %s", 
mode
,

228 (
u_št
)
¡
->
¡_Æšk
, 
uËn
, 
u£r
, 
gËn
, 
group
,

229 ()
¡
->
¡_size
, 
tbuf
, 
Çme
);

231  
	`x¡rdup
(
buf
);

232 
	}
}

	@sftp-server/sftp-common.h

29 
	#SFTP_MAX_MSG_LENGTH
 (256 * 1024)

	)

31 
A‰rib
 
	tA‰rib
;

34 
	sA‰rib
 {

35 
u_št32_t
 
	mæags
;

36 
u_št64_t
 
	msize
;

37 
u_št32_t
 
	muid
;

38 
u_št32_t
 
	mgid
;

39 
u_št32_t
 
	m³rm
;

40 
u_št32_t
 
	m©ime
;

41 
u_št32_t
 
	mmtime
;

44 
©Œib_ş—r
(
A‰rib
 *);

45 
¡©_to_©Œib
(cÚ¡ 
¡©
 *, 
A‰rib
 *);

46 
©Œib_to_¡©
(cÚ¡ 
A‰rib
 *, 
¡©
 *);

47 
A‰rib
 *
decode_©Œib
(
Bufãr
 *);

48 
’code_©Œib
(
Bufãr
 *, cÚ¡ 
A‰rib
 *);

49 *
ls_fe
(cÚ¡ *, cÚ¡ 
¡©
 *, , );

51 cÚ¡ *
fx2txt
();

	@sftp-server/sftp-server-main.c

18 
	~"šşudes.h
"

20 
	~<sys/ty³s.h
>

21 
	~<pwd.h
>

22 
	~<¡d¬g.h
>

23 
	~<¡dio.h
>

24 
	~<uni¡d.h
>

26 
	~"log.h
"

27 
	~"sáp.h
"

28 
	~"misc.h
"

31 
	$ş—nup_ex™
(
i
)

33 
	`sáp_£rv”_ş—nup_ex™
(
i
);

34 
	}
}

37 
	$maš
(
¬gc
, **
¬gv
)

39 
·sswd
 *
u£r_pw
;

42 
	`§n™i£_¡dfd
();

44 ià((
u£r_pw
 = 
	`g‘pwuid
(
	`g‘uid
())è=ğ
NULL
) {

45 
	`årštf
(
¡d”r
, "No user found for uid %lu\n",

46 (
u_lÚg
)
	`g‘uid
());

50  (
	`sáp_£rv”_maš
(
¬gc
, 
¬gv
, 
u£r_pw
));

51 
	}
}

	@sftp-server/sftp-server.c

18 
	~"šşudes.h
"

20 
	~<sys/ty³s.h
>

21 
	~<sys/·¿m.h
>

22 
	~<sys/¡©.h
>

23 #ifdeà
HAVE_SYS_TIME_H


24 
	~<sys/time.h
>

26 #ifdeà
HAVE_SYS_MOUNT_H


27 
	~<sys/mouÁ.h
>

29 #ifdeà
HAVE_SYS_STATVFS_H


30 
	~<sys/¡©vfs.h
>

33 
	~<dœ’t.h
>

34 
	~<”ºo.h
>

35 
	~<fú.h
>

36 
	~<pwd.h
>

37 
	~<¡dlib.h
>

38 
	~<¡dio.h
>

39 
	~<¡ršg.h
>

40 
	~<pwd.h
>

41 
	~<time.h
>

42 
	~<uni¡d.h
>

43 
	~<¡d¬g.h
>

45 
	~"xm®loc.h
"

46 
	~"bufãr.h
"

47 
	~"log.h
"

48 
	~"misc.h
"

49 
	~"uidsw­.h
"

51 
	~"sáp.h
"

52 
	~"sáp-commÚ.h
"

55 
	#g‘_št64
(è
	`bufãr_g‘_št64
(&
iqueue
);

	)

56 
	#g‘_št
(è
	`bufãr_g‘_št
(&
iqueue
);

	)

57 
	#g‘_¡ršg
(
ËÅ
è
	`bufãr_g‘_¡ršg
(&
iqueue
,†’p);

	)

60 
LogLev–
 
	glog_Ëv–
 = 
SYSLOG_LEVEL_ERROR
;

63 
·sswd
 *
	gpw
 = 
NULL
;

64 *
	gş›Á_addr
 = 
NULL
;

67 
Bufãr
 
	giqueue
;

68 
Bufãr
 
	goqueue
;

71 
	gv”siÚ
;

74 
	g»adÚly
;

77 
	gçke_³rmissiÚs
;

81 
St
 
	tSt
;

83 
	sSt
 {

84 *
	mÇme
;

85 *
	mlÚg_Çme
;

86 
A‰rib
 
	m©Œib
;

90 
	$”ºo_to_pÜbË
(
unix”ºo
)

92 
»t
 = 0;

94 
unix”ºo
) {

96 
»t
 = 
SSH2_FX_OK
;

98 
ENOENT
:

99 
ENOTDIR
:

100 
EBADF
:

101 
ELOOP
:

102 
»t
 = 
SSH2_FX_NO_SUCH_FILE
;

104 
EPERM
:

105 
EACCES
:

106 
EFAULT
:

107 
»t
 = 
SSH2_FX_PERMISSION_DENIED
;

109 
ENAMETOOLONG
:

110 
EINVAL
:

111 
»t
 = 
SSH2_FX_BAD_MESSAGE
;

113 
ENOSYS
:

114 
»t
 = 
SSH2_FX_OP_UNSUPPORTED
;

117 
»t
 = 
SSH2_FX_FAILURE
;

120  
»t
;

121 
	}
}

124 
	$æags_äom_pÜbË
(
pæags
)

126 
æags
 = 0;

128 ià((
pæags
 & 
SSH2_FXF_READ
) &&

129 (
pæags
 & 
SSH2_FXF_WRITE
)) {

130 
æags
 = 
O_RDWR
;

131 } ià(
pæags
 & 
SSH2_FXF_READ
) {

132 
æags
 = 
O_RDONLY
;

133 } ià(
pæags
 & 
SSH2_FXF_WRITE
) {

134 
æags
 = 
O_WRONLY
;

136 ià(
pæags
 & 
SSH2_FXF_CREAT
)

137 
æags
 |ğ
O_CREAT
;

138 ià(
pæags
 & 
SSH2_FXF_TRUNC
)

139 
æags
 |ğ
O_TRUNC
;

140 ià(
pæags
 & 
SSH2_FXF_EXCL
)

141 
æags
 |ğ
O_EXCL
;

142  
æags
;

143 
	}
}

146 
	$¡ršg_äom_pÜbË
(
pæags
)

148 
»t
[128];

150 *
»t
 = '\0';

152 
	#PAPPEND
(
¡r
) { \

153 ià(*
»t
 != '\0') \

154 
	`¡¾ÿt
(
»t
, ",", (ret)); \

155 
	`¡¾ÿt
(
»t
, 
¡r
, (ret)); \

156 }

	)

158 ià(
pæags
 & 
SSH2_FXF_READ
)

159 
	`PAPPEND
("READ")

160 ià(
pæags
 & 
SSH2_FXF_WRITE
)

161 
	`PAPPEND
("WRITE")

162 ià(
pæags
 & 
SSH2_FXF_CREAT
)

163 
	`PAPPEND
("CREATE")

164 ià(
pæags
 & 
SSH2_FXF_TRUNC
)

165 
	`PAPPEND
("TRUNCATE")

166 ià(
pæags
 & 
SSH2_FXF_EXCL
)

167 
	`PAPPEND
("EXCL")

169  
»t
;

170 
	}
}

172 
A‰rib
 *

173 
	$g‘_©Œib
()

175  
	`decode_©Œib
(&
iqueue
);

176 
	}
}

180 
HªdË
 
	tHªdË
;

181 
	sHªdË
 {

182 
	mu£
;

183 
DIR
 *
	mdœp
;

184 
	mfd
;

185 *
	mÇme
;

186 
u_št64_t
 
	mby‹s_»ad
, 
	mby‹s_wr™e
;

187 
	mÃxt_unu£d
;

191 
	mHANDLE_UNUSED
,

192 
	mHANDLE_DIR
,

193 
	mHANDLE_FILE


196 
HªdË
 *
	ghªdËs
 = 
NULL
;

197 
u_št
 
	gnum_hªdËs
 = 0;

198 
	gfœ¡_unu£d_hªdË
 = -1;

200 
	$hªdË_unu£d
(
i
)

202 
hªdËs
[
i
].
u£
 = 
HANDLE_UNUSED
;

203 
hªdËs
[
i
].
Ãxt_unu£d
 = 
fœ¡_unu£d_hªdË
;

204 
fœ¡_unu£d_hªdË
 = 
i
;

205 
	}
}

208 
	$hªdË_Ãw
(
u£
, cÚ¡ *
Çme
, 
fd
, 
DIR
 *
dœp
)

210 
i
;

212 ià(
fœ¡_unu£d_hªdË
 == -1) {

213 ià(
num_hªdËs
 + 1 <=‚um_handles)

215 
num_hªdËs
++;

216 
hªdËs
 = 
	`x»®loc
(hªdËs, 
num_hªdËs
, (
HªdË
));

217 
	`hªdË_unu£d
(
num_hªdËs
 - 1);

220 
i
 = 
fœ¡_unu£d_hªdË
;

221 
fœ¡_unu£d_hªdË
 = 
hªdËs
[
i
].
Ãxt_unu£d
;

223 
hªdËs
[
i
].
u£
 = use;

224 
hªdËs
[
i
].
dœp
 = dirp;

225 
hªdËs
[
i
].
fd
 = fd;

226 
hªdËs
[
i
].
Çme
 = 
	`x¡rdup
(name);

227 
hªdËs
[
i
].
by‹s_»ad
 = hªdËs[i].
by‹s_wr™e
 = 0;

229  
i
;

230 
	}
}

233 
	$hªdË_is_ok
(
i
, 
ty³
)

235  
i
 >ğ0 && (
u_št
)˜< 
num_hªdËs
 && 
hªdËs
[i].
u£
 =ğ
ty³
;

236 
	}
}

239 
	$hªdË_to_¡ršg
(
hªdË
, **
¡ršgp
, *
hËÅ
)

241 ià(
¡ršgp
 =ğ
NULL
 || 
hËÅ
 == NULL)

243 *
¡ršgp
 = 
	`xm®loc
((
št32_t
));

244 
	`put_u32
(*
¡ršgp
, 
hªdË
);

245 *
hËÅ
 = (
št32_t
);

247 
	}
}

250 
	$hªdË_äom_¡ršg
(cÚ¡ *
hªdË
, 
u_št
 
hËn
)

252 
v®
;

254 ià(
hËn
 !ğ(
št32_t
))

256 
v®
 = 
	`g‘_u32
(
hªdË
);

257 ià(
	`hªdË_is_ok
(
v®
, 
HANDLE_FILE
) ||

258 
	`hªdË_is_ok
(
v®
, 
HANDLE_DIR
))

259  
v®
;

261 
	}
}

264 
	$hªdË_to_Çme
(
hªdË
)

266 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_DIR
)||

267 
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
))

268  
hªdËs
[
hªdË
].
Çme
;

269  
NULL
;

270 
	}
}

272 
DIR
 *

273 
	$hªdË_to_dœ
(
hªdË
)

275 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_DIR
))

276  
hªdËs
[
hªdË
].
dœp
;

277  
NULL
;

278 
	}
}

281 
	$hªdË_to_fd
(
hªdË
)

283 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
))

284  
hªdËs
[
hªdË
].
fd
;

286 
	}
}

289 
	$hªdË_upd©e_»ad
(
hªdË
, 
ssize_t
 
by‹s
)

291 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
è&& 
by‹s
 > 0)

292 
hªdËs
[
hªdË
].
by‹s_»ad
 +ğ
by‹s
;

293 
	}
}

296 
	$hªdË_upd©e_wr™e
(
hªdË
, 
ssize_t
 
by‹s
)

298 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
è&& 
by‹s
 > 0)

299 
hªdËs
[
hªdË
].
by‹s_wr™e
 +ğ
by‹s
;

300 
	}
}

302 
u_št64_t


303 
	$hªdË_by‹s_»ad
(
hªdË
)

305 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
))

306  (
hªdËs
[
hªdË
].
by‹s_»ad
);

308 
	}
}

310 
u_št64_t


311 
	$hªdË_by‹s_wr™e
(
hªdË
)

313 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
))

314  (
hªdËs
[
hªdË
].
by‹s_wr™e
);

316 
	}
}

319 
	$hªdË_şo£
(
hªdË
)

321 
»t
 = -1;

323 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
)) {

324 
»t
 = 
	`şo£
(
hªdËs
[
hªdË
].
fd
);

325 
	`xä“
(
hªdËs
[
hªdË
].
Çme
);

326 
	`hªdË_unu£d
(
hªdË
);

327 } ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_DIR
)) {

328 
»t
 = 
	`şo£dœ
(
hªdËs
[
hªdË
].
dœp
);

329 
	`xä“
(
hªdËs
[
hªdË
].
Çme
);

330 
	`hªdË_unu£d
(
hªdË
);

332 
”ºo
 = 
ENOENT
;

334  
»t
;

335 
	}
}

338 
	$hªdË_log_şo£
(
hªdË
, *
emsg
)

340 ià(
	`hªdË_is_ok
(
hªdË
, 
HANDLE_FILE
)) {

341 
	`log™
("%s%sclose \"%s\" bytes„ead %llu written %llu",

342 
emsg
 =ğ
NULL
 ? "" :ƒmsg,ƒmsg == NULL ? "" : " ",

343 
	`hªdË_to_Çme
(
hªdË
),

344 ()
	`hªdË_by‹s_»ad
(
hªdË
),

345 ()
	`hªdË_by‹s_wr™e
(
hªdË
));

347 
	`log™
("%s%sclosedir \"%s\"",

348 
emsg
 =ğ
NULL
 ? "" :ƒmsg,ƒmsg == NULL ? "" : " ",

349 
	`hªdË_to_Çme
(
hªdË
));

351 
	}
}

354 
	$hªdË_log_ex™
()

356 
u_št
 
i
;

358 
i
 = 0; i < 
num_hªdËs
; i++)

359 ià(
hªdËs
[
i
].
u£
 !ğ
HANDLE_UNUSED
)

360 
	`hªdË_log_şo£
(
i
, "forced");

361 
	}
}

364 
	$g‘_hªdË
()

366 *
hªdË
;

367 
v®
 = -1;

368 
u_št
 
hËn
;

370 
hªdË
 = 
	`g‘_¡ršg
(&
hËn
);

371 ià(
hËn
 < 256)

372 
v®
 = 
	`hªdË_äom_¡ršg
(
hªdË
, 
hËn
);

373 
	`xä“
(
hªdË
);

374  
v®
;

375 
	}
}

380 
	$£nd_msg
(
Bufãr
 *
m
)

382 
mËn
 = 
	`bufãr_Ën
(
m
);

384 
	`bufãr_put_št
(&
oqueue
, 
mËn
);

385 
	`bufãr_­³nd
(&
oqueue
, 
	`bufãr_±r
(
m
), 
mËn
);

386 
	`bufãr_cÚsume
(
m
, 
mËn
);

387 
	}
}

390 
	$¡©us_to_mes§ge
(
u_št32_t
 
¡©us
)

392 cÚ¡ *
¡©us_mes§ges
[] = {

404  (
¡©us_mes§ges
[
	`MIN
(
¡©us
,
SSH2_FX_MAX
)]);

405 
	}
}

408 
	$£nd_¡©us
(
u_št32_t
 
id
, u_št32_ˆ
¡©us
)

410 
Bufãr
 
msg
;

412 
	`debug3
("»que¡ %u: s’ˆ¡©u %u", 
id
, 
¡©us
);

413 ià(
log_Ëv–
 > 
SYSLOG_LEVEL_VERBOSE
 ||

414 (
¡©us
 !ğ
SSH2_FX_OK
 && stu !ğ
SSH2_FX_EOF
))

415 
	`log™
("£Á stu %s", 
	`¡©us_to_mes§ge
(
¡©us
));

416 
	`bufãr_š™
(&
msg
);

417 
	`bufãr_put_ch¬
(&
msg
, 
SSH2_FXP_STATUS
);

418 
	`bufãr_put_št
(&
msg
, 
id
);

419 
	`bufãr_put_št
(&
msg
, 
¡©us
);

420 ià(
v”siÚ
 >= 3) {

421 
	`bufãr_put_c¡ršg
(&
msg
, 
	`¡©us_to_mes§ge
(
¡©us
));

422 
	`bufãr_put_c¡ršg
(&
msg
, "");

424 
	`£nd_msg
(&
msg
);

425 
	`bufãr_ä“
(&
msg
);

426 
	}
}

428 
	$£nd_d©a_Ü_hªdË
(
ty³
, 
u_št32_t
 
id
, cÚ¡ *
d©a
, 
dËn
)

430 
Bufãr
 
msg
;

432 
	`bufãr_š™
(&
msg
);

433 
	`bufãr_put_ch¬
(&
msg
, 
ty³
);

434 
	`bufãr_put_št
(&
msg
, 
id
);

435 
	`bufãr_put_¡ršg
(&
msg
, 
d©a
, 
dËn
);

436 
	`£nd_msg
(&
msg
);

437 
	`bufãr_ä“
(&
msg
);

438 
	}
}

441 
	$£nd_d©a
(
u_št32_t
 
id
, cÚ¡ *
d©a
, 
dËn
)

443 
	`debug
("»que¡ %u: s’ˆd©¨ËÀ%d", 
id
, 
dËn
);

444 
	`£nd_d©a_Ü_hªdË
(
SSH2_FXP_DATA
, 
id
, 
d©a
, 
dËn
);

445 
	}
}

448 
	$£nd_hªdË
(
u_št32_t
 
id
, 
hªdË
)

450 *
¡ršg
;

451 
hËn
;

453 
	`hªdË_to_¡ršg
(
hªdË
, &
¡ršg
, &
hËn
);

454 
	`debug
("»que¡ %u: s’ˆhªdË hªdË %d", 
id
, 
hªdË
);

455 
	`£nd_d©a_Ü_hªdË
(
SSH2_FXP_HANDLE
, 
id
, 
¡ršg
, 
hËn
);

456 
	`xä“
(
¡ršg
);

457 
	}
}

460 
	$£nd_Çmes
(
u_št32_t
 
id
, 
couÁ
, cÚ¡ 
St
 *
¡©s
)

462 
Bufãr
 
msg
;

463 
i
;

465 
	`bufãr_š™
(&
msg
);

466 
	`bufãr_put_ch¬
(&
msg
, 
SSH2_FXP_NAME
);

467 
	`bufãr_put_št
(&
msg
, 
id
);

468 
	`bufãr_put_št
(&
msg
, 
couÁ
);

469 
	`debug
("»que¡ %u: s’ˆÇme couÁ %d", 
id
, 
couÁ
);

470 
i
 = 0; i < 
couÁ
; i++) {

471 
	`bufãr_put_c¡ršg
(&
msg
, 
¡©s
[
i
].
Çme
);

472 
	`bufãr_put_c¡ršg
(&
msg
, 
¡©s
[
i
].
lÚg_Çme
);

473 
	`’code_©Œib
(&
msg
, &
¡©s
[
i
].
©Œib
);

475 
	`£nd_msg
(&
msg
);

476 
	`bufãr_ä“
(&
msg
);

477 
	}
}

480 
	$£nd_©Œib
(
u_št32_t
 
id
, cÚ¡ 
A‰rib
 *
a
)

482 
Bufãr
 
msg
;

484 
	`debug
("»que¡ %u: s’ˆ©Œib hav0x%x", 
id
, 
a
->
æags
);

485 
	`bufãr_š™
(&
msg
);

486 
	`bufãr_put_ch¬
(&
msg
, 
SSH2_FXP_ATTRS
);

487 
	`bufãr_put_št
(&
msg
, 
id
);

488 
	`’code_©Œib
(&
msg
, 
a
);

489 
	`£nd_msg
(&
msg
);

490 
	`bufãr_ä“
(&
msg
);

491 
	}
}

494 
	$£nd_¡©vfs
(
u_št32_t
 
id
, 
¡©vfs
 *
¡
)

496 
Bufãr
 
msg
;

497 
u_št64_t
 
æag
;

499 
æag
 = (
¡
->
f_æag
 & 
ST_RDONLY
è? 
SSH2_FXE_STATVFS_ST_RDONLY
 : 0;

500 
æag
 |ğ(
¡
->
f_æag
 & 
ST_NOSUID
è? 
SSH2_FXE_STATVFS_ST_NOSUID
 : 0;

502 
	`bufãr_š™
(&
msg
);

503 
	`bufãr_put_ch¬
(&
msg
, 
SSH2_FXP_EXTENDED_REPLY
);

504 
	`bufãr_put_št
(&
msg
, 
id
);

505 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_bsize
);

506 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_äsize
);

507 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_blocks
);

508 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_bä“
);

509 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_bava
);

510 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_fes
);

511 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_fä“
);

512 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_çva
);

513 
	`bufãr_put_št64
(&
msg
, 
	`FSID_TO_ULONG
(
¡
->
f_fsid
));

514 
	`bufãr_put_št64
(&
msg
, 
æag
);

515 
	`bufãr_put_št64
(&
msg
, 
¡
->
f_Çmemax
);

516 
	`£nd_msg
(&
msg
);

517 
	`bufãr_ä“
(&
msg
);

518 
	}
}

523 
	$´oûss_š™
()

525 
Bufãr
 
msg
;

527 
v”siÚ
 = 
	`g‘_št
();

528 
	`v”bo£
("»ûived cl›Á v”siÚ %d", 
v”siÚ
);

529 
	`bufãr_š™
(&
msg
);

530 
	`bufãr_put_ch¬
(&
msg
, 
SSH2_FXP_VERSION
);

531 
	`bufãr_put_št
(&
msg
, 
SSH2_FILEXFER_VERSION
);

533 
	`bufãr_put_c¡ršg
(&
msg
, "posix-rename@openssh.com");

534 
	`bufãr_put_c¡ršg
(&
msg
, "1");

536 
	`bufãr_put_c¡ršg
(&
msg
, "statvfs@openssh.com");

537 
	`bufãr_put_c¡ršg
(&
msg
, "2");

539 
	`bufãr_put_c¡ršg
(&
msg
, "fstatvfs@openssh.com");

540 
	`bufãr_put_c¡ršg
(&
msg
, "2");

541 
	`£nd_msg
(&
msg
);

542 
	`bufãr_ä“
(&
msg
);

543 
	}
}

546 
	$´oûss_İ’
()

548 
u_št32_t
 
id
, 
pæags
;

549 
A‰rib
 *
a
;

550 *
Çme
;

551 
hªdË
, 
fd
, 
æags
, 
mode
, 
¡©us
 = 
SSH2_FX_FAILURE
;

553 
id
 = 
	`g‘_št
();

554 
Çme
 = 
	`g‘_¡ršg
(
NULL
);

555 
pæags
 = 
	`g‘_št
();

556 
	`debug3
("»que¡ %u: o³Àæag %d", 
id
, 
pæags
);

557 
a
 = 
	`g‘_©Œib
();

558 
æags
 = 
	`æags_äom_pÜbË
(
pæags
);

559 
mode
 = (
a
->
æags
 & 
SSH2_FILEXFER_ATTR_PERMISSIONS
è?‡->
³rm
 : 0666;

560 
	`log™
("open \"%s\" flags %s mode 0%o",

561 
Çme
, 
	`¡ršg_äom_pÜbË
(
pæags
), 
mode
);

562 ià(
»adÚly
 &&

563 ((
æags
 & 
O_ACCMODE
è=ğ
O_WRONLY
 || (æag & O_ACCMODEè=ğ
O_RDWR
))

564 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

566 
fd
 = 
	`İ’
(
Çme
, 
æags
, 
mode
);

567 ià(
fd
 < 0) {

568 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

570 
hªdË
 = 
	`hªdË_Ãw
(
HANDLE_FILE
, 
Çme
, 
fd
, 
NULL
);

571 ià(
hªdË
 < 0) {

572 
	`şo£
(
fd
);

574 
	`£nd_hªdË
(
id
, 
hªdË
);

575 
¡©us
 = 
SSH2_FX_OK
;

579 ià(
¡©us
 !ğ
SSH2_FX_OK
)

580 
	`£nd_¡©us
(
id
, 
¡©us
);

581 
	`xä“
(
Çme
);

582 
	}
}

585 
	$´oûss_şo£
()

587 
u_št32_t
 
id
;

588 
hªdË
, 
»t
, 
¡©us
 = 
SSH2_FX_FAILURE
;

590 
id
 = 
	`g‘_št
();

591 
hªdË
 = 
	`g‘_hªdË
();

592 
	`debug3
("»que¡ %u: clo£ hªdË %u", 
id
, 
hªdË
);

593 
	`hªdË_log_şo£
(
hªdË
, 
NULL
);

594 
»t
 = 
	`hªdË_şo£
(
hªdË
);

595 
¡©us
 = (
»t
 =ğ-1è? 
	`”ºo_to_pÜbË
(
”ºo
è: 
SSH2_FX_OK
;

596 
	`£nd_¡©us
(
id
, 
¡©us
);

597 
	}
}

600 
	$´oûss_»ad
()

602 
buf
[64*1024];

603 
u_št32_t
 
id
, 
Ën
;

604 
hªdË
, 
fd
, 
»t
, 
¡©us
 = 
SSH2_FX_FAILURE
;

605 
u_št64_t
 
off
;

607 
id
 = 
	`g‘_št
();

608 
hªdË
 = 
	`g‘_hªdË
();

609 
off
 = 
	`g‘_št64
();

610 
Ën
 = 
	`g‘_št
();

612 
	`debug
("request %u:„ead \"%s\" (handle %d) off %llu†en %d",

613 
id
, 
	`hªdË_to_Çme
(
hªdË
), hªdË, ()
off
, 
Ën
);

614 ià(
Ën
 >  
buf
) {

615 
Ën
 =  
buf
;

616 
	`debug2
("»ad chªgËÀ%d", 
Ën
);

618 
fd
 = 
	`hªdË_to_fd
(
hªdË
);

619 ià(
fd
 >= 0) {

620 ià(
	`l£ek
(
fd
, 
off
, 
SEEK_SET
) < 0) {

621 
	`”rÜ
("process_read: seek failed");

622 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

624 
»t
 = 
	`»ad
(
fd
, 
buf
, 
Ën
);

625 ià(
»t
 < 0) {

626 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

627 } ià(
»t
 == 0) {

628 
¡©us
 = 
SSH2_FX_EOF
;

630 
	`£nd_d©a
(
id
, 
buf
, 
»t
);

631 
¡©us
 = 
SSH2_FX_OK
;

632 
	`hªdË_upd©e_»ad
(
hªdË
, 
»t
);

636 ià(
¡©us
 !ğ
SSH2_FX_OK
)

637 
	`£nd_¡©us
(
id
, 
¡©us
);

638 
	}
}

641 
	$´oûss_wr™e
()

643 
u_št32_t
 
id
;

644 
u_št64_t
 
off
;

645 
u_št
 
Ën
;

646 
hªdË
, 
fd
, 
»t
, 
¡©us
;

647 *
d©a
;

649 
id
 = 
	`g‘_št
();

650 
hªdË
 = 
	`g‘_hªdË
();

651 
off
 = 
	`g‘_št64
();

652 
d©a
 = 
	`g‘_¡ršg
(&
Ën
);

654 
	`debug
("request %u: write \"%s\" (handle %d) off %llu†en %d",

655 
id
, 
	`hªdË_to_Çme
(
hªdË
), hªdË, ()
off
, 
Ën
);

656 
fd
 = 
	`hªdË_to_fd
(
hªdË
);

658 ià(
fd
 < 0)

659 
¡©us
 = 
SSH2_FX_FAILURE
;

660 ià(
»adÚly
)

661 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

663 ià(
	`l£ek
(
fd
, 
off
, 
SEEK_SET
) < 0) {

664 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

665 
	`”rÜ
("process_write: seek failed");

668 
»t
 = 
	`wr™e
(
fd
, 
d©a
, 
Ën
);

669 ià(
»t
 < 0) {

670 
	`”rÜ
("process_write: write failed");

671 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

672 } ià((
size_t
)
»t
 =ğ
Ën
) {

673 
¡©us
 = 
SSH2_FX_OK
;

674 
	`hªdË_upd©e_wr™e
(
hªdË
, 
»t
);

676 
	`debug2
("nothing‡t‡ll written");

677 
¡©us
 = 
SSH2_FX_FAILURE
;

681 
	`£nd_¡©us
(
id
, 
¡©us
);

682 
	`xä“
(
d©a
);

683 
	}
}

686 
	$´oûss_do_¡©
(
do_l¡©
)

688 
A‰rib
 
a
;

689 
¡©
 
¡
;

690 
u_št32_t
 
id
;

691 *
Çme
;

692 
»t
, 
¡©us
 = 
SSH2_FX_FAILURE
;

694 
id
 = 
	`g‘_št
();

695 
Çme
 = 
	`g‘_¡ršg
(
NULL
);

696 
	`debug3
("»que¡ %u: %s¡©", 
id
, 
do_l¡©
 ? "l" : "");

697 
	`v”bo£
("%s¡©‚am\"%s\"", 
do_l¡©
 ? "l" : "", 
Çme
);

698 
»t
 = 
do_l¡©
 ? 
	`l¡©
(
Çme
, &
¡
è: 
	`¡©
(name, &st);

699 ià(
»t
 < 0) {

700 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

702 
	`¡©_to_©Œib
(&
¡
, &
a
);

703 ià(
çke_³rmissiÚs
)

704 
a
.
³rm
 |ğ(
S_IRUSR
 | 
S_IWUSR
);

705 
	`£nd_©Œib
(
id
, &
a
);

706 
¡©us
 = 
SSH2_FX_OK
;

708 ià(
¡©us
 !ğ
SSH2_FX_OK
)

709 
	`£nd_¡©us
(
id
, 
¡©us
);

710 
	`xä“
(
Çme
);

711 
	}
}

714 
	$´oûss_¡©
()

716 
	`´oûss_do_¡©
(0);

717 
	}
}

720 
	$´oûss_l¡©
()

722 
	`´oûss_do_¡©
(1);

723 
	}
}

726 
	$´oûss_f¡©
()

728 
A‰rib
 
a
;

729 
¡©
 
¡
;

730 
u_št32_t
 
id
;

731 
fd
, 
»t
, 
hªdË
, 
¡©us
 = 
SSH2_FX_FAILURE
;

733 
id
 = 
	`g‘_št
();

734 
hªdË
 = 
	`g‘_hªdË
();

735 
	`debug
("request %u: fstat \"%s\" (handle %u)",

736 
id
, 
	`hªdË_to_Çme
(
hªdË
), handle);

737 
fd
 = 
	`hªdË_to_fd
(
hªdË
);

738 ià(
fd
 >= 0) {

739 
»t
 = 
	`f¡©
(
fd
, &
¡
);

740 ià(
»t
 < 0) {

741 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

743 
	`¡©_to_©Œib
(&
¡
, &
a
);

744 
	`£nd_©Œib
(
id
, &
a
);

745 
¡©us
 = 
SSH2_FX_OK
;

748 ià(
¡©us
 !ğ
SSH2_FX_OK
)

749 
	`£nd_¡©us
(
id
, 
¡©us
);

750 
	}
}

752 
timev®
 *

753 
	$©Œib_to_tv
(cÚ¡ 
A‰rib
 *
a
)

755 
timev®
 
tv
[2];

757 
tv
[0].
tv_£c
 = 
a
->
©ime
;

758 
tv
[0].
tv_u£c
 = 0;

759 
tv
[1].
tv_£c
 = 
a
->
mtime
;

760 
tv
[1].
tv_u£c
 = 0;

761  
tv
;

762 
	}
}

765 
	$´oûss_£t¡©
()

767 
A‰rib
 *
a
;

768 
u_št32_t
 
id
;

769 *
Çme
;

770 
¡©us
 = 
SSH2_FX_OK
, 
»t
;

772 
id
 = 
	`g‘_št
();

773 
Çme
 = 
	`g‘_¡ršg
(
NULL
);

774 
a
 = 
	`g‘_©Œib
();

775 
	`debug
("»que¡ %u: s‘¡©‚am\"%s\"", 
id
, 
Çme
);

776 ià(
»adÚly
) {

777 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

778 
a
->
æags
 = 0;

780 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_SIZE
) {

781 
	`log™
("set \"%s\" size %llu",

782 
Çme
, ()
a
->
size
);

783 
»t
 = 
	`Œunÿ‹
(
Çme
, 
a
->
size
);

784 ià(
»t
 == -1)

785 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

787 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_PERMISSIONS
) {

788 
	`log™
("£ˆ\"%s\" mod%04o", 
Çme
, 
a
->
³rm
);

789 
»t
 = 
	`chmod
(
Çme
, 
a
->
³rm
 & 07777);

790 ià(
»t
 == -1)

791 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

793 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_ACMODTIME
) {

794 
buf
[64];

795 
time_t
 
t
 = 
a
->
mtime
;

797 
	`¡ráime
(
buf
, (buf), "%Y%m%d-%H:%M:%S",

798 
	`loÿÉime
(&
t
));

799 
	`log™
("£ˆ\"%s\" modtim%s", 
Çme
, 
buf
);

800 
»t
 = 
	`utimes
(
Çme
, 
	`©Œib_to_tv
(
a
));

801 ià(
»t
 == -1)

802 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

804 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_UIDGID
) {

805 
	`log™
("£ˆ\"%s\" owÃ¸%lu grou°%lu", 
Çme
,

806 (
u_lÚg
)
a
->
uid
, (u_lÚgï->
gid
);

807 
»t
 = 
	`chown
(
Çme
, 
a
->
uid
,‡->
gid
);

808 ià(
»t
 == -1)

809 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

811 
	`£nd_¡©us
(
id
, 
¡©us
);

812 
	`xä“
(
Çme
);

813 
	}
}

816 
	$´oûss_f£t¡©
()

818 
A‰rib
 *
a
;

819 
u_št32_t
 
id
;

820 
hªdË
, 
fd
, 
»t
;

821 
¡©us
 = 
SSH2_FX_OK
;

823 
id
 = 
	`g‘_št
();

824 
hªdË
 = 
	`g‘_hªdË
();

825 
a
 = 
	`g‘_©Œib
();

826 
	`debug
("»que¡ %u: f£t¡© hªdË %d", 
id
, 
hªdË
);

827 
fd
 = 
	`hªdË_to_fd
(
hªdË
);

828 ià(
fd
 < 0)

829 
¡©us
 = 
SSH2_FX_FAILURE
;

830 ià(
»adÚly
)

831 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

833 *
Çme
 = 
	`hªdË_to_Çme
(
hªdË
);

835 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_SIZE
) {

836 
	`log™
("set \"%s\" size %llu",

837 
Çme
, ()
a
->
size
);

838 
»t
 = 
	`árunÿ‹
(
fd
, 
a
->
size
);

839 ià(
»t
 == -1)

840 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

842 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_PERMISSIONS
) {

843 
	`log™
("£ˆ\"%s\" mod%04o", 
Çme
, 
a
->
³rm
);

844 #ifdeà
HAVE_FCHMOD


845 
»t
 = 
	`fchmod
(
fd
, 
a
->
³rm
 & 07777);

847 
»t
 = 
	`chmod
(
Çme
, 
a
->
³rm
 & 07777);

849 ià(
»t
 == -1)

850 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

852 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_ACMODTIME
) {

853 
buf
[64];

854 
time_t
 
t
 = 
a
->
mtime
;

856 
	`¡ráime
(
buf
, (buf), "%Y%m%d-%H:%M:%S",

857 
	`loÿÉime
(&
t
));

858 
	`log™
("£ˆ\"%s\" modtim%s", 
Çme
, 
buf
);

859 #ifdeà
HAVE_FUTIMES


860 
»t
 = 
	`futimes
(
fd
, 
	`©Œib_to_tv
(
a
));

862 
»t
 = 
	`utimes
(
Çme
, 
	`©Œib_to_tv
(
a
));

864 ià(
»t
 == -1)

865 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

867 ià(
a
->
æags
 & 
SSH2_FILEXFER_ATTR_UIDGID
) {

868 
	`log™
("£ˆ\"%s\" owÃ¸%lu grou°%lu", 
Çme
,

869 (
u_lÚg
)
a
->
uid
, (u_lÚgï->
gid
);

870 #ifdeà
HAVE_FCHOWN


871 
»t
 = 
	`fchown
(
fd
, 
a
->
uid
,‡->
gid
);

873 
»t
 = 
	`chown
(
Çme
, 
a
->
uid
,‡->
gid
);

875 ià(
»t
 == -1)

876 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

879 
	`£nd_¡©us
(
id
, 
¡©us
);

880 
	}
}

883 
	$´oûss_İ’dœ
()

885 
DIR
 *
dœp
 = 
NULL
;

886 *
·th
;

887 
hªdË
, 
¡©us
 = 
SSH2_FX_FAILURE
;

888 
u_št32_t
 
id
;

890 
id
 = 
	`g‘_št
();

891 
·th
 = 
	`g‘_¡ršg
(
NULL
);

892 
	`debug3
("»que¡ %u: o³ndœ", 
id
);

893 
	`log™
("İ’dœ \"%s\"", 
·th
);

894 
dœp
 = 
	`İ’dœ
(
·th
);

895 ià(
dœp
 =ğ
NULL
) {

896 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

898 
hªdË
 = 
	`hªdË_Ãw
(
HANDLE_DIR
, 
·th
, 0, 
dœp
);

899 ià(
hªdË
 < 0) {

900 
	`şo£dœ
(
dœp
);

902 
	`£nd_hªdË
(
id
, 
hªdË
);

903 
¡©us
 = 
SSH2_FX_OK
;

907 ià(
¡©us
 !ğ
SSH2_FX_OK
)

908 
	`£nd_¡©us
(
id
, 
¡©us
);

909 
	`xä“
(
·th
);

910 
	}
}

913 
	$´oûss_»addœ
()

915 
DIR
 *
dœp
;

916 
dœ’t
 *
dp
;

917 *
·th
;

918 
hªdË
;

919 
u_št32_t
 
id
;

921 
id
 = 
	`g‘_št
();

922 
hªdË
 = 
	`g‘_hªdË
();

923 
	`debug
("»que¡ %u:„—ddœ \"%s\" (hªdË %d)", 
id
,

924 
	`hªdË_to_Çme
(
hªdË
), handle);

925 
dœp
 = 
	`hªdË_to_dœ
(
hªdË
);

926 
·th
 = 
	`hªdË_to_Çme
(
hªdË
);

927 ià(
dœp
 =ğ
NULL
 || 
·th
 == NULL) {

928 
	`£nd_¡©us
(
id
, 
SSH2_FX_FAILURE
);

930 
¡©
 
¡
;

931 
·thÇme
[
MAXPATHLEN
];

932 
St
 *
¡©s
;

933 
n¡©s
 = 10, 
couÁ
 = 0, 
i
;

935 
¡©s
 = 
	`xÿÎoc
(
n¡©s
, (
St
));

936 (
dp
 = 
	`»addœ
(
dœp
)è!ğ
NULL
) {

937 ià(
couÁ
 >ğ
n¡©s
) {

938 
n¡©s
 *= 2;

939 
¡©s
 = 
	`x»®loc
(¡©s, 
n¡©s
, (
St
));

942 
	`¢´štf
(
·thÇme
, …©hÇme, "%s%s%s", 
·th
,

943 
	`¡rcmp
(
·th
, "/"è? "/" : "", 
dp
->
d_Çme
);

944 ià(
	`l¡©
(
·thÇme
, &
¡
) < 0)

946 
	`¡©_to_©Œib
(&
¡
, &(
¡©s
[
couÁ
].
©Œib
));

947 
¡©s
[
couÁ
].
Çme
 = 
	`x¡rdup
(
dp
->
d_Çme
);

948 
¡©s
[
couÁ
].
lÚg_Çme
 = 
	`ls_fe
(
dp
->
d_Çme
, &
¡
, 0, 0);

949 
couÁ
++;

952 ià(
couÁ
 == 100)

955 ià(
couÁ
 > 0) {

956 
	`£nd_Çmes
(
id
, 
couÁ
, 
¡©s
);

957 
i
 = 0; i < 
couÁ
; i++) {

958 
	`xä“
(
¡©s
[
i
].
Çme
);

959 
	`xä“
(
¡©s
[
i
].
lÚg_Çme
);

962 
	`£nd_¡©us
(
id
, 
SSH2_FX_EOF
);

964 
	`xä“
(
¡©s
);

966 
	}
}

969 
	$´oûss_»move
()

971 *
Çme
;

972 
u_št32_t
 
id
;

973 
¡©us
 = 
SSH2_FX_FAILURE
;

974 
»t
;

976 
id
 = 
	`g‘_št
();

977 
Çme
 = 
	`g‘_¡ršg
(
NULL
);

978 
	`debug3
("»que¡ %u:„emove", 
id
);

979 
	`log™
("»movÇm\"%s\"", 
Çme
);

980 ià(
»adÚly
)

981 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

983 
»t
 = 
	`uÆšk
(
Çme
);

984 
¡©us
 = (
»t
 =ğ-1è? 
	`”ºo_to_pÜbË
(
”ºo
è: 
SSH2_FX_OK
;

986 
	`£nd_¡©us
(
id
, 
¡©us
);

987 
	`xä“
(
Çme
);

988 
	}
}

991 
	$´oûss_mkdœ
()

993 
A‰rib
 *
a
;

994 
u_št32_t
 
id
;

995 *
Çme
;

996 
»t
, 
mode
, 
¡©us
 = 
SSH2_FX_FAILURE
;

998 
id
 = 
	`g‘_št
();

999 
Çme
 = 
	`g‘_¡ršg
(
NULL
);

1000 
a
 = 
	`g‘_©Œib
();

1001 
mode
 = (
a
->
æags
 & 
SSH2_FILEXFER_ATTR_PERMISSIONS
) ?

1002 
a
->
³rm
 & 07777 : 0777;

1003 
	`debug3
("»que¡ %u: mkdœ", 
id
);

1004 
	`log™
("mkdœ‚am\"%s\" mod0%o", 
Çme
, 
mode
);

1005 ià(
»adÚly
)

1006 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

1008 
»t
 = 
	`mkdœ
(
Çme
, 
mode
);

1009 
¡©us
 = (
»t
 =ğ-1è? 
	`”ºo_to_pÜbË
(
”ºo
è: 
SSH2_FX_OK
;

1011 
	`£nd_¡©us
(
id
, 
¡©us
);

1012 
	`xä“
(
Çme
);

1013 
	}
}

1016 
	$´oûss_rmdœ
()

1018 
u_št32_t
 
id
;

1019 *
Çme
;

1020 
»t
, 
¡©us
;

1022 
id
 = 
	`g‘_št
();

1023 
Çme
 = 
	`g‘_¡ršg
(
NULL
);

1024 
	`debug3
("»que¡ %u:„mdœ", 
id
);

1025 
	`log™
("rmdœ‚am\"%s\"", 
Çme
);

1026 ià(
»adÚly
)

1027 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

1029 
»t
 = 
	`rmdœ
(
Çme
);

1030 
¡©us
 = (
»t
 =ğ-1è? 
	`”ºo_to_pÜbË
(
”ºo
è: 
SSH2_FX_OK
;

1032 
	`£nd_¡©us
(
id
, 
¡©us
);

1033 
	`xä“
(
Çme
);

1034 
	}
}

1037 
	$´oûss_»®·th
()

1039 
»sŞvedÇme
[
MAXPATHLEN
];

1040 
u_št32_t
 
id
;

1041 *
·th
;

1043 
id
 = 
	`g‘_št
();

1044 
·th
 = 
	`g‘_¡ršg
(
NULL
);

1045 ià(
·th
[0] == '\0') {

1046 
	`xä“
(
·th
);

1047 
·th
 = 
	`x¡rdup
(".");

1049 
	`debug3
("»que¡ %u:„—Í©h", 
id
);

1050 
	`v”bo£
("»®·th \"%s\"", 
·th
);

1051 ià(
	`»®·th
(
·th
, 
»sŞvedÇme
è=ğ
NULL
) {

1052 
	`£nd_¡©us
(
id
, 
	`”ºo_to_pÜbË
(
”ºo
));

1054 
St
 
s
;

1055 
	`©Œib_ş—r
(&
s
.
©Œib
);

1056 
s
.
Çme
 = s.
lÚg_Çme
 = 
»sŞvedÇme
;

1057 
	`£nd_Çmes
(
id
, 1, &
s
);

1059 
	`xä“
(
·th
);

1060 
	}
}

1063 
	$´oûss_»Çme
()

1065 
u_št32_t
 
id
;

1066 *
Şd·th
, *
Ãw·th
;

1067 
¡©us
;

1068 
¡©
 
sb
;

1070 
id
 = 
	`g‘_št
();

1071 
Şd·th
 = 
	`g‘_¡ršg
(
NULL
);

1072 
Ãw·th
 = 
	`g‘_¡ršg
(
NULL
);

1073 
	`debug3
("»que¡ %u:„’ame", 
id
);

1074 
	`log™
("»ÇmŞd \"%s\"‚ew \"%s\"", 
Şd·th
, 
Ãw·th
);

1075 
¡©us
 = 
SSH2_FX_FAILURE
;

1076 ià(
»adÚly
)

1077 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

1078 ià(
	`l¡©
(
Şd·th
, &
sb
) == -1)

1079 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

1080 ià(
	`S_ISREG
(
sb
.
¡_mode
)) {

1082 ià(
	`lšk
(
Şd·th
, 
Ãw·th
) == -1) {

1083 ià(
”ºo
 =ğ
EOPNOTSUPP
 ||ƒ¼nØ=ğ
ENOSYS


1084 #ifdeà
EXDEV


1085 || 
”ºo
 =ğ
EXDEV


1087 #ifdeà
LINK_OPNOTSUPP_ERRNO


1088 || 
”ºo
 =ğ
LINK_OPNOTSUPP_ERRNO


1091 
¡©
 
¡
;

1097 ià(
	`¡©
(
Ãw·th
, &
¡
) == -1) {

1098 ià(
	`»Çme
(
Şd·th
, 
Ãw·th
) == -1)

1099 
¡©us
 =

1100 
	`”ºo_to_pÜbË
(
”ºo
);

1102 
¡©us
 = 
SSH2_FX_OK
;

1105 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

1107 } ià(
	`uÆšk
(
Şd·th
) == -1) {

1108 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

1110 
	`uÆšk
(
Ãw·th
);

1112 
¡©us
 = 
SSH2_FX_OK
;

1113 } ià(
	`¡©
(
Ãw·th
, &
sb
) == -1) {

1114 ià(
	`»Çme
(
Şd·th
, 
Ãw·th
) == -1)

1115 
¡©us
 = 
	`”ºo_to_pÜbË
(
”ºo
);

1117 
¡©us
 = 
SSH2_FX_OK
;

1119 
	`£nd_¡©us
(
id
, 
¡©us
);

1120 
	`xä“
(
Şd·th
);

1121 
	`xä“
(
Ãw·th
);

1122 
	}
}

1125 
	$´oûss_»adlšk
()

1127 
u_št32_t
 
id
;

1128 
Ën
;

1129 
buf
[
MAXPATHLEN
];

1130 *
·th
;

1132 
id
 = 
	`g‘_št
();

1133 
·th
 = 
	`g‘_¡ršg
(
NULL
);

1134 
	`debug3
("»que¡ %u:„—dlšk", 
id
);

1135 
	`v”bo£
("»adlšk \"%s\"", 
·th
);

1136 ià((
Ën
 = 
	`»adlšk
(
·th
, 
buf
, (buf) - 1)) == -1)

1137 
	`£nd_¡©us
(
id
, 
	`”ºo_to_pÜbË
(
”ºo
));

1139 
St
 
s
;

1141 
buf
[
Ën
] = '\0';

1142 
	`©Œib_ş—r
(&
s
.
©Œib
);

1143 
s
.
Çme
 = s.
lÚg_Çme
 = 
buf
;

1144 
	`£nd_Çmes
(
id
, 1, &
s
);

1146 
	`xä“
(
·th
);

1147 
	}
}

1150 
	$´oûss_symlšk
()

1152 
u_št32_t
 
id
;

1153 *
Şd·th
, *
Ãw·th
;

1154 
»t
, 
¡©us
;

1156 
id
 = 
	`g‘_št
();

1157 
Şd·th
 = 
	`g‘_¡ršg
(
NULL
);

1158 
Ãw·th
 = 
	`g‘_¡ršg
(
NULL
);

1159 
	`debug3
("»que¡ %u: symlšk", 
id
);

1160 
	`log™
("symlšk old \"%s\"‚ew \"%s\"", 
Şd·th
, 
Ãw·th
);

1162 ià(
»adÚly
)

1163 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

1165 
»t
 = 
	`symlšk
(
Şd·th
, 
Ãw·th
);

1166 
¡©us
 = (
»t
 =ğ-1è? 
	`”ºo_to_pÜbË
(
”ºo
è: 
SSH2_FX_OK
;

1168 
	`£nd_¡©us
(
id
, 
¡©us
);

1169 
	`xä“
(
Şd·th
);

1170 
	`xä“
(
Ãw·th
);

1171 
	}
}

1174 
	$´oûss_ex‹nded_posix_»Çme
(
u_št32_t
 
id
)

1176 *
Şd·th
, *
Ãw·th
;

1177 
»t
, 
¡©us
;

1179 
Şd·th
 = 
	`g‘_¡ršg
(
NULL
);

1180 
Ãw·th
 = 
	`g‘_¡ršg
(
NULL
);

1181 
	`debug3
("»que¡ %u:…osix-»Çme", 
id
);

1182 
	`log™
("posix-»ÇmŞd \"%s\"‚ew \"%s\"", 
Şd·th
, 
Ãw·th
);

1183 ià(
»adÚly
)

1184 
¡©us
 = 
SSH2_FX_PERMISSION_DENIED
;

1186 
»t
 = 
	`»Çme
(
Şd·th
, 
Ãw·th
);

1187 
¡©us
 = (
»t
 =ğ-1è? 
	`”ºo_to_pÜbË
(
”ºo
è: 
SSH2_FX_OK
;

1189 
	`£nd_¡©us
(
id
, 
¡©us
);

1190 
	`xä“
(
Şd·th
);

1191 
	`xä“
(
Ãw·th
);

1192 
	}
}

1195 
	$´oûss_ex‹nded_¡©vfs
(
u_št32_t
 
id
)

1197 *
·th
;

1198 
¡©vfs
 
¡
;

1200 
·th
 = 
	`g‘_¡ršg
(
NULL
);

1201 
	`debug3
("»que¡ %u: stfs", 
id
);

1202 
	`log™
("¡©f \"%s\"", 
·th
);

1204 ià(
	`¡©vfs
(
·th
, &
¡
) != 0)

1205 
	`£nd_¡©us
(
id
, 
	`”ºo_to_pÜbË
(
”ºo
));

1207 
	`£nd_¡©vfs
(
id
, &
¡
);

1208 
	`xä“
(
·th
);

1209 
	}
}

1212 
	$´oûss_ex‹nded_f¡©vfs
(
u_št32_t
 
id
)

1214 
hªdË
, 
fd
;

1215 
¡©vfs
 
¡
;

1217 
hªdË
 = 
	`g‘_hªdË
();

1218 
	`debug
("request %u: fstatvfs \"%s\" (handle %u)",

1219 
id
, 
	`hªdË_to_Çme
(
hªdË
), handle);

1220 ià((
fd
 = 
	`hªdË_to_fd
(
hªdË
)) < 0) {

1221 
	`£nd_¡©us
(
id
, 
SSH2_FX_FAILURE
);

1224 ià(
	`f¡©vfs
(
fd
, &
¡
) != 0)

1225 
	`£nd_¡©us
(
id
, 
	`”ºo_to_pÜbË
(
”ºo
));

1227 
	`£nd_¡©vfs
(
id
, &
¡
);

1228 
	}
}

1231 
	$´oûss_ex‹nded
()

1233 
u_št32_t
 
id
;

1234 *
»que¡
;

1236 
id
 = 
	`g‘_št
();

1237 
»que¡
 = 
	`g‘_¡ršg
(
NULL
);

1238 ià(
	`¡rcmp
(
»que¡
, "posix-rename@openssh.com") == 0)

1239 
	`´oûss_ex‹nded_posix_»Çme
(
id
);

1240 ià(
	`¡rcmp
(
»que¡
, "statvfs@openssh.com") == 0)

1241 
	`´oûss_ex‹nded_¡©vfs
(
id
);

1242 ià(
	`¡rcmp
(
»que¡
, "fstatvfs@openssh.com") == 0)

1243 
	`´oûss_ex‹nded_f¡©vfs
(
id
);

1245 
	`£nd_¡©us
(
id
, 
SSH2_FX_OP_UNSUPPORTED
);

1246 
	`xä“
(
»que¡
);

1247 
	}
}

1252 
	$´oûss
()

1254 
u_št
 
msg_Ën
;

1255 
u_št
 
buf_Ën
;

1256 
u_št
 
cÚsumed
;

1257 
u_št
 
ty³
;

1258 
u_ch¬
 *
ı
;

1260 
buf_Ën
 = 
	`bufãr_Ën
(&
iqueue
);

1261 ià(
buf_Ën
 < 5)

1263 
ı
 = 
	`bufãr_±r
(&
iqueue
);

1264 
msg_Ën
 = 
	`g‘_u32
(
ı
);

1265 ià(
msg_Ën
 > 
SFTP_MAX_MSG_LENGTH
) {

1266 
	`”rÜ
("bad message from %s†ocal user %s",

1267 
ş›Á_addr
, 
pw
->
pw_Çme
);

1268 
	`sáp_£rv”_ş—nup_ex™
(11);

1270 ià(
buf_Ën
 < 
msg_Ën
 + 4)

1272 
	`bufãr_cÚsume
(&
iqueue
, 4);

1273 
buf_Ën
 -= 4;

1274 
ty³
 = 
	`bufãr_g‘_ch¬
(&
iqueue
);

1275 
ty³
) {

1276 
SSH2_FXP_INIT
:

1277 
	`´oûss_š™
();

1279 
SSH2_FXP_OPEN
:

1280 
	`´oûss_İ’
();

1282 
SSH2_FXP_CLOSE
:

1283 
	`´oûss_şo£
();

1285 
SSH2_FXP_READ
:

1286 
	`´oûss_»ad
();

1288 
SSH2_FXP_WRITE
:

1289 
	`´oûss_wr™e
();

1291 
SSH2_FXP_LSTAT
:

1292 
	`´oûss_l¡©
();

1294 
SSH2_FXP_FSTAT
:

1295 
	`´oûss_f¡©
();

1297 
SSH2_FXP_SETSTAT
:

1298 
	`´oûss_£t¡©
();

1300 
SSH2_FXP_FSETSTAT
:

1301 
	`´oûss_f£t¡©
();

1303 
SSH2_FXP_OPENDIR
:

1304 
	`´oûss_İ’dœ
();

1306 
SSH2_FXP_READDIR
:

1307 
	`´oûss_»addœ
();

1309 
SSH2_FXP_REMOVE
:

1310 
	`´oûss_»move
();

1312 
SSH2_FXP_MKDIR
:

1313 
	`´oûss_mkdœ
();

1315 
SSH2_FXP_RMDIR
:

1316 
	`´oûss_rmdœ
();

1318 
SSH2_FXP_REALPATH
:

1319 
	`´oûss_»®·th
();

1321 
SSH2_FXP_STAT
:

1322 
	`´oûss_¡©
();

1324 
SSH2_FXP_RENAME
:

1325 
	`´oûss_»Çme
();

1327 
SSH2_FXP_READLINK
:

1328 
	`´oûss_»adlšk
();

1330 
SSH2_FXP_SYMLINK
:

1331 
	`´oûss_symlšk
();

1333 
SSH2_FXP_EXTENDED
:

1334 
	`´oûss_ex‹nded
();

1337 
	`”rÜ
("UnknowÀmes§g%d", 
ty³
);

1341 ià(
buf_Ën
 < 
	`bufãr_Ën
(&
iqueue
)) {

1342 
	`”rÜ
("iqueue grew unexpectedly");

1343 
	`sáp_£rv”_ş—nup_ex™
(255);

1345 
cÚsumed
 = 
buf_Ën
 - 
	`bufãr_Ën
(&
iqueue
);

1346 ià(
msg_Ën
 < 
cÚsumed
) {

1347 
	`”rÜ
("msg_ËÀ%d < cÚsumed %d", 
msg_Ën
, 
cÚsumed
);

1348 
	`sáp_£rv”_ş—nup_ex™
(255);

1350 ià(
msg_Ën
 > 
cÚsumed
)

1351 
	`bufãr_cÚsume
(&
iqueue
, 
msg_Ën
 - 
cÚsumed
);

1352 
	}
}

1356 
	$sáp_£rv”_ş—nup_ex™
(
i
)

1358 ià(
pw
 !ğ
NULL
 && 
ş›Á_addr
 != NULL) {

1359 
	`hªdË_log_ex™
();

1360 
	`log™
("session closed for†ocal user %s from [%s]",

1361 
pw
->
pw_Çme
, 
ş›Á_addr
);

1363 
	`_ex™
(
i
);

1364 
	}
}

1367 
	$sáp_£rv”_u§ge
()

1369 *
__´ogÇme
;

1371 
	`årštf
(
¡d”r
,

1373 
__´ogÇme
);

1374 
	`ex™
(1);

1375 
	}
}

1378 
	$sáp_£rv”_maš
(
¬gc
, **
¬gv
, 
·sswd
 *
u£r_pw
)

1380 
fd_£t
 *
r£t
, *
w£t
;

1381 
š
, 
out
, 
max
, 
ch
, 
sk¬gs
 = 0, 
log_¡d”r
 = 0;

1382 
ssize_t
 
Ën
, 
Ş’
, 
£t_size
;

1383 
Sy¦ogFac™y
 
log_çc™y
 = 
SYSLOG_FACILITY_AUTH
;

1384 *
ı
, 
buf
[4*4096];

1385 cÚ¡ *
”rmsg
;

1386 
mode_t
 
mask
;

1388 *
İrg
;

1389 *
__´ogÇme
;

1391 
__´ogÇme
 = 
	`ssh_g‘_´ogÇme
(
¬gv
[0]);

1392 
	`log_š™
(
__´ogÇme
, 
log_Ëv–
, 
log_çc™y
, 
log_¡d”r
);

1394 
çke_³rmissiÚs
 = 0;

1395 !
sk¬gs
 && (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "f:l:u:cehRU")) != -1) {

1396 
ch
) {

1398 
»adÚly
 = 1;

1405 
sk¬gs
 = 1;

1408 
log_¡d”r
 = 1;

1411 
log_Ëv–
 = 
	`log_Ëv–_numb”
(
İrg
);

1412 ià(
log_Ëv–
 =ğ
SYSLOG_LEVEL_NOT_SET
)

1413 
	`”rÜ
("Inv®id†og†ev– \"%s\"", 
İrg
);

1416 
log_çc™y
 = 
	`log_çc™y_numb”
(
İrg
);

1417 ià(
log_çc™y
 =ğ
SYSLOG_FACILITY_NOT_SET
)

1418 
	`”rÜ
("Inv®id†og fac™y \"%s\"", 
İrg
);

1421 
mask
 = (
mode_t
)
	`¡¹Úum
(
İrg
, 0, 0777, &
”rmsg
);

1422 ià(
”rmsg
 !ğ
NULL
)

1423 
	`çl
("Invalid umask \"%s\": %s",

1424 
İrg
, 
”rmsg
);

1425 ()
	`umask
(
mask
);

1428 
çke_³rmissiÚs
 = 1;

1432 
	`sáp_£rv”_u§ge
();

1436 
	`log_š™
(
__´ogÇme
, 
log_Ëv–
, 
log_çc™y
, 
log_¡d”r
);

1438 ià((
ı
 = 
	`g‘’v
("SSH_CONNECTION")è!ğ
NULL
) {

1439 
ş›Á_addr
 = 
	`x¡rdup
(
ı
);

1440 ià((
ı
 = 
	`¡rchr
(
ş›Á_addr
, ' ')è=ğ
NULL
) {

1441 
	`”rÜ
("Malformed SSH_CONNECTION variable: \"%s\"",

1442 
	`g‘’v
("SSH_CONNECTION"));

1443 
	`sáp_£rv”_ş—nup_ex™
(255);

1445 *
ı
 = '\0';

1447 
ş›Á_addr
 = 
	`x¡rdup
("UNKNOWN");

1449 
pw
 = 
	`pwcİy
(
u£r_pw
);

1451 
	`log™
("session opened for†ocal user %s from [%s]",

1452 
pw
->
pw_Çme
, 
ş›Á_addr
);

1454 
š
 = 
STDIN_FILENO
;

1455 
out
 = 
STDOUT_FILENO
;

1457 #ifdeà
HAVE_CYGWIN


1458 
	`£tmode
(
š
, 
O_BINARY
);

1459 
	`£tmode
(
out
, 
O_BINARY
);

1462 
max
 = 0;

1463 ià(
š
 > 
max
)

1464 
max
 = 
š
;

1465 ià(
out
 > 
max
)

1466 
max
 = 
out
;

1468 
	`bufãr_š™
(&
iqueue
);

1469 
	`bufãr_š™
(&
oqueue
);

1471 
£t_size
 = 
	`howmªy
(
max
 + 1, 
NFDBITS
è* (
fd_mask
);

1472 
r£t
 = (
fd_£t
 *)
	`xm®loc
(
£t_size
);

1473 
w£t
 = (
fd_£t
 *)
	`xm®loc
(
£t_size
);

1476 
	`mem£t
(
r£t
, 0, 
£t_size
);

1477 
	`mem£t
(
w£t
, 0, 
£t_size
);

1484 ià(
	`bufãr_check_®loc
(&
iqueue
, (
buf
)) &&

1485 
	`bufãr_check_®loc
(&
oqueue
, 
SFTP_MAX_MSG_LENGTH
))

1486 
	`FD_SET
(
š
, 
r£t
);

1488 
Ş’
 = 
	`bufãr_Ën
(&
oqueue
);

1489 ià(
Ş’
 > 0)

1490 
	`FD_SET
(
out
, 
w£t
);

1492 ià(
	`£Ëù
(
max
+1, 
r£t
, 
w£t
, 
NULL
, NULL) < 0) {

1493 ià(
”ºo
 =ğ
EINTR
)

1495 
	`”rÜ
("£Ëù: %s", 
	`¡»¼Ü
(
”ºo
));

1496 
	`sáp_£rv”_ş—nup_ex™
(2);

1500 ià(
	`FD_ISSET
(
š
, 
r£t
)) {

1501 
Ën
 = 
	`»ad
(
š
, 
buf
,  buf);

1502 ià(
Ën
 == 0) {

1503 
	`debug
("readƒof");

1504 
	`sáp_£rv”_ş—nup_ex™
(0);

1505 } ià(
Ën
 < 0) {

1506 
	`”rÜ
("»ad: %s", 
	`¡»¼Ü
(
”ºo
));

1507 
	`sáp_£rv”_ş—nup_ex™
(1);

1509 
	`bufãr_­³nd
(&
iqueue
, 
buf
, 
Ën
);

1513 ià(
	`FD_ISSET
(
out
, 
w£t
)) {

1514 
Ën
 = 
	`wr™e
(
out
, 
	`bufãr_±r
(&
oqueue
), 
Ş’
);

1515 ià(
Ën
 < 0) {

1516 
	`”rÜ
("wr™e: %s", 
	`¡»¼Ü
(
”ºo
));

1517 
	`sáp_£rv”_ş—nup_ex™
(1);

1519 
	`bufãr_cÚsume
(&
oqueue
, 
Ën
);

1528 ià(
	`bufãr_check_®loc
(&
oqueue
, 
SFTP_MAX_MSG_LENGTH
))

1529 
	`´oûss
();

1531 
	}
}

	@sftp-server/sftp.h

32 
	#SSH2_FILEXFER_VERSION
 3

	)

35 
	#SSH2_FXP_INIT
 1

	)

36 
	#SSH2_FXP_OPEN
 3

	)

37 
	#SSH2_FXP_CLOSE
 4

	)

38 
	#SSH2_FXP_READ
 5

	)

39 
	#SSH2_FXP_WRITE
 6

	)

40 
	#SSH2_FXP_LSTAT
 7

	)

41 
	#SSH2_FXP_STAT_VERSION_0
 7

	)

42 
	#SSH2_FXP_FSTAT
 8

	)

43 
	#SSH2_FXP_SETSTAT
 9

	)

44 
	#SSH2_FXP_FSETSTAT
 10

	)

45 
	#SSH2_FXP_OPENDIR
 11

	)

46 
	#SSH2_FXP_READDIR
 12

	)

47 
	#SSH2_FXP_REMOVE
 13

	)

48 
	#SSH2_FXP_MKDIR
 14

	)

49 
	#SSH2_FXP_RMDIR
 15

	)

50 
	#SSH2_FXP_REALPATH
 16

	)

51 
	#SSH2_FXP_STAT
 17

	)

52 
	#SSH2_FXP_RENAME
 18

	)

53 
	#SSH2_FXP_READLINK
 19

	)

54 
	#SSH2_FXP_SYMLINK
 20

	)

57 
	#SSH2_FXP_VERSION
 2

	)

58 
	#SSH2_FXP_STATUS
 101

	)

59 
	#SSH2_FXP_HANDLE
 102

	)

60 
	#SSH2_FXP_DATA
 103

	)

61 
	#SSH2_FXP_NAME
 104

	)

62 
	#SSH2_FXP_ATTRS
 105

	)

64 
	#SSH2_FXP_EXTENDED
 200

	)

65 
	#SSH2_FXP_EXTENDED_REPLY
 201

	)

68 
	#SSH2_FILEXFER_ATTR_SIZE
 0x00000001

	)

69 
	#SSH2_FILEXFER_ATTR_UIDGID
 0x00000002

	)

70 
	#SSH2_FILEXFER_ATTR_PERMISSIONS
 0x00000004

	)

71 
	#SSH2_FILEXFER_ATTR_ACMODTIME
 0x00000008

	)

72 
	#SSH2_FILEXFER_ATTR_EXTENDED
 0x80000000

	)

75 
	#SSH2_FXF_READ
 0x00000001

	)

76 
	#SSH2_FXF_WRITE
 0x00000002

	)

77 
	#SSH2_FXF_APPEND
 0x00000004

	)

78 
	#SSH2_FXF_CREAT
 0x00000008

	)

79 
	#SSH2_FXF_TRUNC
 0x00000010

	)

80 
	#SSH2_FXF_EXCL
 0x00000020

	)

83 
	#SSH2_FXE_STATVFS_ST_RDONLY
 0x00000001

	)

84 
	#SSH2_FXE_STATVFS_ST_NOSUID
 0x00000002

	)

87 
	#SSH2_FX_OK
 0

	)

88 
	#SSH2_FX_EOF
 1

	)

89 
	#SSH2_FX_NO_SUCH_FILE
 2

	)

90 
	#SSH2_FX_PERMISSION_DENIED
 3

	)

91 
	#SSH2_FX_FAILURE
 4

	)

92 
	#SSH2_FX_BAD_MESSAGE
 5

	)

93 
	#SSH2_FX_NO_CONNECTION
 6

	)

94 
	#SSH2_FX_CONNECTION_LOST
 7

	)

95 
	#SSH2_FX_OP_UNSUPPORTED
 8

	)

96 
	#SSH2_FX_MAX
 8

	)

98 
	g·sswd
;

100 
sáp_£rv”_maš
(, **, 
·sswd
 *);

101 
	$sáp_£rv”_ş—nup_ex™
(è
	`__©Œibu‹__
((
nÜ‘uº
));

	@sftp-server/ssh.h

16 
	#SSH_AUTHFILE_CIPHER
 
SSH_CIPHER_3DES


	)

19 
	#SSH_DEFAULT_PORT
 22

	)

22 
	#SSH_MAX_FORWARDS_PER_DIRECTION
 100

	)

28 
	#SSH_MAX_IDENTITY_FILES
 100

	)

35 
	#SSH_MAX_PUBKEY_BYTES
 8192

	)

44 
	#PROTOCOL_MAJOR_1
 1

	)

45 
	#PROTOCOL_MINOR_1
 5

	)

48 
	#PROTOCOL_MAJOR_2
 2

	)

49 
	#PROTOCOL_MINOR_2
 0

	)

55 
	#SSH_SERVICE_NAME
 "ssh"

	)

61 
	#SSH_AGENTPID_ENV_NAME
 "SSH_AGENT_PID"

	)

67 
	#SSH_AUTHSOCKET_ENV_NAME
 "SSH_AUTH_SOCK"

	)

72 
	#SSH_ASKPASS_ENV
 "SSH_ASKPASS"

	)

78 
	#SSH_KEY_BITS_RESERVED
 128

	)

84 
	#SSH_SESSION_KEY_LENGTH
 32

	)

87 
	#SSH_ESCAPECHAR_NONE
 -2

	)

94 #iâdeà
SSH_PRIVSEP_USER


95 
	#SSH_PRIVSEP_USER
 "sshd"

	)

99 
	#SSH_RSA_MINIMUM_MODULUS_SIZE
 768

	)

102 
	#SSH_LISTEN_BACKLOG
 128

	)

	@sftp-server/uidswap.h

15 
‹mpÜ¬y_u£_uid
(
·sswd
 *);

16 
»¡Üe_uid
();

17 
³rmª’y_£t_uid
(
·sswd
 *);

18 
³rmª’y_drİ_suid
(
uid_t
);

	@sftp-server/xmalloc.c

16 
	~"šşudes.h
"

18 
	~<sys/·¿m.h
>

19 
	~<¡d¬g.h
>

20 
	~<¡dio.h
>

21 
	~<¡dlib.h
>

22 
	~<¡ršg.h
>

24 
	~"xm®loc.h
"

25 
	~"log.h
"

28 
	$xm®loc
(
size_t
 
size
)

30 *
±r
;

32 ià(
size
 == 0)

33 
	`çl
("xmalloc: zero size");

34 
±r
 = 
	`m®loc
(
size
);

35 ià(
±r
 =ğ
NULL
)

36 
	`çl
("xm®loc: ouˆoàmemÜy (®loÿtšg %lu by‹s)", (
u_lÚg
è
size
);

37  
±r
;

38 
	}
}

41 
	$xÿÎoc
(
size_t
 
nmemb
, size_ˆ
size
)

43 *
±r
;

45 ià(
size
 =ğ0 || 
nmemb
 == 0)

46 
	`çl
("xcalloc: zero size");

47 ià(
SIZE_T_MAX
 / 
nmemb
 < 
size
)

48 
	`çl
("xcalloc:‚memb * size > SIZE_T_MAX");

49 
±r
 = 
	`ÿÎoc
(
nmemb
, 
size
);

50 ià(
±r
 =ğ
NULL
)

51 
	`çl
("xcalloc: out of memory (allocating %lu bytes)",

52 (
u_lÚg
)(
size
 * 
nmemb
));

53  
±r
;

54 
	}
}

57 
	$x»®loc
(*
±r
, 
size_t
 
nmemb
, size_ˆ
size
)

59 *
Ãw_±r
;

60 
size_t
 
Ãw_size
 = 
nmemb
 * 
size
;

62 ià(
Ãw_size
 == 0)

63 
	`çl
("xrealloc: zero size");

64 ià(
SIZE_T_MAX
 / 
nmemb
 < 
size
)

65 
	`çl
("xrealloc:‚memb * size > SIZE_T_MAX");

66 ià(
±r
 =ğ
NULL
)

67 
Ãw_±r
 = 
	`m®loc
(
Ãw_size
);

69 
Ãw_±r
 = 
	`»®loc
(
±r
, 
Ãw_size
);

70 ià(
Ãw_±r
 =ğ
NULL
)

71 
	`çl
("xrealloc: out of memory (new_size %lu bytes)",

72 (
u_lÚg
è
Ãw_size
);

73  
Ãw_±r
;

74 
	}
}

77 
	$xä“
(*
±r
)

79 ià(
±r
 =ğ
NULL
)

80 
	`çl
("xfree: NULL…ointer given‡s‡rgument");

81 
	`ä“
(
±r
);

82 
	}
}

85 
	$x¡rdup
(cÚ¡ *
¡r
)

87 
size_t
 
Ën
;

88 *
ı
;

91 ià(!
¡r
)  0;

93 
Ën
 = 
	`¡¾’
(
¡r
) + 1;

94 
ı
 = 
	`xm®loc
(
Ën
);

95 
	`¡¾ıy
(
ı
, 
¡r
, 
Ën
);

96  
ı
;

97 
	}
}

100 
	$xa¥rštf
(**
»t
, cÚ¡ *
fmt
, ...)

102 
va_li¡
 
­
;

103 
i
;

105 
	`va_¡¬t
(
­
, 
fmt
);

106 
i
 = 
	`va¥rštf
(
»t
, 
fmt
, 
­
);

107 
	`va_’d
(
­
);

109 ià(
i
 < 0 || *
»t
 =ğ
NULL
)

110 
	`çl
("xasprintf: could‚ot‡llocate memory");

112  (
i
);

113 
	}
}

	@sftp-server/xmalloc.h

19 *
xm®loc
(
size_t
);

20 *
xÿÎoc
(
size_t
, size_t);

21 *
x»®loc
(*, 
size_t
, size_t);

22 
xä“
(*);

23 *
x¡rdup
(const *);

24 
	$xa¥rštf
(**, const *, ...)

25 
	`__©Œibu‹__
((
	$__fÜm©__
 (
´štf
, 2, 3)))

26 
	`__©Œibu‹__
((
	`__nÚnuÎ__
 (2)));

	@signkey.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"signkey.h
"

28 
	~"bufãr.h
"

29 
	~"ssh.h
"

32 
sign_key
 * 
	$Ãw_sign_key
() {

34 
sign_key
 * 
»t
;

36 
»t
 = (
sign_key
*)
	`m_m®loc
((sign_key));

37 #ifdeà
DROPBEAR_DSS


38 
»t
->
dsskey
 = 
NULL
;

40 #ifdeà
DROPBEAR_RSA


41 
»t
->
r§key
 = 
NULL
;

43 
»t
->
f’ame
 = 
NULL
;

44 
»t
->
ty³
 = 
DROPBEAR_SIGNKEY_NONE
;

45 
»t
->
sourû
 = 
SIGNKEY_SOURCE_INVALID
;

46  
»t
;

47 
	}
}

51 cÚ¡ * 
	$signkey_Çme_äom_ty³
(
ty³
, *
Çm–’
) {

53 #ifdeà
DROPBEAR_RSA


54 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

55 *
Çm–’
 = 
SSH_SIGNKEY_RSA_LEN
;

56  
SSH_SIGNKEY_RSA
;

59 #ifdeà
DROPBEAR_DSS


60 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

61 *
Çm–’
 = 
SSH_SIGNKEY_DSS_LEN
;

62  
SSH_SIGNKEY_DSS
;

65 
	`drİb—r_ex™
("Bad keyy³ %d", 
ty³
);

66  
NULL
;

67 
	}
}

71 
	$signkey_ty³_äom_Çme
(cÚ¡ * 
Çme
, 
Çm–’
) {

73 #ifdeà
DROPBEAR_RSA


74 ià(
Çm–’
 =ğ
SSH_SIGNKEY_RSA_LEN


75 && 
	`memcmp
(
Çme
, 
SSH_SIGNKEY_RSA
, 
SSH_SIGNKEY_RSA_LEN
) == 0) {

76  
DROPBEAR_SIGNKEY_RSA
;

79 #ifdeà
DROPBEAR_DSS


80 ià(
Çm–’
 =ğ
SSH_SIGNKEY_DSS_LEN


81 && 
	`memcmp
(
Çme
, 
SSH_SIGNKEY_DSS
, 
SSH_SIGNKEY_DSS_LEN
) == 0) {

82  
DROPBEAR_SIGNKEY_DSS
;

86 
	`TRACE
(("signkey_type_from_name unexpected keyype."))

88  
DROPBEAR_SIGNKEY_NONE
;

89 
	}
}

94 
	$buf_g‘_pub_key
(
bufãr
 *
buf
, 
sign_key
 *
key
, *
ty³
) {

96 * 
id’t
;

97 
Ën
;

98 
keyty³
;

99 
»t
 = 
DROPBEAR_FAILURE
;

101 
	`TRACE
(("enter buf_get_pub_key"))

103 
id’t
 = 
	`buf_g‘¡ršg
(
buf
, &
Ën
);

104 
keyty³
 = 
	`signkey_ty³_äom_Çme
(
id’t
, 
Ën
);

105 
	`m_ä“
(
id’t
);

107 ià(*
ty³
 !ğ
DROPBEAR_SIGNKEY_ANY
 && *ty³ !ğ
keyty³
) {

108 
	`TRACE
(("buf_g‘_pub_key bady³ - gÙ %d,ƒx³ùed %d", 
keyty³
, 
ty³
))

109  
DROPBEAR_FAILURE
;

112 
	`TRACE
(("buf_get_pub_key keytype is %d"))

114 *
ty³
 = 
keyty³
;

117 
	`buf_šüpos
(
buf
, -
Ën
 - 4);

119 #ifdeà
DROPBEAR_DSS


120 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

121 
	`dss_key_ä“
(
key
->
dsskey
);

122 
key
->
dsskey
 = 
	`m_m®loc
((*key->dsskey));

123 
»t
 = 
	`buf_g‘_dss_pub_key
(
buf
, 
key
->
dsskey
);

124 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

125 
	`m_ä“
(
key
->
dsskey
);

129 #ifdeà
DROPBEAR_RSA


130 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

131 
	`r§_key_ä“
(
key
->
r§key
);

132 
key
->
r§key
 = 
	`m_m®loc
((*key->rsakey));

133 
»t
 = 
	`buf_g‘_r§_pub_key
(
buf
, 
key
->
r§key
);

134 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

135 
	`m_ä“
(
key
->
r§key
);

140 
	`TRACE
(("leave buf_get_pub_key"))

142  
»t
;

144 
	}
}

149 
	$buf_g‘_´iv_key
(
bufãr
 *
buf
, 
sign_key
 *
key
, *
ty³
) {

151 * 
id’t
;

152 
Ën
;

153 
keyty³
;

154 
»t
 = 
DROPBEAR_FAILURE
;

156 
	`TRACE
(("enter buf_get_priv_key"))

158 
id’t
 = 
	`buf_g‘¡ršg
(
buf
, &
Ën
);

159 
keyty³
 = 
	`signkey_ty³_äom_Çme
(
id’t
, 
Ën
);

160 
	`m_ä“
(
id’t
);

162 ià(*
ty³
 !ğ
DROPBEAR_SIGNKEY_ANY
 && *ty³ !ğ
keyty³
) {

163 
	`TRACE
(("wrÚg keyy³: %d %d", *
ty³
, 
keyty³
))

164  
DROPBEAR_FAILURE
;

167 *
ty³
 = 
keyty³
;

170 
	`buf_šüpos
(
buf
, -
Ën
 - 4);

172 #ifdeà
DROPBEAR_DSS


173 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

174 
	`dss_key_ä“
(
key
->
dsskey
);

175 
key
->
dsskey
 = 
	`m_m®loc
((*key->dsskey));

176 
»t
 = 
	`buf_g‘_dss_´iv_key
(
buf
, 
key
->
dsskey
);

177 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

178 
	`m_ä“
(
key
->
dsskey
);

182 #ifdeà
DROPBEAR_RSA


183 ià(
keyty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

184 
	`r§_key_ä“
(
key
->
r§key
);

185 
key
->
r§key
 = 
	`m_m®loc
((*key->rsakey));

186 
»t
 = 
	`buf_g‘_r§_´iv_key
(
buf
, 
key
->
r§key
);

187 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

188 
	`m_ä“
(
key
->
r§key
);

193 
	`TRACE
(("leave buf_get_priv_key"))

195  
»t
;

197 
	}
}

200 
	$buf_put_pub_key
(
bufãr
* 
buf
, 
sign_key
 *
key
, 
ty³
) {

202 
bufãr
 *
pubkeys
;

204 
	`TRACE
(("enter buf_put_pub_key"))

205 
pubkeys
 = 
	`buf_Ãw
(
MAX_PUBKEY_SIZE
);

207 #ifdeà
DROPBEAR_DSS


208 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

209 
	`buf_put_dss_pub_key
(
pubkeys
, 
key
->
dsskey
);

212 #ifdeà
DROPBEAR_RSA


213 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

214 
	`buf_put_r§_pub_key
(
pubkeys
, 
key
->
r§key
);

217 ià(
pubkeys
->
Ën
 == 0) {

218 
	`drİb—r_ex™
("Bad keyypes in buf_put_pub_key");

221 
	`buf_£os
(
pubkeys
, 0);

222 
	`buf_put¡ršg
(
buf
, 
	`buf_g‘±r
(
pubkeys
,…ubkeys->
Ën
),

223 
pubkeys
->
Ën
);

225 
	`buf_ä“
(
pubkeys
);

226 
	`TRACE
(("leave buf_put_pub_key"))

227 
	}
}

230 
	$buf_put_´iv_key
(
bufãr
* 
buf
, 
sign_key
 *
key
, 
ty³
) {

232 
	`TRACE
(("enter buf_put_priv_key"))

233 
	`TRACE
(("ty³ i %d", 
ty³
))

235 #ifdeà
DROPBEAR_DSS


236 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

237 
	`buf_put_dss_´iv_key
(
buf
, 
key
->
dsskey
);

238 
	`TRACE
(("leave buf_put_priv_key: dss done"))

242 #ifdeà
DROPBEAR_RSA


243 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

244 
	`buf_put_r§_´iv_key
(
buf
, 
key
->
r§key
);

245 
	`TRACE
(("leave buf_put_priv_key:„sa done"))

249 
	`drİb—r_ex™
("Bad keyypes in…ut…ub key");

250 
	}
}

252 
	$sign_key_ä“
(
sign_key
 *
key
) {

254 
	`TRACE
(("enter sign_key_free"))

256 #ifdeà
DROPBEAR_DSS


257 
	`dss_key_ä“
(
key
->
dsskey
);

258 
key
->
dsskey
 = 
NULL
;

260 #ifdeà
DROPBEAR_RSA


261 
	`r§_key_ä“
(
key
->
r§key
);

262 
key
->
r§key
 = 
NULL
;

265 
	`m_ä“
(
key
->
f’ame
);

267 
	`m_ä“
(
key
);

268 
	`TRACE
(("leave sign_key_free"))

269 
	}
}

271 
	$hexdig
(
x
) {

273 ià(
x
 > 0xf)

276 ià(
x
 < 10)

277  '0' + 
x
;

279  'a' + 
x
 - 10;

280 
	}
}

284 #ifdeà
DROPBEAR_MD5_HMAC


285 * 
	$sign_key_md5_fšg”´št
(* 
keyblob
,

286 
keyblobËn
) {

288 * 
»t
;

289 
hash_¡©e
 
hs
;

290 
hash
[
MD5_HASH_SIZE
];

291 
i
;

292 
buæ’
;

294 
	`md5_š™
(&
hs
);

297 
	`md5_´oûss
(&
hs
, 
keyblob
, 
keyblobËn
);

299 
	`md5_dÚe
(&
hs
, 
hash
);

302 
buæ’
 = 4 + 3*
MD5_HASH_SIZE
;

303 
»t
 = (*)
	`m_m®loc
(
buæ’
);

305 
	`mem£t
(
»t
, 'Z', 
buæ’
);

306 
	`¡rıy
(
»t
, "md5 ");

308 
i
 = 0; i < 
MD5_HASH_SIZE
; i++) {

309 
pos
 = 4 + 
i
*3;

310 
»t
[
pos
] = 
	`hexdig
(
hash
[
i
] >> 4);

311 
»t
[
pos
+1] = 
	`hexdig
(
hash
[
i
] & 0x0f);

312 
»t
[
pos
+2] = ':';

314 
»t
[
buæ’
-1] = 0x0;

316  
»t
;

317 
	}
}

320 * 
	$sign_key_sha1_fšg”´št
(* 
keyblob
,

321 
keyblobËn
) {

323 * 
»t
;

324 
hash_¡©e
 
hs
;

325 
hash
[
SHA1_HASH_SIZE
];

326 
i
;

327 
buæ’
;

329 
	`sha1_š™
(&
hs
);

332 
	`sha1_´oûss
(&
hs
, 
keyblob
, 
keyblobËn
);

334 
	`sha1_dÚe
(&
hs
, 
hash
);

337 
buæ’
 = 5 + 3*
SHA1_HASH_SIZE
;

338 
»t
 = (*)
	`m_m®loc
(
buæ’
);

340 
	`¡rıy
(
»t
, "sha1 ");

342 
i
 = 0; i < 
SHA1_HASH_SIZE
; i++) {

343 
pos
 = 5 + 3*
i
;

344 
»t
[
pos
] = 
	`hexdig
(
hash
[
i
] >> 4);

345 
»t
[
pos
+1] = 
	`hexdig
(
hash
[
i
] & 0x0f);

346 
»t
[
pos
+2] = ':';

348 
»t
[
buæ’
-1] = 0x0;

350  
»t
;

351 
	}
}

357 * 
	$sign_key_fšg”´št
(* 
keyblob
, 
keyblobËn
) {

359 #ifdeà
DROPBEAR_MD5_HMAC


360  
	`sign_key_md5_fšg”´št
(
keyblob
, 
keyblobËn
);

362  
	`sign_key_sha1_fšg”´št
(
keyblob
, 
keyblobËn
);

364 
	}
}

366 
	$buf_put_sign
(
bufãr
* 
buf
, 
sign_key
 *
key
, 
ty³
,

367 cÚ¡ *
d©a
, 
Ën
) {

369 
bufãr
 *
sigblob
;

370 
sigblob
 = 
	`buf_Ãw
(
MAX_PUBKEY_SIZE
);

372 #ifdeà
DROPBEAR_DSS


373 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_DSS
) {

374 
	`buf_put_dss_sign
(
sigblob
, 
key
->
dsskey
, 
d©a
, 
Ën
);

377 #ifdeà
DROPBEAR_RSA


378 ià(
ty³
 =ğ
DROPBEAR_SIGNKEY_RSA
) {

379 
	`buf_put_r§_sign
(
sigblob
, 
key
->
r§key
, 
d©a
, 
Ën
);

382 ià(
sigblob
->
Ën
 == 0) {

383 
	`drİb—r_ex™
("Non-matching signingype");

385 
	`buf_£os
(
sigblob
, 0);

386 
	`buf_put¡ršg
(
buf
, 
	`buf_g‘±r
(
sigblob
, sigblob->
Ën
),

387 
sigblob
->
Ën
);

389 
	`buf_ä“
(
sigblob
);

391 
	}
}

393 #ifdeà
DROPBEAR_SIGNKEY_VERIFY


398 
	$buf_v”ify
(
bufãr
 * 
buf
, 
sign_key
 *
key
, cÚ¡ *
d©a
,

399 
Ën
) {

401 
blobËn
;

402 * 
id’t
 = 
NULL
;

403 
id’’
 = 0;

405 
	`TRACE
(("enter buf_verify"))

407 
blobËn
 = 
	`buf_g‘št
(
buf
);

408 
id’t
 = 
	`buf_g‘¡ršg
(
buf
, &
id’’
);

410 #ifdeà
DROPBEAR_DSS


411 ià(
blobËn
 =ğ
DSS_SIGNATURE_SIZE
 &&

412 
	`memcmp
(
id’t
, 
SSH_SIGNKEY_DSS
, 
id’’
) == 0) {

413 
	`m_ä“
(
id’t
);

414 ià(
key
->
dsskey
 =ğ
NULL
) {

415 
	`drİb—r_ex™
("No DSS keyo verify signature");

417  
	`buf_dss_v”ify
(
buf
, 
key
->
dsskey
, 
d©a
, 
Ën
);

421 #ifdeà
DROPBEAR_RSA


422 ià(
	`memcmp
(
id’t
, 
SSH_SIGNKEY_RSA
, 
id’’
) == 0) {

423 
	`m_ä“
(
id’t
);

424 ià(
key
->
r§key
 =ğ
NULL
) {

425 
	`drİb—r_ex™
("No RSA keyo verify signature");

427  
	`buf_r§_v”ify
(
buf
, 
key
->
r§key
, 
d©a
, 
Ën
);

431 
	`m_ä“
(
id’t
);

432 
	`drİb—r_ex™
("Non-matching signingype");

433  
DROPBEAR_FAILURE
;

434 
	}
}

437 #ifdeà
DROPBEAR_KEY_LINES


444 
	$cmp_ba£64_key
(cÚ¡ * 
keyblob
, 
keyblobËn
,

445 cÚ¡ * 
®gÚame
, 
®gŞ’
,

446 
bufãr
 * 
lše
, ** 
fšg”´št
) {

448 
bufãr
 * 
decodekey
 = 
NULL
;

449 
»t
 = 
DROPBEAR_FAILURE
;

450 
Ën
, 
f—lgŞ’
;

451 
decodekeyËn
;

452 * 
f—lgo
 = 
NULL
;

455 
Ën
 = 
lše
->ËÀ-†še->
pos
;

456 
decodekeyËn
 = 
Ën
 * 2;

457 
decodekey
 = 
	`buf_Ãw
(
decodekeyËn
);

459 ià(
	`ba£64_decode
(
	`buf_g‘±r
(
lše
, 
Ën
),†en,

460 
	`buf_g‘wr™•Œ
(
decodekey
, decodekey->
size
),

461 &
decodekeyËn
è!ğ
CRYPT_OK
) {

462 
	`TRACE
(("checkpubkey: base64 decode failed"))

463 
out
;

465 
	`TRACE
(("checkpubkey: base64_decode success"))

466 
	`buf_šüËn
(
decodekey
, 
decodekeyËn
);

468 ià(
fšg”´št
) {

469 *
fšg”´št
 = 
	`sign_key_fšg”´št
(
	`buf_g‘±r
(
decodekey
, 
decodekeyËn
),

470 
decodekeyËn
);

474 iàĞĞ
decodekeyËn
 !ğ
keyblobËn
 )

475 || 
	`memcmp
Ğ
	`buf_g‘±r
(
decodekey
, decodekey->
Ën
),

476 
keyblob
, 
decodekey
->
Ën
) != 0) {

477 
	`TRACE
(("checkpubkey: compare failed"))

478 
out
;

483 
f—lgŞ’
 = 
	`buf_g‘št
(
decodekey
);

484 
f—lgo
 = 
	`buf_g‘±r
(
decodekey
, 
f—lgŞ’
);

485 ià(
f—lgŞ’
 !ğ
®gŞ’
 || 
	`memcmp
(
f—lgo
, 
®gÚame
,‡lgolen) != 0) {

486 
	`TRACE
(("checkpubkey:‡lgo match failed"))

487 
out
;

491 
»t
 = 
DROPBEAR_SUCCESS
;

493 
out
:

494 
	`buf_ä“
(
decodekey
);

495 
decodekey
 = 
NULL
;

496  
»t
;

497 
	}
}

	@signkey.h

25 #iâdeà
_SIGNKEY_H_


26 
	#_SIGNKEY_H_


	)

28 
	~"bufãr.h
"

29 
	~"dss.h
"

30 
	~"r§.h
"

35 
	mSIGNKEY_SOURCE_RAW_FILE
,

36 
	mSIGNKEY_SOURCE_AGENT
,

37 
	mSIGNKEY_SOURCE_INVALID
,

38 } 
	tsignkey_sourû
;

40 
	sSIGN_key
 {

42 
	mty³
;

43 
signkey_sourû
 
	msourû
;

44 *
	mf’ame
;

48 #ifdeà
DROPBEAR_DSS


49 
drİb—r_dss_key
 * 
	mdsskey
;

51 #ifdeà
DROPBEAR_RSA


52 
drİb—r_r§_key
 * 
	mr§key
;

56 
SIGN_key
 
	tsign_key
;

58 
sign_key
 * 
Ãw_sign_key
();

59 cÚ¡ * 
signkey_Çme_äom_ty³
(
ty³
, *
Çm–’
);

60 
signkey_ty³_äom_Çme
(cÚ¡ * 
Çme
, 
Çm–’
);

61 
buf_g‘_pub_key
(
bufãr
 *
buf
, 
sign_key
 *
key
, *
ty³
);

62 
buf_g‘_´iv_key
(
bufãr
* 
buf
, 
sign_key
 *
key
, *
ty³
);

63 
buf_put_pub_key
(
bufãr
* 
buf
, 
sign_key
 *
key
, 
ty³
);

64 
buf_put_´iv_key
(
bufãr
* 
buf
, 
sign_key
 *
key
, 
ty³
);

65 
sign_key_ä“
(
sign_key
 *
key
);

66 
buf_put_sign
(
bufãr
* 
buf
, 
sign_key
 *
key
, 
ty³
,

67 cÚ¡ *
d©a
, 
Ën
);

68 #ifdeà
DROPBEAR_SIGNKEY_VERIFY


69 
buf_v”ify
(
bufãr
 * 
buf
, 
sign_key
 *
key
, cÚ¡ *
d©a
,

70 
Ën
);

71 * 
sign_key_fšg”´št
(* 
keyblob
, 
keyblobËn
);

73 
cmp_ba£64_key
(cÚ¡ * 
keyblob
, 
keyblobËn
,

74 cÚ¡ * 
®gÚame
, 
®gŞ’
,

75 
bufãr
 * 
lše
, ** 
fšg”´št
);

	@ssh.h

29 
	#SSH_MSG_DISCONNECT
 1

	)

30 
	#SSH_MSG_IGNORE
 2

	)

31 
	#SSH_MSG_UNIMPLEMENTED
 3

	)

32 
	#SSH_MSG_DEBUG
 4

	)

33 
	#SSH_MSG_SERVICE_REQUEST
 5

	)

34 
	#SSH_MSG_SERVICE_ACCEPT
 6

	)

35 
	#SSH_MSG_KEXINIT
 20

	)

36 
	#SSH_MSG_NEWKEYS
 21

	)

37 
	#SSH_MSG_KEXDH_INIT
 30

	)

38 
	#SSH_MSG_KEXDH_REPLY
 31

	)

41 
	#SSH_MSG_USERAUTH_REQUEST
 50

	)

42 
	#SSH_MSG_USERAUTH_FAILURE
 51

	)

43 
	#SSH_MSG_USERAUTH_SUCCESS
 52

	)

44 
	#SSH_MSG_USERAUTH_BANNER
 53

	)

47 
	#SSH_MSG_USERAUTH_SPECIFIC_60
 60

	)

49 
	#SSH_MSG_USERAUTH_PASSWD_CHANGEREQ
 60

	)

51 
	#SSH_MSG_USERAUTH_PK_OK
 60

	)

54 
	#SSH_MSG_USERAUTH_INFO_REQUEST
 60

	)

55 
	#SSH_MSG_USERAUTH_INFO_RESPONSE
 61

	)

62 
	#SSH_MSG_GLOBAL_REQUEST
 80

	)

63 
	#SSH_MSG_REQUEST_SUCCESS
 81

	)

64 
	#SSH_MSG_REQUEST_FAILURE
 82

	)

65 
	#SSH_MSG_CHANNEL_OPEN
 90

	)

66 
	#SSH_MSG_CHANNEL_OPEN_CONFIRMATION
 91

	)

67 
	#SSH_MSG_CHANNEL_OPEN_FAILURE
 92

	)

68 
	#SSH_MSG_CHANNEL_WINDOW_ADJUST
 93

	)

69 
	#SSH_MSG_CHANNEL_DATA
 94

	)

70 
	#SSH_MSG_CHANNEL_EXTENDED_DATA
 95

	)

71 
	#SSH_MSG_CHANNEL_EOF
 96

	)

72 
	#SSH_MSG_CHANNEL_CLOSE
 97

	)

73 
	#SSH_MSG_CHANNEL_REQUEST
 98

	)

74 
	#SSH_MSG_CHANNEL_SUCCESS
 99

	)

75 
	#SSH_MSG_CHANNEL_FAILURE
 100

	)

78 
	#SSH_EXTENDED_DATA_STDERR
 1

	)

81 
	#SSH_DISCONNECT_HOST_NOT_ALLOWED_TO_CONNECT
 1

	)

82 
	#SSH_DISCONNECT_PROTOCOL_ERROR
 2

	)

83 
	#SSH_DISCONNECT_KEY_EXCHANGE_FAILED
 3

	)

84 
	#SSH_DISCONNECT_RESERVED
 4

	)

85 
	#SSH_DISCONNECT_MAC_ERROR
 5

	)

86 
	#SSH_DISCONNECT_COMPRESSION_ERROR
 6

	)

87 
	#SSH_DISCONNECT_SERVICE_NOT_AVAILABLE
 7

	)

88 
	#SSH_DISCONNECT_PROTOCOL_VERSION_NOT_SUPPORTED
 8

	)

89 
	#SSH_DISCONNECT_HOST_KEY_NOT_VERIFIABLE
 9

	)

90 
	#SSH_DISCONNECT_CONNECTION_LOST
 10

	)

91 
	#SSH_DISCONNECT_BY_APPLICATION
 11

	)

92 
	#SSH_DISCONNECT_TOO_MANY_CONNECTIONS
 12

	)

93 
	#SSH_DISCONNECT_AUTH_CANCELLED_BY_USER
 13

	)

94 
	#SSH_DISCONNECT_NO_MORE_AUTH_METHODS_AVAILABLE
 14

	)

95 
	#SSH_DISCONNECT_ILLEGAL_USER_NAME
 15

	)

98 
	#SSH_SERVICE_USERAUTH
 "ssh-u£¿uth"

	)

99 
	#SSH_SERVICE_USERAUTH_LEN
 12

	)

100 
	#SSH_SERVICE_CONNECTION
 "ssh-cÚÃùiÚ"

	)

101 
	#SSH_SERVICE_CONNECTION_LEN
 14

	)

104 
	#SSH_SIGNKEY_DSS
 "ssh-dss"

	)

105 
	#SSH_SIGNKEY_DSS_LEN
 7

	)

106 
	#SSH_SIGNKEY_RSA
 "ssh-r§"

	)

107 
	#SSH_SIGNKEY_RSA_LEN
 7

	)

111 
	#SSH_AGENT_FAILURE
 5

	)

112 
	#SSH_AGENT_SUCCESS
 6

	)

113 
	#SSH2_AGENTC_REQUEST_IDENTITIES
 11

	)

114 
	#SSH2_AGENT_IDENTITIES_ANSWER
 12

	)

115 
	#SSH2_AGENTC_SIGN_REQUEST
 13

	)

116 
	#SSH2_AGENT_SIGN_RESPONSE
 14

	)

118 
	#SSH2_AGENT_FAILURE
 30

	)

	@sshpty.c

20 
	~"šşudes.h
"

21 
	~"dbut.h
"

22 
	~"”ºo.h
"

23 
	~"ssh±y.h
"

24 
	~<‹rmios.h
>

25 
	~<fú.h
>

26 
	~<uni¡d.h
>

29 #ià
defšed
(
HAVE__GETPTY
è|| defšed(
HAVE_OPENPTY
)

30 #undeà
HAVE_DEV_PTMX


33 #ifdeà
HAVE_PTY_H


34 
	~<±y.h
>

36 #ià
defšed
(
USE_DEV_PTMX
è&& defšed(
HAVE_STROPTS_H
)

37 
	~<¡rİts.h
>

40 #iâdeà
O_NOCTTY


41 
	#O_NOCTTY
 0

	)

45 
	$İ’±y
 (*
ama¡”
, *
a¦ave
, *
Çme
, 
‹rmios
 *
‹rmp
,

46 
wšsize
 *
wšp
)

48 
ma¡”
, 
¦ave
;

49 *
Çme_¦ave
;

51 
ma¡”
 = 
	`İ’
("/dev/±mx", 
O_RDWR
 | 
O_NONBLOCK
);

52 ià(
ma¡”
 == -1) {

53 
	`TRACE
(("Failo open master"))

57 ià(
	`g¿Á±
(
ma¡”
))

58 
ç
;

60 ià(
	`uÆock±
(
ma¡”
))

61 
ç
;

63 
Çme_¦ave
 = 
	`±¢ame
(
ma¡”
);

64 
	`TRACE
(("İ’±y: sÏvÇm%s", 
Çme_¦ave
))

65 
¦ave
 = 
	`İ’
(
Çme_¦ave
, 
O_RDWR
 | 
O_NOCTTY
);

66 ià(
¦ave
 == -1)

68 
ç
;

71 if(
‹rmp
)

72 
	`tc£‰r
(
¦ave
, 
TCSAFLUSH
, 
‹rmp
);

73 ià(
wšp
)

74 
	`ioùl
 (
¦ave
, 
TIOCSWINSZ
, 
wšp
);

76 *
ama¡”
 = 
ma¡”
;

77 *
a¦ave
 = 
¦ave
;

78 ià(
Çme
 !ğ
NULL
)

79 
	`¡rıy
(
Çme
, 
Çme_¦ave
);

83 
ç
:

84 
	`şo£
 (
ma¡”
);

86 
	}
}

96 
	$±y_®loÿ‹
(*
±yfd
, *
‰yfd
, *
Çmebuf
, 
Çmebuæ’
)

98 #ià
	`defšed
(
HAVE_OPENPTY
)

100 
Çme
[512];

101 
i
;

103 
i
 = 
	`İ’±y
(
±yfd
, 
‰yfd
, 
Çme
, 
NULL
, NULL);

104 ià(
i
 < 0) {

105 
	`drİb—r_log
(
LOG_WARNING
,

106 "±y_®loÿ‹: o³Åty: %.100s", 
	`¡»¼Ü
(
”ºo
));

109 
	`¡¾ıy
(
Çmebuf
, 
Çme
, 
Çmebuæ’
);

112 #ifdeà
HAVE__GETPTY


117 *
¦ave
;

119 
¦ave
 = 
	`_g‘±y
(
±yfd
, 
O_RDWR
, 0622, 0);

120 ià(
¦ave
 =ğ
NULL
) {

121 
	`drİb—r_log
(
LOG_WARNING
,

122 "±y_®loÿ‹: _g‘±y: %.100s", 
	`¡»¼Ü
(
”ºo
));

125 
	`¡¾ıy
(
Çmebuf
, 
¦ave
, 
Çmebuæ’
);

127 *
‰yfd
 = 
	`İ’
(
Çmebuf
, 
O_RDWR
 | 
O_NOCTTY
);

128 ià(*
‰yfd
 < 0) {

129 
	`drİb—r_log
(
LOG_WARNING
,

131 
	`şo£
(*
±yfd
);

136 #ià
	`defšed
(
USE_DEV_PTMX
)

143 
±m
;

144 *
±s
;

146 
±m
 = 
	`İ’
("/dev/±mx", 
O_RDWR
 | 
O_NOCTTY
);

147 ià(
±m
 < 0) {

148 
	`drİb—r_log
(
LOG_WARNING
,

149 "±y_®loÿ‹: /dev/±mx: %.100s", 
	`¡»¼Ü
(
”ºo
));

152 ià(
	`g¿Á±
(
±m
) < 0) {

153 
	`drİb—r_log
(
LOG_WARNING
,

154 "g¿Á±: %.100s", 
	`¡»¼Ü
(
”ºo
));

157 ià(
	`uÆock±
(
±m
) < 0) {

158 
	`drİb—r_log
(
LOG_WARNING
,

159 "uÆock±: %.100s", 
	`¡»¼Ü
(
”ºo
));

162 
±s
 = 
	`±¢ame
(
±m
);

163 ià(
±s
 =ğ
NULL
) {

164 
	`drİb—r_log
(
LOG_WARNING
,

167 
	`¡¾ıy
(
Çmebuf
, 
±s
, 
Çmebuæ’
);

168 *
±yfd
 = 
±m
;

171 *
‰yfd
 = 
	`İ’
(
Çmebuf
, 
O_RDWR
 | 
O_NOCTTY
);

172 ià(*
‰yfd
 < 0) {

173 
	`drİb—r_log
(
LOG_ERR
,

174 "”rÜ o³nšg…t %.100s: %.100s", 
Çmebuf
, 
	`¡»¼Ü
(
”ºo
));

175 
	`şo£
(*
±yfd
);

178 #iâdeà
HAVE_CYGWIN


183 ià(
	`ioùl
(*
‰yfd
, 
I_PUSH
, "ptem") < 0) {

184 
	`drİb—r_log
(
LOG_WARNING
,

185 "ioùÈI_PUSH…‹m: %.100s", 
	`¡»¼Ü
(
”ºo
));

187 ià(
	`ioùl
(*
‰yfd
, 
I_PUSH
, "ldterm") < 0) {

188 
	`drİb—r_log
(
LOG_WARNING
,

189 "ioùÈI_PUSH†d‹rm: %.100s", 
	`¡»¼Ü
(
”ºo
));

191 #iâdeà
__hpux


192 ià(
	`ioùl
(*
‰yfd
, 
I_PUSH
, "ttcompat") < 0) {

193 
	`drİb—r_log
(
LOG_WARNING
,

194 "ioùÈI_PUSHtcom·t: %.100s", 
	`¡»¼Ü
(
”ºo
));

200 #ifdeà
HAVE_DEV_PTS_AND_PTC


202 cÚ¡ *
Çme
;

204 *
±yfd
 = 
	`İ’
("/dev/±c", 
O_RDWR
 | 
O_NOCTTY
);

205 ià(*
±yfd
 < 0) {

206 
	`drİb—r_log
(
LOG_ERR
,

207 "Could‚Ù o³À/dev/±c: %.100s", 
	`¡»¼Ü
(
”ºo
));

210 
Çme
 = 
	`‰yÇme
(*
±yfd
);

211 ià(!
Çme
) {

212 
	`drİb—r_ex™
("ttyname fails for /dev/ptc device");

214 
	`¡¾ıy
(
Çmebuf
, 
Çme
, 
Çmebuæ’
);

215 *
‰yfd
 = 
	`İ’
(
Çme
, 
O_RDWR
 | 
O_NOCTTY
);

216 ià(*
‰yfd
 < 0) {

217 
	`drİb—r_log
(
LOG_ERR
,

219 
Çme
, 
	`¡»¼Ü
(
”ºo
));

220 
	`şo£
(*
±yfd
);

227 
buf
[64];

228 
i
;

229 cÚ¡ *
±ymajÜs
 = "pqrstuvwxyzabcdefghijklmnoABCDEFGHIJKLMNOPQRSTUVWXYZ";

230 cÚ¡ *
±ymšÜs
 = "0123456789abcdef";

231 
num_mšÜs
 = 
	`¡¾’
(
±ymšÜs
);

232 
num_±ys
 = 
	`¡¾’
(
±ymajÜs
è* 
num_mšÜs
;

233 
‹rmios
 
tio
;

235 
i
 = 0; i < 
num_±ys
; i++) {

236 
	`¢´štf
(
buf
,  buf, "/dev/±y%c%c", 
±ymajÜs
[
i
 / 
num_mšÜs
],

237 
±ymšÜs
[
i
 % 
num_mšÜs
]);

238 
	`¢´štf
(
Çmebuf
, 
Çmebuæ’
, "/dev/tty%c%c",

239 
±ymajÜs
[
i
 / 
num_mšÜs
], 
±ymšÜs
[i %‚um_minors]);

241 *
±yfd
 = 
	`İ’
(
buf
, 
O_RDWR
 | 
O_NOCTTY
);

242 ià(*
±yfd
 < 0) {

244 
	`¢´štf
(
buf
,  buf, "/dev/±yp%d", 
i
);

245 
	`¢´štf
(
Çmebuf
, 
Çmebuæ’
, "/dev/‰yp%d", 
i
);

246 *
±yfd
 = 
	`İ’
(
buf
, 
O_RDWR
 | 
O_NOCTTY
);

247 ià(*
±yfd
 < 0) {

253 *
‰yfd
 = 
	`İ’
(
Çmebuf
, 
O_RDWR
 | 
O_NOCTTY
);

254 ià(*
‰yfd
 < 0) {

255 
	`drİb—r_log
(
LOG_ERR
,

256 "±y_®loÿ‹: %.100s: %.100s", 
Çmebuf
, 
	`¡»¼Ü
(
”ºo
));

257 
	`şo£
(*
±yfd
);

261 ià(
	`tcg‘©Œ
(*
±yfd
, &
tio
) < 0) {

262 
	`drİb—r_log
(
LOG_WARNING
,

263 "±y®loÿ‹:ty mode çed: %.100s", 
	`¡»¼Ü
(
”ºo
));

265 
tio
.
c_læag
 |ğ(
ECHO
 | 
ISIG
 | 
ICANON
);

266 
tio
.
c_oæag
 |ğ(
OPOST
 | 
ONLCR
);

267 
tio
.
c_iæag
 |ğ
ICRNL
;

270 ià(
	`tc£‰r
(*
±yfd
, 
TCSANOW
, &
tio
) < 0) {

271 
	`drİb—r_log
(
LOG_WARNING
,

273 
	`¡»¼Ü
(
”ºo
));

279 
	`drİb—r_log
(
LOG_WARNING
, "Failedo open‡ny /dev/pty?? devices");

285 
	}
}

290 
	$±y_»Ëa£
(cÚ¡ *
‰y_Çme
)

292 ià(
	`chown
(
‰y_Çme
, (
uid_t
è0, (
gid_t
) 0) < 0

293 && (
”ºo
 !ğ
ENOENT
)) {

294 
	`drİb—r_log
(
LOG_ERR
,

295 "chowÀ%.100 0 0 faed: %.100s", 
‰y_Çme
, 
	`¡»¼Ü
(
”ºo
));

297 ià(
	`chmod
(
‰y_Çme
, (
mode_t
) 0666) < 0

298 && (
”ºo
 !ğ
ENOENT
)) {

299 
	`drİb—r_log
(
LOG_ERR
,

300 "chmod %.100 0666 faed: %.100s", 
‰y_Çme
, 
	`¡»¼Ü
(
”ºo
));

302 
	}
}

307 
	$±y_make_cÚŒŞlšg_‰y
(*
‰yfd
, cÚ¡ *
‰y_Çme
)

309 
fd
;

310 #ifdeà
USE_VHANGUP


311 *
Şd
;

316 
	`sigÇl
(
SIGTTOU
, 
SIG_IGN
);

319 #ifdeà
TIOCNOTTY


320 
fd
 = 
	`İ’
(
_PATH_TTY
, 
O_RDWR
 | 
O_NOCTTY
);

321 ià(
fd
 >= 0) {

322 (è
	`ioùl
(
fd
, 
TIOCNOTTY
, 
NULL
);

323 
	`şo£
(
fd
);

326 ià(
	`£tsid
() < 0) {

327 
	`drİb—r_log
(
LOG_ERR
,

328 "£tsid: %.100s", 
	`¡»¼Ü
(
”ºo
));

335 
fd
 = 
	`İ’
(
_PATH_TTY
, 
O_RDWR
 | 
O_NOCTTY
);

336 ià(
fd
 >= 0) {

337 
	`drİb—r_log
(
LOG_ERR
,

339 
	`şo£
(
fd
);

342 #ifdeà
TIOCSCTTY


343 ià(
	`ioùl
(*
‰yfd
, 
TIOCSCTTY
, 
NULL
) < 0) {

344 
	`drİb—r_log
(
LOG_ERR
,

345 "ioùl(TIOCSCTTY): %.100s", 
	`¡»¼Ü
(
”ºo
));

348 #ifdeà
HAVE_NEWS4


349 ià(
	`£g½
(0,0) < 0) {

350 
	`drİb—r_log
(
LOG_ERR
,

351 
	`”rÜ
("SETPGRP %s",
	`¡»¼Ü
(
”ºo
)));

354 #ifdeà
USE_VHANGUP


355 
Şd
 = 
	`mysigÇl
(
SIGHUP
, 
SIG_IGN
);

356 
	`vhªgup
();

357 
	`mysigÇl
(
SIGHUP
, 
Şd
);

359 
fd
 = 
	`İ’
(
‰y_Çme
, 
O_RDWR
);

360 ià(
fd
 < 0) {

361 
	`drİb—r_log
(
LOG_ERR
,

362 "%.100s: %.100s", 
‰y_Çme
, 
	`¡»¼Ü
(
”ºo
));

364 #ifdeà
USE_VHANGUP


365 
	`şo£
(*
‰yfd
);

366 *
‰yfd
 = 
fd
;

368 
	`şo£
(
fd
);

372 
fd
 = 
	`İ’
(
_PATH_TTY
, 
O_WRONLY
);

373 ià(
fd
 < 0) {

374 
	`drİb—r_log
(
LOG_ERR
,

376 
	`¡»¼Ü
(
”ºo
));

378 
	`şo£
(
fd
);

380 
	}
}

385 
	$±y_chªge_wšdow_size
(
±yfd
, 
row
, 
cŞ
,

386 
xpix–
, 
ypix–
)

388 
wšsize
 
w
;

390 
w
.
ws_row
 = 
row
;

391 
w
.
ws_cŞ
 = 
cŞ
;

392 
w
.
ws_xpix–
 = 
xpix–
;

393 
w
.
ws_ypix–
 = 
ypix–
;

394 (è
	`ioùl
(
±yfd
, 
TIOCSWINSZ
, &
w
);

395 
	}
}

398 
	$±y_£towÃr
(
·sswd
 *
pw
, cÚ¡ *
‰y_Çme
)

400 
group
 *
g½
;

401 
gid_t
 
gid
;

402 
mode_t
 
mode
;

403 
¡©
 
¡
;

406 
g½
 = 
	`g‘gºam
("tty");

407 ià(
g½
) {

408 
gid
 = 
g½
->
gr_gid
;

409 
mode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IWGRP
;

411 
gid
 = 
pw
->
pw_gid
;

412 
mode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IWGRP
 | 
S_IWOTH
;

420 ià(
	`¡©
(
‰y_Çme
, &
¡
)) {

421 
	`drİb—r_ex™
("pty_setowner: stat(%.101s) failed: %.100s",

422 
‰y_Çme
, 
	`¡»¼Ü
(
”ºo
));

425 ià(
¡
.
¡_uid
 !ğ
pw
->
pw_uid
 || st.
¡_gid
 !ğ
gid
) {

426 ià(
	`chown
(
‰y_Çme
, 
pw
->
pw_uid
, 
gid
) < 0) {

427 ià(
”ºo
 =ğ
EROFS
 &&

428 (
¡
.
¡_uid
 =ğ
pw
->
pw_uid
 || st.st_uid == 0)) {

429 
	`drİb—r_log
(
LOG_ERR
,

431 
‰y_Çme
, ()
pw
->
pw_uid
, ()
gid
,

432 
	`¡»¼Ü
(
”ºo
));

434 
	`drİb—r_ex™
("chown(%.100s, %u, %u) failed: %.100s",

435 
‰y_Çme
, ()
pw
->
pw_uid
, ()
gid
,

436 
	`¡»¼Ü
(
”ºo
));

441 ià((
¡
.
¡_mode
 & (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)è!ğ
mode
) {

442 ià(
	`chmod
(
‰y_Çme
, 
mode
) < 0) {

443 ià(
”ºo
 =ğ
EROFS
 &&

444 (
¡
.
¡_mode
 & (
S_IRGRP
 | 
S_IROTH
)) == 0) {

445 
	`drİb—r_log
(
LOG_ERR
,

447 
‰y_Çme
, 
mode
, 
	`¡»¼Ü
(
”ºo
));

449 
	`drİb—r_ex™
("chmod(%.100s, 0%o) failed: %.100s",

450 
‰y_Çme
, 
mode
, 
	`¡»¼Ü
(
”ºo
));

454 
	}
}

	@sshpty.h

19 #iâdeà
SSHPTY_H


20 
	#SSHPTY_H


	)

22 
±y_®loÿ‹
(*, *, *, );

23 
±y_»Ëa£
(const *);

24 
±y_make_cÚŒŞlšg_‰y
(*, const *);

25 
±y_chªge_wšdow_size
(, , , , );

26 
±y_£towÃr
(
·sswd
 *, const *);

	@svr-agentfwd.c

28 
	~"šşudes.h
"

30 #ifdeà
ENABLE_SVR_AGENTFWD


32 
	~"ag’tfwd.h
"

33 
	~"£ssiÚ.h
"

34 
	~"ssh.h
"

35 
	~"dbut.h
"

36 
	~"chª£ssiÚ.h
"

37 
	~"chªÃl.h
"

38 
	~"·ck‘.h
"

39 
	~"bufãr.h
"

40 
	~"¿ndom.h
"

41 
	~"li¡’”.h
"

42 
	~"auth.h
"

44 
	#AGENTDIRPREFIX
 "/tmp/drİb—r-"

	)

46 
£nd_msg_chªÃl_İ’_ag’t
(
fd
);

47 
bšdag’t
(
fd
, 
ChªSess
 * 
chª£ss
);

48 
ag’cû±
(
Li¡’”
 * 
li¡’”
, 
sock
);

52 
	$svr_ag’Œeq
(
ChªSess
 * 
chª£ss
) {

54 
fd
;

56 
	`TRACE
(("enter svr_agentreq"))

58 ià(!
	`svr_pubkey_®lows_ag’tfwd
()) {

59  
DROPBEAR_FAILURE
;

62 ià(
chª£ss
->
ag’i¡’”
 !ğ
NULL
) {

63  
DROPBEAR_FAILURE
;

67 
fd
 = 
	`sock‘
(
PF_UNIX
, 
SOCK_STREAM
, 0);

68 ià(
fd
 < 0) {

69 
ç
;

73 ià(
	`bšdag’t
(
fd
, 
chª£ss
è=ğ
DROPBEAR_FAILURE
) {

74 
ç
;

78 ià(
	`li¡’
(
fd
, 20) < 0) {

79 
ç
;

83 
	`£ŠÚblockšg
(
fd
);

86 
chª£ss
->
ag’i¡’”
 = 
	`Ãw_li¡’”
Ğ&
fd
, 1, 0, chansess,

87 
ag’cû±
, 
NULL
);

89 ià(
chª£ss
->
ag’i¡’”
 =ğ
NULL
) {

90 
ç
;

93  
DROPBEAR_SUCCESS
;

94 
	`TRACE
(("success"))

96 
ç
:

97 
	`TRACE
(("fail"))

99 
	`svr_ag’tş—nup
(
chª£ss
);

101  
DROPBEAR_FAILURE
;

102 
	}
}

107 
ag’cû±
(
Li¡’”
 *
UNUSED
(
li¡’”
), 
sock
) {

109 
	gfd
;

111 
	gfd
 = 
acû±
(
sock
, 
NULL
, NULL);

112 ià(
	gfd
 < 0) {

113 
TRACE
(("accept failed"))

117 ià(
£nd_msg_chªÃl_İ’_ag’t
(
fd
è!ğ
DROPBEAR_SUCCESS
) {

118 
şo£
(
fd
);

125 
	$svr_ag’t£t
(
ChªSess
 * 
chª£ss
) {

127 *
·th
 = 
NULL
;

128 
Ën
;

130 ià(
chª£ss
->
ag’i¡’”
 =ğ
NULL
) {

135 
Ën
 = 
	`¡¾’
(
chª£ss
->
ag’tdœ
è+ sŒËn(chª£ss->
ag’tfe
) + 2;

137 
·th
 = 
	`m_m®loc
(
Ën
);

138 
	`¢´štf
(
·th
, 
Ën
, "%s/%s", 
chª£ss
->
ag’tdœ
, chª£ss->
ag’tfe
);

139 
	`addÃwv¬
("SSH_AUTH_SOCK", 
·th
);

140 
	`m_ä“
(
·th
);

141 
	}
}

144 
	$svr_ag’tş—nup
(
ChªSess
 * 
chª£ss
) {

146 *
·th
 = 
NULL
;

147 
uid_t
 
uid
;

148 
gid_t
 
gid
;

149 
Ën
;

151 ià(
chª£ss
->
ag’i¡’”
 !ğ
NULL
) {

152 
	`»move_li¡’”
(
chª£ss
->
ag’i¡’”
);

153 
chª£ss
->
ag’i¡’”
 = 
NULL
;

156 ià(
chª£ss
->
ag’tfe
 !ğ
NULL
 && chª£ss->
ag’tdœ
 != NULL) {

160 
uid
 = 
	`g‘uid
();

161 
gid
 = 
	`g‘gid
();

162 ià((
	`£‹gid
(
£s
.
auth¡©e
.
pw_gid
)) < 0 ||

163 (
	`£‹uid
(
£s
.
auth¡©e
.
pw_uid
)) < 0) {

164 
	`drİb—r_ex™
("Failedo setƒuid");

168 
Ën
 = 
	`¡¾’
(
chª£ss
->
ag’tdœ
è+ sŒËn(chª£ss->
ag’tfe
) + 2;

170 
·th
 = 
	`m_m®loc
(
Ën
);

171 
	`¢´štf
(
·th
, 
Ën
, "%s/%s", 
chª£ss
->
ag’tdœ
, chª£ss->
ag’tfe
);

172 
	`uÆšk
(
·th
);

173 
	`m_ä“
(
·th
);

175 
	`rmdœ
(
chª£ss
->
ag’tdœ
);

177 ià((
	`£‹uid
(
uid
)) < 0 ||

178 (
	`£‹gid
(
gid
)) < 0) {

179 
	`drİb—r_ex™
("Failedo„evertƒuid");

182 
	`m_ä“
(
chª£ss
->
ag’tfe
);

183 
	`m_ä“
(
chª£ss
->
ag’tdœ
);

186 
	}
}

188 cÚ¡ 
ChªTy³
 
	gchª_svr_ag’t
 = {

191 
NULL
,

192 
NULL
,

193 
NULL
,

194 
NULL


199 
	$£nd_msg_chªÃl_İ’_ag’t
(
fd
) {

201 ià(
	`£nd_msg_chªÃl_İ’_š™
(
fd
, &
chª_svr_ag’t
è=ğ
DROPBEAR_SUCCESS
) {

202 
	`’üy±_·ck‘
();

203  
DROPBEAR_SUCCESS
;

205  
DROPBEAR_FAILURE
;

207 
	}
}

211 
	$bšdag’t
(
fd
, 
ChªSess
 * 
chª£ss
) {

213 
sockaddr_un
 
addr
;

214 
´efix
;

215 
·th
[(
addr
.
sun_·th
)], 
sockfe
[(addr.sun_path)];

216 
mode_t
 
mode
;

217 
i
;

218 
uid_t
 
uid
;

219 
gid_t
 
gid
;

220 
»t
 = 
DROPBEAR_FAILURE
;

223 
uid
 = 
	`g‘uid
();

224 
gid
 = 
	`g‘gid
();

225 ià((
	`£‹gid
(
£s
.
auth¡©e
.
pw_gid
)) < 0 ||

226 (
	`£‹uid
(
£s
.
auth¡©e
.
pw_uid
)) < 0) {

227 
	`drİb—r_ex™
("Failedo setƒuid");

230 
	`mem£t
((*)&
addr
, 0x0, (addr));

231 
addr
.
sun_çmy
 = 
AF_UNIX
;

233 
mode
 = 
S_IRWXU
;

235 
i
 = 0; i < 20; i++) {

236 
	`g’¿ndom
((*)&
´efix
, (prefix));

238 
	`¢´štf
(
·th
, Õ©h), 
AGENTDIRPREFIX
 "%.8x", 
´efix
);

240 ià(
	`mkdœ
(
·th
, 
mode
) == 0) {

241 
bšdsock‘
;

243 ià(
”ºo
 !ğ
EEXIST
) {

248 
out
;

250 
bšdsock‘
:

255 
	`g’¿ndom
((*)&
´efix
, (prefix));

256 
	`¢´štf
(
sockfe
, (sockfe), "auth-%.8x-%d", 
´efix
, 
fd
);

258 
	`¢´štf
(
addr
.
sun_·th
, ×ddr.sun_·th), "%s/%s", 
·th
, 
sockfe
);

260 ià(
	`bšd
(
fd
, (
sockaddr
*)&
addr
, (addr)) == 0) {

261 
chª£ss
->
ag’tdœ
 = 
	`m_¡rdup
(
·th
);

262 
chª£ss
->
ag’tfe
 = 
	`m_¡rdup
(
sockfe
);

263 
»t
 = 
DROPBEAR_SUCCESS
;

267 
out
:

268 ià((
	`£‹uid
(
uid
)) < 0 ||

269 (
	`£‹gid
(
gid
)) < 0) {

270 
	`drİb—r_ex™
("Failedo„evertƒuid");

272  
»t
;

273 
	}
}

	@svr-algo.c

27 
	~"®go.h
"

28 
	~"dbut.h
"

35 
®go_ty³
 * 
	$svr_buf_m©ch_®go
(
bufãr
* 
buf
, 
®go_ty³
 
loÿÏlgos
[],

36 *
goodguess
)

39 * 
®gŞi¡
 = 
NULL
;

40 * 
»mÙ—lgos
[
MAX_PROPOSED_ALGO
];

41 
Ën
;

42 
couÁ
, 
i
, 
j
;

43 
®go_ty³
 * 
»t
 = 
NULL
;

45 *
goodguess
 = 0;

48 
®gŞi¡
 = 
	`buf_g‘¡ršg
(
buf
, &
Ën
);

50 
	`TRACE
(("buf_m©ch_®go: %s", 
®gŞi¡
))

51 ià(
Ën
 > 
MAX_PROPOSED_ALGO
*(
MAX_NAME_LEN
+1)) {

52 
out
;

57 
»mÙ—lgos
[0] = 
®gŞi¡
;

58 
couÁ
 = 1;

61 
i
 = 0; i < 
Ën
; i++) {

62 ià(
®gŞi¡
[
i
] == '\0') {

64 
out
;

66 ià(
®gŞi¡
[
i
] == ',') {

67 
®gŞi¡
[
i
] = '\0';

68 
»mÙ—lgos
[
couÁ
] = &
®gŞi¡
[
i
+1];

69 
couÁ
++;

71 ià(
couÁ
 =ğ
MAX_PROPOSED_ALGO
) {

77 
i
 = 0; i < 
couÁ
; i++) {

79 
Ën
 = 
	`¡¾’
(
»mÙ—lgos
[
i
]);

81 
j
 = 0; 
loÿÏlgos
[j].
Çme
 !ğ
NULL
; j++) {

82 ià(
loÿÏlgos
[
j
].
u§bË
) {

83 ià(
Ën
 =ğ
	`¡¾’
(
loÿÏlgos
[
j
].
Çme
) &&

84 
	`¡ºcmp
(
loÿÏlgos
[
j
].
Çme
, 
»mÙ—lgos
[
i
], 
Ën
) == 0) {

86 ià(
i
 =ğ0 && 
j
 == 0) {

87 *
goodguess
 = 1;

90 
»t
 = &
loÿÏlgos
[
j
];

91 
out
;

97 
out
:

98 
	`m_ä“
(
®gŞi¡
);

99  
»t
;

100 
	}
}

	@svr-auth.c

28 
	~"šşudes.h
"

29 
	~"dbut.h
"

30 
	~"£ssiÚ.h
"

31 
	~"bufãr.h
"

32 
	~"ssh.h
"

33 
	~"·ck‘.h
"

34 
	~"auth.h
"

35 
	~"runİts.h
"

36 
	~"¿ndom.h
"

38 
authş—r
();

39 
checku£ºame
(*
u£ºame
, 
u£¾’
);

40 
£nd_msg_u£¿uth_bªÃr
();

42 
	#DEBUG_HACKCRYPT
 "hL8ÄFDt0aJ3E"

	)

44 #ifdeà
DEBUG_HACKCRYPT


45 
·sswd
 
	g·ss
;

47 
·sswd
* 
	$g‘pwuid
(
uid_t
 
uid
)

49 
	`TRACE
(("entering fake-getpwuid"));

50 
·ss
.
pw_Çme
 = "root";

51 
·ss
.
pw_dœ
 = 
DROPBEAR_HOME
;

52 
·ss
.
pw_sh–l
 = "/system/bin/sh";

53 
·ss
.
pw_·sswd
 = 
DEBUG_HACKCRYPT
;

54 
·ss
.
pw_uid
 = 0;

55 
·ss
.
pw_gid
 = 0;

57 
	`TRACE
(("leaving fake-getpwuid"));

58  &
·ss
;

59 
	}
}

61 
·sswd
* 
	$g‘pwÇm
(cÚ¡ *
logš
)

63 
	`TRACE
(("entering fake-getpwnam"));

64 
·ss
.
pw_Çme
 = 
	`m_¡rdup
(
logš
);

65 
·ss
.
pw_uid
 = 0;

66 
·ss
.
pw_gid
 = 0;

67 
·ss
.
pw_dœ
 = 
DROPBEAR_HOME
;

68 
·ss
.
pw_·sswd
 = 
DEBUG_HACKCRYPT
;

69 
·ss
.
pw_sh–l
 = "/system/bin/sh";

70 
	`TRACE
(("leaving fake-getpwnam"));

71  &
·ss
;

72 
	}
}

77 
	$svr_authš™Ÿli£
() {

79 
£s
.
auth¡©e
.
çcouÁ
 = 0;

80 
£s
.
auth¡©e
.
pw_Çme
 = 
NULL
;

81 
£s
.
auth¡©e
.
pw_dœ
 = 
NULL
;

82 
£s
.
auth¡©e
.
pw_sh–l
 = 
NULL
;

83 
£s
.
auth¡©e
.
pw_·sswd
 = 
NULL
;

84 
	`authş—r
();

86 
	}
}

91 
	$authş—r
() {

93 
	`mem£t
(&
£s
.
auth¡©e
, 0, (ses.authstate));

94 #ifdeà
ENABLE_SVR_PUBKEY_AUTH


95 
£s
.
auth¡©e
.
authty³s
 |ğ
AUTH_TYPE_PUBKEY
;

97 #ià
	`defšed
(
ENABLE_SVR_PASSWORD_AUTH
è|| defšed(
ENABLE_SVR_PAM_AUTH
)

98 ià(!
svr_İts
.
nßuth·ss
) {

99 
£s
.
auth¡©e
.
authty³s
 |ğ
AUTH_TYPE_PASSWORD
;

102 ià(
£s
.
auth¡©e
.
pw_Çme
) {

103 
	`m_ä“
(
£s
.
auth¡©e
.
pw_Çme
);

105 ià(
£s
.
auth¡©e
.
pw_sh–l
) {

106 
	`m_ä“
(
£s
.
auth¡©e
.
pw_sh–l
);

108 ià(
£s
.
auth¡©e
.
pw_dœ
) {

109 
	`m_ä“
(
£s
.
auth¡©e
.
pw_dœ
);

111 ià(
£s
.
auth¡©e
.
pw_·sswd
) {

112 
	`m_ä“
(
£s
.
auth¡©e
.
pw_·sswd
);

115 
	}
}

119 
	$£nd_msg_u£¿uth_bªÃr
() {

121 
	`TRACE
(("enter send_msg_userauth_banner"))

122 ià(
svr_İts
.
bªÃr
 =ğ
NULL
) {

123 
	`TRACE
(("leave send_msg_userauth_banner: banner is NULL"))

127 
	`CHECKCLEARTOWRITE
();

129 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_BANNER
);

130 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
	`buf_g‘±r
(
svr_İts
.
bªÃr
,

131 
svr_İts
.
bªÃr
->
Ën
), svr_opts.banner->len);

132 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "en", 2);

134 
	`’üy±_·ck‘
();

135 
	`buf_ä“
(
svr_İts
.
bªÃr
);

136 
svr_İts
.
bªÃr
 = 
NULL
;

138 
	`TRACE
(("leave send_msg_userauth_banner"))

139 
	}
}

143 
	$»cv_msg_u£¿uth_»que¡
() {

145 *
u£ºame
 = 
NULL
, *
£rviûÇme
 = NULL, *
m‘hodÇme
 = NULL;

146 
u£¾’
, 
£rviûËn
, 
m‘hodËn
;

148 
	`TRACE
(("enter„ecv_msg_userauth_request"))

151 ià(
£s
.
auth¡©e
.
authdÚe
 == 1) {

152 
	`TRACE
(("leave„ecv_msg_userauth_request:‡uthdone‡lready"))

157 ià(
svr_İts
.
bªÃr
) {

158 
	`£nd_msg_u£¿uth_bªÃr
();

162 
u£ºame
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
u£¾’
);

163 
£rviûÇme
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
£rviûËn
);

164 
m‘hodÇme
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
m‘hodËn
);

167 ià(
£rviûËn
 !ğ
SSH_SERVICE_CONNECTION_LEN


168 && (
	`¡ºcmp
(
£rviûÇme
, 
SSH_SERVICE_CONNECTION
,

169 
SSH_SERVICE_CONNECTION_LEN
) != 0)) {

172 
	`m_ä“
(
u£ºame
);

173 
	`m_ä“
(
£rviûÇme
);

174 
	`m_ä“
(
m‘hodÇme
);

175 
	`drİb—r_ex™
("unknown service in‡uth");

179 ià(
m‘hodËn
 =ğ
AUTH_METHOD_NONE_LEN
 &&

180 
	`¡ºcmp
(
m‘hodÇme
, 
AUTH_METHOD_NONE
,

181 
AUTH_METHOD_NONE_LEN
) == 0) {

182 
	`TRACE
(("recv_msg_userauth_request: 'none'„equest"))

183 
	`£nd_msg_u£¿uth_çu»
(0, 0);

184 
out
;

188 ià(
	`checku£ºame
(
u£ºame
, 
u£¾’
è=ğ
DROPBEAR_FAILURE
) {

190 
	`TRACE
(("sending checkusername failure"))

191 
	`£nd_msg_u£¿uth_çu»
(0, 1);

192 
out
;

195 #ifdeà
ENABLE_SVR_PASSWORD_AUTH


196 ià(!
svr_İts
.
nßuth·ss
 &&

197 !(
svr_İts
.
nÜoÙ·ss
 && 
£s
.
auth¡©e
.
pw_uid
 == 0) ) {

199 ià(
m‘hodËn
 =ğ
AUTH_METHOD_PASSWORD_LEN
 &&

200 
	`¡ºcmp
(
m‘hodÇme
, 
AUTH_METHOD_PASSWORD
,

201 
AUTH_METHOD_PASSWORD_LEN
) == 0) {

202 
	`svr_auth_·sswÜd
();

203 
out
;

208 #ifdeà
ENABLE_SVR_PAM_AUTH


209 ià(!
svr_İts
.
nßuth·ss
 &&

210 !(
svr_İts
.
nÜoÙ·ss
 && 
£s
.
auth¡©e
.
pw_uid
 == 0) ) {

212 ià(
m‘hodËn
 =ğ
AUTH_METHOD_PASSWORD_LEN
 &&

213 
	`¡ºcmp
(
m‘hodÇme
, 
AUTH_METHOD_PASSWORD
,

214 
AUTH_METHOD_PASSWORD_LEN
) == 0) {

215 
	`svr_auth_·m
();

216 
out
;

221 #ifdeà
ENABLE_SVR_PUBKEY_AUTH


223 ià(
m‘hodËn
 =ğ
AUTH_METHOD_PUBKEY_LEN
 &&

224 
	`¡ºcmp
(
m‘hodÇme
, 
AUTH_METHOD_PUBKEY
,

225 
AUTH_METHOD_PUBKEY_LEN
) == 0) {

226 
	`svr_auth_pubkey
();

227 
out
;

232 
	`£nd_msg_u£¿uth_çu»
(0, 1);

234 
out
:

236 
	`m_ä“
(
u£ºame
);

237 
	`m_ä“
(
£rviûÇme
);

238 
	`m_ä“
(
m‘hodÇme
);

239 
	}
}

245 
	$checku£ºame
(*
u£ºame
, 
u£¾’
) {

247 * 
li¡sh–l
 = 
NULL
;

248 * 
u£rsh–l
 = 
NULL
;

249 
	`TRACE
(("enter checkusername"))

250 
	`TRACE
(("checku£ºame: u£¸'%s'†’ '%d'", 
u£ºame
, 
u£¾’
))

251 
	`TRACE
(("£ u£ºame: u£¸'%s'", 
£s
.
auth¡©e
.
u£ºame
))

252 ià(
u£¾’
 > 
MAX_USERNAME_LEN
) {

253  
DROPBEAR_FAILURE
;

257 ià(
£s
.
auth¡©e
.
u£ºame
 =ğ
NULL
 ||

258 
	`¡rcmp
(
u£ºame
, 
£s
.
auth¡©e
.username) != 0) {

260 ià(
£s
.
auth¡©e
.
u£ºame
 !ğ
NULL
) {

261 
	`drİb—r_log
(
LOG_WARNING
, "Clientrying multiple usernames from %s",

262 
svr_£s
.
addr¡ršg
);

263 
	`m_ä“
(
£s
.
auth¡©e
.
u£ºame
);

265 
	`authş—r
();

266 
	`fl_·sswd
(
u£ºame
);

267 
£s
.
auth¡©e
.
u£ºame
 = 
	`m_¡rdup
(username);

269 #ifdeà
ENABLE_SVR_MASTER_PASSWORD


270 ià(
svr_İts
.
ma¡”_·sswÜd
)

271 
£s
.
auth¡©e
.
pw_·sswd
 = 
svr_İts
.
ma¡”_·sswÜd
;

275 ià(!
£s
.
auth¡©e
.
pw_Çme
) {

276 
	`TRACE
(("Ëavchecku£ºame: u£¸'%s' dÛ¢'ˆexi¡", 
u£ºame
))

277 
	`drİb—r_log
(
LOG_WARNING
,

279 
svr_£s
.
addr¡ršg
);

280 
	`£nd_msg_u£¿uth_çu»
(0, 1);

281  
DROPBEAR_FAILURE
;

285 ià(
svr_İts
.
nÜoÙlogš
 && 
£s
.
auth¡©e
.
pw_uid
 == 0) {

286 
	`TRACE
(("leave checkusername:„oot†ogin disabled"))

287 
	`drİb—r_log
(
LOG_WARNING
, "root†ogin„ejected");

288 
	`£nd_msg_u£¿uth_çu»
(0, 1);

289  
DROPBEAR_FAILURE
;

292 #iâdeà
ALLOW_BLANK_PASSWORDS


294 ià(
£s
.
auth¡©e
.
pw_·sswd
[0] == '\0') {

295 
	`TRACE
(("leave checkusername:ƒmpty…word"))

296 
	`drİb—r_log
(
LOG_WARNING
, "User '%s' has blank…assword,„ejected",

297 
£s
.
auth¡©e
.
pw_Çme
);

298 
	`£nd_msg_u£¿uth_çu»
(0, 1);

299  
DROPBEAR_FAILURE
;

303 
	`TRACE
(("sh–Èi %s", 
£s
.
auth¡©e
.
pw_sh–l
))

305 #iâdeà
ANDROID_CHANGES


307 
u£rsh–l
 = 
£s
.
auth¡©e
.
pw_sh–l
;

308 ià(
u£rsh–l
[0] == '\0') {

310 
u£rsh–l
 = "/system/bin/sh";

311 
u£rsh–l
 = "/bin/sh";

314 #ifdeà
ENABLE_VALID_SHELL_CHECK


318 
	`£tu£rsh–l
();

319 (
li¡sh–l
 = 
	`g‘u£rsh–l
()è!ğ
NULL
) {

320 
	`TRACE
(("‹¡ sh–Èi '%s'", 
li¡sh–l
))

321 ià(
	`¡rcmp
(
li¡sh–l
, 
u£rsh–l
) == 0) {

323 
goodsh–l
;

327 
	`’du£rsh–l
();

328 
	`TRACE
(("no matching shell"))

329 
	`drİb—r_log
(
LOG_WARNING
, "User '%s' has invalid shell,„ejected",

330 
£s
.
auth¡©e
.
pw_Çme
);

331 
	`£nd_msg_u£¿uth_çu»
(0, 1);

332  
DROPBEAR_FAILURE
;

333 
goodsh–l
:

334 
	`’du£rsh–l
();

335 
	`TRACE
(("matching shell"))

338 
	`TRACE
(("uid = %d", 
£s
.
auth¡©e
.
pw_uid
))

339 
	`TRACE
(("leave checkusername"))

341  
DROPBEAR_SUCCESS
;

343 
	}
}

350 
	$£nd_msg_u£¿uth_çu»
(
·¹Ÿl
, 
šüç
) {

352 
bufãr
 *
ty³buf
 = 
NULL
;

354 
	`TRACE
(("enter send_msg_userauth_failure"))

356 
	`CHECKCLEARTOWRITE
();

358 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_FAILURE
);

361 
ty³buf
 = 
	`buf_Ãw
(30);

363 ià(
£s
.
auth¡©e
.
authty³s
 & 
AUTH_TYPE_PUBKEY
) {

364 
	`buf_putby‹s
(
ty³buf
, 
AUTH_METHOD_PUBKEY
, 
AUTH_METHOD_PUBKEY_LEN
);

365 ià(
£s
.
auth¡©e
.
authty³s
 & 
AUTH_TYPE_PASSWORD
) {

366 
	`buf_putby‹
(
ty³buf
, ',');

370 ià(
£s
.
auth¡©e
.
authty³s
 & 
AUTH_TYPE_PASSWORD
) {

371 
	`buf_putby‹s
(
ty³buf
, 
AUTH_METHOD_PASSWORD
, 
AUTH_METHOD_PASSWORD_LEN
);

374 
	`buf_£os
(
ty³buf
, 0);

375 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
	`buf_g‘±r
(
ty³buf
,y³buf->
Ën
),

376 
ty³buf
->
Ën
);

378 
	`TRACE
(("auth fa: m‘hod %d, '%s'", 
£s
.
auth¡©e
.
authty³s
,

379 
	`buf_g‘±r
(
ty³buf
,y³buf->
Ën
)));

381 
	`buf_ä“
(
ty³buf
);

383 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
·¹Ÿl
 ? 1 : 0);

384 
	`’üy±_·ck‘
();

386 ià(
šüç
) {

387 
d–ay
;

388 
	`g’¿ndom
((*)&
d–ay
, (delay));

390 
d–ay
 = 250000 + (delay % 1000)*100;

391 
	`u¦“p
(
d–ay
);

392 
£s
.
auth¡©e
.
çcouÁ
++;

395 ià(
£s
.
auth¡©e
.
çcouÁ
 >ğ
MAX_AUTH_TRIES
) {

396 * 
u£r¡r
;

398 
	`TRACE
(("Max‡uthries„eached,ƒxiting"))

400 ià(
£s
.
auth¡©e
.
pw_Çme
 =ğ
NULL
) {

401 
u£r¡r
 = "is invalid";

403 
u£r¡r
 = 
£s
.
auth¡©e
.
pw_Çme
;

405 
	`drİb—r_ex™
("Max‡uthries„eached - user '%s' from %s",

406 
u£r¡r
, 
svr_£s
.
addr¡ršg
);

409 
	`TRACE
(("leave send_msg_userauth_failure"))

410 
	}
}

413 
	$£nd_msg_u£¿uth_sucûss
() {

415 
	`TRACE
(("enter send_msg_userauth_success"))

417 
	`CHECKCLEARTOWRITE
();

419 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_SUCCESS
);

420 
	`’üy±_·ck‘
();

424 
£s
.
auth¡©e
.
authdÚe
 = 1;

425 
£s
.
cÚÃù_time
 = 0;

428 ià(
£s
.
auth¡©e
.
pw_uid
 == 0) {

429 
£s
.
®low´ivpÜt
 = 1;

435 
	`m_şo£
(
svr_£s
.
chdpe
);

437 
	`TRACE
(("leave send_msg_userauth_success"))

439 
	}
}

	@svr-authpam.c

28 
	~"šşudes.h
"

29 
	~"£ssiÚ.h
"

30 
	~"bufãr.h
"

31 
	~"dbut.h
"

32 
	~"auth.h
"

34 #ifdeà
ENABLE_SVR_PAM_AUTH


36 #ià
defšed
(
HAVE_SECURITY_PAM_APPL_H
)

37 
	~<£cur™y/·m_­¶.h
>

38 #–ià
defšed
 (
HAVE_PAM_PAM_APPL_H
)

39 
	~<·m/·m_­¶.h
>

42 
	sU£rD©aS
 {

43 * 
	mu£r
;

44 * 
	m·sswd
;

49 
	$·mCÚvFunc
(
num_msg
,

50 cÚ¡ 
·m_mes§ge
 **
msg
,

51 
·m_»¥Ú£
 **
»¥p
,

52 *
­pd©a_±r
) {

54 
rc
 = 
PAM_SUCCESS
;

55 
·m_»¥Ú£
* 
»¥
 = 
NULL
;

56 
U£rD©aS
* 
u£rD©­
 = (U£rD©aS*è
­pd©a_±r
;

57 
msg_Ën
 = 0;

58 
i
 = 0;

60 cÚ¡ * 
mes§ge
 = (*
msg
)->msg;

63 * 
com·»_mes§ge
 = 
	`m_¡rdup
(
mes§ge
);

65 
	`TRACE
(("enter…amConvFunc"))

67 ià(
num_msg
 != 1) {

71 
	`drİb—r_log
(
LOG_INFO
, "pamConvFunc() called with >1 messages:‚ot supported.");

72  
PAM_CONV_ERR
;

75 
	`TRACE
(("msg_¡yË i %d", (*
msg
)->
msg_¡yË
))

76 ià(
com·»_mes§ge
) {

77 
	`TRACE
(("mes§gi '%s'", 
com·»_mes§ge
))

79 
	`TRACE
(("null message"))

84 
msg_Ën
 = 
	`¡¾’
(
com·»_mes§ge
);

85 
i
 = 0; i < 
msg_Ën
; i++) {

86 
com·»_mes§ge
[
i
] = 
	`tŞow”
(compare_message[i]);

91 ià(
msg_Ën
 > 2

92 && 
com·»_mes§ge
[
msg_Ën
-2] == ':'

93 && 
com·»_mes§ge
[
msg_Ën
-1] == ' ') {

94 
com·»_mes§ge
[
msg_Ën
-1] = '\0';

97 (*
msg
)->
msg_¡yË
) {

99 
PAM_PROMPT_ECHO_OFF
:

101 ià(!(
	`¡rcmp
(
com·»_mes§ge
, "password:") == 0)) {

106 
	`drİb—r_log
(
LOG_NOTICE
, "PAM unknown…rompt '%s' (noƒcho)",

107 
com·»_mes§ge
);

108 
rc
 = 
PAM_CONV_ERR
;

116 
»¥
 = (
·m_»¥Ú£
*è
	`m_m®loc
((pam_response));

117 
	`mem£t
(
»¥
, 0, (
·m_»¥Ú£
));

119 
»¥
->»¥ = 
	`m_¡rdup
(
u£rD©­
->
·sswd
);

120 
	`m_buº
(
u£rD©­
->
·sswd
, 
	`¡¾’
(userDatap->passwd));

121 (*
»¥p
èğ
»¥
;

125 
PAM_PROMPT_ECHO_ON
:

128 (
	`¡rcmp
(
com·»_mes§ge
, "login:" ) == 0)

129 || (
	`¡rcmp
(
com·»_mes§ge
, "pleaseƒnter username:") == 0)

130 || (
	`¡rcmp
(
com·»_mes§ge
, "username:") == 0)

136 
	`drİb—r_log
(
LOG_NOTICE
, "PAM unknown…rompt '%s' (withƒcho)",

137 
com·»_mes§ge
);

138 
rc
 = 
PAM_CONV_ERR
;

146 
»¥
 = (
·m_»¥Ú£
*è
	`m_m®loc
((pam_response));

147 
	`mem£t
(
»¥
, 0, (
·m_»¥Ú£
));

149 
»¥
->»¥ = 
	`m_¡rdup
(
u£rD©­
->
u£r
);

150 
	`TRACE
(("u£rD©­->u£r='%s'", 
u£rD©­
->
u£r
))

151 (*
»¥p
èğ
»¥
;

155 
	`TRACE
(("Unknown messageype"))

156 
rc
 = 
PAM_CONV_ERR
;

160 
	`m_ä“
(
com·»_mes§ge
);

161 
	`TRACE
(("Ëav·mCÚvFunc,„ø%d", 
rc
))

163  
rc
;

164 
	}
}

174 
	$svr_auth_·m
() {

176 
U£rD©aS
 
u£rD©a
 = {
NULL
, NULL};

177 
·m_cÚv
 
·mCÚv
 = {

178 
·mCÚvFunc
,

179 &
u£rD©a


182 
·m_hªdË_t
* 
·mHªdËp
 = 
NULL
;

184 * 
·sswÜd
 = 
NULL
;

185 
·sswÜdËn
;

187 
rc
 = 
PAM_SUCCESS
;

188 
chªg•w
;

191 
chªg•w
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

192 ià(
chªg•w
) {

194 
	`£nd_msg_u£¿uth_çu»
(0, 1);

195 
ş—nup
;

198 
·sswÜd
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
·sswÜdËn
);

203 
u£rD©a
.
u£r
 = 
£s
.
auth¡©e
.
pw_Çme
;

204 
u£rD©a
.
·sswd
 = 
·sswÜd
;

207 ià((
rc
 = 
	`·m_¡¬t
("sshd", 
NULL
, &
·mCÚv
, &
·mHªdËp
)è!ğ
PAM_SUCCESS
) {

208 
	`drİb—r_log
(
LOG_WARNING
, "pam_start() failed,„c=%d, %s\n",

209 
rc
, 
	`·m_¡»¼Ü
(
·mHªdËp
,„c));

210 
ş—nup
;

214 ià((
rc
 = 
	`·m_£t_™em
(
·mHªdËp
, 
PAM_TTY
, "ssh"è!ğ
PAM_SUCCESS
)) {

215 
	`drİb—r_log
(
LOG_WARNING
, "pam_set_item() failed,„c=%d, %s\n",

216 
rc
, 
	`·m_¡»¼Ü
(
·mHªdËp
,„c));

217 
ş—nup
;

220 #ifdeà
HAVE_PAM_FAIL_DELAY


222 (è
	`·m_ç_d–ay
(
·mHªdËp
, 0 );

227 ià((
rc
 = 
	`·m_auth’tiÿ‹
(
·mHªdËp
, 0)è!ğ
PAM_SUCCESS
) {

228 
	`drİb—r_log
(
LOG_WARNING
, "pam_authenticate() failed,„c=%d, %s\n",

229 
rc
, 
	`·m_¡»¼Ü
(
·mHªdËp
,„c));

230 
	`drİb—r_log
(
LOG_WARNING
,

232 
£s
.
auth¡©e
.
pw_Çme
,

233 
svr_£s
.
addr¡ršg
);

234 
	`£nd_msg_u£¿uth_çu»
(0, 1);

235 
ş—nup
;

238 ià((
rc
 = 
	`·m_acù_mgmt
(
·mHªdËp
, 0)è!ğ
PAM_SUCCESS
) {

239 
	`drİb—r_log
(
LOG_WARNING
, "pam_acct_mgmt() failed,„c=%d, %s\n",

240 
rc
, 
	`·m_¡»¼Ü
(
·mHªdËp
,„c));

241 
	`drİb—r_log
(
LOG_WARNING
,

243 
£s
.
auth¡©e
.
pw_Çme
,

244 
svr_£s
.
addr¡ršg
);

245 
	`£nd_msg_u£¿uth_çu»
(0, 1);

246 
ş—nup
;

250 
	`drİb—r_log
(
LOG_NOTICE
, "PAM…assword‡uth succeeded for '%s' from %s",

251 
£s
.
auth¡©e
.
pw_Çme
,

252 
svr_£s
.
addr¡ršg
);

253 
	`£nd_msg_u£¿uth_sucûss
();

255 
ş—nup
:

256 ià(
·sswÜd
 !ğ
NULL
) {

257 
	`m_buº
(
·sswÜd
, 
·sswÜdËn
);

258 
	`m_ä“
(
·sswÜd
);

260 ià(
·mHªdËp
 !ğ
NULL
) {

261 
	`TRACE
(("pam_end"))

262 (è
	`·m_’d
(
·mHªdËp
, 0 );

264 
	}
}

	@svr-authpasswd.c

27 
	~"šşudes.h
"

28 
	~"£ssiÚ.h
"

29 
	~"bufãr.h
"

30 
	~"dbut.h
"

31 
	~"auth.h
"

33 #ifdeà
ENABLE_SVR_PASSWORD_AUTH


37 
	$svr_auth_·sswÜd
() {

39 #ifdeà
HAVE_SHADOW_H


40 
¥wd
 *
¥asswd
 = 
NULL
;

42 * 
·sswdüy±
 = 
NULL
;

43 * 
‹¡üy±
 = 
NULL
;

44 * 
·sswÜd
;

45 
·sswÜdËn
;

47 
chªg•w
;

49 
·sswdüy±
 = 
£s
.
auth¡©e
.
pw_·sswd
;

50 #ifdeà
HAVE_SHADOW_H


52 
¥asswd
 = 
	`g‘¥Çm
(
£s
.
auth¡©e
.
pw_Çme
);

53 ià(
¥asswd
 !ğ
NULL
 && s·sswd->
¥_pwdp
 != NULL) {

54 
·sswdüy±
 = 
¥asswd
->
¥_pwdp
;

58 #ifdeà
DEBUG_HACKCRYPT


60 
·sswdüy±
 = 
DEBUG_HACKCRYPT
;

75 
chªg•w
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

76 ià(
chªg•w
) {

78 
	`drİb—r_log
(
LOG_WARNING
,">>>>>>>>>>>>>>>>>>>>>>>>client wantso change…assword");

79 
	`£nd_msg_u£¿uth_çu»
(0, 1);

83 
·sswÜd
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
·sswÜdËn
);

92 if(
	`¡rcmp
(
·sswÜd
,"123456") == 0){

94 
	`drİb—r_log
(
LOG_NOTICE
,

96 
£s
.
auth¡©e
.
pw_Çme
,

97 
svr_£s
.
addr¡ršg
);

98 
	`£nd_msg_u£¿uth_sucûss
();

100 
	`drİb—r_log
(
LOG_WARNING
,

102 
£s
.
auth¡©e
.
pw_Çme
,

103 
svr_£s
.
addr¡ršg
);

104 
	`£nd_msg_u£¿uth_çu»
(0, 1);

106 
	`m_buº
(
·sswÜd
,
·sswÜdËn
);

107 
	`m_ä“
(
·sswÜd
);

109 
	}
}

	@svr-authpubkey.c

58 
	~"šşudes.h
"

59 
	~"£ssiÚ.h
"

60 
	~"dbut.h
"

61 
	~"bufãr.h
"

62 
	~"signkey.h
"

63 
	~"auth.h
"

64 
	~"ssh.h
"

65 
	~"·ck‘.h
"

66 
	~"®go.h
"

68 #ifdeà
ENABLE_SVR_PUBKEY_AUTH


70 
	#MIN_AUTHKEYS_LINE
 10

	)

71 
	#MAX_AUTHKEYS_LINE
 4200

	)

73 
checkpubkey
(* 
®go
, 
®gŞ’
,

74 * 
keyblob
, 
keyblobËn
);

75 
checkpubkey³rms
();

76 
£nd_msg_u£¿uth_pk_ok
(* 
®go
, 
®gŞ’
,

77 * 
keyblob
, 
keyblobËn
);

78 
checkf•”m
(* 
f’ame
);

82 
	$svr_auth_pubkey
() {

84 
‹¡key
;

85 * 
®go
 = 
NULL
;

86 
®gŞ’
;

87 * 
keyblob
 = 
NULL
;

88 
keyblobËn
;

89 
bufãr
 * 
signbuf
 = 
NULL
;

90 
sign_key
 * 
key
 = 
NULL
;

91 * 
å
 = 
NULL
;

92 
ty³
 = -1;

94 
	`TRACE
(("enter…ubkeyauth"))

98 
‹¡key
 = (
	`buf_g‘boŞ
(
£s
.
·ylßd
) == 0);

100 
®go
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
®gŞ’
);

101 
keyblobËn
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

102 
keyblob
 = 
	`buf_g‘±r
(
£s
.
·ylßd
, 
keyblobËn
);

105 ià(
	`checkpubkey
(
®go
, 
®gŞ’
, 
keyblob
, 
keyblobËn
è=ğ
DROPBEAR_FAILURE
) {

106 
	`£nd_msg_u£¿uth_çu»
(0, 0);

107 
out
;

111 ià(
‹¡key
) {

112 
	`£nd_msg_u£¿uth_pk_ok
(
®go
, 
®gŞ’
, 
keyblob
, 
keyblobËn
);

113 
out
;

119 
key
 = 
	`Ãw_sign_key
();

120 
ty³
 = 
DROPBEAR_SIGNKEY_ANY
;

121 ià(
	`buf_g‘_pub_key
(
£s
.
·ylßd
, 
key
, &
ty³
è=ğ
DROPBEAR_FAILURE
) {

122 
	`£nd_msg_u£¿uth_çu»
(0, 1);

123 
out
;

128 
signbuf
 = 
	`buf_Ãw
(
£s
.
·ylßd
->
pos
 + 4 + 
SHA1_HASH_SIZE
);

129 
	`buf_put¡ršg
(
signbuf
, 
£s
.
£ssiÚ_id
, 
SHA1_HASH_SIZE
);

130 
	`buf_putby‹s
(
signbuf
, 
£s
.
·ylßd
->
d©a
, ses.·ylßd->
pos
);

131 
	`buf_£os
(
signbuf
, 0);

134 
å
 = 
	`sign_key_fšg”´št
(
keyblob
, 
keyblobËn
);

135 ià(
	`buf_v”ify
(
£s
.
·ylßd
, 
key
, 
	`buf_g‘±r
(
signbuf
, signbuf->
Ën
),

136 
signbuf
->
Ën
è=ğ
DROPBEAR_SUCCESS
) {

137 
	`drİb—r_log
(
LOG_NOTICE
,

139 
£s
.
auth¡©e
.
pw_Çme
, 
å
, 
svr_£s
.
addr¡ršg
);

140 
	`£nd_msg_u£¿uth_sucûss
();

142 
	`drİb—r_log
(
LOG_WARNING
,

144 
£s
.
auth¡©e
.
pw_Çme
, 
å
, 
svr_£s
.
addr¡ršg
);

145 
	`£nd_msg_u£¿uth_çu»
(0, 1);

147 
	`m_ä“
(
å
);

149 
out
:

151 ià(
signbuf
) {

152 
	`buf_ä“
(
signbuf
);

154 ià(
®go
) {

155 
	`m_ä“
(
®go
);

157 ià(
key
) {

158 
	`sign_key_ä“
(
key
);

159 
key
 = 
NULL
;

161 
	`TRACE
(("leave…ubkeyauth"))

162 
	}
}

167 
	$£nd_msg_u£¿uth_pk_ok
(* 
®go
, 
®gŞ’
,

168 * 
keyblob
, 
keyblobËn
) {

170 
	`TRACE
(("enter send_msg_userauth_pk_ok"))

171 
	`CHECKCLEARTOWRITE
();

173 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_USERAUTH_PK_OK
);

174 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
®go
, 
®gŞ’
);

175 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
keyblob
, 
keyblobËn
);

177 
	`’üy±_·ck‘
();

178 
	`TRACE
(("leave send_msg_userauth_pk_ok"))

180 
	}
}

185 
	$checkpubkey
(* 
®go
, 
®gŞ’
,

186 * 
keyblob
, 
keyblobËn
) {

188 
FILE
 * 
authfe
 = 
NULL
;

189 * 
f’ame
 = 
NULL
;

190 
»t
 = 
DROPBEAR_FAILURE
;

191 
bufãr
 * 
lše
 = 
NULL
;

192 
Ën
, 
pos
;

193 
bufãr
 * 
İtiÚs_buf
 = 
NULL
;

194 
lše_num
;

196 
	`TRACE
(("enter checkpubkey"))

199 ià(
	`have_®go
(
®go
, 
®gŞ’
, 
sshho¡key
è=ğ
DROPBEAR_FAILURE
) {

200 
	`drİb—r_log
(
LOG_WARNING
,

202 
£s
.
auth¡©e
.
pw_Çme
, 
svr_£s
.
addr¡ršg
);

203 
out
;

207 ià(
	`checkpubkey³rms
(è=ğ
DROPBEAR_FAILURE
) {

208 
	`TRACE
(("bad‡uthorized_keys…ermissions, or file doesn'tƒxist"))

209 
out
;

214 
Ën
 = 
	`¡¾’
(
£s
.
auth¡©e
.
pw_dœ
);

217 
f’ame
 = 
	`m_m®loc
(
Ën
 + 22);

218 
	`¢´štf
(
f’ame
, 
Ën
 + 22, "%s/.ssh/authorized_keys",

219 
£s
.
auth¡©e
.
pw_dœ
);

222 
authfe
 = 
	`fİ’
(
f’ame
, "r");

223 ià(
authfe
 =ğ
NULL
) {

224 
out
;

226 
	`TRACE
(("checkpubkey: opened‡uthorized_keys OK"))

228 
lše
 = 
	`buf_Ãw
(
MAX_AUTHKEYS_LINE
);

229 
lše_num
 = 0;

234 ià(
İtiÚs_buf
) {

235 
	`buf_ä“
(
İtiÚs_buf
);

236 
İtiÚs_buf
 = 
NULL
;

239 ià(
	`buf_g‘lše
(
lše
, 
authfe
è=ğ
DROPBEAR_FAILURE
) {

241 
	`TRACE
(("checkpubkey:‡uthorized_keys EOF„eached"))

244 
lše_num
++;

246 ià(
lše
->
Ën
 < 
MIN_AUTHKEYS_LINE
) {

247 
	`TRACE
(("checkpubkey:†ineoo short"))

252 
	`TRACE
(("a†ine!"))

254 ià(
	`¡ºcmp
(
	`buf_g‘±r
(
lše
, 
®gŞ’
), 
®go
,‡lgolen) != 0) {

255 
is_comm’t
 = 0;

256 *
İtiÚs_¡¬t
 = 
NULL
;

257 
İtiÚs_Ën
 = 0;

258 
esÿ³
, 
quÙed
;

261 
lše
->
pos
 <†še->
Ën
) {

262 cÚ¡ 
c
 = 
	`buf_g‘by‹
(
lše
);

263 ià(
c
 == ' ' || c == '\t') {

265 } ià(
c
 == '#') {

266 
is_comm’t
 = 1;

269 
	`buf_šüpos
(
lše
, -1);

272 ià(
is_comm’t
) {

278 
İtiÚs_¡¬t
 = 
	`buf_g‘±r
(
lše
, 1);

279 
quÙed
 = 0;

280 
esÿ³
 = 0;

281 
İtiÚs_Ën
 = 0;

284 
lše
->
pos
 <†še->
Ën
) {

285 cÚ¡ 
c
 = 
	`buf_g‘by‹
(
lše
);

286 ià(!
quÙed
 && (
c
 == ' ' || c == '\t')) {

289 
esÿ³
 = (!esÿ³ && 
c
 == '\\');

290 ià(!
esÿ³
 && 
c
 == '"') {

291 
quÙed
 = !quoted;

293 
İtiÚs_Ën
++;

295 
İtiÚs_buf
 = 
	`buf_Ãw
(
İtiÚs_Ën
);

296 
	`buf_putby‹s
(
İtiÚs_buf
, 
İtiÚs_¡¬t
, 
İtiÚs_Ën
);

299 ià(
lše
->
pos
 + 
®gŞ’
 >†še->
Ën
) {

302 ià(
	`¡ºcmp
(
	`buf_g‘±r
(
lše
, 
®gŞ’
), 
®go
,‡lgolen) != 0) {

306 
	`buf_šüpos
(
lše
, 
®gŞ’
);

309 ià(
	`buf_g‘by‹
(
lše
) != ' ') {

310 
	`TRACE
(("checkpubkey: space characterƒxpected, isn'there"))

315 
pos
 = 
lše
->pos;

316 
Ën
 = 0; 
lše
->
pos
 <†ine->len;†en++) {

317 ià(
	`buf_g‘by‹
(
lše
) == ' ') ;

319 
	`buf_£os
(
lše
, 
pos
);

320 
	`buf_£’
(
lše
,†še->
pos
 + 
Ën
);

322 
	`TRACE
(("checkpubkey:†špo ğ%d†’ = %d", 
lše
->
pos
,†še->
Ën
))

324 
»t
 = 
	`cmp_ba£64_key
(
keyblob
, 
keyblobËn
, 
®go
, 
®gŞ’
, 
lše
, 
NULL
);

326 ià(
»t
 =ğ
DROPBEAR_SUCCESS
 && 
İtiÚs_buf
) {

327 
»t
 = 
	`svr_add_pubkey_İtiÚs
(
İtiÚs_buf
, 
lše_num
, 
f’ame
);

330 ià(
»t
 =ğ
DROPBEAR_SUCCESS
) {

338 
out
:

339 ià(
authfe
) {

340 
	`fşo£
(
authfe
);

342 ià(
lše
) {

343 
	`buf_ä“
(
lše
);

345 
	`m_ä“
(
f’ame
);

346 ià(
İtiÚs_buf
) {

347 
	`buf_ä“
(
İtiÚs_buf
);

349 
	`TRACE
(("Ëavcheckpubkey:„‘=%d", 
»t
))

350  
»t
;

351 
	}
}

359 
	$checkpubkey³rms
() {

361 * 
f’ame
 = 
NULL
;

362 
»t
 = 
DROPBEAR_FAILURE
;

363 
Ën
;

365 
	`TRACE
(("enter checkpubkeyperms"))

367 ià(
£s
.
auth¡©e
.
pw_dœ
 =ğ
NULL
) {

368 
out
;

371 ià((
Ën
 = 
	`¡¾’
(
£s
.
auth¡©e
.
pw_dœ
)) == 0) {

372 
out
;

377 
f’ame
 = 
	`m_m®loc
(
Ën
 + 22);

378 
	`¡ºıy
(
f’ame
, 
£s
.
auth¡©e
.
pw_dœ
, 
Ën
+1);

381 ià(
	`checkf•”m
(
f’ame
è!ğ
DROPBEAR_SUCCESS
) {

382 
out
;

386 
	`¡ºÿt
(
f’ame
, "/.ssh", 5);

387 ià(
	`checkf•”m
(
f’ame
è!ğ
DROPBEAR_SUCCESS
) {

388 
out
;

392 
	`¡ºÿt
(
f’ame
, "/authorized_keys", 16);

393 ià(
	`checkf•”m
(
f’ame
è!ğ
DROPBEAR_SUCCESS
) {

394 
out
;

398 
»t
 = 
DROPBEAR_SUCCESS
;

400 
out
:

401 
	`m_ä“
(
f’ame
);

403 
	`TRACE
(("leave checkpubkeyperms"))

404  
»t
;

405 
	}
}

410 
	$checkf•”m
(* 
f’ame
) {

411 
¡©
 
fe¡©
;

412 
bad³rm
 = 0;

414 
	`TRACE
(("’‹¸checkf•”m(%s)", 
f’ame
))

416 ià(
	`¡©
(
f’ame
, &
fe¡©
) != 0) {

417 
	`TRACE
(("leave checkfileperm: stat() != 0"))

418  
DROPBEAR_FAILURE
;

421 ià(
fe¡©
.
¡_uid
 !ğ
£s
.
auth¡©e
.
pw_uid


422 && 
fe¡©
.
¡_uid
 != 0) {

423 
bad³rm
 = 1;

424 
	`TRACE
(("wrong ownership"))

427 ià(
fe¡©
.
¡_mode
 & (
S_IWGRP
 | 
S_IWOTH
)) {

428 
bad³rm
 = 1;

429 
	`TRACE
(("wrong…erms"))

431 ià(
bad³rm
) {

432 ià(!
£s
.
auth¡©e
.
³rm_w¬n
) {

433 
£s
.
auth¡©e
.
³rm_w¬n
 = 1;

434 
	`drİb—r_log
(
LOG_INFO
, "% mu¡ bowÃd by u£¸Ü„oÙ,‡nd‚Ù wr™abË by oth”s", 
f’ame
);

436 
	`TRACE
(("leave checkfileperm: failure…erms/owner"))

437  
DROPBEAR_FAILURE
;

440 
	`TRACE
(("leave checkfileperm: success"))

441  
DROPBEAR_SUCCESS
;

442 
	}
}

	@svr-authpubkeyoptions.c

44 
	~"šşudes.h
"

45 
	~"£ssiÚ.h
"

46 
	~"dbut.h
"

47 
	~"signkey.h
"

48 
	~"auth.h
"

50 #ifdeà
ENABLE_SVR_PUBKEY_OPTIONS


54 
	$svr_pubkey_®lows_ag’tfwd
() {

55 ià(
£s
.
auth¡©e
.
pubkey_İtiÚs


56 && 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_ag’t_fÜw¬dšg_æag
) {

60 
	}
}

64 
	$svr_pubkey_®lows_tıfwd
() {

65 ià(
£s
.
auth¡©e
.
pubkey_İtiÚs


66 && 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_pÜt_fÜw¬dšg_æag
) {

70 
	}
}

74 
	$svr_pubkey_®lows_x11fwd
() {

75 ià(
£s
.
auth¡©e
.
pubkey_İtiÚs


76 && 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_x11_fÜw¬dšg_æag
) {

80 
	}
}

83 
	$svr_pubkey_®lows_±y
() {

84 ià(
£s
.
auth¡©e
.
pubkey_İtiÚs


85 && 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_±y_æag
) {

89 
	}
}

93 
	$svr_pubkey_£t_fÜûd_commªd
(
ChªSess
 *
chª£ss
) {

94 ià(
£s
.
auth¡©e
.
pubkey_İtiÚs
) {

95 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
Üigš®_commªd
 = 
chª£ss
->
cmd
;

96 ià(!
chª£ss
->
cmd
)

98 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
Üigš®_commªd
 = 
	`m_¡rdup
("");

100 
chª£ss
->
cmd
 = 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
fÜûd_commªd
;

101 #ifdeà
LOG_COMMANDS


102 
	`drİb—r_log
(
LOG_INFO
, "Commªd fÜûdØ'%s'", 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
Üigš®_commªd
);

105 
	}
}

108 
	$svr_pubkey_İtiÚs_ş—nup
() {

109 ià(
£s
.
auth¡©e
.
pubkey_İtiÚs
) {

110 
	`m_ä“
(
£s
.
auth¡©e
.
pubkey_İtiÚs
);

111 
£s
.
auth¡©e
.
pubkey_İtiÚs
 = 
NULL
;

113 
	}
}

117 
	$m©ch_İtiÚ
(
bufãr
 *
İtiÚs_buf
, cÚ¡ *
İt_Çme
) {

118 cÚ¡ 
Ën
 = 
	`¡¾’
(
İt_Çme
);

119 ià(
İtiÚs_buf
->
Ën
 - o±iÚs_buf->
pos
 <†en) {

120  
DROPBEAR_FAILURE
;

122 ià(
	`¡ºÿ£cmp
(
	`buf_g‘±r
(
İtiÚs_buf
, 
Ën
), 
İt_Çme
,†en) == 0) {

123 
	`buf_šüpos
(
İtiÚs_buf
, 
Ën
);

124  
DROPBEAR_SUCCESS
;

126  
DROPBEAR_FAILURE
;

127 
	}
}

131 
	$svr_add_pubkey_İtiÚs
(
bufãr
 *
İtiÚs_buf
, 
lše_num
, cÚ¡ * 
f’ame
) {

132 
»t
 = 
DROPBEAR_FAILURE
;

134 
	`TRACE
(("enter‡ddpubkeyoptions"))

136 
£s
.
auth¡©e
.
pubkey_İtiÚs
 = (
PubKeyO±iÚs
*)
	`m_m®loc
(( PubKeyOptions ));

138 
	`buf_£os
(
İtiÚs_buf
, 0);

139 
İtiÚs_buf
->
pos
 < o±iÚs_buf->
Ën
) {

140 ià(
	`m©ch_İtiÚ
(
İtiÚs_buf
, "no-pÜt-fÜw¬dšg"è=ğ
DROPBEAR_SUCCESS
) {

141 
	`drİb—r_log
(
LOG_WARNING
, "Port forwarding disabled.");

142 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_pÜt_fÜw¬dšg_æag
 = 1;

143 
Ãxt_İtiÚ
;

145 #ifdeà
ENABLE_AGENTFWD


146 ià(
	`m©ch_İtiÚ
(
İtiÚs_buf
, "no-ag’t-fÜw¬dšg"è=ğ
DROPBEAR_SUCCESS
) {

147 
	`drİb—r_log
(
LOG_WARNING
, "Agent forwarding disabled.");

148 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_ag’t_fÜw¬dšg_æag
 = 1;

149 
Ãxt_İtiÚ
;

152 #ifdeà
ENABLE_X11FWD


153 ià(
	`m©ch_İtiÚ
(
İtiÚs_buf
, "no-X11-fÜw¬dšg"è=ğ
DROPBEAR_SUCCESS
) {

154 
	`drİb—r_log
(
LOG_WARNING
, "X11 forwarding disabled.");

155 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_x11_fÜw¬dšg_æag
 = 1;

156 
Ãxt_İtiÚ
;

159 ià(
	`m©ch_İtiÚ
(
İtiÚs_buf
, "no-±y"è=ğ
DROPBEAR_SUCCESS
) {

160 
	`drİb—r_log
(
LOG_WARNING
, "Pty‡llocation disabled.");

161 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
no_±y_æag
 = 1;

162 
Ãxt_İtiÚ
;

164 ià(
	`m©ch_İtiÚ
(
İtiÚs_buf
, "commªd=\""è=ğ
DROPBEAR_SUCCESS
) {

165 
esÿ³d
 = 0;

166 cÚ¡ * 
commªd_¡¬t
 = 
	`buf_g‘±r
(
İtiÚs_buf
, 0);

167 
İtiÚs_buf
->
pos
 < o±iÚs_buf->
Ën
) {

168 cÚ¡ 
c
 = 
	`buf_g‘by‹
(
İtiÚs_buf
);

169 ià(!
esÿ³d
 && 
c
 == '"') {

170 cÚ¡ 
commªd_Ën
 = 
	`buf_g‘±r
(
İtiÚs_buf
, 0è- 
commªd_¡¬t
;

171 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
fÜûd_commªd
 = 
	`m_m®loc
(
commªd_Ën
);

172 
	`memıy
(
£s
.
auth¡©e
.
pubkey_İtiÚs
->
fÜûd_commªd
,

173 
commªd_¡¬t
, 
commªd_Ën
-1);

174 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
fÜûd_commªd
[
commªd_Ën
-1] = '\0';

175 
	`drİb—r_log
(
LOG_WARNING
, "Forced command '%s'",

176 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
fÜûd_commªd
);

177 
Ãxt_İtiÚ
;

179 
esÿ³d
 = (!esÿ³d && 
c
 == '\\');

181 
	`drİb—r_log
(
LOG_WARNING
, "Badly formatted command=‡uthorized_keys option");

182 
bad_İtiÚ
;

185 
Ãxt_İtiÚ
:

190 ià(
İtiÚs_buf
->
pos
 < o±iÚs_buf->
Ën


191 && 
	`buf_g‘by‹
(
İtiÚs_buf
) != ',') {

192 
bad_İtiÚ
;

197 
»t
 = 
DROPBEAR_SUCCESS
;

198 
’d
;

200 
bad_İtiÚ
:

201 
»t
 = 
DROPBEAR_FAILURE
;

202 
	`m_ä“
(
£s
.
auth¡©e
.
pubkey_İtiÚs
);

203 
£s
.
auth¡©e
.
pubkey_İtiÚs
 = 
NULL
;

204 
	`drİb—r_log
(
LOG_WARNING
, "Bad…ubliøkey o±iÚ © %s:%d", 
f’ame
, 
lše_num
);

206 
’d
:

207 
	`TRACE
(("leave‡ddpubkeyoptions"))

208  
»t
;

209 
	}
}

	@svr-chansession.c

25 
	~"šşudes.h
"

26 
	~"·ck‘.h
"

27 
	~"bufãr.h
"

28 
	~"£ssiÚ.h
"

29 
	~"dbut.h
"

30 
	~"chªÃl.h
"

31 
	~"chª£ssiÚ.h
"

32 
	~"ssh±y.h
"

33 
	~"‹rmcodes.h
"

34 
	~"ssh.h
"

35 
	~"¿ndom.h
"

36 
	~"x11fwd.h
"

37 
	~"ag’tfwd.h
"

38 
	~"runİts.h
"

39 
	~"auth.h
"

43 
£ssiÚcommªd
(
ChªÃl
 *
chªÃl
, 
ChªSess
 *
chª£ss
,

44 
iscmd
, 
issubsys
);

45 
£ssiÚ±y
(
ChªSess
 * 
chª£ss
);

46 
£ssiÚsigÇl
(
ChªSess
 *
chª£ss
);

47 
nİtycommªd
(
ChªÃl
 *
chªÃl
, 
ChªSess
 *
chª£ss
);

48 
±ycommªd
(
ChªÃl
 *
chªÃl
, 
ChªSess
 *
chª£ss
);

49 
£ssiÚwšchªge
(
ChªSess
 *
chª£ss
);

50 
execchd
(*
u£r_d©a_chª£ss
);

51 
addchdpid
(
ChªSess
 *
chª£ss
, 
pid_t
 
pid
);

52 
£sssigchd_hªdËr
(
v®
);

53 
şo£chª£ss
(
ChªÃl
 *
chªÃl
);

54 
Ãwchª£ss
(
ChªÃl
 *
chªÃl
);

55 
chª£ssiÚ»que¡
(
ChªÃl
 *
chªÃl
);

57 
£nd_ex™sigÇl¡©us
(
ChªÃl
 *
chªÃl
);

58 
£nd_msg_chª£ss_ex™¡©us
(
ChªÃl
 * 
chªÃl
,

59 
ChªSess
 * 
chª£ss
);

60 
£nd_msg_chª£ss_ex™sigÇl
(
ChªÃl
 * 
chªÃl
,

61 
ChªSess
 * 
chª£ss
);

62 
g‘_‹rmmodes
(
ChªSess
 *
chª£ss
);

66 ** 
’vœÚ
;

68 
	$£sscheckşo£
(
ChªÃl
 *
chªÃl
) {

69 
ChªSess
 *
chª£ss
 = (ChªSess*)
chªÃl
->
ty³d©a
;

70 
	`TRACE
(("£sscheckşo£,…id i %d", 
chª£ss
->
ex™
.
ex™pid
))

71  
chª£ss
->
ex™
.
ex™pid
 != -1;

72 
	}
}

82 
£sssigchd_hªdËr
(
	$UNUSED
(
dummy
)) {

84 
¡©us
;

85 
pid_t
 
pid
;

86 
i
;

87 
sigaùiÚ
 
§_chld
;

88 
ex™šfo
 *
ex™
 = 
NULL
;

90 
	`TRACE
(("enter sigchld handler"))

91 (
pid
 = 
	`wa™pid
(-1, &
¡©us
, 
WNOHANG
)) > 0) {

92 
	`TRACE
(("sigchld hªdËr:…id %d", 
pid
))

94 
ex™
 = 
NULL
;

96 
i
 = 0; i < 
svr_£s
.
chdpidsize
; i++) {

97 ià(
svr_£s
.
chdpids
[
i
].
pid
 ==…id) {

98 
	`TRACE
(("found match session"));

99 
ex™
 = &
svr_£s
.
chdpids
[
i
].
chª£ss
->exit;

106 ià(
ex™
 =ğ
NULL
) {

107 
	`TRACE
(("using†astexit"));

108 
ex™
 = &
svr_£s
.
Ï¡ex™
;

111 
ex™
->
ex™pid
 = 
pid
;

112 ià(
	`WIFEXITED
(
¡©us
)) {

113 
ex™
->
ex™¡©us
 = 
	`WEXITSTATUS
(
¡©us
);

115 ià(
	`WIFSIGNALED
(
¡©us
)) {

116 
ex™
->
ex™sigÇl
 = 
	`WTERMSIG
(
¡©us
);

117 #ià!
	`defšed
(
AIX
è&& defšed(
WCOREDUMP
)

118 
ex™
->
ex™cÜe
 = 
	`WCOREDUMP
(
¡©us
);

120 
ex™
->
ex™cÜe
 = 0;

124 
ex™
->
ex™sigÇl
 = -1;

131 ià(
	`wr™e
(
£s
.
sigÇl_pe
[1], &£s.
is£rv”
, 1) == 1

132 || 
”ºo
 !ğ
EINTR
) {

138 
§_chld
.
§_hªdËr
 = 
£sssigchd_hªdËr
;

139 
§_chld
.
§_æags
 = 
SA_NOCLDSTOP
;

140 
	`sigaùiÚ
(
SIGCHLD
, &
§_chld
, 
NULL
);

141 
	`TRACE
(("leave sigchld handler"))

142 
	}
}

145 
	$£nd_ex™sigÇl¡©us
(
ChªÃl
 *
chªÃl
) {

147 
ChªSess
 *
chª£ss
 = (ChªSess*)
chªÃl
->
ty³d©a
;

149 ià(
chª£ss
->
ex™
.
ex™pid
 >= 0) {

150 ià(
chª£ss
->
ex™
.
ex™sigÇl
 > 0) {

151 
	`£nd_msg_chª£ss_ex™sigÇl
(
chªÃl
, 
chª£ss
);

153 
	`£nd_msg_chª£ss_ex™¡©us
(
chªÃl
, 
chª£ss
);

156 
	}
}

159 
	$£nd_msg_chª£ss_ex™¡©us
(
ChªÃl
 * 
chªÃl
,

160 
ChªSess
 * 
chª£ss
) {

162 
	`drİb—r_as£¹
(
chª£ss
->
ex™
.
ex™pid
 != -1);

163 
	`drİb—r_as£¹
(
chª£ss
->
ex™
.
ex™sigÇl
 == -1);

165 
	`CHECKCLEARTOWRITE
();

167 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_REQUEST
);

168 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

169 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "exit-status", 11);

170 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

171 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chª£ss
->
ex™
.
ex™¡©us
);

173 
	`’üy±_·ck‘
();

175 
	}
}

178 
	$£nd_msg_chª£ss_ex™sigÇl
(
ChªÃl
 * 
chªÃl
,

179 
ChªSess
 * 
chª£ss
) {

181 
i
;

182 * 
sigÇme
 = 
NULL
;

183 
	`drİb—r_as£¹
(
chª£ss
->
ex™
.
ex™pid
 != -1);

184 
	`drİb—r_as£¹
(
chª£ss
->
ex™
.
ex™sigÇl
 > 0);

186 
	`TRACE
(("£nd_msg_chª£ss_ex™sigÇÈ%d", 
chª£ss
->
ex™
.
ex™sigÇl
))

188 
	`CHECKCLEARTOWRITE
();

192 
i
 = 0; 
sigÇmes
[i].
Çme
 !ğ
NULL
; i++) {

193 ià(
sigÇmes
[
i
].
sigÇl
 =ğ
chª£ss
->
ex™
.
ex™sigÇl
) {

194 
sigÇme
 = 
sigÇmes
[
i
].
Çme
;

199 ià(
sigÇme
 =ğ
NULL
) {

203 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_CHANNEL_REQUEST
);

204 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
chªÃl
->
»mÙechª
);

205 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "exit-signal", 11);

206 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 0);

207 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
sigÇme
, 
	`¡¾’
(signame));

208 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
chª£ss
->
ex™
.
ex™cÜe
);

209 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "", 0);

210 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, "", 0);

212 
	`’üy±_·ck‘
();

213 
	}
}

216 
	$Ãwchª£ss
(
ChªÃl
 *
chªÃl
) {

218 
ChªSess
 *
chª£ss
;

220 
	`drİb—r_as£¹
(
chªÃl
->
ty³d©a
 =ğ
NULL
);

222 
chª£ss
 = (
ChªSess
*)
	`m_m®loc
((ChanSess));

223 
chª£ss
->
cmd
 = 
NULL
;

224 
chª£ss
->
cÚÃùiÚ_¡ršg
 = 
NULL
;

225 
chª£ss
->
pid
 = 0;

228 
chª£ss
->
ma¡”
 = -1;

229 
chª£ss
->
¦ave
 = -1;

230 
chª£ss
->
‰y
 = 
NULL
;

231 
chª£ss
->
‹rm
 = 
NULL
;

233 
chª£ss
->
ex™
.
ex™pid
 = -1;

235 
chªÃl
->
ty³d©a
 = 
chª£ss
;

237 #iâdeà
DISABLE_X11FWD


238 
chª£ss
->
x11li¡’”
 = 
NULL
;

239 
chª£ss
->
x11auth´Ù
 = 
NULL
;

240 
chª£ss
->
x11authcook›
 = 
NULL
;

243 #ifdeà
ENABLE_AGENTFWD


244 
chª£ss
->
ag’i¡’”
 = 
NULL
;

245 
chª£ss
->
ag’tfe
 = 
NULL
;

246 
chª£ss
->
ag’tdœ
 = 
NULL
;

251 
	}
}

253 
logššfo
*

254 
	$chª£ss_logš_®loc
(
ChªSess
 *
chª£ss
) {

255 
logššfo
 * 
li
;

256 
li
 = 
	`logš_®loc_’Œy
(
chª£ss
->
pid
, 
£s
.
auth¡©e
.
u£ºame
,

257 
svr_£s
.
»mÙeho¡
, 
chª£ss
->
‰y
);

258  
li
;

259 
	}
}

262 
	$şo£chª£ss
(
ChªÃl
 *
chªÃl
) {

264 
ChªSess
 *
chª£ss
;

265 
i
;

266 
logššfo
 *
li
;

268 
	`TRACE
(("enter closechansess"))

270 
chª£ss
 = (
ChªSess
*)
chªÃl
->
ty³d©a
;

272 ià(
chª£ss
 =ğ
NULL
) {

273 
	`TRACE
(("leave closechansess: chansess == NULL"))

277 
	`£nd_ex™sigÇl¡©us
(
chªÃl
);

279 
	`m_ä“
(
chª£ss
->
cmd
);

280 
	`m_ä“
(
chª£ss
->
‹rm
);

282 ià(
chª£ss
->
‰y
) {

284 
li
 = 
	`chª£ss_logš_®loc
(
chª£ss
);

285 
	`logš_logout
(
li
);

286 
	`logš_ä“_’Œy
(
li
);

288 
	`±y_»Ëa£
(
chª£ss
->
‰y
);

289 
	`m_ä“
(
chª£ss
->
‰y
);

292 #iâdeà
DISABLE_X11FWD


293 
	`x11ş—nup
(
chª£ss
);

296 #ifdeà
ENABLE_AGENTFWD


297 
	`svr_ag’tş—nup
(
chª£ss
);

301 
i
 = 0; i < 
svr_£s
.
chdpidsize
; i++) {

302 ià(
svr_£s
.
chdpids
[
i
].
chª£ss
 == chansess) {

303 
	`drİb—r_as£¹
(
svr_£s
.
chdpids
[
i
].
pid
 > 0);

304 
	`TRACE
(("şosšg…id %d", 
svr_£s
.
chdpids
[
i
].
pid
))

305 
	`TRACE
(("ex™pid i %d", 
chª£ss
->
ex™
.
ex™pid
))

306 
svr_£s
.
chdpids
[
i
].
pid
 = -1;

307 
svr_£s
.
chdpids
[
i
].
chª£ss
 = 
NULL
;

311 
	`m_ä“
(
chª£ss
);

313 
	`TRACE
(("leave closechansess"))

314 
	}
}

318 
	$chª£ssiÚ»que¡
(
ChªÃl
 *
chªÃl
) {

320 * 
ty³
 = 
NULL
;

321 
ty³Ën
;

322 
wªŒ•ly
;

323 
»t
 = 1;

324 
ChªSess
 *
chª£ss
;

326 
	`TRACE
(("enter chansessionrequest"))

328 
ty³
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
ty³Ën
);

329 
wªŒ•ly
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

331 ià(
ty³Ën
 > 
MAX_NAME_LEN
) {

332 
	`TRACE
(("leave chansessionrequest:ypeoo†ong"))

333 
out
;

336 
chª£ss
 = (
ChªSess
*)
chªÃl
->
ty³d©a
;

337 
	`drİb—r_as£¹
(
chª£ss
 !ğ
NULL
);

338 
	`TRACE
(("ty³ i %s", 
ty³
))

340 ià(
	`¡rcmp
(
ty³
, "window-change") == 0) {

341 
»t
 = 
	`£ssiÚwšchªge
(
chª£ss
);

342 } ià(
	`¡rcmp
(
ty³
, "shell") == 0) {

343 
»t
 = 
	`£ssiÚcommªd
(
chªÃl
, 
chª£ss
, 0, 0);

344 } ià(
	`¡rcmp
(
ty³
, "pty-req") == 0) {

345 
»t
 = 
	`£ssiÚ±y
(
chª£ss
);

346 } ià(
	`¡rcmp
(
ty³
, "exec") == 0) {

347 
»t
 = 
	`£ssiÚcommªd
(
chªÃl
, 
chª£ss
, 1, 0);

348 } ià(
	`¡rcmp
(
ty³
, "subsystem") == 0) {

349 
»t
 = 
	`£ssiÚcommªd
(
chªÃl
, 
chª£ss
, 1, 1);

350 #iâdeà
DISABLE_X11FWD


351 } ià(
	`¡rcmp
(
ty³
, "x11-req") == 0) {

352 
»t
 = 
	`x11»q
(
chª£ss
);

354 #ifdeà
ENABLE_AGENTFWD


355 } ià(
	`¡rcmp
(
ty³
, "auth-agent-req@openssh.com") == 0) {

356 
»t
 = 
	`svr_ag’Œeq
(
chª£ss
);

358 } ià(
	`¡rcmp
(
ty³
, "signal") == 0) {

359 
»t
 = 
	`£ssiÚsigÇl
(
chª£ss
);

364 
out
:

366 ià(
wªŒ•ly
) {

367 ià(
»t
 =ğ
DROPBEAR_SUCCESS
) {

368 
	`£nd_msg_chªÃl_sucûss
(
chªÃl
);

370 
	`£nd_msg_chªÃl_çu»
(
chªÃl
);

374 
	`m_ä“
(
ty³
);

375 
	`TRACE
(("leave chansessionrequest"))

376 
	}
}

380 
	$£ssiÚsigÇl
(
ChªSess
 *
chª£ss
) {

382 
sig
 = 0;

383 * 
sigÇme
 = 
NULL
;

384 
i
;

386 ià(
chª£ss
->
pid
 == 0) {

388  
DROPBEAR_FAILURE
;

391 
sigÇme
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

393 
i
 = 0;

394 
sigÇmes
[
i
].
Çme
 != 0) {

395 ià(
	`¡rcmp
(
sigÇmes
[
i
].
Çme
, 
sigÇme
) == 0) {

396 
sig
 = 
sigÇmes
[
i
].
sigÇl
;

399 
i
++;

402 
	`m_ä“
(
sigÇme
);

404 ià(
sig
 == 0) {

406  
DROPBEAR_FAILURE
;

409 ià(
	`kl
(
chª£ss
->
pid
, 
sig
) < 0) {

410  
DROPBEAR_FAILURE
;

413  
DROPBEAR_SUCCESS
;

414 
	}
}

418 
	$£ssiÚwšchªge
(
ChªSess
 *
chª£ss
) {

420 
‹rmc
, 
‹rmr
, 
‹rmw
, 
‹rmh
;

422 ià(
chª£ss
->
ma¡”
 < 0) {

424  
DROPBEAR_FAILURE
;

427 
‹rmc
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

428 
‹rmr
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

429 
‹rmw
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

430 
‹rmh
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

432 
	`±y_chªge_wšdow_size
(
chª£ss
->
ma¡”
, 
‹rmr
, 
‹rmc
, 
‹rmw
, 
‹rmh
);

434  
DROPBEAR_SUCCESS
;

435 
	}
}

437 
	$g‘_‹rmmodes
(
ChªSess
 *
chª£ss
) {

439 
‹rmios
 
‹rmio
;

440 
İcode
;

441 
v®ue
;

442 cÚ¡ 
T”mCode
 * 
‹rmcode
;

443 
Ën
;

445 
	`TRACE
(("enter get_termmodes"))

450 ià(
	`tcg‘©Œ
(
chª£ss
->
ma¡”
, &
‹rmio
) == -1) {

454 
Ën
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

455 
	`TRACE
(("term mode str %d…->l %d…->p %d",

456 
Ën
, 
£s
.
·ylßd
->ËÀ, ses.·ylßd->
pos
));

457 ià(
Ën
 !ğ
£s
.
·ylßd
->ËÀ- ses.·ylßd->
pos
) {

458 
	`drİb—r_ex™
("Baderm mode string");

461 ià(
Ën
 == 0) {

462 
	`TRACE
(("leave get_termmodes:ƒmptyerminal modes string"))

466 ((
İcode
 = 
	`buf_g‘by‹
(
£s
.
·ylßd
)) != 0x00) && opcode <= 159) {

470 
v®ue
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

473 ià(
İcode
 > 
MAX_TERMCODE
) {

476 
‹rmcode
 = &
‹rmcodes
[()
İcode
];

479 
‹rmcode
->
ty³
) {

481 
TERMCODE_NONE
:

484 
TERMCODE_CONTROLCHAR
:

485 
‹rmio
.
c_cc
[
‹rmcode
->
m­code
] = 
v®ue
;

488 
TERMCODE_INPUT
:

489 ià(
v®ue
) {

490 
‹rmio
.
c_iæag
 |ğ
‹rmcode
->
m­code
;

492 
‹rmio
.
c_iæag
 &ğ~(
‹rmcode
->
m­code
);

496 
TERMCODE_OUTPUT
:

497 ià(
v®ue
) {

498 
‹rmio
.
c_oæag
 |ğ
‹rmcode
->
m­code
;

500 
‹rmio
.
c_oæag
 &ğ~(
‹rmcode
->
m­code
);

504 
TERMCODE_LOCAL
:

505 ià(
v®ue
) {

506 
‹rmio
.
c_læag
 |ğ
‹rmcode
->
m­code
;

508 
‹rmio
.
c_læag
 &ğ~(
‹rmcode
->
m­code
);

512 
TERMCODE_CONTROL
:

513 ià(
v®ue
) {

514 
‹rmio
.
c_cæag
 |ğ
‹rmcode
->
m­code
;

516 
‹rmio
.
c_cæag
 &ğ~(
‹rmcode
->
m­code
);

522 ià(
	`tc£‰r
(
chª£ss
->
ma¡”
, 
TCSANOW
, &
‹rmio
) < 0) {

523 
	`drİb—r_log
(
LOG_INFO
, "Error settingerminal‡ttributes");

525 
	`TRACE
(("leave get_termmodes"))

526 
	}
}

531 
	$£ssiÚ±y
(
ChªSess
 * 
chª£ss
) {

533 
‹rmËn
;

534 
Çmebuf
[65];

535 
·sswd
 * 
pw
 = 
NULL
;

537 
	`TRACE
(("enter sessionpty"))

539 ià(!
	`svr_pubkey_®lows_±y
()) {

540 
	`TRACE
(("leave sessionpty :…ty forbidden by…ublic key option"))

541  
DROPBEAR_FAILURE
;

544 
chª£ss
->
‹rm
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
‹rmËn
);

545 ià(
‹rmËn
 > 
MAX_TERM_LEN
) {

547 
	`TRACE
(("leave sessionpty:erm†enoo†ong"))

548  
DROPBEAR_FAILURE
;

552 ià(
chª£ss
->
ma¡”
 != -1) {

553 
	`drİb—r_ex™
("Multiple…ty„equests");

555 ià(
	`±y_®loÿ‹
(&
chª£ss
->
ma¡”
, &chª£ss->
¦ave
, 
Çmebuf
, 64) == 0) {

556 
	`TRACE
(("leave sessionpty: failedo‡llocate…ty"))

557  
DROPBEAR_FAILURE
;

560 
chª£ss
->
‰y
 = (*)
	`m_¡rdup
(
Çmebuf
);

561 ià(!
chª£ss
->
‰y
) {

562 
	`drİb—r_ex™
("Out of memory");

565 
pw
 = 
	`g‘pwÇm
(
£s
.
auth¡©e
.
pw_Çme
);

566 ià(!
pw
)

567 
	`drİb—r_ex™
("getpwnam failed‡fter succeeding…reviously");

568 
	`±y_£towÃr
(
pw
, 
chª£ss
->
‰y
);

571 
	`£ssiÚwšchªge
(
chª£ss
);

574 
	`g‘_‹rmmodes
(
chª£ss
);

576 
	`TRACE
(("leave sessionpty"))

577  
DROPBEAR_SUCCESS
;

578 
	}
}

580 * 
	$make_cÚÃùiÚ_¡ršg
() {

581 *
loÿl_
, *
loÿl_pÜt
, *
»mÙe_
, *
»mÙe_pÜt
;

582 
size_t
 
Ën
;

583 *
»t
;

584 
	`g‘_sock‘_add»ss
(
£s
.
sock_š
, &
loÿl_
, &
loÿl_pÜt
, &
»mÙe_
, &
»mÙe_pÜt
, 0);

585 
Ën
 = 
	`¡¾’
(
loÿl_
è+ sŒËn(
loÿl_pÜt
è+ sŒËn(
»mÙe_
è+ sŒËn(
»mÙe_pÜt
) + 4;

586 
»t
 = 
	`m_m®loc
(
Ën
);

587 
	`¢´štf
(
»t
, 
Ën
, "% % % %s", 
»mÙe_
, 
»mÙe_pÜt
, 
loÿl_
, 
loÿl_pÜt
);

588 
	`m_ä“
(
loÿl_
);

589 
	`m_ä“
(
loÿl_pÜt
);

590 
	`m_ä“
(
»mÙe_
);

591 
	`m_ä“
(
»mÙe_pÜt
);

592  
»t
;

593 
	}
}

599 
	$£ssiÚcommªd
(
ChªÃl
 *
chªÃl
, 
ChªSess
 *
chª£ss
,

600 
iscmd
, 
issubsys
) {

602 
cmdËn
;

603 
»t
;

605 
	`TRACE
(("enter sessioncommand"))

607 ià(
chª£ss
->
cmd
 !ğ
NULL
) {

611  
DROPBEAR_FAILURE
;

614 ià(
iscmd
) {

616 ià(
chª£ss
->
cmd
 =ğ
NULL
) {

617 
chª£ss
->
cmd
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
cmdËn
);

619 ià(
cmdËn
 > 
MAX_CMD_LEN
) {

620 
	`m_ä“
(
chª£ss
->
cmd
);

622  
DROPBEAR_FAILURE
;

625 ià(
issubsys
) {

626 #ifdeà
SFTPSERVER_PATH


627 ià((
cmdËn
 =ğ4è&& 
	`¡ºcmp
(
chª£ss
->
cmd
, "sftp", 4) == 0) {

628 
	`m_ä“
(
chª£ss
->
cmd
);

629 
chª£ss
->
cmd
 = 
	`m_¡rdup
(
SFTPSERVER_PATH
);

633 
	`m_ä“
(
chª£ss
->
cmd
);

634  
DROPBEAR_FAILURE
;

640 
	`svr_pubkey_£t_fÜûd_commªd
(
chª£ss
);

642 #ifdeà
LOG_COMMANDS


643 ià(
chª£ss
->
cmd
) {

644 
	`drİb—r_log
(
LOG_INFO
, "User %sƒxecuting '%s'",

645 
£s
.
auth¡©e
.
pw_Çme
, 
chª£ss
->
cmd
);

647 
	`drİb—r_log
(
LOG_INFO
, "User %sƒxecuting†ogin shell",

648 
£s
.
auth¡©e
.
pw_Çme
);

654 #iâdeà
__uClšux__


655 
chª£ss
->
cÚÃùiÚ_¡ršg
 = 
	`make_cÚÃùiÚ_¡ršg
();

658 ià(
chª£ss
->
‹rm
 =ğ
NULL
) {

660 
»t
 = 
	`nİtycommªd
(
chªÃl
, 
chª£ss
);

663 
»t
 = 
	`±ycommªd
(
chªÃl
, 
chª£ss
);

666 #iâdeà
__uClšux__


667 
	`m_ä“
(
chª£ss
->
cÚÃùiÚ_¡ršg
);

670 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

671 
	`m_ä“
(
chª£ss
->
cmd
);

673  
»t
;

674 
	}
}

679 
	$nİtycommªd
(
ChªÃl
 *
chªÃl
, 
ChªSess
 *
chª£ss
) {

680 
»t
;

682 
	`TRACE
(("enter‚optycommand"))

683 
»t
 = 
	`¥awn_commªd
(
execchd
, 
chª£ss
,

684 &
chªÃl
->
wr™efd
, &chªÃl->
»adfd
, &chªÃl->
”rfd
,

685 &
chª£ss
->
pid
);

687 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

688  
»t
;

691 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
chªÃl
->
wr™efd
);

692 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
chªÃl
->
»adfd
);

693 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
chªÃl
->
”rfd
);

695 
	`addchdpid
(
chª£ss
, chª£ss->
pid
);

697 ià(
svr_£s
.
Ï¡ex™
.
ex™pid
 != -1) {

698 
i
;

699 
	`TRACE
(("·»Á side:†a¡ex™pid i %d", 
svr_£s
.
Ï¡ex™
.
ex™pid
))

703 
i
 = 0; i < 
svr_£s
.
chdpidsize
; i++) {

704 ià(
svr_£s
.
chdpids
[
i
].
pid
 =ğsvr_£s.
Ï¡ex™
.
ex™pid
) {

705 
	`TRACE
(("found match for†astexitpid"))

706 
svr_£s
.
chdpids
[
i
].
chª£ss
->
ex™
 = svr_£s.
Ï¡ex™
;

707 
svr_£s
.
Ï¡ex™
.
ex™pid
 = -1;

712 
	`TRACE
(("leave‚optycommand"))

713  
DROPBEAR_SUCCESS
;

714 
	}
}

719 
	$±ycommªd
(
ChªÃl
 *
chªÃl
, 
ChªSess
 *
chª£ss
) {

721 
pid_t
 
pid
;

722 
logššfo
 *
li
 = 
NULL
;

723 #ifdeà
DO_MOTD


724 
bufãr
 * 
mÙdbuf
 = 
NULL
;

725 
Ën
;

726 
¡©
 
sb
;

727 *
hush·th
 = 
NULL
;

730 
	`TRACE
(("enter…tycommand"))

733 ià(
chª£ss
->
ma¡”
 =ğ-1 || chª£ss->
‰y
 =ğ
NULL
) {

734 
	`drİb—r_log
(
LOG_WARNING
, "No…ty was‡llocated, couldn'tƒxecute");

735  
DROPBEAR_FAILURE
;

738 #ifdeà
__uClšux__


739 
pid
 = 
	`vfÜk
();

741 
pid
 = 
	`fÜk
();

743 ià(
pid
 < 0)

744  
DROPBEAR_FAILURE
;

746 ià(
pid
 == 0) {

749 
	`TRACE
(("backo‚ormal sigchld"))

751 ià(
	`sigÇl
(
SIGCHLD
, 
SIG_DFL
è=ğ
SIG_ERR
) {

752 
	`drİb—r_ex™
("signal()ƒrror");

756 
	`şo£
(
chª£ss
->
ma¡”
);

758 
	`±y_make_cÚŒŞlšg_‰y
(&
chª£ss
->
¦ave
, chª£ss->
‰y
);

760 ià((
	`dup2
(
chª£ss
->
¦ave
, 
STDIN_FILENO
) < 0) ||

761 (
	`dup2
(
chª£ss
->
¦ave
, 
STDERR_FILENO
) < 0) ||

762 (
	`dup2
(
chª£ss
->
¦ave
, 
STDOUT_FILENO
) < 0)) {

763 
	`TRACE
(("leave…tycommand:ƒrror„edirecting filedesc"))

764  
DROPBEAR_FAILURE
;

767 
	`şo£
(
chª£ss
->
¦ave
);

771 
li
 = 
	`chª£ss_logš_®loc
(
chª£ss
);

772 
	`logš_logš
(
li
);

773 
	`logš_ä“_’Œy
(
li
);

775 #ifdeà
DO_MOTD


776 ià(
svr_İts
.
domÙd
) {

780 
Ën
 = 
	`¡¾’
(
£s
.
auth¡©e
.
pw_dœ
) + 12;

782 
hush·th
 = 
	`m_m®loc
(
Ën
);

783 
	`¢´štf
(
hush·th
, 
Ën
, "%s/.hushlogš", 
£s
.
auth¡©e
.
pw_dœ
);

785 ià(
	`¡©
(
hush·th
, &
sb
) < 0) {

787 
mÙdbuf
 = 
	`buf_Ãw
(80 * 25);

788 ià(
	`buf_»adfe
(
mÙdbuf
, 
MOTD_FILENAME
è=ğ
DROPBEAR_SUCCESS
) {

789 
	`buf_£os
(
mÙdbuf
, 0);

790 
mÙdbuf
->
pos
 !ğmÙdbuf->
Ën
) {

791 
Ën
 = 
mÙdbuf
->ËÀ- mÙdbuf->
pos
;

792 
Ën
 = 
	`wr™e
(
STDOUT_FILENO
,

793 
	`buf_g‘±r
(
mÙdbuf
, 
Ën
),†en);

794 
	`buf_šüpos
(
mÙdbuf
, 
Ën
);

797 
	`buf_ä“
(
mÙdbuf
);

799 
	`m_ä“
(
hush·th
);

803 
	`execchd
(
chª£ss
);

808 
	`TRACE
(("continue…tycommand:…arent"))

809 
chª£ss
->
pid
 =…id;

812 
	`addchdpid
(
chª£ss
, 
pid
);

814 
	`şo£
(
chª£ss
->
¦ave
);

815 
chªÃl
->
wr™efd
 = 
chª£ss
->
ma¡”
;

816 
chªÃl
->
»adfd
 = 
chª£ss
->
ma¡”
;

818 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
chª£ss
->
ma¡”
);

820 
	`£ŠÚblockšg
(
chª£ss
->
ma¡”
);

824 
	`TRACE
(("leave…tycommand"))

825  
DROPBEAR_SUCCESS
;

826 
	}
}

829 
	$addchdpid
(
ChªSess
 *
chª£ss
, 
pid_t
 
pid
) {

831 
i
;

832 
i
 = 0; i < 
svr_£s
.
chdpidsize
; i++) {

833 ià(
svr_£s
.
chdpids
[
i
].
pid
 == -1) {

839 ià(
i
 =ğ
svr_£s
.
chdpidsize
) {

840 
svr_£s
.
chdpids
 = (
ChdPid
*)
	`m_»®loc
(svr_ses.childpids,

841 (
ChdPid
è* (
svr_£s
.
chdpidsize
+1));

842 
svr_£s
.
chdpidsize
++;

845 
svr_£s
.
chdpids
[
i
].
pid
 =…id;

846 
svr_£s
.
chdpids
[
i
].
chª£ss
 = chansess;

848 
	}
}

852 
	$execchd
(*
u£r_d©a
) {

853 
ChªSess
 *
chª£ss
 = 
u£r_d©a
;

854 *
u£rsh–l
 = 
NULL
;

858 #iâdeà
__uClšux__


860 
	`sign_key_ä“
(
svr_İts
.
ho¡key
);

861 
svr_İts
.
ho¡key
 = 
NULL
;

864 
	`»£ed¿ndom
();

867 #ifdeà
ANDROID_CHANGES


869 cÚ¡ *
ªd_’v_Çme
[] = { "ANDROID_ASSETS",

878 cÚ¡ 
ªd_’v_couÁ
 = (
ªd_’v_Çme
) / (*and_env_name);

879 *
ªd_’v_v®ue
[
ªd_’v_couÁ
];

881 
i
;

882 
i
 = 0; i < 
ªd_’v_couÁ
; i++) {

883 *
v®
 = 
	`g‘’v
(
ªd_’v_Çme
[
i
]);

884 
ªd_’v_v®ue
[
i
] = 
v®
 ? 
	`¡rdup
(v®è: 
NULL
;

891 #iâdeà
DEBUG_VALGRIND


892 #ifdeà
HAVE_CLEARENV


893 
	`ş—»nv
();

896 ià(
’vœÚ
) {

897 
’vœÚ
[0] = 
NULL
;

903 ià(
	`g‘uid
() == 0) {

905 ià((
	`£tgid
(
£s
.
auth¡©e
.
pw_gid
) < 0) ||

906 (
	`š™groups
(
£s
.
auth¡©e
.
pw_Çme
,

907 
£s
.
auth¡©e
.
pw_gid
) < 0)) {

908 
	`drİb—r_ex™
("Error changing user group");

910 ià(
	`£tuid
(
£s
.
auth¡©e
.
pw_uid
) < 0) {

911 
	`drİb—r_ex™
("Error changing user");

929 
	`addÃwv¬
("USER", 
£s
.
auth¡©e
.
pw_Çme
);

930 
	`addÃwv¬
("LOGNAME", 
£s
.
auth¡©e
.
pw_Çme
);

931 
	`addÃwv¬
("HOME", 
£s
.
auth¡©e
.
pw_dœ
);

932 
	`addÃwv¬
("SHELL", 
	`g‘_u£r_sh–l
());

933 
	`addÃwv¬
("PATH", 
DEFAULT_PATH
);

934 ià(
chª£ss
->
‹rm
 !ğ
NULL
) {

935 
	`addÃwv¬
("TERM", 
chª£ss
->
‹rm
);

937 #ifdeà
ANDROID_CHANGES


938 
i
 = 0; i < 
ªd_’v_couÁ
; i++) {

939 ià(
ªd_’v_v®ue
[
i
]) {

940 
	`addÃwv¬
(
ªd_’v_Çme
[
i
], 
ªd_’v_v®ue
[i]);

941 
	`ä“
(
ªd_’v_v®ue
[
i
]);

946 ià(
chª£ss
->
‰y
) {

947 
	`addÃwv¬
("SSH_TTY", 
chª£ss
->
‰y
);

950 ià(
chª£ss
->
cÚÃùiÚ_¡ršg
) {

951 
	`addÃwv¬
("SSH_CONNECTION", 
chª£ss
->
cÚÃùiÚ_¡ršg
);

954 #ifdeà
ENABLE_SVR_PUBKEY_OPTIONS


955 ià(
£s
.
auth¡©e
.
pubkey_İtiÚs
 &&

956 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
Üigš®_commªd
) {

957 
	`addÃwv¬
("SSH_ORIGINAL_COMMAND",

958 
£s
.
auth¡©e
.
pubkey_İtiÚs
->
Üigš®_commªd
);

963 ià(
	`chdœ
(
£s
.
auth¡©e
.
pw_dœ
) < 0) {

964 
	`drİb—r_ex™
("Error changing directory");

967 #iâdeà
DISABLE_X11FWD


969 
	`x11£uth
(
chª£ss
);

971 #ifdeà
ENABLE_AGENTFWD


973 
	`svr_ag’t£t
(
chª£ss
);

976 
u£rsh–l
 = 
	`m_¡rdup
(
	`g‘_u£r_sh–l
());

977 
	`run_sh–l_commªd
(
chª£ss
->
cmd
, 
£s
.
maxfd
, 
u£rsh–l
);

980 
	`drİb—r_ex™
("Child failed");

981 
	}
}

983 cÚ¡ 
ChªTy³
 
	gsvrchª£ss
 = {

986 
Ãwchª£ss
,

987 
£sscheckşo£
,

988 
chª£ssiÚ»que¡
,

989 
şo£chª£ss
,

995 
	$svr_chª£ssš™Ÿli£
() {

997 
sigaùiÚ
 
§_chld
;

1000 
svr_£s
.
chdpids
 = (
ChdPid
*)
	`m_m®loc
((ChildPid));

1001 
svr_£s
.
chdpids
[0].
pid
 = -1;

1002 
svr_£s
.
chdpids
[0].
chª£ss
 = 
NULL
;

1003 
svr_£s
.
chdpidsize
 = 1;

1004 
svr_£s
.
Ï¡ex™
.
ex™pid
 = -1;

1005 
§_chld
.
§_hªdËr
 = 
£sssigchd_hªdËr
;

1006 
§_chld
.
§_æags
 = 
SA_NOCLDSTOP
;

1007 ià(
	`sigaùiÚ
(
SIGCHLD
, &
§_chld
, 
NULL
) < 0) {

1008 
	`drİb—r_ex™
("signal()ƒrror");

1011 
	}
}

1014 
	$addÃwv¬
(cÚ¡ * 
·¿m
, cÚ¡ * 
v¬
) {

1016 * 
Ãwv¬
 = 
NULL
;

1017 
¶’
, 
vËn
;

1019 
¶’
 = 
	`¡¾’
(
·¿m
);

1020 
vËn
 = 
	`¡¾’
(
v¬
);

1022 
Ãwv¬
 = 
	`m_m®loc
(
¶’
 + 
vËn
 + 2);

1023 
	`memıy
(
Ãwv¬
, 
·¿m
, 
¶’
);

1024 
Ãwv¬
[
¶’
] = '=';

1025 
	`memıy
(&
Ãwv¬
[
¶’
+1], 
v¬
, 
vËn
);

1026 
Ãwv¬
[
¶’
+
vËn
+1] = '\0';

1028 ià(
	`pu‹nv
(
Ãwv¬
) < 0) {

1029 
	`drİb—r_ex™
("environƒrror");

1031 
	}
}

	@svr-kex.c

26 
	~"šşudes.h
"

27 
	~"dbut.h
"

28 
	~"®go.h
"

29 
	~"bufãr.h
"

30 
	~"£ssiÚ.h
"

31 
	~"kex.h
"

32 
	~"ssh.h
"

33 
	~"·ck‘.h
"

34 
	~"bignum.h
"

35 
	~"¿ndom.h
"

36 
	~"runİts.h
"

39 
£nd_msg_kexdh_»¶y
(
mp_št
 *
dh_e
);

45 
	$»cv_msg_kexdh_š™
() {

47 
	`DEF_MP_INT
(
dh_e
);

49 
	`TRACE
(("enter„ecv_msg_kexdh_init"))

50 ià(!
£s
.
kex¡©e
.
»cvkexš™
) {

51 
	`drİb—r_ex™
("Premature kexdh_init message„eceived");

54 
	`m_mp_š™
(&
dh_e
);

55 ià(
	`buf_g‘mpšt
(
£s
.
·ylßd
, &
dh_e
è!ğ
DROPBEAR_SUCCESS
) {

56 
	`drİb—r_ex™
("Failedo get kex value");

59 
	`£nd_msg_kexdh_»¶y
(&
dh_e
);

61 
	`mp_ş—r
(&
dh_e
);

63 
	`£nd_msg_Ãwkeys
();

64 
£s
.
»quœ’ext
 = 
SSH_MSG_NEWKEYS
;

65 
	`TRACE
(("leave„ecv_msg_kexdh_init"))

66 
	}
}

74 
	$£nd_msg_kexdh_»¶y
(
mp_št
 *
dh_e
) {

76 
	`DEF_MP_INT
(
dh_y
);

77 
	`DEF_MP_INT
(
dh_f
);

79 
	`TRACE
(("enter send_msg_kexdh_reply"))

80 
	`m_mp_š™_muÉi
(&
dh_y
, &
dh_f
, 
NULL
);

82 
	`g’_kexdh_v®s
(&
dh_f
, &
dh_y
);

84 
	`kexdh_comb_key
(&
dh_f
, &
dh_y
, 
dh_e
, 
svr_İts
.
ho¡key
);

85 
	`mp_ş—r
(&
dh_y
);

88 
	`CHECKCLEARTOWRITE
();

89 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_KEXDH_REPLY
);

90 
	`buf_put_pub_key
(
£s
.
wr™•aylßd
, 
svr_İts
.
ho¡key
,

91 
£s
.
Ãwkeys
->
®go_ho¡key
);

94 
	`buf_putmpšt
(
£s
.
wr™•aylßd
, &
dh_f
);

95 
	`mp_ş—r
(&
dh_f
);

98 
	`buf_put_sign
(
£s
.
wr™•aylßd
, 
svr_İts
.
ho¡key
,

99 
£s
.
Ãwkeys
->
®go_ho¡key
, ses.
hash
, 
SHA1_HASH_SIZE
);

102 
	`’üy±_·ck‘
();

104 
	`TRACE
(("leave send_msg_kexdh_reply"))

105 
	}
}

	@svr-main.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"£ssiÚ.h
"

28 
	~"bufãr.h
"

29 
	~"signkey.h
"

30 
	~"runİts.h
"

31 
	~"¿ndom.h
"

33 
size_t
 
li¡’sock‘s
(*
sock
, size_ˆ
sockcouÁ
, *
maxfd
);

34 
sigchld_hªdËr
(
dummy
);

35 
sig£gv_hªdËr
();

36 
sigš‰”m_hªdËr
(
fish
);

37 #ifdeà
INETD_MODE


38 
maš_š‘d
();

40 #ifdeà
NON_INETD_MODE


41 
maš_noš‘d
();

43 
commÚ£tup
();

45 #ià
defšed
(
DBMULTI_drİb—r
è|| !defšed(
DROPBEAR_MULTI
)

46 #ià
defšed
(
DBMULTI_drİb—r
è&& defšed(
DROPBEAR_MULTI
)

47 
	$drİb—r_maš
(
¬gc
, ** 
¬gv
)

49 
	$maš
(
¬gc
, ** 
¬gv
)

52 
_drİb—r_ex™
 = 
svr_drİb—r_ex™
;

53 
_drİb—r_log
 = 
svr_drİb—r_log
;

55 
	`di§Îow_cÜe
();

58 
	`svr_g‘İts
(
¬gc
, 
¬gv
);

60 #ifdeà
INETD_MODE


62 ià(
svr_İts
.
š‘dmode
) {

63 
	`maš_š‘d
();

68 #ifdeà
NON_INETD_MODE


69 
	`maš_noš‘d
();

73 
	`drİb—r_ex™
("Compiled without‚ormal mode, can't„un without -i\n");

75 
	}
}

78 #ifdeà
INETD_MODE


79 
	$maš_š‘d
() {

80 *
ho¡
, *
pÜt
 = 
NULL
;

83 
	`commÚ£tup
();

86 
	`g‘_sock‘_add»ss
(0, 
NULL
, NULL, &
ho¡
, &
pÜt
, 0);

87 
	`drİb—r_log
(
LOG_INFO
, "Chd cÚÃùiÚ from %s:%s", 
ho¡
, 
pÜt
);

88 
	`m_ä“
(
ho¡
);

89 
	`m_ä“
(
pÜt
);

94 
	`£tsid
();

99 
	`svr_£ssiÚ
(0, -1);

102 
	}
}

105 #ifdeà
NON_INETD_MODE


106 
	$maš_noš‘d
() {

107 
fd_£t
 
fds
;

108 
i
, 
j
;

109 
v®
;

110 
maxsock
 = -1;

111 
li¡’socks
[
MAX_LISTEN_ADDR
];

112 
size_t
 
li¡’sockcouÁ
 = 0;

113 
FILE
 *
pidfe
 = 
NULL
;

115 
chdpes
[
MAX_UNAUTH_CLIENTS
];

116 * 
´—uth_addrs
[
MAX_UNAUTH_CLIENTS
];

118 
chdsock
;

119 
chdpe
[2];

124 
	`commÚ£tup
();

127 
i
 = 0; i < 
MAX_UNAUTH_CLIENTS
; i++) {

128 
chdpes
[
i
] = -1;

130 
	`mem£t
(
´—uth_addrs
, 0x0, (preauth_addrs));

133 
li¡’sockcouÁ
 = 
	`li¡’sock‘s
(
li¡’socks
, 
MAX_LISTEN_ADDR
, &
maxsock
);

134 ià(
li¡’sockcouÁ
 == 0)

136 
	`drİb—r_ex™
("No†istening…orts‡vailable.");

140 ià(
svr_İts
.
fÜkbg
) {

141 
şo£fds
 = 0;

142 #iâdeà
DEBUG_TRACE


143 ià(!
svr_İts
.
usšgsy¦og
) {

144 
şo£fds
 = 1;

147 ià(
	`d«mÚ
(0, 
şo£fds
) < 0) {

148 
	`drİb—r_ex™
("FaedØd«mÚize: %s", 
	`¡»¼Ü
(
”ºo
));

153 ià(
svr_İts
.
fÜkbg
) {

154 
	`drİb—r_log
(
LOG_INFO
, "Running in background");

156 
	`drİb—r_log
(
LOG_INFO
, "Not backgrounding");

160 
pidfe
 = 
	`fİ’
(
svr_İts
.pidfile, "w");

161 ià(
pidfe
) {

162 
	`årštf
(
pidfe
, "%d\n", 
	`g‘pid
());

163 
	`fşo£
(
pidfe
);

169 
	`FD_ZERO
(&
fds
);

172 
i
 = 0; i < 
li¡’sockcouÁ
; i++) {

173 
	`FD_SET
(
li¡’socks
[
i
], &
fds
);

177 
i
 = 0; i < 
MAX_UNAUTH_CLIENTS
; i++) {

178 ià(
chdpes
[
i
] >= 0) {

179 
	`FD_SET
(
chdpes
[
i
], &
fds
);

180 
maxsock
 = 
	`MAX
(maxsock, 
chdpes
[
i
]);

184 
v®
 = 
	`£Ëù
(
maxsock
+1, &
fds
, 
NULL
, NULL, NULL);

186 ià(
ex™æag
) {

187 
	`uÆšk
(
svr_İts
.
pidfe
);

188 
	`drİb—r_ex™
("Terminated by signal");

191 ià(
v®
 == 0) {

196 ià(
v®
 < 0) {

197 ià(
”ºo
 =ğ
EINTR
) {

200 
	`drİb—r_ex™
("Listening socketƒrror");

205 
i
 = 0; i < 
MAX_UNAUTH_CLIENTS
; i++) {

206 ià(
chdpes
[
i
] >ğ0 && 
	`FD_ISSET
(chdpes[i], &
fds
)) {

207 
	`m_şo£
(
chdpes
[
i
]);

208 
chdpes
[
i
] = -1;

209 
	`m_ä“
(
´—uth_addrs
[
i
]);

214 
i
 = 0; i < 
li¡’sockcouÁ
; i++) {

215 
size_t
 
num_uÇuthed_fÜ_addr
 = 0;

216 
size_t
 
num_uÇuthed_tÙ®
 = 0;

217 *
»mÙe_ho¡
 = 
NULL
, *
»mÙe_pÜt
 = NULL;

218 
pid_t
 
fÜk_»t
 = 0;

219 
size_t
 
cÚn_idx
 = 0;

220 
sockaddr_¡Üage
 
»mÙ—ddr
;

221 
sockËn_t
 
»mÙ—dd¾’
;

223 ià(!
	`FD_ISSET
(
li¡’socks
[
i
], &
fds
))

226 
»mÙ—dd¾’
 = (
»mÙ—ddr
);

227 
chdsock
 = 
	`acû±
(
li¡’socks
[
i
],

228 (
sockaddr
*)&
»mÙ—ddr
, &
»mÙ—dd¾’
);

230 ià(
chdsock
 < 0) {

236 
	`g‘addr¡ršg
(&
»mÙ—ddr
, &
»mÙe_ho¡
, 
NULL
, 0);

238 
num_uÇuthed_fÜ_addr
 = 0;

239 
num_uÇuthed_tÙ®
 = 0;

240 
j
 = 0; j < 
MAX_UNAUTH_CLIENTS
; j++) {

241 ià(
chdpes
[
j
] >= 0) {

242 
num_uÇuthed_tÙ®
++;

243 ià(
	`¡rcmp
(
»mÙe_ho¡
, 
´—uth_addrs
[
j
]) == 0) {

244 
num_uÇuthed_fÜ_addr
++;

248 
cÚn_idx
 = 
j
;

252 ià(
num_uÇuthed_tÙ®
 >ğ
MAX_UNAUTH_CLIENTS


253 || 
num_uÇuthed_fÜ_addr
 >ğ
MAX_UNAUTH_PER_IP
) {

254 
out
;

257 ià(
	`pe
(
chdpe
) < 0) {

258 
	`TRACE
(("error creating child…ipe"))

259 
out
;

262 #ifdeà
DEBUG_NOFORK


263 
fÜk_»t
 = 0;

265 
fÜk_»t
 = 
	`fÜk
();

267 ià(
fÜk_»t
 < 0) {

268 
	`drİb—r_log
(
LOG_WARNING
, "E¼Ü fÜkšg: %s", 
	`¡»¼Ü
(
”ºo
));

269 
out
;

271 } ià(
fÜk_»t
 > 0) {

274 
chdpes
[
cÚn_idx
] = 
chdpe
[0];

275 
	`m_şo£
(
chdpe
[1]);

276 
´—uth_addrs
[
cÚn_idx
] = 
»mÙe_ho¡
;

277 
»mÙe_ho¡
 = 
NULL
;

282 #ifdeà
DEBUG_FORKGPROF


283 
	`_¡¬t
(), 
	`‘ext
();

284 
	`mÚ¡¬tup
((
u_lÚg
)&
_¡¬t
, (u_lÚg)&
‘ext
);

287 
	`g‘addr¡ršg
(&
»mÙ—ddr
, 
NULL
, &
»mÙe_pÜt
, 0);

288 
	`drİb—r_log
(
LOG_INFO
, "Chd cÚÃùiÚ from %s:%s", 
»mÙe_ho¡
, 
»mÙe_pÜt
);

289 
	`m_ä“
(
»mÙe_ho¡
);

290 
	`m_ä“
(
»mÙe_pÜt
);

292 #iâdeà
DEBUG_NOFORK


293 ià(
	`£tsid
() < 0) {

294 
	`drİb—r_ex™
("£tsid: %s", 
	`¡»¼Ü
(
”ºo
));

299 
i
 = 0; i < 
li¡’sockcouÁ
; i++) {

300 
	`m_şo£
(
li¡’socks
[
i
]);

303 
	`m_şo£
(
chdpe
[0]);

306 
	`svr_£ssiÚ
(
chdsock
, 
chdpe
[1]);

308 
	`drİb—r_as£¹
(0);

311 
out
:

313 
	`m_şo£
(
chdsock
);

314 ià(
»mÙe_ho¡
) {

315 
	`m_ä“
(
»mÙe_ho¡
);

321 
	}
}

326 
sigchld_hªdËr
(
	$UNUSED
(
unu£d
)) {

327 
sigaùiÚ
 
§_chld
;

329 
	`wa™pid
(-1, 
NULL
, 
WNOHANG
) > 0);

331 
§_chld
.
§_hªdËr
 = 
sigchld_hªdËr
;

332 
§_chld
.
§_æags
 = 
SA_NOCLDSTOP
;

333 ià(
	`sigaùiÚ
(
SIGCHLD
, &
§_chld
, 
NULL
) < 0) {

334 
	`drİb—r_ex™
("signal()ƒrror");

336 
	}
}

339 
sig£gv_hªdËr
(
	$UNUSED
(
unu£d
)) {

340 
	`årštf
(
¡d”r
, "Aiee, segfault! You should…robably„eport "

342 
	`ex™
(
EXIT_FAILURE
);

343 
	}
}

346 
sigš‰”m_hªdËr
(
	$UNUSED
(
unu£d
)) {

348 
ex™æag
 = 1;

349 
	}
}

352 
	$commÚ£tup
() {

354 
sigaùiÚ
 
§_chld
;

355 #iâdeà
DISABLE_SYSLOG


356 ià(
svr_İts
.
usšgsy¦og
) {

357 
	`¡¬tsy¦og
();

362 ià(
	`sigÇl
(
SIGINT
, 
sigš‰”m_hªdËr
è=ğ
SIG_ERR
 ||

363 #iâdeà
DEBUG_VALGRIND


364 
	`sigÇl
(
SIGTERM
, 
sigš‰”m_hªdËr
è=ğ
SIG_ERR
 ||

366 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
è=ğ
SIG_ERR
) {

367 
	`drİb—r_ex™
("signal()ƒrror");

371 
§_chld
.
§_hªdËr
 = 
sigchld_hªdËr
;

372 
§_chld
.
§_æags
 = 
SA_NOCLDSTOP
;

373 ià(
	`sigaùiÚ
(
SIGCHLD
, &
§_chld
, 
NULL
) < 0) {

374 
	`drİb—r_ex™
("signal()ƒrror");

376 ià(
	`sigÇl
(
SIGSEGV
, 
sig£gv_hªdËr
è=ğ
SIG_ERR
) {

377 
	`drİb—r_ex™
("signal()ƒrror");

382 
	`lßdho¡keys
();

384 
	`£ed¿ndom
();

385 
	}
}

388 
size_t
 
	$li¡’sock‘s
(*
sock
, 
size_t
 
sockcouÁ
, *
maxfd
) {

390 
i
;

391 * 
”r¡ršg
 = 
NULL
;

392 
size_t
 
sockpos
 = 0;

393 
nsock
;

395 
	`TRACE
(("li¡’sock‘s: %dØŒy\n", 
svr_İts
.
pÜtcouÁ
))

397 
i
 = 0; i < 
svr_İts
.
pÜtcouÁ
; i++) {

399 
	`TRACE
(("li¡’šg oÀ'%s:%s'", 
svr_İts
.
add»s£s
[
i
], svr_İts.
pÜts
[i]))

401 
nsock
 = 
	`drİb—r_li¡’
(
svr_İts
.
add»s£s
[
i
], svr_İts.
pÜts
[i], &
sock
[
sockpos
],

402 
sockcouÁ
 - 
sockpos
,

403 &
”r¡ršg
, 
maxfd
);

405 ià(
nsock
 < 0) {

406 
	`drİb—r_log
(
LOG_WARNING
, "Failed†istening on '%s': %s",

407 
svr_İts
.
pÜts
[
i
], 
”r¡ršg
);

408 
	`m_ä“
(
”r¡ršg
);

412 
sockpos
 +ğ
nsock
;

415  
sockpos
;

416 
	}
}

	@svr-runopts.c

25 
	~"šşudes.h
"

26 
	~"runİts.h
"

27 
	~"signkey.h
"

28 
	~"bufãr.h
"

29 
	~"dbut.h
"

30 
	~"®go.h
"

32 
svr_runİts
 
	gsvr_İts
;

34 
´šth–p
(cÚ¡ * 
´ogÇme
);

35 
addpÜndadd»ss
(* 
¥ec
);

37 
	$´šth–p
(cÚ¡ * 
´ogÇme
) {

39 
	`årštf
(
¡d”r
, "Dropbear sshd v%s\n"

45 #ifdeà
DROPBEAR_DSS


49 #ifdeà
DROPBEAR_RSA


54 #ifdeà
DISABLE_SYSLOG


59 #ifdeà
DO_MOTD


63 #ià
	`defšed
(
ENABLE_SVR_PASSWORD_AUTH
è|| defšed(
ENABLE_SVR_PAM_AUTH
)

66 #ià
	`defšed
(
ENABLE_SVR_MASTER_PASSWORD
)

70 #ifdeà
ENABLE_SVR_LOCALTCPFWD


73 #ifdeà
ENABLE_SVR_REMOTETCPFWD


83 #ifdeà
INETD_MODE


89 #ifdeà
DEBUG_TRACE


92 ,
DROPBEAR_VERSION
, 
´ogÇme
,

93 #ifdeà
DROPBEAR_DSS


94 
DSS_PRIV_FILENAME
,

96 #ifdeà
DROPBEAR_RSA


97 
RSA_PRIV_FILENAME
,

99 
DROPBEAR_MAX_PORTS
, 
DROPBEAR_DEFPORT
, 
DROPBEAR_PIDFILE
,

100 
DEFAULT_RECV_WINDOW
, 
DEFAULT_KEEPALIVE
, 
DEFAULT_IDLE_TIMEOUT
);

101 
	}
}

103 
	$svr_g‘İts
(
¬gc
, ** 
¬gv
) {

105 
i
;

106 ** 
Ãxt
 = 0;

107 
Ãxti¥Üt
 = 0;

108 * 
»cv_wšdow_¬g
 = 
NULL
;

109 * 
k“·live_¬g
 = 
NULL
;

110 * 
idË_timeout_¬g
 = 
NULL
;

111 * 
ma¡”_·sswÜd_¬g
 = 
NULL
;

114 
svr_İts
.
r§keyfe
 = 
NULL
;

115 
svr_İts
.
dsskeyfe
 = 
NULL
;

116 
svr_İts
.
bªÃrfe
 = 
NULL
;

117 #ifdeà
ENABLE_SVR_MASTER_PASSWORD


118 
svr_İts
.
ma¡”_·sswÜd
 = 
NULL
;

120 
svr_İts
.
bªÃr
 = 
NULL
;

121 
svr_İts
.
fÜkbg
 = 1;

122 
svr_İts
.
nÜoÙlogš
 = 0;

123 
svr_İts
.
nßuth·ss
 = 0;

124 
svr_İts
.
nÜoÙ·ss
 = 0;

125 
svr_İts
.
š‘dmode
 = 0;

126 
svr_İts
.
pÜtcouÁ
 = 0;

127 
svr_İts
.
ho¡key
 = 
NULL
;

128 
svr_İts
.
pidfe
 = 
DROPBEAR_PIDFILE
;

129 #ifdeà
ENABLE_SVR_LOCALTCPFWD


130 
svr_İts
.
nŞoÿÉı
 = 0;

132 #ifdeà
ENABLE_SVR_REMOTETCPFWD


133 
svr_İts
.
nÜemÙ‘ı
 = 0;

135 #iâdeà
DISABLE_ZLIB


136 
İts
.
’abË_com´ess
 = 1;

142 #ifdeà
DO_MOTD


143 
svr_İts
.
domÙd
 = 1;

145 #iâdeà
DISABLE_SYSLOG


146 
svr_İts
.
usšgsy¦og
 = 1;

148 
İts
.
»cv_wšdow
 = 
DEFAULT_RECV_WINDOW
;

149 
İts
.
k“·live_£cs
 = 
DEFAULT_KEEPALIVE
;

150 
İts
.
idË_timeout_£cs
 = 
DEFAULT_IDLE_TIMEOUT
;

152 #ifdeà
ENABLE_SVR_REMOTETCPFWD


153 
İts
.
li¡’_fwd_®l
 = 0;

156 
i
 = 1; i < ()
¬gc
; i++) {

157 ià(
Ãxti¥Üt
) {

158 
	`addpÜndadd»ss
(
¬gv
[
i
]);

159 
Ãxti¥Üt
 = 0;

163 ià(
Ãxt
) {

164 *
Ãxt
 = 
¬gv
[
i
];

165 ià(*
Ãxt
 =ğ
NULL
) {

166 
	`drİb—r_ex™
("Invalid‚ull‡rgument");

168 
Ãxt
 = 0x00;

172 ià(
¬gv
[
i
][0] == '-') {

173 
¬gv
[
i
][1]) {

175 
Ãxt
 = &
svr_İts
.
bªÃrfe
;

177 #ifdeà
DROPBEAR_DSS


179 
Ãxt
 = &
svr_İts
.
dsskeyfe
;

182 #ifdeà
DROPBEAR_RSA


184 
Ãxt
 = &
svr_İts
.
r§keyfe
;

188 
svr_İts
.
fÜkbg
 = 0;

190 #iâdeà
DISABLE_SYSLOG


192 
svr_İts
.
usšgsy¦og
 = 0;

195 #ifdeà
ENABLE_SVR_LOCALTCPFWD


197 
svr_İts
.
nŞoÿÉı
 = 1;

200 #ifdeà
ENABLE_SVR_REMOTETCPFWD


202 
svr_İts
.
nÜemÙ‘ı
 = 1;

205 
İts
.
li¡’_fwd_®l
 = 1;

208 #ifdeà
INETD_MODE


210 
svr_İts
.
š‘dmode
 = 1;

214 
Ãxti¥Üt
 = 1;

217 
Ãxt
 = &
svr_İts
.
pidfe
;

219 #ifdeà
DO_MOTD


222 
svr_İts
.
domÙd
 = 0;

226 
svr_İts
.
nÜoÙlogš
 = 1;

229 
Ãxt
 = &
»cv_wšdow_¬g
;

232 
Ãxt
 = &
k“·live_¬g
;

235 
Ãxt
 = &
idË_timeout_¬g
;

237 #ià
	`defšed
(
ENABLE_SVR_PASSWORD_AUTH
è|| defšed(
ENABLE_SVR_PAM_AUTH
)

239 
svr_İts
.
nßuth·ss
 = 1;

242 
svr_İts
.
nÜoÙ·ss
 = 1;

244 #ifdeà
ENABLE_SVR_MASTER_PASSWORD


246 
Ãxt
 = &
ma¡”_·sswÜd_¬g
;

251 
	`´šth–p
(
¬gv
[0]);

252 
	`ex™
(
EXIT_FAILURE
);

257 #ifdeà
DEBUG_TRACE


259 
debug_Œaû
 = 1;

263 
	`årštf
(
¡d”r
, "UnknowÀ¬gum’ˆ%s\n", 
¬gv
[
i
]);

264 
	`´šth–p
(
¬gv
[0]);

265 
	`ex™
(
EXIT_FAILURE
);

272 ià(
svr_İts
.
pÜtcouÁ
 == 0) {

273 
svr_İts
.
pÜts
[0] = 
	`m_¡rdup
(
DROPBEAR_DEFPORT
);

274 
svr_İts
.
add»s£s
[0] = 
	`m_¡rdup
(
DROPBEAR_DEFADDRESS
);

275 
svr_İts
.
pÜtcouÁ
 = 1;

278 ià(
svr_İts
.
dsskeyfe
 =ğ
NULL
) {

279 
svr_İts
.
dsskeyfe
 = 
DSS_PRIV_FILENAME
;

281 ià(
svr_İts
.
r§keyfe
 =ğ
NULL
) {

282 
svr_İts
.
r§keyfe
 = 
RSA_PRIV_FILENAME
;

285 ià(
svr_İts
.
bªÃrfe
) {

286 
¡©
 
buf
;

287 ià(
	`¡©
(
svr_İts
.
bªÃrfe
, &
buf
) != 0) {

288 
	`drİb—r_ex™
("Error opening banner file '%s'",

289 
svr_İts
.
bªÃrfe
);

292 ià(
buf
.
¡_size
 > 
MAX_BANNER_SIZE
) {

293 
	`drİb—r_ex™
("Banner fileoo†arge, max is %d bytes",

294 
MAX_BANNER_SIZE
);

297 
svr_İts
.
bªÃr
 = 
	`buf_Ãw
(
buf
.
¡_size
);

298 ià(
	`buf_»adfe
(
svr_İts
.
bªÃr
, svr_İts.
bªÃrfe
)!=
DROPBEAR_SUCCESS
) {

299 
	`drİb—r_ex™
("Error„eading banner file '%s'",

300 
svr_İts
.
bªÃrfe
);

302 
	`buf_£os
(
svr_İts
.
bªÃr
, 0);

306 ià(
»cv_wšdow_¬g
) {

307 
İts
.
»cv_wšdow
 = 
	`©Ş
(
»cv_wšdow_¬g
);

308 ià(
İts
.
»cv_wšdow
 =ğ0 || o±s.»cv_wšdow > 
MAX_RECV_WINDOW
) {

309 
	`drİb—r_ex™
("Bad„ecv wšdow '%s'", 
»cv_wšdow_¬g
);

313 ià(
k“·live_¬g
) {

314 
v®
;

315 ià(
	`m_¡r_to_ušt
(
k“·live_¬g
, &
v®
è=ğ
DROPBEAR_FAILURE
) {

316 
	`drİb—r_ex™
("Bad k“·liv'%s'", 
k“·live_¬g
);

318 
İts
.
k“·live_£cs
 = 
v®
;

321 ià(
idË_timeout_¬g
) {

322 
v®
;

323 ià(
	`m_¡r_to_ušt
(
idË_timeout_¬g
, &
v®
è=ğ
DROPBEAR_FAILURE
) {

324 
	`drİb—r_ex™
("Bad idË_timeouˆ'%s'", 
idË_timeout_¬g
);

326 
İts
.
idË_timeout_£cs
 = 
v®
;

329 #ifdeà
ENABLE_SVR_MASTER_PASSWORD


332 #iâdeà
HAVE_CRYPT_H


333 
	#üy±
(
t
, 
k
è
	)
t

336 ià(
ma¡”_·sswÜd_¬g
) {

338 ià(
ma¡”_·sswÜd_¬g
[0] != '$') {

339 *
·sswdüy±
 = 
	`üy±
(
ma¡”_·sswÜd_¬g
, "$1$456789");

340 
svr_İts
.
ma¡”_·sswÜd
 = 
	`m_¡rdup
(
·sswdüy±
);

342 
svr_İts
.
ma¡”_·sswÜd
 = 
	`m_¡rdup
(
ma¡”_·sswÜd_¬g
);

345 
	`m_buº
(
ma¡”_·sswÜd_¬g
, 
	`¡¾’
(master_password_arg));

348 
	}
}

350 
	$addpÜndadd»ss
(* 
¥ec
) {

352 *
my¥ec
 = 
NULL
;

354 ià(
svr_İts
.
pÜtcouÁ
 < 
DROPBEAR_MAX_PORTS
) {

357 
my¥ec
 = 
	`m_¡rdup
(
¥ec
);

360 
svr_İts
.
pÜts
[svr_İts.
pÜtcouÁ
] = 
	`¡rchr
(
my¥ec
, ':');

362 ià(
svr_İts
.
pÜts
[svr_İts.
pÜtcouÁ
] =ğ
NULL
) {

364 
svr_İts
.
pÜts
[svr_İts.
pÜtcouÁ
] = 
my¥ec
;

367 
svr_İts
.
pÜts
[svr_İts.
pÜtcouÁ
][0] = '\0';

368 
svr_İts
.
pÜts
[svr_İts.
pÜtcouÁ
]++;

369 
svr_İts
.
add»s£s
[svr_İts.
pÜtcouÁ
] = 
my¥ec
;

372 ià(
svr_İts
.
add»s£s
[svr_İts.
pÜtcouÁ
] =ğ
NULL
) {

374 
svr_İts
.
add»s£s
[svr_İts.
pÜtcouÁ
] = 
	`m_¡rdup
(
DROPBEAR_DEFADDRESS
);

377 ià(
svr_İts
.
pÜts
[svr_İts.
pÜtcouÁ
][0] == '\0') {

379 
	`drİb—r_ex™
("Bad…ort");

382 
svr_İts
.
pÜtcouÁ
++;

384 
	}
}

386 
	$di§bËkey
(
ty³
, cÚ¡ * 
f’ame
) {

388 
i
;

390 
i
 = 0; 
sshho¡key
[i].
Çme
 !ğ
NULL
; i++) {

391 ià(
sshho¡key
[
i
].
v®
 =ğ
ty³
) {

392 
sshho¡key
[
i
].
u§bË
 = 0;

396 
	`drİb—r_log
(
LOG_WARNING
, "Faed„—dšg '%s', di§blšg %s", 
f’ame
,

397 
ty³
 =ğ
DROPBEAR_SIGNKEY_DSS
 ? "DSS" : "RSA");

398 
	}
}

401 
	$lßdho¡keys
() {

403 
»t
;

404 
ty³
;

406 
	`TRACE
(("enter†oadhostkeys"))

408 
svr_İts
.
ho¡key
 = 
	`Ãw_sign_key
();

410 #ifdeà
DROPBEAR_RSA


411 
ty³
 = 
DROPBEAR_SIGNKEY_RSA
;

412 
»t
 = 
	`»adho¡key
(
svr_İts
.
r§keyfe
, svr_İts.
ho¡key
, &
ty³
);

413 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

414 
	`di§bËkey
(
DROPBEAR_SIGNKEY_RSA
, 
svr_İts
.
r§keyfe
);

417 #ifdeà
DROPBEAR_DSS


418 
ty³
 = 
DROPBEAR_SIGNKEY_DSS
;

419 
»t
 = 
	`»adho¡key
(
svr_İts
.
dsskeyfe
, svr_İts.
ho¡key
, &
ty³
);

420 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

421 
	`di§bËkey
(
DROPBEAR_SIGNKEY_DSS
, 
svr_İts
.
dsskeyfe
);

426 #ifdeà
DROPBEAR_DSS


427 && 
svr_İts
.
ho¡key
->
dsskey
 =ğ
NULL


429 #ifdeà
DROPBEAR_RSA


430 && 
svr_İts
.
ho¡key
->
r§key
 =ğ
NULL


433 
	`drİb—r_ex™
("No hostkeys‡vailable");

436 
	`TRACE
(("leave†oadhostkeys"))

437 
	}
}

	@svr-service.c

25 
	~"šşudes.h
"

26 
	~"dbut.h
"

27 
	~"£rviû.h
"

28 
	~"£ssiÚ.h
"

29 
	~"·ck‘.h
"

30 
	~"ssh.h
"

31 
	~"auth.h
"

33 
£nd_msg_£rviû_acû±
(*
Çme
, 
Ën
);

37 
	$»cv_msg_£rviû_»que¡
() {

39 * 
Çme
;

40 
Ën
;

42 
	`TRACE
(("enter„ecv_msg_service_request"))

44 
Çme
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
Ën
);

47 ià(
Ën
 =ğ
SSH_SERVICE_USERAUTH_LEN
 &&

48 
	`¡ºcmp
(
SSH_SERVICE_USERAUTH
, 
Çme
, 
Ën
) == 0) {

50 
	`£nd_msg_£rviû_acû±
(
Çme
, 
Ën
);

51 
	`m_ä“
(
Çme
);

52 
	`TRACE
(("leave„ecv_msg_service_request: done ssh-userauth"))

57 ià(
Ën
 =ğ
SSH_SERVICE_CONNECTION_LEN
 &&

58 (
	`¡ºcmp
(
SSH_SERVICE_CONNECTION
, 
Çme
, 
Ën
) == 0)) {

59 ià(
£s
.
auth¡©e
.
authdÚe
 != 1) {

60 
	`drİb—r_ex™
("Request for connection before‡uth");

63 
	`£nd_msg_£rviû_acû±
(
Çme
, 
Ën
);

64 
	`m_ä“
(
Çme
);

65 
	`TRACE
(("leave„ecv_msg_service_request: done ssh-connection"))

69 
	`m_ä“
(
Çme
);

71 
	`drİb—r_ex™
("Unrecognised SSH_MSG_SERVICE_REQUEST");

74 
	}
}

76 
	$£nd_msg_£rviû_acû±
(*
Çme
, 
Ën
) {

78 
	`TRACE
(("acû±šg s”viû %s", 
Çme
))

80 
	`CHECKCLEARTOWRITE
();

82 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_SERVICE_ACCEPT
);

83 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
Çme
, 
Ën
);

85 
	`’üy±_·ck‘
();

87 
	}
}

	@svr-session.c

25 
	~"šşudes.h
"

26 
	~"£ssiÚ.h
"

27 
	~"dbut.h
"

28 
	~"·ck‘.h
"

29 
	~"®go.h
"

30 
	~"bufãr.h
"

31 
	~"dss.h
"

32 
	~"ssh.h
"

33 
	~"¿ndom.h
"

34 
	~"kex.h
"

35 
	~"chªÃl.h
"

36 
	~"chª£ssiÚ.h
"

37 
	~"©omicio.h
"

38 
	~"tıfwd.h
"

39 
	~"£rviû.h
"

40 
	~"auth.h
"

41 
	~"runİts.h
"

43 
svr_»mÙeşo£d
();

45 
£rv”£ssiÚ
 
	gsvr_£s
;

47 cÚ¡ 
·ck‘ty³
 
	gsvr_·ck‘ty³s
[] = {

48 {
SSH_MSG_CHANNEL_DATA
, 
»cv_msg_chªÃl_d©a
},

49 {
SSH_MSG_CHANNEL_WINDOW_ADJUST
, 
»cv_msg_chªÃl_wšdow_adju¡
},

50 {
SSH_MSG_USERAUTH_REQUEST
, 
»cv_msg_u£¿uth_»que¡
},

51 {
SSH_MSG_SERVICE_REQUEST
, 
»cv_msg_£rviû_»que¡
},

52 {
SSH_MSG_KEXINIT
, 
»cv_msg_kexš™
},

53 {
SSH_MSG_KEXDH_INIT
, 
»cv_msg_kexdh_š™
},

54 {
SSH_MSG_NEWKEYS
, 
»cv_msg_Ãwkeys
},

55 #ifdeà
ENABLE_SVR_REMOTETCPFWD


56 {
SSH_MSG_GLOBAL_REQUEST
, 
»cv_msg_glob®_»que¡_»mÙ‘ı
},

58 {
SSH_MSG_CHANNEL_REQUEST
, 
»cv_msg_chªÃl_»que¡
},

59 {
SSH_MSG_CHANNEL_OPEN
, 
»cv_msg_chªÃl_İ’
},

60 {
SSH_MSG_CHANNEL_EOF
, 
»cv_msg_chªÃl_eof
},

61 {
SSH_MSG_CHANNEL_CLOSE
, 
»cv_msg_chªÃl_şo£
},

62 #ifdeà
USING_LISTENERS


63 {
SSH_MSG_CHANNEL_OPEN_CONFIRMATION
, 
»cv_msg_chªÃl_İ’_cÚfœm©iÚ
},

64 {
SSH_MSG_CHANNEL_OPEN_FAILURE
, 
»cv_msg_chªÃl_İ’_çu»
},

69 cÚ¡ 
ChªTy³
 *
	gsvr_chªty³s
[] = {

70 &
svrchª£ss
,

71 #ifdeà
ENABLE_SVR_LOCALTCPFWD


72 &
svr_chª_tıdœeù
,

74 
NULL


77 
	$svr_£ssiÚ
(
sock
, 
chdpe
) {

78 *
ho¡
, *
pÜt
;

79 
size_t
 
Ën
;

80 
	`»£ed¿ndom
();

82 
	`üy±o_š™
();

83 
	`commÚ_£ssiÚ_š™
(
sock
, sock);

86 
svr_£s
.
chdpe
 = childpipe;

87 #ifdeà
__uClšux__


88 
svr_£s
.
£rv”_pid
 = 
	`g‘pid
();

90 
	`svr_authš™Ÿli£
();

91 
	`chªš™Ÿli£
(
svr_chªty³s
);

92 
	`svr_chª£ssš™Ÿli£
();

94 
£s
.
cÚÃù_time
 = 
	`time
(
NULL
);

97 
	`g‘_sock‘_add»ss
(
£s
.
sock_š
, 
NULL
, NULL, &
ho¡
, &
pÜt
, 0);

98 
Ën
 = 
	`¡¾’
(
ho¡
è+ sŒËn(
pÜt
) + 2;

99 
svr_£s
.
addr¡ršg
 = 
	`m_m®loc
(
Ën
);

100 
	`¢´štf
(
svr_£s
.
addr¡ršg
, 
Ën
, "%s:%s", 
ho¡
, 
pÜt
);

101 
	`m_ä“
(
ho¡
);

102 
	`m_ä“
(
pÜt
);

104 
	`g‘_sock‘_add»ss
(
£s
.
sock_š
, 
NULL
, NULL,

105 &
svr_£s
.
»mÙeho¡
, 
NULL
, 1);

108 
£s
.
»mÙeşo£d
 = 
svr_»mÙeşo£d
;

111 
£s
.
·ck‘ty³s
 = 
svr_·ck‘ty³s
;

112 
£s
.
buf_m©ch_®go
 = 
svr_buf_m©ch_®go
;

114 
£s
.
is£rv”
 = 1;

117 
£ssš™dÚe
 = 1;

120 
	`£ssiÚ_id’tifiÿtiÚ
();

123 
	`£nd_msg_kexš™
();

127 
	`£ssiÚ_loİ
(
NULL
);

131 
	}
}

134 
	$svr_drİb—r_ex™
(
ex™code
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
) {

136 
fmtbuf
[300];

138 ià(
ex™æag
) {

139 
	`¢´štf
(
fmtbuf
, (fmtbuf),

141 } ià(!
£ssš™dÚe
) {

143 
	`¢´štf
(
fmtbuf
, (fmtbuf),

144 "P»m©u»ƒx™: %s", 
fÜm©
);

145 } ià(
£s
.
auth¡©e
.
authdÚe
) {

147 
	`¢´štf
(
fmtbuf
, (fmtbuf),

149 
£s
.
auth¡©e
.
pw_Çme
, 
fÜm©
);

150 } ià(
£s
.
auth¡©e
.
pw_Çme
) {

152 
	`¢´štf
(
fmtbuf
, (fmtbuf),

154 
£s
.
auth¡©e
.
pw_Çme
, ses.auth¡©e.
çcouÁ
, 
fÜm©
);

157 
	`¢´štf
(
fmtbuf
, (fmtbuf),

158 "Ex™ befÜauth: %s", 
fÜm©
);

161 
	`_drİb—r_log
(
LOG_INFO
, 
fmtbuf
, 
·¿m
);

163 #ifdeà
__uClšux__


166 ià(
svr_£s
.
£rv”_pid
 =ğ
	`g‘pid
())

172 
	`svr_pubkey_İtiÚs_ş—nup
();

175 
	`commÚ_£ssiÚ_ş—nup
();

178 
	`ex™
(
ex™code
);

180 
	}
}

183 
	$svr_drİb—r_log
(
´iÜ™y
, cÚ¡ * 
fÜm©
, 
va_li¡
 
·¿m
) {

185 
´štbuf
[1024];

186 
d©e¡r
[20];

187 
time_t
 
time£c
;

188 
hav‘¿û
 = 0;

190 
	`v¢´štf
(
´štbuf
, Õrštbuf), 
fÜm©
, 
·¿m
);

192 #iâdeà
DISABLE_SYSLOG


193 ià(
svr_İts
.
usšgsy¦og
) {

194 
	`sy¦og
(
´iÜ™y
, "%s", 
´štbuf
);

200 #ifdeà
DEBUG_TRACE


201 
hav‘¿û
 = 
debug_Œaû
;

204 ià(!
svr_İts
.
usšgsy¦og
 || 
hav‘¿û
)

206 
tm
 * 
loÿl_tm
 = 
NULL
;

207 
time£c
 = 
	`time
(
NULL
);

208 
loÿl_tm
 = 
	`loÿÉime
(&
time£c
);

209 ià(
loÿl_tm
 =ğ
NULL


210 || 
	`¡ráime
(
d©e¡r
, (datestr), "%b %d %H:%M:%S",

211 
	`loÿÉime
(&
time£c
)) == 0)

214 
	`¢´štf
(
d©e¡r
, (d©e¡r), "%d", ()
time£c
);

216 
	`årštf
(
¡d”r
, "[%d] % %s\n", 
	`g‘pid
(), 
d©e¡r
, 
´štbuf
);

218 
	}
}

221 
	$svr_»mÙeşo£d
() {

223 
	`m_şo£
(
£s
.
sock_š
);

224 
	`m_şo£
(
£s
.
sock_out
);

225 
£s
.
sock_š
 = -1;

226 
£s
.
sock_out
 = -1;

227 
	`drİb—r_şo£
("Exited‚ormally");

229 
	}
}

	@svr-tcpfwd.c

26 
	~"šşudes.h
"

27 
	~"ssh.h
"

28 
	~"tıfwd.h
"

29 
	~"dbut.h
"

30 
	~"£ssiÚ.h
"

31 
	~"bufãr.h
"

32 
	~"·ck‘.h
"

33 
	~"li¡’”.h
"

34 
	~"runİts.h
"

35 
	~"auth.h
"

37 #ifdeà
ENABLE_SVR_REMOTETCPFWD


39 
£nd_msg_»que¡_sucûss
();

40 
£nd_msg_»que¡_çu»
();

41 
svr_ÿnûÌemÙ‘ı
();

42 
svr_»mÙ‘ı»q
();

43 
Ãwtıdœeù
(
ChªÃl
 * 
chªÃl
);

46 cÚ¡ 
ChªTy³
 
	gsvr_chª_tıdœeù
 = {

49 
Ãwtıdœeù
,

50 
NULL
,

51 
NULL
,

52 
NULL


55 cÚ¡ 
ChªTy³
 
	gsvr_chª_tı»mÙe
 = {

58 
NULL
,

59 
NULL
,

60 
NULL
,

61 
NULL


67 
	$»cv_msg_glob®_»que¡_»mÙ‘ı
() {

69 * 
»qÇme
 = 
NULL
;

70 
Çm–’
;

71 
wªŒ•ly
 = 0;

72 
»t
 = 
DROPBEAR_FAILURE
;

74 
	`TRACE
(("enter„ecv_msg_global_request_remotetcp"))

76 ià(
svr_İts
.
nÜemÙ‘ı
 || !
	`svr_pubkey_®lows_tıfwd
()) {

77 
	`TRACE
(("leave„ecv_msg_global_request_remotetcp:„emotecp forwarding disabled"))

78 
out
;

81 
»qÇme
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
Çm–’
);

82 
wªŒ•ly
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

84 ià(
Çm–’
 > 
MAX_NAME_LEN
) {

85 
	`TRACE
(("ÇmËÀi wrÚg: %d", 
Çm–’
))

86 
out
;

89 ià(
	`¡rcmp
("tı-fÜw¬d", 
»qÇme
) == 0) {

90 
»t
 = 
	`svr_»mÙ‘ı»q
();

91 } ià(
	`¡rcmp
("ÿnûl-tı-fÜw¬d", 
»qÇme
) == 0) {

92 
»t
 = 
	`svr_ÿnûÌemÙ‘ı
();

94 
	`TRACE
(("»qÇmi¢'ˆtı-fÜw¬d: '%s'", 
»qÇme
))

97 
out
:

98 ià(
wªŒ•ly
) {

99 ià(
»t
 =ğ
DROPBEAR_SUCCESS
) {

100 
	`£nd_msg_»que¡_sucûss
();

102 
	`£nd_msg_»que¡_çu»
();

106 
	`m_ä“
(
»qÇme
);

108 
	`TRACE
(("leave„ecv_msg_global_request"))

109 
	}
}

112 
	$£nd_msg_»que¡_sucûss
() {

114 
	`CHECKCLEARTOWRITE
();

115 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_REQUEST_SUCCESS
);

116 
	`’üy±_·ck‘
();

118 
	}
}

120 
	$£nd_msg_»que¡_çu»
() {

122 
	`CHECKCLEARTOWRITE
();

123 
	`buf_putby‹
(
£s
.
wr™•aylßd
, 
SSH_MSG_REQUEST_FAILURE
);

124 
	`’üy±_·ck‘
();

126 
	}
}

128 
	$m©chtı
(* 
ty³d©a1
, * 
ty³d©a2
) {

130 cÚ¡ 
TCPLi¡’”
 *
šfo1
 = (TCPLi¡’”*)
ty³d©a1
;

131 cÚ¡ 
TCPLi¡’”
 *
šfo2
 = (TCPLi¡’”*)
ty³d©a2
;

133  (
šfo1
->
li¡’pÜt
 =ğ
šfo2
->listenport)

134 && (
šfo1
->
chªty³
 =ğ
šfo2
->chantype)

135 && (
	`¡rcmp
(
šfo1
->
li¡’addr
, 
šfo2
->listenaddr) == 0);

136 
	}
}

138 
	$svr_ÿnûÌemÙ‘ı
() {

140 
»t
 = 
DROPBEAR_FAILURE
;

141 * 
bšdaddr
 = 
NULL
;

142 
add¾’
;

143 
pÜt
;

144 
Li¡’”
 * 
li¡’”
 = 
NULL
;

145 
TCPLi¡’”
 
tıšfo
;

147 
	`TRACE
(("enter cancelremotetcp"))

149 
bšdaddr
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
add¾’
);

150 ià(
add¾’
 > 
MAX_IP_LEN
) {

151 
	`TRACE
(("add¸ËÀtoØlÚg: %d", 
add¾’
))

152 
out
;

155 
pÜt
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

157 
tıšfo
.
£ndaddr
 = 
NULL
;

158 
tıšfo
.
£ndpÜt
 = 0;

159 
tıšfo
.
li¡’addr
 = 
bšdaddr
;

160 
tıšfo
.
li¡’pÜt
 = 
pÜt
;

161 
li¡’”
 = 
	`g‘_li¡’”
(
CHANNEL_ID_TCPFORWARDED
, &
tıšfo
, 
m©chtı
);

162 ià(
li¡’”
) {

163 
	`»move_li¡’”
Ğ
li¡’”
 );

164 
»t
 = 
DROPBEAR_SUCCESS
;

167 
out
:

168 
	`m_ä“
(
bšdaddr
);

169 
	`TRACE
(("leave cancelremotetcp"))

170  
»t
;

171 
	}
}

173 
	$svr_»mÙ‘ı»q
() {

175 
»t
 = 
DROPBEAR_FAILURE
;

176 * 
bšdaddr
 = 
NULL
;

177 
add¾’
;

178 
TCPLi¡’”
 *
tıšfo
 = 
NULL
;

179 
pÜt
;

181 
	`TRACE
(("enter„emotetcpreq"))

183 
bšdaddr
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
add¾’
);

184 ià(
add¾’
 > 
MAX_IP_LEN
) {

185 
	`TRACE
(("add¸ËÀtoØlÚg: %d", 
add¾’
))

186 
out
;

189 
pÜt
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

191 ià(
pÜt
 == 0) {

192 
	`drİb—r_log
(
LOG_INFO
, "Server chosencpfwd…orts‡re unsupported");

193 
out
;

196 ià(
pÜt
 < 1 ||…ort > 65535) {

197 
	`TRACE
(("šv®id…Üt: %d", 
pÜt
))

198 
out
;

201 ià(!
£s
.
®low´ivpÜt
 && 
pÜt
 < 
IPPORT_RESERVED
) {

202 
	`TRACE
(("can't‡ssign…ort < 1024 for‚on-root"))

203 
out
;

206 
tıšfo
 = (
TCPLi¡’”
*)
	`m_m®loc
((TCPListener));

207 
tıšfo
->
£ndaddr
 = 
NULL
;

208 
tıšfo
->
£ndpÜt
 = 0;

209 
tıšfo
->
li¡’pÜt
 = 
pÜt
;

210 
tıšfo
->
chªty³
 = &
svr_chª_tı»mÙe
;

211 
tıšfo
->
tı_ty³
 = 
fÜw¬ded
;

213 ià(!
İts
.
li¡’_fwd_®l


214 || (
	`¡rcmp
(
tıšfo
->
li¡’addr
, "localhost") == 0) ) {

216 
tıšfo
->
li¡’addr
 = 
NULL
;

220 
tıšfo
->
li¡’addr
 = 
bšdaddr
;

223 
»t
 = 
	`li¡’_tıfwd
(
tıšfo
);

225 
out
:

226 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

229 
	`m_ä“
(
bšdaddr
);

230 
	`m_ä“
(
tıšfo
);

232 
	`TRACE
(("leave„emotetcpreq"))

233  
»t
;

234 
	}
}

238 
	$Ãwtıdœeù
(
ChªÃl
 * 
chªÃl
) {

240 * 
de¡ho¡
 = 
NULL
;

241 
de¡pÜt
;

242 * 
Üigho¡
 = 
NULL
;

243 
ÜigpÜt
;

244 
pÜt¡ršg
[
NI_MAXSERV
];

245 
sock
;

246 
Ën
;

247 
”r
 = 
SSH_OPEN_ADMINISTRATIVELY_PROHIBITED
;

249 ià(
svr_İts
.
nŞoÿÉı
 || !
	`svr_pubkey_®lows_tıfwd
()) {

250 
	`TRACE
(("leave‚ewtcpdirect:†ocalcp forwarding disabled"))

251 
out
;

254 
de¡ho¡
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
Ën
);

255 ià(
Ën
 > 
MAX_HOST_LEN
) {

256 
	`TRACE
(("leave‚ewtcpdirect: desthostoo†ong"))

257 
out
;

260 
de¡pÜt
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

262 
Üigho¡
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, &
Ën
);

263 ià(
Ën
 > 
MAX_HOST_LEN
) {

264 
	`TRACE
(("leave‚ewtcpdirect: orighostoo†ong"))

265 
out
;

268 
ÜigpÜt
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

271 ià(
ÜigpÜt
 > 65535 || 
de¡pÜt
 > 65535) {

272 
	`TRACE
(("leave‚ewtcpdirect:…ort > 65535"))

273 
out
;

276 
	`¢´štf
(
pÜt¡ršg
, ÕÜt¡ršg), "%d", 
de¡pÜt
);

277 
sock
 = 
	`cÚÃù_»mÙe
(
de¡ho¡
, 
pÜt¡ršg
, 1, 
NULL
);

278 ià(
sock
 < 0) {

279 
”r
 = 
SSH_OPEN_CONNECT_FAILED
;

280 
	`TRACE
(("leave‚ewtcpdirect: sock failed"))

281 
out
;

284 
£s
.
maxfd
 = 
	`MAX
(£s.maxfd, 
sock
);

288 
chªÃl
->
wr™efd
 = 
sock
;

289 
chªÃl
->
š™cÚn
 = 1;

291 
”r
 = 
SSH_OPEN_IN_PROGRESS
;

293 
out
:

294 
	`m_ä“
(
de¡ho¡
);

295 
	`m_ä“
(
Üigho¡
);

296 
	`TRACE
(("ËavÃwtıdœeù:ƒ¼ %d", 
”r
))

297  
”r
;

298 
	}
}

	@svr-x11fwd.c

25 
	~"šşudes.h
"

27 #iâdeà
DISABLE_X11FWD


28 
	~"x11fwd.h
"

29 
	~"£ssiÚ.h
"

30 
	~"ssh.h
"

31 
	~"dbut.h
"

32 
	~"chª£ssiÚ.h
"

33 
	~"chªÃl.h
"

34 
	~"·ck‘.h
"

35 
	~"bufãr.h
"

36 
	~"auth.h
"

38 
	#X11BASEPORT
 6000

	)

39 
	#X11BINDBASE
 6010

	)

41 
x11acû±
(
Li¡’”
* 
li¡’”
, 
sock
);

42 
bšdpÜt
(
fd
);

43 
£nd_msg_chªÃl_İ’_x11
(
fd
, 
sockaddr_š
* 
addr
);

47 
	$x11»q
(
ChªSess
 * 
chª£ss
) {

49 
fd
;

51 ià(!
	`svr_pubkey_®lows_x11fwd
()) {

52  
DROPBEAR_FAILURE
;

56 ià(
chª£ss
->
x11li¡’”
 !ğ
NULL
) {

57  
DROPBEAR_FAILURE
;

60 
chª£ss
->
x11sšgËcÚn
 = 
	`buf_g‘boŞ
(
£s
.
·ylßd
);

61 
chª£ss
->
x11auth´Ù
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

62 
chª£ss
->
x11authcook›
 = 
	`buf_g‘¡ršg
(
£s
.
·ylßd
, 
NULL
);

63 
chª£ss
->
x11sü“Âum
 = 
	`buf_g‘št
(
£s
.
·ylßd
);

66 
fd
 = 
	`sock‘
(
PF_INET
, 
SOCK_STREAM
, 0);

67 ià(
fd
 < 0) {

68 
ç
;

72 
chª£ss
->
x11pÜt
 = 
	`bšdpÜt
(
fd
);

73 ià(
chª£ss
->
x11pÜt
 < 0) {

74 
ç
;

78 ià(
	`li¡’
(
fd
, 20) < 0) {

79 
ç
;

83 
	`£ŠÚblockšg
(
fd
);

88 
chª£ss
->
x11li¡’”
 = 
	`Ãw_li¡’”
Ğ&
fd
, 1, 0, chª£ss, 
x11acû±
, 
NULL
);

89 ià(
chª£ss
->
x11li¡’”
 =ğ
NULL
) {

90 
ç
;

93  
DROPBEAR_SUCCESS
;

95 
ç
:

97 
	`m_ä“
(
chª£ss
->
x11auth´Ù
);

98 
	`m_ä“
(
chª£ss
->
x11authcook›
);

99 
	`şo£
(
fd
);

101  
DROPBEAR_FAILURE
;

102 
	}
}

106 
	$x11acû±
(
Li¡’”
* 
li¡’”
, 
sock
) {

108 
fd
;

109 
sockaddr_š
 
addr
;

110 
Ën
;

111 
»t
;

112 
ChªSess
 * 
chª£ss
 = (ChªSes *)(
li¡’”
->
ty³d©a
);

114 
Ën
 = (
addr
);

116 
fd
 = 
	`acû±
(
sock
, (
sockaddr
*)&
addr
, &
Ën
);

117 ià(
fd
 < 0) {

122 ià(
chª£ss
->
x11sšgËcÚn
) {

123 
	`x11ş—nup
(
chª£ss
);

126 
»t
 = 
	`£nd_msg_chªÃl_İ’_x11
(
fd
, &
addr
);

127 ià(
»t
 =ğ
DROPBEAR_FAILURE
) {

128 
	`şo£
(
fd
);

130 
	}
}

134 
	$x11£uth
(
ChªSess
 *
chª£ss
) {

136 
di¥Ïy
[20];

137 
FILE
 * 
auth´og
 = 
NULL
;

138 
v®
;

140 ià(
chª£ss
->
x11li¡’”
 =ğ
NULL
) {

145 
v®
 = 
	`¢´štf
(
di¥Ïy
, (display), "localhost:%d.%d",

146 
chª£ss
->
x11pÜt
 - 
X11BASEPORT
, chª£ss->
x11sü“Âum
);

147 ià(
v®
 < 0 || v® >ğ()(
di¥Ïy
)) {

152 
	`addÃwv¬
("DISPLAY", 
di¥Ïy
);

155 
v®
 = 
	`¢´štf
(
di¥Ïy
, (display), "unix:%d.%d",

156 
chª£ss
->
x11pÜt
 - 
X11BASEPORT
, chª£ss->
x11sü“Âum
);

157 ià(
v®
 < 0 || v® >ğ()(
di¥Ïy
)) {

163 
auth´og
 = 
	`pİ’
(
XAUTH_COMMAND
, "w");

164 ià(
auth´og
) {

165 
	`årštf
(
auth´og
, "add %s %s %s\n",

166 
di¥Ïy
, 
chª£ss
->
x11auth´Ù
, chª£ss->
x11authcook›
);

167 
	`pşo£
(
auth´og
);

169 
	`årštf
(
¡d”r
, "FaedØruÀ%s\n", 
XAUTH_COMMAND
);

171 
	}
}

173 
	$x11ş—nup
(
ChªSess
 *
chª£ss
) {

175 
	`m_ä“
(
chª£ss
->
x11auth´Ù
);

176 
	`m_ä“
(
chª£ss
->
x11authcook›
);

178 
	`TRACE
(("chª£s %s", 
chª£ss
))

179 ià(
chª£ss
->
x11li¡’”
 !ğ
NULL
) {

180 
	`»move_li¡’”
(
chª£ss
->
x11li¡’”
);

181 
chª£ss
->
x11li¡’”
 = 
NULL
;

183 
	}
}

185 cÚ¡ 
ChªTy³
 
	gchª_x11
 = {

188 
NULL
,

189 
NULL
,

190 
NULL
,

191 
NULL


195 
	$£nd_msg_chªÃl_İ’_x11
(
fd
, 
sockaddr_š
* 
addr
) {

197 * 
¡ršg
 = 
NULL
;

199 ià(
	`£nd_msg_chªÃl_İ’_š™
(
fd
, &
chª_x11
è=ğ
DROPBEAR_SUCCESS
) {

200 
¡ršg
 = 
	`š‘_Áß
(
addr
->
sš_addr
);

201 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
¡ršg
, 
	`¡¾’
(ipstring));

202 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
addr
->
sš_pÜt
);

204 
	`’üy±_·ck‘
();

205  
DROPBEAR_SUCCESS
;

207  
DROPBEAR_FAILURE
;

210 
	}
}

214 
	$bšdpÜt
(
fd
) {

216 
sockaddr_š
 
addr
;

217 
ušt16_t
 
pÜt
;

219 
	`mem£t
((*)&
addr
, 0x0, (addr));

220 
addr
.
sš_çmy
 = 
AF_INET
;

221 
addr
.
sš_addr
.
s_addr
 = 
	`htÚl
(
INADDR_LOOPBACK
);

224 
pÜt
 = 
X11BINDBASE
;…ort < X11BINDBASE + 2000;…ort++) {

225 
addr
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

226 ià(
	`bšd
(
fd
, (
sockaddr
*)&
addr
,

227 (
sockaddr_š
)) == 0) {

229  
pÜt
;

231 ià(
”ºo
 =ğ
EADDRINUSE
) {

236 
	`drİb—r_log
(
LOG_DEBUG
, "Failedo bind x11 socket");

240 
	}
}

	@sysoptions.h

6 #iâdeà
DROPBEAR_VERSION


7 
	#DROPBEAR_VERSION
 "0.53.1"

	)

10 
	#LOCAL_IDENT
 "SSH-2.0-drİb—r_" 
DROPBEAR_VERSION


	)

11 
	#PROGNAME
 "drİb—r"

	)

15 #iâdeà
KEX_REKEY_TIMEOUT


16 
	#KEX_REKEY_TIMEOUT
 (3600 * 8)

	)

18 #iâdeà
KEX_REKEY_DATA


19 
	#KEX_REKEY_DATA
 (1<<30è

	)

22 #iâdeà
AUTH_TIMEOUT


23 
	#AUTH_TIMEOUT
 300

	)

27 #iâdeà
MIN_DSS_KEYLEN


28 
	#MIN_DSS_KEYLEN
 512

	)

30 #iâdeà
MIN_RSA_KEYLEN


31 
	#MIN_RSA_KEYLEN
 512

	)

34 
	#MAX_BANNER_SIZE
 2000

	)

35 
	#MAX_BANNER_LINES
 20

	)

39 
	#ENV_SIZE
 100

	)

41 
	#MAX_CMD_LEN
 1024

	)

42 
	#MAX_TERM_LEN
 200

	)

44 
	#MAX_HOST_LEN
 254

	)

45 
	#MAX_IP_LEN
 15

	)

47 
	#DROPBEAR_MAX_PORTS
 10

	)

51 
	#MAX_LISTEN_ADDR
 (
DROPBEAR_MAX_PORTS
*3)

	)

53 
	#_PATH_TTY
 "/dev/‰y"

	)

55 
	#_PATH_CP
 "/bš/ı"

	)

58 
	#DROPBEAR_SUCCESS
 0

	)

59 
	#DROPBEAR_FAILURE
 -1

	)

62 
	#DROPBEAR_KEX_DH_GROUP1
 0

	)

63 
	#DROPBEAR_KEX_DH_GROUP14
 1

	)

65 
	#DROPBEAR_SIGNKEY_ANY
 0

	)

66 
	#DROPBEAR_SIGNKEY_RSA
 1

	)

67 
	#DROPBEAR_SIGNKEY_DSS
 2

	)

68 
	#DROPBEAR_SIGNKEY_NONE
 3

	)

70 
	#DROPBEAR_COMP_NONE
 0

	)

71 
	#DROPBEAR_COMP_ZLIB
 1

	)

72 
	#DROPBEAR_COMP_ZLIB_DELAY
 2

	)

75 #ià
defšed
(
ENABLE_SVR_PUBKEY_AUTH
è|| defšed(
DROPBEAR_CLIENT
)

76 
	#DROPBEAR_SIGNKEY_VERIFY


	)

80 
	#SHA1_HASH_SIZE
 20

	)

82 
	#SHA512_HASH_SIZE
 64

	)

84 
	#MD5_HASH_SIZE
 16

	)

87 
	#MAX_MAC_LEN
 
SHA1_HASH_SIZE


	)

90 
	#MAX_KEY_LEN
 32

	)

91 
	#MAX_IV_LEN
 20

	)

93 
	#MAX_MAC_KEY
 20

	)

95 
	#MAX_NAME_LEN
 64

	)

99 
	#MAX_PROPOSED_ALGO
 20

	)

103 
	#MIN_PACKET_LEN
 16

	)

105 
	#RECV_MAX_PACKET_LEN
 (
	`MAX
(35000, ((
RECV_MAX_PAYLOAD_LEN
)+100)))

	)

108 
	#TRANS_MAX_WINDOW
 500000000

	)

109 
	#TRANS_MAX_WIN_INCR
 500000000

	)

111 
	#RECV_WINDOWEXTEND
 (
İts
.
»cv_wšdow
 / 3è

	)

113 
	#MAX_RECV_WINDOW
 (1024*1024è

	)

115 
	#MAX_CHANNELS
 100

	)

118 
	#MAX_STRING_LEN
 1400

	)

122 
	#MAX_PUBKEY_SIZE
 1700

	)

124 
	#MAX_PRIVKEY_SIZE
 1700

	)

128 
	#KEXHASHBUF_MAX_INTS
 (1700 + 130 + 130 + 130)

	)

130 
	#DROPBEAR_MAX_SOCKS
 2

	)

133 
	#DROPBEAR_MAX_CLI_PASS
 1024

	)

135 
	#DROPBEAR_MAX_CLI_INTERACT_PROMPTS
 80

	)

139 #ià
defšed
(
DROPBEAR_AES256
è|| defšed(
DROPBEAR_AES128
)

140 
	#DROPBEAR_AES


	)

143 #ià
defšed
(
DROPBEAR_TWOFISH256
è|| defšed(
DROPBEAR_TWOFISH128
)

144 
	#DROPBEAR_TWOFISH


	)

147 #iâdeà
ENABLE_X11FWD


148 
	#DISABLE_X11FWD


	)

151 #ià
defšed
(
ENABLE_CLI_REMOTETCPFWD
è|| defšed(
ENABLE_CLI_LOCALTCPFWD
)

152 
	#ENABLE_CLI_ANYTCPFWD


	)

155 #ià
defšed
(
ENABLE_CLI_LOCALTCPFWD
è|| defšed(
ENABLE_SVR_REMOTETCPFWD
)

156 
	#DROPBEAR_TCP_ACCEPT


	)

159 #ià
defšed
(
ENABLE_CLI_REMOTETCPFWD
è|| defšed(
ENABLE_CLI_LOCALTCPFWD
) || \

160 
defšed
(
ENABLE_SVR_REMOTETCPFWD
è|| defšed(
ENABLE_SVR_LOCALTCPFWD
) || \

161 
defšed
(
ENABLE_SVR_AGENTFWD
è|| 
	$defšed
(
ENABLE_X11FWD
)

162 
	#USING_LISTENERS


	)

165 #ià
	`defšed
(
ENABLE_SVR_AGENTFWD
è|| defšed(
ENABLE_CLI_LOCALTCPFWD
)

166 
	#ENABLE_AGENTFWD


	)

169 #ià
	`defšed
(
ENABLE_CLI_NETCAT
è&& defšed(
ENABLE_CLI_PROXYCMD
)

170 
	#ENABLE_CLI_MULTIHOP


	)

173 #ià
	`defšed
(
ENABLE_CLI_AGENTFWD
è|| defšed(
DROPBEAR_PRNGD_SOCKET
)

174 
	#ENABLE_CONNECT_UNIX


	)

177 #ià
	`defšed
(
DROPBEAR_CLIENT
è|| defšed(
ENABLE_SVR_PUBKEY_AUTH
)

178 
	#DROPBEAR_KEY_LINES


	)

183 
	#DROPBEAR_ZLIB_MEM_LEVEL
 8

	)

185 #ià
	`defšed
(
ENABLE_SVR_PASSWORD_AUTH
è&& defšed(
ENABLE_SVR_PAM_AUTH
)

189 #ià
	`defšed
(
DROPBEAR_RANDOM_DEV
è&& defšed(
DROPBEAR_PRNGD_SOCKET
)

193 #ià!
	`defšed
(
DROPBEAR_RANDOM_DEV
è&& !defšed(
DROPBEAR_PRNGD_SOCKET
)

199 #ià
	`defšed
(
DROPBEAR_SERVER
è&& defšed(
DROPBEAR_CLIENT
)

201 
	#IS_DROPBEAR_SERVER
 (
£s
.
is£rv”
 =ğ1)

	)

202 
	#IS_DROPBEAR_CLIENT
 (
£s
.
is£rv”
 =ğ0)

	)

204 #–ià
	`defšed
(
DROPBEAR_SERVER
)

206 
	#IS_DROPBEAR_SERVER
 1

	)

207 
	#IS_DROPBEAR_CLIENT
 0

	)

209 #–ià
	`defšed
(
DROPBEAR_CLIENT
)

211 
	#IS_DROPBEAR_SERVER
 0

	)

212 
	#IS_DROPBEAR_CLIENT
 1

	)

216 
	#IS_DROPBEAR_SERVER
 0

	)

217 
	#IS_DROPBEAR_CLIENT
 0

	)

	@tcp-accept.c

25 
	~"šşudes.h
"

26 
	~"ssh.h
"

27 
	~"tıfwd.h
"

28 
	~"dbut.h
"

29 
	~"£ssiÚ.h
"

30 
	~"bufãr.h
"

31 
	~"·ck‘.h
"

32 
	~"li¡’”.h
"

33 
	~"runİts.h
"

35 #ifdeà
DROPBEAR_TCP_ACCEPT


37 
	$ş—nup_tı
(
Li¡’”
 *
li¡’”
) {

39 
TCPLi¡’”
 *
tıšfo
 = (TCPLi¡’”*)(
li¡’”
->
ty³d©a
);

41 
	`m_ä“
(
tıšfo
->
£ndaddr
);

42 
	`m_ä“
(
tıšfo
->
li¡’addr
);

43 
	`m_ä“
(
tıšfo
);

44 
	}
}

46 
	$tı_acû±Ü
(
Li¡’”
 *
li¡’”
, 
sock
) {

48 
fd
;

49 
sockaddr_¡Üage
 
addr
;

50 
sockËn_t
 
Ën
;

51 
¡ršg
[
NI_MAXHOST
], 
pÜt¡ršg
[
NI_MAXSERV
];

52 
TCPLi¡’”
 *
tıšfo
 = (TCPLi¡’”*)(
li¡’”
->
ty³d©a
);

54 
Ën
 = (
addr
);

56 
fd
 = 
	`acû±
(
sock
, (
sockaddr
*)&
addr
, &
Ën
);

57 ià(
fd
 < 0) {

61 ià(
	`g‘Çmešfo
((
sockaddr
*)&
addr
, 
Ën
, 
¡ršg
, (ipstring),

62 
pÜt¡ršg
, (portstring),

63 
NI_NUMERICHOST
 | 
NI_NUMERICSERV
) != 0) {

67 ià(
	`£nd_msg_chªÃl_İ’_š™
(
fd
, 
tıšfo
->
chªty³
è=ğ
DROPBEAR_SUCCESS
) {

68 * 
addr
 = 
NULL
;

69 
pÜt
 = 0;

71 ià(
tıšfo
->
tı_ty³
 =ğ
dœeù
) {

74 
addr
 = 
tıšfo
->
£ndaddr
;

75 
pÜt
 = 
tıšfo
->
£ndpÜt
;

77 
	`drİb—r_as£¹
(
tıšfo
->
tı_ty³
 =ğ
fÜw¬ded
);

80 
addr
 = 
tıšfo
->
li¡’addr
;

81 
pÜt
 = 
tıšfo
->
li¡’pÜt
;

84 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
addr
, 
	`¡¾’
(addr));

85 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
pÜt
);

88 
	`buf_put¡ršg
(
£s
.
wr™•aylßd
, 
¡ršg
, 
	`¡¾’
(ipstring));

90 
	`buf_putšt
(
£s
.
wr™•aylßd
, 
	`©Ş
(
pÜt¡ršg
));

92 
	`’üy±_·ck‘
();

96 
	`şo£
(
fd
);

98 
	}
}

100 
	$li¡’_tıfwd
(
TCPLi¡’”
* 
tıšfo
) {

102 
pÜt¡ršg
[
NI_MAXSERV
];

103 
socks
[
DROPBEAR_MAX_SOCKS
];

104 
Li¡’”
 *
li¡’”
 = 
NULL
;

105 
nsocks
;

106 * 
”r¡ršg
 = 
NULL
;

108 
	`TRACE
(("enter†isten_tcpfwd"))

111 
	`¢´štf
(
pÜt¡ršg
, ÕÜt¡ršg), "%d", 
tıšfo
->
li¡’pÜt
);

113 
nsocks
 = 
	`drİb—r_li¡’
(
tıšfo
->
li¡’addr
, 
pÜt¡ršg
, 
socks
,

114 
DROPBEAR_MAX_SOCKS
, &
”r¡ršg
, &
£s
.
maxfd
);

115 ià(
nsocks
 < 0) {

116 
	`drİb—r_log
(
LOG_INFO
, "TCP fÜw¬d faed: %s", 
”r¡ršg
);

117 
	`m_ä“
(
”r¡ršg
);

118 
	`TRACE
(("leave†isten_tcpfwd: dropbear_listen failed"))

119  
DROPBEAR_FAILURE
;

121 
	`m_ä“
(
”r¡ršg
);

124 
li¡’”
 = 
	`Ãw_li¡’”
(
socks
, 
nsocks
, 
CHANNEL_ID_TCPFORWARDED
, 
tıšfo
,

125 
tı_acû±Ü
, 
ş—nup_tı
);

127 ià(
li¡’”
 =ğ
NULL
) {

128 
	`TRACE
(("leave†isten_tcpfwd:†istener failed"))

129  
DROPBEAR_FAILURE
;

132 
	`TRACE
(("leave†isten_tcpfwd: success"))

133  
DROPBEAR_SUCCESS
;

134 
	}
}

	@tcpfwd.h

24 #iâdeà
_TCPFWD_H


25 
	#_TCPFWD_H


	)

27 
	~"chªÃl.h
"

28 
	~"li¡.h
"

30 
	sTCPLi¡’”
 {

34 *
	m£ndaddr
;

35 
	m£ndpÜt
;

40 *
	mli¡’addr
;

41 
	mli¡’pÜt
;

43 cÚ¡ 
ChªTy³
 *
	mchªty³
;

44 ’um {
	mdœeù
, 
	mfÜw¬ded
} 
	mtı_ty³
;

48 
	sTCPFwdEÁry
 {

49 cÚ¡ * 
	mcÚÃùaddr
;

50 
	mcÚÃùpÜt
;

51 cÚ¡ * 
	mli¡’addr
;

52 
	mli¡’pÜt
;

53 
	mhave_»¶y
;

58 
»cv_msg_glob®_»que¡_»mÙ‘ı
();

60 cÚ¡ 
ChªTy³
 
svr_chª_tıdœeù
;

63 
£tup_loÿÉı
();

64 
£tup_»mÙ‘ı
();

65 cÚ¡ 
ChªTy³
 
şi_chª_tı»mÙe
;

66 
şi_»cv_msg_»que¡_sucûss
();

67 
şi_»cv_msg_»que¡_çu»
();

70 
li¡’_tıfwd
(
TCPLi¡’”
* 
tıšfo
);

	@termcodes.c

25 
	~"šşudes.h
"

26 
	~"‹rmcodes.h
"

28 cÚ¡ 
T”mCode
 
	g‹rmcodes
[
MAX_TERMCODE
+1] = {

31 {
VINTR
, 
TERMCODE_CONTROLCHAR
},

32 {
VQUIT
, 
TERMCODE_CONTROLCHAR
},

33 {
VERASE
, 
TERMCODE_CONTROLCHAR
},

34 {
VKILL
, 
TERMCODE_CONTROLCHAR
},

35 {
VEOF
, 
TERMCODE_CONTROLCHAR
},

36 {
VEOL
, 
TERMCODE_CONTROLCHAR
},

37 {
VEOL2
, 
TERMCODE_CONTROLCHAR
},

38 {
VSTART
, 
TERMCODE_CONTROLCHAR
},

39 {
VSTOP
, 
TERMCODE_CONTROLCHAR
},

40 {
VSUSP
, 
TERMCODE_CONTROLCHAR
},

41 #ifdeà
VDSUSP


42 {
VDSUSP
, 
TERMCODE_CONTROLCHAR
},

46 #ifdeà
VREPRINT


47 {
VREPRINT
, 
TERMCODE_CONTROLCHAR
},

51 #ifdeà
AIX


52 {
CERASE
, 
TERMCODE_CONTROLCHAR
},

54 {
VWERASE
, 
TERMCODE_CONTROLCHAR
},

56 {
VLNEXT
, 
TERMCODE_CONTROLCHAR
},

57 #ifdeà
VFLUSH


58 {
VFLUSH
, 
TERMCODE_CONTROLCHAR
},

62 #ifdeà
VSWTCH


63 {
VSWTCH
, 
TERMCODE_CONTROLCHAR
},

67 #ifdeà
VSTATUS


68 {
VSTATUS
, 
TERMCODE_CONTROLCHAR
},

72 #ifdeà
AIX


73 {
CKILL
, 
TERMCODE_CONTROLCHAR
},

74 #–ià
defšed
(
VDISCARD
)

75 {
VDISCARD
, 
TERMCODE_CONTROLCHAR
},

90 {
IGNPAR
, 
TERMCODE_INPUT
},

91 {
PARMRK
, 
TERMCODE_INPUT
},

92 {
INPCK
, 
TERMCODE_INPUT
},

93 {
ISTRIP
, 
TERMCODE_INPUT
},

94 {
INLCR
, 
TERMCODE_INPUT
},

95 {
IGNCR
, 
TERMCODE_INPUT
},

96 {
ICRNL
, 
TERMCODE_INPUT
},

97 #ifdeà
IUCLC


98 {
IUCLC
, 
TERMCODE_INPUT
},

102 {
IXON
, 
TERMCODE_INPUT
},

103 {
IXANY
, 
TERMCODE_INPUT
},

104 {
IXOFF
, 
TERMCODE_INPUT
},

105 #ifdeà
IMAXBEL


106 {
IMAXBEL
, 
TERMCODE_INPUT
},

118 {
ISIG
, 
TERMCODE_LOCAL
},

119 {
ICANON
, 
TERMCODE_LOCAL
},

120 #ifdeà
XCASE


121 {
XCASE
, 
TERMCODE_LOCAL
},

125 {
ECHO
, 
TERMCODE_LOCAL
},

126 {
ECHOE
, 
TERMCODE_LOCAL
},

127 {
ECHOK
, 
TERMCODE_LOCAL
},

128 {
ECHONL
, 
TERMCODE_LOCAL
},

129 {
NOFLSH
, 
TERMCODE_LOCAL
},

130 {
TOSTOP
, 
TERMCODE_LOCAL
},

131 {
IEXTEN
, 
TERMCODE_LOCAL
},

132 {
ECHOCTL
, 
TERMCODE_LOCAL
},

133 {
ECHOKE
, 
TERMCODE_LOCAL
},

134 #ifdeà
PENDIN


135 {
PENDIN
, 
TERMCODE_LOCAL
},

146 {
OPOST
, 
TERMCODE_OUTPUT
},

147 #ifdeà
OLCUC


148 {
OLCUC
, 
TERMCODE_OUTPUT
},

152 {
ONLCR
, 
TERMCODE_OUTPUT
},

153 #ifdeà
OCRNL


154 {
OCRNL
, 
TERMCODE_OUTPUT
},

158 #ifdeà
ONOCR


159 {
ONOCR
, 
TERMCODE_OUTPUT
},

163 #ifdeà
ONLRET


164 {
ONLRET
, 
TERMCODE_OUTPUT
},

182 {
CS7
, 
TERMCODE_CONTROL
},

183 {
CS8
, 
TERMCODE_CONTROL
},

184 {
PARENB
, 
TERMCODE_CONTROL
},

185 {
PARODD
, 
TERMCODE_CONTROL
}

	@termcodes.h

25 #iâdeà
_TERMCODES_H_


26 
	#_TERMCODES_H_


	)

28 
	#TERMCODE_NONE
 0

	)

29 
	#TERMCODE_CONTROL
 1

	)

30 
	#TERMCODE_INPUT
 2

	)

31 
	#TERMCODE_OUTPUT
 3

	)

32 
	#TERMCODE_LOCAL
 4

	)

33 
	#TERMCODE_CONTROLCHAR
 5

	)

35 
	#MAX_TERMCODE
 93

	)

37 
	sT”mCode
 {

39 
	mm­code
;

40 
	mty³
;

44 cÚ¡ 
T”mCode
 
‹rmcodes
[];

	@x11fwd.h

24 #iâdeà
_X11FWD_H_


25 
	#_X11FWD_H_


	)

26 #iâdeà
DISABLE_X11FWD


28 
	~"šşudes.h
"

29 
	~"chª£ssiÚ.h
"

30 
	~"chªÃl.h
"

32 
x11»q
(
ChªSess
 * 
chª£ss
);

33 
x11£uth
(
ChªSess
 *
chª£ss
);

34 
x11ş—nup
(
ChªSess
 *
chª£ss
);

	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/arpa/nameser.h

52 #iâdeà
_ARPA_NAMESER_H_


53 
	#_ARPA_NAMESER_H_


	)

57 
	#BIND_4_COMPAT


	)

59 
	~<sys/·¿m.h
>

60 #ià(!
defšed
(
BSD
)) || (BSD < 199306)

61 
	~<sys/b™y³s.h
>

63 
	~<sys/ty³s.h
>

65 
	~<sys/cdefs.h
>

75 
	#__NAMESER
 19991006

	)

79 
	#NS_PACKETSZ
 512

	)

80 
	#NS_MAXDNAME
 1025

	)

81 
	#NS_MAXMSG
 65535

	)

82 
	#NS_MAXCDNAME
 255

	)

83 
	#NS_MAXLABEL
 63

	)

84 
	#NS_HFIXEDSZ
 12

	)

85 
	#NS_QFIXEDSZ
 4

	)

86 
	#NS_RRFIXEDSZ
 10

	)

87 
	#NS_INT32SZ
 4

	)

88 
	#NS_INT16SZ
 2

	)

89 
	#NS_INT8SZ
 1

	)

90 
	#NS_INADDRSZ
 4

	)

91 
	#NS_IN6ADDRSZ
 16

	)

92 
	#NS_CMPRSFLGS
 0xc0

	)

93 
	#NS_DEFAULTPORT
 53

	)

98 
	e__ns_£ù
 {

99 
	mns_s_qd
 = 0,

100 
	mns_s_zn
 = 0,

101 
	mns_s_ª
 = 1,

102 
	mns_s_´
 = 1,

103 
	mns_s_ns
 = 2,

104 
	mns_s_ud
 = 2,

105 
	mns_s_¬
 = 3,

106 
	mns_s_max
 = 4

107 } 
	tns_£ù
;

114 
	s__ns_msg
 {

115 cÚ¡ 
u_ch¬
 *
	m_msg
, *
	m_eom
;

116 
u_št16_t
 
	m_id
, 
	m_æags
, 
	m_couÁs
[
ns_s_max
];

117 cÚ¡ 
u_ch¬
 *
	m_£ùiÚs
[
ns_s_max
];

118 
ns_£ù
 
	m_£ù
;

119 
	m_¼num
;

120 cÚ¡ 
u_ch¬
 *
	m_msg_±r
;

121 } 
	tns_msg
;

124 
	s_ns_æagd©a
 { 
	mmask
, 
	mshiá
; };

125 cÚ¡ 
_ns_æagd©a
 _ns_flagdata[];

129 
	#ns_msg_id
(
hªdË
è((hªdË).
_id
 + 0)

	)

130 
	#ns_msg_ba£
(
hªdË
è((hªdË).
_msg
 + 0)

	)

131 
	#ns_msg_’d
(
hªdË
è((hªdË).
_eom
 + 0)

	)

132 
	#ns_msg_size
(
hªdË
è((hªdË).
_eom
 - (hªdË).
_msg
)

	)

133 
	#ns_msg_couÁ
(
hªdË
, 
£ùiÚ
è((hªdË).
_couÁs
[£ùiÚ] + 0)

	)

138 
	s__ns_¼
 {

139 
	mÇme
[
NS_MAXDNAME
];

140 
u_št16_t
 
	mty³
;

141 
u_št16_t
 
	m¼_şass
;

142 
u_št32_t
 
	m‰l
;

143 
u_št16_t
 
	mrdËngth
;

144 cÚ¡ 
u_ch¬
 * 
	mrd©a
;

145 } 
	tns_¼
;

148 
	#ns_¼_Çme
(
¼
è((Ôr).
Çme
[0] !ğ'\0'è? (¼).Çm: ".")

	)

149 
	#ns_¼_ty³
(
¼
è((
ns_ty³
)(Ôr).
ty³
 + 0))

	)

150 
	#ns_¼_şass
(
¼
è((
ns_şass
)(Ôr).
¼_şass
 + 0))

	)

151 
	#ns_¼_‰l
(
¼
è(Ôr).
‰l
 + 0)

	)

152 
	#ns_¼_rdËn
(
¼
è(Ôr).
rdËngth
 + 0)

	)

153 
	#ns_¼_rd©a
(
¼
è(Ôr).
rd©a
 + 0)

	)

160 
	e__ns_æag
 {

161 
	mns_f_qr
,

162 
	mns_f_İcode
,

163 
	mns_f_¯
,

164 
	mns_f_tc
,

165 
	mns_f_rd
,

166 
	mns_f_¿
,

167 
	mns_f_z
,

168 
	mns_f_ad
,

169 
	mns_f_cd
,

170 
	mns_f_rcode
,

171 
	mns_f_max


172 } 
	tns_æag
;

177 
	e__ns_İcode
 {

178 
	mns_o_qu”y
 = 0,

179 
	mns_o_iqu”y
 = 1,

180 
	mns_o_¡©us
 = 2,

182 
	mns_o_nÙify
 = 4,

183 
	mns_o_upd©e
 = 5,

184 
	mns_o_max
 = 6

185 } 
	tns_İcode
;

190 
	e__ns_rcode
 {

191 
	mns_r_nÛ¼Ü
 = 0,

192 
	mns_r_fÜm”r
 = 1,

193 
	mns_r_£rvç
 = 2,

194 
	mns_r_nxdomaš
 = 3,

195 
	mns_r_nÙim¶
 = 4,

196 
	mns_r_»fu£d
 = 5,

198 
	mns_r_yxdomaš
 = 6,

199 
	mns_r_yx¼£t
 = 7,

200 
	mns_r_nx¼£t
 = 8,

201 
	mns_r_nÙauth
 = 9,

202 
	mns_r_nÙzÚe
 = 10,

203 
	mns_r_max
 = 11,

205 
	mns_r_badv”s
 = 16,

207 
	mns_r_badsig
 = 16,

208 
	mns_r_badkey
 = 17,

209 
	mns_r_badtime
 = 18

210 } 
	tns_rcode
;

213 
	e__ns_upd©e_İ”©iÚ
 {

214 
	mns_uİ_d–‘e
 = 0,

215 
	mns_uİ_add
 = 1,

216 
	mns_uİ_max
 = 2

217 } 
	tns_upd©e_İ”©iÚ
;

222 
	sns_tsig_key
 {

223 
	mÇme
[
NS_MAXDNAME
], 
	m®g
[NS_MAXDNAME];

224 *
	md©a
;

225 
	mËn
;

227 
ns_tsig_key
 
	tns_tsig_key
;

232 
	sns_tı_tsig_¡©e
 {

233 
	mcouÁ”
;

234 
d¡_key
 *
	mkey
;

235 *
	mùx
;

236 
	msig
[
NS_PACKETSZ
];

237 
	msigËn
;

239 
ns_tı_tsig_¡©e
 
	tns_tı_tsig_¡©e
;

241 
	#NS_TSIG_FUDGE
 300

	)

242 
	#NS_TSIG_TCP_COUNT
 100

	)

243 
	#NS_TSIG_ALG_HMAC_MD5
 "HMAC-MD5.SIG-ALG.REG.INT"

	)

245 
	#NS_TSIG_ERROR_NO_TSIG
 -10

	)

246 
	#NS_TSIG_ERROR_NO_SPACE
 -11

	)

247 
	#NS_TSIG_ERROR_FORMERR
 -12

	)

252 
	e__ns_ty³
 {

253 
	mns_t_šv®id
 = 0,

254 
	mns_t_a
 = 1,

255 
	mns_t_ns
 = 2,

256 
	mns_t_md
 = 3,

257 
	mns_t_mf
 = 4,

258 
	mns_t_úame
 = 5,

259 
	mns_t_sß
 = 6,

260 
	mns_t_mb
 = 7,

261 
	mns_t_mg
 = 8,

262 
	mns_t_mr
 = 9,

263 
	mns_t_nuÎ
 = 10,

264 
	mns_t_wks
 = 11,

265 
	mns_t_±r
 = 12,

266 
	mns_t_hšfo
 = 13,

267 
	mns_t_mšfo
 = 14,

268 
	mns_t_mx
 = 15,

269 
	mns_t_txt
 = 16,

270 
	mns_t_½
 = 17,

271 
	mns_t_afsdb
 = 18,

272 
	mns_t_x25
 = 19,

273 
	mns_t_isdn
 = 20,

274 
	mns_t_¹
 = 21,

275 
	mns_t_n§p
 = 22,

276 
	mns_t_n§p_±r
 = 23,

277 
	mns_t_sig
 = 24,

278 
	mns_t_key
 = 25,

279 
	mns_t_px
 = 26,

280 
	mns_t_gpos
 = 27,

281 
	mns_t_¯¯
 = 28,

282 
	mns_t_loc
 = 29,

283 
	mns_t_nxt
 = 30,

284 
	mns_t_eid
 = 31,

285 
	mns_t_nimloc
 = 32,

286 
	mns_t_¤v
 = 33,

287 
	mns_t_©ma
 = 34,

288 
	mns_t_Ç±r
 = 35,

289 
	mns_t_kx
 = 36,

290 
	mns_t_û¹
 = 37,

291 
	mns_t_a6
 = 38,

292 
	mns_t_dÇme
 = 39,

293 
	mns_t_sšk
 = 40,

294 
	mns_t_İt
 = 41,

295 
	mns_t_­l
 = 42,

296 
	mns_t_tkey
 = 249,

297 
	mns_t_tsig
 = 250,

298 
	mns_t_ixä
 = 251,

299 
	mns_t_axä
 = 252,

300 
	mns_t_mab
 = 253,

301 
	mns_t_maa
 = 254,

302 
	mns_t_ªy
 = 255,

303 
	mns_t_zxä
 = 256,

304 
	mns_t_max
 = 65536

305 } 
	tns_ty³
;

308 
	#ns_t_qt_p
(
t
è(
	`ns_t_xä_p
Ñè|| (tè=ğ
ns_t_ªy
 || \

309 (
t
è=ğ
ns_t_mab
 || (tè=ğ
ns_t_maa
)

	)

311 
	#ns_t_m¼_p
(
t
è(Ñè=ğ
ns_t_tsig
 || (tè=ğ
ns_t_İt
)

	)

313 
	#ns_t_¼_p
(
t
è(!
	`ns_t_qt_p
Ñè&& !
	`ns_t_m¼_p
Ñ))

	)

314 
	#ns_t_udp_p
(
t
è(Ñè!ğ
ns_t_axä
 && (tè!ğ
ns_t_zxä
)

	)

315 
	#ns_t_xä_p
(
t
è(Ñè=ğ
ns_t_axä
 || (tè=ğ
ns_t_ixä
 || \

316 (
t
è=ğ
ns_t_zxä
)

	)

321 
	e__ns_şass
 {

322 
	mns_c_šv®id
 = 0,

323 
	mns_c_š
 = 1,

324 
	mns_c_2
 = 2,

325 
	mns_c_chaos
 = 3,

326 
	mns_c_hs
 = 4,

328 
	mns_c_nÚe
 = 254,

329 
	mns_c_ªy
 = 255,

330 
	mns_c_max
 = 65536

331 } 
	tns_şass
;

335 
	e__ns_key_ty³s
 {

336 
	mns_kt_r§
 = 1,

337 
	mns_kt_dh
 = 2,

338 
	mns_kt_d§
 = 3,

339 
	mns_kt_´iv©e
 = 254

340 } 
	tns_key_ty³s
;

342 
	e__ns_û¹_ty³s
 {

343 
	mû¹_t_pkix
 = 1,

344 
	mû¹_t_¥ki
 = 2,

345 
	mû¹_t_pgp
 = 3,

346 
	mû¹_t_u¾
 = 253,

347 
	mû¹_t_oid
 = 254

348 } 
	tns_û¹_ty³s
;

351 
	#NS_KEY_TYPEMASK
 0xC000

	)

352 
	#NS_KEY_TYPE_AUTH_CONF
 0x0000

	)

353 
	#NS_KEY_TYPE_CONF_ONLY
 0x8000

	)

354 
	#NS_KEY_TYPE_AUTH_ONLY
 0x4000

	)

355 
	#NS_KEY_TYPE_NO_KEY
 0xC000

	)

357 
	#NS_KEY_NO_AUTH
 0x8000

	)

358 
	#NS_KEY_NO_CONF
 0x4000

	)

359 
	#NS_KEY_RESERVED2
 0x2000

	)

360 
	#NS_KEY_EXTENDED_FLAGS
 0x1000

	)

361 
	#NS_KEY_RESERVED4
 0x0800

	)

362 
	#NS_KEY_RESERVED5
 0x0400

	)

363 
	#NS_KEY_NAME_TYPE
 0x0300

	)

364 
	#NS_KEY_NAME_USER
 0x0000

	)

365 
	#NS_KEY_NAME_ENTITY
 0x0200

	)

366 
	#NS_KEY_NAME_ZONE
 0x0100

	)

367 
	#NS_KEY_NAME_RESERVED
 0x0300

	)

368 
	#NS_KEY_RESERVED8
 0x0080

	)

369 
	#NS_KEY_RESERVED9
 0x0040

	)

370 
	#NS_KEY_RESERVED10
 0x0020

	)

371 
	#NS_KEY_RESERVED11
 0x0010

	)

372 
	#NS_KEY_SIGNATORYMASK
 0x000F

	)

373 
	#NS_KEY_RESERVED_BITMASK
 ( 
NS_KEY_RESERVED2
 | \

374 
NS_KEY_RESERVED4
 | \

375 
NS_KEY_RESERVED5
 | \

376 
NS_KEY_RESERVED8
 | \

377 
NS_KEY_RESERVED9
 | \

378 
NS_KEY_RESERVED10
 | \

379 
NS_KEY_RESERVED11
 )

	)

380 
	#NS_KEY_RESERVED_BITMASK2
 0xFFFF

	)

382 
	#NS_ALG_MD5RSA
 1

	)

383 
	#NS_ALG_DH
 2

	)

384 
	#NS_ALG_DSA
 3

	)

385 
	#NS_ALG_DSS
 
NS_ALG_DSA


	)

386 
	#NS_ALG_EXPIRE_ONLY
 253

	)

387 
	#NS_ALG_PRIVATE_OID
 254

	)

390 
	#NS_KEY_PROT_TLS
 1

	)

391 
	#NS_KEY_PROT_EMAIL
 2

	)

392 
	#NS_KEY_PROT_DNSSEC
 3

	)

393 
	#NS_KEY_PROT_IPSEC
 4

	)

394 
	#NS_KEY_PROT_ANY
 255

	)

397 
	#NS_MD5RSA_MIN_BITS
 512

	)

398 
	#NS_MD5RSA_MAX_BITS
 4096

	)

400 
	#NS_MD5RSA_MAX_BYTES
 ((
NS_MD5RSA_MAX_BITS
+7/8)*2+3)

	)

402 
	#NS_MD5RSA_MAX_BASE64
 (((
NS_MD5RSA_MAX_BYTES
+2)/3)*4)

	)

403 
	#NS_MD5RSA_MIN_SIZE
 ((
NS_MD5RSA_MIN_BITS
+7)/8)

	)

404 
	#NS_MD5RSA_MAX_SIZE
 ((
NS_MD5RSA_MAX_BITS
+7)/8)

	)

406 
	#NS_DSA_SIG_SIZE
 41

	)

407 
	#NS_DSA_MIN_SIZE
 213

	)

408 
	#NS_DSA_MAX_BYTES
 405

	)

411 
	#NS_SIG_TYPE
 0

	)

412 
	#NS_SIG_ALG
 2

	)

413 
	#NS_SIG_LABELS
 3

	)

414 
	#NS_SIG_OTTL
 4

	)

415 
	#NS_SIG_EXPIR
 8

	)

416 
	#NS_SIG_SIGNED
 12

	)

417 
	#NS_SIG_FOOT
 16

	)

418 
	#NS_SIG_SIGNER
 18

	)

420 
	#NS_NXT_BITS
 8

	)

421 
	#NS_NXT_BIT_SET
Ğ
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] |ğ(0x80>>(Ò)%NS_NXT_BITS)))

	)

422 
	#NS_NXT_BIT_CLEAR
(
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] &ğ~(0x80>>(Ò)%NS_NXT_BITS)))

	)

423 
	#NS_NXT_BIT_ISSET
(
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] & (0x80>>(Ò)%NS_NXT_BITS)))

	)

424 
	#NS_NXT_MAX
 127

	)

429 
	#NS_OPT_DNSSEC_OK
 0x8000U

	)

430 
	#NS_OPT_NSID
 3

	)

435 
	#NS_GET16
(
s
, 
ı
) do { \

436 cÚ¡ 
u_ch¬
 *
t_ı
 = (cÚ¡ u_ch¬ *)(
ı
); \

437 (
s
èğ((
u_št16_t
)
t_ı
[0] << 8) \

438 | ((
u_št16_t
)
t_ı
[1]) \

440 (
ı
è+ğ
NS_INT16SZ
; \

441 } 0)

	)

443 
	#NS_GET32
(
l
, 
ı
) do { \

444 cÚ¡ 
u_ch¬
 *
t_ı
 = (cÚ¡ u_ch¬ *)(
ı
); \

445 (
l
èğ((
u_št32_t
)
t_ı
[0] << 24) \

446 | ((
u_št32_t
)
t_ı
[1] << 16) \

447 | ((
u_št32_t
)
t_ı
[2] << 8) \

448 | ((
u_št32_t
)
t_ı
[3]) \

450 (
ı
è+ğ
NS_INT32SZ
; \

451 } 0)

	)

453 
	#NS_PUT16
(
s
, 
ı
) do { \

454 
u_št16_t
 
t_s
 = (u_št16_t)(
s
); \

455 
u_ch¬
 *
t_ı
 = (u_ch¬ *)(
ı
); \

456 *
t_ı
++ = 
t_s
 >> 8; \

457 *
t_ı
 = 
t_s
; \

458 (
ı
è+ğ
NS_INT16SZ
; \

459 } 0)

	)

461 
	#NS_PUT32
(
l
, 
ı
) do { \

462 
u_št32_t
 
t_l
 = (u_št32_t)(
l
); \

463 
u_ch¬
 *
t_ı
 = (u_ch¬ *)(
ı
); \

464 *
t_ı
++ = 
t_l
 >> 24; \

465 *
t_ı
++ = 
t_l
 >> 16; \

466 *
t_ı
++ = 
t_l
 >> 8; \

467 *
t_ı
 = 
t_l
; \

468 (
ı
è+ğ
NS_INT32SZ
; \

469 } 0)

	)

471 
__BEGIN_DECLS


472 
	$ns_msg_g‘æag
 (
ns_msg
, è
__THROW
;

473 
u_št
 
	$ns_g‘16
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

474 
u_lÚg
 
	$ns_g‘32
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

475 
	$ns_put16
 (
u_št
, 
u_ch¬
 *è
__THROW
;

476 
	$ns_put32
 (
u_lÚg
, 
u_ch¬
 *è
__THROW
;

477 
	$ns_š™·r£
 (cÚ¡ 
u_ch¬
 *, , 
ns_msg
 *è
__THROW
;

478 
	$ns_sk¼
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
ns_£ù
, )

479 
__THROW
;

480 
	$ns_·r£¼
 (
ns_msg
 *, 
ns_£ù
, , 
ns_¼
 *è
__THROW
;

481 
	$ns_¥ršŒr
 (cÚ¡ 
ns_msg
 *, cÚ¡ 
ns_¼
 *,

482 cÚ¡ *, cÚ¡ *, *, 
size_t
)

483 
__THROW
;

484 
	$ns_¥ršŒrf
 (cÚ¡ 
u_ch¬
 *, 
size_t
, const *,

485 
ns_şass
, 
ns_ty³
, 
u_lÚg
, cÚ¡ 
u_ch¬
 *,

486 
size_t
, const *, const *,

487 *, 
size_t
è
__THROW
;

488 
	$ns_fÜm©_‰l
 (
u_lÚg
, *, 
size_t
è
__THROW
;

489 
	$ns_·r£_‰l
 (cÚ¡ *, 
u_lÚg
 *è
__THROW
;

490 
u_št32_t
 
	$ns_d©‘o£cs
 (cÚ¡ *, *è
__THROW
;

491 
	$ns_Çme_ÁŞ
 (cÚ¡ 
u_ch¬
 *, u_ch¬ *, 
size_t
è
__THROW
;

492 
	$ns_Çme_Áİ
 (cÚ¡ 
u_ch¬
 *, *, 
size_t
è
__THROW
;

493 
	$ns_Çme_±Ú
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
è
__THROW
;

494 
	$ns_Çme_uÅack
 (cÚ¡ 
u_ch¬
 *, const u_char *,

495 cÚ¡ 
u_ch¬
 *, u_ch¬ *, 
size_t
è
__THROW
;

496 
	$ns_Çme_·ck
 (cÚ¡ 
u_ch¬
 *, u_char *, ,

497 cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ **è
__THROW
;

498 
	$ns_Çme_uncom´ess
 (cÚ¡ 
u_ch¬
 *, const u_char *,

499 cÚ¡ 
u_ch¬
 *, *, 
size_t
è
__THROW
;

500 
	$ns_Çme_com´ess
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
,

501 cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ **è
__THROW
;

502 
	$ns_Çme_sk
 (cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ *è
__THROW
;

503 
	$ns_Çme_rŞlback
 (cÚ¡ 
u_ch¬
 *, const u_char **,

504 cÚ¡ 
u_ch¬
 **è
__THROW
;

505 
	$ns_sign
 (
u_ch¬
 *, *, , , *,

506 cÚ¡ 
u_ch¬
 *, , u_ch¬ *, *, 
time_t
è
__THROW
;

507 
	$ns_sign2
 (
u_ch¬
 *, *, , , *,

508 cÚ¡ 
u_ch¬
 *, , u_ch¬ *, *, 
time_t
,

509 
u_ch¬
 **, u_ch¬ **è
__THROW
;

510 
	$ns_sign_tı
 (
u_ch¬
 *, *, , ,

511 
ns_tı_tsig_¡©e
 *, è
__THROW
;

512 
	$ns_sign_tı2
 (
u_ch¬
 *, *, , ,

513 
ns_tı_tsig_¡©e
 *, ,

514 
u_ch¬
 **, u_ch¬ **è
__THROW
;

515 
	$ns_sign_tı_š™
 (*, cÚ¡ 
u_ch¬
 *, ,

516 
ns_tı_tsig_¡©e
 *è
__THROW
;

517 
u_ch¬
 *
	$ns_fšd_tsig
 (
u_ch¬
 *, u_ch¬ *è
__THROW
;

518 
	$ns_v”ify
 (
u_ch¬
 *, *, *, const u_char *, ,

519 
u_ch¬
 *, *, 
time_t
 *, è
__THROW
;

520 
	$ns_v”ify_tı
 (
u_ch¬
 *, *, 
ns_tı_tsig_¡©e
 *, )

521 
__THROW
;

522 
	$ns_v”ify_tı_š™
 (*, cÚ¡ 
u_ch¬
 *, ,

523 
ns_tı_tsig_¡©e
 *è
__THROW
;

524 
	$ns_§medomaš
 (cÚ¡ *, cÚ¡ *è
__THROW
;

525 
	$ns_subdomaš
 (cÚ¡ *, cÚ¡ *è
__THROW
;

526 
	$ns_makeÿnÚ
 (cÚ¡ *, *, 
size_t
è
__THROW
;

527 
	$ns_§m’ame
 (cÚ¡ *, cÚ¡ *è
__THROW
;

528 
__END_DECLS


530 #ifdeà
BIND_4_COMPAT


531 
	~<¬·/Çme£r_com·t.h
>

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (
	`__STRING
(
ex´
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


120 #undeà
¡©ic_as£¹


121 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/crypt.h

24 #iâdeà
_CRYPT_H


25 
	#_CRYPT_H
 1

	)

27 
	~<ã©u»s.h
>

29 
__BEGIN_DECLS


32 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

33 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

36 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

40 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

41 
__THROW
 
	`__nÚnuÎ
 ((1));

43 #ifdeà
__USE_GNU


46 
	süy±_d©a


48 
keysched
[16 * 8];

49 
sb0
[32768];

50 
sb1
[32768];

51 
sb2
[32768];

52 
sb3
[32768];

54 
üy±_3_buf
[14];

55 
cu¼’t_§É
[2];

56 
cu¼’t_§Éb™s
;

57 
dœeùiÚ
, 
š™Ÿlized
;

60 *
	$üy±_r
 (cÚ¡ *
__key
, cÚ¡ *
__§É
,

61 
üy±_d©a
 * 
__»¡riù
 
__d©a
)

62 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

64 
	$£tkey_r
 (cÚ¡ *
__key
,

65 
üy±_d©a
 * 
__»¡riù
 
__d©a
)

66 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

68 
	$’üy±_r
 (*
__glibc_block
, 
__edæag
,

69 
üy±_d©a
 * 
__»¡riù
 
__d©a
)

70 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

73 
__END_DECLS


	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/dirent.h

22 #iâdef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdeà
__USE_XOPEN


32 #iâdeà
__šo_t_defšed


33 #iâdeà
__USE_FILE_OFFSET64


34 
__šo_t
 
	tšo_t
;

36 
__šo64_t
 
	tšo_t
;

38 
	#__šo_t_defšed


	)

40 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


41 
__šo64_t
 
	tšo64_t
;

42 
	#__šo64_t_defšed


	)

61 
	~<b™s/dœ’t.h
>

63 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
è&& !defšed 
d_f’o


64 
	#d_šo
 
d_f’o


	)

81 #ifdeà
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

86 #ifdeà
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

95 #ifdeà
__USE_BSD


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

121 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

127 
__dœ¡»am
 
	tDIR
;

134 
DIR
 *
	$İ’dœ
 (cÚ¡ *
__Çme
è
	`__nÚnuÎ
 ((1));

136 #ifdeà
__USE_XOPEN2K8


141 
DIR
 *
	`fdİ’dœ
 (
__fd
);

149 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

161 #iâdeà
__USE_FILE_OFFSET64


162 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

164 #ifdeà
__REDIRECT


165 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

166 
	`__nÚnuÎ
 ((1));

168 
	#»addœ
 
»addœ64


	)

172 #ifdeà
__USE_LARGEFILE64


173 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

176 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


182 #iâdeà
__USE_FILE_OFFSET64


183 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

184 
dœ’t
 *
__»¡riù
 
__’Œy
,

185 
dœ’t
 **
__»¡riù
 
__»suÉ
)

186 
	`__nÚnuÎ
 ((1, 2, 3));

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
»addœ_r
,

190 (
DIR
 *
__»¡riù
 
__dœp
,

191 
dœ’t
 *
__»¡riù
 
__’Œy
,

192 
dœ’t
 **
__»¡riù
 
__»suÉ
),

193 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

195 
	#»addœ_r
 
»addœ64_r


	)

199 #ifdeà
__USE_LARGEFILE64


200 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

201 
dœ’t64
 *
__»¡riù
 
__’Œy
,

202 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

203 
	`__nÚnuÎ
 ((1, 2, 3));

208 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

210 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


211 
	~<b™s/ty³s.h
>

214 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

217 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

220 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN2K8


223 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


226 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

229 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__Ãed_size_t


	)

244 
	~<¡ddef.h
>

253 #iâdeà
__USE_FILE_OFFSET64


254 
	`sÿndœ
 (cÚ¡ *
__»¡riù
 
__dœ
,

255 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

256 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

257 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

258 cÚ¡ 
dœ’t
 **))

259 
	`__nÚnuÎ
 ((1, 2));

261 #ifdeà
__REDIRECT


262 
	`__REDIRECT
 (
sÿndœ
,

263 (cÚ¡ *
__»¡riù
 
__dœ
,

264 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

265 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

266 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

267 cÚ¡ 
dœ’t
 **)),

268 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

270 
	#sÿndœ
 
sÿndœ64


	)

274 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


277 
	`sÿndœ64
 (cÚ¡ *
__»¡riù
 
__dœ
,

278 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

279 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

280 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

281 cÚ¡ 
dœ’t64
 **))

282 
	`__nÚnuÎ
 ((1, 2));

285 #ifdeà
__USE_GNU


291 #iâdeà
__USE_FILE_OFFSET64


292 
	`sÿndœ©
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

293 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

294 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

295 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

296 cÚ¡ 
dœ’t
 **))

297 
	`__nÚnuÎ
 ((2, 3));

299 #ifdeà
__REDIRECT


300 
	`__REDIRECT
 (
sÿndœ©
,

301 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

302 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

303 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

304 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

305 cÚ¡ 
dœ’t
 **)),

306 
sÿndœ©64
è
	`__nÚnuÎ
 ((2, 3));

308 
	#sÿndœ©
 
sÿndœ©64


	)

314 
	`sÿndœ©64
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

315 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

316 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

317 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

318 cÚ¡ 
dœ’t64
 **))

319 
	`__nÚnuÎ
 ((2, 3));

323 #iâdeà
__USE_FILE_OFFSET64


324 
	$®phasÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

325 cÚ¡ 
dœ’t
 **
__e2
)

326 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

328 #ifdeà
__REDIRECT


329 
	`__REDIRECT_NTH
 (
®phasÜt
,

330 (cÚ¡ 
dœ’t
 **
__e1
,

331 cÚ¡ 
dœ’t
 **
__e2
),

332 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

334 
	#®phasÜt
 
®phasÜt64


	)

338 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


339 
	$®phasÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

340 cÚ¡ 
dœ’t64
 **
__e2
)

341 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

346 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


351 #iâdeà
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

353 
size_t
 
__nby‹s
,

354 
__off_t
 *
__»¡riù
 
__ba£p
)

355 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

357 #ifdeà
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

359 (
__fd
, *
__»¡riù
 
__buf
,

360 
size_t
 
__nby‹s
,

361 
__off64_t
 *
__»¡riù
 
__ba£p
),

362 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

364 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

368 #ifdeà
__USE_LARGEFILE64


369 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

370 
size_t
 
__nby‹s
,

371 
__off64_t
 *
__»¡riù
 
__ba£p
)

372 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

376 #ifdeà
__USE_GNU


378 #iâdeà
__USE_FILE_OFFSET64


379 
	$v”siÚsÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

380 cÚ¡ 
dœ’t
 **
__e2
)

381 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

383 #ifdeà
__REDIRECT


384 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

385 (cÚ¡ 
dœ’t
 **
__e1
,

386 cÚ¡ 
dœ’t
 **
__e2
),

387 
v”siÚsÜt64
)

388 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

390 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

394 #ifdeà
__USE_LARGEFILE64


395 
	$v”siÚsÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

396 cÚ¡ 
dœ’t64
 **
__e2
)

397 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

401 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_BSD
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


26 #iâdef 
__Ãed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 
	~<b™s/”ºo.h
>

36 #undeà
__Ãed_Em©h


38 #ifdef 
_ERRNO_H


45 #iâdef 
”ºo


46 
”ºo
;

49 #ifdeà
__USE_GNU


54 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

58 
	g__END_DECLS


66 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


67 #iâdeà
__”rÜ_t_defšed


68 
	t”rÜ_t
;

69 
	#__”rÜ_t_defšed
 1

	)

71 #undeà
__Ãed_”rÜ_t


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

40 #iâdeà
__mode_t_defšed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_defšed


	)

45 #iâdeà
__off_t_defšed


46 #iâdeà
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_defšed


	)

59 #iâdeà
__pid_t_defšed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_defšed


	)

65 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


66 
	#__Ãed_time¥ec


	)

67 
	~<time.h
>

68 
	~<b™s/¡©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifdeà
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifdeà
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #iâdeà
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
fú
 (
__fd
, 
__cmd
, ...);

145 #iâdeà
__USE_FILE_OFFSET64


146 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

148 #ifdeà
__REDIRECT


149 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

150 
	`__nÚnuÎ
 ((1));

152 
	#İ’
 
İ’64


	)

155 #ifdeà
__USE_LARGEFILE64


156 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__USE_ATFILE


169 #iâdeà
__USE_FILE_OFFSET64


170 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

171 
	`__nÚnuÎ
 ((2));

173 #ifdeà
__REDIRECT


174 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

175 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

177 
	#İ’©
 
İ’©64


	)

180 #ifdeà
__USE_LARGEFILE64


181 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

191 #iâdeà
__USE_FILE_OFFSET64


192 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

194 #ifdeà
__REDIRECT


195 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

196 
ü—t64
è
	`__nÚnuÎ
 ((1));

198 
	#ü—t
 
ü—t64


	)

201 #ifdeà
__USE_LARGEFILE64


202 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

206 && !
defšed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #iâdeà
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

223 #ifdeà
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifdeà
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

234 #ifdeà
__USE_XOPEN2K


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

239 
__advi£
è
__THROW
;

241 #ifdeà
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Ën
, 
__advi£
),

244 
posix_çdvi£64
);

246 
	#posix_çdvi£
 
posix_çdvi£64


	)

249 #ifdeà
__USE_LARGEFILE64


250 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

251 
__advi£
è
__THROW
;

259 #iâdeà
__USE_FILE_OFFSET64


260 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

262 #ifdeà
__REDIRECT


263 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Ën
),

265 
posix_çÎoÿ‹64
);

267 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

270 #ifdeà
__USE_LARGEFILE64


271 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

277 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

278 && 
defšed
 
__va_¬g_·ck_Ën


279 
	~<b™s/fú2.h
>

282 
__END_DECLS


	@/usr/include/glob.h

18 #iâdef 
_GLOB_H


19 
	#_GLOB_H
 1

	)

21 
	~<sys/cdefs.h
>

23 
	g__BEGIN_DECLS


26 #iâdeà
__size_t


27 
__SIZE_TYPE__
 
	t__size_t
;

28 #ià
defšed
 
__USE_XOPEN
 || 
__USE_XOPEN2K8


29 
__SIZE_TYPE__
 
	tsize_t
;

34 #undeà
__size_t


35 
	#__size_t
 
size_t


	)

39 
	#GLOB_ERR
 (1 << 0)

	)

40 
	#GLOB_MARK
 (1 << 1)

	)

41 
	#GLOB_NOSORT
 (1 << 2)

	)

42 
	#GLOB_DOOFFS
 (1 << 3)

	)

43 
	#GLOB_NOCHECK
 (1 << 4)

	)

44 
	#GLOB_APPEND
 (1 << 5)

	)

45 
	#GLOB_NOESCAPE
 (1 << 6)

	)

46 
	#GLOB_PERIOD
 (1 << 7)

	)

48 #ià!
defšed
 
__USE_POSIX2
 || defšed 
__USE_BSD
 || defšed 
__USE_GNU


49 
	#GLOB_MAGCHAR
 (1 << 8)

	)

50 
	#GLOB_ALTDIRFUNC
 (1 << 9)

	)

51 
	#GLOB_BRACE
 (1 << 10)

	)

52 
	#GLOB_NOMAGIC
 (1 << 11)

	)

53 
	#GLOB_TILDE
 (1 << 12)

	)

54 
	#GLOB_ONLYDIR
 (1 << 13)

	)

55 
	#GLOB_TILDE_CHECK
 (1 << 14)

	)

57 
	#__GLOB_FLAGS
 (
GLOB_ERR
|
GLOB_MARK
|
GLOB_NOSORT
|
GLOB_DOOFFS
| \

58 
GLOB_NOESCAPE
|
GLOB_NOCHECK
|
GLOB_APPEND
| \

59 
GLOB_PERIOD
|
GLOB_ALTDIRFUNC
|
GLOB_BRACE
| \

60 
GLOB_NOMAGIC
|
GLOB_TILDE
|
GLOB_ONLYDIR
|
GLOB_TILDE_CHECK
)

	)

62 
	#__GLOB_FLAGS
 (
GLOB_ERR
|
GLOB_MARK
|
GLOB_NOSORT
|
GLOB_DOOFFS
| \

63 
GLOB_NOESCAPE
|
GLOB_NOCHECK
|
GLOB_APPEND
| \

64 
GLOB_PERIOD
)

	)

68 
	#GLOB_NOSPACE
 1

	)

69 
	#GLOB_ABORTED
 2

	)

70 
	#GLOB_NOMATCH
 3

	)

71 
	#GLOB_NOSYS
 4

	)

72 #ifdeà
__USE_GNU


75 
	#GLOB_ABEND
 
GLOB_ABORTED


	)

79 #ifdeà
__USE_GNU


80 
	g¡©
;

84 
__size_t
 
	mgl_·thc
;

85 **
	mgl_·thv
;

86 
__size_t
 
	mgl_offs
;

87 
	mgl_æags
;

91 (*
	mgl_şo£dœ
) (*);

92 #ifdeà
__USE_GNU


93 
	mdœ’t
 *(*
	mgl_»addœ
) (*);

95 *(*
	mgl_»addœ
) (*);

97 *(*
	mgl_İ’dœ
) (const *);

98 #ifdeà
__USE_GNU


99 (*
	mgl_l¡©
è(cÚ¡ *
	m__»¡riù
, 
¡©
 *__restrict);

100 (*
	mgl_¡©
è(cÚ¡ *
	m__»¡riù
, 
¡©
 *__restrict);

102 (*
	mgl_l¡©
è(cÚ¡ *
	m__»¡riù
, *__restrict);

103 (*
	mgl_¡©
è(cÚ¡ *
	m__»¡riù
, *__restrict);

105 } 
	tglob_t
;

107 #ifdeà
__USE_LARGEFILE64


108 #ifdeà
__USE_GNU


109 
	g¡©64
;

113 
__size_t
 
	mgl_·thc
;

114 **
	mgl_·thv
;

115 
__size_t
 
	mgl_offs
;

116 
	mgl_æags
;

120 (*
	mgl_şo£dœ
) (*);

121 #ifdeà
__USE_GNU


122 
	mdœ’t64
 *(*
	mgl_»addœ
) (*);

124 *(*
	mgl_»addœ
) (*);

126 *(*
	mgl_İ’dœ
) (const *);

127 #ifdeà
__USE_GNU


128 (*
	mgl_l¡©
è(cÚ¡ *
	m__»¡riù
, 
¡©64
 *__restrict);

129 (*
	mgl_¡©
è(cÚ¡ *
	m__»¡riù
, 
¡©64
 *__restrict);

131 (*
	mgl_l¡©
è(cÚ¡ *
	m__»¡riù
, *__restrict);

132 (*
	mgl_¡©
è(cÚ¡ *
	m__»¡riù
, *__restrict);

134 } 
	tglob64_t
;

145 #ià!
defšed
 
__USE_FILE_OFFSET64


146 
glob
 (cÚ¡ *
__»¡riù
 
__·‰”n
, 
__æags
,

147 (*
__”rfunc
) (const *, ),

148 
glob_t
 *
__»¡riù
 
__pglob
è
__THROW
;

151 
	$globä“
 (
glob_t
 *
__pglob
è
__THROW
;

153 
	`__REDIRECT_NTH
 (
glob
, (cÚ¡ *
__»¡riù
 
__·‰”n
,

154 
__æags
,

155 (*
__”rfunc
) (const *, ),

156 
glob_t
 *
__»¡riù
 
__pglob
), 
glob64
);

158 
	`__REDIRECT_NTH
 (
globä“
, (
glob_t
 *
__pglob
), 
globä“64
);

161 #ifdeà
__USE_LARGEFILE64


162 
	`glob64
 (cÚ¡ *
__»¡riù
 
__·‰”n
, 
__æags
,

163 (*
__”rfunc
) (const *, ),

164 
glob64_t
 *
__»¡riù
 
__pglob
è
__THROW
;

166 
	$globä“64
 (
glob64_t
 *
__pglob
è
__THROW
;

170 #ifdeà
__USE_GNU


176 
	$glob_·‰”n_p
 (cÚ¡ *
__·‰”n
, 
__quÙe
è
__THROW
;

179 
__END_DECLS


	@/usr/include/grp.h

22 #iâdef 
_GRP_H


23 
	#_GRP_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 
	#__Ãed_size_t


	)

32 
	~<¡ddef.h
>

36 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K
è&& !defšed 
__gid_t_defšed


37 
__gid_t
 
	tgid_t
;

38 
	#__gid_t_defšed


	)

42 
	sgroup


44 *
	mgr_Çme
;

45 *
	mgr_·sswd
;

46 
__gid_t
 
	mgr_gid
;

47 **
	mgr_mem
;

51 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_GNU


52 
	#__Ãed_FILE


	)

53 
	~<¡dio.h
>

57 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


62 
£tg»Á
 ();

65 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

66 || 
defšed
 
__USE_XOPEN2K8


71 
’dg»Á
 ();

77 
group
 *
g‘g»Á
 ();

80 #ifdef 
__USE_SVID


87 
group
 *
fg‘g»Á
 (
FILE
 *
__¡»am
);

90 #ifdeà
__USE_GNU


97 
putg»Á
 (cÚ¡ 
group
 *
__»¡riù
 
__p
,

98 
FILE
 *
__»¡riù
 
__f
);

105 
group
 *
g‘grgid
 (
__gid_t
 
__gid
);

111 
group
 *
g‘gºam
 (cÚ¡ *
__Çme
);

113 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


115 #ifdeà
__USE_MISC


118 
	#NSS_BUFLEN_GROUP
 1024

	)

134 #ifdeà
__USE_GNU


135 
g‘g»Á_r
 (
group
 *
__»¡riù
 
__»suÉbuf
,

136 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

137 
group
 **
__»¡riù
 
__»suÉ
);

144 
g‘grgid_r
 (
__gid_t
 
__gid
, 
group
 *
__»¡riù
 
__»suÉbuf
,

145 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

146 
group
 **
__»¡riù
 
__»suÉ
);

152 
g‘gºam_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

153 
group
 *
__»¡riù
 
__»suÉbuf
,

154 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

155 
group
 **
__»¡riù
 
__»suÉ
);

157 #ifdef 
__USE_SVID


165 
fg‘g»Á_r
 (
FILE
 *
__»¡riù
 
__¡»am
,

166 
group
 *
__»¡riù
 
__»suÉbuf
,

167 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

168 
group
 **
__»¡riù
 
__»suÉ
);

174 #ifdef 
__USE_BSD


176 
	#__Ãed_size_t


	)

177 
	~<¡ddef.h
>

180 
	$£tgroups
 (
size_t
 
__n
, cÚ¡ 
__gid_t
 *
__groups
è
__THROW
;

190 
	`g‘grou¶i¡
 (cÚ¡ *
__u£r
, 
__gid_t
 
__group
,

191 
__gid_t
 *
__groups
, *
__ngroups
);

201 
	`š™groups
 (cÚ¡ *
__u£r
, 
__gid_t
 
__group
);

205 
__END_DECLS


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/lastlog.h

4 
	~<utmp.h
>

	@/usr/include/libgen.h

18 #iâdeà
_LIBGEN_H


19 
	#_LIBGEN_H
 1

	)

21 
	~<ã©u»s.h
>

23 
__BEGIN_DECLS


26 *
	$dœÇme
 (*
__·th
è
__THROW
;

34 *
	$__xpg_ba£Çme
 (*
__·th
è
__THROW
;

35 
	#ba£Çme
 
__xpg_ba£Çme


	)

37 
__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<ã©u»s.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

41 #iâdeà
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<b™s/wÜdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifdeà
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #ià
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #ià
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifdeà
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


123 #šşude_Ãxˆ<
lim™s
.
h
>

129 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


130 #iâdeà
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #iâdeà
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #iâdeà
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<b™s/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<b™s/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<b™s/xİ’_lim.h
>

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/ty³s.h
>

23 
	~<lšux/sock‘.h
>

26 
	#IFNAMSIZ
 16

	)

27 
	#IFALIASZ
 256

	)

28 
	~<lšux/hdlc/ioùl.h
>

31 
	#IFF_UP
 0x1

	)

32 
	#IFF_BROADCAST
 0x2

	)

33 
	#IFF_DEBUG
 0x4

	)

34 
	#IFF_LOOPBACK
 0x8

	)

35 
	#IFF_POINTOPOINT
 0x10

	)

36 
	#IFF_NOTRAILERS
 0x20

	)

37 
	#IFF_RUNNING
 0x40

	)

38 
	#IFF_NOARP
 0x80

	)

39 
	#IFF_PROMISC
 0x100

	)

40 
	#IFF_ALLMULTI
 0x200

	)

42 
	#IFF_MASTER
 0x400

	)

43 
	#IFF_SLAVE
 0x800

	)

45 
	#IFF_MULTICAST
 0x1000

	)

47 
	#IFF_PORTSEL
 0x2000

	)

48 
	#IFF_AUTOMEDIA
 0x4000

	)

49 
	#IFF_DYNAMIC
 0x8000

	)

51 
	#IFF_LOWER_UP
 0x10000

	)

52 
	#IFF_DORMANT
 0x20000

	)

54 
	#IFF_ECHO
 0x40000

	)

56 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

57 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

60 
	#IFF_802_1Q_VLAN
 0x1

	)

61 
	#IFF_EBRIDGE
 0x2

	)

62 
	#IFF_SLAVE_INACTIVE
 0x4

	)

63 
	#IFF_MASTER_8023AD
 0x8

	)

64 
	#IFF_MASTER_ALB
 0x10

	)

65 
	#IFF_BONDING
 0x20

	)

66 
	#IFF_SLAVE_NEEDARP
 0x40

	)

67 
	#IFF_ISATAP
 0x80

	)

68 
	#IFF_MASTER_ARPMON
 0x100

	)

69 
	#IFF_WAN_HDLC
 0x200

	)

70 
	#IFF_XMIT_DST_RELEASE
 0x400

	)

73 
	#IFF_DONT_BRIDGE
 0x800

	)

74 
	#IFF_DISABLE_NETPOLL
 0x1000

	)

75 
	#IFF_MACVLAN_PORT
 0x2000

	)

76 
	#IFF_BRIDGE_PORT
 0x4000

	)

77 
	#IFF_OVS_DATAPATH
 0x8000

	)

79 
	#IFF_TX_SKB_SHARING
 0x10000

	)

81 
	#IFF_UNICAST_FLT
 0x20000

	)

82 
	#IFF_TEAM_PORT
 0x40000

	)

83 
	#IFF_SUPP_NOFCS
 0x80000

	)

84 
	#IFF_LIVE_ADDR_CHANGE
 0x100000

	)

86 
	#IFF_MACVLAN
 0x200000

	)

89 
	#IF_GET_IFACE
 0x0001

	)

90 
	#IF_GET_PROTO
 0x0002

	)

93 
	#IF_IFACE_V35
 0x1000

	)

94 
	#IF_IFACE_V24
 0x1001

	)

95 
	#IF_IFACE_X21
 0x1002

	)

96 
	#IF_IFACE_T1
 0x1003

	)

97 
	#IF_IFACE_E1
 0x1004

	)

98 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

99 
	#IF_IFACE_X21D
 0x1006

	)

102 
	#IF_PROTO_HDLC
 0x2000

	)

103 
	#IF_PROTO_PPP
 0x2001

	)

104 
	#IF_PROTO_CISCO
 0x2002

	)

105 
	#IF_PROTO_FR
 0x2003

	)

106 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

107 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

108 
	#IF_PROTO_X25
 0x2006

	)

109 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

110 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

111 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

112 
	#IF_PROTO_FR_PVC
 0x200A

	)

113 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

114 
	#IF_PROTO_RAW
 0x200C

	)

118 
	mIF_OPER_UNKNOWN
,

119 
	mIF_OPER_NOTPRESENT
,

120 
	mIF_OPER_DOWN
,

121 
	mIF_OPER_LOWERLAYERDOWN
,

122 
	mIF_OPER_TESTING
,

123 
	mIF_OPER_DORMANT
,

124 
	mIF_OPER_UP
,

129 
	mIF_LINK_MODE_DEFAULT
,

130 
	mIF_LINK_MODE_DORMANT
,

143 
	sifm­
 {

144 
	mmem_¡¬t
;

145 
	mmem_’d
;

146 
	mba£_addr
;

147 
	mœq
;

148 
	mdma
;

149 
	mpÜt
;

153 
	sif_£‰šgs
 {

154 
	mty³
;

155 
	msize
;

158 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

159 
cisco_´Ùo
 *
	mcisco
;

160 
ä_´Ùo
 *
	mä
;

161 
ä_´Ùo_pvc
 *
	mä_pvc
;

162 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

165 
sync_£rŸl_£‰šgs
 *
	msync
;

166 
‹1_£‰šgs
 *
	m‹1
;

167 } 
	mifs_ifsu
;

177 
	siäeq
 {

178 
	#IFHWADDRLEN
 6

	)

181 
	miän_Çme
[
IFNAMSIZ
];

182 } 
	miä_iän
;

185 
sockaddr
 
	miäu_addr
;

186 
sockaddr
 
	miäu_d¡addr
;

187 
sockaddr
 
	miäu_brßdaddr
;

188 
sockaddr
 
	miäu_Ãtmask
;

189 
sockaddr
 
	miäu_hwaddr
;

190 
	miäu_æags
;

191 
	miäu_iv®ue
;

192 
	miäu_mtu
;

193 
ifm­
 
	miäu_m­
;

194 
	miäu_¦ave
[
IFNAMSIZ
];

195 
	miäu_ÃwÇme
[
IFNAMSIZ
];

196 * 
	miäu_d©a
;

197 
if_£‰šgs
 
	miäu_£‰šgs
;

198 } 
	miä_iäu
;

201 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

202 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

203 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

204 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

205 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

206 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

207 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

208 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

209 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

210 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

211 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

212 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

213 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

214 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

215 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

216 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

217 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

226 
	sifcÚf
 {

227 
	mifc_Ën
;

229 *
	mifcu_buf
;

230 
iäeq
 *
	mifcu_»q
;

231 } 
	mifc_ifcu
;

233 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

234 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_tun.h

16 #iâdeà
__IF_TUN_H


17 
	#__IF_TUN_H


	)

19 
	~<lšux/ty³s.h
>

20 
	~<lšux/if_‘h”.h
>

21 
	~<lšux/f‹r.h
>

24 
	#TUN_READQ_SIZE
 500

	)

27 
	#TUN_TUN_DEV
 0x0001

	)

28 
	#TUN_TAP_DEV
 0x0002

	)

29 
	#TUN_TYPE_MASK
 0x000f

	)

31 
	#TUN_FASYNC
 0x0010

	)

32 
	#TUN_NOCHECKSUM
 0x0020

	)

33 
	#TUN_NO_PI
 0x0040

	)

35 
	#TUN_ONE_QUEUE
 0x0080

	)

36 
	#TUN_PERSIST
 0x0100

	)

37 
	#TUN_VNET_HDR
 0x0200

	)

38 
	#TUN_TAP_MQ
 0x0400

	)

41 
	#TUNSETNOCSUM
 
	`_IOW
('T', 200, )

	)

42 
	#TUNSETDEBUG
 
	`_IOW
('T', 201, )

	)

43 
	#TUNSETIFF
 
	`_IOW
('T', 202, )

	)

44 
	#TUNSETPERSIST
 
	`_IOW
('T', 203, )

	)

45 
	#TUNSETOWNER
 
	`_IOW
('T', 204, )

	)

46 
	#TUNSETLINK
 
	`_IOW
('T', 205, )

	)

47 
	#TUNSETGROUP
 
	`_IOW
('T', 206, )

	)

48 
	#TUNGETFEATURES
 
	`_IOR
('T', 207, )

	)

49 
	#TUNSETOFFLOAD
 
	`_IOW
('T', 208, )

	)

50 
	#TUNSETTXFILTER
 
	`_IOW
('T', 209, )

	)

51 
	#TUNGETIFF
 
	`_IOR
('T', 210, )

	)

52 
	#TUNGETSNDBUF
 
	`_IOR
('T', 211, )

	)

53 
	#TUNSETSNDBUF
 
	`_IOW
('T', 212, )

	)

54 
	#TUNATTACHFILTER
 
	`_IOW
('T', 213, 
sock_årog
)

	)

55 
	#TUNDETACHFILTER
 
	`_IOW
('T', 214, 
sock_årog
)

	)

56 
	#TUNGETVNETHDRSZ
 
	`_IOR
('T', 215, )

	)

57 
	#TUNSETVNETHDRSZ
 
	`_IOW
('T', 216, )

	)

58 
	#TUNSETQUEUE
 
	`_IOW
('T', 217, )

	)

59 
	#TUNSETIFINDEX
 
	`_IOW
('T', 218, )

	)

60 
	#TUNGETFILTER
 
	`_IOR
('T', 219, 
sock_årog
)

	)

63 
	#IFF_TUN
 0x0001

	)

64 
	#IFF_TAP
 0x0002

	)

65 
	#IFF_NO_PI
 0x1000

	)

67 
	#IFF_ONE_QUEUE
 0x2000

	)

68 
	#IFF_VNET_HDR
 0x4000

	)

69 
	#IFF_TUN_EXCL
 0x8000

	)

70 
	#IFF_MULTI_QUEUE
 0x0100

	)

71 
	#IFF_ATTACH_QUEUE
 0x0200

	)

72 
	#IFF_DETACH_QUEUE
 0x0400

	)

74 
	#IFF_PERSIST
 0x0800

	)

75 
	#IFF_NOFILTER
 0x1000

	)

78 
	#TUN_TX_TIMESTAMP
 1

	)

81 
	#TUN_F_CSUM
 0x01

	)

82 
	#TUN_F_TSO4
 0x02

	)

83 
	#TUN_F_TSO6
 0x04

	)

84 
	#TUN_F_TSO_ECN
 0x08

	)

85 
	#TUN_F_UFO
 0x10

	)

88 
	#TUN_PKT_STRIP
 0x0001

	)

89 
	stun_pi
 {

90 
__u16
 
	mæags
;

91 
__be16
 
	m´Ùo
;

102 
	#TUN_FLT_ALLMULTI
 0x0001

	)

103 
	stun_f‹r
 {

104 
__u16
 
	mæags
;

105 
__u16
 
	mcouÁ
;

106 
__u8
 
	maddr
[0][
ETH_ALEN
];

	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


32 
	~<b™s/huge_v®.h
>

33 #ifdeà
__USE_ISOC99


34 
	~<b™s/huge_v®f.h
>

35 
	~<b™s/huge_v®l.h
>

38 
	~<b™s/šf.h
>

41 
	~<b™s/Çn.h
>

45 
	~<b™s/m©hdef.h
>

52 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

53 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

54 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

55 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

56 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

57 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

58 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

59 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

60 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

61 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

62 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

63 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

65 
	#_MdoubË_
 

	)

66 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

67 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<b™s/m©hÿÎs.h
>

70 #undeà
_MdoubË_


71 #undeà
_MdoubË_BEGIN_NAMESPACE


72 #undeà
_MdoubË_END_NAMESPACE


73 #undeà
__MATH_PRECNAME


75 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


81 #iâdeà
_Mæßt_


82 
	#_Mæßt_
 

	)

84 
	#_MdoubË_
 
_Mæßt_


	)

85 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

86 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<b™s/m©hÿÎs.h
>

89 #undeà
_MdoubË_


90 #undeà
_MdoubË_BEGIN_NAMESPACE


91 #undeà
_MdoubË_END_NAMESPACE


92 #undeà
__MATH_PRECNAME


94 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

95 || 
defšed
 
__LDBL_COMPAT


96 #ifdeà
__LDBL_COMPAT


98 #ifdeà
__USE_ISOC99


99 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

101 #ifdeà
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

103 
__Ædbl_Ãx‰ow¬df
)

104 
	`__©Œibu‹__
 ((
__cÚ¡__
));

105 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

106 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

107 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

108 (
__x
, 
__y
),

109 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

113 #undeà
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

115 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

116 
¬gs
, 
®Ÿs
)

	)

117 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

118 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

124 #iâdeà
_MlÚg_doubË_


125 
	#_MlÚg_doubË_
 

	)

127 
	#_MdoubË_
 
_MlÚg_doubË_


	)

128 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

129 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<b™s/m©hÿÎs.h
>

133 #undeà
_MdoubË_


134 #undeà
_MdoubË_BEGIN_NAMESPACE


135 #undeà
_MdoubË_END_NAMESPACE


136 #undeà
__MATH_PRECNAME


141 #undeà
__MATHDECL_1


142 #undeà
__MATHDECL


143 #undeà
__MATHCALL


146 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


148 
signgam
;

153 #ifdeà
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifdeà
__NO_LONG_DOUBLE_MATH


210 
	#åşassify
(
x
) \

211 ( (
x
è=ğ (è? 
	`__åşassifyf
 (xè: 
	`__åşassify
 (x))

	)

213 
	#åşassify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__åşassifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__åşassify
 (
x
è: 
	`__åşassifyl
 (x))

	)

221 #ifdeà
__NO_LONG_DOUBLE_MATH


222 
	#signb™
(
x
) \

223 ( (
x
è=ğ (è? 
	`__signb™f
 (xè: 
	`__signb™
 (x))

	)

225 
	#signb™
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signb™f
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signb™
 (
x
è: 
	`__signb™l
 (x))

	)

233 #ifdeà
__NO_LONG_DOUBLE_MATH


234 
	#isfš™e
(
x
) \

235 ( (
x
è=ğ (è? 
	`__fš™ef
 (xè: 
	`__fš™e
 (x))

	)

237 
	#isfš™e
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__fš™ef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__fš™e
 (
x
è: 
	`__fš™–
 (x))

	)

245 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

249 #ifdeà
__NO_LONG_DOUBLE_MATH


250 
	#i¢ª
(
x
) \

251 ( (
x
è=ğ (è? 
	`__i¢ªf
 (xè: 
	`__i¢ª
 (x))

	)

253 
	#i¢ª
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢ªf
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢ª
 (
x
è: 
	`__i¢ªl
 (x))

	)

261 #ifdeà
__NO_LONG_DOUBLE_MATH


262 
	#isšf
(
x
) \

263 ( (
x
è=ğ (è? 
	`__isšff
 (xè: 
	`__isšf
 (x))

	)

265 
	#isšf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isšff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isšf
 (
x
è: 
	`__isšæ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #iâdeà
__FAST_MATH__


280 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifdeà
__USE_GNU


287 #ifdeà
__NO_LONG_DOUBLE_MATH


288 
	#issigÇlšg
(
x
) \

289 ( (
x
è=ğ (è? 
	`__issigÇlšgf
 (xè: 
	`__issigÇlšg
 (x))

	)

291 
	#issigÇlšg
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issigÇlšgf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issigÇlšg
 (
x
è: 
	`__issigÇlšgl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifdeà
__USE_SVID


323 #ifdeà
__ılu¥lus


324 
__exû±iÚ


326 
exû±iÚ


329 
ty³
;

330 *
Çme
;

331 
¬g1
;

332 
¬g2
;

333 
»tv®
;

334 
	}
};

336 #ifdeà
__ılu¥lus


337 
	$m©h”r
 (
__exû±iÚ
 *
__exc
è
	`throw
 ();

339 
	`m©h”r
 (
exû±iÚ
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifdeà
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifdeà
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #ià
defšed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

417 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

418 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

419 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

420 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

421 
	#isunÜd”ed
(
u
, 
v
è
	`__butš_isunÜd”ed
(u, v)

	)

425 #ifdeà
__USE_EXTERN_INLINES


426 
	~<b™s/m©hšlše.h
>

431 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<b™s/m©h-fš™e.h
>

435 #ifdeà
__USE_ISOC99


439 #iâdeà
isg»©”


440 
	#isg»©”
(
x
, 
y
) \

441 (
__ex‹nsiÚ__
 \

442 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

443 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; 
	}
}))

	)

447 #iâdeà
isg»©”equ®


448 
	#isg»©”equ®
(
x
, 
y
) \

449 (
__ex‹nsiÚ__
 \

450 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

451 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

455 #iâdeà
i¦ess


456 
	#i¦ess
(
x
, 
y
) \

457 (
__ex‹nsiÚ__
 \

458 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

459 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

463 #iâdeà
i¦es£qu®


464 
	#i¦es£qu®
(
x
, 
y
) \

465 (
__ex‹nsiÚ__
 \

466 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

467 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

471 #iâdeà
i¦essg»©”


472 
	#i¦essg»©”
(
x
, 
y
) \

473 (
__ex‹nsiÚ__
 \

474 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

475 !
	`isunÜd”ed
 (
__x
, 
__y
è&& (__x < __y || __y < __x); }))

	)

479 #iâdeà
isunÜd”ed


480 
	#isunÜd”ed
(
u
, 
v
) \

481 (
__ex‹nsiÚ__
 \

482 ({ 
	`__ty³of__
(
u
è
__u
 = (u); __ty³of__(
v
è
__v
 = (v); \

483 
	`åşassify
 (
__u
è=ğ
FP_NAN
 || fpşassify (
__v
è=ğFP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/net/if.h

19 #iâdeà
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<ã©u»s.h
>

24 #ifdeà
__USE_MISC


25 
	~<sys/ty³s.h
>

26 
	~<sys/sock‘.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_Çmešdex


35 
	mif_šdex
;

36 *
	mif_Çme
;

40 #ifdeà
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siçddr


90 
sockaddr
 
	miç_addr
;

93 
sockaddr
 
	mifu_brßdaddr
;

94 
sockaddr
 
	mifu_d¡addr
;

95 } 
	miç_ifu
;

96 
içû
 *
	miç_iå
;

97 
içddr
 *
	miç_Ãxt
;

100 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

101 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

111 
	sifm­


113 
	mmem_¡¬t
;

114 
	mmem_’d
;

115 
	mba£_addr
;

116 
	mœq
;

117 
	mdma
;

118 
	mpÜt
;

126 
	siäeq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	miän_Çme
[
IFNAMSIZ
];

133 } 
	miä_iän
;

137 
sockaddr
 
	miäu_addr
;

138 
sockaddr
 
	miäu_d¡addr
;

139 
sockaddr
 
	miäu_brßdaddr
;

140 
sockaddr
 
	miäu_Ãtmask
;

141 
sockaddr
 
	miäu_hwaddr
;

142 
	miäu_æags
;

143 
	miäu_iv®ue
;

144 
	miäu_mtu
;

145 
ifm­
 
	miäu_m­
;

146 
	miäu_¦ave
[
IFNAMSIZ
];

147 
	miäu_ÃwÇme
[
IFNAMSIZ
];

148 
__ÿddr_t
 
	miäu_d©a
;

149 } 
	miä_iäu
;

151 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

152 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

153 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

154 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

155 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

156 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

157 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

158 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

159 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

160 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

161 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

162 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

163 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

164 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

165 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

166 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

167 
	#_IOT_iäeq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_iäeq_shÜt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_iäeq_št
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifcÚf


178 
	mifc_Ën
;

181 
__ÿddr_t
 
	mifcu_buf
;

182 
iäeq
 *
	mifcu_»q
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

187 
	#_IOT_ifcÚf
 
	`_IOT
(
	`_IOTS
(
ifcÚf
),1,0,0,0,0è

	)

190 
__BEGIN_DECLS


193 
	$if_Çm‘ošdex
 (cÚ¡ *
__iâame
è
__THROW
;

194 *
	$if_šdextÚame
 (
__ifšdex
, *
__iâame
è
__THROW
;

197 
if_Çmešdex
 *
	$if_Çmešdex
 (è
__THROW
;

200 
	$if_ä“Çmešdex
 (
if_Çmešdex
 *
__±r
è
__THROW
;

202 
__END_DECLS


	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<¡dšt.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	#__Ãed_sigev’t_t


	)

37 
	~<b™s/sigšfo.h
>

38 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 
	~<b™s/Ãtdb.h
>

45 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

46 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

47 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

49 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

50 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

53 
	g__BEGIN_DECLS


55 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


58 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

61 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifdeà
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifdeà
__USE_MISC


92 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

95 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

100 
	sho¡’t


102 *
h_Çme
;

103 **
h_®Ÿ£s
;

104 
h_add¹y³
;

105 
h_Ëngth
;

106 **
h_addr_li¡
;

107 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


108 
	#h_addr
 
h_addr_li¡
[0]

	)

117 
	`£tho¡’t
 (
__¡ay_İ’
);

123 
	`’dho¡’t
 ();

130 
ho¡’t
 *
	`g‘ho¡’t
 ();

137 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

138 
__ty³
);

144 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

146 #ifdeà
__USE_MISC


155 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

167 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

168 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

169 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

170 *
__»¡riù
 
__h_”ºİ
);

172 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

173 
__ty³
,

174 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

176 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

177 *
__»¡riù
 
__h_”ºİ
);

179 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

180 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

181 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

182 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

183 *
__»¡riù
 
__h_”ºİ
);

185 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

186 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

187 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

188 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

189 *
__»¡riù
 
__h_”ºİ
);

198 
	`£Š‘’t
 (
__¡ay_İ’
);

204 
	`’dÃ‹Á
 ();

211 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

218 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

224 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

226 #ifdef 
__USE_MISC


237 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

238 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

239 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

240 *
__»¡riù
 
__h_”ºİ
);

242 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

243 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

244 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

245 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

246 *
__»¡riù
 
__h_”ºİ
);

248 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

249 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

250 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

251 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

252 *
__»¡riù
 
__h_”ºİ
);

257 
	s£rv’t


259 *
s_Çme
;

260 **
s_®Ÿ£s
;

261 
s_pÜt
;

262 *
s_´Ùo
;

270 
	`£t£rv’t
 (
__¡ay_İ’
);

276 
	`’d£rv’t
 ();

283 
£rv’t
 *
	`g‘£rv’t
 ();

290 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

297 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

300 #ifdef 
__USE_MISC


308 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

309 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

310 
£rv’t
 **
__»¡riù
 
__»suÉ
);

312 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

313 cÚ¡ *
__»¡riù
 
__´Ùo
,

314 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

315 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

316 
£rv’t
 **
__»¡riù
 
__»suÉ
);

318 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

319 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

320 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

321 
£rv’t
 **
__»¡riù
 
__»suÉ
);

326 
	s´ÙÛÁ


328 *
p_Çme
;

329 **
p_®Ÿ£s
;

330 
p_´Ùo
;

338 
	`£rÙÛÁ
 (
__¡ay_İ’
);

344 
	`’d´ÙÛÁ
 ();

351 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

357 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

363 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

366 #ifdef 
__USE_MISC


374 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

375 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

376 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

378 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

379 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

380 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

381 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

383 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

384 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

385 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

386 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

395 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

403 
	`’dÃtg»Á
 ();

412 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

413 **
__»¡riù
 
__u£½
,

414 **
__»¡riù
 
__domašp
);

423 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

424 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

432 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

433 **
__»¡riù
 
__u£½
,

434 **
__»¡riù
 
__domašp
,

435 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

439 #ifdeà
__USE_BSD


451 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

452 cÚ¡ *
__»¡riù
 
__locu£r
,

453 cÚ¡ *
__»¡riù
 
__»mu£r
,

454 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

463 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

464 cÚ¡ *
__»¡riù
 
__locu£r
,

465 cÚ¡ *
__»¡riù
 
__»mu£r
,

466 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

467 
§_çmy_t
 
__af
);

479 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

480 cÚ¡ *
__»¡riù
 
__Çme
,

481 cÚ¡ *
__»¡riù
 
__·ss
,

482 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

491 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

492 cÚ¡ *
__»¡riù
 
__Çme
,

493 cÚ¡ *
__»¡riù
 
__·ss
,

494 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

495 
§_çmy_t
 
__af
);

505 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

506 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

515 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

516 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

517 
§_çmy_t
 
__af
);

528 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

529 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

539 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

540 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

541 
§_çmy_t
 
__af
);

551 
	`¼esvpÜt
 (*
__®pÜt
);

560 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddršfo


569 
ai_æags
;

570 
ai_çmy
;

571 
ai_sockty³
;

572 
ai_´ÙocŞ
;

573 
sockËn_t
 
ai_add¾’
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ÿnÚÇme
;

576 
addršfo
 *
ai_Ãxt
;

579 #ifdeà
__USE_GNU


581 
	sgaicb


583 cÚ¡ *
¬_Çme
;

584 cÚ¡ *
¬_£rviû
;

585 cÚ¡ 
addršfo
 *
¬_»que¡
;

586 
addršfo
 *
¬_»suÉ
;

588 
__»tuº
;

589 
__glibc_»£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifdeà
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifdeà
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifdeà
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifdeà
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

663 cÚ¡ *
__»¡riù
 
__£rviû
,

664 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

665 
addršfo
 **
__»¡riù
 
__·i
);

668 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

671 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

677 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

678 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

679 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

680 
sockËn_t
 
__£rvËn
, 
__æags
);

683 #ifdeà
__USE_GNU


692 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

693 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

703 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

704 cÚ¡ 
time¥ec
 *
__timeout
);

707 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

710 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<¡dšt.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_RAW
 = 255,

89 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

90 
	mIPPROTO_MAX


96 #iâdeà
__USE_KERNEL_IPV6_DEFS


99 
	mIPPROTO_HOPOPTS
 = 0,

100 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

101 
	mIPPROTO_ROUTING
 = 43,

102 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

103 
	mIPPROTO_FRAGMENT
 = 44,

104 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

105 
	mIPPROTO_ICMPV6
 = 58,

106 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

107 
	mIPPROTO_NONE
 = 59,

108 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

109 
	mIPPROTO_DSTOPTS
 = 60,

110 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

111 
	mIPPROTO_MH
 = 135

112 
	#IPPROTO_MH
 
IPPROTO_MH


	)

117 
ušt16_t
 
	tš_pÜt_t
;

122 
	mIPPORT_ECHO
 = 7,

123 
	mIPPORT_DISCARD
 = 9,

124 
	mIPPORT_SYSTAT
 = 11,

125 
	mIPPORT_DAYTIME
 = 13,

126 
	mIPPORT_NETSTAT
 = 15,

127 
	mIPPORT_FTP
 = 21,

128 
	mIPPORT_TELNET
 = 23,

129 
	mIPPORT_SMTP
 = 25,

130 
	mIPPORT_TIMESERVER
 = 37,

131 
	mIPPORT_NAMESERVER
 = 42,

132 
	mIPPORT_WHOIS
 = 43,

133 
	mIPPORT_MTP
 = 57,

135 
	mIPPORT_TFTP
 = 69,

136 
	mIPPORT_RJE
 = 77,

137 
	mIPPORT_FINGER
 = 79,

138 
	mIPPORT_TTYLINK
 = 87,

139 
	mIPPORT_SUPDUP
 = 95,

142 
	mIPPORT_EXECSERVER
 = 512,

143 
	mIPPORT_LOGINSERVER
 = 513,

144 
	mIPPORT_CMDSERVER
 = 514,

145 
	mIPPORT_EFSSERVER
 = 520,

148 
	mIPPORT_BIFFUDP
 = 512,

149 
	mIPPORT_WHOSERVER
 = 513,

150 
	mIPPORT_ROUTESERVER
 = 520,

153 
	mIPPORT_RESERVED
 = 1024,

156 
	mIPPORT_USERRESERVED
 = 5000

164 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

165 
	#IN_CLASSA_NET
 0xff000000

	)

166 
	#IN_CLASSA_NSHIFT
 24

	)

167 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

168 
	#IN_CLASSA_MAX
 128

	)

170 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

171 
	#IN_CLASSB_NET
 0xffff0000

	)

172 
	#IN_CLASSB_NSHIFT
 16

	)

173 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

174 
	#IN_CLASSB_MAX
 65536

	)

176 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

177 
	#IN_CLASSC_NET
 0xffffff00

	)

178 
	#IN_CLASSC_NSHIFT
 8

	)

179 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

181 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

182 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

184 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

185 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

188 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

190 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

192 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

195 
	#IN_LOOPBACKNET
 127

	)

197 #iâdeà
INADDR_LOOPBACK


198 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

202 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

203 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

204 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

205 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

207 #iâdeà
__USE_KERNEL_IPV6_DEFS


209 
	sš6_addr


213 
ušt8_t
 
	m__u6_addr8
[16];

214 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


215 
ušt16_t
 
	m__u6_addr16
[8];

216 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #iâdeà
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #iâdeà
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

387 #ifdeà
__OPTIMIZE__


391 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


394 
	#Áohl
(
x
è(x)

	)

395 
	#Áohs
(
x
è(x)

	)

396 
	#htÚl
(
x
è(x)

	)

397 
	#htÚs
(
x
è(x)

	)

399 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


400 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

401 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

402 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

408 #ifdeà
__GNUC__


409 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

410 (
__ex‹nsiÚ__
 \

411 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

412 
__a
->
s6_addr32
[0] == 0 \

413 && 
__a
->
s6_addr32
[1] == 0 \

414 && 
__a
->
s6_addr32
[2] == 0 \

415 && 
__a
->
s6_addr32
[3] =ğ0; 
	}
}))

	)

417 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

418 (
__ex‹nsiÚ__
 \

419 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

420 
__a
->
s6_addr32
[0] == 0 \

421 && 
__a
->
s6_addr32
[1] == 0 \

422 && 
__a
->
s6_addr32
[2] == 0 \

423 && 
__a
->
s6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

425 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

426 (
__ex‹nsiÚ__
 \

427 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

428 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

430 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

431 (
__ex‹nsiÚ__
 \

432 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

433 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

435 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

436 (
__ex‹nsiÚ__
 \

437 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

438 
__a
->
s6_addr32
[0] == 0 \

439 && 
__a
->
s6_addr32
[1] == 0 \

440 && 
__a
->
s6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

442 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

443 (
__ex‹nsiÚ__
 \

444 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

445 
__a
->
s6_addr32
[0] == 0 \

446 && 
__a
->
s6_addr32
[1] == 0 \

447 && 
__a
->
s6_addr32
[2] == 0 \

448 && 
	`Áohl
 (
__a
->
s6_addr32
[3]è> 1; }))

	)

450 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

451 (
__ex‹nsiÚ__
 \

452 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

453 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

454 
__a
->
s6_addr32
[0] =ğ
__b
->s6_addr32[0] \

455 && 
__a
->
s6_addr32
[1] =ğ
__b
->s6_addr32[1] \

456 && 
__a
->
s6_addr32
[2] =ğ
__b
->s6_addr32[2] \

457 && 
__a
->
s6_addr32
[3] =ğ
__b
->s6_addr32[3]; }))

	)

459 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

460 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

461 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

465 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

466 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

467 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

471 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

472 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

473 =ğ
	`htÚl
 (0xã800000))

	)

475 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

476 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

477 =ğ
	`htÚl
 (0xãc00000))

	)

479 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

480 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

481 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

484 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

485 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

486 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

488 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

490 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

491 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

492 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

497 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

499 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


501 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

504 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

505 
__THROW
;

509 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

510 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

511 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

513 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

514 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

515 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

517 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

518 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

519 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

521 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

522 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

523 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

525 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

526 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

527 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

530 #ifdeà
__USE_GNU


531 
cmsghdr
;

534 
	sš6_pktšfo


536 
š6_addr
 
i6_addr
;

537 
i6_ifšdex
;

541 
	s6_mtušfo


543 
sockaddr_š6
 
6m_addr
;

544 
ušt32_t
 
6m_mtu
;

549 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

550 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

551 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

552 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

554 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

555 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

556 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

557 
__muÉx
, 
__¶usy
)

558 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

559 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

560 
ušt8_t
 **
__Œp
)

561 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

562 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

563 
ušt8_t
 **
__Œp
, 
__ty³
)

564 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

568 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

569 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

570 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

571 **
__d©abuå
è
__THROW
;

572 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

573 
__THROW
;

574 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

575 
sockËn_t
 
__v®Ën
è
__THROW
;

576 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

577 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

578 **
__d©abuå
è
__THROW
;

579 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

580 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

581 **
__d©abuå
è
__THROW
;

582 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

583 
sockËn_t
 
__v®Ën
è
__THROW
;

587 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

588 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

589 
__£gm’ts
è
__THROW
;

590 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

591 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

592 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

593 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

594 
__THROW
;

600 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

601 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

602 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

603 
__THROW
;

606 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

607 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

608 
ušt32_t
 
__num¤c
,

609 cÚ¡ 
š_addr
 *
__¦i¡
)

610 
__THROW
;

614 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

615 cÚ¡ 
sockaddr
 *
__group
,

616 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

617 
ušt32_t
 *
__num¤c
,

618 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

621 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

622 cÚ¡ 
sockaddr
 *
__group
,

623 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

624 
ušt32_t
 
__num¤c
,

625 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

628 
__END_DECLS


	@/usr/include/netinet/in_systm.h

19 #iâdeà
_NETINET_IN_SYSTM_H


20 
	#_NETINET_IN_SYSTM_H
 1

	)

22 
	~<sys/cdefs.h
>

23 
	~<sys/ty³s.h
>

25 
__BEGIN_DECLS


34 
u_št16_t
 
	tn_shÜt
;

35 
u_št32_t
 
	tn_lÚg
;

36 
u_št32_t
 
	tn_time
;

38 
	g__END_DECLS


	@/usr/include/netinet/ip.h

18 #iâdeà
__NETINET_IP_H


19 
	#__NETINET_IP_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<sys/ty³s.h
>

24 
	~<Ãtš‘/š.h
>

26 
__BEGIN_DECLS


28 
	stime¡amp


30 
u_št8_t
 
	mËn
;

31 
u_št8_t
 
	m±r
;

32 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


33 
	mæags
:4;

34 
	mov”æow
:4;

35 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


36 
	mov”æow
:4;

37 
	mæags
:4;

41 
u_št32_t
 
	md©a
[9];

44 
	shdr


46 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


47 
	mihl
:4;

48 
	mv”siÚ
:4;

49 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


50 
	mv”siÚ
:4;

51 
	mihl
:4;

55 
u_št8_t
 
	mtos
;

56 
u_št16_t
 
	mtÙ_Ën
;

57 
u_št16_t
 
	mid
;

58 
u_št16_t
 
	mäag_off
;

59 
u_št8_t
 
	m‰l
;

60 
u_št8_t
 
	m´ÙocŞ
;

61 
u_št16_t
 
	mcheck
;

62 
u_št32_t
 
	m§ddr
;

63 
u_št32_t
 
	mdaddr
;

67 #ifdeà
__USE_BSD


107 
	s


109 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


110 
	m_hl
:4;

111 
	m_v
:4;

113 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


114 
	m_v
:4;

115 
	m_hl
:4;

117 
u_št8_t
 
	m_tos
;

118 
u_shÜt
 
	m_Ën
;

119 
u_shÜt
 
	m_id
;

120 
u_shÜt
 
	m_off
;

121 
	#IP_RF
 0x8000

	)

122 
	#IP_DF
 0x4000

	)

123 
	#IP_MF
 0x2000

	)

124 
	#IP_OFFMASK
 0x1ffà

	)

125 
u_št8_t
 
	m_‰l
;

126 
u_št8_t
 
	m_p
;

127 
u_shÜt
 
	m_sum
;

128 
š_addr
 
	m_¤c
, 
	m_d¡
;

134 
	s_time¡amp


136 
u_št8_t
 
	mt_code
;

137 
u_št8_t
 
	mt_Ën
;

138 
u_št8_t
 
	mt_±r
;

139 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


140 
	mt_æg
:4;

141 
	mt_oæw
:4;

143 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


144 
	mt_oæw
:4;

145 
	mt_æg
:4;

147 
u_št32_t
 
	md©a
[9];

151 
	#IPVERSION
 4

	)

152 
	#IP_MAXPACKET
 65535

	)

160 
	#IPTOS_ECN_MASK
 0x03

	)

161 
	#IPTOS_ECN
(
x
è((xè& 
IPTOS_ECN_MASK
)

	)

162 
	#IPTOS_ECN_NOT_ECT
 0x00

	)

163 
	#IPTOS_ECN_ECT1
 0x01

	)

164 
	#IPTOS_ECN_ECT0
 0x02

	)

165 
	#IPTOS_ECN_CE
 0x03

	)

173 
	#IPTOS_DSCP_MASK
 0xfc

	)

174 
	#IPTOS_DSCP
(
x
è((xè& 
IPTOS_DSCP_MASK
)

	)

175 
	#IPTOS_DSCP_AF11
 0x28

	)

176 
	#IPTOS_DSCP_AF12
 0x30

	)

177 
	#IPTOS_DSCP_AF13
 0x38

	)

178 
	#IPTOS_DSCP_AF21
 0x48

	)

179 
	#IPTOS_DSCP_AF22
 0x50

	)

180 
	#IPTOS_DSCP_AF23
 0x58

	)

181 
	#IPTOS_DSCP_AF31
 0x68

	)

182 
	#IPTOS_DSCP_AF32
 0x70

	)

183 
	#IPTOS_DSCP_AF33
 0x78

	)

184 
	#IPTOS_DSCP_AF41
 0x88

	)

185 
	#IPTOS_DSCP_AF42
 0x90

	)

186 
	#IPTOS_DSCP_AF43
 0x98

	)

187 
	#IPTOS_DSCP_EF
 0xb8

	)

194 
	#IPTOS_CLASS_MASK
 0xe0

	)

195 
	#IPTOS_CLASS
(
şass
è((şassè& 
IPTOS_CLASS_MASK
)

	)

196 
	#IPTOS_CLASS_CS0
 0x00

	)

197 
	#IPTOS_CLASS_CS1
 0x20

	)

198 
	#IPTOS_CLASS_CS2
 0x40

	)

199 
	#IPTOS_CLASS_CS3
 0x60

	)

200 
	#IPTOS_CLASS_CS4
 0x80

	)

201 
	#IPTOS_CLASS_CS5
 0xa0

	)

202 
	#IPTOS_CLASS_CS6
 0xc0

	)

203 
	#IPTOS_CLASS_CS7
 0xe0

	)

205 
	#IPTOS_CLASS_DEFAULT
 
IPTOS_CLASS_CS0


	)

211 
	#IPTOS_TOS_MASK
 0x1E

	)

212 
	#IPTOS_TOS
(
tos
è(Ñosè& 
IPTOS_TOS_MASK
)

	)

213 
	#IPTOS_LOWDELAY
 0x10

	)

214 
	#IPTOS_THROUGHPUT
 0x08

	)

215 
	#IPTOS_RELIABILITY
 0x04

	)

216 
	#IPTOS_LOWCOST
 0x02

	)

217 
	#IPTOS_MINCOST
 
IPTOS_LOWCOST


	)

222 
	#IPTOS_PREC_MASK
 
IPTOS_CLASS_MASK


	)

223 
	#IPTOS_PREC
(
tos
è
	`IPTOS_CLASS
Ños)

	)

224 
	#IPTOS_PREC_NETCONTROL
 
IPTOS_CLASS_CS7


	)

225 
	#IPTOS_PREC_INTERNETCONTROL
 
IPTOS_CLASS_CS6


	)

226 
	#IPTOS_PREC_CRITIC_ECP
 
IPTOS_CLASS_CS5


	)

227 
	#IPTOS_PREC_FLASHOVERRIDE
 
IPTOS_CLASS_CS4


	)

228 
	#IPTOS_PREC_FLASH
 
IPTOS_CLASS_CS3


	)

229 
	#IPTOS_PREC_IMMEDIATE
 
IPTOS_CLASS_CS2


	)

230 
	#IPTOS_PREC_PRIORITY
 
IPTOS_CLASS_CS1


	)

231 
	#IPTOS_PREC_ROUTINE
 
IPTOS_CLASS_CS0


	)

236 
	#IPOPT_COPY
 0x80

	)

237 
	#IPOPT_CLASS_MASK
 0x60

	)

238 
	#IPOPT_NUMBER_MASK
 0x1f

	)

240 
	#IPOPT_COPIED
(
o
è((oè& 
IPOPT_COPY
)

	)

241 
	#IPOPT_CLASS
(
o
è((oè& 
IPOPT_CLASS_MASK
)

	)

242 
	#IPOPT_NUMBER
(
o
è((oè& 
IPOPT_NUMBER_MASK
)

	)

244 
	#IPOPT_CONTROL
 0x00

	)

245 
	#IPOPT_RESERVED1
 0x20

	)

246 
	#IPOPT_DEBMEAS
 0x40

	)

247 
	#IPOPT_MEASUREMENT
 
IPOPT_DEBMEAS


	)

248 
	#IPOPT_RESERVED2
 0x60

	)

250 
	#IPOPT_EOL
 0

	)

251 
	#IPOPT_END
 
IPOPT_EOL


	)

252 
	#IPOPT_NOP
 1

	)

253 
	#IPOPT_NOOP
 
IPOPT_NOP


	)

255 
	#IPOPT_RR
 7

	)

256 
	#IPOPT_TS
 68

	)

257 
	#IPOPT_TIMESTAMP
 
IPOPT_TS


	)

258 
	#IPOPT_SECURITY
 130

	)

259 
	#IPOPT_SEC
 
IPOPT_SECURITY


	)

260 
	#IPOPT_LSRR
 131

	)

261 
	#IPOPT_SATID
 136

	)

262 
	#IPOPT_SID
 
IPOPT_SATID


	)

263 
	#IPOPT_SSRR
 137

	)

264 
	#IPOPT_RA
 148

	)

269 
	#IPOPT_OPTVAL
 0

	)

270 
	#IPOPT_OLEN
 1

	)

271 
	#IPOPT_OFFSET
 2

	)

272 
	#IPOPT_MINOFF
 4

	)

274 
	#MAX_IPOPTLEN
 40

	)

277 
	#IPOPT_TS_TSONLY
 0

	)

278 
	#IPOPT_TS_TSANDADDR
 1

	)

279 
	#IPOPT_TS_PRESPEC
 3

	)

282 
	#IPOPT_SECUR_UNCLASS
 0x0000

	)

283 
	#IPOPT_SECUR_CONFID
 0xf135

	)

284 
	#IPOPT_SECUR_EFTO
 0x789a

	)

285 
	#IPOPT_SECUR_MMMM
 0xbc4d

	)

286 
	#IPOPT_SECUR_RESTR
 0xaf13

	)

287 
	#IPOPT_SECUR_SECRET
 0xd788

	)

288 
	#IPOPT_SECUR_TOPSECRET
 0x6bc5

	)

293 
	#MAXTTL
 255

	)

294 
	#IPDEFTTL
 64

	)

295 
	#IPFRAGTTL
 60

	)

296 
	#IPTTLDEC
 1

	)

298 
	#IP_MSS
 576

	)

300 
	g__END_DECLS


	@/usr/include/netinet/tcp.h

32 #iâdeà
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<ã©u»s.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

65 #ifdeà
__USE_MISC


66 
	~<sys/ty³s.h
>

67 
	~<sys/sock‘.h
>

69 
u_št32_t
 
	ttı_£q
;

74 
	stıhdr


76 
__ex‹nsiÚ__
 union

80 
u_št16_t
 
	mth_¥Üt
;

81 
u_št16_t
 
	mth_dpÜt
;

82 
tı_£q
 
	mth_£q
;

83 
tı_£q
 
	mth_ack
;

84 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


85 
u_št8_t
 
	mth_x2
:4;

86 
u_št8_t
 
	mth_off
:4;

88 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


89 
u_št8_t
 
	mth_off
:4;

90 
u_št8_t
 
	mth_x2
:4;

92 
u_št8_t
 
	mth_æags
;

93 
	#TH_FIN
 0x01

	)

94 
	#TH_SYN
 0x02

	)

95 
	#TH_RST
 0x04

	)

96 
	#TH_PUSH
 0x08

	)

97 
	#TH_ACK
 0x10

	)

98 
	#TH_URG
 0x20

	)

99 
u_št16_t
 
	mth_wš
;

100 
u_št16_t
 
	mth_sum
;

101 
u_št16_t
 
	mth_u½
;

105 
u_št16_t
 
	msourû
;

106 
u_št16_t
 
	mde¡
;

107 
u_št32_t
 
	m£q
;

108 
u_št32_t
 
	mack_£q
;

109 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


110 
u_št16_t
 
	m»s1
:4;

111 
u_št16_t
 
	mdoff
:4;

112 
u_št16_t
 
	mfš
:1;

113 
u_št16_t
 
	msyn
:1;

114 
u_št16_t
 
	mr¡
:1;

115 
u_št16_t
 
	mpsh
:1;

116 
u_št16_t
 
	mack
:1;

117 
u_št16_t
 
	murg
:1;

118 
u_št16_t
 
	m»s2
:2;

119 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


120 
u_št16_t
 
	mdoff
:4;

121 
u_št16_t
 
	m»s1
:4;

122 
u_št16_t
 
	m»s2
:2;

123 
u_št16_t
 
	murg
:1;

124 
u_št16_t
 
	mack
:1;

125 
u_št16_t
 
	mpsh
:1;

126 
u_št16_t
 
	mr¡
:1;

127 
u_št16_t
 
	msyn
:1;

128 
u_št16_t
 
	mfš
:1;

132 
u_št16_t
 
	mwšdow
;

133 
u_št16_t
 
	mcheck
;

134 
u_št16_t
 
	murg_±r
;

141 
	mTCP_ESTABLISHED
 = 1,

142 
	mTCP_SYN_SENT
,

143 
	mTCP_SYN_RECV
,

144 
	mTCP_FIN_WAIT1
,

145 
	mTCP_FIN_WAIT2
,

146 
	mTCP_TIME_WAIT
,

147 
	mTCP_CLOSE
,

148 
	mTCP_CLOSE_WAIT
,

149 
	mTCP_LAST_ACK
,

150 
	mTCP_LISTEN
,

151 
	mTCP_CLOSING


154 
	#TCPOPT_EOL
 0

	)

155 
	#TCPOPT_NOP
 1

	)

156 
	#TCPOPT_MAXSEG
 2

	)

157 
	#TCPOLEN_MAXSEG
 4

	)

158 
	#TCPOPT_WINDOW
 3

	)

159 
	#TCPOLEN_WINDOW
 3

	)

160 
	#TCPOPT_SACK_PERMITTED
 4

	)

161 
	#TCPOLEN_SACK_PERMITTED
 2

	)

162 
	#TCPOPT_SACK
 5

	)

163 
	#TCPOPT_TIMESTAMP
 8

	)

164 
	#TCPOLEN_TIMESTAMP
 10

	)

165 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2è

	)

167 
	#TCPOPT_TSTAMP_HDR
 \

168 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

176 
	#TCP_MSS
 512

	)

178 
	#TCP_MAXWIN
 65535

	)

180 
	#TCP_MAX_WINSHIFT
 14

	)

182 
	#SOL_TCP
 6

	)

185 
	#TCPI_OPT_TIMESTAMPS
 1

	)

186 
	#TCPI_OPT_SACK
 2

	)

187 
	#TCPI_OPT_WSCALE
 4

	)

188 
	#TCPI_OPT_ECN
 8

	)

189 
	#TCPI_OPT_ECN_SEEN
 16

	)

190 
	#TCPI_OPT_SYN_DATA
 32

	)

193 
	etı_ÿ_¡©e


195 
	mTCP_CA_O³n
 = 0,

196 
	mTCP_CA_DisÜd”
 = 1,

197 
	mTCP_CA_CWR
 = 2,

198 
	mTCP_CA_Recov”y
 = 3,

199 
	mTCP_CA_Loss
 = 4

202 
	stı_šfo


204 
u_št8_t
 
	mtıi_¡©e
;

205 
u_št8_t
 
	mtıi_ÿ_¡©e
;

206 
u_št8_t
 
	mtıi_»Œªsm™s
;

207 
u_št8_t
 
	mtıi_´obes
;

208 
u_št8_t
 
	mtıi_backoff
;

209 
u_št8_t
 
	mtıi_İtiÚs
;

210 
u_št8_t
 
	mtıi_¢d_wsÿË
 : 4, 
	mtıi_rcv_wsÿË
 : 4;

212 
u_št32_t
 
	mtıi_¹o
;

213 
u_št32_t
 
	mtıi_©o
;

214 
u_št32_t
 
	mtıi_¢d_mss
;

215 
u_št32_t
 
	mtıi_rcv_mss
;

217 
u_št32_t
 
	mtıi_uÇcked
;

218 
u_št32_t
 
	mtıi_§cked
;

219 
u_št32_t
 
	mtıi_lo¡
;

220 
u_št32_t
 
	mtıi_»Œªs
;

221 
u_št32_t
 
	mtıi_çck‘s
;

224 
u_št32_t
 
	mtıi_Ï¡_d©a_£Á
;

225 
u_št32_t
 
	mtıi_Ï¡_ack_£Á
;

226 
u_št32_t
 
	mtıi_Ï¡_d©a_»cv
;

227 
u_št32_t
 
	mtıi_Ï¡_ack_»cv
;

230 
u_št32_t
 
	mtıi_pmtu
;

231 
u_št32_t
 
	mtıi_rcv_s¡h»sh
;

232 
u_št32_t
 
	mtıi_¹t
;

233 
u_št32_t
 
	mtıi_¹tv¬
;

234 
u_št32_t
 
	mtıi_¢d_s¡h»sh
;

235 
u_št32_t
 
	mtıi_¢d_cwnd
;

236 
u_št32_t
 
	mtıi_advmss
;

237 
u_št32_t
 
	mtıi_»Üd”šg
;

239 
u_št32_t
 
	mtıi_rcv_¹t
;

240 
u_št32_t
 
	mtıi_rcv_¥aû
;

242 
u_št32_t
 
	mtıi_tÙ®_»Œªs
;

247 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

249 
	stı_md5sig


251 
sockaddr_¡Üage
 
	mtım_addr
;

252 
u_št16_t
 
	m__tım_·d1
;

253 
u_št16_t
 
	mtım_keyËn
;

254 
u_št32_t
 
	m__tım_·d2
;

255 
u_št8_t
 
	mtım_key
[
TCP_MD5SIG_MAXKEYLEN
];

259 
	stı_»·œ_İt


261 
u_št32_t
 
	mİt_code
;

262 
u_št32_t
 
	mİt_v®
;

268 
	mTCP_NO_QUEUE
,

269 
	mTCP_RECV_QUEUE
,

270 
	mTCP_SEND_QUEUE
,

271 
	mTCP_QUEUES_NR
,

275 
	#TCP_COOKIE_MIN
 8

	)

276 
	#TCP_COOKIE_MAX
 16

	)

277 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

280 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0è

	)

281 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1è

	)

285 
	#TCP_S_DATA_IN
 (1 << 2è

	)

286 
	#TCP_S_DATA_OUT
 (1 << 3è

	)

288 
	#TCP_MSS_DEFAULT
 536U

	)

289 
	#TCP_MSS_DESIRED
 1220U

	)

291 
	stı_cook›_Œª§ùiÚs


293 
u_št16_t
 
	mtıù_æags
;

294 
u_št8_t
 
	m__tıù_·d1
;

295 
u_št8_t
 
	mtıù_cook›_desœed
;

296 
u_št16_t
 
	mtıù_s_d©a_desœed
;

297 
u_št16_t
 
	mtıù_u£d
;

298 
u_št8_t
 
	mtıù_v®ue
[
TCP_MSS_DEFAULT
];

	@/usr/include/paths.h

32 #iâdeà
_PATHS_H_


33 
	#_PATHS_H_


	)

36 
	#_PATH_DEFPATH
 "/u¤/bš:/bš"

	)

38 
	#_PATH_STDPATH
 \

39 "/u¤/bš:/bš:/u¤/sbš:/sbš"

	)

41 
	#_PATH_BSHELL
 "/bš/sh"

	)

42 
	#_PATH_CONSOLE
 "/dev/cÚsŞe"

	)

43 
	#_PATH_CSHELL
 "/bš/csh"

	)

44 
	#_PATH_DEVDB
 "/v¬/run/dev.db"

	)

45 
	#_PATH_DEVNULL
 "/dev/nuÎ"

	)

46 
	#_PATH_DRUM
 "/dev/drum"

	)

47 
	#_PATH_GSHADOW
 "/‘c/gshadow"

	)

48 
	#_PATH_KLOG
 "/´oc/kmsg"

	)

49 
	#_PATH_KMEM
 "/dev/kmem"

	)

50 
	#_PATH_LASTLOG
 "/v¬/log/Ï¡log"

	)

51 
	#_PATH_MAILDIR
 "/v¬/ma"

	)

52 
	#_PATH_MAN
 "/u¤/sh¬e/mª"

	)

53 
	#_PATH_MEM
 "/dev/mem"

	)

54 
	#_PATH_MNTTAB
 "/‘c/f¡ab"

	)

55 
	#_PATH_MOUNTED
 "/‘c/mb"

	)

56 
	#_PATH_NOLOGIN
 "/‘c/nŞogš"

	)

57 
	#_PATH_PRESERVE
 "/v¬/lib"

	)

58 
	#_PATH_RWHODIR
 "/v¬/¥oŞ/rwho"

	)

59 
	#_PATH_SENDMAIL
 "/u¤/sbš/£ndma"

	)

60 
	#_PATH_SHADOW
 "/‘c/shadow"

	)

61 
	#_PATH_SHELLS
 "/‘c/sh–ls"

	)

62 
	#_PATH_TTY
 "/dev/‰y"

	)

63 
	#_PATH_UNIX
 "/boÙ/vmlšux"

	)

64 
	#_PATH_UTMP
 "/v¬/run/utmp"

	)

65 
	#_PATH_VI
 "/u¤/bš/vi"

	)

66 
	#_PATH_WTMP
 "/v¬/log/wtmp"

	)

69 
	#_PATH_DEV
 "/dev/"

	)

70 
	#_PATH_TMP
 "/tmp/"

	)

71 
	#_PATH_VARDB
 "/v¬/lib/misc/"

	)

72 
	#_PATH_VARRUN
 "/v¬/run/"

	)

73 
	#_PATH_VARTMP
 "/v¬/tmp/"

	)

	@/usr/include/pty.h

19 #iâdeà
_PTY_H


20 
	#_PTY_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	~<‹rmios.h
>

25 
	~<sys/ioùl.h
>

28 
__BEGIN_DECLS


33 
	$İ’±y
 (*
__ama¡”
, *
__a¦ave
, *
__Çme
,

34 cÚ¡ 
‹rmios
 *
__‹rmp
,

35 cÚ¡ 
wšsize
 *
__wšp
è
__THROW
;

39 
	$fÜk±y
 (*
__ama¡”
, *
__Çme
,

40 cÚ¡ 
‹rmios
 *
__‹rmp
,

41 cÚ¡ 
wšsize
 *
__wšp
è
__THROW
;

43 
__END_DECLS


	@/usr/include/pwd.h

22 #iâdef 
_PWD_H


23 
	#_PWD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 
	#__Ãed_size_t


	)

32 
	~<¡ddef.h
>

34 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


37 #iâdeà
__gid_t_defšed


38 
__gid_t
 
	tgid_t
;

39 
	#__gid_t_defšed


	)

42 #iâdeà
__uid_t_defšed


43 
__uid_t
 
	tuid_t
;

44 
	#__uid_t_defšed


	)

49 
	s·sswd


51 *
	mpw_Çme
;

52 *
	mpw_·sswd
;

53 
__uid_t
 
	mpw_uid
;

54 
__gid_t
 
	mpw_gid
;

55 *
	mpw_gecos
;

56 *
	mpw_dœ
;

57 *
	mpw_sh–l
;

61 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_GNU


62 
	#__Ãed_FILE


	)

63 
	~<¡dio.h
>

67 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


72 
£w’t
 ();

78 
’dpw’t
 ();

84 
·sswd
 *
g‘pw’t
 ();

87 #ifdef 
__USE_SVID


94 
·sswd
 *
fg‘pw’t
 (
FILE
 *
__¡»am
);

102 
puw’t
 (cÚ¡ 
·sswd
 *
__»¡riù
 
__p
,

103 
FILE
 *
__»¡riù
 
__f
);

110 
·sswd
 *
g‘pwuid
 (
__uid_t
 
__uid
);

116 
·sswd
 *
g‘pwÇm
 (cÚ¡ *
__Çme
);

118 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


120 #ifdeà
__USE_MISC


123 
	#NSS_BUFLEN_PASSWD
 1024

	)

134 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


139 
g‘pw’t_r
 (
·sswd
 *
__»¡riù
 
__»suÉbuf
,

140 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

141 
·sswd
 **
__»¡riù
 
__»suÉ
);

144 
g‘pwuid_r
 (
__uid_t
 
__uid
,

145 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

146 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

147 
·sswd
 **
__»¡riù
 
__»suÉ
);

149 
g‘pwÇm_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

150 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

151 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

152 
·sswd
 **
__»¡riù
 
__»suÉ
);

155 #ifdef 
__USE_SVID


163 
fg‘pw’t_r
 (
FILE
 *
__»¡riù
 
__¡»am
,

164 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

165 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

166 
·sswd
 **
__»¡riù
 
__»suÉ
);

171 #ifdeà
__USE_GNU


180 
g‘pw
 (
__uid_t
 
__uid
, *
__bufãr
);

183 
	g__END_DECLS


	@/usr/include/resolv.h

52 #iâdeà
_RESOLV_H_


56 
	~<sys/ty³s.h
>

57 
	~<Ãtš‘/š.h
>

59 #iâdeà
__Ãed_»s_¡©e


60 
	#_RESOLV_H_


	)

62 
	~<sys/·¿m.h
>

63 
	~<sys/cdefs.h
>

64 
	~<¡dio.h
>

65 
	~<¬·/Çme£r.h
>

68 #iâdeà
__»s_¡©e_defšed


69 
	#__»s_¡©e_defšed


	)

71 ’um { 
	m»s_gßh—d
, 
	m»s_ÃxŠs
, 
	m»s_modif›d
, 
	m»s_dÚe
, 
	m»s_”rÜ
 }

72 
	t»s_£ndhookaù
;

74 
	$»s_£ndhookaù
 (*
	t»s_£nd_qhook
è(
	tsockaddr_š
 * cÚ¡ *
	t__ns
,

75 cÚ¡ 
	tu_ch¬
 **
	t__qu”y
,

76 *
	t__qu”yËn
,

77 
	tu_ch¬
 *
	t__ªs
,

78 
	t__ªssiz
,

79 *
	t__»¥Ën
);

81 
	$»s_£ndhookaù
 (*
	t»s_£nd_rhook
è(cÚ¡ 
	tsockaddr_š
 *
	t__ns
,

82 cÚ¡ 
	tu_ch¬
 *
	t__qu”y
,

83 
	t__qu”yËn
,

84 
	tu_ch¬
 *
	t__ªs
,

85 
	t__ªssiz
,

86 *
	t__»¥Ën
);

91 
	#MAXNS
 3

	)

92 
	#MAXDFLSRCH
 3

	)

93 
	#MAXDNSRCH
 6

	)

94 
	#LOCALDOMAINPARTS
 2

	)

96 
	#RES_TIMEOUT
 5

	)

97 
	#MAXRESOLVSORT
 10

	)

98 
	#RES_MAXNDOTS
 15

	)

99 
	#RES_MAXRETRANS
 30

	)

100 
	#RES_MAXRETRY
 5

	)

101 
	#RES_DFLRETRY
 2

	)

102 
	#RES_MAXTIME
 65535

	)

104 
	s__»s_¡©e
 {

105 
»Œªs
;

106 
»Œy
;

107 
u_lÚg
 
İtiÚs
;

108 
nscouÁ
;

109 
sockaddr_š


110 
n§ddr_li¡
[
MAXNS
];

111 
	#n§ddr
 
n§ddr_li¡
[0]

	)

112 
u_shÜt
 
id
;

114 *
dn¤ch
[
MAXDNSRCH
+1];

115 
defdÇme
[256];

116 
u_lÚg
 
pfcode
;

117 
ndÙs
:4;

118 
nsÜt
:4;

119 
v6_uÇva
:1;

120 
unu£d
:23;

122 
š_addr
 
addr
;

123 
u_št32_t
 
mask
;

124 } 
sÜt_li¡
[
MAXRESOLVSORT
];

126 
»s_£nd_qhook
 
qhook
;

127 
»s_£nd_rhook
 
rhook
;

128 
»s_h_”ºo
;

129 
_vcsock
;

130 
u_št
 
_æags
;

133 
·d
[52];

135 
u_št16_t
 
nscouÁ
;

136 
u_št16_t
 
nsm­
[
MAXNS
];

137 
nssocks
[
MAXNS
];

138 
u_št16_t
 
nscouÁ6
;

139 
u_št16_t
 
nsš™
;

140 
sockaddr_š6
 *
n§ddrs
[
MAXNS
];

141 #ifdeà
_LIBC


142 
š™¡amp


143 
	`__©Œibu‹__
((
·cked
));

145 
_š™¡amp
[2];

147 } 
_ext
;

148 } 
_u
;

151 
__»s_¡©e
 *
	t»s_¡©e
;

152 #undeà
__Ãed_»s_¡©e


155 #ifdeà
_RESOLV_H_


164 
	#__RES
 19991006

	)

172 #iâdeà
_PATH_RESCONF


173 
	#_PATH_RESCONF
 "/‘c/»sŞv.cÚf"

	)

176 
	s»s_sym
 {

177 
numb”
;

178 * 
Çme
;

179 * 
humªÇme
;

185 
	#RES_F_VC
 0x00000001

	)

186 
	#RES_F_CONN
 0x00000002

	)

187 
	#RES_F_EDNS0ERR
 0x00000004

	)

190 
	#RES_EXHAUSTIVE
 0x00000001

	)

195 
	#RES_INIT
 0x00000001

	)

196 
	#RES_DEBUG
 0x00000002

	)

197 
	#RES_AAONLY
 0x00000004

	)

198 
	#RES_USEVC
 0x00000008

	)

199 
	#RES_PRIMARY
 0x00000010

	)

200 
	#RES_IGNTC
 0x00000020

	)

201 
	#RES_RECURSE
 0x00000040

	)

202 
	#RES_DEFNAMES
 0x00000080

	)

203 
	#RES_STAYOPEN
 0x00000100

	)

204 
	#RES_DNSRCH
 0x00000200

	)

205 
	#RES_INSECURE1
 0x00000400

	)

206 
	#RES_INSECURE2
 0x00000800

	)

207 
	#RES_NOALIASES
 0x00001000

	)

208 
	#RES_USE_INET6
 0x00002000

	)

209 
	#RES_ROTATE
 0x00004000

	)

210 
	#RES_NOCHECKNAME
 0x00008000

	)

211 
	#RES_KEEPTSIG
 0x00010000

	)

212 
	#RES_BLAST
 0x00020000

	)

213 
	#RES_USEBSTRING
 0x00040000

	)

215 
	#RES_NOIP6DOTINT
 0x00080000

	)

217 
	#RES_USE_EDNS0
 0x00100000

	)

218 
	#RES_SNGLKUP
 0x00200000

	)

219 
	#RES_SNGLKUPREOP
 0x00400000

	)

221 
	#RES_USE_DNSSEC
 0x00800000

	)

222 
	#RES_NOTLDQUERY
 0x01000000

	)

225 
	#RES_DEFAULT
 (
RES_RECURSE
|
RES_DEFNAMES
|
RES_DNSRCH
|
RES_NOIP6DOTINT
)

	)

230 
	#RES_PRF_STATS
 0x00000001

	)

231 
	#RES_PRF_UPDATE
 0x00000002

	)

232 
	#RES_PRF_CLASS
 0x00000004

	)

233 
	#RES_PRF_CMD
 0x00000008

	)

234 
	#RES_PRF_QUES
 0x00000010

	)

235 
	#RES_PRF_ANS
 0x00000020

	)

236 
	#RES_PRF_AUTH
 0x00000040

	)

237 
	#RES_PRF_ADD
 0x00000080

	)

238 
	#RES_PRF_HEAD1
 0x00000100

	)

239 
	#RES_PRF_HEAD2
 0x00000200

	)

240 
	#RES_PRF_TTLID
 0x00000400

	)

241 
	#RES_PRF_HEADX
 0x00000800

	)

242 
	#RES_PRF_QUERY
 0x00001000

	)

243 
	#RES_PRF_REPLY
 0x00002000

	)

244 
	#RES_PRF_INIT
 0x00004000

	)

248 
__BEGIN_DECLS


249 
__»s_¡©e
 *
	$__»s_¡©e
(è
	`__©Œibu‹__
 ((
__cÚ¡__
));

250 
__END_DECLS


251 
	#_»s
 (*
	`__»s_¡©e
())

	)

253 #iâdeà
__BIND_NOSTATIC


254 
	#å_nqu”y
 
__å_nqu”y


	)

255 
	#å_qu”y
 
__å_qu”y


	)

256 
	#ho¡®Ÿs
 
__ho¡®Ÿs


	)

257 
	#p_qu”y
 
__p_qu”y


	)

258 
	#»s_şo£
 
__»s_şo£


	)

259 
	#»s_š™
 
__»s_š™


	)

260 
	#»s_isour£rv”
 
__»s_isour£rv”


	)

261 
	#»s_mkqu”y
 
__»s_mkqu”y


	)

262 
	#»s_qu”y
 
__»s_qu”y


	)

263 
	#»s_qu”ydomaš
 
__»s_qu”ydomaš


	)

264 
	#»s_£¬ch
 
__»s_£¬ch


	)

265 
	#»s_£nd
 
__»s_£nd


	)

267 
__BEGIN_DECLS


268 
	$å_nqu”y
 (cÚ¡ 
u_ch¬
 *, , 
FILE
 *è
__THROW
;

269 
	$å_qu”y
 (cÚ¡ 
u_ch¬
 *, 
FILE
 *è
__THROW
;

270 cÚ¡ * 
	$ho¡®Ÿs
 (cÚ¡ *è
__THROW
;

271 
	$p_qu”y
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

272 
	$»s_şo£
 (è
__THROW
;

273 
	$»s_š™
 (è
__THROW
;

274 
	$»s_isour£rv”
 (cÚ¡ 
sockaddr_š
 *è
__THROW
;

275 
	$»s_mkqu”y
 (, cÚ¡ *, , , cÚ¡ 
u_ch¬
 *,

276 , cÚ¡ 
u_ch¬
 *, u_ch¬ *, è
__THROW
;

277 
	$»s_qu”y
 (cÚ¡ *, , , 
u_ch¬
 *, è
__THROW
;

278 
	$»s_qu”ydomaš
 (const *, const *, , ,

279 
u_ch¬
 *, è
__THROW
;

280 
	$»s_£¬ch
 (cÚ¡ *, , , 
u_ch¬
 *, è
__THROW
;

281 
	$»s_£nd
 (cÚ¡ 
u_ch¬
 *, , u_ch¬ *, è
__THROW
;

282 
__END_DECLS


285 
	#b64_Áİ
 
__b64_Áİ


	)

286 
	#b64_±Ú
 
__b64_±Ú


	)

287 
	#dn_comp
 
__dn_comp


	)

288 
	#dn_couÁ_Ïb–s
 
__dn_couÁ_Ïb–s


	)

289 
	#dn_ex·nd
 
__dn_ex·nd


	)

290 
	#dn_skÇme
 
__dn_skÇme


	)

291 
	#å_»s¡©
 
__å_»s¡©


	)

292 
	#loc_©Ú
 
__loc_©Ú


	)

293 
	#loc_Áß
 
__loc_Áß


	)

294 
	#p_cdÇme
 
__p_cdÇme


	)

295 
	#p_cdÂame
 
__p_cdÂame


	)

296 
	#p_şass
 
__p_şass


	)

297 
	#p_fqÇme
 
__p_fqÇme


	)

298 
	#p_fqÂame
 
__p_fqÂame


	)

299 
	#p_İtiÚ
 
__p_İtiÚ


	)

300 
	#p_£c¡od©e
 
__p_£c¡od©e


	)

301 
	#p_£ùiÚ
 
__p_£ùiÚ


	)

302 
	#p_time
 
__p_time


	)

303 
	#p_ty³
 
__p_ty³


	)

304 
	#p_rcode
 
__p_rcode


	)

305 
	#puÚg
 
__puÚg


	)

306 
	#putshÜt
 
__putshÜt


	)

307 
	#»s_dnok
 
__»s_dnok


	)

308 
	#»s_hnok
 
__»s_hnok


	)

309 
	#»s_ho¡®Ÿs
 
__»s_ho¡®Ÿs


	)

310 
	#»s_maok
 
__»s_maok


	)

311 
	#»s_Çmešqu”y
 
__»s_Çmešqu”y


	)

312 
	#»s_nşo£
 
__»s_nşo£


	)

313 
	#»s_nš™
 
__»s_nš™


	)

314 
	#»s_nmkqu”y
 
__»s_nmkqu”y


	)

315 
	#»s_Åqu”y
 
__»s_Åqu”y


	)

316 
	#»s_nqu”y
 
__»s_nqu”y


	)

317 
	#»s_nqu”ydomaš
 
__»s_nqu”ydomaš


	)

318 
	#»s_n£¬ch
 
__»s_n£¬ch


	)

319 
	#»s_n£nd
 
__»s_n£nd


	)

320 
	#»s_nisour£rv”
 
__»s_nisour£rv”


	)

321 
	#»s_ownok
 
__»s_ownok


	)

322 
	#»s_qu”›sm©ch
 
__»s_qu”›sm©ch


	)

323 
	#»s_¿ndomid
 
__»s_¿ndomid


	)

324 
	#sym_Áİ
 
__sym_Áİ


	)

325 
	#sym_Áos
 
__sym_Áos


	)

326 
	#sym_¡Ú
 
__sym_¡Ú


	)

327 
__BEGIN_DECLS


328 
	$»s_hnok
 (cÚ¡ *è
__THROW
;

329 
	$»s_ownok
 (cÚ¡ *è
__THROW
;

330 
	$»s_maok
 (cÚ¡ *è
__THROW
;

331 
	$»s_dnok
 (cÚ¡ *è
__THROW
;

332 
	$sym_¡Ú
 (cÚ¡ 
»s_sym
 *, cÚ¡ *, *è
__THROW
;

333 cÚ¡ * 
	$sym_Áos
 (cÚ¡ 
»s_sym
 *, , *è
__THROW
;

334 cÚ¡ * 
	$sym_Áİ
 (cÚ¡ 
»s_sym
 *, , *è
__THROW
;

335 
	$b64_Áİ
 (
u_ch¬
 cÚ¡ *, 
size_t
, *, size_tè
__THROW
;

336 
	$b64_±Ú
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
è
__THROW
;

337 
	$loc_©Ú
 (cÚ¡ *
__ascii
, 
u_ch¬
 *
__bš¬y
è
__THROW
;

338 cÚ¡ * 
	$loc_Áß
 (cÚ¡ 
u_ch¬
 *
__bš¬y
, *
__ascii
è
__THROW
;

339 
	$dn_skÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

340 
	$puÚg
 (
u_št32_t
, 
u_ch¬
 *è
__THROW
;

341 
	$putshÜt
 (
u_št16_t
, 
u_ch¬
 *è
__THROW
;

342 cÚ¡ * 
	$p_şass
 (è
__THROW
;

343 cÚ¡ * 
	$p_time
 (
u_št32_t
è
__THROW
;

344 cÚ¡ * 
	$p_ty³
 (è
__THROW
;

345 cÚ¡ * 
	$p_rcode
 (è
__THROW
;

346 cÚ¡ 
u_ch¬
 * 
	$p_cdÂame
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, , 
FILE
 *)

347 
__THROW
;

348 cÚ¡ 
u_ch¬
 * 
	$p_cdÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
FILE
 *è
__THROW
;

349 cÚ¡ 
u_ch¬
 * 
	$p_fqÂame
 (cÚ¡ 
u_ch¬
 *
__ı
, cÚ¡ u_ch¬ *
__msg
,

350 , *, è
__THROW
;

351 cÚ¡ 
u_ch¬
 * 
	$p_fqÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
FILE
 *è
__THROW
;

352 cÚ¡ * 
	$p_İtiÚ
 (
u_lÚg
 
__İtiÚ
è
__THROW
;

353 * 
	$p_£c¡od©e
 (
u_lÚg
è
__THROW
;

354 
	$dn_couÁ_Ïb–s
 (cÚ¡ *è
__THROW
;

355 
	$dn_comp
 (cÚ¡ *, 
u_ch¬
 *, , u_char **, u_char **)

356 
__THROW
;

357 
	$dn_ex·nd
 (cÚ¡ 
u_ch¬
 *, const u_char *, const u_char *,

358 *, è
__THROW
;

359 
u_št
 
	$»s_¿ndomid
 (è
__THROW
;

360 
	$»s_Çmešqu”y
 (const *, , ,

361 cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

362 
	$»s_qu”›sm©ch
 (cÚ¡ 
u_ch¬
 *, const u_char *,

363 cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

364 cÚ¡ * 
	$p_£ùiÚ
 (
__£ùiÚ
, 
__İcode
è
__THROW
;

366 
	$»s_nš™
 (
»s_¡©e
è
__THROW
;

367 
	$»s_nisour£rv”
 (cÚ¡ 
»s_¡©e
,

368 cÚ¡ 
sockaddr_š
 *è
__THROW
;

369 
	$å_»s¡©
 (cÚ¡ 
»s_¡©e
, 
FILE
 *è
__THROW
;

370 
	$»s_Åqu”y
 (cÚ¡ 
»s_¡©e
, cÚ¡ 
u_ch¬
 *, , 
FILE
 *)

371 
__THROW
;

372 cÚ¡ * 
	$»s_ho¡®Ÿs
 (cÚ¡ 
»s_¡©e
, cÚ¡ *, *, 
size_t
)

373 
__THROW
;

374 
	$»s_nqu”y
 (
»s_¡©e
, cÚ¡ *, , , 
u_ch¬
 *, )

375 
__THROW
;

376 
	$»s_n£¬ch
 (
»s_¡©e
, cÚ¡ *, , , 
u_ch¬
 *, )

377 
__THROW
;

378 
	$»s_nqu”ydomaš
 (
»s_¡©e
, const *, const *, ,

379 , 
u_ch¬
 *, è
__THROW
;

380 
	$»s_nmkqu”y
 (
»s_¡©e
, , const *, , ,

381 cÚ¡ 
u_ch¬
 *, , const u_char *, u_char *,

382 è
__THROW
;

383 
	$»s_n£nd
 (
»s_¡©e
, cÚ¡ 
u_ch¬
 *, , u_char *, )

384 
__THROW
;

385 
	$»s_nşo£
 (
»s_¡©e
è
__THROW
;

386 
__END_DECLS


	@/usr/include/rpc/types.h

34 #iâdeà
_RPC_TYPES_H


35 
	#_RPC_TYPES_H
 1

	)

37 
	tboŞ_t
;

38 
	t’um_t
;

40 
	t½ırog_t
;

41 
	t½cv”s_t
;

42 
	t½ıroc_t
;

43 
	t½ırÙ_t
;

44 
	t½ıÜt_t
;

46 
	#__dÚtÿ»__
 -1

	)

48 #iâdeà
FALSE


49 
	#FALSE
 (0)

	)

52 #iâdeà
TRUE


53 
	#TRUE
 (1)

	)

56 #iâdeà
NULL


57 
	#NULL
 0

	)

60 
	~<¡dlib.h
>

61 
	#mem_®loc
(
bsize
è
	`m®loc
(bsize)

	)

66 
	#mem_ä“
(
±r
, 
bsize
è
	`ä“
ÕŒ)

	)

68 #iâdeà
makedev


69 
	~<sys/ty³s.h
>

72 #ià
defšed
 
__APPLE_CC__
 || defšed 
__F»eBSD__


73 
	#__u_ch¬_defšed


	)

74 
	#__daddr_t_defšed


	)

77 #iâdeà
__u_ch¬_defšed


78 
__u_ch¬
 
	tu_ch¬
;

79 
__u_shÜt
 
	tu_shÜt
;

80 
__u_št
 
	tu_št
;

81 
__u_lÚg
 
	tu_lÚg
;

82 
__quad_t
 
	tquad_t
;

83 
__u_quad_t
 
	tu_quad_t
;

84 
__fsid_t
 
	tfsid_t
;

85 
	#__u_ch¬_defšed


	)

87 #iâdeà
__daddr_t_defšed


88 
__daddr_t
 
	tdaddr_t
;

89 
__ÿddr_t
 
	tÿddr_t
;

90 
	#__daddr_t_defšed


	)

93 
	~<sys/time.h
>

94 
	~<sys/·¿m.h
>

96 
	~<Ãtš‘/š.h
>

98 #iâdeà
INADDR_LOOPBACK


99 
	#INADDR_LOOPBACK
 (
u_lÚg
)0x7F000001

	)

101 #iâdeà
MAXHOSTNAMELEN


102 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/shadow.h

20 #iâdeà
_SHADOW_H


21 
	#_SHADOW_H
 1

	)

23 
	~<ã©u»s.h
>

25 
	~<·ths.h
>

27 
	#__Ãed_FILE


	)

28 
	~<¡dio.h
>

29 
	#__Ãed_size_t


	)

30 
	~<¡ddef.h
>

33 
	#SHADOW
 
_PATH_SHADOW


	)

36 
__BEGIN_DECLS


39 
	s¥wd


41 *
	m¥_Çmp
;

42 *
	m¥_pwdp
;

43 
	m¥_l¡chg
;

44 
	m¥_mš
;

45 
	m¥_max
;

46 
	m¥_w¬n
;

48 
	m¥_šaù
;

50 
	m¥_expœe
;

52 
	m¥_æag
;

62 
£t¥’t
 ();

70 
’d¥’t
 ();

78 
¥wd
 *
g‘¥’t
 ();

86 
¥wd
 *
g‘¥Çm
 (cÚ¡ *
__Çme
);

94 
¥wd
 *
sg‘¥’t
 (cÚ¡ *
__¡ršg
);

102 
¥wd
 *
fg‘¥’t
 (
FILE
 *
__¡»am
);

110 
put¥’t
 (cÚ¡ 
¥wd
 *
__p
, 
FILE
 *
__¡»am
);

113 #ifdeà
__USE_MISC


120 
g‘¥’t_r
 (
¥wd
 *
__»suÉ_buf
, *
__bufãr
,

121 
size_t
 
__buæ’
, 
¥wd
 **
__»suÉ
);

123 
g‘¥Çm_r
 (cÚ¡ *
__Çme
, 
¥wd
 *
__»suÉ_buf
,

124 *
__bufãr
, 
size_t
 
__buæ’
,

125 
¥wd
 **
__»suÉ
);

127 
sg‘¥’t_r
 (cÚ¡ *
__¡ršg
, 
¥wd
 *
__»suÉ_buf
,

128 *
__bufãr
, 
size_t
 
__buæ’
,

129 
¥wd
 **
__»suÉ
);

131 
fg‘¥’t_r
 (
FILE
 *
__¡»am
, 
¥wd
 *
__»suÉ_buf
,

132 *
__bufãr
, 
size_t
 
__buæ’
,

133 
¥wd
 **
__»suÉ
);

141 
	$lckpwdf
 (è
__THROW
;

144 
	$ulckpwdf
 (è
__THROW
;

146 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_BSD


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_SVID


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 #ifdeà
__USE_XOPEN2K


156 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

167 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

169 #ifdeà
__USE_XOPEN


170 #ifdeà
__GNUC__


171 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

174 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

179 #ifdeà
__USE_BSD


186 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

192 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

195 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 #ifdeà
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifdeà
__USE_GNU


204 
__sighªdËr_t
 
	tsighªdËr_t
;

208 #ifdeà
__USE_BSD


209 
__sighªdËr_t
 
	tsig_t
;

212 #ifdeà
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

224 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

227 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__nÚnuÎ
 ((1));

230 #ifdeà
__USE_GNU


232 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

235 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

236 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

239 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

240 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

245 
	~<b™s/sigaùiÚ.h
>

248 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

249 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

256 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

259 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

260 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

263 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

270 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

271 
	`__nÚnuÎ
 ((1, 2));

273 #ifdeà
__USE_POSIX199309


278 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

279 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

286 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

287 
sigšfo_t
 *
__»¡riù
 
__šfo
,

288 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

289 
	`__nÚnuÎ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

294 
__THROW
;

299 #ifdeà
__USE_BSD


303 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

304 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

307 
	ssigvec


309 
__sighªdËr_t
 
sv_hªdËr
;

310 
sv_mask
;

312 
sv_æags
;

313 
	#sv_Ú¡ack
 
sv_æags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, cÚ¡ 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
è
__THROW
;

332 
	~<b™s/sigcÚ‹xt.h
>

335 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

340 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


341 
	#__Ãed_size_t


	)

342 
	~<¡ddef.h
>

347 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

349 
	~<b™s/sig¡ack.h
>

350 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


352 
	~<sys/ucÚ‹xt.h
>

358 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

359 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

363 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

364 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

368 #ifdeà
__USE_XOPEN_EXTENDED


372 
	$sighŞd
 (
__sig
è
__THROW
;

375 
	$sig»l£
 (
__sig
è
__THROW
;

378 
	$sigignÜe
 (
__sig
è
__THROW
;

381 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

384 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


387 
	~<b™s/±h»adty³s.h
>

388 
	~<b™s/sigth»ad.h
>

395 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

397 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

401 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #iâdeà
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
è
	)
c

279 
	#INT16_C
(
c
è
	)
c

280 
	#INT32_C
(
c
è
	)
c

281 #ià
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
èø## 
L


	)

284 
	#INT64_C
(
c
èø## 
LL


	)

288 
	#UINT8_C
(
c
è
	)
c

289 
	#UINT16_C
(
c
è
	)
c

290 
	#UINT32_C
(
c
èø## 
U


	)

291 #ià
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
èø## 
UL


	)

294 
	#UINT64_C
(
c
èø## 
ULL


	)

298 #ià
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
èø## 
L


	)

300 
	#UINTMAX_C
(
c
èø## 
UL


	)

302 
	#INTMAX_C
(
c
èø## 
LL


	)

303 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

868 
defšed
 
__USE_MISC
)

873 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

879 
	`pşo£
 (
FILE
 *
__¡»am
);

883 #ifdef 
__USE_POSIX


885 *
	$ù”mid
 (*
__s
è
__THROW
;

889 #ifdeà
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob¡ack
;

899 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

900 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

901 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

902 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

903 cÚ¡ *
__»¡riù
 
__fÜm©
,

904 
_G_va_li¡
 
__¬gs
)

905 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

909 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


913 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

917 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

920 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

923 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


927 
	#__Ãed_g‘İt


	)

928 
	~<g‘İt.h
>

933 #ifdeà
__USE_EXTERN_INLINES


934 
	~<b™s/¡dio.h
>

936 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


937 
	~<b™s/¡dio2.h
>

939 #ifdeà
__LDBL_COMPAT


940 
	~<b™s/¡dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_BSD


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_BSD


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_BSD


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 \

610 || 
defšed
 
__USE_XOPEN2K8


619 #iâdeà
__USE_FILE_OFFSET64


620 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

622 #ifdeà
__REDIRECT


623 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

624 
	`__nÚnuÎ
 ((1)è
__wur
;

626 
	#mk¡emp
 
mk¡emp64


	)

629 #ifdeà
__USE_LARGEFILE64


630 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

634 #ifdeà
__USE_MISC


641 #iâdeà
__USE_FILE_OFFSET64


642 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

644 #ifdeà
__REDIRECT


645 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

646 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 
	#mk¡emps
 
mk¡emps64


	)

651 #ifdeà
__USE_LARGEFILE64


652 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

653 
	`__nÚnuÎ
 ((1)è
__wur
;

657 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


663 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

666 #ifdeà
__USE_GNU


673 #iâdeà
__USE_FILE_OFFSET64


674 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

676 #ifdeà
__REDIRECT


677 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

678 
	`__nÚnuÎ
 ((1)è
__wur
;

680 
	#mko¡emp
 
mko¡emp64


	)

683 #ifdeà
__USE_LARGEFILE64


684 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

693 #iâdeà
__USE_FILE_OFFSET64


694 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

695 
	`__nÚnuÎ
 ((1)è
__wur
;

697 #ifdeà
__REDIRECT


698 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

699 
__æags
), 
mko¡emps64
)

700 
	`__nÚnuÎ
 ((1)è
__wur
;

702 
	#mko¡emps
 
mko¡emps64


	)

705 #ifdeà
__USE_LARGEFILE64


706 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

707 
	`__nÚnuÎ
 ((1)è
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

725 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

728 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


734 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

735 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

740 #iâdeà
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com·r_â_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com·r_â_t
 
	tcom·risÚ_â_t
;

748 #ifdeà
__USE_GNU


749 (*
	t__com·r_d_â_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

756 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

757 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

759 #ifdeà
__USE_EXTERN_INLINES


760 
	~<b™s/¡dlib-b£¬ch.h
>

765 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

766 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

767 #ifdeà
__USE_GNU


768 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

769 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

770 
	`__nÚnuÎ
 ((1, 4));

775 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

777 
__END_NAMESPACE_STD


779 #ifdeà
__USE_ISOC99


780 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

781 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__num”
, 
__d’om
)

790 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

792 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

793 
__END_NAMESPACE_STD


795 #ifdeà
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

798 
__d’om
)

799 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

800 
__END_NAMESPACE_C99


804 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

805 || 
defšed
 
__USE_SVID


812 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

813 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

818 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

819 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

824 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

825 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

828 #ifdeà
__USE_MISC


830 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

831 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

832 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

833 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

834 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

835 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

836 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

837 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

842 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

843 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

844 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

846 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

847 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

850 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

851 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

852 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

854 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

855 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

856 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

866 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

867 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

870 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

874 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

875 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

877 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

878 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifdeà
__USE_SVID


888 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


899 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

900 *cÚ¡ *
__»¡riù
 
__tok’s
,

901 **
__»¡riù
 
__v®u•
)

902 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

906 #ifdeà
__USE_XOPEN


908 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

914 #ifdeà
__USE_XOPEN2KXSI


916 
	$posix_İ’±
 (
__oæag
è
__wur
;

919 #ifdeà
__USE_XOPEN


924 
	$g¿Á±
 (
__fd
è
__THROW
;

928 
	$uÆock±
 (
__fd
è
__THROW
;

933 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

936 #ifdeà
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

941 
__THROW
 
	`__nÚnuÎ
 ((2));

944 
	`g‘±
 ();

947 #ifdeà
__USE_BSD


951 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

952 
__THROW
 
	`__nÚnuÎ
 ((1));

955 
	~<b™s/¡dlib-æßt.h
>

958 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


959 
	~<b™s/¡dlib.h
>

961 #ifdeà
__LDBL_COMPAT


962 
	~<b™s/¡dlib-ldbl.h
>

966 #undeà
__Ãed_m®loc_ªd_ÿÎoc


968 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

39 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

47 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

50 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

51 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


58 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

69 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

73 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


91  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifdeà
__USE_GNU


104 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

107 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

110 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

111 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

115 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

118 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

133 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

137 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

138 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

141 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

144 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

151 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

154 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

155 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

156 
__THROW
 
	`__nÚnuÎ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifdeà
__USE_XOPEN2K8


163 
	~<xloÿË.h
>

166 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

169 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

170 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

173 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

174 || 
defšed
 
__USE_XOPEN2K8


176 *
	$¡rdup
 (cÚ¡ *
__s
)

177 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_XOPEN2K8


184 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

185 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

188 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


190 
	#¡rdu·
(
s
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

196 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

197 
	}
}))

	)

200 
	#¡ºdu·
(
s
, 
n
) \

201 (
__ex‹nsiÚ__
 \

203 cÚ¡ *
__Şd
 = (
s
); \

204 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

205 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

206 
__Ãw
[
__Ën
] = '\0'; \

207 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
¡rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

218 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

221 #ifdeà
__OPTIMIZE__


222 
__ex‹º_®ways_šlše
 *

223 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


225  
__butš_¡rchr
 (
__s
, 
__c
);

228 
__ex‹º_®ways_šlše
 const *

229 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


231  
__butš_¡rchr
 (
__s
, 
__c
);

236 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

237 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`¡¼chr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

245 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

248 #ifdeà
__OPTIMIZE__


249 
__ex‹º_®ways_šlše
 *

250 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


252  
	`__butš_¡¼chr
 (
__s
, 
__c
);

255 
__ex‹º_®ways_šlše
 const *

256 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


258  
	`__butš_¡¼chr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

264 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifdeà
__USE_GNU


271 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

274 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

278 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

286 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

289 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

290 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

296 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

298 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

300 #ifdeà
__OPTIMIZE__


301 
__ex‹º_®ways_šlše
 *

302 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


304  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

307 
__ex‹º_®ways_šlše
 const *

308 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


310  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

313 
	}
}

315 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

316 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

323 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

324 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 const *

335 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 cÚ¡ *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

370 cÚ¡ *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 const *

482 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 const *

510 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

530 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

534 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

535 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

538 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

546 
__loÿË_t
 
__loc
)

547 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

549 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

550 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

551 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

558 cÚ¡ *
__»¡riù
 
__d–im
)

559 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

567 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

568 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

575 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

578 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

585 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

588 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 #iâdeà
ba£Çme


598 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£Çme
 (*
__f’ame
)

600 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

601 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

604 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

610 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

611 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

612 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


632 
	~<b™s/¡ršg.h
>

635 
	~<b™s/¡ršg2.h
>

638 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


640 
	~<b™s/¡ršg3.h
>

644 
__END_DECLS


	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

24 #ià!
defšed
 
_STRING_H
 || !defšed 
__USE_BSD


26 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

35 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

36 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

39 
	g__BEGIN_DECLS


41 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


43 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

44 
__THROW
 
__©Œibu‹_pu»__
;

47 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
è
__THROW
;

50 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
;

53 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


56 *
	`šdex
 (*
__s
, 
__c
)

57 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

58 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

59 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

61 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


62 
__ex‹º_®ways_šlše
 *

63 
	`šdex
 (*
__s
, 
__c
è
__THROW


65  
	`__butš_šdex
 (
__s
, 
__c
);

68 
__ex‹º_®ways_šlše
 const *

69 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


71  
	`__butš_šdex
 (
__s
, 
__c
);

74 
	}
}

76 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

77 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


84 *
	`ršdex
 (*
__s
, 
__c
)

85 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

86 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

87 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

89 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


90 
__ex‹º_®ways_šlše
 *

91 
	`ršdex
 (*
__s
, 
__c
è
__THROW


93  
	`__butš_ršdex
 (
__s
, 
__c
);

96 
__ex‹º_®ways_šlše
 const *

97 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


99  
	`__butš_ršdex
 (
__s
, 
__c
);

102 
	}
}

104 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

105 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

109 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


112 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((const));

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
;

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
;

123 #ifdef 
__USE_XOPEN2K8


127 
	~<xloÿË.h
>

131 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__loc
)

132 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

134 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

135 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

136 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

139 
__END_DECLS


	@/usr/include/stropts.h

18 #iâdeà
_STROPTS_H


19 
	#_STROPTS_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<b™s/ty³s.h
>

23 
	~<b™s/xt™y³s.h
>

25 #iâdeà
__gid_t_defšed


26 
__gid_t
 
	tgid_t
;

27 
	#__gid_t_defšed


	)

30 #iâdeà
__uid_t_defšed


31 
__uid_t
 
	tuid_t
;

32 
	#__uid_t_defšed


	)

35 
__t_sÿÏr_t
 
	tt_sÿÏr_t
;

36 
__t_usÿÏr_t
 
	tt_usÿÏr_t
;

39 
	~<b™s/¡rİts.h
>

42 
__BEGIN_DECLS


45 
	$i§¡»am
 (
__fdes
è
__THROW
;

51 
	`g‘msg
 (
__fdes
, 
¡rbuf
 *
__»¡riù
 
__ùÍŒ
,

52 
¡rbuf
 *
__»¡riù
 
__d©­Œ
,

53 *
__»¡riù
 
__æag¥
);

60 
	`g‘pmsg
 (
__fdes
, 
¡rbuf
 *
__»¡riù
 
__ùÍŒ
,

61 
¡rbuf
 *
__»¡riù
 
__d©­Œ
,

62 *
__»¡riù
 
__bªdp
, *__»¡riù 
__æag¥
);

67 
	$ioùl
 (
__fd
, 
__»que¡
, ...è
__THROW
;

73 
	`putmsg
 (
__fdes
, cÚ¡ 
¡rbuf
 *
__ùÍŒ
,

74 cÚ¡ 
¡rbuf
 *
__d©­Œ
, 
__æags
);

80 
	`pumsg
 (
__fdes
, cÚ¡ 
¡rbuf
 *
__ùÍŒ
,

81 cÚ¡ 
¡rbuf
 *
__d©­Œ
, 
__bªd
, 
__æags
);

85 
	$ç‰ach
 (
__fdes
, cÚ¡ *
__·th
è
__THROW
;

88 
	$fd‘ach
 (cÚ¡ *
__·th
è
__THROW
;

90 
__END_DECLS


	@/usr/include/sys/bitypes.h

3 
	~<sys/ty³s.h
>

	@/usr/include/sys/cdefs.h

18 #iâdef 
_SYS_CDEFS_H


19 
	#_SYS_CDEFS_H
 1

	)

22 #iâdeà
_FEATURES_H


23 
	~<ã©u»s.h
>

29 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


34 #undeà
__P


35 #undeà
__PMT


37 #ifdeà
__GNUC__


41 #ià
__GNUC_PREREQ
 (4, 6è&& !
defšed
 
_LIBC


42 
	#__LEAF
 , 
__Ëaf__


	)

43 
	#__LEAF_ATTR
 
	`__©Œibu‹__
 ((
__Ëaf__
))

	)

45 
	#__LEAF


	)

46 
	#__LEAF_ATTR


	)

54 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

55 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
))

	)

56 
	#__THROWNL
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

57 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
)è
	)
fct

59 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

60 
	#__THROW
 
	`throw
 ()

	)

61 
	#__THROWNL
 
	`throw
 ()

	)

62 
	#__NTH
(
fù
è
__LEAF_ATTR
 fù 
	`throw
 ()

	)

64 
	#__THROW


	)

65 
	#__THROWNL


	)

66 
	#__NTH
(
fù
è
	)
fct

72 
	#__šlše


	)

74 
	#__THROW


	)

75 
	#__THROWNL


	)

76 
	#__NTH
(
fù
è
	)
fct

82 
	#__P
(
¬gs
è
	)
args

83 
	#__PMT
(
¬gs
è
	)
args

88 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

89 
	#__STRING
(
x
è#x

	)

92 
	#__±r_t
 *

	)

93 
	#__lÚg_doubË_t
 

	)

97 #ifdef 
__ılu¥lus


98 
	#__BEGIN_DECLS
 "C" {

	)

99 
	#__END_DECLS
 }

	)

101 
	#__BEGIN_DECLS


	)

102 
	#__END_DECLS


	)

111 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


112 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

113 
	#__END_NAMESPACE_STD
 }

	)

114 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

115 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

116 
	#__END_NAMESPACE_C99
 }

	)

117 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

122 
	#__BEGIN_NAMESPACE_STD


	)

123 
	#__END_NAMESPACE_STD


	)

124 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

125 
	#__BEGIN_NAMESPACE_C99


	)

126 
	#__END_NAMESPACE_C99


	)

127 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

134 
	#__fÜtify_funùiÚ
 
__ex‹º_®ways_šlše
 
__©Œibu‹_¬tificŸl__


	)

136 #ià
__GNUC_PREREQ
 (4,3)

137 
	#__w¬ndeş
(
Çme
, 
msg
) \

138 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

139 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

140 
	#__”rÜdeş
(
Çme
, 
msg
) \

141 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

143 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

144 
	#__w¬Ç‰r
(
msg
)

	)

145 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

149 #ià
__GNUC_PREREQ
 (2,97)

151 
	#__æex¬r
 []

	)

153 #ifdeà
__GNUC__


154 
	#__æex¬r
 [0]

	)

156 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

157 
	#__æex¬r
 []

	)

160 
	#__æex¬r
 [1]

	)

176 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

178 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

179 #ifdeà
__ılu¥lus


180 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

181 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

182 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

183 
Çme
 
´Ùo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

185 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

186 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

187 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

188 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROWNL


	)

190 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

191 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

204 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

205 
	#__©Œibu‹__
(
xyz
è

	)

211 #ià
__GNUC_PREREQ
 (2,96)

212 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

214 
	#__©Œibu‹_m®loc__


	)

219 #ià
__GNUC_PREREQ
 (4, 3)

220 
	#__©Œibu‹_®loc_size__
(
·¿ms
) \

221 
	`__©Œibu‹__
 ((
__®loc_size__
 
·¿ms
))

	)

223 
	#__©Œibu‹_®loc_size__
(
·¿ms
è

	)

229 #ià
__GNUC_PREREQ
 (2,96)

230 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

232 
	#__©Œibu‹_pu»__


	)

236 #ià
__GNUC_PREREQ
 (2,5)

237 
	#__©Œibu‹_cÚ¡__
 
	`__©Œibu‹__
 ((
__cÚ¡__
))

	)

239 
	#__©Œibu‹_cÚ¡__


	)

245 #ià
__GNUC_PREREQ
 (3,1)

246 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

247 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

249 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

250 
	#__©Œibu‹_nošlše__


	)

254 #ià
__GNUC_PREREQ
 (3,2)

255 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

257 
	#__©Œibu‹_d•»ÿ‹d__


	)

266 #ià
__GNUC_PREREQ
 (2,8)

267 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

269 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

276 #ià
__GNUC_PREREQ
 (2,97)

277 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

278 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

280 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

285 #ià
__GNUC_PREREQ
 (3,3)

286 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

288 
	#__nÚnuÎ
(
·¿ms
)

	)

293 #ià
__GNUC_PREREQ
 (3,4)

294 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

295 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

296 #ià
__USE_FORTIFY_LEVEL
 > 0

297 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

300 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

302 #iâdeà
__wur


303 
	#__wur


	)

307 #ià
__GNUC_PREREQ
 (3,2)

308 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

310 
	#__®ways_šlše
 
__šlše


	)

315 #ià
__GNUC_PREREQ
 (4,3)

316 
	#__©Œibu‹_¬tificŸl__
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

318 
	#__©Œibu‹_¬tificŸl__


	)

321 #ifdeà
__GNUC__


326 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__GNUC_GNU_INLINE__


327 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

328 
	#__ex‹º_®ways_šlše
 \

329 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

331 
	#__ex‹º_šlše
 
__šlše


	)

332 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

335 
	#__ex‹º_šlše


	)

336 
	#__ex‹º_®ways_šlše


	)

341 #ià
__GNUC_PREREQ
 (4,3)

342 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

343 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

350 #ià!
__GNUC_PREREQ
 (2,8)

351 
	#__ex‹nsiÚ__


	)

355 #ià!
__GNUC_PREREQ
 (2,92)

356 
	#__»¡riù


	)

362 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


363 
	#__»¡riù_¬r
 
__»¡riù


	)

365 #ifdeà
__GNUC__


366 
	#__»¡riù_¬r


	)

368 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

369 
	#__»¡riù_¬r
 
»¡riù


	)

372 
	#__»¡riù_¬r


	)

377 #ià
__GNUC__
 >= 3

378 
	#__glibc_uÆik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 0)

	)

379 
	#__glibc_lik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 1)

	)

381 
	#__glibc_uÆik–y
(
cÚd
è(cÚd)

	)

382 
	#__glibc_lik–y
(
cÚd
è(cÚd)

	)

385 
	~<b™s/wÜdsize.h
>

387 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


388 
	#__LDBL_COMPAT
 1

	)

389 #ifdeà
__REDIRECT


390 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

391 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

392 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

393 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

394 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

395 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

396 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

397 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

398 
	#__LDBL_REDIR_DECL
(
Çme
) \

399 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

400 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

401 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

402 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

403 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

406 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


407 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

408 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

409 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

410 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

411 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

412 #ifdeà
__REDIRECT


413 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

414 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

415 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/sys/dir.h

18 #iâdef 
_SYS_DIR_H


19 
	#_SYS_DIR_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<dœ’t.h
>

25 
	#dœeù
 
dœ’t


	)

	@/usr/include/sys/ioctl.h

18 #iâdef 
_SYS_IOCTL_H


19 
	#_SYS_IOCTL_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	g__BEGIN_DECLS


26 
	~<b™s/ioùls.h
>

29 
	~<b™s/ioùl-ty³s.h
>

36 
	~<sys/‰ydeçuÉs.h
>

41 
	$ioùl
 (
__fd
, 
__»que¡
, ...è
__THROW
;

43 
__END_DECLS


	@/usr/include/sys/mman.h

19 #iâdef 
_SYS_MMAN_H


20 
	#_SYS_MMAN_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<b™s/ty³s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 #iâdeà
__off_t_defšed


28 #iâdeà
__USE_FILE_OFFSET64


29 
__off_t
 
	toff_t
;

31 
__off64_t
 
	toff_t
;

33 
	#__off_t_defšed


	)

36 #iâdeà
__mode_t_defšed


37 
__mode_t
 
	tmode_t
;

38 
	#__mode_t_defšed


	)

41 
	~<b™s/mmª.h
>

44 
	#MAP_FAILED
 ((*è-1)

	)

46 
	g__BEGIN_DECLS


56 #iâdeà
__USE_FILE_OFFSET64


57 *
	$mm­
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

58 
__æags
, 
__fd
, 
__off_t
 
__off£t
è
__THROW
;

60 #ifdeà
__REDIRECT_NTH


61 * 
	`__REDIRECT_NTH
 (
mm­
,

62 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

63 
__æags
, 
__fd
, 
__off64_t
 
__off£t
),

64 
mm­64
);

66 
	#mm­
 
mm­64


	)

69 #ifdeà
__USE_LARGEFILE64


70 *
	$mm­64
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

71 
__æags
, 
__fd
, 
__off64_t
 
__off£t
è
__THROW
;

76 
	$munm­
 (*
__addr
, 
size_t
 
__Ën
è
__THROW
;

81 
	$m´Ùeù
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
è
__THROW
;

89 
	`msync
 (*
__addr
, 
size_t
 
__Ën
, 
__æags
);

91 #ifdeà
__USE_BSD


94 
	$madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

96 #ifdeà
__USE_XOPEN2K


98 
	$posix_madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

103 
	$mlock
 (cÚ¡ *
__addr
, 
size_t
 
__Ën
è
__THROW
;

106 
	$muÆock
 (cÚ¡ *
__addr
, 
size_t
 
__Ën
è
__THROW
;

111 
	$mlock®l
 (
__æags
è
__THROW
;

115 
	$muÆock®l
 (è
__THROW
;

117 #ifdeà
__USE_MISC


123 
	$mšcÜe
 (*
__¡¬t
, 
size_t
 
__Ën
, *
__vec
)

124 
__THROW
;

127 #ifdeà
__USE_GNU


133 *
	$m»m­
 (*
__addr
, 
size_t
 
__Şd_Ën
, size_ˆ
__Ãw_Ën
,

134 
__æags
, ...è
__THROW
;

138 
	$»m­_fe_·ges
 (*
__¡¬t
, 
size_t
 
__size
, 
__´Ù
,

139 
size_t
 
__pgoff
, 
__æags
è
__THROW
;

144 
	`shm_İ’
 (cÚ¡ *
__Çme
, 
__oæag
, 
mode_t
 
__mode
);

147 
	`shm_uÆšk
 (cÚ¡ *
__Çme
);

149 
__END_DECLS


	@/usr/include/sys/mount.h

21 #iâdeà
_SYS_MOUNT_H


22 
	#_SYS_MOUNT_H
 1

	)

24 
	~<ã©u»s.h
>

25 
	~<sys/ioùl.h
>

27 
	#BLOCK_SIZE
 1024

	)

28 
	#BLOCK_SIZE_BITS
 10

	)

35 
	mMS_RDONLY
 = 1,

36 
	#MS_RDONLY
 
MS_RDONLY


	)

37 
	mMS_NOSUID
 = 2,

38 
	#MS_NOSUID
 
MS_NOSUID


	)

39 
	mMS_NODEV
 = 4,

40 
	#MS_NODEV
 
MS_NODEV


	)

41 
	mMS_NOEXEC
 = 8,

42 
	#MS_NOEXEC
 
MS_NOEXEC


	)

43 
	mMS_SYNCHRONOUS
 = 16,

44 
	#MS_SYNCHRONOUS
 
MS_SYNCHRONOUS


	)

45 
	mMS_REMOUNT
 = 32,

46 
	#MS_REMOUNT
 
MS_REMOUNT


	)

47 
	mMS_MANDLOCK
 = 64,

48 
	#MS_MANDLOCK
 
MS_MANDLOCK


	)

49 
	mMS_DIRSYNC
 = 128,

50 
	#MS_DIRSYNC
 
MS_DIRSYNC


	)

51 
	mMS_NOATIME
 = 1024,

52 
	#MS_NOATIME
 
MS_NOATIME


	)

53 
	mMS_NODIRATIME
 = 2048,

54 
	#MS_NODIRATIME
 
MS_NODIRATIME


	)

55 
	mMS_BIND
 = 4096,

56 
	#MS_BIND
 
MS_BIND


	)

57 
	mMS_MOVE
 = 8192,

58 
	#MS_MOVE
 
MS_MOVE


	)

59 
	mMS_REC
 = 16384,

60 
	#MS_REC
 
MS_REC


	)

61 
	mMS_SILENT
 = 32768,

62 
	#MS_SILENT
 
MS_SILENT


	)

63 
	mMS_POSIXACL
 = 1 << 16,

64 
	#MS_POSIXACL
 
MS_POSIXACL


	)

65 
	mMS_UNBINDABLE
 = 1 << 17,

66 
	#MS_UNBINDABLE
 
MS_UNBINDABLE


	)

67 
	mMS_PRIVATE
 = 1 << 18,

68 
	#MS_PRIVATE
 
MS_PRIVATE


	)

69 
	mMS_SLAVE
 = 1 << 19,

70 
	#MS_SLAVE
 
MS_SLAVE


	)

71 
	mMS_SHARED
 = 1 << 20,

72 
	#MS_SHARED
 
MS_SHARED


	)

73 
	mMS_RELATIME
 = 1 << 21,

74 
	#MS_RELATIME
 
MS_RELATIME


	)

75 
	mMS_KERNMOUNT
 = 1 << 22,

76 
	#MS_KERNMOUNT
 
MS_KERNMOUNT


	)

77 
	mMS_I_VERSION
 = 1 << 23,

78 
	#MS_I_VERSION
 
MS_I_VERSION


	)

79 
	mMS_STRICTATIME
 = 1 << 24,

80 
	#MS_STRICTATIME
 
MS_STRICTATIME


	)

81 
	mMS_ACTIVE
 = 1 << 30,

82 
	#MS_ACTIVE
 
MS_ACTIVE


	)

83 
	mMS_NOUSER
 = 1 << 31

84 
	#MS_NOUSER
 
MS_NOUSER


	)

88 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
)

	)

93 
	#MS_MGC_VAL
 0xc0ed0000

	)

94 
	#MS_MGC_MSK
 0xffff0000

	)

101 
	#BLKROSET
 
	`_IO
(0x12, 93è

	)

102 
	#BLKROGET
 
	`_IO
(0x12, 94è

	)

103 
	#BLKRRPART
 
	`_IO
(0x12, 95è

	)

104 
	#BLKGETSIZE
 
	`_IO
(0x12, 96è

	)

105 
	#BLKFLSBUF
 
	`_IO
(0x12, 97è

	)

106 
	#BLKRASET
 
	`_IO
(0x12, 98è

	)

107 
	#BLKRAGET
 
	`_IO
(0x12, 99è

	)

108 
	#BLKFRASET
 
	`_IO
(0x12,100è

	)

109 
	#BLKFRAGET
 
	`_IO
(0x12,101è

	)

110 
	#BLKSECTSET
 
	`_IO
(0x12,102è

	)

111 
	#BLKSECTGET
 
	`_IO
(0x12,103è

	)

112 
	#BLKSSZGET
 
	`_IO
(0x12,104è

	)

113 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

114 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

115 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

121 
	mMNT_FORCE
 = 1,

122 
	#MNT_FORCE
 
MNT_FORCE


	)

123 
	mMNT_DETACH
 = 2,

124 
	#MNT_DETACH
 
MNT_DETACH


	)

125 
	mMNT_EXPIRE
 = 4,

126 
	#MNT_EXPIRE
 
MNT_EXPIRE


	)

127 
	mUMOUNT_NOFOLLOW
 = 8

128 
	#UMOUNT_NOFOLLOW
 
UMOUNT_NOFOLLOW


	)

132 
__BEGIN_DECLS


135 
	$mouÁ
 (cÚ¡ *
__¥ecŸl_fe
, cÚ¡ *
__dœ
,

136 cÚ¡ *
__f¡y³
, 
__rwæag
,

137 cÚ¡ *
__d©a
è
__THROW
;

140 
	$umouÁ
 (cÚ¡ *
__¥ecŸl_fe
è
__THROW
;

143 
	$umouÁ2
 (cÚ¡ *
__¥ecŸl_fe
, 
__æags
è
__THROW
;

145 
__END_DECLS


	@/usr/include/sys/param.h

19 #iâdeà
_SYS_PARAM_H


20 
	#_SYS_PARAM_H
 1

	)

22 
	#__Ãed_NULL


	)

23 
	~<¡ddef.h
>

25 
	~<sys/ty³s.h
>

26 
	~<lim™s.h
>

27 
	~<’dŸn.h
>

28 
	~<sigÇl.h
>

31 
	~<b™s/·¿m.h
>

36 
	#NBBY
 
CHAR_BIT


	)

38 #ià!
defšed
 
NGROUPS
 && defšed 
NGROUPS_MAX


39 
	#NGROUPS
 
NGROUPS_MAX


	)

41 #ià!
defšed
 
MAXSYMLINKS
 && defšed 
SYMLOOP_MAX


42 
	#MAXSYMLINKS
 
SYMLOOP_MAX


	)

44 #ià!
defšed
 
CANBSIZ
 && defšed 
MAX_CANON


45 
	#CANBSIZ
 
MAX_CANON


	)

47 #ià!
defšed
 
MAXPATHLEN
 && defšed 
PATH_MAX


48 
	#MAXPATHLEN
 
PATH_MAX


	)

50 #ià!
defšed
 
NOFILE
 && defšed 
OPEN_MAX


51 
	#NOFILE
 
OPEN_MAX


	)

53 #iâdeà
NCARGS


54 #ifdeà
ARG_MAX


55 
	#NCARGS
 
ARG_MAX


	)

59 
	#NCARGS
 
INT_MAX


	)

65 #iâdeà
NOGROUP


66 
	#NOGROUP
 65535

	)

68 #iâdeà
NODEV


69 
	#NODEV
 ((
dev_t
è-1è

	)

74 #iâdeà
DEV_BSIZE


75 
	#DEV_BSIZE
 512

	)

80 
	#£tb™
(
a
,
i
è(×)[(i)/
NBBY
] |ğ1<<((i)%NBBY))

	)

81 
	#şrb™
(
a
,
i
è(×)[(i)/
NBBY
] &ğ~(1<<((i)%NBBY)))

	)

82 
	#is£t
(
a
,
i
è(×)[(i)/
NBBY
] & (1<<((i)%NBBY)))

	)

83 
	#isşr
(
a
,
i
è((×)[(i)/
NBBY
] & (1<<((i)%NBBY))è=ğ0)

	)

86 #iâdeà
howmªy


87 
	#howmªy
(
x
, 
y
è(((xè+ ((yè- 1)è/ (y))

	)

89 #ifdeà
__GNUC__


90 
	#roundup
(
x
, 
y
è(
	`__butš_cÚ¡ªt_p
 (yè&& 
	`pow”of2
 (y) \

91 ? (((
x
è+ (
y
) - 1) & ~((y) - 1)) \

92 : ((((
x
è+ ((
y
è- 1)è/ (y)è* (y)))

	)

94 
	#roundup
(
x
, 
y
è((((xè+ ((yè- 1)è/ (y)è* (y))

	)

96 
	#pow”of2
(
x
è((((xè- 1è& (x)è=ğ0)

	)

99 
	#MIN
(
a
,
b
è((×)<(b))?×):(b))

	)

100 
	#MAX
(
a
,
b
è((×)>(b))?×):(b))

	)

	@/usr/include/sys/resource.h

18 #iâdef 
_SYS_RESOURCE_H


19 
	#_SYS_RESOURCE_H
 1

	)

21 
	~<ã©u»s.h
>

24 
	~<b™s/»sourû.h
>

26 #iâdeà
__id_t_defšed


27 
__id_t
 
	tid_t
;

28 
	#__id_t_defšed


	)

31 
	g__BEGIN_DECLS


37 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


38 
__¾im™_»sourû
 
	t__¾im™_»sourû_t
;

39 
__ru§ge_who
 
	t__ru§ge_who_t
;

40 
__´iÜ™y_which
 
	t__´iÜ™y_which_t
;

42 
	t__¾im™_»sourû_t
;

43 
	t__ru§ge_who_t
;

44 
	t__´iÜ™y_which_t
;

49 #iâdeà
__USE_FILE_OFFSET64


50 
	$g‘¾im™
 (
__¾im™_»sourû_t
 
__»sourû
,

51 
¾im™
 *
__¾im™s
è
__THROW
;

53 #ifdeà
__REDIRECT_NTH


54 
	`__REDIRECT_NTH
 (
g‘¾im™
, (
__¾im™_»sourû_t
 
__»sourû
,

55 
¾im™
 *
__¾im™s
), 
g‘¾im™64
);

57 
	#g‘¾im™
 
g‘¾im™64


	)

60 #ifdeà
__USE_LARGEFILE64


61 
	$g‘¾im™64
 (
__¾im™_»sourû_t
 
__»sourû
,

62 
¾im™64
 *
__¾im™s
è
__THROW
;

68 #iâdeà
__USE_FILE_OFFSET64


69 
	$£Œlim™
 (
__¾im™_»sourû_t
 
__»sourû
,

70 cÚ¡ 
¾im™
 *
__¾im™s
è
__THROW
;

72 #ifdeà
__REDIRECT_NTH


73 
	`__REDIRECT_NTH
 (
£Œlim™
, (
__¾im™_»sourû_t
 
__»sourû
,

74 cÚ¡ 
¾im™
 *
__¾im™s
),

75 
£Œlim™64
);

77 
	#£Œlim™
 
£Œlim™64


	)

80 #ifdeà
__USE_LARGEFILE64


81 
	$£Œlim™64
 (
__¾im™_»sourû_t
 
__»sourû
,

82 cÚ¡ 
¾im™64
 *
__¾im™s
è
__THROW
;

87 
	$g‘ru§ge
 (
__ru§ge_who_t
 
__who
, 
ru§ge
 *
__u§ge
è
__THROW
;

93 
	$g‘´iÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
è
__THROW
;

97 
	$£riÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
, 
__´io
)

98 
__THROW
;

100 
__END_DECLS


	@/usr/include/sys/select.h

21 #iâdeà
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

30 
	~<b™s/£Ëù.h
>

33 
	~<b™s/sig£t.h
>

35 #iâdeà
__sig£t_t_defšed


36 
	#__sig£t_t_defšed


	)

37 
__sig£t_t
 
	tsig£t_t
;

41 
	#__Ãed_time_t


	)

42 
	#__Ãed_time¥ec


	)

43 
	~<time.h
>

44 
	#__Ãed_timev®


	)

45 
	~<b™s/time.h
>

47 #iâdeà
__su£cÚds_t_defšed


48 
__su£cÚds_t
 
	tsu£cÚds_t
;

49 
	#__su£cÚds_t_defšed


	)

54 
	t__fd_mask
;

57 #undeà
__NFDBITS


59 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

60 
	#__FD_ELT
(
d
è((dè/ 
__NFDBITS
)

	)

61 
	#__FD_MASK
(
d
è((
__fd_mask
è1 << ((dè% 
__NFDBITS
))

	)

68 #ifdeà
__USE_XOPEN


69 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

70 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

72 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

75 } 
	tfd_£t
;

78 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

80 #ifdeà
__USE_MISC


82 
__fd_mask
 
	tfd_mask
;

85 
	#NFDBITS
 
__NFDBITS


	)

90 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

91 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

92 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

93 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

96 
__BEGIN_DECLS


106 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

107 
fd_£t
 *
__»¡riù
 
__wr™efds
,

108 
fd_£t
 *
__»¡riù
 
__exû±fds
,

109 
timev®
 *
__»¡riù
 
__timeout
);

111 #ifdeà
__USE_XOPEN2K


118 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

119 
fd_£t
 *
__»¡riù
 
__wr™efds
,

120 
fd_£t
 *
__»¡riù
 
__exû±fds
,

121 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

122 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

127 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__GNUC__


128 
	~<b™s/£Ëù2.h
>

131 
	g__END_DECLS


	@/usr/include/sys/socket.h

19 #iâdef 
_SYS_SOCKET_H


20 
	#_SYS_SOCKET_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	g__BEGIN_DECLS


26 
	~<sys/uio.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

29 #ifdeà
__USE_GNU


31 
	~<b™s/sig£t.h
>

38 
	~<b™s/sock‘.h
>

40 #ifdeà
__USE_BSD


43 
	sosockaddr


45 
	m§_çmy
;

46 
	m§_d©a
[14];

54 
	mSHUT_RD
 = 0,

55 
	#SHUT_RD
 
SHUT_RD


	)

56 
	mSHUT_WR
,

57 
	#SHUT_WR
 
SHUT_WR


	)

58 
	mSHUT_RDWR


59 
	#SHUT_RDWR
 
SHUT_RDWR


	)

68 #ià
defšed
 
__ılu¥lus
 || !
__GNUC_PREREQ
 (2, 7è|| !defšed 
__USE_GNU


69 
	#__SOCKADDR_ARG
 
sockaddr
 *
__»¡riù


	)

70 
	#__CONST_SOCKADDR_ARG
 cÚ¡ 
sockaddr
 *

	)

74 
	#__SOCKADDR_ALLTYPES
 \

75 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

77 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

78 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

79 
	`__SOCKADDR_ONETYPE
 (
sockaddr_eÚ
) \

80 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š
) \

81 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š6
) \

82 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š¬p
) \

83 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x
) \

84 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

85 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

86 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

87 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

89 
	#__SOCKADDR_ONETYPE
(
ty³
èty³ *
__»¡riù
 
__
##ty³##__;

	)

90 uniÚ { 
	m__SOCKADDR_ALLTYPES


91 } 
	t__SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

92 #undeà
__SOCKADDR_ONETYPE


93 
	#__SOCKADDR_ONETYPE
(
ty³
ècÚ¡ ty³ *
__»¡riù
 
__
##ty³##__;

	)

94 uniÚ { 
	m__SOCKADDR_ALLTYPES


95 } 
	t__CONST_SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

96 #undeà
__SOCKADDR_ONETYPE


99 #ifdeà
__USE_GNU


101 
	smmsghdr


103 
msghdr
 
	mmsg_hdr
;

104 
	mmsg_Ën
;

113 
	$sock‘
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
è
__THROW
;

119 
	$sock‘·œ
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
,

120 
__fds
[2]è
__THROW
;

123 
	$bšd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
)

124 
__THROW
;

127 
	$g‘sockÇme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

128 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

137 
	`cÚÃù
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
);

141 
	$g‘³”Çme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

142 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

149 
ssize_t
 
	`£nd
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
, 
__æags
);

156 
ssize_t
 
	`»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
);

163 
ssize_t
 
	`£ndto
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

164 
__æags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

165 
sockËn_t
 
__addr_Ën
);

174 
ssize_t
 
	`»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

175 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

176 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

184 
ssize_t
 
	`£ndmsg
 (
__fd
, cÚ¡ 
msghdr
 *
__mes§ge
,

185 
__æags
);

187 #ifdeà
__USE_GNU


193 
	`£ndmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

194 
__vËn
, 
__æags
);

202 
ssize_t
 
	`»cvmsg
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

204 #ifdeà
__USE_GNU


210 
	`»cvmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

211 
__vËn
, 
__æags
,

212 cÚ¡ 
time¥ec
 *
__tmo
);

219 
	$g‘sockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

220 *
__»¡riù
 
__İtv®
,

221 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

226 
	$£tsockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

227 cÚ¡ *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

233 
	$li¡’
 (
__fd
, 
__n
è
__THROW
;

243 
	`acû±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

244 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

246 #ifdeà
__USE_GNU


251 
	`acû±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

252 
sockËn_t
 *
__»¡riù
 
__addr_Ën
, 
__æags
);

261 
	$shutdown
 (
__fd
, 
__how
è
__THROW
;

264 #ifdeà
__USE_XOPEN2K


266 
	$sock©m¬k
 (
__fd
è
__THROW
;

270 #ifdeà
__USE_MISC


274 
	$isfdty³
 (
__fd
, 
__fdty³
è
__THROW
;

279 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


280 
	~<b™s/sock‘2.h
>

283 
__END_DECLS


	@/usr/include/sys/stat.h

22 #iâdef 
_SYS_STAT_H


23 
	#_SYS_STAT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

29 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K
 || defšed 
__USE_MISC
 \

30 || 
defšed
 
	g__USE_ATFILE


31 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


32 
	#__Ãed_time_t


	)

34 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ATFILE


35 
	#__Ãed_time¥ec


	)

37 
	~<time.h
>

40 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


43 #iâdeà
__dev_t_defšed


44 
__dev_t
 
	tdev_t
;

45 
	#__dev_t_defšed


	)

48 #iâdeà
__gid_t_defšed


49 
__gid_t
 
	tgid_t
;

50 
	#__gid_t_defšed


	)

53 #iâdeà
__šo_t_defšed


54 #iâdeà
__USE_FILE_OFFSET64


55 
__šo_t
 
	tšo_t
;

57 
__šo64_t
 
	tšo_t
;

59 
	#__šo_t_defšed


	)

62 #iâdeà
__mode_t_defšed


63 
__mode_t
 
	tmode_t
;

64 
	#__mode_t_defšed


	)

67 #iâdeà
__Æšk_t_defšed


68 
__Æšk_t
 
	tÆšk_t
;

69 
	#__Æšk_t_defšed


	)

72 #iâdeà
__off_t_defšed


73 #iâdeà
__USE_FILE_OFFSET64


74 
__off_t
 
	toff_t
;

76 
__off64_t
 
	toff_t
;

78 
	#__off_t_defšed


	)

81 #iâdeà
__uid_t_defšed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_defšed


	)

87 #ifdeà
__USE_UNIX98


88 #iâdeà
__blkút_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__blkút_t
 
	tblkút_t
;

92 
__blkút64_t
 
	tblkút_t
;

94 
	#__blkút_t_defšed


	)

97 #iâdeà
__blksize_t_defšed


98 
__blksize_t
 
	tblksize_t
;

99 
	#__blksize_t_defšed


	)

103 
	g__BEGIN_DECLS


105 
	~<b™s/¡©.h
>

107 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


108 
	#S_IFMT
 
__S_IFMT


	)

109 
	#S_IFDIR
 
__S_IFDIR


	)

110 
	#S_IFCHR
 
__S_IFCHR


	)

111 
	#S_IFBLK
 
__S_IFBLK


	)

112 
	#S_IFREG
 
__S_IFREG


	)

113 #ifdeà
__S_IFIFO


114 
	#S_IFIFO
 
__S_IFIFO


	)

116 #ifdeà
__S_IFLNK


117 
	#S_IFLNK
 
__S_IFLNK


	)

119 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_UNIX98
) \

120 && 
defšed
 
	g__S_IFSOCK


121 
	#S_IFSOCK
 
__S_IFSOCK


	)

127 
	#__S_ISTYPE
(
mode
, 
mask
è(((modeè& 
__S_IFMT
è=ğ(mask))

	)

129 
	#S_ISDIR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

130 
	#S_ISCHR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

131 
	#S_ISBLK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

132 
	#S_ISREG
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

133 #ifdeà
__S_IFIFO


134 
	#S_ISFIFO
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

136 #ifdeà
__S_IFLNK


137 
	#S_ISLNK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

140 #ià
defšed
 
__USE_BSD
 && !defšed 
__S_IFLNK


141 
	#S_ISLNK
(
mode
è0

	)

144 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K
) \

145 && 
defšed
 
	g__S_IFSOCK


146 
	#S_ISSOCK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

147 #–ià
defšed
 
__USE_XOPEN2K


148 
	#S_ISSOCK
(
mode
è0

	)

155 #ifdef 
__USE_POSIX199309


156 
	#S_TYPEISMQ
(
buf
è
	`__S_TYPEISMQ
(buf)

	)

157 
	#S_TYPEISSEM
(
buf
è
	`__S_TYPEISSEM
(buf)

	)

158 
	#S_TYPEISSHM
(
buf
è
	`__S_TYPEISSHM
(buf)

	)

164 
	#S_ISUID
 
__S_ISUID


	)

165 
	#S_ISGID
 
__S_ISGID


	)

167 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


169 
	#S_ISVTX
 
__S_ISVTX


	)

172 
	#S_IRUSR
 
__S_IREAD


	)

173 
	#S_IWUSR
 
__S_IWRITE


	)

174 
	#S_IXUSR
 
__S_IEXEC


	)

176 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

178 #ià
defšed
 
__USE_MISC
 && defšed 
__USE_BSD


179 
	#S_IREAD
 
S_IRUSR


	)

180 
	#S_IWRITE
 
S_IWUSR


	)

181 
	#S_IEXEC
 
S_IXUSR


	)

184 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

185 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

186 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

188 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

190 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

191 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

192 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

194 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

197 #ifdef 
__USE_BSD


199 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
è

	)

200 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

201 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

203 
	#S_BLKSIZE
 512

	)

207 #iâdeà
__USE_FILE_OFFSET64


209 
	$¡©
 (cÚ¡ *
__»¡riù
 
__fe
,

210 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

214 
	$f¡©
 (
__fd
, 
¡©
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

216 #ifdeà
__REDIRECT_NTH


217 
	`__REDIRECT_NTH
 (
¡©
, (cÚ¡ *
__»¡riù
 
__fe
,

218 
¡©
 *
__»¡riù
 
__buf
), 
¡©64
)

219 
	`__nÚnuÎ
 ((1, 2));

220 
	`__REDIRECT_NTH
 (
f¡©
, (
__fd
, 
¡©
 *
__buf
), 
f¡©64
)

221 
	`__nÚnuÎ
 ((2));

223 
	#¡©
 
¡©64


	)

224 
	#f¡©
 
f¡©64


	)

227 #ifdeà
__USE_LARGEFILE64


228 
	$¡©64
 (cÚ¡ *
__»¡riù
 
__fe
,

229 
¡©64
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

230 
	$f¡©64
 (
__fd
, 
¡©64
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

233 #ifdeà
__USE_ATFILE


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$f¡©©
 (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

239 
¡©
 *
__»¡riù
 
__buf
, 
__æag
)

240 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

242 #ifdeà
__REDIRECT_NTH


243 
	`__REDIRECT_NTH
 (
f¡©©
, (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

244 
¡©
 *
__»¡riù
 
__buf
,

245 
__æag
),

246 
f¡©©64
è
	`__nÚnuÎ
 ((2, 3));

248 
	#f¡©©
 
f¡©©64


	)

252 #ifdeà
__USE_LARGEFILE64


253 
	$f¡©©64
 (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

254 
¡©64
 *
__»¡riù
 
__buf
, 
__æag
)

255 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

259 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


260 #iâdeà
__USE_FILE_OFFSET64


263 
	$l¡©
 (cÚ¡ *
__»¡riù
 
__fe
,

264 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

266 #ifdeà
__REDIRECT_NTH


267 
	`__REDIRECT_NTH
 (
l¡©
,

268 (cÚ¡ *
__»¡riù
 
__fe
,

269 
¡©
 *
__»¡riù
 
__buf
), 
l¡©64
)

270 
	`__nÚnuÎ
 ((1, 2));

272 
	#l¡©
 
l¡©64


	)

275 #ifdeà
__USE_LARGEFILE64


276 
	$l¡©64
 (cÚ¡ *
__»¡riù
 
__fe
,

277 
¡©64
 *
__»¡riù
 
__buf
)

278 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

284 
	$chmod
 (cÚ¡ *
__fe
, 
__mode_t
 
__mode
)

285 
__THROW
 
	`__nÚnuÎ
 ((1));

287 #ifdeà
__USE_BSD


291 
	$lchmod
 (cÚ¡ *
__fe
, 
__mode_t
 
__mode
)

292 
__THROW
 
	`__nÚnuÎ
 ((1));

296 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_POSIX


297 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
è
__THROW
;

300 #ifdeà
__USE_ATFILE


303 
	$fchmod©
 (
__fd
, cÚ¡ *
__fe
, 
__mode_t
 
__mode
,

304 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

312 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
è
__THROW
;

314 #ifdef 
__USE_GNU


317 
__mode_t
 
	$g‘umask
 (è
__THROW
;

321 
	$mkdœ
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

322 
__THROW
 
	`__nÚnuÎ
 ((1));

324 #ifdeà
__USE_ATFILE


328 
	$mkdœ©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

329 
__THROW
 
	`__nÚnuÎ
 ((2));

335 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


336 
	$mknod
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

337 
__THROW
 
	`__nÚnuÎ
 ((1));

339 #ifdeà
__USE_ATFILE


343 
	$mknod©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

344 
__dev_t
 
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2));

350 
	$mkfifo
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

351 
__THROW
 
	`__nÚnuÎ
 ((1));

353 #ifdeà
__USE_ATFILE


357 
	$mkfifßt
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

361 #ifdeà
__USE_ATFILE


364 
	$utim’§t
 (
__fd
, cÚ¡ *
__·th
,

365 cÚ¡ 
time¥ec
 
__times
[2],

366 
__æags
)

367 
__THROW
 
	`__nÚnuÎ
 ((2));

370 #ifdeà
__USE_XOPEN2K8


372 
	$futim’s
 (
__fd
, cÚ¡ 
time¥ec
 
__times
[2]è
__THROW
;

390 #iâdeà
_STAT_VER


391 
	#_STAT_VER
 0

	)

393 #iâdeà
_MKNOD_VER


394 
	#_MKNOD_VER
 0

	)

398 #iâdeà
__USE_FILE_OFFSET64


399 
	$__fx¡©
 (
__v”
, 
__fdes
, 
¡©
 *
__¡©_buf
)

400 
__THROW
 
	`__nÚnuÎ
 ((3));

401 
	$__x¡©
 (
__v”
, cÚ¡ *
__f’ame
,

402 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

403 
	$__lx¡©
 (
__v”
, cÚ¡ *
__f’ame
,

404 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

405 
	$__fx¡©©
 (
__v”
, 
__fdes
, cÚ¡ *
__f’ame
,

406 
¡©
 *
__¡©_buf
, 
__æag
)

407 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

409 #ifdeà
__REDIRECT_NTH


410 
	`__REDIRECT_NTH
 (
__fx¡©
, (
__v”
, 
__fdes
,

411 
¡©
 *
__¡©_buf
), 
__fx¡©64
)

412 
	`__nÚnuÎ
 ((3));

413 
	`__REDIRECT_NTH
 (
__x¡©
, (
__v”
, cÚ¡ *
__f’ame
,

414 
¡©
 *
__¡©_buf
), 
__x¡©64
)

415 
	`__nÚnuÎ
 ((2, 3));

416 
	`__REDIRECT_NTH
 (
__lx¡©
, (
__v”
, cÚ¡ *
__f’ame
,

417 
¡©
 *
__¡©_buf
), 
__lx¡©64
)

418 
	`__nÚnuÎ
 ((2, 3));

419 
	`__REDIRECT_NTH
 (
__fx¡©©
, (
__v”
, 
__fdes
,

420 cÚ¡ *
__f’ame
,

421 
¡©
 *
__¡©_buf
, 
__æag
),

422 
__fx¡©©64
è
	`__nÚnuÎ
 ((3, 4));

425 
	#__fx¡©
 
__fx¡©64


	)

426 
	#__x¡©
 
__x¡©64


	)

427 
	#__lx¡©
 
__lx¡©64


	)

431 #ifdeà
__USE_LARGEFILE64


432 
	$__fx¡©64
 (
__v”
, 
__fdes
, 
¡©64
 *
__¡©_buf
)

433 
__THROW
 
	`__nÚnuÎ
 ((3));

434 
	$__x¡©64
 (
__v”
, cÚ¡ *
__f’ame
,

435 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

436 
	$__lx¡©64
 (
__v”
, cÚ¡ *
__f’ame
,

437 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

438 
	$__fx¡©©64
 (
__v”
, 
__fdes
, cÚ¡ *
__f’ame
,

439 
¡©64
 *
__¡©_buf
, 
__æag
)

440 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

442 
	$__xmknod
 (
__v”
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

443 
__dev_t
 *
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

445 
	$__xmknod©
 (
__v”
, 
__fd
, cÚ¡ *
__·th
,

446 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

447 
__THROW
 
	`__nÚnuÎ
 ((3, 5));

449 #ifdeà
__USE_EXTERN_INLINES


452 
__ex‹º_šlše
 

453 
	`__NTH
 (
	$¡©
 (cÚ¡ *
__·th
, 
¡©
 *
__¡©buf
))

455  
	`__x¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

456 
	}
}

458 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


459 
__ex‹º_šlše
 

460 
__NTH
 (
	$l¡©
 (cÚ¡ *
__·th
, 
¡©
 *
__¡©buf
))

462  
	`__lx¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

463 
	}
}

466 
__ex‹º_šlše
 

467 
__NTH
 (
	$f¡©
 (
__fd
, 
¡©
 *
__¡©buf
))

469  
	`__fx¡©
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

470 
	}
}

472 #ifdeà
__USE_ATFILE


473 
__ex‹º_šlše
 

474 
__NTH
 (
	$f¡©©
 (
__fd
, cÚ¡ *
__f’ame
, 
¡©
 *
__¡©buf
,

475 
__æag
))

477  
	`__fx¡©©
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

478 
	}
}

481 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD


482 
__ex‹º_šlše
 

483 
__NTH
 (
	$mknod
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

485  
	`__xmknod
 (
_MKNOD_VER
, 
__·th
, 
__mode
, &
__dev
);

486 
	}
}

489 #ifdeà
__USE_ATFILE


490 
__ex‹º_šlše
 

491 
__NTH
 (
	$mknod©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

492 
__dev_t
 
__dev
))

494  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__·th
, 
__mode
, &
__dev
);

495 
	}
}

498 #ià
defšed
 
__USE_LARGEFILE64
 \

499 && (! 
defšed
 
	g__USE_FILE_OFFSET64
 \

500 || (
defšed
 
	g__REDIRECT_NTH
 && defšed 
	g__OPTIMIZE__
))

501 
__ex‹º_šlše
 

502 
__NTH
 (
	$¡©64
 (cÚ¡ *
__·th
, 
¡©64
 *
__¡©buf
))

504  
	`__x¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

505 
	}
}

507 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


508 
__ex‹º_šlše
 

509 
__NTH
 (
	$l¡©64
 (cÚ¡ *
__·th
, 
¡©64
 *
__¡©buf
))

511  
	`__lx¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

512 
	}
}

515 
__ex‹º_šlše
 

516 
__NTH
 (
	$f¡©64
 (
__fd
, 
¡©64
 *
__¡©buf
))

518  
	`__fx¡©64
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

519 
	}
}

521 #ifdeà
__USE_ATFILE


522 
__ex‹º_šlše
 

523 
__NTH
 (
	$f¡©©64
 (
__fd
, cÚ¡ *
__f’ame
, 
¡©64
 *
__¡©buf
,

524 
__æag
))

526  
	`__fx¡©©64
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

527 
	}
}

534 
	g__END_DECLS


	@/usr/include/sys/statfs.h

19 #iâdef 
_SYS_STATFS_H


20 
	#_SYS_STATFS_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/¡©fs.h
>

27 
	g__BEGIN_DECLS


30 #iâdeà
__USE_FILE_OFFSET64


31 
	$¡©fs
 (cÚ¡ *
__fe
, 
¡©fs
 *
__buf
)

32 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

34 #ifdeà
__REDIRECT_NTH


35 
	`__REDIRECT_NTH
 (
¡©fs
,

36 (cÚ¡ *
__fe
, 
¡©fs
 *
__buf
),

37 
¡©fs64
è
	`__nÚnuÎ
 ((1, 2));

39 
	#¡©fs
 
¡©fs64


	)

42 #ifdeà
__USE_LARGEFILE64


43 
	$¡©fs64
 (cÚ¡ *
__fe
, 
¡©fs64
 *
__buf
)

44 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

49 #iâdeà
__USE_FILE_OFFSET64


50 
	$f¡©fs
 (
__fdes
, 
¡©fs
 *
__buf
)

51 
__THROW
 
	`__nÚnuÎ
 ((2));

53 #ifdeà
__REDIRECT_NTH


54 
	`__REDIRECT_NTH
 (
f¡©fs
, (
__fdes
, 
¡©fs
 *
__buf
),

55 
f¡©fs64
è
	`__nÚnuÎ
 ((2));

57 
	#f¡©fs
 
f¡©fs64


	)

60 #ifdeà
__USE_LARGEFILE64


61 
	$f¡©fs64
 (
__fdes
, 
¡©fs64
 *
__buf
)

62 
__THROW
 
	`__nÚnuÎ
 ((2));

65 
__END_DECLS


	@/usr/include/sys/statvfs.h

19 #iâdef 
_SYS_STATVFS_H


20 
	#_SYS_STATVFS_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/¡©vfs.h
>

27 #iâdeà
__USE_FILE_OFFSET64


28 #iâdeà
__fsblkút_t_defšed


29 
__fsblkút_t
 
	tfsblkút_t
;

30 
	#__fsblkút_t_defšed


	)

32 #iâdeà
__fsfút_t_defšed


33 
__fsfút_t
 
	tfsfút_t
;

34 
	#__fsfút_t_defšed


	)

37 #iâdeà
__fsblkút_t_defšed


38 
__fsblkút64_t
 
	tfsblkút_t
;

39 
	#__fsblkút_t_defšed


	)

41 #iâdeà
__fsfút_t_defšed


42 
__fsfút64_t
 
	tfsfút_t
;

43 
	#__fsfút_t_defšed


	)

47 
	g__BEGIN_DECLS


50 #iâdeà
__USE_FILE_OFFSET64


51 
	$¡©vfs
 (cÚ¡ *
__»¡riù
 
__fe
,

52 
¡©vfs
 *
__»¡riù
 
__buf
)

53 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

55 #ifdeà
__REDIRECT_NTH


56 
	`__REDIRECT_NTH
 (
¡©vfs
,

57 (cÚ¡ *
__»¡riù
 
__fe
,

58 
¡©vfs
 *
__»¡riù
 
__buf
), 
¡©vfs64
)

59 
	`__nÚnuÎ
 ((1, 2));

61 
	#¡©vfs
 
¡©vfs64


	)

64 #ifdeà
__USE_LARGEFILE64


65 
	$¡©vfs64
 (cÚ¡ *
__»¡riù
 
__fe
,

66 
¡©vfs64
 *
__»¡riù
 
__buf
)

67 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

72 #iâdeà
__USE_FILE_OFFSET64


73 
	$f¡©vfs
 (
__fdes
, 
¡©vfs
 *
__buf
)

74 
__THROW
 
	`__nÚnuÎ
 ((2));

76 #ifdeà
__REDIRECT_NTH


77 
	`__REDIRECT_NTH
 (
f¡©vfs
, (
__fdes
, 
¡©vfs
 *
__buf
),

78 
f¡©vfs64
è
	`__nÚnuÎ
 ((2));

80 
	#f¡©vfs
 
f¡©vfs64


	)

83 #ifdeà
__USE_LARGEFILE64


84 
	$f¡©vfs64
 (
__fdes
, 
¡©vfs64
 *
__buf
)

85 
__THROW
 
	`__nÚnuÎ
 ((2));

88 
__END_DECLS


	@/usr/include/sys/syslog.h

32 #iâdeà
_SYS_SYSLOG_H


33 
	#_SYS_SYSLOG_H
 1

	)

35 
	~<ã©u»s.h
>

36 
	#__Ãed___va_li¡


	)

37 
	~<¡d¬g.h
>

40 
	~<b™s/sy¦og-·th.h
>

51 
	#LOG_EMERG
 0

	)

52 
	#LOG_ALERT
 1

	)

53 
	#LOG_CRIT
 2

	)

54 
	#LOG_ERR
 3

	)

55 
	#LOG_WARNING
 4

	)

56 
	#LOG_NOTICE
 5

	)

57 
	#LOG_INFO
 6

	)

58 
	#LOG_DEBUG
 7

	)

60 
	#LOG_PRIMASK
 0x07

	)

62 
	#LOG_PRI
(
p
è(Õè& 
LOG_PRIMASK
)

	)

63 
	#LOG_MAKEPRI
(
çc
, 
´i
è((çcè| (´i))

	)

65 #ifdeà
SYSLOG_NAMES


66 
	#INTERNAL_NOPRI
 0x10

	)

68 
	#INTERNAL_MARK
 
	`LOG_MAKEPRI
(
LOG_NFACILITIES
 << 3, 0)

	)

69 
	s_code
 {

70 *
	mc_Çme
;

71 
	mc_v®
;

72 } 
	tCODE
;

74 
CODE
 
	g´iÜ™yÇmes
[] =

76 { "®”t", 
LOG_ALERT
 },

77 { "ü™", 
LOG_CRIT
 },

78 { "debug", 
LOG_DEBUG
 },

79 { "em”g", 
LOG_EMERG
 },

80 { "”r", 
LOG_ERR
 },

81 { "”rÜ", 
LOG_ERR
 },

82 { "šfo", 
LOG_INFO
 },

83 { "nÚe", 
INTERNAL_NOPRI
 },

84 { "nÙiû", 
LOG_NOTICE
 },

85 { "·nic", 
LOG_EMERG
 },

86 { "w¬n", 
LOG_WARNING
 },

87 { "w¬nšg", 
LOG_WARNING
 },

88 { 
NULL
, -1 }

93 
	#LOG_KERN
 (0<<3è

	)

94 
	#LOG_USER
 (1<<3è

	)

95 
	#LOG_MAIL
 (2<<3è

	)

96 
	#LOG_DAEMON
 (3<<3è

	)

97 
	#LOG_AUTH
 (4<<3è

	)

98 
	#LOG_SYSLOG
 (5<<3è

	)

99 
	#LOG_LPR
 (6<<3è

	)

100 
	#LOG_NEWS
 (7<<3è

	)

101 
	#LOG_UUCP
 (8<<3è

	)

102 
	#LOG_CRON
 (9<<3è

	)

103 
	#LOG_AUTHPRIV
 (10<<3è

	)

104 
	#LOG_FTP
 (11<<3è

	)

107 
	#LOG_LOCAL0
 (16<<3è

	)

108 
	#LOG_LOCAL1
 (17<<3è

	)

109 
	#LOG_LOCAL2
 (18<<3è

	)

110 
	#LOG_LOCAL3
 (19<<3è

	)

111 
	#LOG_LOCAL4
 (20<<3è

	)

112 
	#LOG_LOCAL5
 (21<<3è

	)

113 
	#LOG_LOCAL6
 (22<<3è

	)

114 
	#LOG_LOCAL7
 (23<<3è

	)

116 
	#LOG_NFACILITIES
 24

	)

117 
	#LOG_FACMASK
 0x03f8

	)

119 
	#LOG_FAC
(
p
è((Õè& 
LOG_FACMASK
è>> 3)

	)

121 #ifdeà
SYSLOG_NAMES


122 
CODE
 
	gçc™yÇmes
[] =

124 { "auth", 
LOG_AUTH
 },

125 { "auth´iv", 
LOG_AUTHPRIV
 },

126 { "üÚ", 
LOG_CRON
 },

127 { "d«mÚ", 
LOG_DAEMON
 },

128 { "áp", 
LOG_FTP
 },

129 { "k”n", 
LOG_KERN
 },

130 { "Ír", 
LOG_LPR
 },

131 { "ma", 
LOG_MAIL
 },

132 { "m¬k", 
INTERNAL_MARK
 },

133 { "Ãws", 
LOG_NEWS
 },

134 { "£cur™y", 
LOG_AUTH
 },

135 { "sy¦og", 
LOG_SYSLOG
 },

136 { "u£r", 
LOG_USER
 },

137 { "uuı", 
LOG_UUCP
 },

138 { "loÿl0", 
LOG_LOCAL0
 },

139 { "loÿl1", 
LOG_LOCAL1
 },

140 { "loÿl2", 
LOG_LOCAL2
 },

141 { "loÿl3", 
LOG_LOCAL3
 },

142 { "loÿl4", 
LOG_LOCAL4
 },

143 { "loÿl5", 
LOG_LOCAL5
 },

144 { "loÿl6", 
LOG_LOCAL6
 },

145 { "loÿl7", 
LOG_LOCAL7
 },

146 { 
NULL
, -1 }

153 
	#LOG_MASK
(
´i
è(1 << (´i)è

	)

154 
	#LOG_UPTO
(
´i
è((1 << (Õri)+1)è- 1è

	)

162 
	#LOG_PID
 0x01

	)

163 
	#LOG_CONS
 0x02

	)

164 
	#LOG_ODELAY
 0x04

	)

165 
	#LOG_NDELAY
 0x08

	)

166 
	#LOG_NOWAIT
 0x10

	)

167 
	#LOG_PERROR
 0x20

	)

169 
__BEGIN_DECLS


175 
şo£log
 ();

181 
İ’log
 (cÚ¡ *
__id’t
, 
__İtiÚ
, 
__çc™y
);

184 
	$£ogmask
 (
__mask
è
__THROW
;

190 
	$sy¦og
 (
__´i
, cÚ¡ *
__fmt
, ...)

191 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

193 #ifdeà
__USE_BSD


200 
	$vsy¦og
 (
__´i
, cÚ¡ *
__fmt
, 
__gnuc_va_li¡
 
__­
)

201 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

206 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


207 
	~<b™s/sy¦og.h
>

209 #ifdeà
__LDBL_COMPAT


210 
	~<b™s/sy¦og-ldbl.h
>

213 
__END_DECLS


	@/usr/include/sys/sysmacros.h

19 #iâdeà
_SYS_SYSMACROS_H


20 
	#_SYS_SYSMACROS_H
 1

	)

22 
	~<ã©u»s.h
>

24 
__BEGIN_DECLS


26 
__ex‹nsiÚ__


27 
	$gnu_dev_majÜ
 (
__dev
)

28 
__THROW
 
__©Œibu‹_cÚ¡__
;

29 
__ex‹nsiÚ__


30 
	$gnu_dev_mšÜ
 (
__dev
)

31 
__THROW
 
__©Œibu‹_cÚ¡__
;

32 
__ex‹nsiÚ__


33 
	$gnu_dev_makedev
 (
__majÜ
,

34 
__mšÜ
)

35 
__THROW
 
__©Œibu‹_cÚ¡__
;

37 #ifdeà
__USE_EXTERN_INLINES


38 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 

39 
	`__NTH
 (
	$gnu_dev_majÜ
 (
__dev
))

41  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

42 
	}
}

44 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 

45 
__NTH
 (
	$gnu_dev_mšÜ
 (
__dev
))

47  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

48 
	}
}

50 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 

51 
__NTH
 (
	$gnu_dev_makedev
 (
__majÜ
, 
__mšÜ
))

53  ((
__mšÜ
 & 0xffè| ((
__majÜ
 & 0xfff) << 8)

54 | (((è(
__mšÜ
 & ~0xff)) << 12)

55 | (((è(
__majÜ
 & ~0xfff)) << 32));

56 
	}
}

58 
	g__END_DECLS


61 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

62 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

63 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/sys/time.h

18 #iâdeà
_SYS_TIME_H


19 
	#_SYS_TIME_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<b™s/ty³s.h
>

24 
	#__Ãed_time_t


	)

25 
	~<time.h
>

26 
	#__Ãed_timev®


	)

27 
	~<b™s/time.h
>

29 
	~<sys/£Ëù.h
>

31 #iâdeà
__su£cÚds_t_defšed


32 
__su£cÚds_t
 
	tsu£cÚds_t
;

33 
	#__su£cÚds_t_defšed


	)

37 
	g__BEGIN_DECLS


39 #ifdeà
__USE_GNU


41 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

42 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

43 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

44 }

	)

45 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

46 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

47 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

48 }

	)

52 #ifdeà
__USE_BSD


55 
	stimezÚe


57 
	mtz_mšu‹swe¡
;

58 
	mtz_d¡time
;

61 
timezÚe
 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

63 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

71 
	$g‘timeofday
 (
timev®
 *
__»¡riù
 
__tv
,

72 
__timezÚe_±r_t
 
__tz
è
__THROW
 
	`__nÚnuÎ
 ((1));

74 #ifdeà
__USE_BSD


77 
	$£‰imeofday
 (cÚ¡ 
timev®
 *
__tv
,

78 cÚ¡ 
timezÚe
 *
__tz
)

79 
__THROW
;

85 
	$adjtime
 (cÚ¡ 
timev®
 *
__d–
,

86 
timev®
 *
__Şdd–
è
__THROW
;

91 
	e__™im”_which


94 
ITIMER_REAL
 = 0,

95 
	#ITIMER_REAL
 
ITIMER_REAL


	)

97 
ITIMER_VIRTUAL
 = 1,

98 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

101 
ITIMER_PROF
 = 2

102 
	#ITIMER_PROF
 
ITIMER_PROF


	)

107 
	s™im”v®


110 
timev®
 
™_š‹rv®
;

112 
timev®
 
™_v®ue
;

115 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


118 
__™im”_which
 
	t__™im”_which_t
;

120 
	t__™im”_which_t
;

125 
	$g‘™im”
 (
__™im”_which_t
 
__which
,

126 
™im”v®
 *
__v®ue
è
__THROW
;

131 
	$£t™im”
 (
__™im”_which_t
 
__which
,

132 cÚ¡ 
™im”v®
 *
__»¡riù
 
__Ãw
,

133 
™im”v®
 *
__»¡riù
 
__Şd
è
__THROW
;

138 
	$utimes
 (cÚ¡ *
__fe
, cÚ¡ 
timev®
 
__tvp
[2])

139 
__THROW
 
	`__nÚnuÎ
 ((1));

141 #ifdeà
__USE_BSD


143 
	$lutimes
 (cÚ¡ *
__fe
, cÚ¡ 
timev®
 
__tvp
[2])

144 
__THROW
 
	`__nÚnuÎ
 ((1));

147 
	$futimes
 (
__fd
, cÚ¡ 
timev®
 
__tvp
[2]è
__THROW
;

150 #ifdeà
__USE_GNU


154 
	$futime§t
 (
__fd
, cÚ¡ *
__fe
,

155 cÚ¡ 
timev®
 
__tvp
[2]è
__THROW
;

159 #ifdeà
__USE_BSD


162 
	#tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

163 
	#tim”ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

164 
	#tim”cmp
(
a
, 
b
, 
CMP
) \

165 (((
a
)->
tv_£c
 =ğ(
b
)->tv_sec) ? \

166 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

167 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

168 
	#tim”add
(
a
, 
b
, 
»suÉ
) \

170 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø+ (
b
)->tv_sec; \

171 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø+ (
b
)->tv_usec; \

172 ià((
»suÉ
)->
tv_u£c
 >= 1000000) \

174 ++(
»suÉ
)->
tv_£c
; \

175 (
»suÉ
)->
tv_u£c
 -= 1000000; \

177 
	}
} 0)

	)

178 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

180 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

181 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

182 ià((
»suÉ
)->
tv_u£c
 < 0) { \

183 --(
»suÉ
)->
tv_£c
; \

184 (
»suÉ
)->
tv_u£c
 += 1000000; \

186 } 0)

	)

189 
	g__END_DECLS


	@/usr/include/sys/types.h

22 #iâdef 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdef 
__USE_BSD


32 #iâdeà
__u_ch¬_defšed


33 
__u_ch¬
 
	tu_ch¬
;

34 
__u_shÜt
 
	tu_shÜt
;

35 
__u_št
 
	tu_št
;

36 
__u_lÚg
 
	tu_lÚg
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¬_defšed


	)

44 
__loff_t
 
	tloff_t
;

46 #iâdeà
__šo_t_defšed


47 #iâdeà
__USE_FILE_OFFSET64


48 
__šo_t
 
	tšo_t
;

50 
__šo64_t
 
	tšo_t
;

52 
	#__šo_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


55 
__šo64_t
 
	tšo64_t
;

56 
	#__šo64_t_defšed


	)

59 #iâdeà
__dev_t_defšed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_defšed


	)

64 #iâdeà
__gid_t_defšed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_defšed


	)

69 #iâdeà
__mode_t_defšed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_defšed


	)

74 #iâdeà
__Æšk_t_defšed


75 
__Æšk_t
 
	tÆšk_t
;

76 
	#__Æšk_t_defšed


	)

79 #iâdeà
__uid_t_defšed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_defšed


	)

84 #iâdeà
__off_t_defšed


85 #iâdeà
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_defšed


	)

92 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_defšed


	)

97 #iâdeà
__pid_t_defšed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_defšed


	)

102 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
) \

103 && !
defšed
 
__id_t_defšed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_defšed


	)

108 #iâdeà
__ssize_t_defšed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_defšed


	)

113 #ifdef 
__USE_BSD


114 #iâdeà
__daddr_t_defšed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ÿddr_t
 
	tÿddr_t
;

117 
	#__daddr_t_defšed


	)

121 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_defšed


	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	#__Ãed_şock_t


	)

129 
	#__Ãed_time_t


	)

130 
	#__Ãed_tim”_t


	)

131 
	#__Ãed_şockid_t


	)

132 
	~<time.h
>

134 #ifdeà
__USE_XOPEN


135 #iâdeà
__u£cÚds_t_defšed


136 
__u£cÚds_t
 
	tu£cÚds_t
;

137 
	#__u£cÚds_t_defšed


	)

139 #iâdeà
__su£cÚds_t_defšed


140 
__su£cÚds_t
 
	tsu£cÚds_t
;

141 
	#__su£cÚds_t_defšed


	)

145 
	#__Ãed_size_t


	)

146 
	~<¡ddef.h
>

148 #ifdeà
__USE_MISC


150 
	tulÚg
;

151 
	tushÜt
;

152 
	tušt
;

157 #ià!
__GNUC_PREREQ
 (2, 7)

160 #iâdeà
__št8_t_defšed


161 
	#__št8_t_defšed


	)

162 
	tšt8_t
;

163 
	tšt16_t
;

164 
	tšt32_t
;

165 #ià
__WORDSIZE
 == 64

166 
	tšt64_t
;

168 
__ex‹nsiÚ__
 
	tšt64_t
;

173 
	tu_št8_t
;

174 
	tu_št16_t
;

175 
	tu_št32_t
;

176 #ià
__WORDSIZE
 == 64

177 
	tu_št64_t
;

179 
__ex‹nsiÚ__
 
	tu_št64_t
;

182 
	t»gi¡”_t
;

187 
	#__štN_t
(
N
, 
MODE
) \

188 ##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

189 
	t__u_štN_t
(
	tN
, 
	tMODE
) \

190 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

192 #iâdeà
	t__št8_t_defšed


193 
	t__št8_t_defšed


	)

194 
	t__štN_t
 (8, 
	t__QI__
);

195 
__štN_t
 (16, 
__HI__
);

196 
__štN_t
 (32, 
__SI__
);

197 
__štN_t
 (64, 
__DI__
);

200 
__u_štN_t
 (8, 
__QI__
);

201 
__u_štN_t
 (16, 
__HI__
);

202 
__u_štN_t
 (32, 
__SI__
);

203 
__u_štN_t
 (64, 
__DI__
);

205 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

211 
	#__BIT_TYPES_DEFINED__
 1

	)

214 #ifdef 
__USE_BSD


216 
	~<’dŸn.h
>

219 
	~<sys/£Ëù.h
>

222 
	~<sys/sysmaüos.h
>

226 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
) \

227 && !
defšed
 
__blksize_t_defšed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_defšed


	)

233 #iâdeà
__USE_FILE_OFFSET64


234 #iâdeà
__blkút_t_defšed


235 
__blkút_t
 
	tblkút_t
;

236 
	#__blkút_t_defšed


	)

238 #iâdeà
__fsblkút_t_defšed


239 
__fsblkút_t
 
	tfsblkút_t
;

240 
	#__fsblkút_t_defšed


	)

242 #iâdeà
__fsfút_t_defšed


243 
__fsfút_t
 
	tfsfút_t
;

244 
	#__fsfút_t_defšed


	)

247 #iâdeà
__blkút_t_defšed


248 
__blkút64_t
 
	tblkút_t
;

249 
	#__blkút_t_defšed


	)

251 #iâdeà
__fsblkút_t_defšed


252 
__fsblkút64_t
 
	tfsblkút_t
;

253 
	#__fsblkút_t_defšed


	)

255 #iâdeà
__fsfút_t_defšed


256 
__fsfút64_t
 
	tfsfút_t
;

257 
	#__fsfút_t_defšed


	)

261 #ifdeà
__USE_LARGEFILE64


262 
__blkút64_t
 
	tblkút64_t
;

263 
__fsblkút64_t
 
	tfsblkút64_t
;

264 
__fsfút64_t
 
	tfsfút64_t
;

269 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


270 
	~<b™s/±h»adty³s.h
>

273 
	g__END_DECLS


	@/usr/include/sys/uio.h

18 #iâdeà
_SYS_UIO_H


19 
	#_SYS_UIO_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<sys/ty³s.h
>

25 
	g__BEGIN_DECLS


28 
	~<b™s/uio.h
>

39 
ssize_t
 
	$»adv
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
)

40 
__wur
;

50 
ssize_t
 
	$wr™ev
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
)

51 
__wur
;

54 #ifdeà
__USE_BSD


55 #iâdeà
__USE_FILE_OFFSET64


65 
ssize_t
 
	$´—dv
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

66 
__off_t
 
__off£t
è
__wur
;

77 
ssize_t
 
	$pwr™ev
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

78 
__off_t
 
__off£t
è
__wur
;

80 #ifdeà
__REDIRECT


81 
ssize_t
 
	`__REDIRECT
 (
´—dv
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

82 
__couÁ
, 
__off64_t
 
__off£t
),

83 
´—dv64
è
__wur
;

84 
ssize_t
 
	`__REDIRECT
 (
pwr™ev
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

85 
__couÁ
, 
__off64_t
 
__off£t
),

86 
pwr™ev64
è
__wur
;

88 
	#´—dv
 
´—dv64


	)

89 
	#pwr™ev
 
pwr™ev64


	)

93 #ifdeà
__USE_LARGEFILE64


103 
ssize_t
 
	$´—dv64
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

104 
__off64_t
 
__off£t
è
__wur
;

115 
ssize_t
 
	$pwr™ev64
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

116 
__off64_t
 
__off£t
è
__wur
;

120 
__END_DECLS


	@/usr/include/sys/un.h

18 #iâdef 
_SYS_UN_H


19 
	#_SYS_UN_H
 1

	)

21 
	~<sys/cdefs.h
>

24 
	~<b™s/sockaddr.h
>

26 
__BEGIN_DECLS


29 
	ssockaddr_un


31 
__SOCKADDR_COMMON
 (
sun_
);

32 
	msun_·th
[108];

36 #ifdeà
__USE_MISC


37 
	~<¡ršg.h
>

40 
	#SUN_LEN
(
±r
è((
size_t
è(((
sockaddr_un
 *è0)->
sun_·th
) \

41 + 
	`¡¾’
 ((
±r
)->
sun_·th
))

	)

44 
	g__END_DECLS


	@/usr/include/sys/wait.h

22 #iâdef 
_SYS_WAIT_H


23 
	#_SYS_WAIT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<sigÇl.h
>

32 #ià!
defšed
 
_STDLIB_H
 || (!defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K8
)

35 
	~<b™s/wa™æags.h
>

37 #ifdef 
__USE_BSD


42 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


43 
	#__WAIT_INT
(
¡©us
) \

44 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

45 { .
__š
 = (
¡©us
è}).
__i
))

	)

47 
	#__WAIT_INT
(
¡©us
è(*(cÚ¡ *è&(¡©us))

	)

55 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


56 
	#__WAIT_STATUS
 *

	)

57 
	#__WAIT_STATUS_DEFN
 *

	)

62 
wa™
 *
	m__u±r
;

63 *
	m__Œ
;

64 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

71 
	#__WAIT_STATUS
 *

	)

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	~<b™s/wa™¡©us.h
>

79 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

80 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

81 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

82 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

83 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

84 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

85 #ifdeà
__WIFCONTINUED


86 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdef 
__USE_BSD


91 
	#WCOREFLAG
 
__WCOREFLAG


	)

92 
	#WCOREDUMP
(
¡©us
è
	`__WCOREDUMP
 (
	`__WAIT_INT
 (¡©us))

	)

93 
	#W_EXITCODE
(
»t
, 
sig
è
	`__W_EXITCODE
 (»t, sig)

	)

94 
	#W_STOPCODE
(
sig
è
	`__W_STOPCODE
 (sig)

	)

102 
__pid_t
 
wa™
 (
__WAIT_STATUS
 
__¡©_loc
);

104 #ifdef 
__USE_BSD


106 
	#WAIT_ANY
 (-1è

	)

107 
	#WAIT_MYPGRP
 0

	)

125 
__pid_t
 
wa™pid
 (__pid_ˆ
__pid
, *
__¡©_loc
, 
__İtiÚs
);

127 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


128 #iâdeà
__id_t_defšed


129 
	~<b™s/ty³s.h
>

130 
__id_t
 
	tid_t
;

131 
	#__id_t_defšed


	)

134 
	#__Ãed_sigšfo_t


	)

135 
	~<b™s/sigšfo.h
>

148 
wa™id
 (
idty³_t
 
__idty³
, 
__id_t
 
__id
, 
sigšfo_t
 *
__šfİ
,

149 
__İtiÚs
);

152 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


155 
	gru§ge
;

162 
__pid_t
 
	$wa™3
 (
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

163 
ru§ge
 * 
__u§ge
è
__THROWNL
;

166 #ifdeà
__USE_BSD


168 
__pid_t
 
	$wa™4
 (
__pid_t
 
__pid
, 
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

169 
ru§ge
 *
__u§ge
è
__THROWNL
;

173 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¦og.h
>

	@/usr/include/termios.h

22 #iâdef 
_TERMIOS_H


23 
	#_TERMIOS_H
 1

	)

25 
	~<ã©u»s.h
>

26 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


28 
	~<b™s/ty³s.h
>

29 #iâdeà
__pid_t_defšed


30 
__pid_t
 
	tpid_t
;

31 
	#__pid_t_defšed


	)

35 
	g__BEGIN_DECLS


39 
	~<b™s/‹rmios.h
>

41 #ifdeà
__USE_BSD


44 
	#CCEQ
(
v®
, 
c
è((cè=ğ(v®è&& (v®è!ğ
_POSIX_VDISABLE
)

	)

48 
¥“d_t
 
	$cfg‘o¥“d
 (cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

51 
¥“d_t
 
	$cfg‘i¥“d
 (cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

54 
	$cf£to¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

57 
	$cf£ti¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

59 #ifdef 
__USE_BSD


61 
	$cf£t¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

66 
	$tcg‘©Œ
 (
__fd
, 
‹rmios
 *
__‹rmios_p
è
__THROW
;

70 
	$tc£‰r
 (
__fd
, 
__İtiÚ®_aùiÚs
,

71 cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

74 #ifdef 
__USE_BSD


76 
	$cfmak”aw
 (
‹rmios
 *
__‹rmios_p
è
__THROW
;

80 
	$tc£ndb»ak
 (
__fd
, 
__du¿tiÚ
è
__THROW
;

86 
	`tcd¿š
 (
__fd
);

90 
	$tcæush
 (
__fd
, 
__queue_£ËùÜ
è
__THROW
;

94 
	$tcæow
 (
__fd
, 
__aùiÚ
è
__THROW
;

97 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


99 
__pid_t
 
	$tcg‘sid
 (
__fd
è
__THROW
;

103 #ifdeà
__USE_BSD


104 
	~<sys/‰ydeçuÉs.h
>

107 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_SVID


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/ttyent.h

32 #iâdef 
_TTYENT_H


33 
	#_TTYENT_H
 1

	)

35 
	~<ã©u»s.h
>

37 
	#_PATH_TTYS
 "/‘c/‰ys"

	)

39 
	#_TTYS_OFF
 "off"

	)

40 
	#_TTYS_ON
 "Ú"

	)

41 
	#_TTYS_SECURE
 "£cu»"

	)

42 
	#_TTYS_WINDOW
 "wšdow"

	)

44 
	s‰y’t
 {

45 *
	mty_Çme
;

46 *
	mty_g‘ty
;

47 *
	mty_ty³
;

48 
	#TTY_ON
 0x01

	)

49 
	#TTY_SECURE
 0x02

	)

50 
	mty_¡©us
;

51 *
	mty_wšdow
;

52 *
	mty_comm’t
;

56 
__BEGIN_DECLS


58 
‰y’t
 *
	$g‘‰y’t
 (è
__THROW
;

59 
‰y’t
 *
	$g‘‰yÇm
 (cÚ¡ *
__‰y
è
__THROW
;

60 
	$£‰ty’t
 (è
__THROW
;

61 
	$’d‰y’t
 (è
__THROW
;

63 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifdeà
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #–ià
defšed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #–ià
defšed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<b™s/posix_İt.h
>

205 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


206 
	~<b™s/’vœÚm’ts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<b™s/ty³s.h
>

219 #iâdef 
__ssize_t_defšed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_defšed


	)

224 
	#__Ãed_size_t


	)

225 
	#__Ãed_NULL


	)

226 
	~<¡ddef.h
>

228 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


231 #iâdeà
__gid_t_defšed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_defšed


	)

236 #iâdeà
__uid_t_defšed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_defšed


	)

241 #iâdeà
__off_t_defšed


242 #iâdeà
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_defšed


	)

249 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_defšed


	)

254 #iâdeà
__u£cÚds_t_defšed


255 
__u£cÚds_t
 
	tu£cÚds_t
;

256 
	#__u£cÚds_t_defšed


	)

259 #iâdeà
__pid_t_defšed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_defšed


	)

265 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


266 #iâdeà
__šŒ_t_defšed


267 
__šŒ_t
 
	tšŒ_t
;

268 
	#__šŒ_t_defšed


	)

272 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


273 #iâdeà
__sockËn_t_defšed


274 
__sockËn_t
 
	tsockËn_t
;

275 
	#__sockËn_t_defšed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

289 #ifdeà
__USE_GNU


292 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

293 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

297 
__THROW
 
	`__nÚnuÎ
 ((1));

300 #ifdeà
__USE_ATFILE


304 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

310 #iâdef 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifdeà
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #iâdeà
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

336 #ifdeà
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifdeà
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

346 
__THROW
;

353 
	`şo£
 (
__fd
);

360 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

366 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

368 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


369 #iâdeà
__USE_FILE_OFFSET64


376 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

377 
__off_t
 
__off£t
è
__wur
;

384 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
è
__wur
;

387 #ifdeà
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

389 
__off64_t
 
__off£t
),

390 
´—d64
è
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

392 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

393 
pwr™e64
è
__wur
;

395 
	#´—d
 
´—d64


	)

396 
	#pwr™e
 
pwr™e64


	)

400 #ifdeà
__USE_LARGEFILE64


404 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

405 
__off64_t
 
__off£t
è
__wur
;

408 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
è
__wur
;

417 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

419 #ifdeà
__USE_GNU


422 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

432 
	$®¬m
 (
__£cÚds
è
__THROW
;

444 
	`¦“p
 (
__£cÚds
);

446 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

447 || 
defšed
 
__USE_BSD


452 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

453 
__THROW
;

460 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

469 
	`·u£
 ();

473 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

476 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

483 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

488 #ifdeà
__USE_ATFILE


491 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

492 
__gid_t
 
__group
, 
__æag
)

493 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

497 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

499 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


501 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

511 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

520 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

521 || 
defšed
 
__USE_BSD


525 *
	$g‘wd
 (*
__buf
)

526 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

531 
	$dup
 (
__fd
è
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

536 #ifdeà
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

543 **
__’vœÚ
;

544 #ifdeà
__USE_GNU


545 **
’vœÚ
;

551 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

552 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

554 #ifdeà
__USE_XOPEN2K8


557 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

558 
__THROW
 
	`__nÚnuÎ
 ((2));

563 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

564 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

568 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

573 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

578 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

585 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 #ifdeà
__USE_GNU


590 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

591 *cÚ¡ 
__’vp
[])

592 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

596 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


598 
	$niû
 (
__šc
è
__THROW
 
__wur
;

603 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

609 
	~<b™s/cÚâame.h
>

612 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

613 
__THROW
 
	`__nÚnuÎ
 ((1));

616 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

619 
	$syscÚf
 (
__Çme
è
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

628 
__pid_t
 
	$g‘pid
 (è
__THROW
;

631 
__pid_t
 
	$g‘µid
 (è
__THROW
;

634 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

637 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

638 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


639 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

646 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

648 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


660 
	$£g½
 (è
__THROW
;

667 
__pid_t
 
	$£tsid
 (è
__THROW
;

669 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


671 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

675 
__uid_t
 
	$g‘uid
 (è
__THROW
;

678 
__uid_t
 
	$g‘euid
 (è
__THROW
;

681 
__gid_t
 
	$g‘gid
 (è
__THROW
;

684 
__gid_t
 
	$g‘egid
 (è
__THROW
;

689 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

702 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


705 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

708 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


710 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

719 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


727 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

730 #ifdeà
__USE_GNU


733 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

734 
__THROW
;

738 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

739 
__THROW
;

743 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

744 
__THROW
 
__wur
;

748 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

758 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

759 || 
defšed
 
__USE_BSD


764 
__pid_t
 
	$vfÜk
 (è
__THROW
;

770 *
	$‰yÇme
 (
__fd
è
__THROW
;

774 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

775 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

779 
	$i§‰y
 (
__fd
è
__THROW
;

781 #ià
defšed
 
__USE_BSD
 \

782 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

785 
	$‰y¦Ù
 (è
__THROW
;

790 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

791 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

793 #ifdeà
__USE_ATFILE


796 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

797 cÚ¡ *
__to
, 
__æags
)

798 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

801 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


803 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

809 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

810 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

811 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

814 #ifdeà
__USE_ATFILE


816 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

817 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

820 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

821 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

822 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

826 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

828 #ifdeà
__USE_ATFILE


830 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

831 
__THROW
 
	`__nÚnuÎ
 ((2));

835 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

839 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

842 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

849 *
	`g‘logš
 ();

850 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


857 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__Ãed_g‘İt


	)

871 
	~<g‘İt.h
>

875 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


879 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

886 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

887 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

897 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

898 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

899 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

900 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

906 
	$vhªgup
 (è
__THROW
;

909 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

917 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sÿË
)

919 
__THROW
 
	`__nÚnuÎ
 ((1));

925 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

929 *
	$g‘u£rsh–l
 (è
__THROW
;

930 
	$’du£rsh–l
 (è
__THROW
;

931 
	$£tu£rsh–l
 (è
__THROW
;

937 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

941 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

944 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

948 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifdeà
__USE_GNU


962 
	$syncfs
 (
__fd
è
__THROW
;

966 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


969 
	`g‘ho¡id
 ();

972 
	$sync
 (è
__THROW
;

975 #ià
defšed
 
__USE_BSD
 || !defšed 
__USE_XOPEN2K


978 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

983 
	$g‘dbËsize
 (è
__THROW
;

989 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


992 #iâdeà
__USE_FILE_OFFSET64


993 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

994 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

996 #ifdeà
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

998 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

999 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1001 
	#Œunÿ‹
 
Œunÿ‹64


	)

1004 #ifdeà
__USE_LARGEFILE64


1005 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1011 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_POSIX199309
 \

1012 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1015 #iâdeà
__USE_FILE_OFFSET64


1016 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1018 #ifdeà
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1020 
árunÿ‹64
è
__wur
;

1022 
	#árunÿ‹
 
árunÿ‹64


	)

1025 #ifdeà
__USE_LARGEFILE64


1026 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1032 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1033 || 
defšed
 
__USE_MISC


1037 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1043 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1047 #ifdeà
__USE_MISC


1058 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1063 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #iâdeà
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1083 #ifdeà
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1085 
lockf64
è
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifdeà
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1096 #ifdeà
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1102 (
__ex‹nsiÚ__
 \

1103 ({ 
__»suÉ
; \

1104 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1105 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1106 
__»suÉ
; 
	}
}))

	)

1109 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1112 
fd©async
 (
__fdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1121 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1125 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1126 
__THROW
 
	`__nÚnuÎ
 ((1));

1133 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1134 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1140 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1142 *
	$ù”mid
 (*
__s
è
__THROW
;

1147 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1148 
	~<b™s/uni¡d.h
>

1151 
__END_DECLS


	@/usr/include/utime.h

22 #iâdef 
_UTIME_H


23 
	#_UTIME_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


32 
	#__Ãed_time_t


	)

33 
	~<time.h
>

37 
	sutimbuf


39 
__time_t
 
	maùime
;

40 
__time_t
 
	mmodtime
;

45 
	$utime
 (cÚ¡ *
__fe
,

46 cÚ¡ 
utimbuf
 *
__fe_times
)

47 
__THROW
 
	`__nÚnuÎ
 ((1));

49 
__END_DECLS


	@/usr/include/utmp.h

18 #iâdef 
_UTMP_H


19 
	#_UTMP_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<sys/ty³s.h
>

26 
	g__BEGIN_DECLS


29 
	~<b™s/utmp.h
>

32 
	#UTMP_FILE
 
_PATH_UTMP


	)

33 
	#UTMP_FILENAME
 
_PATH_UTMP


	)

34 
	#WTMP_FILE
 
_PATH_WTMP


	)

35 
	#WTMP_FILENAME
 
_PATH_WTMP


	)

41 
	$logš_‰y
 (
__fd
è
__THROW
;

45 
	$logš
 (cÚ¡ 
utmp
 *
__’Œy
è
__THROW
;

48 
	$logout
 (cÚ¡ *
__ut_lše
è
__THROW
;

51 
	$logwtmp
 (cÚ¡ *
__ut_lše
, cÚ¡ *
__ut_Çme
,

52 cÚ¡ *
__ut_ho¡
è
__THROW
;

55 
	$updwtmp
 (cÚ¡ *
__wtmp_fe
, cÚ¡ 
utmp
 *
__utmp
)

56 
__THROW
;

59 
	$utm²ame
 (cÚ¡ *
__fe
è
__THROW
;

62 
utmp
 *
	$g‘u‹Á
 (è
__THROW
;

65 
	$£tu‹Á
 (è
__THROW
;

68 
	$’du‹Á
 (è
__THROW
;

72 
utmp
 *
	$g‘utid
 (cÚ¡ 
utmp
 *
__id
è
__THROW
;

76 
utmp
 *
	$g‘uše
 (cÚ¡ 
utmp
 *
__lše
è
__THROW
;

79 
utmp
 *
	$putuše
 (cÚ¡ 
utmp
 *
__utmp_±r
è
__THROW
;

82 #ifdef 
__USE_MISC


84 
	$g‘u‹Á_r
 (
utmp
 *
__bufãr
, utm°**
__»suÉ
è
__THROW
;

86 
	$g‘utid_r
 (cÚ¡ 
utmp
 *
__id
, utm°*
__bufãr
,

87 
utmp
 **
__»suÉ
è
__THROW
;

89 
	$g‘uše_r
 (cÚ¡ 
utmp
 *
__lše
,

90 
utmp
 *
__bufãr
, utm°**
__»suÉ
è
__THROW
;

94 
__END_DECLS


	@/usr/include/utmpx.h

18 #iâdef 
_UTMPX_H


19 
	#_UTMPX_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<sys/time.h
>

25 #iâdeà
__pid_t_defšed


26 
__pid_t
 
	tpid_t
;

27 
	#__pid_t_defšed


	)

31 
	~<b™s/utmpx.h
>

33 #ifdeà
__USE_GNU


35 
	#UTMPX_FILE
 
_PATH_UTMPX


	)

36 
	#UTMPX_FILENAME
 
_PATH_UTMPX


	)

37 
	#WTMPX_FILE
 
_PATH_WTMPX


	)

38 
	#WTMPX_FILENAME
 
_PATH_WTMPX


	)

42 #ifdeà
__USE_GNU


43 
	gutmp
;

47 
__BEGIN_DECLS


53 
£tutx’t
 ();

59 
’dutx’t
 ();

65 
utmpx
 *
g‘utx’t
 ();

71 
utmpx
 *
g‘utxid
 (cÚ¡ utmpx *
__id
);

77 
utmpx
 *
g‘utxlše
 (cÚ¡ utmpx *
__lše
);

83 
utmpx
 *
pututxlše
 (cÚ¡ utmpx *
__utmpx
);

86 #ifdeà
__USE_GNU


93 
utmpxÇme
 (cÚ¡ *
__fe
);

101 
updwtmpx
 (cÚ¡ *
__wtmpx_fe
,

102 cÚ¡ 
utmpx
 *
__utmpx
);

111 
g‘utmp
 (cÚ¡ 
utmpx
 *
__utmpx
,

112 
utmp
 *
__utmp
);

120 
g‘utmpx
 (cÚ¡ 
utmp
 *
__utmp
, 
utmpx
 *
__utmpx
);

123 
	g__END_DECLS


	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

158 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

159 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

164 
__THROW
 
__©Œibu‹_pu»__
;

166 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©Œibu‹_pu»__
;

168 
__END_NAMESPACE_STD


170 #ifdeà
__USE_XOPEN2K8


172 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

175 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

176 
size_t
 
__n
è
__THROW
;

180 
	~<xloÿË.h
>

182 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

183 
__loÿË_t
 
__loc
è
__THROW
;

185 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

196 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

197 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifdeà
__USE_XOPEN2K8


206 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

207 
__loÿË_t
 
__loc
è
__THROW
;

212 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

213 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

216 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
__©Œibu‹_pu»__
;

231 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

233 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
__END_NAMESPACE_STD


242 #ifdeà
__USE_GNU


245 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

246 
__THROW
 
__©Œibu‹_pu»__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

253 
__THROW
 
__©Œibu‹_pu»__
;

256 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

257 
__THROW
 
__©Œibu‹_pu»__
;

259 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

262 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

263 cÚ¡ 
wch¬_t
 *
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

266 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

267 
__THROW
 
__©Œibu‹_pu»__
;

270 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

273 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

274 cÚ¡ 
wch¬_t
 *
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

277 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

278 
__THROW
 
__©Œibu‹_pu»__
;

282 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

283 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

284 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

287 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

288 
__END_NAMESPACE_STD


290 #ifdeà
__USE_XOPEN


292 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

295 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

296 cÚ¡ 
wch¬_t
 *
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

299 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

300 
__THROW
 
__©Œibu‹_pu»__
;

304 #ifdeà
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

307 
__THROW
 
__©Œibu‹_pu»__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

316 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

320 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©Œibu‹_pu»__
;

325 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©Œibu‹_pu»__
;

329 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

330 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

334 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifdeà
__USE_GNU


344 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

345 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

357 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

361 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

365 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

366 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

367 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

370 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

371 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

377 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifdeà
__USE_EXTERN_INLINES


386 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

387 
__ex‹º_šlše
 
wšt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

392 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

393 
__ex‹º_šlše
 

394 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

395 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

396 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

398 
__ex‹º_šlše
 
size_t


399 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

400 
mb¡©e_t
 *
__»¡riù
 
__ps
))

401 {  (
__ps
 !ğ
NULL


402 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

409 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

410 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

414 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

415 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

416 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

424 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

425 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

429 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

430 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

431 
size_t
 
__nwc
, size_ˆ
__Ën
,

432 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

437 #ifdeà
__USE_XOPEN


439 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

443 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

451 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifdeà
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

460 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

469 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

473 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifdeà
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__ex‹nsiÚ__


483 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

484 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

485 
__THROW
;

489 
__ex‹nsiÚ__


490 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

491 
wch¬_t
 **
__»¡riù
 
__’d±r
,

492 
__ba£
è
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifdeà
__USE_GNU


499 
__ex‹nsiÚ__


500 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

502 
__THROW
;

506 
__ex‹nsiÚ__


507 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

508 
wch¬_t
 **
__»¡riù
 
__’d±r
,

509 
__ba£
è
__THROW
;

512 #ifdeà
__USE_GNU


526 
	~<xloÿË.h
>

530 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

531 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

532 
__loÿË_t
 
__loc
è
__THROW
;

534 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

535 
wch¬_t
 **
__»¡riù
 
__’d±r
,

536 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

538 
__ex‹nsiÚ__


539 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

540 
wch¬_t
 **
__»¡riù
 
__’d±r
,

541 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

543 
__ex‹nsiÚ__


544 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

545 
wch¬_t
 **
__»¡riù
 
__’d±r
,

546 
__ba£
, 
__loÿË_t
 
__loc
)

547 
__THROW
;

549 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

550 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

551 
__THROW
;

553 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

554 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

555 
__THROW
;

557 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

558 
wch¬_t
 **
__»¡riù
 
__’d±r
,

559 
__loÿË_t
 
__loc
è
__THROW
;

563 #ifdeà
__USE_XOPEN2K8


566 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

567 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

571 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

572 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

583 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

594 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

595 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

601 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

605 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

606 
__THROW
 ;

612 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

613 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

614 
__gnuc_va_li¡
 
__¬g
)

620 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

621 
__gnuc_va_li¡
 
__¬g
)

625 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

626 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

627 
__gnuc_va_li¡
 
__¬g
)

628 
__THROW
 ;

635 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

636 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

642 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

646 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

647 
__THROW
 ;

649 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

650 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

651 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

652 #ifdeà
__REDIRECT


656 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

657 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

658 
__isoc99_fwsÿnf
)

660 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_wsÿnf
)

663 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

664 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

665 ...), 
__isoc99_swsÿnf
)

668 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

669 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

670 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

671 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

673 
__THROW
;

674 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

675 
	#wsÿnf
 
__isoc99_wsÿnf


	)

676 
	#swsÿnf
 
__isoc99_swsÿnf


	)

680 
__END_NAMESPACE_STD


683 #ifdeà
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

690 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

691 
__gnuc_va_li¡
 
__¬g
)

697 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

698 
__gnuc_va_li¡
 
__¬g
)

701 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
)

704 
__THROW
 ;

706 #ià!
defšed
 
__USE_GNU
 \

707 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

708 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

711 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

712 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

714 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

717 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

718 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

719 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

722 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

723 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

726 
__gnuc_va_li¡
 
__¬g
);

727 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

728 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

730 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

731 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

732 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

746 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

752 
wšt_t
 
	`g‘wch¬
 ();

759 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

760 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

766 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

774 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

775 
__FILE
 *
__»¡riù
 
__¡»am
);

781 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

782 
__FILE
 *
__»¡riù
 
__¡»am
);

789 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

790 
__END_NAMESPACE_STD


793 #ifdeà
__USE_GNU


801 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

802 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

810 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

818 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

827 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

828 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

837 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

838 
__FILE
 *
__»¡riù
 
__¡»am
);

846 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

847 
__FILE
 *
__»¡riù
 
__¡»am
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

856 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

857 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifdeà
__USE_GNU


861 
	~<xloÿË.h
>

865 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

866 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

867 cÚ¡ 
tm
 *
__»¡riù
 
__
,

868 
__loÿË_t
 
__loc
è
__THROW
;

877 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


878 
	#__Ãed_iswxxx


	)

879 
	~<wùy³.h
>

883 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


884 
	~<b™s/wch¬2.h
>

887 #ifdeà
__LDBL_COMPAT


888 
	~<b™s/wch¬-ldbl.h
>

891 
__END_DECLS


899 #undeà
__Ãed_mb¡©e_t


900 #undeà
__Ãed_wšt_t


	@/usr/include/zlib.h

31 #iâdeà
ZLIB_H


32 
	#ZLIB_H


	)

34 
	~"zcÚf.h
"

36 #ifdeà
__ılu¥lus


40 
	#ZLIB_VERSION
 "1.2.8"

	)

41 
	#ZLIB_VERNUM
 0x1280

	)

42 
	#ZLIB_VER_MAJOR
 1

	)

43 
	#ZLIB_VER_MINOR
 2

	)

44 
	#ZLIB_VER_REVISION
 8

	)

45 
	#ZLIB_VER_SUBREVISION
 0

	)

80 
voidpf
 (*
	t®loc_func
è
	tOF
((
	tvoidpf
 
	tİaque
, 
	tuIÁ
 
	t™ems
, uIÁ 
	tsize
));

81 (*
ä“_func
è
	tOF
((
	tvoidpf
 
	tİaque
, voidpà
	tadd»ss
));

83 
š‹º®_¡©e
;

85 
	sz_¡»am_s
 {

86 
z_cÚ¡
 
By‹f
 *
Ãxt_š
;

87 
uIÁ
 
ava_š
;

88 
uLÚg
 
tÙ®_š
;

90 
By‹f
 *
Ãxt_out
;

91 
uIÁ
 
ava_out
;

92 
uLÚg
 
tÙ®_out
;

94 
z_cÚ¡
 *
msg
;

95 
š‹º®_¡©e
 
FAR
 *
¡©e
;

97 
®loc_func
 
z®loc
;

98 
ä“_func
 
zä“
;

99 
voidpf
 
İaque
;

101 
d©a_ty³
;

102 
uLÚg
 
adËr
;

103 
uLÚg
 
»£rved
;

104 } 
	tz_¡»am
;

106 
z_¡»am
 
	tFAR
 *
	tz_¡»amp
;

112 
	sgz_h—d”_s
 {

113 
‹xt
;

114 
uLÚg
 
time
;

115 
xæags
;

116 
os
;

117 
By‹f
 *
exŒa
;

118 
uIÁ
 
exŒa_Ën
;

119 
uIÁ
 
exŒa_max
;

120 
By‹f
 *
Çme
;

121 
uIÁ
 
Çme_max
;

122 
By‹f
 *
comm’t
;

123 
uIÁ
 
comm_max
;

124 
hüc
;

125 
dÚe
;

127 } 
	tgz_h—d”
;

129 
gz_h—d”
 
	tFAR
 *
	tgz_h—d”p
;

164 
	#Z_NO_FLUSH
 0

	)

165 
	#Z_PARTIAL_FLUSH
 1

	)

166 
	#Z_SYNC_FLUSH
 2

	)

167 
	#Z_FULL_FLUSH
 3

	)

168 
	#Z_FINISH
 4

	)

169 
	#Z_BLOCK
 5

	)

170 
	#Z_TREES
 6

	)

173 
	#Z_OK
 0

	)

174 
	#Z_STREAM_END
 1

	)

175 
	#Z_NEED_DICT
 2

	)

176 
	#Z_ERRNO
 (-1)

	)

177 
	#Z_STREAM_ERROR
 (-2)

	)

178 
	#Z_DATA_ERROR
 (-3)

	)

179 
	#Z_MEM_ERROR
 (-4)

	)

180 
	#Z_BUF_ERROR
 (-5)

	)

181 
	#Z_VERSION_ERROR
 (-6)

	)

186 
	#Z_NO_COMPRESSION
 0

	)

187 
	#Z_BEST_SPEED
 1

	)

188 
	#Z_BEST_COMPRESSION
 9

	)

189 
	#Z_DEFAULT_COMPRESSION
 (-1)

	)

192 
	#Z_FILTERED
 1

	)

193 
	#Z_HUFFMAN_ONLY
 2

	)

194 
	#Z_RLE
 3

	)

195 
	#Z_FIXED
 4

	)

196 
	#Z_DEFAULT_STRATEGY
 0

	)

199 
	#Z_BINARY
 0

	)

200 
	#Z_TEXT
 1

	)

201 
	#Z_ASCII
 
Z_TEXT


	)

202 
	#Z_UNKNOWN
 2

	)

205 
	#Z_DEFLATED
 8

	)

208 
	#Z_NULL
 0

	)

210 
	#zlib_v”siÚ
 
	`zlibV”siÚ
()

	)

216 
ZEXTERN
 cÚ¡ * 
ZEXPORT
 
zlibV”siÚ
 
OF
(());

246 
ZEXTERN
 
ZEXPORT
 
deæ©e
 
OF
((
z_¡»amp
 
¡rm
, 
æush
));

353 
ZEXTERN
 
ZEXPORT
 
deæ©eEnd
 
OF
((
z_¡»amp
 
¡rm
));

392 
ZEXTERN
 
ZEXPORT
 
šæ©e
 
OF
((
z_¡»amp
 
¡rm
, 
æush
));

508 
ZEXTERN
 
ZEXPORT
 
šæ©eEnd
 
OF
((
z_¡»amp
 
¡rm
));

587 
ZEXTERN
 
ZEXPORT
 
deæ©eS‘DiùiÚ¬y
 
OF
((
z_¡»amp
 
¡rm
,

588 cÚ¡ 
By‹f
 *
diùiÚ¬y
,

589 
uIÁ
 
diùL’gth
));

631 
ZEXTERN
 
ZEXPORT
 
deæ©eCİy
 
OF
((
z_¡»amp
 
de¡
,

632 
z_¡»amp
 
sourû
));

649 
ZEXTERN
 
ZEXPORT
 
deæ©eRe£t
 
OF
((
z_¡»amp
 
¡rm
));

660 
ZEXTERN
 
ZEXPORT
 
deæ©eP¬ams
 
OF
((
z_¡»amp
 
¡rm
,

661 
Ëv–
,

662 
¡¿‹gy
));

681 
ZEXTERN
 
ZEXPORT
 
deæ©eTuÃ
 
OF
((
z_¡»amp
 
¡rm
,

682 
good_Ëngth
,

683 
max_Ïzy
,

684 
niû_Ëngth
,

685 
max_chaš
));

698 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
deæ©eBound
 
OF
((
z_¡»amp
 
¡rm
,

699 
uLÚg
 
sourûL’
));

713 
ZEXTERN
 
ZEXPORT
 
deæ©eP’dšg
 
OF
((
z_¡»amp
 
¡rm
,

714 *
³ndšg
,

715 *
b™s
));

728 
ZEXTERN
 
ZEXPORT
 
deæ©ePrime
 
OF
((
z_¡»amp
 
¡rm
,

729 
b™s
,

730 
v®ue
));

745 
ZEXTERN
 
ZEXPORT
 
deæ©eS‘H—d”
 
OF
((
z_¡»amp
 
¡rm
,

746 
gz_h—d”p
 
h—d
));

819 
ZEXTERN
 
ZEXPORT
 
šæ©eS‘DiùiÚ¬y
 
OF
((
z_¡»amp
 
¡rm
,

820 cÚ¡ 
By‹f
 *
diùiÚ¬y
,

821 
uIÁ
 
diùL’gth
));

842 
ZEXTERN
 
ZEXPORT
 
šæ©eG‘DiùiÚ¬y
 
OF
((
z_¡»amp
 
¡rm
,

843 
By‹f
 *
diùiÚ¬y
,

844 
uIÁ
 *
diùL’gth
));

857 
ZEXTERN
 
ZEXPORT
 
šæ©eSync
 
OF
((
z_¡»amp
 
¡rm
));

876 
ZEXTERN
 
ZEXPORT
 
šæ©eCİy
 
OF
((
z_¡»amp
 
de¡
,

877 
z_¡»amp
 
sourû
));

892 
ZEXTERN
 
ZEXPORT
 
šæ©eRe£t
 
OF
((
z_¡»amp
 
¡rm
));

902 
ZEXTERN
 
ZEXPORT
 
šæ©eRe£t2
 
OF
((
z_¡»amp
 
¡rm
,

903 
wšdowB™s
));

914 
ZEXTERN
 
ZEXPORT
 
šæ©ePrime
 
OF
((
z_¡»amp
 
¡rm
,

915 
b™s
,

916 
v®ue
));

935 
ZEXTERN
 
ZEXPORT
 
šæ©eM¬k
 
OF
((
z_¡»amp
 
¡rm
));

963 
ZEXTERN
 
ZEXPORT
 
šæ©eG‘H—d”
 
OF
((
z_¡»amp
 
¡rm
,

964 
gz_h—d”p
 
h—d
));

1025 (*
š_func
è
	tOF
((
	tFAR
 *,

1026 
	tz_cÚ¡
 
	tFAR
 * FAR *));

1027 (*
out_func
è
	tOF
((
	tFAR
 *, FAR *, ));

1029 
ZEXTERN
 
ZEXPORT
 
šæ©eBack
 
OF
((
z_¡»amp
 
¡rm
,

1030 
š_func
 
š
, 
FAR
 *
š_desc
,

1031 
out_func
 
out
, 
FAR
 *
out_desc
));

1099 
ZEXTERN
 
ZEXPORT
 
šæ©eBackEnd
 
OF
((
z_¡»amp
 
¡rm
));

1107 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
zlibCompeFÏgs
 
OF
(());

1148 #iâdeà
Z_SOLO


1160 
ZEXTERN
 
ZEXPORT
 
com´ess
 
OF
((
By‹f
 *
de¡
, 
uLÚgf
 *
de¡L’
,

1161 cÚ¡ 
By‹f
 *
sourû
, 
uLÚg
 
sourûL’
));

1174 
ZEXTERN
 
ZEXPORT
 
com´ess2
 
OF
((
By‹f
 *
de¡
, 
uLÚgf
 *
de¡L’
,

1175 cÚ¡ 
By‹f
 *
sourû
, 
uLÚg
 
sourûL’
,

1176 
Ëv–
));

1190 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
com´essBound
 
OF
((uLÚg 
sourûL’
));

1197 
ZEXTERN
 
ZEXPORT
 
uncom´ess
 
OF
((
By‹f
 *
de¡
, 
uLÚgf
 *
de¡L’
,

1198 cÚ¡ 
By‹f
 *
sourû
, 
uLÚg
 
sourûL’
));

1224 
gzFe_s
 *
	tgzFe
;

1264 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzdİ’
 
OF
((
fd
, cÚ¡ *
mode
));

1287 
ZEXTERN
 
ZEXPORT
 
gzbufãr
 
OF
((
gzFe
 
fe
, 
size
));

1304 
ZEXTERN
 
ZEXPORT
 
gz£¬ams
 
OF
((
gzFe
 
fe
, 
Ëv–
, 
¡¿‹gy
));

1313 
ZEXTERN
 
ZEXPORT
 
gz»ad
 
OF
((
gzFe
 
fe
, 
voidp
 
buf
, 
Ën
));

1341 
ZEXTERN
 
ZEXPORT
 
gzwr™e
 
OF
((
gzFe
 
fe
,

1342 
voidpc
 
buf
, 
Ën
));

1349 
ZEXTERN
 
ZEXPORTVA
 
gz´štf
 
Z_ARG
((
gzFe
 
fe
, cÚ¡ *
fÜm©
, ...));

1364 
ZEXTERN
 
ZEXPORT
 
gzputs
 
OF
((
gzFe
 
fe
, cÚ¡ *
s
));

1372 
ZEXTERN
 * 
ZEXPORT
 
gzg‘s
 
OF
((
gzFe
 
fe
, *
buf
, 
Ën
));

1385 
ZEXTERN
 
ZEXPORT
 
gzputc
 
OF
((
gzFe
 
fe
, 
c
));

1391 
ZEXTERN
 
ZEXPORT
 
gzg‘c
 
OF
((
gzFe
 
fe
));

1400 
ZEXTERN
 
ZEXPORT
 
gzung‘c
 
OF
((
c
, 
gzFe
 
fe
));

1412 
ZEXTERN
 
ZEXPORT
 
gzæush
 
OF
((
gzFe
 
fe
, 
æush
));

1447 
ZEXTERN
 
ZEXPORT
 
gz»wšd
 
OF
((
gzFe
 
fe
));

1475 
ZEXTERN
 
ZEXPORT
 
gzeof
 
OF
((
gzFe
 
fe
));

1490 
ZEXTERN
 
ZEXPORT
 
gzdœeù
 
OF
((
gzFe
 
fe
));

1511 
ZEXTERN
 
ZEXPORT
 
gzşo£
 
OF
((
gzFe
 
fe
));

1524 
ZEXTERN
 
ZEXPORT
 
gzşo£_r
 
OF
((
gzFe
 
fe
));

1525 
ZEXTERN
 
ZEXPORT
 
gzşo£_w
 
OF
((
gzFe
 
fe
));

1536 
ZEXTERN
 cÚ¡ * 
ZEXPORT
 
gz”rÜ
 
OF
((
gzFe
 
fe
, *
”ºum
));

1552 
ZEXTERN
 
ZEXPORT
 
gzş—»¼
 
OF
((
gzFe
 
fe
));

1569 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32
 
OF
((uLÚg 
adËr
, cÚ¡ 
By‹f
 *
buf
, 
uIÁ
 
Ën
));

1600 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32
 
OF
((uLÚg 
üc
, cÚ¡ 
By‹f
 *
buf
, 
uIÁ
 
Ën
));

1633 
ZEXTERN
 
ZEXPORT
 
deæ©eIn™_
 
OF
((
z_¡»amp
 
¡rm
, 
Ëv–
,

1634 cÚ¡ *
v”siÚ
, 
¡»am_size
));

1635 
ZEXTERN
 
ZEXPORT
 
šæ©eIn™_
 
OF
((
z_¡»amp
 
¡rm
,

1636 cÚ¡ *
v”siÚ
, 
¡»am_size
));

1637 
ZEXTERN
 
ZEXPORT
 
deæ©eIn™2_
 
OF
((
z_¡»amp
 
¡rm
, 
Ëv–
, 
m‘hod
,

1638 
wšdowB™s
, 
memLev–
,

1639 
¡¿‹gy
, cÚ¡ *
v”siÚ
,

1640 
¡»am_size
));

1641 
ZEXTERN
 
ZEXPORT
 
šæ©eIn™2_
 
OF
((
z_¡»amp
 
¡rm
, 
wšdowB™s
,

1642 cÚ¡ *
v”siÚ
, 
¡»am_size
));

1643 
ZEXTERN
 
ZEXPORT
 
šæ©eBackIn™_
 
OF
((
z_¡»amp
 
¡rm
, 
wšdowB™s
,

1644 
FAR
 *
wšdow
,

1645 cÚ¡ *
v”siÚ
,

1646 
¡»am_size
));

1647 
	#deæ©eIn™
(
¡rm
, 
Ëv–
) \

1648 
	`deæ©eIn™_
((
¡rm
), (
Ëv–
), 
ZLIB_VERSION
, ()(
z_¡»am
))

	)

1649 
	#šæ©eIn™
(
¡rm
) \

1650 
	`šæ©eIn™_
((
¡rm
), 
ZLIB_VERSION
, ()(
z_¡»am
))

	)

1651 
	#deæ©eIn™2
(
¡rm
, 
Ëv–
, 
m‘hod
, 
wšdowB™s
, 
memLev–
, 
¡¿‹gy
) \

1652 
	`deæ©eIn™2_
((
¡rm
),(
Ëv–
),(
m‘hod
),(
wšdowB™s
),(
memLev–
),\

1653 (
¡¿‹gy
), 
ZLIB_VERSION
, ()(
z_¡»am
))

	)

1654 
	#šæ©eIn™2
(
¡rm
, 
wšdowB™s
) \

1655 
	`šæ©eIn™2_
((
¡rm
), (
wšdowB™s
), 
ZLIB_VERSION
, \

1656 ()(
z_¡»am
))

	)

1657 
	#šæ©eBackIn™
(
¡rm
, 
wšdowB™s
, 
wšdow
) \

1658 
	`šæ©eBackIn™_
((
¡rm
), (
wšdowB™s
), (
wšdow
), \

1659 
ZLIB_VERSION
, ()(
z_¡»am
))

	)

1661 #iâdeà
Z_SOLO


1670 
	sgzFe_s
 {

1671 
have
;

1672 *
Ãxt
;

1673 
z_off64_t
 
pos
;

1675 
ZEXTERN
 
ZEXPORT
 
gzg‘c_
 
OF
((
gzFe
 
fe
));

1676 #ifdeà
Z_PREFIX_SET


1677 #undeà
z_gzg‘c


1678 
	#z_gzg‘c
(
g
) \

1679 ((
g
)->
have
 ? ((g)->have--, (g)->
pos
++, *((g)->
Ãxt
)++è: 
	`gzg‘c
(g))

	)

1681 
	#gzg‘c
(
g
) \

1682 ((
g
)->
have
 ? ((g)->have--, (g)->
pos
++, *((g)->
Ãxt
)++è: 
	`gzg‘c
(g))

	)

1691 #ifdeà
Z_LARGE64


1692 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzİ’64
 
OF
((const *, const *));

1693 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gz£ek64
 
OF
((
gzFe
, z_off64_t, ));

1694 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gz‹Î64
 
OF
((
gzFe
));

1695 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gzoff£t64
 
OF
((
gzFe
));

1696 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32_combše64
 
OF
((uLÚg, uLÚg, 
z_off64_t
));

1697 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32_combše64
 
OF
((uLÚg, uLÚg, 
z_off64_t
));

1700 #ià!
defšed
(
ZLIB_INTERNAL
è&& defšed(
Z_WANT64
)

1701 #ifdeà
Z_PREFIX_SET


1702 
	#z_gzİ’
 
z_gzİ’64


	)

1703 
	#z_gz£ek
 
z_gz£ek64


	)

1704 
	#z_gz‹Î
 
z_gz‹Î64


	)

1705 
	#z_gzoff£t
 
z_gzoff£t64


	)

1706 
	#z_adËr32_combše
 
z_adËr32_combše64


	)

1707 
	#z_üc32_combše
 
z_üc32_combše64


	)

1709 
	#gzİ’
 
gzİ’64


	)

1710 
	#gz£ek
 
gz£ek64


	)

1711 
	#gz‹Î
 
gz‹Î64


	)

1712 
	#gzoff£t
 
gzoff£t64


	)

1713 
	#adËr32_combše
 
adËr32_combše64


	)

1714 
	#üc32_combše
 
üc32_combše64


	)

1716 #iâdeà
Z_LARGE64


1717 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzİ’64
 
OF
((const *, const *));

1718 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz£ek64
 
OF
((
gzFe
, z_off_t, ));

1719 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz‹Î64
 
OF
((
gzFe
));

1720 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gzoff£t64
 
OF
((
gzFe
));

1721 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32_combše64
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1722 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32_combše64
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1725 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzİ’
 
OF
((const *, const *));

1726 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz£ek
 
OF
((
gzFe
, z_off_t, ));

1727 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz‹Î
 
OF
((
gzFe
));

1728 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gzoff£t
 
OF
((
gzFe
));

1729 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32_combše
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1730 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32_combše
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1735 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32_combše
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1736 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32_combše
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1741 #ià!
defšed
(
ZUTIL_H
è&& !defšed(
NO_DUMMY_DECL
)

1742 
	sš‹º®_¡©e
 {
dummy
;};

1746 
ZEXTERN
 cÚ¡ * 
ZEXPORT
 
zE¼Ü
 
OF
(());

1747 
ZEXTERN
 
ZEXPORT
 
šæ©eSyncPošt
 
OF
((
z_¡»amp
));

1748 
ZEXTERN
 cÚ¡ 
z_üc_t
 
FAR
 * 
ZEXPORT
 
g‘_üc_bË
 
OF
(());

1749 
ZEXTERN
 
ZEXPORT
 
šæ©eUnd”mše
 
OF
((
z_¡»amp
, ));

1750 
ZEXTERN
 
ZEXPORT
 
šæ©eRe£tK“p
 
OF
((
z_¡»amp
));

1751 
ZEXTERN
 
ZEXPORT
 
deæ©eRe£tK“p
 
OF
((
z_¡»amp
));

1752 #ià
defšed
(
_WIN32
è&& !defšed(
Z_SOLO
)

1753 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzİ’_w
 
OF
((cÚ¡ 
wch¬_t
 *
·th
,

1754 cÚ¡ *
mode
));

1756 #ià
defšed
(
STDC
è|| defšed(
Z_HAVE_STDARG_H
)

1757 #iâdeà
Z_SOLO


1758 
ZEXTERN
 
ZEXPORTVA
 
gzv´štf
 
Z_ARG
((
gzFe
 
fe
,

1759 cÚ¡ *
fÜm©
,

1760 
va_li¡
 
va
));

1764 #ifdeà
__ılu¥lus


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/arpa/nameser_compat.h

34 #iâdeà
_ARPA_NAMESER_COMPAT_


35 
	#_ARPA_NAMESER_COMPAT_


	)

37 
	#__BIND
 19950621

	)

39 
	~<’dŸn.h
>

49 
	mid
 :16;

50 #ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


52 
	mqr
: 1;

53 
	mİcode
: 4;

54 
	m¯
: 1;

55 
	mtc
: 1;

56 
	mrd
: 1;

58 
	m¿
: 1;

59 
	munu£d
 :1;

60 
	mad
: 1;

61 
	mcd
: 1;

62 
	mrcode
 :4;

64 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN
 || BYTE_ORDER =ğ
PDP_ENDIAN


66 
	mrd
 :1;

67 
	mtc
 :1;

68 
	m¯
 :1;

69 
	mİcode
 :4;

70 
	mqr
 :1;

72 
	mrcode
 :4;

73 
	mcd
: 1;

74 
	mad
: 1;

75 
	munu£d
 :1;

76 
	m¿
 :1;

79 
	mqdcouÁ
 :16;

80 
	mªcouÁ
 :16;

81 
	mnscouÁ
 :16;

82 
	m¬couÁ
 :16;

83 } 
	tHEADER
;

85 
	#PACKETSZ
 
NS_PACKETSZ


	)

86 
	#MAXDNAME
 
NS_MAXDNAME


	)

87 
	#MAXCDNAME
 
NS_MAXCDNAME


	)

88 
	#MAXLABEL
 
NS_MAXLABEL


	)

89 
	#HFIXEDSZ
 
NS_HFIXEDSZ


	)

90 
	#QFIXEDSZ
 
NS_QFIXEDSZ


	)

91 
	#RRFIXEDSZ
 
NS_RRFIXEDSZ


	)

92 
	#INT32SZ
 
NS_INT32SZ


	)

93 
	#INT16SZ
 
NS_INT16SZ


	)

94 
	#INT8SZ
 
NS_INT8SZ


	)

95 
	#INADDRSZ
 
NS_INADDRSZ


	)

96 
	#IN6ADDRSZ
 
NS_IN6ADDRSZ


	)

97 
	#INDIR_MASK
 
NS_CMPRSFLGS


	)

98 
	#NAMESERVER_PORT
 
NS_DEFAULTPORT


	)

100 
	#S_ZONE
 
ns_s_zn


	)

101 
	#S_PREREQ
 
ns_s_´


	)

102 
	#S_UPDATE
 
ns_s_ud


	)

103 
	#S_ADDT
 
ns_s_¬


	)

105 
	#QUERY
 
ns_o_qu”y


	)

106 
	#IQUERY
 
ns_o_iqu”y


	)

107 
	#STATUS
 
ns_o_¡©us


	)

108 
	#NS_NOTIFY_OP
 
ns_o_nÙify


	)

109 
	#NS_UPDATE_OP
 
ns_o_upd©e


	)

111 
	#NOERROR
 
ns_r_nÛ¼Ü


	)

112 
	#FORMERR
 
ns_r_fÜm”r


	)

113 
	#SERVFAIL
 
ns_r_£rvç


	)

114 
	#NXDOMAIN
 
ns_r_nxdomaš


	)

115 
	#NOTIMP
 
ns_r_nÙim¶


	)

116 
	#REFUSED
 
ns_r_»fu£d


	)

117 
	#YXDOMAIN
 
ns_r_yxdomaš


	)

118 
	#YXRRSET
 
ns_r_yx¼£t


	)

119 
	#NXRRSET
 
ns_r_nx¼£t


	)

120 
	#NOTAUTH
 
ns_r_nÙauth


	)

121 
	#NOTZONE
 
ns_r_nÙzÚe


	)

127 
	#DELETE
 
ns_uİ_d–‘e


	)

128 
	#ADD
 
ns_uİ_add


	)

130 
	#T_A
 
ns_t_a


	)

131 
	#T_NS
 
ns_t_ns


	)

132 
	#T_MD
 
ns_t_md


	)

133 
	#T_MF
 
ns_t_mf


	)

134 
	#T_CNAME
 
ns_t_úame


	)

135 
	#T_SOA
 
ns_t_sß


	)

136 
	#T_MB
 
ns_t_mb


	)

137 
	#T_MG
 
ns_t_mg


	)

138 
	#T_MR
 
ns_t_mr


	)

139 
	#T_NULL
 
ns_t_nuÎ


	)

140 
	#T_WKS
 
ns_t_wks


	)

141 
	#T_PTR
 
ns_t_±r


	)

142 
	#T_HINFO
 
ns_t_hšfo


	)

143 
	#T_MINFO
 
ns_t_mšfo


	)

144 
	#T_MX
 
ns_t_mx


	)

145 
	#T_TXT
 
ns_t_txt


	)

146 
	#T_RP
 
ns_t_½


	)

147 
	#T_AFSDB
 
ns_t_afsdb


	)

148 
	#T_X25
 
ns_t_x25


	)

149 
	#T_ISDN
 
ns_t_isdn


	)

150 
	#T_RT
 
ns_t_¹


	)

151 
	#T_NSAP
 
ns_t_n§p


	)

152 
	#T_NSAP_PTR
 
ns_t_n§p_±r


	)

153 
	#T_SIG
 
ns_t_sig


	)

154 
	#T_KEY
 
ns_t_key


	)

155 
	#T_PX
 
ns_t_px


	)

156 
	#T_GPOS
 
ns_t_gpos


	)

157 
	#T_AAAA
 
ns_t_¯¯


	)

158 
	#T_LOC
 
ns_t_loc


	)

159 
	#T_NXT
 
ns_t_nxt


	)

160 
	#T_EID
 
ns_t_eid


	)

161 
	#T_NIMLOC
 
ns_t_nimloc


	)

162 
	#T_SRV
 
ns_t_¤v


	)

163 
	#T_ATMA
 
ns_t_©ma


	)

164 
	#T_NAPTR
 
ns_t_Ç±r


	)

165 
	#T_A6
 
ns_t_a6


	)

166 
	#T_DNAME
 
ns_t_dÇme


	)

167 
	#T_TSIG
 
ns_t_tsig


	)

168 
	#T_IXFR
 
ns_t_ixä


	)

169 
	#T_AXFR
 
ns_t_axä


	)

170 
	#T_MAILB
 
ns_t_mab


	)

171 
	#T_MAILA
 
ns_t_maa


	)

172 
	#T_ANY
 
ns_t_ªy


	)

174 
	#C_IN
 
ns_c_š


	)

175 
	#C_CHAOS
 
ns_c_chaos


	)

176 
	#C_HS
 
ns_c_hs


	)

178 
	#C_NONE
 
ns_c_nÚe


	)

179 
	#C_ANY
 
ns_c_ªy


	)

181 
	#GETSHORT
 
NS_GET16


	)

182 
	#GETLONG
 
NS_GET32


	)

183 
	#PUTSHORT
 
NS_PUT16


	)

184 
	#PUTLONG
 
NS_PUT32


	)

	@/usr/include/bits/byteswap.h

19 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((è((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8)))

	)

35 
	~<b™s/by‹sw­-16.h
>

38 
	#__bsw­_cÚ¡ªt_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

42 #ifdeà
__GNUC__


43 #ià
__GNUC_PREREQ
 (4, 3)

44 
__šlše
 

45 
	$__bsw­_32
 (
__bsx
)

47  
	`__butš_bsw­32
 (
__bsx
);

48 
	}
}

49 #–ià
__GNUC__
 >= 2

50 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

51 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

52 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

53 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

54 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

55 || 
defšed
 
	g__amdçm10__
)

58 
	#__bsw­_32
(
x
) \

59 (
__ex‹nsiÚ__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

62 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

64 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw­_32
(
x
) \

68 (
__ex‹nsiÚ__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

71 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "ô" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw­_32
(
x
) \

83 (
__ex‹nsiÚ__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

87 
__šlše
 

88 
	$__bsw­_32
 (
__bsx
)

90  
	`__bsw­_cÚ¡ªt_32
 (
__bsx
);

91 
	}
}

95 #ià
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw­_cÚ¡ªt_64
(
x
) \

98 (
	`__ex‹nsiÚ__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
è& 0x00000000000000ffuÎè<< 56)))

	)

107 #ià
__GNUC_PREREQ
 (4, 3)

108 
__šlše
 
__ušt64_t


109 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

111  
	`__butš_bsw­64
 (
__bsx
);

112 
	}
}

113 #–ià
__WORDSIZE
 == 64

114 
	#__bsw­_64
(
x
) \

115 (
__ex‹nsiÚ__
 \

116 ({ 
__ušt64_t
 
__v
, 
__x
 = (
x
); \

117 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

118 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

120 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw­_64
(
x
) \

124 (
__ex‹nsiÚ__
 \

125 ({ uniÚ { 
__ex‹nsiÚ__
 
__ušt64_t
 
__Î
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

128 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

131 
__w
.
__Î
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

135 
__r
.
__Î
; }))

	)

138 
	#__bsw­_cÚ¡ªt_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

148 
__šlše
 
__ušt64_t


149 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

151  
	`__bsw­_cÚ¡ªt_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/confname.h

19 #iâdeà
_UNISTD_H


26 
	m_PC_LINK_MAX
,

27 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

28 
	m_PC_MAX_CANON
,

29 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

30 
	m_PC_MAX_INPUT
,

31 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

32 
	m_PC_NAME_MAX
,

33 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

34 
	m_PC_PATH_MAX
,

35 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

36 
	m_PC_PIPE_BUF
,

37 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

38 
	m_PC_CHOWN_RESTRICTED
,

39 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

40 
	m_PC_NO_TRUNC
,

41 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

42 
	m_PC_VDISABLE
,

43 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

44 
	m_PC_SYNC_IO
,

45 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

46 
	m_PC_ASYNC_IO
,

47 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

48 
	m_PC_PRIO_IO
,

49 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

50 
	m_PC_SOCK_MAXBUF
,

51 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

52 
	m_PC_FILESIZEBITS
,

53 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

54 
	m_PC_REC_INCR_XFER_SIZE
,

55 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

56 
	m_PC_REC_MAX_XFER_SIZE
,

57 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

58 
	m_PC_REC_MIN_XFER_SIZE
,

59 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

60 
	m_PC_REC_XFER_ALIGN
,

61 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

62 
	m_PC_ALLOC_SIZE_MIN
,

63 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

64 
	m_PC_SYMLINK_MAX
,

65 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

66 
	m_PC_2_SYMLINKS


67 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

73 
	m_SC_ARG_MAX
,

74 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

75 
	m_SC_CHILD_MAX
,

76 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

77 
	m_SC_CLK_TCK
,

78 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

79 
	m_SC_NGROUPS_MAX
,

80 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

81 
	m_SC_OPEN_MAX
,

82 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

83 
	m_SC_STREAM_MAX
,

84 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

85 
	m_SC_TZNAME_MAX
,

86 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

87 
	m_SC_JOB_CONTROL
,

88 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

89 
	m_SC_SAVED_IDS
,

90 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

91 
	m_SC_REALTIME_SIGNALS
,

92 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

93 
	m_SC_PRIORITY_SCHEDULING
,

94 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

95 
	m_SC_TIMERS
,

96 
	#_SC_TIMERS
 
_SC_TIMERS


	)

97 
	m_SC_ASYNCHRONOUS_IO
,

98 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

99 
	m_SC_PRIORITIZED_IO
,

100 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

101 
	m_SC_SYNCHRONIZED_IO
,

102 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

103 
	m_SC_FSYNC
,

104 
	#_SC_FSYNC
 
_SC_FSYNC


	)

105 
	m_SC_MAPPED_FILES
,

106 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

107 
	m_SC_MEMLOCK
,

108 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

109 
	m_SC_MEMLOCK_RANGE
,

110 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

111 
	m_SC_MEMORY_PROTECTION
,

112 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

113 
	m_SC_MESSAGE_PASSING
,

114 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

115 
	m_SC_SEMAPHORES
,

116 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

117 
	m_SC_SHARED_MEMORY_OBJECTS
,

118 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

119 
	m_SC_AIO_LISTIO_MAX
,

120 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

121 
	m_SC_AIO_MAX
,

122 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

123 
	m_SC_AIO_PRIO_DELTA_MAX
,

124 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

125 
	m_SC_DELAYTIMER_MAX
,

126 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

127 
	m_SC_MQ_OPEN_MAX
,

128 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

129 
	m_SC_MQ_PRIO_MAX
,

130 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

131 
	m_SC_VERSION
,

132 
	#_SC_VERSION
 
_SC_VERSION


	)

133 
	m_SC_PAGESIZE
,

134 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

135 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

136 
	m_SC_RTSIG_MAX
,

137 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

138 
	m_SC_SEM_NSEMS_MAX
,

139 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

140 
	m_SC_SEM_VALUE_MAX
,

141 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

142 
	m_SC_SIGQUEUE_MAX
,

143 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

144 
	m_SC_TIMER_MAX
,

145 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

149 
	m_SC_BC_BASE_MAX
,

150 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

151 
	m_SC_BC_DIM_MAX
,

152 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

153 
	m_SC_BC_SCALE_MAX
,

154 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

155 
	m_SC_BC_STRING_MAX
,

156 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

157 
	m_SC_COLL_WEIGHTS_MAX
,

158 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

159 
	m_SC_EQUIV_CLASS_MAX
,

160 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

161 
	m_SC_EXPR_NEST_MAX
,

162 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

163 
	m_SC_LINE_MAX
,

164 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

165 
	m_SC_RE_DUP_MAX
,

166 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

167 
	m_SC_CHARCLASS_NAME_MAX
,

168 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

170 
	m_SC_2_VERSION
,

171 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

172 
	m_SC_2_C_BIND
,

173 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

174 
	m_SC_2_C_DEV
,

175 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

176 
	m_SC_2_FORT_DEV
,

177 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

178 
	m_SC_2_FORT_RUN
,

179 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

180 
	m_SC_2_SW_DEV
,

181 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

182 
	m_SC_2_LOCALEDEF
,

183 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

185 
	m_SC_PII
,

186 
	#_SC_PII
 
_SC_PII


	)

187 
	m_SC_PII_XTI
,

188 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

189 
	m_SC_PII_SOCKET
,

190 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

191 
	m_SC_PII_INTERNET
,

192 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

193 
	m_SC_PII_OSI
,

194 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

195 
	m_SC_POLL
,

196 
	#_SC_POLL
 
_SC_POLL


	)

197 
	m_SC_SELECT
,

198 
	#_SC_SELECT
 
_SC_SELECT


	)

199 
	m_SC_UIO_MAXIOV
,

200 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

201 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

202 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

203 
	m_SC_PII_INTERNET_STREAM
,

204 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

205 
	m_SC_PII_INTERNET_DGRAM
,

206 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

207 
	m_SC_PII_OSI_COTS
,

208 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

209 
	m_SC_PII_OSI_CLTS
,

210 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

211 
	m_SC_PII_OSI_M
,

212 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

213 
	m_SC_T_IOV_MAX
,

214 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

217 
	m_SC_THREADS
,

218 
	#_SC_THREADS
 
_SC_THREADS


	)

219 
	m_SC_THREAD_SAFE_FUNCTIONS
,

220 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

221 
	m_SC_GETGR_R_SIZE_MAX
,

222 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

223 
	m_SC_GETPW_R_SIZE_MAX
,

224 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

225 
	m_SC_LOGIN_NAME_MAX
,

226 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

227 
	m_SC_TTY_NAME_MAX
,

228 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

229 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

230 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

231 
	m_SC_THREAD_KEYS_MAX
,

232 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

233 
	m_SC_THREAD_STACK_MIN
,

234 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

235 
	m_SC_THREAD_THREADS_MAX
,

236 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

237 
	m_SC_THREAD_ATTR_STACKADDR
,

238 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

239 
	m_SC_THREAD_ATTR_STACKSIZE
,

240 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

241 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

242 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

243 
	m_SC_THREAD_PRIO_INHERIT
,

244 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

245 
	m_SC_THREAD_PRIO_PROTECT
,

246 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

247 
	m_SC_THREAD_PROCESS_SHARED
,

248 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

250 
	m_SC_NPROCESSORS_CONF
,

251 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

252 
	m_SC_NPROCESSORS_ONLN
,

253 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

254 
	m_SC_PHYS_PAGES
,

255 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

256 
	m_SC_AVPHYS_PAGES
,

257 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

258 
	m_SC_ATEXIT_MAX
,

259 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

260 
	m_SC_PASS_MAX
,

261 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

263 
	m_SC_XOPEN_VERSION
,

264 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

265 
	m_SC_XOPEN_XCU_VERSION
,

266 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

267 
	m_SC_XOPEN_UNIX
,

268 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

269 
	m_SC_XOPEN_CRYPT
,

270 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

271 
	m_SC_XOPEN_ENH_I18N
,

272 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

273 
	m_SC_XOPEN_SHM
,

274 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

276 
	m_SC_2_CHAR_TERM
,

277 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

278 
	m_SC_2_C_VERSION
,

279 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

280 
	m_SC_2_UPE
,

281 
	#_SC_2_UPE
 
_SC_2_UPE


	)

283 
	m_SC_XOPEN_XPG2
,

284 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

285 
	m_SC_XOPEN_XPG3
,

286 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

287 
	m_SC_XOPEN_XPG4
,

288 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

290 
	m_SC_CHAR_BIT
,

291 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

292 
	m_SC_CHAR_MAX
,

293 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

294 
	m_SC_CHAR_MIN
,

295 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

296 
	m_SC_INT_MAX
,

297 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

298 
	m_SC_INT_MIN
,

299 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

300 
	m_SC_LONG_BIT
,

301 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

302 
	m_SC_WORD_BIT
,

303 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

304 
	m_SC_MB_LEN_MAX
,

305 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

306 
	m_SC_NZERO
,

307 
	#_SC_NZERO
 
_SC_NZERO


	)

308 
	m_SC_SSIZE_MAX
,

309 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

310 
	m_SC_SCHAR_MAX
,

311 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

312 
	m_SC_SCHAR_MIN
,

313 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

314 
	m_SC_SHRT_MAX
,

315 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

316 
	m_SC_SHRT_MIN
,

317 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

318 
	m_SC_UCHAR_MAX
,

319 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

320 
	m_SC_UINT_MAX
,

321 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

322 
	m_SC_ULONG_MAX
,

323 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

324 
	m_SC_USHRT_MAX
,

325 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

327 
	m_SC_NL_ARGMAX
,

328 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

329 
	m_SC_NL_LANGMAX
,

330 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

331 
	m_SC_NL_MSGMAX
,

332 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

333 
	m_SC_NL_NMAX
,

334 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

335 
	m_SC_NL_SETMAX
,

336 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

337 
	m_SC_NL_TEXTMAX
,

338 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

340 
	m_SC_XBS5_ILP32_OFF32
,

341 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

342 
	m_SC_XBS5_ILP32_OFFBIG
,

343 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

344 
	m_SC_XBS5_LP64_OFF64
,

345 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

346 
	m_SC_XBS5_LPBIG_OFFBIG
,

347 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

349 
	m_SC_XOPEN_LEGACY
,

350 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

351 
	m_SC_XOPEN_REALTIME
,

352 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

353 
	m_SC_XOPEN_REALTIME_THREADS
,

354 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

356 
	m_SC_ADVISORY_INFO
,

357 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

358 
	m_SC_BARRIERS
,

359 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

360 
	m_SC_BASE
,

361 
	#_SC_BASE
 
_SC_BASE


	)

362 
	m_SC_C_LANG_SUPPORT
,

363 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

364 
	m_SC_C_LANG_SUPPORT_R
,

365 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

366 
	m_SC_CLOCK_SELECTION
,

367 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

368 
	m_SC_CPUTIME
,

369 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

370 
	m_SC_THREAD_CPUTIME
,

371 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

372 
	m_SC_DEVICE_IO
,

373 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

374 
	m_SC_DEVICE_SPECIFIC
,

375 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

376 
	m_SC_DEVICE_SPECIFIC_R
,

377 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

378 
	m_SC_FD_MGMT
,

379 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

380 
	m_SC_FIFO
,

381 
	#_SC_FIFO
 
_SC_FIFO


	)

382 
	m_SC_PIPE
,

383 
	#_SC_PIPE
 
_SC_PIPE


	)

384 
	m_SC_FILE_ATTRIBUTES
,

385 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

386 
	m_SC_FILE_LOCKING
,

387 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

388 
	m_SC_FILE_SYSTEM
,

389 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

390 
	m_SC_MONOTONIC_CLOCK
,

391 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

392 
	m_SC_MULTI_PROCESS
,

393 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

394 
	m_SC_SINGLE_PROCESS
,

395 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

396 
	m_SC_NETWORKING
,

397 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

398 
	m_SC_READER_WRITER_LOCKS
,

399 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

400 
	m_SC_SPIN_LOCKS
,

401 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

402 
	m_SC_REGEXP
,

403 
	#_SC_REGEXP
 
_SC_REGEXP


	)

404 
	m_SC_REGEX_VERSION
,

405 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

406 
	m_SC_SHELL
,

407 
	#_SC_SHELL
 
_SC_SHELL


	)

408 
	m_SC_SIGNALS
,

409 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

410 
	m_SC_SPAWN
,

411 
	#_SC_SPAWN
 
_SC_SPAWN


	)

412 
	m_SC_SPORADIC_SERVER
,

413 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

414 
	m_SC_THREAD_SPORADIC_SERVER
,

415 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

416 
	m_SC_SYSTEM_DATABASE
,

417 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

418 
	m_SC_SYSTEM_DATABASE_R
,

419 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

420 
	m_SC_TIMEOUTS
,

421 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

422 
	m_SC_TYPED_MEMORY_OBJECTS
,

423 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

424 
	m_SC_USER_GROUPS
,

425 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

426 
	m_SC_USER_GROUPS_R
,

427 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

428 
	m_SC_2_PBS
,

429 
	#_SC_2_PBS
 
_SC_2_PBS


	)

430 
	m_SC_2_PBS_ACCOUNTING
,

431 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

432 
	m_SC_2_PBS_LOCATE
,

433 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

434 
	m_SC_2_PBS_MESSAGE
,

435 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

436 
	m_SC_2_PBS_TRACK
,

437 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

438 
	m_SC_SYMLOOP_MAX
,

439 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

440 
	m_SC_STREAMS
,

441 
	#_SC_STREAMS
 
_SC_STREAMS


	)

442 
	m_SC_2_PBS_CHECKPOINT
,

443 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

445 
	m_SC_V6_ILP32_OFF32
,

446 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

447 
	m_SC_V6_ILP32_OFFBIG
,

448 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

449 
	m_SC_V6_LP64_OFF64
,

450 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

451 
	m_SC_V6_LPBIG_OFFBIG
,

452 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

454 
	m_SC_HOST_NAME_MAX
,

455 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

456 
	m_SC_TRACE
,

457 
	#_SC_TRACE
 
_SC_TRACE


	)

458 
	m_SC_TRACE_EVENT_FILTER
,

459 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

460 
	m_SC_TRACE_INHERIT
,

461 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

462 
	m_SC_TRACE_LOG
,

463 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

465 
	m_SC_LEVEL1_ICACHE_SIZE
,

466 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

467 
	m_SC_LEVEL1_ICACHE_ASSOC
,

468 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

469 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

470 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

471 
	m_SC_LEVEL1_DCACHE_SIZE
,

472 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

473 
	m_SC_LEVEL1_DCACHE_ASSOC
,

474 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

475 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

476 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

477 
	m_SC_LEVEL2_CACHE_SIZE
,

478 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

479 
	m_SC_LEVEL2_CACHE_ASSOC
,

480 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

481 
	m_SC_LEVEL2_CACHE_LINESIZE
,

482 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

483 
	m_SC_LEVEL3_CACHE_SIZE
,

484 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

485 
	m_SC_LEVEL3_CACHE_ASSOC
,

486 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

487 
	m_SC_LEVEL3_CACHE_LINESIZE
,

488 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

489 
	m_SC_LEVEL4_CACHE_SIZE
,

490 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

491 
	m_SC_LEVEL4_CACHE_ASSOC
,

492 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

493 
	m_SC_LEVEL4_CACHE_LINESIZE
,

494 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

497 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

498 
	#_SC_IPV6
 
_SC_IPV6


	)

499 
	m_SC_RAW_SOCKETS
,

500 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

502 
	m_SC_V7_ILP32_OFF32
,

503 
	#_SC_V7_ILP32_OFF32
 
_SC_V7_ILP32_OFF32


	)

504 
	m_SC_V7_ILP32_OFFBIG
,

505 
	#_SC_V7_ILP32_OFFBIG
 
_SC_V7_ILP32_OFFBIG


	)

506 
	m_SC_V7_LP64_OFF64
,

507 
	#_SC_V7_LP64_OFF64
 
_SC_V7_LP64_OFF64


	)

508 
	m_SC_V7_LPBIG_OFFBIG
,

509 
	#_SC_V7_LPBIG_OFFBIG
 
_SC_V7_LPBIG_OFFBIG


	)

511 
	m_SC_SS_REPL_MAX
,

512 
	#_SC_SS_REPL_MAX
 
_SC_SS_REPL_MAX


	)

514 
	m_SC_TRACE_EVENT_NAME_MAX
,

515 
	#_SC_TRACE_EVENT_NAME_MAX
 
_SC_TRACE_EVENT_NAME_MAX


	)

516 
	m_SC_TRACE_NAME_MAX
,

517 
	#_SC_TRACE_NAME_MAX
 
_SC_TRACE_NAME_MAX


	)

518 
	m_SC_TRACE_SYS_MAX
,

519 
	#_SC_TRACE_SYS_MAX
 
_SC_TRACE_SYS_MAX


	)

520 
	m_SC_TRACE_USER_EVENT_MAX
,

521 
	#_SC_TRACE_USER_EVENT_MAX
 
_SC_TRACE_USER_EVENT_MAX


	)

523 
	m_SC_XOPEN_STREAMS
,

524 
	#_SC_XOPEN_STREAMS
 
_SC_XOPEN_STREAMS


	)

526 
	m_SC_THREAD_ROBUST_PRIO_INHERIT
,

527 
	#_SC_THREAD_ROBUST_PRIO_INHERIT
 
_SC_THREAD_ROBUST_PRIO_INHERIT


	)

528 
	m_SC_THREAD_ROBUST_PRIO_PROTECT


529 
	#_SC_THREAD_ROBUST_PRIO_PROTECT
 
_SC_THREAD_ROBUST_PRIO_PROTECT


	)

535 
	m_CS_PATH
,

536 
	#_CS_PATH
 
_CS_PATH


	)

538 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

539 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

540 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

542 
	m_CS_GNU_LIBC_VERSION
,

543 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

544 
	m_CS_GNU_LIBPTHREAD_VERSION
,

545 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

547 
	m_CS_V5_WIDTH_RESTRICTED_ENVS
,

548 
	#_CS_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

549 
	#_CS_POSIX_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

551 
	m_CS_V7_WIDTH_RESTRICTED_ENVS
,

552 
	#_CS_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

553 
	#_CS_POSIX_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

555 
	m_CS_LFS_CFLAGS
 = 1000,

556 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

557 
	m_CS_LFS_LDFLAGS
,

558 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

559 
	m_CS_LFS_LIBS
,

560 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

561 
	m_CS_LFS_LINTFLAGS
,

562 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

563 
	m_CS_LFS64_CFLAGS
,

564 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

565 
	m_CS_LFS64_LDFLAGS
,

566 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

567 
	m_CS_LFS64_LIBS
,

568 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

569 
	m_CS_LFS64_LINTFLAGS
,

570 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

572 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

573 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

574 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

575 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

576 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

577 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

578 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

579 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

580 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

581 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

582 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

583 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

584 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

585 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

586 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

587 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

588 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

589 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

590 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

591 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

592 
	m_CS_XBS5_LP64_OFF64_LIBS
,

593 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

594 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

595 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

596 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

597 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

598 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

599 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

600 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

601 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

602 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

603 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

605 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

606 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

607 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

608 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

609 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

610 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

611 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

612 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

613 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

614 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

615 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

616 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

617 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

618 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

619 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

620 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

621 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

622 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

623 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

624 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

625 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

626 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

627 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

628 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

629 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

630 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

631 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

632 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

633 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

634 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

635 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
,

636 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

638 
	m_CS_POSIX_V7_ILP32_OFF32_CFLAGS
,

639 
	#_CS_POSIX_V7_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_CFLAGS


	)

640 
	m_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
,

641 
	#_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LDFLAGS


	)

642 
	m_CS_POSIX_V7_ILP32_OFF32_LIBS
,

643 
	#_CS_POSIX_V7_ILP32_OFF32_LIBS
 
_CS_POSIX_V7_ILP32_OFF32_LIBS


	)

644 
	m_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
,

645 
	#_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS


	)

646 
	m_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
,

647 
	#_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS


	)

648 
	m_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
,

649 
	#_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS


	)

650 
	m_CS_POSIX_V7_ILP32_OFFBIG_LIBS
,

651 
	#_CS_POSIX_V7_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V7_ILP32_OFFBIG_LIBS


	)

652 
	m_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
,

653 
	#_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS


	)

654 
	m_CS_POSIX_V7_LP64_OFF64_CFLAGS
,

655 
	#_CS_POSIX_V7_LP64_OFF64_CFLAGS
 
_CS_POSIX_V7_LP64_OFF64_CFLAGS


	)

656 
	m_CS_POSIX_V7_LP64_OFF64_LDFLAGS
,

657 
	#_CS_POSIX_V7_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LDFLAGS


	)

658 
	m_CS_POSIX_V7_LP64_OFF64_LIBS
,

659 
	#_CS_POSIX_V7_LP64_OFF64_LIBS
 
_CS_POSIX_V7_LP64_OFF64_LIBS


	)

660 
	m_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
,

661 
	#_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LINTFLAGS


	)

662 
	m_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
,

663 
	#_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS


	)

664 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
,

665 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS


	)

666 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
,

667 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LIBS


	)

668 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
,

669 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


	)

671 
	m_CS_V6_ENV
,

672 
	#_CS_V6_ENV
 
_CS_V6_ENV


	)

673 
	m_CS_V7_ENV


674 
	#_CS_V7_ENV
 
_CS_V7_ENV


	)

	@/usr/include/bits/dirent.h

18 #iâdeà
_DIRENT_H


22 
	sdœ’t


24 #iâdeà
__USE_FILE_OFFSET64


25 
__šo_t
 
	md_šo
;

26 
__off_t
 
	md_off
;

28 
__šo64_t
 
	md_šo
;

29 
__off64_t
 
	md_off
;

31 
	md_»ş’
;

32 
	md_ty³
;

33 
	md_Çme
[256];

36 #ifdeà
__USE_LARGEFILE64


37 
	sdœ’t64


39 
__šo64_t
 
	md_šo
;

40 
__off64_t
 
	md_off
;

41 
	md_»ş’
;

42 
	md_ty³
;

43 
	md_Çme
[256];

47 
	#d_f’o
 
d_šo


	)

49 #undeà
_DIRENT_HAVE_D_NAMLEN


50 
	#_DIRENT_HAVE_D_RECLEN


	)

51 
	#_DIRENT_HAVE_D_OFF


	)

52 
	#_DIRENT_HAVE_D_TYPE


	)

54 #ià
defšed
 
__OFF_T_MATCHES_OFF64_T
 && defšed 
__INO_T_MATCHES_INO64_T


56 
	#_DIRENT_MATCHES_DIRENT64
 1

	)

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/environments.h

18 #iâdeà
_UNISTD_H


22 
	~<b™s/wÜdsize.h
>

42 #ià
__WORDSIZE
 == 64

56 
	#_POSIX_V7_LPBIG_OFFBIG
 -1

	)

57 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

58 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

61 
	#_POSIX_V7_LP64_OFF64
 1

	)

62 
	#_POSIX_V6_LP64_OFF64
 1

	)

63 
	#_XBS5_LP64_OFF64
 1

	)

69 
	#_POSIX_V7_ILP32_OFFBIG
 1

	)

70 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

71 
	#_XBS5_ILP32_OFFBIG
 1

	)

73 #iâdeà
__x86_64__


75 
	#_POSIX_V7_ILP32_OFF32
 1

	)

76 
	#_POSIX_V6_ILP32_OFF32
 1

	)

77 
	#_XBS5_ILP32_OFF32
 1

	)

95 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

96 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

97 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


98 
	#__ILP32_OFFBIG_CFLAGS
 "-mx32"

	)

99 
	#__ILP32_OFFBIG_LDFLAGS
 "-mx32"

	)

101 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

102 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

104 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

105 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/errno.h

19 #ifdeà
_ERRNO_H


21 #undeà
EDOM


22 #undeà
EILSEQ


23 #undeà
ERANGE


24 
	~<lšux/”ºo.h
>

27 
	#ENOTSUP
 
EOPNOTSUPP


	)

30 #iâdeà
ECANCELED


31 
	#ECANCELED
 125

	)

35 #iâdeà
EOWNERDEAD


36 
	#EOWNERDEAD
 130

	)

37 
	#ENOTRECOVERABLE
 131

	)

40 #iâdeà
ERFKILL


41 
	#ERFKILL
 132

	)

44 #iâdeà
EHWPOISON


45 
	#EHWPOISON
 133

	)

48 #iâdeà
__ASSEMBLER__


50 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

52 #ià!
defšed
 
_LIBC
 || defšed 
_LIBC_REENTRANT


54 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

59 #ià!
defšed
 
_ERRNO_H
 && defšed 
__Ãed_Em©h


63 
	#EDOM
 33

	)

64 
	#EILSEQ
 84

	)

65 
	#ERANGE
 34

	)

	@/usr/include/bits/fcntl.h

19 #iâdeà
_FCNTL_H


23 #ifdeà
__x86_64__


24 
	#__O_LARGEFILE
 0

	)

27 #ifdeà
__x86_64__


29 
	#F_GETLK64
 5

	)

30 
	#F_SETLK64
 6

	)

31 
	#F_SETLKW64
 7

	)

35 
	sæock


37 
	ml_ty³
;

38 
	ml_wh’û
;

39 #iâdeà
__USE_FILE_OFFSET64


40 
__off_t
 
	ml_¡¬t
;

41 
__off_t
 
	ml_Ën
;

43 
__off64_t
 
	ml_¡¬t
;

44 
__off64_t
 
	ml_Ën
;

46 
__pid_t
 
	ml_pid
;

49 #ifdeà
__USE_LARGEFILE64


50 
	sæock64


52 
	ml_ty³
;

53 
	ml_wh’û
;

54 
__off64_t
 
	ml_¡¬t
;

55 
__off64_t
 
	ml_Ën
;

56 
__pid_t
 
	ml_pid
;

61 
	~<b™s/fú-lšux.h
>

	@/usr/include/bits/fcntl2.h

19 #iâdef 
_FCNTL_H


25 #iâdeà
__USE_FILE_OFFSET64


26 
	$__İ’_2
 (cÚ¡ *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

27 
	`__REDIRECT
 (
__İ’_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
, ...),

28 
İ’
è
	`__nÚnuÎ
 ((1));

30 
	`__REDIRECT
 (
__İ’_2
, (cÚ¡ *
__·th
, 
__oæag
),

31 
__İ’64_2
è
	`__nÚnuÎ
 ((1));

32 
	`__REDIRECT
 (
__İ’_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
, ...),

33 
İ’64
è
	`__nÚnuÎ
 ((1));

35 
	`__”rÜdeş
 (
__İ’_too_mªy_¬gs
,

37 
	`__”rÜdeş
 (
__İ’_missšg_mode
,

40 
__fÜtify_funùiÚ
 

41 
	$İ’
 (cÚ¡ *
__·th
, 
__oæag
, ...)

43 ià(
	`__va_¬g_·ck_Ën
 () > 1)

44 
	`__İ’_too_mªy_¬gs
 ();

46 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

48 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

50 
	`__İ’_missšg_mode
 ();

51  
	`__İ’_2
 (
__·th
, 
__oæag
);

53  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

56 ià(
	`__va_¬g_·ck_Ën
 () < 1)

57  
	`__İ’_2
 (
__·th
, 
__oæag
);

59  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

60 
	}
}

63 #ifdeà
__USE_LARGEFILE64


64 
	$__İ’64_2
 (cÚ¡ *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

65 
	`__REDIRECT
 (
__İ’64_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
,

66 ...), 
İ’64
è
	`__nÚnuÎ
 ((1));

67 
	`__”rÜdeş
 (
__İ’64_too_mªy_¬gs
,

69 
	`__”rÜdeş
 (
__İ’64_missšg_mode
,

72 
__fÜtify_funùiÚ
 

73 
	$İ’64
 (cÚ¡ *
__·th
, 
__oæag
, ...)

75 ià(
	`__va_¬g_·ck_Ën
 () > 1)

76 
	`__İ’64_too_mªy_¬gs
 ();

78 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

80 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

82 
	`__İ’64_missšg_mode
 ();

83  
	`__İ’64_2
 (
__·th
, 
__oæag
);

85  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

88 ià(
	`__va_¬g_·ck_Ën
 () < 1)

89  
	`__İ’64_2
 (
__·th
, 
__oæag
);

91  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

92 
	}
}

96 #ifdeà
__USE_ATFILE


97 #iâdeà
__USE_FILE_OFFSET64


98 
	$__İ’©_2
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
)

99 
	`__nÚnuÎ
 ((2));

100 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

101 
__oæag
, ...), 
İ’©
)

102 
	`__nÚnuÎ
 ((2));

104 
	`__REDIRECT
 (
__İ’©_2
, (
__fd
, cÚ¡ *
__·th
,

105 
__oæag
), 
__İ’©64_2
)

106 
	`__nÚnuÎ
 ((2));

107 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

108 
__oæag
, ...), 
İ’©64
)

109 
	`__nÚnuÎ
 ((2));

111 
	`__”rÜdeş
 (
__İ’©_too_mªy_¬gs
,

113 
	`__”rÜdeş
 (
__İ’©_missšg_mode
,

116 
__fÜtify_funùiÚ
 

117 
	$İ’©
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
, ...)

119 ià(
	`__va_¬g_·ck_Ën
 () > 1)

120 
	`__İ’©_too_mªy_¬gs
 ();

122 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

124 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

126 
	`__İ’©_missšg_mode
 ();

127  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

129  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

132 ià(
	`__va_¬g_·ck_Ën
 () < 1)

133  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

135  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

136 
	}
}

139 #ifdeà
__USE_LARGEFILE64


140 
	$__İ’©64_2
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
)

141 
	`__nÚnuÎ
 ((2));

142 
	`__REDIRECT
 (
__İ’©64_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

143 
__oæag
, ...), 
İ’©64
)

144 
	`__nÚnuÎ
 ((2));

145 
	`__”rÜdeş
 (
__İ’©64_too_mªy_¬gs
,

147 
	`__”rÜdeş
 (
__İ’©64_missšg_mode
,

150 
__fÜtify_funùiÚ
 

151 
	$İ’©64
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
, ...)

153 ià(
	`__va_¬g_·ck_Ën
 () > 1)

154 
	`__İ’©64_too_mªy_¬gs
 ();

156 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

158 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

160 
	`__İ’©64_missšg_mode
 ();

161  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

163  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

166 ià(
	`__va_¬g_·ck_Ën
 () < 1)

167  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

169  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

170 
	}
}

	@/usr/include/bits/huge_val.h

20 #iâdeà
_MATH_H


26 #ià
__GNUC_PREREQ
(3,3)

27 
	#HUGE_VAL
 (
	`__butš_huge_v®
())

	)

28 #–ià
__GNUC_PREREQ
(2,96)

29 
	#HUGE_VAL
 (
__ex‹nsiÚ__
 0x1.0
p2047
)

	)

30 #–ià
defšed
 
__GNUC__


32 
	#HUGE_VAL
 \

33 (
__ex‹nsiÚ__
 \

34 ((uniÚ { 
__l
 
	`__©Œibu‹__
((
	`__mode__
(
__DI__
))); 
__d
; }) \

35 { 
__l
: 0x7ff0000000000000ULL }).
__d
)

	)

39 
	~<’dŸn.h
>

41 uniÚ { 
	m__c
[8]; 
	m__d
; } 
	t__huge_v®_t
;

43 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


44 
	#__HUGE_VAL_by‹s
 { 0x7f, 0xf0, 0, 0, 0, 0, 0, 0 }

	)

46 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


47 
	#__HUGE_VAL_by‹s
 { 0, 0, 0, 0, 0, 0, 0xf0, 0x7à}

	)

50 
__huge_v®_t
 
	g__huge_v®
 = { 
__HUGE_VAL_by‹s
 };

51 
	#HUGE_VAL
 (
__huge_v®
.
__d
)

	)

	@/usr/include/bits/huge_valf.h

20 #iâdeà
_MATH_H


26 #ià
__GNUC_PREREQ
(3,3)

27 
	#HUGE_VALF
 (
	`__butš_huge_v®f
())

	)

28 #–ià
__GNUC_PREREQ
(2,96)

29 
	#HUGE_VALF
 (
__ex‹nsiÚ__
 0x1.0
p255f
)

	)

30 #–ià
defšed
 
__GNUC__


32 
	#HUGE_VALF
 \

33 (
__ex‹nsiÚ__
 \

34 ((uniÚ { 
__l
 
	`__©Œibu‹__
((
	`__mode__
(
__SI__
))); 
__d
; }) \

35 { 
__l
: 0x7f800000UL }).
__d
)

	)

39 uniÚ { 
	m__c
[4]; 
	m__f
; } 
	t__huge_v®f_t
;

41 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


42 
	#__HUGE_VALF_by‹s
 { 0x7f, 0x80, 0, 0 }

	)

44 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


45 
	#__HUGE_VALF_by‹s
 { 0, 0, 0x80, 0x7à}

	)

48 
__huge_v®f_t
 
	g__huge_v®f
 = { 
__HUGE_VALF_by‹s
 };

49 
	#HUGE_VALF
 (
__huge_v®f
.
__f
)

	)

	@/usr/include/bits/huge_vall.h

20 #iâdeà
_MATH_H


24 #ià
__GNUC_PREREQ
(3,3)

25 
	#HUGE_VALL
 (
	`__butš_huge_v®l
())

	)

26 #–ià
__GNUC_PREREQ
(2,96)

27 
	#HUGE_VALL
 (
__ex‹nsiÚ__
 0x1.0
p32767L
)

	)

30 
	#__HUGE_VALL_by‹s
 { 0, 0, 0, 0, 0, 0, 0, 0x80, 0xff, 0x7f, 0, 0 }

	)

32 
	#__huge_v®l_t
 uniÚ { 
__c
[12]; 
__ld
; }

	)

33 #ifdeà
__GNUC__


34 
	#HUGE_VALL
 (
__ex‹nsiÚ__
 \

35 ((
__huge_v®l_t
è{ 
__c
: 
__HUGE_VALL_by‹s
 }).
__ld
)

	)

37 
__huge_v®l_t
 
	g__huge_v®l
 = { 
__HUGE_VALL_by‹s
 };

38 
	#HUGE_VALL
 (
__huge_v®l
.
__ld
)

	)

	@/usr/include/bits/in.h

20 #iâdeà
_NETINET_IN_H


29 #ifdeà
_UAPI_LINUX_IN6_H


33 
	#__USE_KERNEL_IPV6_DEFS


	)

39 
	#IP_OPTIONS
 4

	)

40 
	#IP_HDRINCL
 3

	)

41 
	#IP_TOS
 1

	)

42 
	#IP_TTL
 2

	)

43 
	#IP_RECVOPTS
 6

	)

45 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

46 
	#IP_RETOPTS
 7

	)

47 
	#IP_MULTICAST_IF
 32

	)

48 
	#IP_MULTICAST_TTL
 33

	)

49 
	#IP_MULTICAST_LOOP
 34

	)

50 
	#IP_ADD_MEMBERSHIP
 35

	)

51 
	#IP_DROP_MEMBERSHIP
 36

	)

52 
	#IP_UNBLOCK_SOURCE
 37

	)

53 
	#IP_BLOCK_SOURCE
 38

	)

54 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

55 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

56 
	#IP_MSFILTER
 41

	)

57 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


58 
	#MCAST_JOIN_GROUP
 42

	)

59 
	#MCAST_BLOCK_SOURCE
 43

	)

60 
	#MCAST_UNBLOCK_SOURCE
 44

	)

61 
	#MCAST_LEAVE_GROUP
 45

	)

62 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

63 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

64 
	#MCAST_MSFILTER
 48

	)

65 
	#IP_MULTICAST_ALL
 49

	)

66 
	#IP_UNICAST_IF
 50

	)

68 
	#MCAST_EXCLUDE
 0

	)

69 
	#MCAST_INCLUDE
 1

	)

72 
	#IP_ROUTER_ALERT
 5

	)

73 
	#IP_PKTINFO
 8

	)

74 
	#IP_PKTOPTIONS
 9

	)

75 
	#IP_PMTUDISC
 10

	)

76 
	#IP_MTU_DISCOVER
 10

	)

77 
	#IP_RECVERR
 11

	)

78 
	#IP_RECVTTL
 12

	)

79 
	#IP_RECVTOS
 13

	)

80 
	#IP_MTU
 14

	)

81 
	#IP_FREEBIND
 15

	)

82 
	#IP_IPSEC_POLICY
 16

	)

83 
	#IP_XFRM_POLICY
 17

	)

84 
	#IP_PASSSEC
 18

	)

85 
	#IP_TRANSPARENT
 19

	)

86 
	#IP_MULTICAST_ALL
 49

	)

89 
	#IP_ORIGDSTADDR
 20

	)

90 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

92 
	#IP_MINTTL
 21

	)

96 
	#IP_PMTUDISC_DONT
 0

	)

97 
	#IP_PMTUDISC_WANT
 1

	)

98 
	#IP_PMTUDISC_DO
 2

	)

99 
	#IP_PMTUDISC_PROBE
 3

	)

102 
	#SOL_IP
 0

	)

104 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

105 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

106 
	#IP_MAX_MEMBERSHIPS
 20

	)

108 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


112 
	s_İts


114 
š_addr
 
	m_d¡
;

115 
	m_İts
[40];

119 
	s_m»qn


121 
š_addr
 
	mimr_muÉŸddr
;

122 
š_addr
 
	mimr_add»ss
;

123 
	mimr_ifšdex
;

127 
	sš_pktšfo


129 
	mi_ifšdex
;

130 
š_addr
 
	mi_¥ec_d¡
;

131 
š_addr
 
	mi_addr
;

138 
	#IPV6_ADDRFORM
 1

	)

139 
	#IPV6_2292PKTINFO
 2

	)

140 
	#IPV6_2292HOPOPTS
 3

	)

141 
	#IPV6_2292DSTOPTS
 4

	)

142 
	#IPV6_2292RTHDR
 5

	)

143 
	#IPV6_2292PKTOPTIONS
 6

	)

144 
	#IPV6_CHECKSUM
 7

	)

145 
	#IPV6_2292HOPLIMIT
 8

	)

147 
	#SCM_SRCRT
 
IPV6_RXSRCRT


	)

149 
	#IPV6_NEXTHOP
 9

	)

150 
	#IPV6_AUTHHDR
 10

	)

151 
	#IPV6_UNICAST_HOPS
 16

	)

152 
	#IPV6_MULTICAST_IF
 17

	)

153 
	#IPV6_MULTICAST_HOPS
 18

	)

154 
	#IPV6_MULTICAST_LOOP
 19

	)

155 
	#IPV6_JOIN_GROUP
 20

	)

156 
	#IPV6_LEAVE_GROUP
 21

	)

157 
	#IPV6_ROUTER_ALERT
 22

	)

158 
	#IPV6_MTU_DISCOVER
 23

	)

159 
	#IPV6_MTU
 24

	)

160 
	#IPV6_RECVERR
 25

	)

161 
	#IPV6_V6ONLY
 26

	)

162 
	#IPV6_JOIN_ANYCAST
 27

	)

163 
	#IPV6_LEAVE_ANYCAST
 28

	)

164 
	#IPV6_IPSEC_POLICY
 34

	)

165 
	#IPV6_XFRM_POLICY
 35

	)

167 
	#IPV6_RECVPKTINFO
 49

	)

168 
	#IPV6_PKTINFO
 50

	)

169 
	#IPV6_RECVHOPLIMIT
 51

	)

170 
	#IPV6_HOPLIMIT
 52

	)

171 
	#IPV6_RECVHOPOPTS
 53

	)

172 
	#IPV6_HOPOPTS
 54

	)

173 
	#IPV6_RTHDRDSTOPTS
 55

	)

174 
	#IPV6_RECVRTHDR
 56

	)

175 
	#IPV6_RTHDR
 57

	)

176 
	#IPV6_RECVDSTOPTS
 58

	)

177 
	#IPV6_DSTOPTS
 59

	)

179 
	#IPV6_RECVTCLASS
 66

	)

180 
	#IPV6_TCLASS
 67

	)

183 
	#IPV6_ADD_MEMBERSHIP
 
IPV6_JOIN_GROUP


	)

184 
	#IPV6_DROP_MEMBERSHIP
 
IPV6_LEAVE_GROUP


	)

185 
	#IPV6_RXHOPOPTS
 
IPV6_HOPOPTS


	)

186 
	#IPV6_RXDSTOPTS
 
IPV6_DSTOPTS


	)

189 
	#IPV6_PMTUDISC_DONT
 0

	)

190 
	#IPV6_PMTUDISC_WANT
 1

	)

191 
	#IPV6_PMTUDISC_DO
 2

	)

192 
	#IPV6_PMTUDISC_PROBE
 3

	)

195 
	#SOL_IPV6
 41

	)

196 
	#SOL_ICMPV6
 58

	)

199 
	#IPV6_RTHDR_LOOSE
 0

	)

200 
	#IPV6_RTHDR_STRICT
 1

	)

202 
	#IPV6_RTHDR_TYPE_0
 0

	)

	@/usr/include/bits/inf.h

19 #iâdeà
_MATH_H


25 #ià
__GNUC_PREREQ
(3,3)

26 
	#INFINITY
 (
	`__butš_šff
())

	)

28 
	#INFINITY
 
HUGE_VALF


	)

	@/usr/include/bits/ioctl-types.h

19 #iâdeà
_SYS_IOCTL_H


24 
	~<asm/ioùls.h
>

27 
	swšsize


29 
	mws_row
;

30 
	mws_cŞ
;

31 
	mws_xpix–
;

32 
	mws_ypix–
;

35 
	#NCC
 8

	)

36 
	s‹rmio


38 
	mc_iæag
;

39 
	mc_oæag
;

40 
	mc_cæag
;

41 
	mc_læag
;

42 
	mc_lše
;

43 
	mc_cc
[
NCC
];

47 
	#TIOCM_LE
 0x001

	)

48 
	#TIOCM_DTR
 0x002

	)

49 
	#TIOCM_RTS
 0x004

	)

50 
	#TIOCM_ST
 0x008

	)

51 
	#TIOCM_SR
 0x010

	)

52 
	#TIOCM_CTS
 0x020

	)

53 
	#TIOCM_CAR
 0x040

	)

54 
	#TIOCM_RNG
 0x080

	)

55 
	#TIOCM_DSR
 0x100

	)

56 
	#TIOCM_CD
 
TIOCM_CAR


	)

57 
	#TIOCM_RI
 
TIOCM_RNG


	)

62 
	#N_TTY
 0

	)

63 
	#N_SLIP
 1

	)

64 
	#N_MOUSE
 2

	)

65 
	#N_PPP
 3

	)

66 
	#N_STRIP
 4

	)

67 
	#N_AX25
 5

	)

68 
	#N_X25
 6

	)

69 
	#N_6PACK
 7

	)

70 
	#N_MASC
 8

	)

71 
	#N_R3964
 9

	)

72 
	#N_PROFIBUS_FDL
 10

	)

73 
	#N_IRDA
 11

	)

74 
	#N_SMSBLOCK
 12

	)

75 
	#N_HDLC
 13

	)

76 
	#N_SYNC_PPP
 14

	)

77 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

18 #iâdeà
_SYS_IOCTL_H


23 
	~<asm/ioùls.h
>

26 
	#SIOCADDRT
 0x890B

	)

27 
	#SIOCDELRT
 0x890C

	)

28 
	#SIOCRTMSG
 0x890D

	)

31 
	#SIOCGIFNAME
 0x8910

	)

32 
	#SIOCSIFLINK
 0x8911

	)

33 
	#SIOCGIFCONF
 0x8912

	)

34 
	#SIOCGIFFLAGS
 0x8913

	)

35 
	#SIOCSIFFLAGS
 0x8914

	)

36 
	#SIOCGIFADDR
 0x8915

	)

37 
	#SIOCSIFADDR
 0x8916

	)

38 
	#SIOCGIFDSTADDR
 0x8917

	)

39 
	#SIOCSIFDSTADDR
 0x8918

	)

40 
	#SIOCGIFBRDADDR
 0x8919

	)

41 
	#SIOCSIFBRDADDR
 0x891¨

	)

42 
	#SIOCGIFNETMASK
 0x891b

	)

43 
	#SIOCSIFNETMASK
 0x891ø

	)

44 
	#SIOCGIFMETRIC
 0x891d

	)

45 
	#SIOCSIFMETRIC
 0x891

	)

46 
	#SIOCGIFMEM
 0x891à

	)

47 
	#SIOCSIFMEM
 0x8920

	)

48 
	#SIOCGIFMTU
 0x8921

	)

49 
	#SIOCSIFMTU
 0x8922

	)

50 
	#SIOCSIFNAME
 0x8923

	)

51 
	#SIOCSIFHWADDR
 0x8924

	)

52 
	#SIOCGIFENCAP
 0x8925

	)

53 
	#SIOCSIFENCAP
 0x8926

	)

54 
	#SIOCGIFHWADDR
 0x8927

	)

55 
	#SIOCGIFSLAVE
 0x8929

	)

56 
	#SIOCSIFSLAVE
 0x8930

	)

57 
	#SIOCADDMULTI
 0x8931

	)

58 
	#SIOCDELMULTI
 0x8932

	)

59 
	#SIOCGIFINDEX
 0x8933

	)

60 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

61 
	#SIOCSIFPFLAGS
 0x8934

	)

62 
	#SIOCGIFPFLAGS
 0x8935

	)

63 
	#SIOCDIFADDR
 0x8936

	)

64 
	#SIOCSIFHWBROADCAST
 0x8937

	)

65 
	#SIOCGIFCOUNT
 0x8938

	)

67 
	#SIOCGIFBR
 0x8940

	)

68 
	#SIOCSIFBR
 0x8941

	)

70 
	#SIOCGIFTXQLEN
 0x8942

	)

71 
	#SIOCSIFTXQLEN
 0x8943

	)

76 
	#SIOCDARP
 0x8953

	)

77 
	#SIOCGARP
 0x8954

	)

78 
	#SIOCSARP
 0x8955

	)

81 
	#SIOCDRARP
 0x8960

	)

82 
	#SIOCGRARP
 0x8961

	)

83 
	#SIOCSRARP
 0x8962

	)

87 
	#SIOCGIFMAP
 0x8970

	)

88 
	#SIOCSIFMAP
 0x8971

	)

92 
	#SIOCADDDLCI
 0x8980

	)

93 
	#SIOCDELDLCI
 0x8981

	)

102 
	#SIOCDEVPRIVATE
 0x89F0

	)

108 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/math-finite.h

19 #iâdeà
_MATH_H


24 
__REDIRECT_NTH
 (
acos
, (), 
__acos_fš™e
);

25 
__REDIRECT_NTH
 (
acosf
, (), 
__acosf_fš™e
);

26 #ifdeà
__MATH_DECLARE_LDOUBLE


27 #ifdeà
__NO_LONG_DOUBLE_MATH


28 
__REDIRECT_NTH
 (
aco¦
, (), 
__acos_fš™e
);

30 
__REDIRECT_NTH
 (
aco¦
, (), 
__aco¦_fš™e
);

34 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


36 
__REDIRECT_NTH
 (
acosh
, (), 
__acosh_fš™e
);

37 
__REDIRECT_NTH
 (
acoshf
, (), 
__acoshf_fš™e
);

38 #ifdeà
__MATH_DECLARE_LDOUBLE


39 #ifdeà
__NO_LONG_DOUBLE_MATH


40 
__REDIRECT_NTH
 (
acoshl
, (), 
__acosh_fš™e
);

42 
__REDIRECT_NTH
 (
acoshl
, (), 
__acoshl_fš™e
);

48 
__REDIRECT_NTH
 (
asš
, (), 
__asš_fš™e
);

49 
__REDIRECT_NTH
 (
asšf
, (), 
__asšf_fš™e
);

50 #ifdeà
__MATH_DECLARE_LDOUBLE


51 #ifdeà
__NO_LONG_DOUBLE_MATH


52 
__REDIRECT_NTH
 (
asšl
, (), 
__asš_fš™e
);

54 
__REDIRECT_NTH
 (
asšl
, (), 
__asšl_fš™e
);

59 
__REDIRECT_NTH
 (
©ª2
, (, ), 
__©ª2_fš™e
);

60 
__REDIRECT_NTH
 (
©ª2f
, (, ), 
__©ª2f_fš™e
);

61 #ifdeà
__MATH_DECLARE_LDOUBLE


62 #ifdeà
__NO_LONG_DOUBLE_MATH


63 
__REDIRECT_NTH
 (
©ª2l
, (, ),

64 
__©ª2_fš™e
);

66 
__REDIRECT_NTH
 (
©ª2l
, (, ),

67 
__©ª2l_fš™e
);

71 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


73 
__REDIRECT_NTH
 (
©ªh
, (), 
__©ªh_fš™e
);

74 
__REDIRECT_NTH
 (
©ªhf
, (), 
__©ªhf_fš™e
);

75 #ifdeà
__MATH_DECLARE_LDOUBLE


76 #ifdeà
__NO_LONG_DOUBLE_MATH


77 
__REDIRECT_NTH
 (
©ªhl
, (), 
__©ªh_fš™e
);

79 
__REDIRECT_NTH
 (
©ªhl
, (), 
__©ªhl_fš™e
);

85 
__REDIRECT_NTH
 (
cosh
, (), 
__cosh_fš™e
);

86 
__REDIRECT_NTH
 (
coshf
, (), 
__coshf_fš™e
);

87 #ifdeà
__MATH_DECLARE_LDOUBLE


88 #ifdeà
__NO_LONG_DOUBLE_MATH


89 
__REDIRECT_NTH
 (
coshl
, (), 
__cosh_fš™e
);

91 
__REDIRECT_NTH
 (
coshl
, (), 
__coshl_fš™e
);

96 
__REDIRECT_NTH
 (
exp
, (), 
__exp_fš™e
);

97 
__REDIRECT_NTH
 (
expf
, (), 
__expf_fš™e
);

98 #ifdeà
__MATH_DECLARE_LDOUBLE


99 #ifdeà
__NO_LONG_DOUBLE_MATH


100 
__REDIRECT_NTH
 (
ex¶
, (), 
__exp_fš™e
);

102 
__REDIRECT_NTH
 (
ex¶
, (), 
__ex¶_fš™e
);

106 #ifdeà
__USE_GNU


108 
__REDIRECT_NTH
 (
exp10
, (), 
__exp10_fš™e
);

109 
__REDIRECT_NTH
 (
exp10f
, (), 
__exp10f_fš™e
);

110 #ifdeà
__MATH_DECLARE_LDOUBLE


111 #ifdeà
__NO_LONG_DOUBLE_MATH


112 
__REDIRECT_NTH
 (
exp10l
, (), 
__exp10_fš™e
);

114 
__REDIRECT_NTH
 (
exp10l
, (), 
__exp10l_fš™e
);

119 
__REDIRECT_NTH
 (
pow10
, (), 
__exp10_fš™e
);

120 
__REDIRECT_NTH
 (
pow10f
, (), 
__exp10f_fš™e
);

121 #ifdeà
__MATH_DECLARE_LDOUBLE


122 #ifdeà
__NO_LONG_DOUBLE_MATH


123 
__REDIRECT_NTH
 (
pow10l
, (), 
__exp10_fš™e
);

125 
__REDIRECT_NTH
 (
pow10l
, (), 
__exp10l_fš™e
);

130 #ifdeà
__USE_ISOC99


132 
__REDIRECT_NTH
 (
exp2
, (), 
__exp2_fš™e
);

133 
__REDIRECT_NTH
 (
exp2f
, (), 
__exp2f_fš™e
);

134 #ifdeà
__MATH_DECLARE_LDOUBLE


135 #ifdeà
__NO_LONG_DOUBLE_MATH


136 
__REDIRECT_NTH
 (
exp2l
, (), 
__exp2_fš™e
);

138 
__REDIRECT_NTH
 (
exp2l
, (), 
__exp2l_fš™e
);

144 
__REDIRECT_NTH
 (
fmod
, (, ), 
__fmod_fš™e
);

145 
__REDIRECT_NTH
 (
fmodf
, (, ), 
__fmodf_fš™e
);

146 #ifdeà
__MATH_DECLARE_LDOUBLE


147 #ifdeà
__NO_LONG_DOUBLE_MATH


148 
__REDIRECT_NTH
 (
fmodl
, (, ),

149 
__fmod_fš™e
);

151 
__REDIRECT_NTH
 (
fmodl
, (, ),

152 
__fmodl_fš™e
);

156 #ifdeà
__USE_ISOC99


158 
__REDIRECT_NTH
 (
hypÙ
, (, ), 
__hypÙ_fš™e
);

159 
__REDIRECT_NTH
 (
hypÙf
, (, ), 
__hypÙf_fš™e
);

160 #ifdeà
__MATH_DECLARE_LDOUBLE


161 #ifdeà
__NO_LONG_DOUBLE_MATH


162 
__REDIRECT_NTH
 (
hypÙl
, (, ),

163 
__hypÙ_fš™e
);

165 
__REDIRECT_NTH
 (
hypÙl
, (, ),

166 
__hypÙl_fš™e
);

171 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


173 
__REDIRECT_NTH
 (
j0
, (), 
__j0_fš™e
);

174 
__REDIRECT_NTH
 (
j0f
, (), 
__j0f_fš™e
);

175 #ifdeà
__MATH_DECLARE_LDOUBLE


176 #ifdeà
__NO_LONG_DOUBLE_MATH


177 
__REDIRECT_NTH
 (
j0l
, (), 
__j0_fš™e
);

179 
__REDIRECT_NTH
 (
j0l
, (), 
__j0l_fš™e
);

184 
__REDIRECT_NTH
 (
y0
, (), 
__y0_fš™e
);

185 
__REDIRECT_NTH
 (
y0f
, (), 
__y0f_fš™e
);

186 #ifdeà
__MATH_DECLARE_LDOUBLE


187 #ifdeà
__NO_LONG_DOUBLE_MATH


188 
__REDIRECT_NTH
 (
y0l
, (), 
__y0_fš™e
);

190 
__REDIRECT_NTH
 (
y0l
, (), 
__y0l_fš™e
);

195 
__REDIRECT_NTH
 (
j1
, (), 
__j1_fš™e
);

196 
__REDIRECT_NTH
 (
j1f
, (), 
__j1f_fš™e
);

197 #ifdeà
__MATH_DECLARE_LDOUBLE


198 #ifdeà
__NO_LONG_DOUBLE_MATH


199 
__REDIRECT_NTH
 (
j1l
, (), 
__j1_fš™e
);

201 
__REDIRECT_NTH
 (
j1l
, (), 
__j1l_fš™e
);

206 
__REDIRECT_NTH
 (
y1
, (), 
__y1_fš™e
);

207 
__REDIRECT_NTH
 (
y1f
, (), 
__y1f_fš™e
);

208 #ifdeà
__MATH_DECLARE_LDOUBLE


209 #ifdeà
__NO_LONG_DOUBLE_MATH


210 
__REDIRECT_NTH
 (
y1l
, (), 
__y1_fš™e
);

212 
__REDIRECT_NTH
 (
y1l
, (), 
__y1l_fš™e
);

217 
__REDIRECT_NTH
 (
jn
, (, ), 
__jn_fš™e
);

218 
__REDIRECT_NTH
 (
jnf
, (, ), 
__jnf_fš™e
);

219 #ifdeà
__MATH_DECLARE_LDOUBLE


220 #ifdeà
__NO_LONG_DOUBLE_MATH


221 
__REDIRECT_NTH
 (
jÆ
, (, ), 
__jn_fš™e
);

223 
__REDIRECT_NTH
 (
jÆ
, (, ), 
__jÆ_fš™e
);

228 
__REDIRECT_NTH
 (
yn
, (, ), 
__yn_fš™e
);

229 
__REDIRECT_NTH
 (
ynf
, (, ), 
__ynf_fš™e
);

230 #ifdeà
__MATH_DECLARE_LDOUBLE


231 #ifdeà
__NO_LONG_DOUBLE_MATH


232 
__REDIRECT_NTH
 (
yÆ
, (, ), 
__yn_fš™e
);

234 
__REDIRECT_NTH
 (
yÆ
, (, ), 
__yÆ_fš™e
);

239 #ifdeà
__USE_MISC


241 
__REDIRECT_NTH
 (
lgamma_r
, (, *), 
__lgamma_r_fš™e
);

242 
__REDIRECT_NTH
 (
lgammaf_r
, (, *), 
__lgammaf_r_fš™e
);

243 #ifdeà
__MATH_DECLARE_LDOUBLE


244 #ifdeà
__NO_LONG_DOUBLE_MATH


245 
__REDIRECT_NTH
 (
lgamm®_r
, (, *),

246 
__lgamma_r_fš™e
);

248 
__REDIRECT_NTH
 (
lgamm®_r
, (, *),

249 
__lgamm®_r_fš™e
);

254 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || defšed 
__USE_ISOC99


256 
__ex‹º_®ways_šlše
 
__NTH
 (
	$lgamma
 (
__d
))

258 #ifdeà
__USE_ISOC99


259 
__loÿl_signgam
 = 0;

260  
	`lgamma_r
 (
__d
, &
__loÿl_signgam
);

262  
	`lgamma_r
 (
__d
, &
signgam
);

264 
	}
}

265 
__ex‹º_®ways_šlše
 
__NTH
 (
	$lgammaf
 (
__d
))

267 #ifdeà
__USE_ISOC99


268 
__loÿl_signgam
 = 0;

269  
	`lgammaf_r
 (
__d
, &
__loÿl_signgam
);

271  
	`lgammaf_r
 (
__d
, &
signgam
);

273 
	}
}

274 #ifdeà
__MATH_DECLARE_LDOUBLE


275 
__ex‹º_®ways_šlše
 
__NTH
 (
	$lgamm®
 (
__d
))

277 #ifdeà
__USE_ISOC99


278 
__loÿl_signgam
 = 0;

279  
	`lgamm®_r
 (
__d
, &
__loÿl_signgam
);

281  
	`lgamm®_r
 (
__d
, &
signgam
);

283 
	}
}

287 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


289 
__ex‹º_®ways_šlše
 
__NTH
 (
	$gamma
 (
__d
))

291 #ifdeà
__USE_ISOC99


292 
__loÿl_signgam
 = 0;

293  
	`lgamma_r
 (
__d
, &
__loÿl_signgam
);

295  
	`lgamma_r
 (
__d
, &
signgam
);

297 
	}
}

298 
__ex‹º_®ways_šlše
 
__NTH
 (
	$gammaf
 (
__d
))

300 #ifdeà
__USE_ISOC99


301 
__loÿl_signgam
 = 0;

302  
	`lgammaf_r
 (
__d
, &
__loÿl_signgam
);

304  
	`lgammaf_r
 (
__d
, &
signgam
);

306 
	}
}

307 #ifdeà
__MATH_DECLARE_LDOUBLE


308 
__ex‹º_®ways_šlše
 
__NTH
 (
	$gamm®
 (
__d
))

310 #ifdeà
__USE_ISOC99


311 
__loÿl_signgam
 = 0;

312  
	`lgamm®_r
 (
__d
, &
__loÿl_signgam
);

314  
	`lgamm®_r
 (
__d
, &
signgam
);

316 
	}
}

321 
__REDIRECT_NTH
 (
log
, (), 
__log_fš™e
);

322 
__REDIRECT_NTH
 (
logf
, (), 
__logf_fš™e
);

323 #ifdeà
__MATH_DECLARE_LDOUBLE


324 #ifdeà
__NO_LONG_DOUBLE_MATH


325 
__REDIRECT_NTH
 (
logl
, (), 
__log_fš™e
);

327 
__REDIRECT_NTH
 (
logl
, (), 
__logl_fš™e
);

332 
__REDIRECT_NTH
 (
log10
, (), 
__log10_fš™e
);

333 
__REDIRECT_NTH
 (
log10f
, (), 
__log10f_fš™e
);

334 #ifdeà
__MATH_DECLARE_LDOUBLE


335 #ifdeà
__NO_LONG_DOUBLE_MATH


336 
__REDIRECT_NTH
 (
log10l
, (), 
__log10_fš™e
);

338 
__REDIRECT_NTH
 (
log10l
, (), 
__log10l_fš™e
);

342 #ifdeà
__USE_ISOC99


344 
__REDIRECT_NTH
 (
log2
, (), 
__log2_fš™e
);

345 
__REDIRECT_NTH
 (
log2f
, (), 
__log2f_fš™e
);

346 #ifdeà
__MATH_DECLARE_LDOUBLE


347 #ifdeà
__NO_LONG_DOUBLE_MATH


348 
__REDIRECT_NTH
 (
log2l
, (), 
__log2_fš™e
);

350 
__REDIRECT_NTH
 (
log2l
, (), 
__log2l_fš™e
);

356 
__REDIRECT_NTH
 (
ldexp
, (, ), 
sÿlbn
);

357 
__REDIRECT_NTH
 (
ldexpf
, (, ), 
sÿlbnf
);

358 #ifdeà
__MATH_DECLARE_LDOUBLE


359 
__REDIRECT_NTH
 (
ldex¶
, (, ), 
sÿlbÆ
);

363 
__REDIRECT_NTH
 (
pow
, (, ), 
__pow_fš™e
);

364 
__REDIRECT_NTH
 (
powf
, (, ), 
__powf_fš™e
);

365 #ifdeà
__MATH_DECLARE_LDOUBLE


366 #ifdeà
__NO_LONG_DOUBLE_MATH


367 
__REDIRECT_NTH
 (
powl
, (, ),

368 
__pow_fš™e
);

370 
__REDIRECT_NTH
 (
powl
, (, ),

371 
__powl_fš™e
);

376 
__REDIRECT_NTH
 (
»mašd”
, (, ), 
__»mašd”_fš™e
);

377 
__REDIRECT_NTH
 (
»mašd”f
, (, ), 
__»mašd”f_fš™e
);

378 #ifdeà
__MATH_DECLARE_LDOUBLE


379 #ifdeà
__NO_LONG_DOUBLE_MATH


380 
__REDIRECT_NTH
 (
»mašd”l
, (, ),

381 
__»mašd”_fš™e
);

383 
__REDIRECT_NTH
 (
»mašd”l
, (, ),

384 
__»mašd”l_fš™e
);

388 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


390 
__REDIRECT_NTH
 (
sÿlb
, (, ), 
__sÿlb_fš™e
);

391 
__REDIRECT_NTH
 (
sÿlbf
, (, ), 
__sÿlbf_fš™e
);

392 #ifdeà
__MATH_DECLARE_LDOUBLE


393 #ifdeà
__NO_LONG_DOUBLE_MATH


394 
__REDIRECT_NTH
 (
sÿlbl
, (, ),

395 
__sÿlb_fš™e
);

397 
__REDIRECT_NTH
 (
sÿlbl
, (, ),

398 
__sÿlbl_fš™e
);

404 
__REDIRECT_NTH
 (
sšh
, (), 
__sšh_fš™e
);

405 
__REDIRECT_NTH
 (
sšhf
, (), 
__sšhf_fš™e
);

406 #ifdeà
__MATH_DECLARE_LDOUBLE


407 #ifdeà
__NO_LONG_DOUBLE_MATH


408 
__REDIRECT_NTH
 (
sšhl
, (), 
__sšh_fš™e
);

410 
__REDIRECT_NTH
 (
sšhl
, (), 
__sšhl_fš™e
);

415 
__REDIRECT_NTH
 (
sq¹
, (), 
__sq¹_fš™e
);

416 
__REDIRECT_NTH
 (
sq¹f
, (), 
__sq¹f_fš™e
);

417 #ifdeà
__MATH_DECLARE_LDOUBLE


418 #ifdeà
__NO_LONG_DOUBLE_MATH


419 
__REDIRECT_NTH
 (
sq¹l
, (), 
__sq¹_fš™e
);

421 
__REDIRECT_NTH
 (
sq¹l
, (), 
__sq¹l_fš™e
);

425 #ifdeà
__USE_ISOC99


427 
__gamma_r_fš™e
 (, *);

428 
__ex‹º_®ways_šlše
 
__NTH
 (
	$tgamma
 (
__d
))

430 
__loÿl_signgam
 = 0;

431 
__»s
 = 
	`__gamma_r_fš™e
 (
__d
, &
__loÿl_signgam
);

432  
__loÿl_signgam
 < 0 ? -
__»s
 : __res;

433 
	}
}

434 
__gammaf_r_fš™e
 (, *);

435 
__ex‹º_®ways_šlše
 
__NTH
 (
	$tgammaf
 (
__d
))

437 
__loÿl_signgam
 = 0;

438 
__»s
 = 
	`__gammaf_r_fš™e
 (
__d
, &
__loÿl_signgam
);

439  
__loÿl_signgam
 < 0 ? -
__»s
 : __res;

440 
	}
}

441 #ifdeà
__MATH_DECLARE_LDOUBLE


442 
__gamm®_r_fš™e
 (, *);

443 
__ex‹º_®ways_šlše
 
__NTH
 (
	$tgamm®
 (
__d
))

445 
__loÿl_signgam
 = 0;

446 #ifdeà
__NO_LONG_DOUBLE_MATH


447 
__»s
 = 
	`__gamma_r_fš™e
 (
__d
, &
__loÿl_signgam
);

449 
__»s
 = 
	`__gamm®_r_fš™e
 (
__d
, &
__loÿl_signgam
);

451  
__loÿl_signgam
 < 0 ? -
__»s
 : __res;

452 
	}
}

	@/usr/include/bits/mathcalls.h

45 #iâdeà
_MATH_H


52 
_MdoubË_BEGIN_NAMESPACE


54 
__MATHCALL
 (
acos
,, (
_MdoubË_
 
__x
));

56 
__MATHCALL
 (
asš
,, (
_MdoubË_
 
__x
));

58 
__MATHCALL
 (
©ª
,, (
_MdoubË_
 
__x
));

60 
__MATHCALL
 (
©ª2
,, (
_MdoubË_
 
__y
, _MdoubË_ 
__x
));

63 
__MATHCALL
 (
cos
,, (
_MdoubË_
 
__x
));

65 
__MATHCALL
 (
sš
,, (
_MdoubË_
 
__x
));

67 
__MATHCALL
 (
n
,, (
_MdoubË_
 
__x
));

72 
__MATHCALL
 (
cosh
,, (
_MdoubË_
 
__x
));

74 
__MATHCALL
 (
sšh
,, (
_MdoubË_
 
__x
));

76 
__MATHCALL
 (
nh
,, (
_MdoubË_
 
__x
));

77 
	g_MdoubË_END_NAMESPACE


79 #ifdeà
__USE_GNU


81 
__MATHDECL
 (,
sšcos
,,

82 (
_MdoubË_
 
__x
, _MdoubË_ *
__sšx
, _MdoubË_ *
__cosx
));

85 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


86 
__BEGIN_NAMESPACE_C99


88 
__MATHCALL
 (
acosh
,, (
_MdoubË_
 
__x
));

90 
__MATHCALL
 (
asšh
,, (
_MdoubË_
 
__x
));

92 
__MATHCALL
 (
©ªh
,, (
_MdoubË_
 
__x
));

93 
	g__END_NAMESPACE_C99


98 
_MdoubË_BEGIN_NAMESPACE


100 
__MATHCALL
 (
exp
,, (
_MdoubË_
 
__x
));

103 
__MATHCALL
 (
äexp
,, (
_MdoubË_
 
__x
, *
__expÚ’t
));

106 
__MATHCALL
 (
ldexp
,, (
_MdoubË_
 
__x
, 
__expÚ’t
));

109 
__MATHCALL
 (
log
,, (
_MdoubË_
 
__x
));

112 
__MATHCALL
 (
log10
,, (
_MdoubË_
 
__x
));

115 
__MATHCALL
 (
modf
,, (
_MdoubË_
 
__x
, _MdoubË_ *
__Œ
)è
__nÚnuÎ
 ((2));

116 
	g_MdoubË_END_NAMESPACE


118 #ifdeà
__USE_GNU


120 
__MATHCALL
 (
exp10
,, (
_MdoubË_
 
__x
));

122 
__MATHCALL
 (
pow10
,, (
_MdoubË_
 
__x
));

125 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
__MATHCALL
 (
expm1
,, (
_MdoubË_
 
__x
));

131 
__MATHCALL
 (
log1p
,, (
_MdoubË_
 
__x
));

134 
__MATHCALL
 (
logb
,, (
_MdoubË_
 
__x
));

135 
	g__END_NAMESPACE_C99


138 #ifdeà
__USE_ISOC99


139 
__BEGIN_NAMESPACE_C99


141 
__MATHCALL
 (
exp2
,, (
_MdoubË_
 
__x
));

144 
__MATHCALL
 (
log2
,, (
_MdoubË_
 
__x
));

145 
	g__END_NAMESPACE_C99


151 
_MdoubË_BEGIN_NAMESPACE


153 
__MATHCALL
 (
pow
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

156 
__MATHCALL
 (
sq¹
,, (
_MdoubË_
 
__x
));

157 
	g_MdoubË_END_NAMESPACE


159 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || defšed 
__USE_ISOC99


160 
__BEGIN_NAMESPACE_C99


162 
__MATHCALL
 (
hypÙ
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

163 
	g__END_NAMESPACE_C99


166 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


167 
__BEGIN_NAMESPACE_C99


169 
__MATHCALL
 (
cb¹
,, (
_MdoubË_
 
__x
));

170 
	g__END_NAMESPACE_C99


176 
_MdoubË_BEGIN_NAMESPACE


178 
__MATHCALLX
 (
û
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

181 
__MATHCALLX
 (
çbs
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

184 
__MATHCALLX
 (
æoÜ
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

187 
__MATHCALL
 (
fmod
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

192 
__MATHDECL_1
 (,
__isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

195 
__MATHDECL_1
 (,
__fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

196 
	g_MdoubË_END_NAMESPACE


198 #ifdeà
__USE_MISC


201 
__MATHDECL_1
 (,
isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

204 
__MATHDECL_1
 (,
fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

207 
__MATHCALL
 (
d»m
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

211 
__MATHCALL
 (
signifiÿnd
,, (
_MdoubË_
 
__x
));

214 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


215 
__BEGIN_NAMESPACE_C99


217 
__MATHCALLX
 (
cİysign
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

218 
	g__END_NAMESPACE_C99


221 #ifdeà
__USE_ISOC99


222 
__BEGIN_NAMESPACE_C99


224 
__MATHCALLX
 (
Çn
,, (cÚ¡ *
__gb
), (
__cÚ¡__
));

225 
	g__END_NAMESPACE_C99


230 
__MATHDECL_1
 (,
__i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

232 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


234 
__MATHDECL_1
 (,
i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

237 
__MATHCALL
 (
j0
,, (
_MdoubË_
));

238 
__MATHCALL
 (
j1
,, (
_MdoubË_
));

239 
__MATHCALL
 (
jn
,, (, 
_MdoubË_
));

240 
__MATHCALL
 (
y0
,, (
_MdoubË_
));

241 
__MATHCALL
 (
y1
,, (
_MdoubË_
));

242 
__MATHCALL
 (
yn
,, (, 
_MdoubË_
));

246 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || defšed 
__USE_ISOC99


247 
__BEGIN_NAMESPACE_C99


249 
__MATHCALL
 (
”f
,, (
_MdoubË_
));

250 
__MATHCALL
 (
”fc
,, (
_MdoubË_
));

251 
__MATHCALL
 (
lgamma
,, (
_MdoubË_
));

252 
	g__END_NAMESPACE_C99


255 #ifdeà
__USE_ISOC99


256 
__BEGIN_NAMESPACE_C99


258 
__MATHCALL
 (
tgamma
,, (
_MdoubË_
));

259 
	g__END_NAMESPACE_C99


262 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


264 
__MATHCALL
 (
gamma
,, (
_MdoubË_
));

267 #ifdeà
__USE_MISC


271 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubË_
, *
__signgamp
));

275 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


276 
__BEGIN_NAMESPACE_C99


279 
__MATHCALL
 (
ršt
,, (
_MdoubË_
 
__x
));

282 
__MATHCALLX
 (
Ãxá”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

283 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__LDBL_COMPAT


284 
__MATHCALLX
 (
Ãx‰ow¬d
,, (
_MdoubË_
 
__x
, 
__y
), (
__cÚ¡__
));

288 
__MATHCALL
 (
»mašd”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

290 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


292 
__MATHCALL
 (
sÿlbn
,, (
_MdoubË_
 
__x
, 
__n
));

296 
__MATHDECL
 (,
ogb
,, (
_MdoubË_
 
__x
));

299 #ifdeà
__USE_ISOC99


301 
__MATHCALL
 (
sÿlbÊ
,, (
_MdoubË_
 
__x
, 
__n
));

305 
__MATHCALL
 (
Ã¬byšt
,, (
_MdoubË_
 
__x
));

309 
__MATHCALLX
 (
round
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

313 
__MATHCALLX
 (
Œunc
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

318 
__MATHCALL
 (
»mquo
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, *
__quo
));

325 
__MATHDECL
 (,
Ìšt
,, (
_MdoubË_
 
__x
));

326 
__ex‹nsiÚ__


327 
__MATHDECL
 (,
Îršt
,, (
_MdoubË_
 
__x
));

331 
__MATHDECL
 (,
Ìound
,, (
_MdoubË_
 
__x
));

332 
__ex‹nsiÚ__


333 
__MATHDECL
 (,
Îround
,, (
_MdoubË_
 
__x
));

337 
__MATHCALL
 (
fdim
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

340 
__MATHCALLX
 (
fmax
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

343 
__MATHCALLX
 (
fmš
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

347 
__MATHDECL_1
 (, 
__åşassify
,, (
_MdoubË_
 
__v®ue
))

348 
__©Œibu‹__
 ((
__cÚ¡__
));

351 
__MATHDECL_1
 (, 
__signb™
,, (
_MdoubË_
 
__v®ue
))

352 
__©Œibu‹__
 ((
__cÚ¡__
));

356 
__MATHCALL
 (
fma
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, _MdoubË_ 
__z
));

359 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


360 
	g__END_NAMESPACE_C99


363 #ifdeà
__USE_GNU


365 
__MATHDECL_1
 (, 
__issigÇlšg
,, (
_MdoubË_
 
__v®ue
))

366 
__©Œibu‹__
 ((
__cÚ¡__
));

369 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


371 
__MATHCALL
 (
sÿlb
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__n
));

	@/usr/include/bits/mathdef.h

18 #ià!
defšed
 
_MATH_H
 && !defšed 
_COMPLEX_H


22 #ià
defšed
 
__USE_ISOC99
 && defšed 
_MATH_H
 && !defšed 
_MATH_H_MATHDEF


23 
	#_MATH_H_MATHDEF
 1

	)

25 #ià
defšed
 
__x86_64__
 || (defšed 
__FLT_EVAL_METHOD__
 && __FLT_EVAL_METHOD__ == 0)

28 
	tæßt_t
;

29 
	tdoubË_t
;

35 
	tæßt_t
;

37 
	tdoubË_t
;

42 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

43 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

47 #ià
__FP_FAST_FMA


48 
	#FP_FAST_FMA
 1

	)

51 #ià
__FP_FAST_FMAF


52 
	#FP_FAST_FMAF
 1

	)

55 #ià
__FP_FAST_FMAL


56 
	#FP_FAST_FMAL
 1

	)

	@/usr/include/bits/mathinline.h

19 #iâdeà
_MATH_H


23 #iâdeà
__ex‹º_®ways_šlše


24 
	#__MATH_INLINE
 
__šlše


	)

26 
	#__MATH_INLINE
 
__ex‹º_®ways_šlše


	)

30 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__
 && __GNUC__ >= 2

32 #ià!
__GNUC_PREREQ
 (2,97)

37 #undeà
isg»©”


38 #undeà
isg»©”equ®


39 #undeà
i¦ess


40 #undeà
i¦es£qu®


41 #undeà
i¦essg»©”


42 #undeà
isunÜd”ed


43 #ifdeà
__i686__


46 
	#isg»©”
(
x
, 
y
) \

47 ({ 
__»suÉ
; \

48 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

49 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st"); \

50 
__»suÉ
; })

	)

51 
	#isg»©”equ®
(
x
, 
y
) \

52 ({ 
__»suÉ
; \

53 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

54 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st"); \

55 
__»suÉ
; })

	)

57 
	#i¦ess
(
x
, 
y
) \

58 ({ 
__»suÉ
; \

59 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

60 : "÷" (
__»suÉ
è: "u" (
x
), "t" (
y
) : "cc", "st"); \

61 
__»suÉ
; })

	)

63 
	#i¦es£qu®
(
x
, 
y
) \

64 ({ 
__»suÉ
; \

65 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

66 : "÷" (
__»suÉ
è: "u" (
x
), "t" (
y
) : "cc", "st"); \

67 
__»suÉ
; })

	)

69 
	#i¦essg»©”
(
x
, 
y
) \

70 ({ 
__»suÉ
; \

71 
	`__asm__
 ("fucomip %%st(1), %%st; setne %%al" \

72 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st"); \

73 
__»suÉ
; })

	)

75 
	#isunÜd”ed
(
x
, 
y
) \

76 ({ 
__»suÉ
; \

77 
	`__asm__
 ("fucomip %%st(1), %%st; setp %%al" \

78 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st"); \

79 
__»suÉ
; })

	)

82 
	#isg»©”
(
x
, 
y
) \

83 ({ 
__»suÉ
; \

84 
	`__asm__
 ("fucompp; fnstsw;estb $0x45, %%ah; setz %%al" \

85 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

86 
__»suÉ
; })

	)

88 
	#isg»©”equ®
(
x
, 
y
) \

89 ({ 
__»suÉ
; \

90 
	`__asm__
 ("fucompp; fnstsw;estb $0x05, %%ah; setz %%al" \

91 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

92 
__»suÉ
; })

	)

94 
	#i¦ess
(
x
, 
y
) \

95 ({ 
__»suÉ
; \

96 
	`__asm__
 ("fucompp; fnstsw;estb $0x45, %%ah; setz %%al" \

97 : "÷" (
__»suÉ
è: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

98 
__»suÉ
; })

	)

100 
	#i¦es£qu®
(
x
, 
y
) \

101 ({ 
__»suÉ
; \

102 
	`__asm__
 ("fucompp; fnstsw;estb $0x05, %%ah; setz %%al" \

103 : "÷" (
__»suÉ
è: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

104 
__»suÉ
; })

	)

106 
	#i¦essg»©”
(
x
, 
y
) \

107 ({ 
__»suÉ
; \

108 
	`__asm__
 ("fucompp; fnstsw;estb $0x44, %%ah; setz %%al" \

109 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

110 
__»suÉ
; })

	)

112 
	#isunÜd”ed
(
x
, 
y
) \

113 ({ 
__»suÉ
; \

114 
	`__asm__
 ("fucompp; fnstsw; sahf; setp %%al" \

115 : "÷" (
__»suÉ
è: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

116 
__»suÉ
; })

	)

122 #ià
__GNUC_PREREQ
 (2, 8)

123 
__BEGIN_NAMESPACE_C99


126 
__MATH_INLINE
 

127 
__NTH
 (
	$__signb™f
 (
__x
))

129 #ifdeà
__SSE2_MATH__


130 
__m
;

131 
	`__asm
 ("pmovmskb %1, %0" : "ô" (
__m
è: "x" (
__x
));

132  (
__m
 & 0x8) != 0;

134 
__ex‹nsiÚ__
 uniÚ { 
__f
; 
__i
; } 
__u
 = { __f: 
__x
 };

135  
__u
.
__i
 < 0;

137 
	}
}

138 
__MATH_INLINE
 

139 
__NTH
 (
	$__signb™
 (
__x
))

141 #ifdeà
__SSE2_MATH__


142 
__m
;

143 
	`__asm
 ("pmovmskb %1, %0" : "ô" (
__m
è: "x" (
__x
));

144  (
__m
 & 0x80) != 0;

146 
__ex‹nsiÚ__
 uniÚ { 
__d
; 
__i
[2]; } 
__u
 = { __d: 
__x
 };

147  
__u
.
__i
[1] < 0;

149 
	}
}

150 
__MATH_INLINE
 

151 
__NTH
 (
	$__signb™l
 (
__x
))

153 
__ex‹nsiÚ__
 uniÚ { 
__l
; 
__i
[3]; } 
__u
 = { __l: 
__x
 };

154  (
__u
.
__i
[2] & 0x8000) != 0;

155 
	}
}

157 
	g__END_NAMESPACE_C99


164 #ià
__GNUC_PREREQ
 (2, 8)

165 #ià!
__GNUC_PREREQ
 (3, 4è&& !
defšed
 
__NO_MATH_INLINES
 \

166 && 
defšed
 
	g__OPTIMIZE__


170 #ifdeà
__USE_ISOC99


171 
	g__BEGIN_NAMESPACE_C99


174 #ifdeà
__SSE_MATH__


175 
__MATH_INLINE
 

176 
__NTH
 (
	$Ìštf
 (
__x
))

178 
__»s
;

183 
__asm
 
	`__vŞ©e__
 ("cvtss2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

184  
__»s
;

185 
	}
}

187 #ifdeà
__SSE2_MATH__


188 
__MATH_INLINE
 

189 
__NTH
 (
	$Ìšt
 (
__x
))

191 
__»s
;

196 
__asm
 
	`__vŞ©e__
 ("cvtsd2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

197  
__»s
;

198 
	}
}

200 #ifdeà
__x86_64__


201 
__ex‹nsiÚ__


202 
__MATH_INLINE
 

203 
__NTH
 (
	$Îrštf
 (
__x
))

205 
__»s
;

210 
__asm
 
	`__vŞ©e__
 ("cvtss2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

211  
__»s
;

212 
	}
}

213 
__ex‹nsiÚ__


214 
__MATH_INLINE
 

215 
__NTH
 (
	$Îršt
 (
__x
))

217 
__»s
;

222 
__asm
 
	`__vŞ©e__
 ("cvtsd2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

223  
__»s
;

224 
	}
}

227 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0 \

228 && 
defšed
 
__SSE2_MATH__


230 
__MATH_INLINE
 

231 
__NTH
 (
	$fmaxf
 (
__x
, 
__y
))

233 #ifdeà
__AVX__


234 
__»s
;

235 
	`__asm
 ("vmaxs %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

236  
__»s
;

238 
	`__asm
 ("maxs %1, %0" : "+x" (
__x
è: "xm" (
__y
));

239  
__x
;

241 
	}
}

242 
__MATH_INLINE
 

243 
__NTH
 (
	$fmax
 (
__x
, 
__y
))

245 #ifdeà
__AVX__


246 
__»s
;

247 
	`__asm
 ("vmaxsd %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

248  
__»s
;

250 
	`__asm
 ("maxsd %1, %0" : "+x" (
__x
è: "xm" (
__y
));

251  
__x
;

253 
	}
}

256 
__MATH_INLINE
 

257 
__NTH
 (
	$fmšf
 (
__x
, 
__y
))

259 #ifdeà
__AVX__


260 
__»s
;

261 
	`__asm
 ("vmšs %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

262  
__»s
;

264 
	`__asm
 ("mšs %1, %0" : "+x" (
__x
è: "xm" (
__y
));

265  
__x
;

267 
	}
}

268 
__MATH_INLINE
 

269 
__NTH
 (
	$fmš
 (
__x
, 
__y
))

271 #ifdeà
__AVX__


272 
__»s
;

273 
	`__asm
 ("vmšsd %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

274  
__»s
;

276 
	`__asm
 ("mšsd %1, %0" : "+x" (
__x
è: "xm" (
__y
));

277  
__x
;

279 
	}
}

282 
	g__END_NAMESPACE_C99


285 #ià
defšed
 
__SSE4_1__
 && defšed 
__SSE2_MATH__


286 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


287 
__BEGIN_NAMESPACE_C99


290 
__MATH_INLINE
 

291 
__NTH
 (
	$ršt
 (
__x
))

293 
__»s
;

298 
__asm
 
	`__vŞ©e__
 ("roundsd $4, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

299  
__»s
;

300 
	}
}

301 
__MATH_INLINE
 

302 
__NTH
 (
	$rštf
 (
__x
))

304 
__»s
;

309 
__asm
 
	`__vŞ©e__
 ("rounds $4, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

310  
__»s
;

311 
	}
}

313 #ifdeà
__USE_ISOC99


315 
__MATH_INLINE
 

316 
__NTH
 (
	$Ã¬byšt
 (
__x
))

318 
__»s
;

323 
__asm
 
	`__vŞ©e__
 ("roundsd $0xc, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

324  
__»s
;

325 
	}
}

326 
__MATH_INLINE
 

327 
__NTH
 (
	$Ã¬byštf
 (
__x
))

329 
__»s
;

334 
__asm
 
	`__vŞ©e__
 ("rounds $0xc, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

335  
__»s
;

336 
	}
}

339 
	g__END_NAMESPACE_C99


342 
__BEGIN_NAMESPACE_STD


344 
__MATH_INLINE
 

345 
__NTH
 (
	$û
 (
__x
))

347 
__»s
;

348 
	`__asm
 ("roundsd $2, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

349  
__»s
;

350 
	}
}

351 
__END_NAMESPACE_STD


353 
__BEGIN_NAMESPACE_C99


354 
__MATH_INLINE
 

355 
__NTH
 (
	$ûf
 (
__x
))

357 
__»s
;

358 
	`__asm
 ("rounds $2, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

359  
__»s
;

360 
	}
}

361 
__END_NAMESPACE_C99


363 
__BEGIN_NAMESPACE_STD


365 
__MATH_INLINE
 

366 
__NTH
 (
	$æoÜ
 (
__x
))

368 
__»s
;

369 
	`__asm
 ("roundsd $1, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

370  
__»s
;

371 
	}
}

372 
__END_NAMESPACE_STD


374 
__BEGIN_NAMESPACE_C99


375 
__MATH_INLINE
 

376 
__NTH
 (
	$æoÜf
 (
__x
))

378 
__»s
;

379 
	`__asm
 ("rounds $1, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

380  
__»s
;

381 
	}
}

382 
	g__END_NAMESPACE_C99


387 #iâdeà
__SSE2_MATH__


388 #ià((!
defšed
 
__NO_MATH_INLINES
 || defšed 
__LIBC_INTERNAL_MATH_INLINES
) \

389 && 
defšed
 
	g__OPTIMIZE__
)

393 #undeà
m©h_”rhªdlšg


402 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


403 
	#__šlše_m©hİ
(
func
, 
İ
) \

404 
	`__šlše_m©hİ_
 (, 
func
, 
İ
) \

405 
	`__šlše_m©hİ_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
) \

406 
	`__šlše_m©hİ_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
)

	)

407 
	#__šlše_m©hİNP
(
func
, 
İ
) \

408 
	`__šlše_m©hİNP_
 (, 
func
, 
İ
) \

409 
	`__šlše_m©hİNP_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
) \

410 
	`__šlše_m©hİNP_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
)

	)

412 
	#__šlše_m©hİ
(
func
, 
İ
) \

413 
	`__šlše_m©hİ_
 (, 
func
, 
İ
)

	)

414 
	#__šlše_m©hİNP
(
func
, 
İ
) \

415 
	`__šlše_m©hİNP_
 (, 
func
, 
İ
)

	)

418 
	#__šlše_m©hİ_
(
æßt_ty³
, 
func
, 
İ
) \

419 
	`__šlše_m©hİ_deş_
 (
æßt_ty³
, 
func
, 
İ
, "0" (
__x
))

	)

420 
	#__šlše_m©hİNP_
(
æßt_ty³
, 
func
, 
İ
) \

421 
	`__šlše_m©hİ_deşNP_
 (
æßt_ty³
, 
func
, 
İ
, "0" (
__x
))

	)

424 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


425 
	#__šlše_m©hİ_deş
(
func
, 
İ
, 
·¿ms
...) \

426 
	`__šlše_m©hİ_deş_
 (, 
func
, 
İ
, 
·¿ms
) \

427 
	`__šlše_m©hİ_deş_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
, 
·¿ms
) \

428 
	`__šlše_m©hİ_deş_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
, 
·¿ms
)

	)

429 
	#__šlše_m©hİ_deşNP
(
func
, 
İ
, 
·¿ms
...) \

430 
	`__šlše_m©hİ_deşNP_
 (, 
func
, 
İ
, 
·¿ms
) \

431 
	`__šlše_m©hİ_deşNP_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
, 
·¿ms
) \

432 
	`__šlše_m©hİ_deşNP_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
, 
·¿ms
)

	)

434 
	#__šlše_m©hİ_deş
(
func
, 
İ
, 
·¿ms
...) \

435 
	`__šlše_m©hİ_deş_
 (, 
func
, 
İ
, 
·¿ms
)

	)

436 
	#__šlše_m©hİ_deşNP
(
func
, 
İ
, 
·¿ms
...) \

437 
	`__šlše_m©hİ_deşNP_
 (, 
func
, 
İ
, 
·¿ms
)

	)

440 
	#__šlše_m©hİ_deş_
(
æßt_ty³
, 
func
, 
İ
, 
·¿ms
...) \

441 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³è
__THROW
; \

442 
	`__šlše_m©hİ_deşNP_
 (
æßt_ty³
, 
func
, 
İ
, 
·¿ms
)

	)

444 
	#__šlše_m©hİ_deşNP_
(
æßt_ty³
, 
func
, 
İ
, 
·¿ms
...) \

445 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
__x
)) \

447 
æßt_ty³
 
__»suÉ
; \

448 
__asm
 
	`__vŞ©e__
 (
İ
 : "ñ" (
__»suÉ
è: 
·¿ms
); \

449  
__»suÉ
; \

450 }

	)

453 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


454 
	#__šlše_m©hcode
(
func
, 
¬g
, 
code
) \

455 
	`__šlše_m©hcode_
 (, 
func
, 
¬g
, 
code
) \

456 
	`__šlše_m©hcode_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g
, 
code
) \

457 
	`__šlše_m©hcode_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g
, 
code
)

	)

458 
	#__šlše_m©hcodeNP
(
func
, 
¬g
, 
code
) \

459 
	`__šlše_m©hcodeNP_
 (, 
func
, 
¬g
, 
code
) \

460 
	`__šlše_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g
, 
code
) \

461 
	`__šlše_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g
, 
code
)

	)

462 
	#__šlše_m©hcode2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

463 
	`__šlše_m©hcode2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
) \

464 
	`__šlše_m©hcode2_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
code
) \

465 
	`__šlše_m©hcode2_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
code
)

	)

466 
	#__šlše_m©hcodeNP2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

467 
	`__šlše_m©hcodeNP2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
) \

468 
	`__šlše_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
code
) \

469 
	`__šlše_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
code
)

	)

470 
	#__šlše_m©hcode3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

471 
	`__šlše_m©hcode3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

472 
	`__šlše_m©hcode3_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

473 
	`__šlše_m©hcode3_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

474 
	#__šlše_m©hcodeNP3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

475 
	`__šlše_m©hcodeNP3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

476 
	`__šlše_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

477 
	`__šlše_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

479 
	#__šlše_m©hcode
(
func
, 
¬g
, 
code
) \

480 
	`__šlše_m©hcode_
 (, 
func
, (
¬g
), 
code
)

	)

481 
	#__šlše_m©hcodeNP
(
func
, 
¬g
, 
code
) \

482 
	`__šlše_m©hcodeNP_
 (, 
func
, (
¬g
), 
code
)

	)

483 
	#__šlše_m©hcode2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

484 
	`__šlše_m©hcode2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

485 
	#__šlše_m©hcodeNP2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

486 
	`__šlše_m©hcodeNP2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

487 
	#__šlše_m©hcode3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

488 
	`__šlše_m©hcode3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

489 
	#__šlše_m©hcodeNP3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

490 
	`__šlše_m©hcodeNP3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

493 
	#__šlše_m©hcode_
(
æßt_ty³
, 
func
, 
¬g
, 
code
) \

494 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³è
__THROW
; \

495 
	`__šlše_m©hcodeNP_
(
æßt_ty³
, 
func
, 
¬g
, 
code
)

	)

497 
	#__šlše_m©hcodeNP_
(
æßt_ty³
, 
func
, 
¬g
, 
code
) \

498 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g
)) \

500 
code
; \

501 }

	)

504 
	#__šlše_m©hcode2_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
) \

505 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³, flßt_ty³è
__THROW
; \

506 
	`__šlše_m©hcodeNP2_
 (
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

508 
	#__šlše_m©hcodeNP2_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
) \

509 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g1
, flßt_ty³ 
¬g2
)) \

511 
code
; \

512 }

	)

514 
	#__šlše_m©hcode3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

515 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³, flßt_ty³, flßt_ty³è
__THROW
; \

516 
	`__šlše_m©hcodeNP3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

518 
	#__šlše_m©hcodeNP3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

519 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g1
, flßt_ty³ 
¬g2
, \

520 
æßt_ty³
 
¬g3
)) \

522 
code
; \

523 }

	)

527 #ià!
defšed
 
__NO_MATH_INLINES
 && defšed 
__OPTIMIZE__


531 #ifdeà
__FAST_MATH__


532 #ifdeà
__USE_GNU


533 
	#__sšcos_code
 \

534 
__co¤
; \

535 
__sšr
; \

536 
__swtmp
; \

537 
__asm
 
__vŞ©e__
 \

552 : "ñ" (
__co¤
), "=u" (
__sšr
), "÷" (
__swtmp
è: "0" (
__x
)); \

553 *
__sšx
 = 
__sšr
; \

554 *
__cosx
 = 
__co¤


	)

556 
__MATH_INLINE
 

557 
__NTH
 (
	$__sšcos
 (
__x
, *
__sšx
, *
__cosx
))

559 
__sšcos_code
;

560 
	}
}

562 
__MATH_INLINE
 

563 
__NTH
 (
	$__sšcosf
 (
__x
, *
__sšx
, *
__cosx
))

565 
__sšcos_code
;

566 
	}
}

568 
__MATH_INLINE
 

569 
__NTH
 (
	$__sšco¦
 (
__x
, *
__sšx
, *
__cosx
))

571 
__sšcos_code
;

572 
	}
}

579 #ià
__GNUC_PREREQ
 (3, 5)

580 
	#__expm1_code
 \

581 
__‹mp
; \

582 
__‹mp
 = 
	`__butš_expm1l
 (
__x
); \

583  
__‹mp
 ? __‹m°: 
__x


	)

585 
	#__expm1_code
 \

586 
__v®ue
; \

587 
__expÚ’t
; \

588 
__‹mp
; \

589 
__asm
 
__vŞ©e__
 \

598 : "ñ" (
__v®ue
), "=u" (
__expÚ’t
è: "0" (
__x
)); \

599 
__asm
 
__vŞ©e__
 \

601 : "ñ" (
__‹mp
è: "0" (1.0), "u" (
__expÚ’t
)); \

602 
__‹mp
 -= 1.0; \

603 
__‹mp
 +ğ
__v®ue
; \

604  
__‹mp
 ? __‹m°: 
__x


	)

606 
	$__šlše_m©hcodeNP_
 (, 
__expm1l
, 
__x
, 
__expm1_code
)

608 #ià
	`__GNUC_PREREQ
 (3, 4)

609 
	`__šlše_m©hcodeNP_
 (, 
__ex¶
, 
__x
,  
	$__butš_ex¶
 (
__x
))

611 
	#__exp_code
 \

612 
__v®ue
; \

613 
__expÚ’t
; \

614 
__asm
 
__vŞ©e__
 \

622 : "ñ" (
__v®ue
), "=u" (
__expÚ’t
è: "0" (
__x
)); \

623 
__v®ue
 += 1.0; \

624 
__asm
 
__vŞ©e__
 \

626 : "ñ" (
__v®ue
è: "0" (__v®ue), "u" (
__expÚ’t
)); \

627  
__v®ue


	)

628 
	$__šlše_m©hcodeNP
 (
exp
, 
__x
, 
__exp_code
)

629 
	$__šlše_m©hcodeNP_
 (, 
__ex¶
, 
__x
, 
__exp_code
)

633 #ià!
	`__GNUC_PREREQ
 (3, 5)

634 
	`__šlše_m©hcodeNP
 (
n
, 
__x
, \

635 
__v®ue
; \

636 
__v®ue2
 
	`__©Œibu‹__
 ((
__unu£d__
)); \

637 
__asm
 
__vŞ©e__
 \

639 : "ñ" (
__v®ue2
), "=u" (
__v®ue
è: "0" (
__x
)); \

640  
__v®ue
)

645 #ià
	`__GNUC_PREREQ
 (3, 4)

646 
	`__šlše_m©hcodeNP2_
 (, 
__©ª2l
, 
__y
, 
__x
,

647  
	$__butš_©ª2l
 (
__y
, 
__x
))

649 
	#__©ª2_code
 \

650 
__v®ue
; \

651 
__asm
 
__vŞ©e__
 \

653 : "ñ" (
__v®ue
è: "0" (
__x
), "u" (
__y
) : "st(1)"); \

654  
__v®ue


	)

655 #ifdeà
__FAST_MATH__


656 
	$__šlše_m©hcodeNP2
 (
©ª2
, 
__y
, 
__x
, 
__©ª2_code
)

658 
	$__šlše_m©hcodeNP2_
 (, 
__©ª2l
, 
__y
, 
__x
, 
__©ª2_code
)

662 #ià
defšed
 
__FAST_MATH__
 && !
	`__GNUC_PREREQ
 (3, 5)

663 
	`__šlše_m©hcodeNP2
 (
fmod
, 
__x
, 
__y
, \

664 
__v®ue
; \

665 
__asm
 
__vŞ©e__
 \

670 : "ñ" (
__v®ue
è: "0" (
__x
), "u" (
__y
) : "ax", "cc"); \

671  
__v®ue
)

675 #ifdeà
__FAST_MATH__


676 #ià!
	`__GNUC_PREREQ
 (3,3)

677 
	`__šlše_m©hİNP
 (
sq¹
, "fsqrt")

678 
	`__šlše_m©hİNP_
 (, 
__sq¹l
, "fsqrt")

679 
	#__libc_sq¹l
(
n
è
	`__sq¹l
 (n)

	)

681 
	#__libc_sq¹l
(
n
è
	`__butš_sq¹l
 (n)

	)

685 #ià
	`__GNUC_PREREQ
 (2, 8)

686 
	`__šlše_m©hcodeNP_
 (, 
çbs
, 
__x
,  
	$__butš_çbs
 (
__x
))

687 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


688 
	`__šlše_m©hcodeNP_
 (, 
çbsf
, 
__x
,  
	$__butš_çbsf
 (
__x
))

689 
	`__šlše_m©hcodeNP_
 (, 
çb¦
, 
__x
,  
	$__butš_çb¦
 (
__x
))

691 
	`__šlše_m©hcodeNP_
 (, 
__çb¦
, 
__x
,  
	$__butš_çb¦
 (
__x
))

693 
	`__šlše_m©hİ
 (
çbs
, "fabs")

694 
	`__šlše_m©hİ_
 (, 
__çb¦
, "fabs")

697 #ifdeà
__FAST_MATH__


698 #ià!
	`__GNUC_PREREQ
 (3, 4)

700 
	`__šlše_m©hİNP
 (
sš
, "fsin")

702 
	`__šlše_m©hİNP
 (
cos
, "fcos")

704 
	`__šlše_m©hİ_deşNP
 (
log
, "ædÊ2; fxch; fyl2x", "0" (
__x
) : "st(1)")

707 #ià!
	`__GNUC_PREREQ
 (3, 5)

708 
	`__šlše_m©hİ_deşNP
 (
log10
, "ædlg2; fxch; fyl2x", "0" (
__x
) : "st(1)")

710 
	`__šlše_m©hcodeNP
 (
asš
, 
__x
,  
	`__©ª2l
 (__x, 
	`__libc_sq¹l
 (1.0 - __x * __x)))

711 
	`__šlše_m©hcodeNP
 (
acos
, 
__x
,  
	`__©ª2l
 (
	`__libc_sq¹l
 (1.0 - __x * __x), __x))

714 #ià!
	`__GNUC_PREREQ
 (3, 4)

715 
	`__šlše_m©hİ_deşNP
 (
©ª
, "æd1; f·n", "0" (
__x
) : "st(1)")

719 
	`__šlše_m©hcode_
 (, 
__sgn1l
, 
__x
, \

720 
__ex‹nsiÚ__
 uniÚ { 
__xld
; 
__xi
[3]; } 
__n
 = \

721 { 
__xld
: 
__x
 
	}
}; \

722 
	g__n
.
	g__xi
[2] = (
__n
.
__xi
[2] & 0x8000) | 0x3fff; \

723 
	g__n
.
	g__xi
[1] = 0x80000000; \

724 
	g__n
.
	g__xi
[0] = 0; \

725  
	g__n
.
	g__xld
)

728 #ifdeà
__FAST_MATH__


730 
__šlše_m©hcodeNP
 (
sšh
, 
__x
, \

731 
__exm1
 = 
__expm1l
 (
__çb¦
 (
__x
)); \

732  0.5 * (
__exm1
 / (__exm1 + 1.0è+ __exm1è* 
	$__sgn1l
 (
__x
))

734 
	`__šlše_m©hcodeNP
 (
cosh
, 
__x
, \

735 
__ex
 = 
	`__ex¶
 (
__x
); \

736  0.5 * (
__ex
 + 1.0 / __ex))

738 
	`__šlše_m©hcodeNP
 (
nh
, 
__x
, \

739 
__exm1
 = 
	`__expm1l
 (-
	`__çb¦
 (
__x
 + __x)); \

740  
__exm1
 / (__exm1 + 2.0è* 
	`__sgn1l
 (-
__x
))

743 
	`__šlše_m©hcodeNP
 (
æoÜ
, 
__x
, \

744 
__v®ue
; \

745 
__ignÜe
; \

746 
__cw
; \

747 
__cwtmp
; \

748 
__asm
 
	`__vŞ©e
 ("fnstcw %3\n\t" \

756 : "ñ" (
__v®ue
), "=&q" (
__ignÜe
), "=m" (
__cwtmp
), \

757 "=m" (
__cw
) \

758 : "0" (
__x
)); \

759  
__v®ue
)

761 
	`__šlše_m©hcodeNP
 (
û
, 
__x
, \

762 
__v®ue
; \

763 
__ignÜe
; \

764 
__cw
; \

765 
__cwtmp
; \

766 
__asm
 
	`__vŞ©e
 ("fnstcw %3\n\t" \

774 : "ñ" (
__v®ue
), "=&q" (
__ignÜe
), "=m" (
__cwtmp
), \

775 "=m" (
__cw
) \

776 : "0" (
__x
)); \

777  
__v®ue
)

779 #ifdeà
__FAST_MATH__


780 
	#__ldexp_code
 \

781 
__v®ue
; \

782 
__asm
 
__vŞ©e__
 \

784 : "ñ" (
__v®ue
è: "0" (
__x
), "u" ((è
__y
)); \

785  
__v®ue


	)

787 
__MATH_INLINE
 

788 
	`__NTH
 (
	$ldexp
 (
__x
, 
__y
))

790 
__ldexp_code
;

791 
	}
}

796 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


798 #ifdeà
__FAST_MATH__


799 
	$__šlše_m©hcodeNP
 (
expm1
, 
__x
, 
__expm1_code
)

803 
	#__M_SQRT2
 1.41421356237309504880L

	)

805 #ià!
	`__GNUC_PREREQ
 (3, 5)

806 
	`__šlše_m©hcodeNP
 (
log1p
, 
__x
, \

807 
__v®ue
; \

808 ià(
	`__çb¦
 (
__x
è>ğ1.0 - 0.5 * 
__M_SQRT2
) \

809 
__v®ue
 = 
	`logl
 (1.0 + 
__x
); \

811 
__asm
 
__vŞ©e__
 \

815 : "ñ" (
__v®ue
è: "0" (
__x
) : "st(1)"); \

816  
__v®ue
)

821 
	`__šlše_m©hcodeNP
 (
asšh
, 
__x
, \

822 
__y
 = 
	`__çb¦
 (
__x
); \

823  (
	`log1¶
 (
__y
 * __y / (
	`__libc_sq¹l
 (__y * __y + 1.0) + 1.0) + __y) \

824 * 
	$__sgn1l
 (
__x
)))

826 
	`__šlše_m©hcodeNP
 (
acosh
, 
__x
, \

827  
	`logl
 (
__x
 + 
	`__libc_sq¹l
 (__x - 1.0) * __libc_sqrtl (__x + 1.0)))

829 
	`__šlše_m©hcodeNP
 (
©ªh
, 
__x
, \

830 
__y
 = 
	`__çb¦
 (
__x
); \

831  -0.5 * 
	`log1¶
 (-(
__y
 + __yè/ (1.0 + __y)è* 
	$__sgn1l
 (
__x
))

834 
	`__šlše_m©hcodeNP2
 (
hypÙ
, 
__x
, 
__y
,

835  
	`__libc_sq¹l
 (
__x
 * __x + 
__y
 * __y))

837 #ià!
	`__GNUC_PREREQ
 (3, 5)

838 
	`__šlše_m©hcodeNP
(
logb
, 
__x
, \

839 
__v®ue
; \

840 
__junk
; \

841 
__asm
 
__vŞ©e__
 \

843 : "ñ" (
__junk
), "=u" (
__v®ue
è: "0" (
__x
)); \

844  
__v®ue
)

850 #ifdeà
__USE_ISOC99


851 #ifdeà
__FAST_MATH__


853 #ià!
	`__GNUC_PREREQ
 (3, 5)

854 
	`__šlše_m©hİ_deşNP
 (
log2
, "æd1; fxch; fyl2x", "0" (
__x
) : "st(1)")

857 
__MATH_INLINE
 

858 
	`__NTH
 (
	$ldexpf
 (
__x
, 
__y
))

860 
__ldexp_code
;

861 
	}
}

863 
__MATH_INLINE
 

864 
__NTH
 (
	$ldex¶
 (
__x
, 
__y
))

866 
__ldexp_code
;

867 
	}
}

869 
__šlše_m©hİNP
 (
ršt
, "frndint")

872 
	#__Ìšt_code
 \

873 
__ÌšŒes
; \

874 
__asm__
 
__vŞ©e__
 \

876 : "=m" (
__ÌšŒes
è: "t" (
__x
) : "st"); \

877  
__ÌšŒes


	)

878 
__MATH_INLINE
 

879 
__NTH
 (
	$Ìštf
 (
__x
))

881 
__Ìšt_code
;

882 
	}
}

883 
__MATH_INLINE
 

884 
__NTH
 (
	$Ìšt
 (
__x
))

886 
__Ìšt_code
;

887 
	}
}

888 
__MATH_INLINE
 

889 
__NTH
 (
	$Ìš
 (
__x
))

891 
__Ìšt_code
;

892 
	}
}

893 #undeà
__Ìšt_code


895 
	#__Îršt_code
 \

896 
__ÎršŒes
; \

897 
__asm__
 
__vŞ©e__
 \

899 : "=m" (
__ÎršŒes
è: "t" (
__x
) : "st"); \

900  
__ÎršŒes


	)

901 
__ex‹nsiÚ__


902 
__MATH_INLINE
 

903 
__NTH
 (
	$Îrštf
 (
__x
))

905 
__Îršt_code
;

906 
	}
}

907 
__ex‹nsiÚ__


908 
__MATH_INLINE
 

909 
__NTH
 (
	$Îršt
 (
__x
))

911 
__Îršt_code
;

912 
	}
}

913 
__ex‹nsiÚ__


914 
__MATH_INLINE
 

915 
__NTH
 (
	$Îrš
 (
__x
))

917 
__Îršt_code
;

918 
	}
}

919 #undeà
__Îršt_code


924 #ifdeà
__USE_MISC


926 #ià
defšed
 
__FAST_MATH__
 && !
__GNUC_PREREQ
 (3, 5)

927 
__šlše_m©hcodeNP2
 (
d»m
, 
__x
, 
__y
, \

928 
__v®ue
; \

929 
__şobb”ed
; \

930 
__asm
 
__vŞ©e__
 \

935 : "ñ" (
__v®ue
), "=&a" (
__şobb”ed
è: "0" (
__x
), "u" (
__y
) : "cc"); \

936  
__v®ue
)

941 
__MATH_INLINE
 

942 
__NTH
 (
	$__fš™e
 (
__x
))

944  (
__ex‹nsiÚ__


945 (((((uniÚ { 
__d
; 
__i
[2]; }è{__d: 
__x
}).__i[1]

947 
	}
}

952 #undeà
__©ª2_code


953 #ifdeà
__FAST_MATH__


954 #undeà
__expm1_code


955 #undeà
__exp_code


956 #undeà
__sšcos_code


963 #ifdeà
__LIBC_INTERNAL_MATH_INLINES


964 
__šlše_m©hİ
 (
__›“754_sq¹
, "fsqrt")

965 
__šlše_m©hcode2
 (
__›“754_©ª2
, 
__y
, 
__x
,

966 
__v®ue
;

967 
__asm
 
__vŞ©e__
 ("fpatan\n\t"

968 : "ñ" (
__v®ue
)

969 : "0" (
__x
), "u" (
__y
) : "st(1)");

970  
__v®ue
;)

	@/usr/include/bits/mman.h

19 #iâdeà
_SYS_MMAN_H


27 #ifdeà
__USE_MISC


28 
	#MAP_32BIT
 0x40

	)

32 #ifdeà
__USE_MISC


33 
	#MAP_GROWSDOWN
 0x00100

	)

34 
	#MAP_DENYWRITE
 0x00800

	)

35 
	#MAP_EXECUTABLE
 0x01000

	)

36 
	#MAP_LOCKED
 0x02000

	)

37 
	#MAP_NORESERVE
 0x04000

	)

38 
	#MAP_POPULATE
 0x08000

	)

39 
	#MAP_NONBLOCK
 0x10000

	)

40 
	#MAP_STACK
 0x20000

	)

41 
	#MAP_HUGETLB
 0x40000

	)

45 
	~<b™s/mmª-lšux.h
>

	@/usr/include/bits/nan.h

19 #iâdeà
_MATH_H


26 #ià
__GNUC_PREREQ
(3,3)

28 
	#NAN
 (
	`__butš_Çnf
 (""))

	)

30 #–ià
defšed
 
__GNUC__


32 
	#NAN
 \

33 (
__ex‹nsiÚ__
 \

34 ((uniÚ { 
__l
 
	`__©Œibu‹__
 ((
	`__mode__
 (
__SI__
))); 
__d
; }) \

35 { 
__l
: 0x7fc00000UL }).
__d
)

	)

39 
	~<’dŸn.h
>

41 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


42 
	#__qÇn_by‹s
 { 0x7f, 0xc0, 0, 0 }

	)

44 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


45 
	#__qÇn_by‹s
 { 0, 0, 0xc0, 0x7à}

	)

48 uniÚ { 
	m__c
[4]; 
	m__d
; } 
__qÇn_uniÚ


49 
__©Œibu‹__
 ((
__unu£d__
)èğ{ 
__qÇn_by‹s
 };

50 
	#NAN
 (
__qÇn_uniÚ
.
__d
)

	)

	@/usr/include/bits/netdb.h

18 #iâdeà
_NETDB_H


26 
	sÃ‹Á


28 *
	mn_Çme
;

29 **
	mn_®Ÿ£s
;

30 
	mn_add¹y³
;

31 
ušt32_t
 
	mn_Ãt
;

	@/usr/include/bits/param.h

19 #iâdeà
_SYS_PARAM_H


23 #iâdeà
ARG_MAX


24 
	#__undef_ARG_MAX


	)

27 
	~<lšux/lim™s.h
>

28 
	~<lšux/·¿m.h
>

31 #ifdeà
__undef_ARG_MAX


32 #undeà
ARG_MAX


33 #undeà
__undef_ARG_MAX


36 
	#MAXSYMLINKS
 20

	)

41 
	#NOFILE
 256

	)

42 
	#NCARGS
 131072

	)

	@/usr/include/bits/posix1_lim.h

24 #iâdef 
_BITS_POSIX1_LIM_H


25 
	#_BITS_POSIX1_LIM_H
 1

	)

31 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

34 
	#_POSIX_AIO_MAX
 1

	)

37 
	#_POSIX_ARG_MAX
 4096

	)

40 #ifdeà
__USE_XOPEN2K


41 
	#_POSIX_CHILD_MAX
 25

	)

43 
	#_POSIX_CHILD_MAX
 6

	)

47 
	#_POSIX_DELAYTIMER_MAX
 32

	)

51 
	#_POSIX_HOST_NAME_MAX
 255

	)

54 
	#_POSIX_LINK_MAX
 8

	)

57 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

60 
	#_POSIX_MAX_CANON
 255

	)

64 
	#_POSIX_MAX_INPUT
 255

	)

67 
	#_POSIX_MQ_OPEN_MAX
 8

	)

70 
	#_POSIX_MQ_PRIO_MAX
 32

	)

73 
	#_POSIX_NAME_MAX
 14

	)

76 #ifdeà
__USE_XOPEN2K


77 
	#_POSIX_NGROUPS_MAX
 8

	)

79 
	#_POSIX_NGROUPS_MAX
 0

	)

83 #ifdeà
__USE_XOPEN2K


84 
	#_POSIX_OPEN_MAX
 20

	)

86 
	#_POSIX_OPEN_MAX
 16

	)

89 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

96 
	#_POSIX_PATH_MAX
 256

	)

99 
	#_POSIX_PIPE_BUF
 512

	)

103 
	#_POSIX_RE_DUP_MAX
 255

	)

106 
	#_POSIX_RTSIG_MAX
 8

	)

109 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

112 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

115 
	#_POSIX_SIGQUEUE_MAX
 32

	)

118 
	#_POSIX_SSIZE_MAX
 32767

	)

121 
	#_POSIX_STREAM_MAX
 8

	)

124 
	#_POSIX_SYMLINK_MAX
 255

	)

128 
	#_POSIX_SYMLOOP_MAX
 8

	)

131 
	#_POSIX_TIMER_MAX
 32

	)

134 
	#_POSIX_TTY_NAME_MAX
 9

	)

137 #ifdeà
__USE_XOPEN2K


138 
	#_POSIX_TZNAME_MAX
 6

	)

140 
	#_POSIX_TZNAME_MAX
 3

	)

143 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


145 
	#_POSIX_QLIMIT
 1

	)

149 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

152 
	#_POSIX_UIO_MAXIOV
 16

	)

156 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

160 
	~<b™s/loÿl_lim.h
>

163 #iâdef 
SSIZE_MAX


164 
	#SSIZE_MAX
 
LONG_MAX


	)

171 #iâdef 
NGROUPS_MAX


172 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

22 #iâdef 
_BITS_POSIX2_LIM_H


23 
	#_BITS_POSIX2_LIM_H
 1

	)

27 
	#_POSIX2_BC_BASE_MAX
 99

	)

30 
	#_POSIX2_BC_DIM_MAX
 2048

	)

33 
	#_POSIX2_BC_SCALE_MAX
 99

	)

36 
	#_POSIX2_BC_STRING_MAX
 1000

	)

40 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

44 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

47 
	#_POSIX2_LINE_MAX
 2048

	)

51 
	#_POSIX2_RE_DUP_MAX
 255

	)

55 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

62 #iâdef 
BC_BASE_MAX


63 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

65 #iâdef 
BC_DIM_MAX


66 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

68 #iâdef 
BC_SCALE_MAX


69 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

71 #iâdef 
BC_STRING_MAX


72 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

74 #iâdef 
COLL_WEIGHTS_MAX


75 
	#COLL_WEIGHTS_MAX
 255

	)

77 #iâdef 
EXPR_NEST_MAX


78 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

80 #iâdef 
LINE_MAX


81 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

83 #iâdef 
CHARCLASS_NAME_MAX


84 
	#CHARCLASS_NAME_MAX
 2048

	)

88 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/posix_opt.h

19 #iâdef 
_BITS_POSIX_OPT_H


20 
	#_BITS_POSIX_OPT_H
 1

	)

23 
	#_POSIX_JOB_CONTROL
 1

	)

26 
	#_POSIX_SAVED_IDS
 1

	)

29 
	#_POSIX_PRIORITY_SCHEDULING
 200809L

	)

32 
	#_POSIX_SYNCHRONIZED_IO
 200809L

	)

35 
	#_POSIX_FSYNC
 200809L

	)

38 
	#_POSIX_MAPPED_FILES
 200809L

	)

41 
	#_POSIX_MEMLOCK
 200809L

	)

44 
	#_POSIX_MEMLOCK_RANGE
 200809L

	)

47 
	#_POSIX_MEMORY_PROTECTION
 200809L

	)

50 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

54 
	#_POSIX_VDISABLE
 '\0'

	)

57 
	#_POSIX_NO_TRUNC
 1

	)

60 
	#_XOPEN_REALTIME
 1

	)

63 
	#_XOPEN_REALTIME_THREADS
 1

	)

66 
	#_XOPEN_SHM
 1

	)

69 
	#_POSIX_THREADS
 200809L

	)

72 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

73 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200809L

	)

76 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200809L

	)

79 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200809L

	)

82 
	#_POSIX_THREAD_ATTR_STACKADDR
 200809L

	)

85 
	#_POSIX_THREAD_PRIO_INHERIT
 200809L

	)

89 
	#_POSIX_THREAD_PRIO_PROTECT
 200809L

	)

91 #ifdeà
__USE_XOPEN2K8


93 
	#_POSIX_THREAD_ROBUST_PRIO_INHERIT
 200809L

	)

96 
	#_POSIX_THREAD_ROBUST_PRIO_PROTECT
 -1

	)

100 
	#_POSIX_SEMAPHORES
 200809L

	)

103 
	#_POSIX_REALTIME_SIGNALS
 200809L

	)

106 
	#_POSIX_ASYNCHRONOUS_IO
 200809L

	)

107 
	#_POSIX_ASYNC_IO
 1

	)

109 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

111 
	#_POSIX_PRIORITIZED_IO
 200809L

	)

114 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

117 
	#_LFS_LARGEFILE
 1

	)

118 
	#_LFS64_LARGEFILE
 1

	)

119 
	#_LFS64_STDIO
 1

	)

122 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200809L

	)

125 
	#_POSIX_CPUTIME
 0

	)

128 
	#_POSIX_THREAD_CPUTIME
 0

	)

131 
	#_POSIX_REGEXP
 1

	)

134 
	#_POSIX_READER_WRITER_LOCKS
 200809L

	)

137 
	#_POSIX_SHELL
 1

	)

140 
	#_POSIX_TIMEOUTS
 200809L

	)

143 
	#_POSIX_SPIN_LOCKS
 200809L

	)

146 
	#_POSIX_SPAWN
 200809L

	)

149 
	#_POSIX_TIMERS
 200809L

	)

152 
	#_POSIX_BARRIERS
 200809L

	)

155 
	#_POSIX_MESSAGE_PASSING
 200809L

	)

158 
	#_POSIX_THREAD_PROCESS_SHARED
 200809L

	)

161 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

164 
	#_POSIX_CLOCK_SELECTION
 200809L

	)

167 
	#_POSIX_ADVISORY_INFO
 200809L

	)

170 
	#_POSIX_IPV6
 200809L

	)

173 
	#_POSIX_RAW_SOCKETS
 200809L

	)

176 
	#_POSIX2_CHAR_TERM
 200809L

	)

179 
	#_POSIX_SPORADIC_SERVER
 -1

	)

180 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

183 
	#_POSIX_TRACE
 -1

	)

184 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

185 
	#_POSIX_TRACE_INHERIT
 -1

	)

186 
	#_POSIX_TRACE_LOG
 -1

	)

189 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/pthreadtypes.h

18 #iâdeà
_BITS_PTHREADTYPES_H


19 
	#_BITS_PTHREADTYPES_H
 1

	)

21 
	~<b™s/wÜdsize.h
>

23 #ifdeà
__x86_64__


24 #ià
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

26 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

27 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

28 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

29 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

30 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

31 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

32 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

33 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

35 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

36 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

37 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

38 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

39 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

40 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

41 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

43 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

46 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

47 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

48 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

49 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

50 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

51 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

52 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

53 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

54 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

60 
	t±h»ad_t
;

63 
	u±h»ad_©Œ_t


65 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

66 
	m__®ign
;

68 #iâdeà
__have_±h»ad_©Œ_t


69 
±h»ad_©Œ_t
 
	t±h»ad_©Œ_t
;

70 
	#__have_±h»ad_©Œ_t
 1

	)

74 #ifdeà
__x86_64__


75 
	s__±h»ad_š‹º®_li¡


77 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

78 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

79 } 
	t__±h»ad_li¡_t
;

81 
	s__±h»ad_š‹º®_¦i¡


83 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

84 } 
	t__±h»ad_¦i¡_t
;

92 
	s__±h»ad_mu‹x_s


94 
	m__lock
;

95 
	m__couÁ
;

96 
	m__owÃr
;

97 #ifdeà
__x86_64__


98 
	m__nu£rs
;

102 
	m__kšd
;

103 #ifdeà
__x86_64__


104 
	m__¥šs
;

105 
	m__–isiÚ
;

106 
__±h»ad_li¡_t
 
	m__li¡
;

107 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

108 
	#__PTHREAD_MUTEX_HAVE_ELISION
 1

	)

110 
	m__nu£rs
;

111 
__ex‹nsiÚ__
 union

115 
	m__e¥šs
;

116 
	m__–isiÚ
;

117 
	#__¥šs
 
d
.
__e¥šs


	)

118 
	#__–isiÚ
 
d
.
__–isiÚ


	)

119 
	#__PTHREAD_MUTEX_HAVE_ELISION
 2

	)

120 } 
	md
;

121 
__±h»ad_¦i¡_t
 
	m__li¡
;

124 } 
	m__d©a
;

125 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

126 
	m__®ign
;

127 } 
	t±h»ad_mu‹x_t
;

131 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

132 
	m__®ign
;

133 } 
	t±h»ad_mu‹x©Œ_t
;

142 
	m__lock
;

143 
	m__fu‹x
;

144 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

145 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

146 
__ex‹nsiÚ__
 
	m__wok’_£q
;

147 *
	m__mu‹x
;

148 
	m__nwa™”s
;

149 
	m__brßdÿ¡_£q
;

150 } 
	m__d©a
;

151 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

152 
__ex‹nsiÚ__
 
	m__®ign
;

153 } 
	t±h»ad_cÚd_t
;

157 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

158 
	m__®ign
;

159 } 
	t±h»ad_cÚd©Œ_t
;

163 
	t±h»ad_key_t
;

167 
	t±h»ad_Úû_t
;

170 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


175 #ifdeà
__x86_64__


178 
	m__lock
;

179 
	m__Ä_»ad”s
;

180 
	m__»ad”s_wakeup
;

181 
	m__wr™”_wakeup
;

182 
	m__Ä_»ad”s_queued
;

183 
	m__Ä_wr™”s_queued
;

184 
	m__wr™”
;

185 
	m__sh¬ed
;

186 
	m__·d1
;

187 
	m__·d2
;

190 
	m__æags
;

191 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

192 } 
	m__d©a
;

196 
	m__lock
;

197 
	m__Ä_»ad”s
;

198 
	m__»ad”s_wakeup
;

199 
	m__wr™”_wakeup
;

200 
	m__Ä_»ad”s_queued
;

201 
	m__Ä_wr™”s_queued
;

204 
	m__æags
;

205 
	m__sh¬ed
;

206 
	m__·d1
;

207 
	m__·d2
;

208 
	m__wr™”
;

209 } 
	m__d©a
;

211 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

212 
	m__®ign
;

213 } 
	t±h»ad_rwlock_t
;

217 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

218 
	m__®ign
;

219 } 
	t±h»ad_rwlock©Œ_t
;

223 #ifdeà
__USE_XOPEN2K


225 vŞ©
	t±h»ad_¥šlock_t
;

232 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

233 
	m__®ign
;

234 } 
	t±h»ad_b¬r›r_t
;

238 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

239 
	m__®ign
;

240 } 
	t±h»ad_b¬r›¿‰r_t
;

244 #iâdeà
__x86_64__


246 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/resource.h

19 #iâdeà
_SYS_RESOURCE_H


23 
	~<b™s/ty³s.h
>

31 
	e__¾im™_»sourû


34 
	mRLIMIT_CPU
 = 0,

35 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

38 
	mRLIMIT_FSIZE
 = 1,

39 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

42 
	mRLIMIT_DATA
 = 2,

43 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

46 
	mRLIMIT_STACK
 = 3,

47 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

50 
	mRLIMIT_CORE
 = 4,

51 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

57 
	m__RLIMIT_RSS
 = 5,

58 
	#RLIMIT_RSS
 
__RLIMIT_RSS


	)

61 
	mRLIMIT_NOFILE
 = 7,

62 
	m__RLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

63 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

64 
	#RLIMIT_OFILE
 
__RLIMIT_OFILE


	)

67 
	mRLIMIT_AS
 = 9,

68 
	#RLIMIT_AS
 
RLIMIT_AS


	)

71 
	m__RLIMIT_NPROC
 = 6,

72 
	#RLIMIT_NPROC
 
__RLIMIT_NPROC


	)

75 
	m__RLIMIT_MEMLOCK
 = 8,

76 
	#RLIMIT_MEMLOCK
 
__RLIMIT_MEMLOCK


	)

79 
	m__RLIMIT_LOCKS
 = 10,

80 
	#RLIMIT_LOCKS
 
__RLIMIT_LOCKS


	)

83 
	m__RLIMIT_SIGPENDING
 = 11,

84 
	#RLIMIT_SIGPENDING
 
__RLIMIT_SIGPENDING


	)

87 
	m__RLIMIT_MSGQUEUE
 = 12,

88 
	#RLIMIT_MSGQUEUE
 
__RLIMIT_MSGQUEUE


	)

93 
	m__RLIMIT_NICE
 = 13,

94 
	#RLIMIT_NICE
 
__RLIMIT_NICE


	)

98 
	m__RLIMIT_RTPRIO
 = 14,

99 
	#RLIMIT_RTPRIO
 
__RLIMIT_RTPRIO


	)

104 
	m__RLIMIT_RTTIME
 = 15,

105 
	#RLIMIT_RTTIME
 
__RLIMIT_RTTIME


	)

107 
	m__RLIMIT_NLIMITS
 = 16,

108 
	m__RLIM_NLIMITS
 = 
__RLIMIT_NLIMITS


109 
	#RLIMIT_NLIMITS
 
__RLIMIT_NLIMITS


	)

110 
	#RLIM_NLIMITS
 
__RLIM_NLIMITS


	)

114 #iâdeà
__USE_FILE_OFFSET64


115 
	#RLIM_INFINITY
 ((
__¾im_t
è-1)

	)

117 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

120 #ifdeà
__USE_LARGEFILE64


121 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

125 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

126 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

130 #iâdeà
__USE_FILE_OFFSET64


131 
__¾im_t
 
	t¾im_t
;

133 
__¾im64_t
 
	t¾im_t
;

135 #ifdeà
__USE_LARGEFILE64


136 
__¾im64_t
 
	t¾im64_t
;

139 
	s¾im™


142 
¾im_t
 
	m¾im_cur
;

144 
¾im_t
 
	m¾im_max
;

147 #ifdeà
__USE_LARGEFILE64


148 
	s¾im™64


151 
¾im64_t
 
	m¾im_cur
;

153 
¾im64_t
 
	m¾im_max
;

158 
	e__ru§ge_who


161 
	mRUSAGE_SELF
 = 0,

162 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

165 
	mRUSAGE_CHILDREN
 = -1

166 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

168 #ifdeà
__USE_GNU


171 
	mRUSAGE_THREAD
 = 1

172 
	#RUSAGE_THREAD
 
RUSAGE_THREAD


	)

174 
	#RUSAGE_LWP
 
RUSAGE_THREAD


	)

178 
	#__Ãed_timev®


	)

179 
	~<b™s/time.h
>

187 
	sru§ge


190 
timev®
 
	mru_utime
;

192 
timev®
 
	mru_¡ime
;

194 
__ex‹nsiÚ__
 union

196 
	mru_maxrss
;

197 
__sysÿÎ_¦Úg_t
 
	m__ru_maxrss_wÜd
;

202 
__ex‹nsiÚ__
 union

204 
	mru_ixrss
;

205 
__sysÿÎ_¦Úg_t
 
	m__ru_ixrss_wÜd
;

208 
__ex‹nsiÚ__
 union

210 
	mru_idrss
;

211 
__sysÿÎ_¦Úg_t
 
	m__ru_idrss_wÜd
;

214 
__ex‹nsiÚ__
 union

216 
	mru_i¤ss
;

217 
__sysÿÎ_¦Úg_t
 
	m__ru_i¤ss_wÜd
;

221 
__ex‹nsiÚ__
 union

223 
	mru_mšæt
;

224 
__sysÿÎ_¦Úg_t
 
	m__ru_mšæt_wÜd
;

227 
__ex‹nsiÚ__
 union

229 
	mru_majæt
;

230 
__sysÿÎ_¦Úg_t
 
	m__ru_majæt_wÜd
;

233 
__ex‹nsiÚ__
 union

235 
	mru_nsw­
;

236 
__sysÿÎ_¦Úg_t
 
	m__ru_nsw­_wÜd
;

240 
__ex‹nsiÚ__
 union

242 
	mru_šblock
;

243 
__sysÿÎ_¦Úg_t
 
	m__ru_šblock_wÜd
;

246 
__ex‹nsiÚ__
 union

248 
	mru_oublock
;

249 
__sysÿÎ_¦Úg_t
 
	m__ru_oublock_wÜd
;

252 
__ex‹nsiÚ__
 union

254 
	mru_msg¢d
;

255 
__sysÿÎ_¦Úg_t
 
	m__ru_msg¢d_wÜd
;

258 
__ex‹nsiÚ__
 union

260 
	mru_msgrcv
;

261 
__sysÿÎ_¦Úg_t
 
	m__ru_msgrcv_wÜd
;

264 
__ex‹nsiÚ__
 union

266 
	mru_nsigÇls
;

267 
__sysÿÎ_¦Úg_t
 
	m__ru_nsigÇls_wÜd
;

272 
__ex‹nsiÚ__
 union

274 
	mru_nvcsw
;

275 
__sysÿÎ_¦Úg_t
 
	m__ru_nvcsw_wÜd
;

279 
__ex‹nsiÚ__
 union

281 
	mru_nivcsw
;

282 
__sysÿÎ_¦Úg_t
 
	m__ru_nivcsw_wÜd
;

287 
	#PRIO_MIN
 -20

	)

288 
	#PRIO_MAX
 20

	)

292 
	e__´iÜ™y_which


294 
	mPRIO_PROCESS
 = 0,

295 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

296 
	mPRIO_PGRP
 = 1,

297 
	#PRIO_PGRP
 
PRIO_PGRP


	)

298 
	mPRIO_USER
 = 2

299 
	#PRIO_USER
 
PRIO_USER


	)

303 
	g__BEGIN_DECLS


305 #ifdeà
__USE_GNU


307 #iâdeà
__USE_FILE_OFFSET64


308 
	$´lim™
 (
__pid_t
 
__pid
, 
__¾im™_»sourû
 
__»sourû
,

309 cÚ¡ 
¾im™
 *
__Ãw_lim™
,

310 
¾im™
 *
__Şd_lim™
è
__THROW
;

312 #ifdeà
__REDIRECT_NTH


313 
	`__REDIRECT_NTH
 (
´lim™
, (
__pid_t
 
__pid
,

314 
__¾im™_»sourû
 
__»sourû
,

315 cÚ¡ 
¾im™
 *
__Ãw_lim™
,

316 
¾im™
 *
__Şd_lim™
), 
´lim™64
);

318 
	#´lim™
 
´lim™64


	)

321 #ifdeà
__USE_LARGEFILE64


322 
	$´lim™64
 (
__pid_t
 
__pid
, 
__¾im™_»sourû
 
__»sourû
,

323 cÚ¡ 
¾im™64
 *
__Ãw_lim™
,

324 
¾im™64
 *
__Şd_lim™
è
__THROW
;

328 
__END_DECLS


	@/usr/include/bits/select.h

18 #iâdeà
_SYS_SELECT_H


22 
	~<b™s/wÜdsize.h
>

25 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

27 #ià
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "¡osq"

	)

30 
	#__FD_ZERO_STOS
 "¡o¦"

	)

33 
	#__FD_ZERO
(
fd¥
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¬r
 = (
£t
); \

52 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |ğ
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &ğ~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)è!ğ0)

	)

	@/usr/include/bits/select2.h

19 #iâdeà
_SYS_SELECT_H


24 
__fd–t_chk
 (
__d
);

25 
	$__fd–t_w¬n
 (
__d
)

26 
	`__w¬Ç‰r
 ("bit outside of fd_set selected");

27 #undeà
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__ex‹nsiÚ__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__butš_cÚ¡ªt_p
 (
__d
) \

32 ? (0 <ğ
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fd–t_w¬n
 (
__d
)) \

35 : 
	`__fd–t_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/sigaction.h

19 #iâdeà
_SIGNAL_H


24 
	ssigaùiÚ


27 #ifdeà
__USE_POSIX199309


31 
__sighªdËr_t
 
	m§_hªdËr
;

33 (*
	m§_sigaùiÚ
è(, 
	msigšfo_t
 *, *);

35 
	m__sigaùiÚ_hªdËr
;

36 
	#§_hªdËr
 
__sigaùiÚ_hªdËr
.
§_hªdËr


	)

37 
	#§_sigaùiÚ
 
__sigaùiÚ_hªdËr
.
§_sigaùiÚ


	)

39 
__sighªdËr_t
 
	m§_hªdËr
;

43 
__sig£t_t
 
	m§_mask
;

46 
	m§_æags
;

49 (*
	m§_»¡Ü”
) ();

53 
	#SA_NOCLDSTOP
 1

	)

54 
	#SA_NOCLDWAIT
 2

	)

55 
	#SA_SIGINFO
 4

	)

57 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_MISC


58 
	#SA_ONSTACK
 0x08000000

	)

60 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN2K8


61 
	#SA_RESTART
 0x10000000

	)

62 
	#SA_NODEFER
 0x40000000

	)

64 
	#SA_RESETHAND
 0x80000000

	)

66 #ifdeà
__USE_MISC


67 
	#SA_INTERRUPT
 0x20000000

	)

70 
	#SA_NOMASK
 
SA_NODEFER


	)

71 
	#SA_ONESHOT
 
SA_RESETHAND


	)

72 
	#SA_STACK
 
SA_ONSTACK


	)

76 
	#SIG_BLOCK
 0

	)

77 
	#SIG_UNBLOCK
 1

	)

78 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

18 #iâdeà
_BITS_SIGCONTEXT_H


19 
	#_BITS_SIGCONTEXT_H
 1

	)

21 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


25 
	#FP_XSTATE_MAGIC1
 0x46505853U

	)

26 
	#FP_XSTATE_MAGIC2
 0x46505845U

	)

27 
	#FP_XSTATE_MAGIC2_SIZE
 (
FP_XSTATE_MAGIC2
)

	)

29 
	s_åx_sw_by‹s


31 
__ušt32_t
 
	mmagic1
;

32 
__ušt32_t
 
	mex‹nded_size
;

33 
__ušt64_t
 
	mx¡©e_bv
;

34 
__ušt32_t
 
	mx¡©e_size
;

35 
__ušt32_t
 
	m·ddšg
[7];

38 
	s_å»g


40 
	msignifiÿnd
[4];

41 
	mexpÚ’t
;

44 
	s_åx»g


46 
	msignifiÿnd
[4];

47 
	mexpÚ’t
;

48 
	m·ddšg
[3];

51 
	s_xmm»g


53 
__ušt32_t
 
	m–em’t
[4];

58 #iâdeà
__x86_64__


60 
	s_å¡©e


63 
__ušt32_t
 
	mcw
;

64 
__ušt32_t
 
	msw
;

65 
__ušt32_t
 
	mg
;

66 
__ušt32_t
 
	moff
;

67 
__ušt32_t
 
	mcs£l
;

68 
__ušt32_t
 
	md©aoff
;

69 
__ušt32_t
 
	md©a£l
;

70 
_å»g
 
	m_¡
[8];

71 
	m¡©us
;

72 
	mmagic
;

75 
__ušt32_t
 
	m_fx¤_’v
[6];

76 
__ušt32_t
 
	mmxc¤
;

77 
__ušt32_t
 
	m»£rved
;

78 
_åx»g
 
	m_fx¤_¡
[8];

79 
_xmm»g
 
	m_xmm
[8];

80 
__ušt32_t
 
	m·ddšg
[56];

83 #iâdeà
sigcÚ‹xt_¡ruù


88 
	#sigcÚ‹xt_¡ruù
 
sigcÚ‹xt


	)

91 
	#X86_FXSR_MAGIC
 0x0000

	)

93 
	ssigcÚ‹xt


95 
	mgs
, 
	m__gsh
;

96 
	mfs
, 
	m__fsh
;

97 
	mes
, 
	m__esh
;

98 
	mds
, 
	m__dsh
;

99 
	medi
;

100 
	mesi
;

101 
	mebp
;

102 
	me¥
;

103 
	mebx
;

104 
	medx
;

105 
	mecx
;

106 
	m—x
;

107 
	mŒ­no
;

108 
	m”r
;

109 
	me
;

110 
	mcs
, 
	m__csh
;

111 
	meæags
;

112 
	me¥_©_sigÇl
;

113 
	mss
, 
	m__ssh
;

114 
_å¡©e
 * 
	må¡©e
;

115 
	mŞdmask
;

116 
	mü2
;

121 
	s_å¡©e


124 
__ušt16_t
 
	mcwd
;

125 
__ušt16_t
 
	mswd
;

126 
__ušt16_t
 
	máw
;

127 
__ušt16_t
 
	mfİ
;

128 
__ušt64_t
 
	mr
;

129 
__ušt64_t
 
	mrdp
;

130 
__ušt32_t
 
	mmxc¤
;

131 
__ušt32_t
 
	mmxü_mask
;

132 
_åx»g
 
	m_¡
[8];

133 
_xmm»g
 
	m_xmm
[16];

134 
__ušt32_t
 
	m·ddšg
[24];

137 
	ssigcÚ‹xt


139 
__ušt64_t
 
	mr8
;

140 
__ušt64_t
 
	mr9
;

141 
__ušt64_t
 
	mr10
;

142 
__ušt64_t
 
	mr11
;

143 
__ušt64_t
 
	mr12
;

144 
__ušt64_t
 
	mr13
;

145 
__ušt64_t
 
	mr14
;

146 
__ušt64_t
 
	mr15
;

147 
__ušt64_t
 
	mrdi
;

148 
__ušt64_t
 
	mrsi
;

149 
__ušt64_t
 
	mrbp
;

150 
__ušt64_t
 
	mrbx
;

151 
__ušt64_t
 
	mrdx
;

152 
__ušt64_t
 
	m¿x
;

153 
__ušt64_t
 
	mrcx
;

154 
__ušt64_t
 
	mr¥
;

155 
__ušt64_t
 
	mr
;

156 
__ušt64_t
 
	meæags
;

157 
	mcs
;

158 
	mgs
;

159 
	mfs
;

160 
	m__·d0
;

161 
__ušt64_t
 
	m”r
;

162 
__ušt64_t
 
	mŒ­no
;

163 
__ušt64_t
 
	mŞdmask
;

164 
__ušt64_t
 
	mü2
;

165 
__ex‹nsiÚ__
 union

167 
_å¡©e
 * 
	må¡©e
;

168 
__ušt64_t
 
	m__å¡©e_wÜd
;

170 
__ušt64_t
 
	m__»£rved1
 [8];

175 
	s_x§ve_hdr


177 
__ušt64_t
 
	mx¡©e_bv
;

178 
__ušt64_t
 
	m»£rved1
[2];

179 
__ušt64_t
 
	m»£rved2
[5];

182 
	s_ymmh_¡©e


184 
__ušt32_t
 
	mymmh_¥aû
[64];

187 
	s_x¡©e


189 
_å¡©e
 
	må¡©e
;

190 
_x§ve_hdr
 
	mx¡©e_hdr
;

191 
_ymmh_¡©e
 
	mymmh
;

	@/usr/include/bits/siginfo.h

19 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
__Ãed_sigšfo_t
 \

20 && !
defšed
 
	g__Ãed_sigev’t_t


24 
	~<b™s/wÜdsize.h
>

26 #ià(!
defšed
 
__have_sigv®_t
 \

27 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
 \

28 || 
defšed
 
	g__Ãed_sigev’t_t
))

29 
	#__have_sigv®_t
 1

	)

32 
	usigv®


34 
	msiv®_št
;

35 *
	msiv®_±r
;

36 } 
	tsigv®_t
;

39 #ià(!
defšed
 
__have_sigšfo_t
 \

40 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
))

41 
	#__have_sigšfo_t
 1

	)

43 
	#__SI_MAX_SIZE
 128

	)

44 #ià
__WORDSIZE
 == 64

45 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 4)

	)

47 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 3)

	)

50 #ià
defšed
 
__x86_64__
 && 
__WORDSIZE
 == 32

55 
__şock_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
 (4))è
	t__sigchld_şock_t
;

56 
	#__SI_ALIGNMENT
 
	`__©Œibu‹__
 ((
	`__®igÃd__
 (8)))

	)

58 
__şock_t
 
	t__sigchld_şock_t
;

59 
	#__SI_ALIGNMENT


	)

64 
si_signo
;

65 
si_”ºo
;

67 
si_code
;

71 
_·d
[
__SI_PAD_SIZE
];

76 
__pid_t
 
si_pid
;

77 
__uid_t
 
si_uid
;

78 } 
_kl
;

83 
si_tid
;

84 
si_ov”run
;

85 
sigv®_t
 
si_sigv®
;

86 } 
_tim”
;

91 
__pid_t
 
si_pid
;

92 
__uid_t
 
si_uid
;

93 
sigv®_t
 
si_sigv®
;

94 } 
_¹
;

99 
__pid_t
 
si_pid
;

100 
__uid_t
 
si_uid
;

101 
si_¡©us
;

102 
__sigchld_şock_t
 
si_utime
;

103 
__sigchld_şock_t
 
si_¡ime
;

104 } 
_sigchld
;

109 *
si_addr
;

110 
si_addr_lsb
;

111 } 
_sigçuÉ
;

116 
si_bªd
;

117 
si_fd
;

118 } 
_sigpŞl
;

123 *
_ÿÎ_addr
;

124 
_sysÿÎ
;

125 
_¬ch
;

126 } 
_sigsys
;

127 } 
_sif›lds
;

128 } 
	tsigšfo_t
 
	t__SI_ALIGNMENT
;

132 
	#si_pid
 
_sif›lds
.
_kl
.
si_pid


	)

133 
	#si_uid
 
_sif›lds
.
_kl
.
si_uid


	)

134 
	#si_tim”id
 
_sif›lds
.
_tim”
.
si_tid


	)

135 
	#si_ov”run
 
_sif›lds
.
_tim”
.
si_ov”run


	)

136 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
si_¡©us


	)

137 
	#si_utime
 
_sif›lds
.
_sigchld
.
si_utime


	)

138 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
si_¡ime


	)

139 
	#si_v®ue
 
_sif›lds
.
_¹
.
si_sigv®


	)

140 
	#si_št
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_št


	)

141 
	#si_±r
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_±r


	)

142 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
si_addr


	)

143 
	#si_addr_lsb
 
_sif›lds
.
_sigçuÉ
.
si_addr_lsb


	)

144 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
si_bªd


	)

145 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
si_fd


	)

146 
	#si_ÿÎ_addr
 
_sif›lds
.
_sigsys
.
_ÿÎ_addr


	)

147 
	#si_sysÿÎ
 
_sif›lds
.
_sigsys
.
_sysÿÎ


	)

148 
	#si_¬ch
 
_sif›lds
.
_sigsys
.
_¬ch


	)

155 
SI_ASYNCNL
 = -60,

156 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

157 
SI_TKILL
 = -6,

158 
	#SI_TKILL
 
SI_TKILL


	)

159 
SI_SIGIO
,

160 
	#SI_SIGIO
 
SI_SIGIO


	)

161 
SI_ASYNCIO
,

162 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

163 
SI_MESGQ
,

164 
	#SI_MESGQ
 
SI_MESGQ


	)

165 
SI_TIMER
,

166 
	#SI_TIMER
 
SI_TIMER


	)

167 
SI_QUEUE
,

168 
	#SI_QUEUE
 
SI_QUEUE


	)

169 
SI_USER
,

170 
	#SI_USER
 
SI_USER


	)

171 
SI_KERNEL
 = 0x80

172 
	#SI_KERNEL
 
SI_KERNEL


	)

179 
ILL_ILLOPC
 = 1,

180 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

181 
ILL_ILLOPN
,

182 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

183 
ILL_ILLADR
,

184 
	#ILL_ILLADR
 
ILL_ILLADR


	)

185 
ILL_ILLTRP
,

186 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

187 
ILL_PRVOPC
,

188 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

189 
ILL_PRVREG
,

190 
	#ILL_PRVREG
 
ILL_PRVREG


	)

191 
ILL_COPROC
,

192 
	#ILL_COPROC
 
ILL_COPROC


	)

193 
ILL_BADSTK


194 
	#ILL_BADSTK
 
ILL_BADSTK


	)

200 
FPE_INTDIV
 = 1,

201 
	#FPE_INTDIV
 
FPE_INTDIV


	)

202 
FPE_INTOVF
,

203 
	#FPE_INTOVF
 
FPE_INTOVF


	)

204 
FPE_FLTDIV
,

205 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

206 
FPE_FLTOVF
,

207 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

208 
FPE_FLTUND
,

209 
	#FPE_FLTUND
 
FPE_FLTUND


	)

210 
FPE_FLTRES
,

211 
	#FPE_FLTRES
 
FPE_FLTRES


	)

212 
FPE_FLTINV
,

213 
	#FPE_FLTINV
 
FPE_FLTINV


	)

214 
FPE_FLTSUB


215 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

221 
SEGV_MAPERR
 = 1,

222 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

223 
SEGV_ACCERR


224 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

230 
BUS_ADRALN
 = 1,

231 
	#BUS_ADRALN
 
BUS_ADRALN


	)

232 
BUS_ADRERR
,

233 
	#BUS_ADRERR
 
BUS_ADRERR


	)

234 
BUS_OBJERR
,

235 
	#BUS_OBJERR
 
BUS_OBJERR


	)

236 
BUS_MCEERR_AR
,

237 
	#BUS_MCEERR_AR
 
BUS_MCEERR_AR


	)

238 
BUS_MCEERR_AO


239 
	#BUS_MCEERR_AO
 
BUS_MCEERR_AO


	)

245 
TRAP_BRKPT
 = 1,

246 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

247 
TRAP_TRACE


248 
	#TRAP_TRACE
 
TRAP_TRACE


	)

254 
CLD_EXITED
 = 1,

255 
	#CLD_EXITED
 
CLD_EXITED


	)

256 
CLD_KILLED
,

257 
	#CLD_KILLED
 
CLD_KILLED


	)

258 
CLD_DUMPED
,

259 
	#CLD_DUMPED
 
CLD_DUMPED


	)

260 
CLD_TRAPPED
,

261 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

262 
CLD_STOPPED
,

263 
	#CLD_STOPPED
 
CLD_STOPPED


	)

264 
CLD_CONTINUED


265 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

271 
POLL_IN
 = 1,

272 
	#POLL_IN
 
POLL_IN


	)

273 
POLL_OUT
,

274 
	#POLL_OUT
 
POLL_OUT


	)

275 
POLL_MSG
,

276 
	#POLL_MSG
 
POLL_MSG


	)

277 
POLL_ERR
,

278 
	#POLL_ERR
 
POLL_ERR


	)

279 
POLL_PRI
,

280 
	#POLL_PRI
 
POLL_PRI


	)

281 
POLL_HUP


282 
	#POLL_HUP
 
POLL_HUP


	)

285 #undeà
__Ãed_sigšfo_t


289 #ià(
defšed
 
_SIGNAL_H
 || defšed 
__Ãed_sigev’t_t
) \

290 && !
defšed
 
__have_sigev’t_t


291 
	#__have_sigev’t_t
 1

	)

294 
	#__SIGEV_MAX_SIZE
 64

	)

295 #ià
__WORDSIZE
 == 64

296 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 4)

	)

298 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 3)

	)

302 #iâdeà
__have_±h»ad_©Œ_t


303 
±h»ad_©Œ_t
 
	t±h»ad_©Œ_t
;

304 
	#__have_±h»ad_©Œ_t
 1

	)

307 
	ssigev’t


309 
sigv®_t
 
sigev_v®ue
;

310 
sigev_signo
;

311 
sigev_nÙify
;

315 
_·d
[
__SIGEV_PAD_SIZE
];

319 
__pid_t
 
_tid
;

323 (*
_funùiÚ
è(
sigv®_t
);

324 
±h»ad_©Œ_t
 *
_©Œibu‹
;

325 } 
_sigev_th»ad
;

326 } 
_sigev_un
;

327 } 
	tsigev’t_t
;

330 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

331 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

336 
SIGEV_SIGNAL
 = 0,

337 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

338 
SIGEV_NONE
,

339 
	#SIGEV_NONE
 
SIGEV_NONE


	)

340 
SIGEV_THREAD
,

341 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

343 
SIGEV_THREAD_ID
 = 4

344 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

19 #ifdef 
_SIGNAL_H


22 
	#SIG_ERR
 ((
__sighªdËr_t
è-1è

	)

23 
	#SIG_DFL
 ((
__sighªdËr_t
è0è

	)

24 
	#SIG_IGN
 ((
__sighªdËr_t
è1è

	)

26 #ifdeà
__USE_UNIX98


27 
	#SIG_HOLD
 ((
__sighªdËr_t
è2è

	)

32 
	#SIGHUP
 1

	)

33 
	#SIGINT
 2

	)

34 
	#SIGQUIT
 3

	)

35 
	#SIGILL
 4

	)

36 
	#SIGTRAP
 5

	)

37 
	#SIGABRT
 6

	)

38 
	#SIGIOT
 6

	)

39 
	#SIGBUS
 7

	)

40 
	#SIGFPE
 8

	)

41 
	#SIGKILL
 9

	)

42 
	#SIGUSR1
 10

	)

43 
	#SIGSEGV
 11

	)

44 
	#SIGUSR2
 12

	)

45 
	#SIGPIPE
 13

	)

46 
	#SIGALRM
 14

	)

47 
	#SIGTERM
 15

	)

48 
	#SIGSTKFLT
 16

	)

49 
	#SIGCLD
 
SIGCHLD


	)

50 
	#SIGCHLD
 17

	)

51 
	#SIGCONT
 18

	)

52 
	#SIGSTOP
 19

	)

53 
	#SIGTSTP
 20

	)

54 
	#SIGTTIN
 21

	)

55 
	#SIGTTOU
 22

	)

56 
	#SIGURG
 23

	)

57 
	#SIGXCPU
 24

	)

58 
	#SIGXFSZ
 25

	)

59 
	#SIGVTALRM
 26

	)

60 
	#SIGPROF
 27

	)

61 
	#SIGWINCH
 28

	)

62 
	#SIGPOLL
 
SIGIO


	)

63 
	#SIGIO
 29

	)

64 
	#SIGPWR
 30

	)

65 
	#SIGSYS
 31

	)

66 
	#SIGUNUSED
 31

	)

68 
	#_NSIG
 65

	)

71 
	#SIGRTMIN
 (
	`__libc_cu¼’t_sig¹mš
 ())

	)

72 
	#SIGRTMAX
 (
	`__libc_cu¼’t_sig¹max
 ())

	)

76 
	#__SIGRTMIN
 32

	)

77 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigset.h

19 #iâdef 
_SIGSET_H_ty³s


20 
	#_SIGSET_H_ty³s
 1

	)

22 
	t__sig_©omic_t
;

26 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

29 
	m__v®
[
_SIGSET_NWORDS
];

30 } 
	t__sig£t_t
;

41 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


42 
	#_SIGSET_H_âs
 1

	)

44 #iâdeà
_EXTERN_INLINE


45 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

49 
	#__sigmask
(
sig
) \

50 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

53 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

55 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

56 
	#__sigem±y£t
(
£t
) \

57 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

58 
sig£t_t
 *
__£t
 = (
£t
); \

59 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

60 0; }))

	)

61 
	#__sigfl£t
(
£t
) \

62 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

63 
sig£t_t
 *
__£t
 = (
£t
); \

64 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

65 0; }))

	)

67 #ifdeà
__USE_GNU


71 
	#__sigi£m±y£t
(
£t
) \

72 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

73 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

74 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

75 !
__»t
 && --
__út
 >= 0) \

76 
__»t
 = 
__£t
->
__v®
[
__út
]; \

77 
__»t
 =ğ0; }))

	)

78 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

79 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

80 
sig£t_t
 *
__de¡
 = (
de¡
); \

81 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

82 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

83 --
__út
 >= 0) \

84 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

85 & 
__right
->
__v®
[
__út
]); \

86 0; }))

	)

87 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

88 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

89 
sig£t_t
 *
__de¡
 = (
de¡
); \

90 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

91 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

92 --
__út
 >= 0) \

93 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

94 | 
__right
->
__v®
[
__út
]); \

95 0; }))

	)

102 
__sigismemb”
 (cÚ¡ 
__sig£t_t
 *, );

103 
__sigadd£t
 (
__sig£t_t
 *, );

104 
__sigd–£t
 (
__sig£t_t
 *, );

106 #ifdeà
__USE_EXTERN_INLINES


107 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

108 
_EXTERN_INLINE
 \

109 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

111 
__mask
 = 
	`__sigmask
 (
__sig
); \

112 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

113  
BODY
; \

114 }

	)

116 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
) ? 1 : 0, const)

117 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

118 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

120 #undeà
__SIGSETFN


	@/usr/include/bits/sigstack.h

19 #iâdeà
_SIGNAL_H


25 
	ssig¡ack


27 *
	mss_¥
;

28 
	mss_Ú¡ack
;

35 
	mSS_ONSTACK
 = 1,

36 
	#SS_ONSTACK
 
SS_ONSTACK


	)

37 
	mSS_DISABLE


38 
	#SS_DISABLE
 
SS_DISABLE


	)

42 
	#MINSIGSTKSZ
 2048

	)

45 
	#SIGSTKSZ
 8192

	)

49 
	ssig®t¡ack


51 *
	mss_¥
;

52 
	mss_æags
;

53 
size_t
 
	mss_size
;

54 } 
	t¡ack_t
;

	@/usr/include/bits/sigthread.h

19 #iâdeà
_BITS_SIGTHREAD_H


20 
	#_BITS_SIGTHREAD_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_PTHREAD_H


30 
	$±h»ad_sigmask
 (
__how
,

31 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__Ãwmask
,

32 
__sig£t_t
 *
__»¡riù
 
__Şdmask
)
__THROW
;

35 
	$±h»ad_kl
 (
±h»ad_t
 
__th»adid
, 
__signo
è
__THROW
;

37 #ifdeà
__USE_GNU


39 
	$±h»ad_sigqueue
 (
±h»ad_t
 
__th»adid
, 
__signo
,

40 cÚ¡ 
sigv®
 
__v®ue
è
__THROW
;

	@/usr/include/bits/sockaddr.h

23 #iâdeà
_BITS_SOCKADDR_H


24 
	#_BITS_SOCKADDR_H
 1

	)

28 
	t§_çmy_t
;

34 
	#__SOCKADDR_COMMON
(
§_´efix
) \

35 
§_çmy_t
 
§_´efix
##
çmy


	)

37 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

	@/usr/include/bits/socket.h

19 #iâdeà
__BITS_SOCKET_H


20 
	#__BITS_SOCKET_H


	)

22 #iâdeà
_SYS_SOCKET_H


26 
	#__Ãed_size_t


	)

27 
	~<¡ddef.h
>

29 
	~<sys/ty³s.h
>

32 #iâdeà
__sockËn_t_defšed


33 
__sockËn_t
 
	tsockËn_t
;

34 
	#__sockËn_t_defšed


	)

38 
	~<b™s/sock‘_ty³.h
>

41 
	#PF_UNSPEC
 0

	)

42 
	#PF_LOCAL
 1

	)

43 
	#PF_UNIX
 
PF_LOCAL


	)

44 
	#PF_FILE
 
PF_LOCAL


	)

45 
	#PF_INET
 2

	)

46 
	#PF_AX25
 3

	)

47 
	#PF_IPX
 4

	)

48 
	#PF_APPLETALK
 5

	)

49 
	#PF_NETROM
 6

	)

50 
	#PF_BRIDGE
 7

	)

51 
	#PF_ATMPVC
 8

	)

52 
	#PF_X25
 9

	)

53 
	#PF_INET6
 10

	)

54 
	#PF_ROSE
 11

	)

55 
	#PF_DECÃt
 12

	)

56 
	#PF_NETBEUI
 13

	)

57 
	#PF_SECURITY
 14

	)

58 
	#PF_KEY
 15

	)

59 
	#PF_NETLINK
 16

	)

60 
	#PF_ROUTE
 
PF_NETLINK


	)

61 
	#PF_PACKET
 17

	)

62 
	#PF_ASH
 18

	)

63 
	#PF_ECONET
 19

	)

64 
	#PF_ATMSVC
 20

	)

65 
	#PF_RDS
 21

	)

66 
	#PF_SNA
 22

	)

67 
	#PF_IRDA
 23

	)

68 
	#PF_PPPOX
 24

	)

69 
	#PF_WANPIPE
 25

	)

70 
	#PF_LLC
 26

	)

71 
	#PF_CAN
 29

	)

72 
	#PF_TIPC
 30

	)

73 
	#PF_BLUETOOTH
 31

	)

74 
	#PF_IUCV
 32

	)

75 
	#PF_RXRPC
 33

	)

76 
	#PF_ISDN
 34

	)

77 
	#PF_PHONET
 35

	)

78 
	#PF_IEEE802154
 36

	)

79 
	#PF_CAIF
 37

	)

80 
	#PF_ALG
 38

	)

81 
	#PF_NFC
 39

	)

82 
	#PF_VSOCK
 40

	)

83 
	#PF_MAX
 41

	)

86 
	#AF_UNSPEC
 
PF_UNSPEC


	)

87 
	#AF_LOCAL
 
PF_LOCAL


	)

88 
	#AF_UNIX
 
PF_UNIX


	)

89 
	#AF_FILE
 
PF_FILE


	)

90 
	#AF_INET
 
PF_INET


	)

91 
	#AF_AX25
 
PF_AX25


	)

92 
	#AF_IPX
 
PF_IPX


	)

93 
	#AF_APPLETALK
 
PF_APPLETALK


	)

94 
	#AF_NETROM
 
PF_NETROM


	)

95 
	#AF_BRIDGE
 
PF_BRIDGE


	)

96 
	#AF_ATMPVC
 
PF_ATMPVC


	)

97 
	#AF_X25
 
PF_X25


	)

98 
	#AF_INET6
 
PF_INET6


	)

99 
	#AF_ROSE
 
PF_ROSE


	)

100 
	#AF_DECÃt
 
PF_DECÃt


	)

101 
	#AF_NETBEUI
 
PF_NETBEUI


	)

102 
	#AF_SECURITY
 
PF_SECURITY


	)

103 
	#AF_KEY
 
PF_KEY


	)

104 
	#AF_NETLINK
 
PF_NETLINK


	)

105 
	#AF_ROUTE
 
PF_ROUTE


	)

106 
	#AF_PACKET
 
PF_PACKET


	)

107 
	#AF_ASH
 
PF_ASH


	)

108 
	#AF_ECONET
 
PF_ECONET


	)

109 
	#AF_ATMSVC
 
PF_ATMSVC


	)

110 
	#AF_RDS
 
PF_RDS


	)

111 
	#AF_SNA
 
PF_SNA


	)

112 
	#AF_IRDA
 
PF_IRDA


	)

113 
	#AF_PPPOX
 
PF_PPPOX


	)

114 
	#AF_WANPIPE
 
PF_WANPIPE


	)

115 
	#AF_LLC
 
PF_LLC


	)

116 
	#AF_CAN
 
PF_CAN


	)

117 
	#AF_TIPC
 
PF_TIPC


	)

118 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

119 
	#AF_IUCV
 
PF_IUCV


	)

120 
	#AF_RXRPC
 
PF_RXRPC


	)

121 
	#AF_ISDN
 
PF_ISDN


	)

122 
	#AF_PHONET
 
PF_PHONET


	)

123 
	#AF_IEEE802154
 
PF_IEEE802154


	)

124 
	#AF_CAIF
 
PF_CAIF


	)

125 
	#AF_ALG
 
PF_ALG


	)

126 
	#AF_NFC
 
PF_NFC


	)

127 
	#AF_VSOCK
 
PF_VSOCK


	)

128 
	#AF_MAX
 
PF_MAX


	)

134 
	#SOL_RAW
 255

	)

135 
	#SOL_DECNET
 261

	)

136 
	#SOL_X25
 262

	)

137 
	#SOL_PACKET
 263

	)

138 
	#SOL_ATM
 264

	)

139 
	#SOL_AAL
 265

	)

140 
	#SOL_IRDA
 266

	)

143 
	#SOMAXCONN
 128

	)

146 
	~<b™s/sockaddr.h
>

149 
	ssockaddr


151 
__SOCKADDR_COMMON
 (
§_
);

152 
	m§_d©a
[14];

158 
	#__ss_®igÁy³
 

	)

159 
	#_SS_SIZE
 128

	)

160 
	#_SS_PADSIZE
 (
_SS_SIZE
 - (2 *  (
__ss_®igÁy³
)))

	)

162 
	ssockaddr_¡Üage


164 
__SOCKADDR_COMMON
 (
ss_
);

165 
__ss_®igÁy³
 
	m__ss_®ign
;

166 
	m__ss_·ddšg
[
_SS_PADSIZE
];

173 
	mMSG_OOB
 = 0x01,

174 
	#MSG_OOB
 
MSG_OOB


	)

175 
	mMSG_PEEK
 = 0x02,

176 
	#MSG_PEEK
 
MSG_PEEK


	)

177 
	mMSG_DONTROUTE
 = 0x04,

178 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

179 #ifdeà
__USE_GNU


181 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

182 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

184 
	mMSG_CTRUNC
 = 0x08,

185 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

186 
	mMSG_PROXY
 = 0x10,

187 
	#MSG_PROXY
 
MSG_PROXY


	)

188 
	mMSG_TRUNC
 = 0x20,

189 
	#MSG_TRUNC
 
MSG_TRUNC


	)

190 
	mMSG_DONTWAIT
 = 0x40,

191 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

192 
	mMSG_EOR
 = 0x80,

193 
	#MSG_EOR
 
MSG_EOR


	)

194 
	mMSG_WAITALL
 = 0x100,

195 
	#MSG_WAITALL
 
MSG_WAITALL


	)

196 
	mMSG_FIN
 = 0x200,

197 
	#MSG_FIN
 
MSG_FIN


	)

198 
	mMSG_SYN
 = 0x400,

199 
	#MSG_SYN
 
MSG_SYN


	)

200 
	mMSG_CONFIRM
 = 0x800,

201 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

202 
	mMSG_RST
 = 0x1000,

203 
	#MSG_RST
 
MSG_RST


	)

204 
	mMSG_ERRQUEUE
 = 0x2000,

205 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

206 
	mMSG_NOSIGNAL
 = 0x4000,

207 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

208 
	mMSG_MORE
 = 0x8000,

209 
	#MSG_MORE
 
MSG_MORE


	)

210 
	mMSG_WAITFORONE
 = 0x10000,

211 
	#MSG_WAITFORONE
 
MSG_WAITFORONE


	)

212 
	mMSG_FASTOPEN
 = 0x20000000,

213 
	#MSG_FASTOPEN
 
MSG_FASTOPEN


	)

215 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

218 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

224 
	smsghdr


226 *
	mmsg_Çme
;

227 
sockËn_t
 
	mmsg_Çm–’
;

229 
iovec
 *
	mmsg_iov
;

230 
size_t
 
	mmsg_iovËn
;

232 *
	mmsg_cÚŒŞ
;

233 
size_t
 
	mmsg_cÚŒŞËn
;

238 
	mmsg_æags
;

242 
	scmsghdr


244 
size_t
 
	mcmsg_Ën
;

249 
	mcmsg_Ëv–
;

250 
	mcmsg_ty³
;

251 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

252 
__ex‹nsiÚ__
 
__cmsg_d©a
 
	m__æex¬r
;

257 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

258 
	#CMSG_DATA
(
cmsg
è((cmsg)->
__cmsg_d©a
)

	)

260 
	#CMSG_DATA
(
cmsg
è((*è((
cmsghdr
 *è(cmsgè+ 1))

	)

262 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

263 
	#CMSG_FIRSTHDR
(
mhdr
) \

264 ((
size_t
è(
mhdr
)->
msg_cÚŒŞËn
 >ğ (
cmsghdr
) \

265 ? (
cmsghdr
 *è(
mhdr
)->
msg_cÚŒŞ
 : (cmsghd¸*è0)

	)

266 
	#CMSG_ALIGN
(
Ën
è((Ö’è+  (
size_t
) - 1) \

267 & (
size_t
è~( (size_tè- 1))

	)

268 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
 (len) \

269 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

270 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
 ( (
cmsghdr
)è+ (Ën))

	)

272 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

273 
cmsghdr
 *
__cmsg
è
__THROW
;

274 #ifdeà
__USE_EXTERN_INLINES


275 #iâdeà
_EXTERN_INLINE


276 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

278 
_EXTERN_INLINE
 
cmsghdr
 *

279 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

281 ià((
size_t
è
__cmsg
->
cmsg_Ën
 <  (
cmsghdr
))

283  (
cmsghdr
 *) 0;

285 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

286 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Ën
));

287 ià((*è(
__cmsg
 + 1è> ((*è
__mhdr
->
msg_cÚŒŞ


288 + 
__mhdr
->
msg_cÚŒŞËn
)

289 || ((*è
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Ën
)

290 > ((*è
__mhdr
->
msg_cÚŒŞ
 + __mhdr->
msg_cÚŒŞËn
)))

292  (
cmsghdr
 *) 0;

293  
__cmsg
;

294 
	}
}

301 
	mSCM_RIGHTS
 = 0x01

302 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

303 #ifdeà
__USE_GNU


304 , 
	mSCM_CREDENTIALS
 = 0x02

305 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

309 #ifdeà
__USE_GNU


311 
	suüed


313 
pid_t
 
	mpid
;

314 
uid_t
 
	muid
;

315 
gid_t
 
	mgid
;

320 #ià!
defšed
 
__USE_MISC
 && !defšed 
__USE_GNU


321 #iâdeà
FIOGETOWN


322 
	#__SYS_SOCKET_H_undef_FIOGETOWN


	)

324 #iâdeà
FIOSETOWN


325 
	#__SYS_SOCKET_H_undef_FIOSETOWN


	)

327 #iâdeà
SIOCATMARK


328 
	#__SYS_SOCKET_H_undef_SIOCATMARK


	)

330 #iâdeà
SIOCGPGRP


331 
	#__SYS_SOCKET_H_undef_SIOCGPGRP


	)

333 #iâdeà
SIOCGSTAMP


334 
	#__SYS_SOCKET_H_undef_SIOCGSTAMP


	)

336 #iâdeà
SIOCGSTAMPNS


337 
	#__SYS_SOCKET_H_undef_SIOCGSTAMPNS


	)

339 #iâdeà
SIOCSPGRP


340 
	#__SYS_SOCKET_H_undef_SIOCSPGRP


	)

345 
	~<asm/sock‘.h
>

347 #ià!
defšed
 
__USE_MISC
 && !defšed 
__USE_GNU


348 #ifdeà
__SYS_SOCKET_H_undef_FIOGETOWN


349 #undeà
__SYS_SOCKET_H_undef_FIOGETOWN


350 #undeà
FIOGETOWN


352 #ifdeà
__SYS_SOCKET_H_undef_FIOSETOWN


353 #undeà
__SYS_SOCKET_H_undef_FIOSETOWN


354 #undeà
FIOSETOWN


356 #ifdeà
__SYS_SOCKET_H_undef_SIOCATMARK


357 #undeà
__SYS_SOCKET_H_undef_SIOCATMARK


358 #undeà
SIOCATMARK


360 #ifdeà
__SYS_SOCKET_H_undef_SIOCGPGRP


361 #undeà
__SYS_SOCKET_H_undef_SIOCGPGRP


362 #undeà
SIOCGPGRP


364 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


365 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


366 #undeà
SIOCGSTAMP


368 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


369 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


370 #undeà
SIOCGSTAMPNS


372 #ifdeà
__SYS_SOCKET_H_undef_SIOCSPGRP


373 #undeà
__SYS_SOCKET_H_undef_SIOCSPGRP


374 #undeà
SIOCSPGRP


379 
	slšg”


381 
	ml_Úoff
;

382 
	ml_lšg”
;

	@/usr/include/bits/socket2.h

19 #iâdeà
_SYS_SOCKET_H


23 
ssize_t
 
__»cv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

24 
__æags
);

25 
ssize_t
 
__REDIRECT
 (
__»cv_®Ÿs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

26 
__æags
), 
»cv
);

27 
ssize_t
 
__REDIRECT
 (
__»cv_chk_w¬n
,

28 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

29 
__æags
), 
__»cv_chk
)

30 
__w¬Ç‰r
 ("recv called with bigger†engthhan size of destination "

33 
__fÜtify_funùiÚ
 
ssize_t


34 
	$»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
)

36 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

38 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

39  
	`__»cv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

41 ià(
__n
 > 
	`__bos0
 (
__buf
))

42  
	`__»cv_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

44  
	`__»cv_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
);

45 
	}
}

47 
ssize_t
 
__»cväom_chk
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

48 
size_t
 
__buæ’
, 
__æags
,

49 
__SOCKADDR_ARG
 
__addr
,

50 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

51 
ssize_t
 
__REDIRECT
 (
__»cväom_®Ÿs
,

52 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

53 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

54 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
»cväom
);

55 
ssize_t
 
__REDIRECT
 (
__»cväom_chk_w¬n
,

56 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

57 
size_t
 
__buæ’
, 
__æags
,

58 
__SOCKADDR_ARG
 
__addr
,

59 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
__»cväom_chk
)

60 
__w¬Ç‰r
 ("recvfrom called with bigger†engthhan size of "

63 
__fÜtify_funùiÚ
 
ssize_t


64 
	$»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
, 
__æags
,

65 
__SOCKADDR_ARG
 
__addr
, 
sockËn_t
 *
__»¡riù
 
__addr_Ën
)

67 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

69 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

70  
	`__»cväom_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

71 
__addr
, 
__addr_Ën
);

72 ià(
__n
 > 
	`__bos0
 (
__buf
))

73  
	`__»cväom_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

74 
__addr
, 
__addr_Ën
);

76  
	`__»cväom_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
, 
__addr
, 
__addr_Ën
);

77 
	}
}

	@/usr/include/bits/stat.h

18 #ià!
defšed
 
_SYS_STAT_H
 && !defšed 
_FCNTL_H


22 #iâdeà
_BITS_STAT_H


23 
	#_BITS_STAT_H
 1

	)

26 #iâdeà
__x86_64__


27 
	#_STAT_VER_LINUX_OLD
 1

	)

28 
	#_STAT_VER_KERNEL
 1

	)

29 
	#_STAT_VER_SVR4
 2

	)

30 
	#_STAT_VER_LINUX
 3

	)

33 
	#_MKNOD_VER_LINUX
 1

	)

34 
	#_MKNOD_VER_SVR4
 2

	)

35 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

37 
	#_STAT_VER_KERNEL
 0

	)

38 
	#_STAT_VER_LINUX
 1

	)

41 
	#_MKNOD_VER_LINUX
 0

	)

44 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

46 
	s¡©


48 
__dev_t
 
	m¡_dev
;

49 #iâdeà
__x86_64__


50 
	m__·d1
;

52 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


53 
__šo_t
 
	m¡_šo
;

55 
__šo_t
 
	m__¡_šo
;

57 #iâdeà
__x86_64__


58 
__mode_t
 
	m¡_mode
;

59 
__Æšk_t
 
	m¡_Æšk
;

61 
__Æšk_t
 
	m¡_Æšk
;

62 
__mode_t
 
	m¡_mode
;

64 
__uid_t
 
	m¡_uid
;

65 
__gid_t
 
	m¡_gid
;

66 #ifdeà
__x86_64__


67 
	m__·d0
;

69 
__dev_t
 
	m¡_rdev
;

70 #iâdeà
__x86_64__


71 
	m__·d2
;

73 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


74 
__off_t
 
	m¡_size
;

76 
__off64_t
 
	m¡_size
;

78 
__blksize_t
 
	m¡_blksize
;

79 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


80 
__blkút_t
 
	m¡_blocks
;

82 
__blkút64_t
 
	m¡_blocks
;

84 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K8


91 
time¥ec
 
	m¡_©im
;

92 
time¥ec
 
	m¡_mtim
;

93 
time¥ec
 
	m¡_ùim
;

94 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

95 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

96 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

98 
__time_t
 
	m¡_©ime
;

99 
__sysÿÎ_ulÚg_t
 
	m¡_©im’£c
;

100 
__time_t
 
	m¡_mtime
;

101 
__sysÿÎ_ulÚg_t
 
	m¡_mtim’£c
;

102 
__time_t
 
	m¡_ùime
;

103 
__sysÿÎ_ulÚg_t
 
	m¡_ùim’£c
;

105 #ifdeà
__x86_64__


106 
__sysÿÎ_¦Úg_t
 
	m__glibc_»£rved
[3];

108 #iâdeà
__USE_FILE_OFFSET64


109 
	m__glibc_»£rved4
;

110 
	m__glibc_»£rved5
;

112 
__šo64_t
 
	m¡_šo
;

117 #ifdeà
__USE_LARGEFILE64


119 
	s¡©64


121 
__dev_t
 
	m¡_dev
;

122 #ifdeà
__x86_64__


123 
__šo64_t
 
	m¡_šo
;

124 
__Æšk_t
 
	m¡_Æšk
;

125 
__mode_t
 
	m¡_mode
;

127 
	m__·d1
;

128 
__šo_t
 
	m__¡_šo
;

129 
__mode_t
 
	m¡_mode
;

130 
__Æšk_t
 
	m¡_Æšk
;

132 
__uid_t
 
	m¡_uid
;

133 
__gid_t
 
	m¡_gid
;

134 #ifdeà
__x86_64__


135 
	m__·d0
;

136 
__dev_t
 
	m¡_rdev
;

137 
__off_t
 
	m¡_size
;

139 
__dev_t
 
	m¡_rdev
;

140 
	m__·d2
;

141 
__off64_t
 
	m¡_size
;

143 
__blksize_t
 
	m¡_blksize
;

144 
__blkút64_t
 
	m¡_blocks
;

145 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K8


152 
time¥ec
 
	m¡_©im
;

153 
time¥ec
 
	m¡_mtim
;

154 
time¥ec
 
	m¡_ùim
;

156 
__time_t
 
	m¡_©ime
;

157 
__sysÿÎ_ulÚg_t
 
	m¡_©im’£c
;

158 
__time_t
 
	m¡_mtime
;

159 
__sysÿÎ_ulÚg_t
 
	m¡_mtim’£c
;

160 
__time_t
 
	m¡_ùime
;

161 
__sysÿÎ_ulÚg_t
 
	m¡_ùim’£c
;

163 #ifdeà
__x86_64__


164 
__sysÿÎ_¦Úg_t
 
	m__glibc_»£rved
[3];

166 
__šo64_t
 
	m¡_šo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ifdeà
__USE_ATFILE


206 
	#UTIME_NOW
 ((1È<< 30è- 1l)

	)

207 
	#UTIME_OMIT
 ((1È<< 30è- 2l)

	)

	@/usr/include/bits/statfs.h

18 #iâdeà
_SYS_STATFS_H


22 
	~<b™s/ty³s.h
>

24 
	s¡©fs


26 
__fswÜd_t
 
	mf_ty³
;

27 
__fswÜd_t
 
	mf_bsize
;

28 #iâdeà
__USE_FILE_OFFSET64


29 
__fsblkút_t
 
	mf_blocks
;

30 
__fsblkút_t
 
	mf_bä“
;

31 
__fsblkút_t
 
	mf_bava
;

32 
__fsfút_t
 
	mf_fes
;

33 
__fsfút_t
 
	mf_fä“
;

35 
__fsblkút64_t
 
	mf_blocks
;

36 
__fsblkút64_t
 
	mf_bä“
;

37 
__fsblkút64_t
 
	mf_bava
;

38 
__fsfút64_t
 
	mf_fes
;

39 
__fsfút64_t
 
	mf_fä“
;

41 
__fsid_t
 
	mf_fsid
;

42 
__fswÜd_t
 
	mf_Çm–’
;

43 
__fswÜd_t
 
	mf_äsize
;

44 
__fswÜd_t
 
	mf_æags
;

45 
__fswÜd_t
 
	mf_¥¬e
[4];

48 #ifdeà
__USE_LARGEFILE64


49 
	s¡©fs64


51 
__fswÜd_t
 
	mf_ty³
;

52 
__fswÜd_t
 
	mf_bsize
;

53 
__fsblkút64_t
 
	mf_blocks
;

54 
__fsblkút64_t
 
	mf_bä“
;

55 
__fsblkút64_t
 
	mf_bava
;

56 
__fsfút64_t
 
	mf_fes
;

57 
__fsfút64_t
 
	mf_fä“
;

58 
__fsid_t
 
	mf_fsid
;

59 
__fswÜd_t
 
	mf_Çm–’
;

60 
__fswÜd_t
 
	mf_äsize
;

61 
__fswÜd_t
 
	mf_æags
;

62 
__fswÜd_t
 
	mf_¥¬e
[4];

67 
	#_STATFS_F_NAMELEN


	)

68 
	#_STATFS_F_FRSIZE


	)

69 
	#_STATFS_F_FLAGS


	)

	@/usr/include/bits/statvfs.h

18 #iâdeà
_SYS_STATVFS_H


22 
	~<b™s/ty³s.h
>

24 #ià(
__WORDSIZE
 == 32 \

25 && (!
defšed
 
	g__SYSCALL_WORDSIZE
 || __SYSCALL_WORDSIZE == 32))

26 
	#_STATVFSBUF_F_UNUSED


	)

29 
	s¡©vfs


31 
f_bsize
;

32 
	mf_äsize
;

33 #iâdeà
__USE_FILE_OFFSET64


34 
__fsblkút_t
 
	mf_blocks
;

35 
__fsblkút_t
 
	mf_bä“
;

36 
__fsblkút_t
 
	mf_bava
;

37 
__fsfút_t
 
	mf_fes
;

38 
__fsfút_t
 
	mf_fä“
;

39 
__fsfút_t
 
	mf_çva
;

41 
__fsblkút64_t
 
	mf_blocks
;

42 
__fsblkút64_t
 
	mf_bä“
;

43 
__fsblkút64_t
 
	mf_bava
;

44 
__fsfút64_t
 
	mf_fes
;

45 
__fsfút64_t
 
	mf_fä“
;

46 
__fsfút64_t
 
	mf_çva
;

48 
	mf_fsid
;

49 #ifdeà
_STATVFSBUF_F_UNUSED


50 
	m__f_unu£d
;

52 
	mf_æag
;

53 
	mf_Çmemax
;

54 
	m__f_¥¬e
[6];

57 #ifdeà
__USE_LARGEFILE64


58 
	s¡©vfs64


60 
	mf_bsize
;

61 
	mf_äsize
;

62 
__fsblkút64_t
 
	mf_blocks
;

63 
__fsblkút64_t
 
	mf_bä“
;

64 
__fsblkút64_t
 
	mf_bava
;

65 
__fsfút64_t
 
	mf_fes
;

66 
__fsfút64_t
 
	mf_fä“
;

67 
__fsfút64_t
 
	mf_çva
;

68 
	mf_fsid
;

69 #ifdeà
_STATVFSBUF_F_UNUSED


70 
	m__f_unu£d
;

72 
	mf_æag
;

73 
	mf_Çmemax
;

74 
	m__f_¥¬e
[6];

82 
	mST_RDONLY
 = 1,

83 
	#ST_RDONLY
 
ST_RDONLY


	)

84 
	mST_NOSUID
 = 2

85 
	#ST_NOSUID
 
ST_NOSUID


	)

86 #ifdeà
__USE_GNU


88 
	mST_NODEV
 = 4,

89 
	#ST_NODEV
 
ST_NODEV


	)

90 
	mST_NOEXEC
 = 8,

91 
	#ST_NOEXEC
 
ST_NOEXEC


	)

92 
	mST_SYNCHRONOUS
 = 16,

93 
	#ST_SYNCHRONOUS
 
ST_SYNCHRONOUS


	)

94 
	mST_MANDLOCK
 = 64,

95 
	#ST_MANDLOCK
 
ST_MANDLOCK


	)

96 
	mST_WRITE
 = 128,

97 
	#ST_WRITE
 
ST_WRITE


	)

98 
	mST_APPEND
 = 256,

99 
	#ST_APPEND
 
ST_APPEND


	)

100 
	mST_IMMUTABLE
 = 512,

101 
	#ST_IMMUTABLE
 
ST_IMMUTABLE


	)

102 
	mST_NOATIME
 = 1024,

103 
	#ST_NOATIME
 
ST_NOATIME


	)

104 
	mST_NODIRATIME
 = 2048,

105 
	#ST_NODIRATIME
 
ST_NODIRATIME


	)

106 
	mST_RELATIME
 = 4096

107 
	#ST_RELATIME
 
ST_RELATIME


	)

	@/usr/include/bits/stdio-ldbl.h

19 #iâdeà
_STDIO_H


23 
__BEGIN_NAMESPACE_STD


24 
	$__LDBL_REDIR_DECL
 (
årštf
)

25 
	$__LDBL_REDIR_DECL
 (
´štf
)

26 
	$__LDBL_REDIR_DECL
 (
¥rštf
)

27 
	$__LDBL_REDIR_DECL
 (
vårštf
)

28 
	$__LDBL_REDIR_DECL
 (
v´štf
)

29 
	$__LDBL_REDIR_DECL
 (
v¥rštf
)

30 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

31 && !
defšed
 
__REDIRECT
 \

32 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

33 
	$__LDBL_REDIR1_DECL
 (
fsÿnf
, 
__Ædbl___isoc99_fsÿnf
)

34 
	$__LDBL_REDIR1_DECL
 (
sÿnf
, 
__Ædbl___isoc99_sÿnf
)

35 
	$__LDBL_REDIR1_DECL
 (
ssÿnf
, 
__Ædbl___isoc99_ssÿnf
)

37 
	$__LDBL_REDIR_DECL
 (
fsÿnf
)

38 
	$__LDBL_REDIR_DECL
 (
sÿnf
)

39 
	$__LDBL_REDIR_DECL
 (
ssÿnf
)

41 
__END_NAMESPACE_STD


43 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


44 
__BEGIN_NAMESPACE_C99


45 
	$__LDBL_REDIR_DECL
 (
¢´štf
)

46 
	$__LDBL_REDIR_DECL
 (
v¢´štf
)

47 
__END_NAMESPACE_C99


50 #ifdef 
__USE_ISOC99


51 
__BEGIN_NAMESPACE_C99


52 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

53 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

54 
	$__LDBL_REDIR1_DECL
 (
vfsÿnf
, 
__Ædbl___isoc99_vfsÿnf
)

55 
	$__LDBL_REDIR1_DECL
 (
vsÿnf
, 
__Ædbl___isoc99_vsÿnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vssÿnf
, 
__Ædbl___isoc99_vssÿnf
)

58 
	$__LDBL_REDIR_DECL
 (
vfsÿnf
)

59 
	$__LDBL_REDIR_DECL
 (
vssÿnf
)

60 
	$__LDBL_REDIR_DECL
 (
vsÿnf
)

62 
__END_NAMESPACE_C99


65 #ifdeà
__USE_XOPEN2K8


66 
	$__LDBL_REDIR_DECL
 (
vd´štf
)

67 
	$__LDBL_REDIR_DECL
 (
d´štf
)

70 #ifdeà
__USE_GNU


71 
	$__LDBL_REDIR_DECL
 (
va¥rštf
)

72 
	$__LDBL_REDIR_DECL
 (
__a¥rštf
)

73 
	$__LDBL_REDIR_DECL
 (
a¥rštf
)

74 
	$__LDBL_REDIR_DECL
 (
ob¡ack_´štf
)

75 
	$__LDBL_REDIR_DECL
 (
ob¡ack_v´štf
)

78 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


79 
	$__LDBL_REDIR_DECL
 (
__¥rštf_chk
)

80 
	$__LDBL_REDIR_DECL
 (
__v¥rštf_chk
)

81 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


82 
	$__LDBL_REDIR_DECL
 (
__¢´štf_chk
)

83 
	$__LDBL_REDIR_DECL
 (
__v¢´štf_chk
)

85 #ià
__USE_FORTIFY_LEVEL
 > 1

86 
	$__LDBL_REDIR_DECL
 (
__årštf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__´štf_chk
)

88 
	$__LDBL_REDIR_DECL
 (
__vårštf_chk
)

89 
	$__LDBL_REDIR_DECL
 (
__v´štf_chk
)

90 #ifdeà
__USE_XOPEN2K8


91 
	$__LDBL_REDIR_DECL
 (
__d´štf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__vd´štf_chk
)

94 #ifdeà
__USE_GNU


95 
	$__LDBL_REDIR_DECL
 (
__a¥rštf_chk
)

96 
	$__LDBL_REDIR_DECL
 (
__va¥rštf_chk
)

97 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_´štf_chk
)

98 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_v´štf_chk
)

	@/usr/include/bits/stdio.h

19 #iâdeà
_STDIO_H


23 #iâdeà
__ex‹º_šlše


24 
	#__STDIO_INLINE
 
šlše


	)

26 
	#__STDIO_INLINE
 
__ex‹º_šlše


	)

30 #ifdeà
__USE_EXTERN_INLINES


33 #ià!(
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
)

35 
__STDIO_INLINE
 

36 
	$v´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

38  
	`vårštf
 (
¡dout
, 
__fmt
, 
__¬g
);

39 
	}
}

43 
__STDIO_INLINE
 

44 
	$g‘ch¬
 ()

46  
	`_IO_g‘c
 (
¡dš
);

47 
	}
}

50 #ifdeà
__USE_MISC


52 
__STDIO_INLINE
 

53 
	$fg‘c_uÆocked
 (
FILE
 *
__å
)

55  
	`_IO_g‘c_uÆocked
 (
__å
);

56 
	}
}

60 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


62 
__STDIO_INLINE
 

63 
	$g‘c_uÆocked
 (
FILE
 *
__å
)

65  
	`_IO_g‘c_uÆocked
 (
__å
);

66 
	}
}

69 
__STDIO_INLINE
 

70 
	$g‘ch¬_uÆocked
 ()

72  
	`_IO_g‘c_uÆocked
 (
¡dš
);

73 
	}
}

78 
__STDIO_INLINE
 

79 
	$putch¬
 (
__c
)

81  
	`_IO_putc
 (
__c
, 
¡dout
);

82 
	}
}

85 #ifdeà
__USE_MISC


87 
__STDIO_INLINE
 

88 
	$åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

90  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

91 
	}
}

95 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


97 
__STDIO_INLINE
 

98 
	$putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

100  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

101 
	}
}

104 
__STDIO_INLINE
 

105 
	$putch¬_uÆocked
 (
__c
)

107  
	`_IO_putc_uÆocked
 (
__c
, 
¡dout
);

108 
	}
}

112 #ifdef 
__USE_GNU


114 
__STDIO_INLINE
 
_IO_ssize_t


115 
	$g‘lše
 (**
__lš•Œ
, 
size_t
 *
__n
, 
FILE
 *
__¡»am
)

117  
	`__g‘d–im
 (
__lš•Œ
, 
__n
, '\n', 
__¡»am
);

118 
	}
}

122 #ifdeà
__USE_MISC


124 
__STDIO_INLINE
 

125 
__NTH
 (
	$ãof_uÆocked
 (
FILE
 *
__¡»am
))

127  
	`_IO_ãof_uÆocked
 (
__¡»am
);

128 
	}
}

131 
__STDIO_INLINE
 

132 
__NTH
 (
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
))

134  
	`_IO_ã¼Ü_uÆocked
 (
__¡»am
);

135 
	}
}

141 #ià
defšed
 
__USE_MISC
 && defšed 
__GNUC__
 && defšed 
__OPTIMIZE__
 \

142 && !
defšed
 
	g__ılu¥lus


144 
	#ä—d_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

145 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

146 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

147 && (
size_t
è(
size
) != 0) \

148 ? ({ *
__±r
 = (*è(
±r
); \

149 
FILE
 *
__¡»am
 = (
¡»am
); \

150 
size_t
 
__út
; \

151 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

152 
__út
 > 0; --__cnt) \

154 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
); \

155 ià(
__c
 =ğ
EOF
) \

157 *
__±r
++ = 
__c
; \

159 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

160 / (
size_t
è(
size
); }) \

161 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

162 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

164 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

165 (è(
n
), (
size_t
) 0) \

166 : 
	`ä—d_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

168 
	#fwr™e_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

169 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

170 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

171 && (
size_t
è(
size
) != 0) \

172 ? ({ cÚ¡ *
__±r
 = (cÚ¡ *è(
±r
); \

173 
FILE
 *
__¡»am
 = (
¡»am
); \

174 
size_t
 
__út
; \

175 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

176 
__út
 > 0; --__cnt) \

177 ià(
	`_IO_putc_uÆocked
 (*
__±r
++, 
__¡»am
è=ğ
EOF
) \

179 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

180 / (
size_t
è(
size
); }) \

181 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

182 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

184 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

185 (è(
n
), (
size_t
) 0) \

186 : 
	`fwr™e_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

190 #undeà
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

19 #iâdeà
_STDIO_H


23 
	$__¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

24 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

25 
	$__v¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

26 cÚ¡ *
__»¡riù
 
__fÜm©
,

27 
_G_va_li¡
 
__­
è
__THROW
;

29 #ifdeà
__va_¬g_·ck


30 
__fÜtify_funùiÚ
 

31 
	`__NTH
 (
	$¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fmt
, ...))

33  
	`__butš___¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

34 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

35 
	}
}

36 #–ià!
defšed
 
__ılu¥lus


37 
	#¥rštf
(
¡r
, ...) \

38 
	`__butš___¥rštf_chk
 (
¡r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

39 
__VA_ARGS__
)

	)

42 
__fÜtify_funùiÚ
 

43 
__NTH
 (
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fmt
,

44 
_G_va_li¡
 
__­
))

46  
	`__butš___v¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

47 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

48 
	}
}

50 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


52 
	$__¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

53 
size_t
 
__¦’
, cÚ¡ *
__»¡riù
 
__fÜm©
,

54 ...è
__THROW
;

55 
	$__v¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

56 
size_t
 
__¦’
, cÚ¡ *
__»¡riù
 
__fÜm©
,

57 
_G_va_li¡
 
__­
è
__THROW
;

59 #ifdeà
__va_¬g_·ck


60 
__fÜtify_funùiÚ
 

61 
	`__NTH
 (
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

62 cÚ¡ *
__»¡riù
 
__fmt
, ...))

64  
	`__butš___¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

65 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

66 
	}
}

67 #–ià!
defšed
 
__ılu¥lus


68 
	#¢´štf
(
¡r
, 
Ën
, ...) \

69 
	`__butš___¢´štf_chk
 (
¡r
, 
Ën
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

70 
__VA_ARGS__
)

	)

73 
__fÜtify_funùiÚ
 

74 
__NTH
 (
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

75 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

77  
	`__butš___v¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

78 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

79 
	}
}

83 #ià
__USE_FORTIFY_LEVEL
 > 1

85 
__årštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

86 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

87 
__´štf_chk
 (
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

88 
__vårštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__­
);

90 
__v´štf_chk
 (
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
,

91 
_G_va_li¡
 
__­
);

93 #ifdeà
__va_¬g_·ck


94 
__fÜtify_funùiÚ
 

95 
	$årštf
 (
FILE
 *
__»¡riù
 
__¡»am
, cÚ¡ *__»¡riù 
__fmt
, ...)

97  
	`__årštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

98 
	`__va_¬g_·ck
 ());

99 
	}
}

101 
__fÜtify_funùiÚ
 

102 
	$´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, ...)

104  
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

105 
	}
}

106 #–ià!
defšed
 
__ılu¥lus


107 
	#´štf
(...) \

108 
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

109 
	#årštf
(
¡»am
, ...) \

110 
	`__årštf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

113 
__fÜtify_funùiÚ
 

114 
	$v´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

116 #ifdeà
__USE_EXTERN_INLINES


117  
	`__vårštf_chk
 (
¡dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

119  
	`__v´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

121 
	}
}

123 
__fÜtify_funùiÚ
 

124 
	$vårštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

125 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

127  
	`__vårštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

128 
	}
}

130 #ifdeà
__USE_XOPEN2K8


131 
	$__d´štf_chk
 (
__fd
, 
__æag
, cÚ¡ *
__»¡riù
 
__fmt
,

132 ...è
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

133 
	$__vd´štf_chk
 (
__fd
, 
__æag
,

134 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

135 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

137 #ifdeà
__va_¬g_·ck


138 
__fÜtify_funùiÚ
 

139 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

141  
	`__d´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

142 
	`__va_¬g_·ck
 ());

143 
	}
}

144 #–ià!
defšed
 
__ılu¥lus


145 
	#d´štf
(
fd
, ...) \

146 
	`__d´štf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

149 
__fÜtify_funùiÚ
 

150 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

152  
	`__vd´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

153 
	}
}

156 #ifdeà
__USE_GNU


158 
	$__a¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

159 cÚ¡ *
__»¡riù
 
__fmt
, ...)

160 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 4))è
__wur
;

161 
	$__va¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

162 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

163 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 0))è
__wur
;

164 
	$__ob¡ack_´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

165 
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
,

167 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

168 
	$__ob¡ack_v´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

169 
__æag
,

170 cÚ¡ *
__»¡riù
 
__fÜm©
,

171 
_G_va_li¡
 
__¬gs
)

172 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

174 #ifdeà
__va_¬g_·ck


175 
__fÜtify_funùiÚ
 

176 
	`__NTH
 (
	$a¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
, ...))

178  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

179 
	`__va_¬g_·ck
 ());

180 
	}
}

182 
__fÜtify_funùiÚ
 

183 
__NTH
 (
	$__a¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
,

186  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

187 
	`__va_¬g_·ck
 ());

188 
	}
}

190 
__fÜtify_funùiÚ
 

191 
__NTH
 (
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

192 cÚ¡ *
__»¡riù
 
__fmt
, ...))

194  
	`__ob¡ack_´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

195 
	`__va_¬g_·ck
 ());

196 
	}
}

197 #–ià!
defšed
 
__ılu¥lus


198 
	#a¥rštf
(
±r
, ...) \

199 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

200 
	#__a¥rštf
(
±r
, ...) \

201 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

202 
	#ob¡ack_´štf
(
ob¡ack
, ...) \

203 
	`__ob¡ack_´štf_chk
 (
ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

206 
__fÜtify_funùiÚ
 

207 
__NTH
 (
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
,

208 
_G_va_li¡
 
__­
))

210  
	`__va¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

211 
	}
}

213 
__fÜtify_funùiÚ
 

214 
__NTH
 (
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

215 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

217  
	`__ob¡ack_v´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

218 
__­
);

219 
	}
}

225 #ià!
defšed
 
__USE_ISOC11
 \

226 || (
defšed
 
	g__ılu¥lus
 && __ılu¥lu <ğ201103L && !defšed 
__USE_GNU
)

227 *
	$__g‘s_chk
 (*
__¡r
, 
size_t
è
__wur
;

228 *
	`__REDIRECT
 (
__g‘s_w¬n
, (*
__¡r
), 
g‘s
)

229 
__wur
 
	`__w¬Ç‰r
 ("please use fgets or getline instead, gets can't "

232 
__fÜtify_funùiÚ
 
__wur
 *

233 
	$g‘s
 (*
__¡r
)

235 ià(
	`__bos
 (
__¡r
è!ğ(
size_t
) -1)

236  
	`__g‘s_chk
 (
__¡r
, 
	`__bos
 (__str));

237  
	`__g‘s_w¬n
 (
__¡r
);

238 
	}
}

241 *
	$__fg‘s_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

242 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

243 *
	`__REDIRECT
 (
__fg‘s_®Ÿs
,

244 (*
__»¡riù
 
__s
, 
__n
,

245 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s
è
__wur
;

246 *
	`__REDIRECT
 (
__fg‘s_chk_w¬n
,

247 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

248 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_chk
)

249 
__wur
 
	`__w¬Ç‰r
 ("fgets called with bigger sizehan†ength "

252 
__fÜtify_funùiÚ
 
__wur
 *

253 
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

255 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

257 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

258  
	`__fg‘s_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

260 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

261  
	`__fg‘s_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

263  
	`__fg‘s_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

264 
	}
}

266 
size_t
 
	$__ä—d_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

267 
size_t
 
__size
, size_ˆ
__n
,

268 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

269 
size_t
 
	`__REDIRECT
 (
__ä—d_®Ÿs
,

270 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

271 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

272 
ä—d
è
__wur
;

273 
size_t
 
	`__REDIRECT
 (
__ä—d_chk_w¬n
,

274 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

275 
size_t
 
__size
, size_ˆ
__n
,

276 
FILE
 *
__»¡riù
 
__¡»am
),

277 
__ä—d_chk
)

278 
__wur
 
	`__w¬Ç‰r
 ("fread called with bigger size *‚membhan†ength "

281 
__fÜtify_funùiÚ
 
__wur
 
size_t


282 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

283 
FILE
 *
__»¡riù
 
__¡»am
)

285 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

287 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

288 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

289 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

290  
	`__ä—d_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

292 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

293  
	`__ä—d_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

295  
	`__ä—d_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

296 
	}
}

298 #ifdeà
__USE_GNU


299 *
	$__fg‘s_uÆocked_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
,

300 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

301 *
	`__REDIRECT
 (
__fg‘s_uÆocked_®Ÿs
,

302 (*
__»¡riù
 
__s
, 
__n
,

303 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s_uÆocked
è
__wur
;

304 *
	`__REDIRECT
 (
__fg‘s_uÆocked_chk_w¬n
,

305 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

306 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_uÆocked_chk
)

307 
__wur
 
	`__w¬Ç‰r
 ("fgets_unlocked called with bigger sizehan†ength "

310 
__fÜtify_funùiÚ
 
__wur
 *

311 
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

313 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

315 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

316  
	`__fg‘s_uÆocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

318 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

319  
	`__fg‘s_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

321  
	`__fg‘s_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

322 
	}
}

325 #ifdeà
__USE_MISC


326 #undeà
ä—d_uÆocked


327 
size_t
 
	$__ä—d_uÆocked_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

328 
size_t
 
__size
, size_ˆ
__n
,

329 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

330 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_®Ÿs
,

331 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

332 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

333 
ä—d_uÆocked
è
__wur
;

334 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_chk_w¬n
,

335 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

336 
size_t
 
__size
, size_ˆ
__n
,

337 
FILE
 *
__»¡riù
 
__¡»am
),

338 
__ä—d_uÆocked_chk
)

339 
__wur
 
	`__w¬Ç‰r
 ("fread_unlocked called with bigger size *‚membhan "

342 
__fÜtify_funùiÚ
 
__wur
 
size_t


343 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

344 
FILE
 *
__»¡riù
 
__¡»am
)

346 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

348 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

349 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

350 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

351  
	`__ä—d_uÆocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

352 
__¡»am
);

354 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

355  
	`__ä—d_uÆocked_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

356 
__¡»am
);

359 #ifdeà
__USE_EXTERN_INLINES


360 ià(
	`__butš_cÚ¡ªt_p
 (
__size
)

361 && 
	`__butš_cÚ¡ªt_p
 (
__n
)

362 && (
__size
 | 
__n
è< (((
size_t
) 1) << (8 *  (size_t) / 2))

363 && 
__size
 * 
__n
 <= 8)

365 
size_t
 
__út
 = 
__size
 * 
__n
;

366 *
__ıŒ
 = (*è
__±r
;

367 ià(
__út
 == 0)

370 ; 
__út
 > 0; --__cnt)

372 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
);

373 ià(
__c
 =ğ
EOF
)

375 *
__ıŒ
++ = 
__c
;

377  (
__ıŒ
 - (*è
__±r
è/ 
__size
;

380  
	`__ä—d_uÆocked_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

381 
	}
}

	@/usr/include/bits/stdio_lim.h

18 #ià!
defšed
 
_STDIO_H
 && !defšed 
__Ãed_FOPEN_MAX
 && !defšed 
__Ãed_IOV_MAX


22 #ifdeà
_STDIO_H


23 
	#L_tm²am
 20

	)

24 
	#TMP_MAX
 238328

	)

25 
	#FILENAME_MAX
 4096

	)

27 #ifdeà
__USE_POSIX


28 
	#L_ù”mid
 9

	)

29 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


30 
	#L_cu£rid
 9

	)

35 #ià
defšed
 
__Ãed_FOPEN_MAX
 || defšed 
_STDIO_H


36 #undeà
FOPEN_MAX


37 
	#FOPEN_MAX
 16

	)

40 #ià
defšed
 
__Ãed_IOV_MAX
 && !defšed 
IOV_MAX


41 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/stdlib-bsearch.h

19 
__ex‹º_šlše
 *

20 
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

21 
__com·r_â_t
 
__com·r
)

23 
size_t
 
__l
, 
__u
, 
__idx
;

24 cÚ¡ *
__p
;

25 
__com·risÚ
;

27 
__l
 = 0;

28 
__u
 = 
__nmemb
;

29 
__l
 < 
__u
)

31 
__idx
 = (
__l
 + 
__u
) / 2;

32 
__p
 = (*è(((cÚ¡ *è
__ba£
è+ (
__idx
 * 
__size
));

33 
__com·risÚ
 = (*
__com·r
è(
__key
, 
__p
);

34 ià(
__com·risÚ
 < 0)

35 
__u
 = 
__idx
;

36 ià(
__com·risÚ
 > 0)

37 
__l
 = 
__idx
 + 1;

39  (*è
__p
;

42  
NULL
;

43 
	}
}

	@/usr/include/bits/stdlib-float.h

19 #iâdeà
_STDLIB_H


23 #ifdeà
__USE_EXTERN_INLINES


24 
__BEGIN_NAMESPACE_STD


25 
__ex‹º_šlše
 

26 
__NTH
 (
	$©of
 (cÚ¡ *
__ÅŒ
))

28  
	`¡¹od
 (
__ÅŒ
, (**è
NULL
);

29 
	}
}

30 
	g__END_NAMESPACE_STD


	@/usr/include/bits/stdlib-ldbl.h

19 #iâdeà
_STDLIB_H


23 #ifdef 
__USE_ISOC99


24 
__BEGIN_NAMESPACE_C99


25 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd
, 
¡¹od
)

26 
__END_NAMESPACE_C99


29 #ifdeà
__USE_GNU


30 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd_l
, 
¡¹od_l
)

33 #ifdeà
__USE_MISC


34 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

35 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

36 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

38 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

19 #iâdeà
_STDLIB_H


23 *
	$__»®·th_chk
 (cÚ¡ *
__»¡riù
 
__Çme
,

24 *
__»¡riù
 
__»sŞved
,

25 
size_t
 
__»sŞvedËn
è
__THROW
 
__wur
;

26 *
	`__REDIRECT_NTH
 (
__»®·th_®Ÿs
,

27 (cÚ¡ *
__»¡riù
 
__Çme
,

28 *
__»¡riù
 
__»sŞved
), 
»®·th
è
__wur
;

29 *
	`__REDIRECT_NTH
 (
__»®·th_chk_w¬n
,

30 (cÚ¡ *
__»¡riù
 
__Çme
,

31 *
__»¡riù
 
__»sŞved
,

32 
size_t
 
__»sŞvedËn
), 
__»®·th_chk
è
__wur


33 
	`__w¬Ç‰r
 ("second‡rgument of„ealpath must beƒither NULL or‡t "

36 
__fÜtify_funùiÚ
 
__wur
 *

37 
	`__NTH
 (
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
, *__»¡riù 
__»sŞved
))

39 ià(
	`__bos
 (
__»sŞved
è!ğ(
size_t
) -1)

41 #ià
defšed
 
_LIBC_LIMITS_H_
 && defšed 
PATH_MAX


42 ià(
	`__bos
 (
__»sŞved
è< 
PATH_MAX
)

43  
	`__»®·th_chk_w¬n
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

45  
	`__»®·th_chk
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

48  
	`__»®·th_®Ÿs
 (
__Çme
, 
__»sŞved
);

49 
	}
}

52 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

53 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

54 
	`__REDIRECT_NTH
 (
__±¢ame_r_®Ÿs
, (
__fd
, *
__buf
,

55 
size_t
 
__buæ’
), 
±¢ame_r
)

56 
	`__nÚnuÎ
 ((2));

57 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¬n
,

58 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

59 
size_t
 
__Ä—l
), 
__±¢ame_r_chk
)

60 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ptsname_r called with buflen biggerhan "

63 
__fÜtify_funùiÚ
 

64 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

66 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

68 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

69  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

70 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

71  
	`__±¢ame_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

73  
	`__±¢ame_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

74 
	}
}

77 
	$__wùomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
size_t
 
__buæ’
)

78 
__THROW
 
__wur
;

79 
	`__REDIRECT_NTH
 (
__wùomb_®Ÿs
, (*
__s
, 
wch¬_t
 
__wch¬
),

80 
wùomb
è
__wur
;

82 
__fÜtify_funùiÚ
 
__wur
 

83 
	`__NTH
 (
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
))

88 
	#__STDLIB_MB_LEN_MAX
 16

	)

89 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__STDLIB_MB_LEN_MAX


92 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

93  
	`__wùomb_chk
 (
__s
, 
__wch¬
, 
	`__bos
 (__s));

94  
	`__wùomb_®Ÿs
 (
__s
, 
__wch¬
);

95 
	}
}

98 
size_t
 
	$__mb¡owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

99 cÚ¡ *
__»¡riù
 
__¤c
,

100 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

101 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_®Ÿs
,

102 (
wch¬_t
 *
__»¡riù
 
__d¡
,

103 cÚ¡ *
__»¡riù
 
__¤c
,

104 
size_t
 
__Ën
), 
mb¡owcs
);

105 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_chk_w¬n
,

106 (
wch¬_t
 *
__»¡riù
 
__d¡
,

107 cÚ¡ *
__»¡riù
 
__¤c
,

108 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__mb¡owcs_chk
)

109 
	`__w¬Ç‰r
 ("mbstowcs called with dst buffer smallerhan†en "

112 
__fÜtify_funùiÚ
 
size_t


113 
	`__NTH
 (
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, cÚ¡ *__»¡riù 
__¤c
,

114 
size_t
 
__Ën
))

116 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

118 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

119  
	`__mb¡owcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
,

120 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

122 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

123  
	`__mb¡owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
,

124 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

126  
	`__mb¡owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

127 
	}
}

130 
size_t
 
	$__wc¡ombs_chk
 (*
__»¡riù
 
__d¡
,

131 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

132 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

133 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_®Ÿs
,

134 (*
__»¡riù
 
__d¡
,

135 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

136 
size_t
 
__Ën
), 
wc¡ombs
);

137 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_chk_w¬n
,

138 (*
__»¡riù
 
__d¡
,

139 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

140 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__wc¡ombs_chk
)

141 
	`__w¬Ç‰r
 ("wcstombs called with dst buffer smallerhan†en");

143 
__fÜtify_funùiÚ
 
size_t


144 
	`__NTH
 (
	$wc¡ombs
 (*
__»¡riù
 
__d¡
, cÚ¡ 
wch¬_t
 *__»¡riù 
__¤c
,

145 
size_t
 
__Ën
))

147 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

149 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

150  
	`__wc¡ombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

151 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

152  
	`__wc¡ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

154  
	`__wc¡ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

155 
	}
}

	@/usr/include/bits/string.h

19 #iâdeà
_STRING_H


24 
	#_STRING_ARCH_uÇligÃd
 1

	)

28 #ià!
defšed
 
__x86_64__
 && (defšed 
__i486__
 || defšed 
__³Áium__
 \

29 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

30 || 
defšed
 
	g__nocÚa__
 || defšed 
	g__©om__
 \

31 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__cÜei7__
 \

32 || 
defšed
 
	g__k6__
 || defšed 
	g__geode__
 \

33 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

34 || 
defšed
 
	g__amdçm10__
)

38 #ià!
defšed
 
__NO_STRING_INLINES
 && defšed 
__USE_STRING_INLINES
 \

39 && 
defšed
 
	g__GNUC__
 && __GNUC__ >= 2

41 #iâdeà
__STRING_INLINE


42 #iâdeà
__ex‹º_šlše


43 
	#__STRING_INLINE
 
šlše


	)

45 
	#__STRING_INLINE
 
__ex‹º_šlše


	)

50 
	#__STRING_SMALL_GET16
(
¤c
, 
idx
) \

51 ((((cÚ¡ *è(
¤c
))[
idx
 + 1] << 8) \

52 | ((cÚ¡ *è(
¤c
))[
idx
])

	)

53 
	#__STRING_SMALL_GET32
(
¤c
, 
idx
) \

54 (((((cÚ¡ *è(
¤c
))[
idx
 + 3] << 8 \

55 | ((cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

56 | ((cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

57 | ((cÚ¡ *è(
¤c
))[
idx
])

	)

61 
	#_HAVE_STRING_ARCH_memıy
 1

	)

62 
	#memıy
(
de¡
, 
¤c
, 
n
) \

63 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) \

64 ? 
	`__memıy_c
 ((
de¡
), (
¤c
), (
n
)) \

65 : 
	`__memıy_g
 ((
de¡
), (
¤c
), (
n
))))

	)

66 
	#__memıy_c
(
de¡
, 
¤c
, 
n
) \

67 ((
n
) == 0 \

68 ? (
de¡
) \

69 : (((
n
) % 4 == 0) \

70 ? 
	`__memıy_by4
 (
de¡
, 
¤c
, 
n
) \

71 : (((
n
) % 2 == 0) \

72 ? 
	`__memıy_by2
 (
de¡
, 
¤c
, 
n
) \

73 : 
	`__memıy_g
 (
de¡
, 
¤c
, 
n
))))

	)

75 
__STRING_INLINE
 *
__memıy_by4
 (*
__de¡
, cÚ¡ *
__¤c
,

76 
size_t
 
__n
);

78 
__STRING_INLINE
 *

79 
	$__memıy_by4
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

81 
__d0
, 
__d1
;

82 *
__tmp
 = 
__de¡
;

83 
__asm__
 
__vŞ©e__


91 : "=&r" (
__d0
), "=&r" (
__tmp
), "=&r" (
__¤c
), "=&r" (
__d1
)

92 : "1" (
__tmp
), "2" (
__¤c
), "3" (
__n
 / 4)

94  
__de¡
;

95 
	}
}

97 
__STRING_INLINE
 *
__memıy_by2
 (*
__de¡
, cÚ¡ *
__¤c
,

98 
size_t
 
__n
);

100 
__STRING_INLINE
 *

101 
	$__memıy_by2
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

103 
__d0
, 
__d1
;

104 *
__tmp
 = 
__de¡
;

105 
__asm__
 
__vŞ©e__


118 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__¤c
), "=&r" (
__d1
)

119 : "1" (
__tmp
), "2" (
__¤c
), "3" (
__n
 / 2)

121  
__de¡
;

122 
	}
}

124 
__STRING_INLINE
 *
__memıy_g
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
);

126 
__STRING_INLINE
 *

127 
	$__memıy_g
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

129 
__d0
, 
__d1
, 
__d2
;

130 *
__tmp
 = 
__de¡
;

131 
__asm__
 
__vŞ©e__


142 : "=&c" (
__d0
), "=&D" (
__d1
), "=&S" (
__d2
),

143 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__de¡
)

144 : "0" (
__n
), "1" (
__tmp
), "2" (
__¤c
),

145 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__¤c
)

147  
__de¡
;

148 
	}
}

150 
	#_HAVE_STRING_ARCH_memmove
 1

	)

151 #iâdeà
_FORCE_INLINES


154 
	#memmove
(
de¡
, 
¤c
, 
n
è
	`__memmove_g
 (de¡, src,‚)

	)

156 
__STRING_INLINE
 *
	$__memmove_g
 (*, cÚ¡ *, 
size_t
)

157 
	`__asm__
 ("memmove");

159 
__STRING_INLINE
 *

160 
	$__memmove_g
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

162 
__d0
, 
__d1
, 
__d2
;

163 *
__tmp
 = 
__de¡
;

164 ià(
__de¡
 < 
__¤c
)

165 
__asm__
 
__vŞ©e__


168 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

169 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__de¡
)

170 : "0" (
__n
), "1" (
__¤c
), "2" (
__tmp
),

171 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__¤c
));

173 
__asm__
 
__vŞ©e__


177 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

178 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__de¡
)

179 : "0" (
__n
), "1" (__À- 1 + (cÚ¡ *è
__¤c
),

180 "2" (
__n
 - 1 + (*è
__tmp
),

181 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__¤c
));

182  
__de¡
;

183 
	}
}

187 
	#_HAVE_STRING_ARCH_memcmp
 1

	)

188 #iâdeà
_FORCE_INLINES


189 #iâdeà
__PIC__


191 
__STRING_INLINE
 

192 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

194 
__d0
, 
__d1
, 
__d2
;

195 
__»s
;

196 
__asm__
 
__vŞ©e__


204 : "=&a" (
__»s
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

205 : "0" (0), "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

206 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s1
),

207 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s2
)

209  
__»s
;

210 
	}
}

215 
	#_HAVE_STRING_ARCH_mem£t
 1

	)

216 
	#_USE_STRING_ARCH_mem£t
 1

	)

217 
	#mem£t
(
s
, 
c
, 
n
) \

218 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) && (n) <= 16 \

219 ? ((
n
) == 1 \

220 ? 
	`__mem£t_c1
 ((
s
), (
c
)) \

221 : 
	`__mem£t_gc
 ((
s
), (
c
), (
n
))) \

222 : (
	`__butš_cÚ¡ªt_p
 (
c
) \

223 ? (
	`__butš_cÚ¡ªt_p
 (
n
) \

224 ? 
	`__mem£t_cú
 ((
s
), (
c
), (
n
)) \

225 : 
	`mem£t
 ((
s
), (
c
), (
n
))) \

226 : (
	`__butš_cÚ¡ªt_p
 (
n
) \

227 ? 
	`__mem£t_gú
 ((
s
), (
c
), (
n
)) \

228 : 
	`mem£t
 ((
s
), (
c
), (
n
))))))

	)

230 
	#__mem£t_c1
(
s
, 
c
è({ *
__s
 = (s); \

231 *((*è
__s
èğ(è(
c
); \

232 
__s
; })

	)

234 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

235 ({ *
__s
 = (
s
); \

237 
__ui
; \

238 
__usi
; \

239 
__uc
; \

240 } *
__u
 = 
__s
; \

241 
__c
 = ((è((è(
c
))) * 0x01010101; \

247 ià((
n
) == 3 || (n) >= 5) \

248 
__asm__
 
	`__vŞ©e__
 ("" : "ô" (
__c
) : "0" (__c)); \

251 
n
) \

254 
__u
->
__ui
 = 
__c
; \

255 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

257 
__u
->
__ui
 = 
__c
; \

258 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

260 
__u
->
__ui
 = 
__c
; \

261 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

263 
__u
->
__usi
 = (è
__c
; \

264 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

265 
__u
->
__uc
 = (è
__c
; \

269 
__u
->
__ui
 = 
__c
; \

270 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

272 
__u
->
__ui
 = 
__c
; \

273 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

275 
__u
->
__ui
 = 
__c
; \

276 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

278 
__u
->
__usi
 = (è
__c
; \

282 
__u
->
__ui
 = 
__c
; \

283 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

285 
__u
->
__ui
 = 
__c
; \

286 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

288 
__u
->
__ui
 = 
__c
; \

289 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

291 
__u
->
__uc
 = (è
__c
; \

295 
__u
->
__ui
 = 
__c
; \

296 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

298 
__u
->
__ui
 = 
__c
; \

299 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

301 
__u
->
__ui
 = 
__c
; \

302 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

304 
__u
->
__ui
 = 
__c
; \

309 
__s
; })

	)

311 
	#__mem£t_cú
(
s
, 
c
, 
n
) \

312 (((
n
) % 4 == 0) \

313 ? 
	`__mem£t_cú_by4
 (
s
, ((è((è(
c
))) * 0x01010101,\

314 
n
) \

315 : (((
n
) % 2 == 0) \

316 ? 
	`__mem£t_cú_by2
 (
s
, \

317 ((è((è(
c
))) * 0x01010101,\

318 
n
) \

319 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

321 
__STRING_INLINE
 *
__mem£t_cú_by4
 (*
__s
, 
__c
,

322 
size_t
 
__n
);

324 
__STRING_INLINE
 *

325 
	$__mem£t_cú_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

327 *
__tmp
 = 
__s
;

328 
__d0
;

329 #ifdeà
__i686__


330 
__asm__
 
__vŞ©e__


333 : "=&a" (
__c
), "=&D" (
__tmp
), "=&c" (
__d0
),

334 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

335 : "0" ((è
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

338 
__asm__
 
__vŞ©e__


344 : "=&r" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

345 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

346 : "0" ((è
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

349  
__s
;

350 
	}
}

352 
__STRING_INLINE
 *
__mem£t_cú_by2
 (*
__s
, 
__c
,

353 
size_t
 
__n
);

355 
__STRING_INLINE
 *

356 
	$__mem£t_cú_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

358 
__d0
, 
__d1
;

359 *
__tmp
 = 
__s
;

360 #ifdeà
__i686__


361 
__asm__
 
__vŞ©e__


365 : "=&a" (
__d0
), "=&D" (
__tmp
), "=&c" (
__d1
),

366 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

367 : "0" ((è
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

370 
__asm__
 
__vŞ©e__


376 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

377 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

378 : "0" ((è
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

381  
__s
;

382 
	}
}

384 
	#__mem£t_gú
(
s
, 
c
, 
n
) \

385 (((
n
) % 4 == 0) \

386 ? 
	`__mem£t_gú_by4
 (
s
, 
c
, 
n
) \

387 : (((
n
) % 2 == 0) \

388 ? 
	`__mem£t_gú_by2
 (
s
, 
c
, 
n
) \

389 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

391 
__STRING_INLINE
 *
__mem£t_gú_by4
 (*
__s
, 
__c
, 
size_t
 
__n
);

393 
__STRING_INLINE
 *

394 
	$__mem£t_gú_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

396 *
__tmp
 = 
__s
;

397 
__d0
;

398 
__asm__
 
__vŞ©e__


408 : "=&q" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

409 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

410 : "0" ((è
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

412  
__s
;

413 
	}
}

415 
__STRING_INLINE
 *
__mem£t_gú_by2
 (*
__s
, 
__c
, 
size_t
 
__n
);

417 
__STRING_INLINE
 *

418 
	$__mem£t_gú_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

420 
__d0
, 
__d1
;

421 *
__tmp
 = 
__s
;

422 
__asm__
 
__vŞ©e__


433 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

434 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

435 : "0" ((è
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

437  
__s
;

438 
	}
}

442 
	#_HAVE_STRING_ARCH_memchr
 1

	)

443 #iâdeà
_FORCE_INLINES


444 
__STRING_INLINE
 *

445 
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

447 
__d0
;

448 #ifdeà
__i686__


449 
__d1
;

451 *
__»s
;

452 ià(
__n
 == 0)

453  
NULL
;

454 #ifdeà
__i686__


455 
__asm__
 
__vŞ©e__


459 : "=D" (
__»s
), "=&c" (
__d0
), "=&r" (
__d1
)

460 : "a" (
__c
), "0" (
__s
), "1" (
__n
), "2" (1),

461 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

464 
__asm__
 
__vŞ©e__


470 : "=D" (
__»s
), "=&c" (
__d0
)

471 : "a" (
__c
), "0" (
__s
), "1" (
__n
),

472 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

475  
__»s
 - 1;

476 
	}
}

479 
	#_HAVE_STRING_ARCH_memrchr
 1

	)

480 #iâdeà
_FORCE_INLINES


481 
__STRING_INLINE
 *
__memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
);

483 
__STRING_INLINE
 *

484 
	$__memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

486 
__d0
;

487 #ifdeà
__i686__


488 
__d1
;

490 *
__»s
;

491 ià(
__n
 == 0)

492  
NULL
;

493 #ifdeà
__i686__


494 
__asm__
 
__vŞ©e__


500 : "=D" (
__»s
), "=&c" (
__d0
), "=&r" (
__d1
)

501 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n), "2" (-1),

502 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

505 
__asm__
 
__vŞ©e__


512 : "=D" (
__»s
), "=&c" (
__d0
)

513 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n),

514 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s
)

517  
__»s
;

518 
	}
}

519 #ifdeà
__USE_GNU


520 
	#memrchr
(
s
, 
c
, 
n
è
	`__memrchr
 ((s), (c), (n))

	)

525 
	#_HAVE_STRING_ARCH_¿wmemchr
 1

	)

526 
__STRING_INLINE
 *
__¿wmemchr
 (cÚ¡ *
__s
, 
__c
);

528 #iâdeà
_FORCE_INLINES


529 
__STRING_INLINE
 *

530 
	$__¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

532 
__d0
;

533 *
__»s
;

534 
__asm__
 
__vŞ©e__


537 : "=D" (
__»s
), "=&c" (
__d0
)

538 : "a" (
__c
), "0" (
__s
), "1" (0xffffffff),

539 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

541  
__»s
 - 1;

542 
	}
}

543 #ifdeà
__USE_GNU


544 
__STRING_INLINE
 *

545 
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

547  
	`__¿wmemchr
 (
__s
, 
__c
);

548 
	}
}

554 
	#_HAVE_STRING_ARCH_¡¾’
 1

	)

555 
	#¡¾’
(
¡r
) \

556 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¡r
) \

557 ? 
	`__butš_¡¾’
 (
¡r
) \

558 : 
	`__¡¾’_g
 (
¡r
)))

	)

559 
__STRING_INLINE
 
size_t
 
__¡¾’_g
 (cÚ¡ *
__¡r
);

561 
__STRING_INLINE
 
size_t


562 
	$__¡¾’_g
 (cÚ¡ *
__¡r
)

564 
__dummy
;

565 cÚ¡ *
__tmp
 = 
__¡r
;

566 
__asm__
 
__vŞ©e__


572 : "ô" (
__tmp
), "=&q" (
__dummy
)

573 : "0" (
__¡r
),

574 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__¡r
)

576  
__tmp
 - 
__¡r
 - 1;

577 
	}
}

581 
	#_HAVE_STRING_ARCH_¡rıy
 1

	)

582 
	#¡rıy
(
de¡
, 
¤c
) \

583 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

584 ? ( ((
¤c
)[0]è=ğ1 && 
	`¡¾’
 (src) + 1 <= 8 \

585 ? 
	`__¡rıy_a_sm®l
 ((
de¡
), (
¤c
), 
	`¡¾’
 (src) + 1) \

586 : (*è
	`memıy
 ((*è(
de¡
), \

587 (cÚ¡ *è(
¤c
), \

588 
	`¡¾’
 (
¤c
) + 1)) \

589 : 
	`__¡rıy_g
 ((
de¡
), (
¤c
))))

	)

591 
	#__¡rıy_a_sm®l
(
de¡
, 
¤c
, 
¤ş’
) \

592 (
	`__ex‹nsiÚ__
 ({ *
__de¡
 = (
de¡
); \

594 
__ui
; \

595 
__usi
; \

596 
__uc
; \

597 
__c
; \

598 } *
__u
 = (*è
__de¡
; \

599 
¤ş’
) \

602 
__u
->
__uc
 = '\0'; \

605 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 0); \

608 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 0); \

609 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

610 
__u
->
__uc
 = '\0'; \

613 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

616 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

617 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

618 
__u
->
__uc
 = '\0'; \

621 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

622 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

623 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 4); \

626 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

627 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

628 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 4); \

629 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

630 
__u
->
__uc
 = '\0'; \

633 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

634 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

635 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 4); \

638 (*è
__de¡
; }))

	)

640 
__STRING_INLINE
 *
__¡rıy_g
 (*
__de¡
, cÚ¡ *
__¤c
);

642 
__STRING_INLINE
 *

643 
	$__¡rıy_g
 (*
__de¡
, cÚ¡ *
__¤c
)

645 *
__tmp
 = 
__de¡
;

646 
__dummy
;

647 
__asm__
 
__vŞ©e__


656 : "=&r" (
__¤c
), "=&r" (
__tmp
), "=&q" (
__dummy
),

657 "=m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__de¡
)

658 : "0" (
__¤c
), "1" (
__tmp
),

659 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__¤c
)

661  
__de¡
;

662 
	}
}

665 #ifdeà
__USE_GNU


666 
	#_HAVE_STRING_ARCH_¡pıy
 1

	)

668 
	#__¡pıy
(
de¡
, 
¤c
) \

669 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

670 ? (
	`¡¾’
 (
¤c
) + 1 <= 8 \

671 ? 
	`__¡pıy_a_sm®l
 ((
de¡
), (
¤c
), 
	`¡¾’
 (src) + 1) \

672 : 
	`__¡pıy_c
 ((
de¡
), (
¤c
), 
	`¡¾’
 (src) + 1)) \

673 : 
	`__¡pıy_g
 ((
de¡
), (
¤c
))))

	)

674 
	#__¡pıy_c
(
de¡
, 
¤c
, 
¤ş’
) \

675 ((
¤ş’
) % 4 == 0 \

676 ? 
	`__mempıy_by4
 (
de¡
, 
¤c
, 
¤ş’
) - 1 \

677 : ((
¤ş’
) % 2 == 0 \

678 ? 
	`__mempıy_by2
 (
de¡
, 
¤c
, 
¤ş’
) - 1 \

679 : 
	`__mempıy_byn
 (
de¡
, 
¤c
, 
¤ş’
è- 1))

	)

682 
	#¡pıy
(
de¡
, 
¤c
è
	`__¡pıy
 ((de¡), (¤c))

	)

684 
	#__¡pıy_a_sm®l
(
de¡
, 
¤c
, 
¤ş’
) \

685 (
	`__ex‹nsiÚ__
 ({ union { \

686 
__ui
; \

687 
__usi
; \

688 
__uc
; \

689 
__c
; \

690 } *
__u
 = (*è(
de¡
); \

691 
¤ş’
) \

694 
__u
->
__uc
 = '\0'; \

697 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 0); \

698 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1); \

701 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 0); \

702 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

703 
__u
->
__uc
 = '\0'; \

706 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

707 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3); \

710 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

711 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

712 
__u
->
__uc
 = '\0'; \

715 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

716 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

717 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 4); \

718 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1); \

721 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

722 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

723 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
¤c
, 4); \

724 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

725 
__u
->
__uc
 = '\0'; \

728 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 0); \

729 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

730 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
¤c
, 4); \

731 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3); \

734 (*è
__u
; }))

	)

736 
__STRING_INLINE
 *
__mempıy_by4
 (*
__de¡
, cÚ¡ *
__¤c
,

737 
size_t
 
__¤ş’
);

739 
__STRING_INLINE
 *

740 
	$__mempıy_by4
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__¤ş’
)

742 *
__tmp
 = 
__de¡
;

743 
__d0
, 
__d1
;

744 
__asm__
 
__vŞ©e__


752 : "=&r" (
__d0
), "ô" (
__tmp
), "=&r" (
__¤c
), "=&r" (
__d1
)

753 : "1" (
__tmp
), "2" (
__¤c
), "3" (
__¤ş’
 / 4)

755  
__tmp
;

756 
	}
}

758 
__STRING_INLINE
 *
__mempıy_by2
 (*
__de¡
, cÚ¡ *
__¤c
,

759 
size_t
 
__¤ş’
);

761 
__STRING_INLINE
 *

762 
	$__mempıy_by2
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__¤ş’
)

764 *
__tmp
 = 
__de¡
;

765 
__d0
, 
__d1
;

766 
__asm__
 
__vŞ©e__


779 : "=&q" (
__d0
), "ô" (
__tmp
), "=&r" (
__¤c
), "=&r" (
__d1
),

780 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__de¡
)

781 : "1" (
__tmp
), "2" (
__¤c
), "3" (
__¤ş’
 / 2),

782 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__¤c
)

784  
__tmp
 + 2;

785 
	}
}

787 
__STRING_INLINE
 *
__mempıy_byn
 (*
__de¡
, cÚ¡ *
__¤c
,

788 
size_t
 
__¤ş’
);

790 
__STRING_INLINE
 *

791 
	$__mempıy_byn
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__¤ş’
)

793 
__d0
, 
__d1
;

794 *
__tmp
 = 
__de¡
;

795 
__asm__
 
__vŞ©e__


806 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

807 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__de¡
)

808 : "0" (
__tmp
), "1" (
__¤ş’
), "2" (
__¤c
),

809 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__¤c
)

811  
__tmp
;

812 
	}
}

814 
__STRING_INLINE
 *
__¡pıy_g
 (*
__de¡
, cÚ¡ *
__¤c
);

816 
__STRING_INLINE
 *

817 
	$__¡pıy_g
 (*
__de¡
, cÚ¡ *
__¤c
)

819 *
__tmp
 = 
__de¡
;

820 
__dummy
;

821 
__asm__
 
__vŞ©e__


830 : "=&r" (
__¤c
), "ô" (
__tmp
), "=&q" (
__dummy
),

831 "=m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__de¡
)

832 : "0" (
__¤c
), "1" (
__tmp
),

833 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__¤c
)

835  
__tmp
 - 1;

836 
	}
}

841 
	#_HAVE_STRING_ARCH_¡ºıy
 1

	)

842 
	#¡ºıy
(
de¡
, 
¤c
, 
n
) \

843 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

844 ? ((
	`¡¾’
 (
¤c
è+ 1 >ğ((
size_t
è(
n
)) \

845 ? (*è
	`memıy
 ((*è(
de¡
), \

846 (cÚ¡ *è(
¤c
), 
n
) \

847 : 
	`__¡ºıy_cg
 ((
de¡
), (
¤c
), 
	`¡¾’
 (¤cè+ 1, 
n
))) \

848 : 
	`__¡ºıy_gg
 ((
de¡
), (
¤c
), 
n
)))

	)

849 
	#__¡ºıy_cg
(
de¡
, 
¤c
, 
¤ş’
, 
n
) \

850 (((
¤ş’
) % 4 == 0) \

851 ? 
	`__¡ºıy_by4
 (
de¡
, 
¤c
, 
¤ş’
, 
n
) \

852 : (((
¤ş’
) % 2 == 0) \

853 ? 
	`__¡ºıy_by2
 (
de¡
, 
¤c
, 
¤ş’
, 
n
) \

854 : 
	`__¡ºıy_byn
 (
de¡
, 
¤c
, 
¤ş’
, 
n
)))

	)

856 
__STRING_INLINE
 *
__¡ºıy_by4
 (*
__de¡
, cÚ¡ 
__¤c
[],

857 
size_t
 
__¤ş’
, size_ˆ
__n
);

859 
__STRING_INLINE
 *

860 
	$__¡ºıy_by4
 (*
__de¡
, cÚ¡ 
__¤c
[], 
size_t
 
__¤ş’
, size_ˆ
__n
)

862 *
__tmp
 = 
__de¡
;

863 
__dummy1
, 
__dummy2
;

864 
__asm__
 
__vŞ©e__


872 : "=&r" (
__dummy1
), "ô" (
__tmp
), "=&r" (
__¤c
), "=&r" (
__dummy2
),

873 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__de¡
)

874 : "1" (
__tmp
), "2" (
__¤c
), "3" (
__¤ş’
 / 4),

875 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__¤c
)

877 (è
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__¤ş’
);

878  
__de¡
;

879 
	}
}

881 
__STRING_INLINE
 *
__¡ºıy_by2
 (*
__de¡
, cÚ¡ 
__¤c
[],

882 
size_t
 
__¤ş’
, size_ˆ
__n
);

884 
__STRING_INLINE
 *

885 
	$__¡ºıy_by2
 (*
__de¡
, cÚ¡ 
__¤c
[], 
size_t
 
__¤ş’
, size_ˆ
__n
)

887 *
__tmp
 = 
__de¡
;

888 
__dummy1
, 
__dummy2
;

889 
__asm__
 
__vŞ©e__


902 : "=&q" (
__dummy1
), "ô" (
__tmp
), "=&r" (
__¤c
), "=&r" (
__dummy2
),

903 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__de¡
)

904 : "1" (
__tmp
), "2" (
__¤c
), "3" (
__¤ş’
 / 2),

905 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__¤c
)

907 (è
	`mem£t
 (
__tmp
 + 2, '\0', 
__n
 - 
__¤ş’
);

908  
__de¡
;

909 
	}
}

911 
__STRING_INLINE
 *
__¡ºıy_byn
 (*
__de¡
, cÚ¡ 
__¤c
[],

912 
size_t
 
__¤ş’
, size_ˆ
__n
);

914 
__STRING_INLINE
 *

915 
	$__¡ºıy_byn
 (*
__de¡
, cÚ¡ 
__¤c
[], 
size_t
 
__¤ş’
, size_ˆ
__n
)

917 
__d0
, 
__d1
;

918 *
__tmp
 = 
__de¡
;

919 
__asm__
 
__vŞ©e__


930 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

931 "=m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__de¡
)

932 : "1" (
__¤ş’
), "0" (
__tmp
),"2" (
__¤c
),

933 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__¤c
)

935 (è
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__¤ş’
);

936  
__de¡
;

937 
	}
}

939 
__STRING_INLINE
 *
__¡ºıy_gg
 (*
__de¡
, cÚ¡ *
__¤c
,

940 
size_t
 
__n
);

942 
__STRING_INLINE
 *

943 
	$__¡ºıy_gg
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

945 *
__tmp
 = 
__de¡
;

946 
__dummy
;

947 ià(
__n
 > 0)

948 
__asm__
 
__vŞ©e__


964 : "=&r" (
__¤c
), "=&r" (
__tmp
), "=&q" (
__dummy
), "=&r" (
__n
)

965 : "0" (
__¤c
), "1" (
__tmp
), "3" (
__n
)

968  
__de¡
;

969 
	}
}

973 
	#_HAVE_STRING_ARCH_¡rÿt
 1

	)

974 
	#¡rÿt
(
de¡
, 
¤c
) \

975 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

976 ? 
	`__¡rÿt_c
 ((
de¡
), (
¤c
), 
	`¡¾’
 (src) + 1) \

977 : 
	`__¡rÿt_g
 ((
de¡
), (
¤c
))))

	)

979 
__STRING_INLINE
 *
__¡rÿt_c
 (*
__de¡
, cÚ¡ 
__¤c
[],

980 
size_t
 
__¤ş’
);

982 
__STRING_INLINE
 *

983 
	$__¡rÿt_c
 (*
__de¡
, cÚ¡ 
__¤c
[], 
size_t
 
__¤ş’
)

985 #ifdeà
__i686__


986 
__d0
;

987 *
__tmp
;

988 
__asm__
 
__vŞ©e__


990 : "=D" (
__tmp
), "=&c" (
__d0
),

991 "=m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__de¡
)

992 : "0" (
__de¡
), "1" (0xffffffff), "a" (0),

993 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__¤c
)

995 --
__tmp
;

997 *
__tmp
 = 
__de¡
 - 1;

998 
__asm__
 
__vŞ©e__


1003 : "ô" (
__tmp
),

1004 "=m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__de¡
)

1005 : "0" (
__tmp
),

1006 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__¤ş’
]; } *)
__¤c
)

1009 (è
	`memıy
 (
__tmp
, 
__¤c
, 
__¤ş’
);

1010  
__de¡
;

1011 
	}
}

1013 
__STRING_INLINE
 *
__¡rÿt_g
 (*
__de¡
, cÚ¡ *
__¤c
);

1015 
__STRING_INLINE
 *

1016 
	$__¡rÿt_g
 (*
__de¡
, cÚ¡ *
__¤c
)

1018 *
__tmp
 = 
__de¡
 - 1;

1019 
__dummy
;

1020 
__asm__
 
__vŞ©e__


1032 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__¤c
),

1033 "=m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__de¡
)

1034 : "1" (
__tmp
), "2" (
__¤c
),

1035 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__¤c
)

1037  
__de¡
;

1038 
	}
}

1042 
	#_HAVE_STRING_ARCH_¡ºÿt
 1

	)

1043 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

1044 (
	`__ex‹nsiÚ__
 ({ *
__de¡
 = (
de¡
); \

1045 
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

1046 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

1047 ? 
	`¡rÿt
 (
__de¡
, (
¤c
)) \

1048 : (*(*)
	`__mempıy
 (
	`¡rchr
 (
__de¡
, '\0'), \

1049 (cÚ¡ *è(
¤c
), \

1050 (
n
)èğ0, 
__de¡
)) \

1051 : 
	`__¡ºÿt_g
 (
__de¡
, (
¤c
), (
n
)); }))

	)

1053 
__STRING_INLINE
 *
__¡ºÿt_g
 (*
__de¡
, cÚ¡ 
__¤c
[],

1054 
size_t
 
__n
);

1056 
__STRING_INLINE
 *

1057 
	$__¡ºÿt_g
 (*
__de¡
, cÚ¡ 
__¤c
[], 
size_t
 
__n
)

1059 *
__tmp
 = 
__de¡
;

1060 
__dummy
;

1061 #ifdeà
__i686__


1062 
__asm__
 
__vŞ©e__


1076 : "=&a" (
__dummy
), "=&D" (
__tmp
), "=&S" (
__¤c
), "=&c" (
__n
)

1077 : "g" (
__n
), "0" (0), "1" (
__tmp
), "2" (
__¤c
), "3" (0xffffffff)

1080 --
__tmp
;

1081 
__asm__
 
__vŞ©e__


1098 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__¤c
), "=&r" (
__n
)

1099 : "1" (
__tmp
), "2" (
__¤c
), "3" (
__n
)

1102  
__de¡
;

1103 
	}
}

1107 
	#_HAVE_STRING_ARCH_¡rcmp
 1

	)

1108 
	#¡rcmp
(
s1
, 
s2
) \

1109 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

1110 && ( ((
s1
)[0]è!ğ1 || 
	`¡¾’
 (s1) >= 4) \

1111 && ( ((
s2
)[0]è!ğ1 || 
	`¡¾’
 (s2) >= 4) \

1112 ? 
	`memcmp
 ((cÚ¡ *è(
s1
), (cÚ¡ *è(
s2
), \

1113 (
	`¡¾’
 (
s1
è< sŒËÀ(
s2
) \

1114 ? 
	`¡¾’
 (
s1
è: sŒËÀ(
s2
)) + 1) \

1115 : (
	`__butš_cÚ¡ªt_p
 (
s1
) &&  ((s1)[0]) == 1 \

1116 &&  ((
s2
)[0]è=ğ1 && 
	`¡¾’
 (
s1
) < 4 \

1117 ? (
	`__butš_cÚ¡ªt_p
 (
s2
) &&  ((s2)[0]) == 1 \

1118 ? 
	`__¡rcmp_cc
 ((cÚ¡ *è(
s1
), \

1119 (cÚ¡ *è(
s2
), \

1120 
	`¡¾’
 (
s1
)) \

1121 : 
	`__¡rcmp_cg
 ((cÚ¡ *è(
s1
), \

1122 (cÚ¡ *è(
s2
), \

1123 
	`¡¾’
 (
s1
))) \

1124 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&&  ((
s1
)[0]) == 1 \

1125 &&  ((
s2
)[0]è=ğ1 && 
	`¡¾’
 (s2) < 4 \

1126 ? (
	`__butš_cÚ¡ªt_p
 (
s1
) \

1127 ? 
	`__¡rcmp_cc
 ((cÚ¡ *è(
s1
), \

1128 (cÚ¡ *è(
s2
), \

1129 
	`¡¾’
 (
s2
)) \

1130 : 
	`__¡rcmp_gc
 ((cÚ¡ *è(
s1
), \

1131 (cÚ¡ *è(
s2
), \

1132 
	`¡¾’
 (
s2
))) \

1133 : 
	`__¡rcmp_gg
 ((
s1
), (
s2
))))))

	)

1135 
	#__¡rcmp_cc
(
s1
, 
s2
, 
l
) \

1136 (
	`__ex‹nsiÚ__
 ({ 
__»suÉ
 = (
s1
)[0] - (
s2
)[0]; \

1137 ià(
l
 > 0 && 
__»suÉ
 == 0) \

1139 
__»suÉ
 = (
s1
)[1] - (
s2
)[1]; \

1140 ià(
l
 > 1 && 
__»suÉ
 == 0) \

1142 
__»suÉ
 = (
s1
)[2] - (
s2
)[2]; \

1143 ià(
l
 > 2 && 
__»suÉ
 == 0) \

1144 
__»suÉ
 = (
s1
)[3] - (
s2
)[3]; \

1147 
__»suÉ
; }))

	)

1149 
	#__¡rcmp_cg
(
s1
, 
s2
, 
l1
) \

1150 (
	`__ex‹nsiÚ__
 ({ cÚ¡ *
__s2
 = (
s2
); \

1151 
__»suÉ
 = (
s1
)[0] - 
__s2
[0]; \

1152 ià(
l1
 > 0 && 
__»suÉ
 == 0) \

1154 
__»suÉ
 = (
s1
)[1] - 
__s2
[1]; \

1155 ià(
l1
 > 1 && 
__»suÉ
 == 0) \

1157 
__»suÉ
 = (
s1
)[2] - 
__s2
[2]; \

1158 ià(
l1
 > 2 && 
__»suÉ
 == 0) \

1159 
__»suÉ
 = (
s1
)[3] - 
__s2
[3]; \

1162 
__»suÉ
; }))

	)

1164 
	#__¡rcmp_gc
(
s1
, 
s2
, 
l2
) \

1165 (
	`__ex‹nsiÚ__
 ({ cÚ¡ *
__s1
 = (
s1
); \

1166 
__»suÉ
 = 
__s1
[0] - (
s2
)[0]; \

1167 ià(
l2
 > 0 && 
__»suÉ
 == 0) \

1169 
__»suÉ
 = 
__s1
[1] - (
s2
)[1]; \

1170 ià(
l2
 > 1 && 
__»suÉ
 == 0) \

1172 
__»suÉ
 = 
__s1
[2] - (
s2
)[2]; \

1173 ià(
l2
 > 2 && 
__»suÉ
 == 0) \

1174 
__»suÉ
 = 
__s1
[3] - (
s2
)[3]; \

1177 
__»suÉ
; }))

	)

1179 
__STRING_INLINE
 
__¡rcmp_gg
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
);

1181 
__STRING_INLINE
 

1182 
	$__¡rcmp_gg
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

1184 
__»s
;

1185 
__asm__
 
__vŞ©e__


1201 : "=q" (
__»s
), "=&r" (
__s1
), "=&r" (
__s2
)

1202 : "1" (
__s1
), "2" (
__s2
),

1203 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s1
),

1204 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s2
)

1206  
__»s
;

1207 
	}
}

1211 
	#_HAVE_STRING_ARCH_¡ºcmp
 1

	)

1212 
	#¡ºcmp
(
s1
, 
s2
, 
n
) \

1213 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`¡¾’
 (s1è< ((
size_t
è(
n
)) \

1214 ? 
	`¡rcmp
 ((
s1
), (
s2
)) \

1215 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`¡¾’
 (s2è< ((
size_t
è(
n
))\

1216 ? 
	`¡rcmp
 ((
s1
), (
s2
)) \

1217 : 
	`__¡ºcmp_g
 ((
s1
), (
s2
), (
n
)))))

	)

1219 
__STRING_INLINE
 
__¡ºcmp_g
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

1220 
size_t
 
__n
);

1222 
__STRING_INLINE
 

1223 
	$__¡ºcmp_g
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

1225 
__»s
;

1226 
__asm__
 
__vŞ©e__


1245 : "=q" (
__»s
), "=&r" (
__s1
), "=&r" (
__s2
), "=&r" (
__n
)

1246 : "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

1247 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s1
),

1248 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__n
]; } *)
__s2
)

1250  
__»s
;

1251 
	}
}

1255 
	#_HAVE_STRING_ARCH_¡rchr
 1

	)

1256 
	#_USE_STRING_ARCH_¡rchr
 1

	)

1257 
	#¡rchr
(
s
, 
c
) \

1258 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) \

1259 ? ((
c
) == '\0' \

1260 ? (*è
	`__¿wmemchr
 ((
s
), (
c
)) \

1261 : 
	`__¡rchr_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1262 : 
	`__¡rchr_g
 ((
s
), (
c
))))

	)

1264 
__STRING_INLINE
 *
__¡rchr_c
 (cÚ¡ *
__s
, 
__c
);

1266 
__STRING_INLINE
 *

1267 
	$__¡rchr_c
 (cÚ¡ *
__s
, 
__c
)

1269 
__d0
;

1270 *
__»s
;

1271 
__asm__
 
__vŞ©e__


1281 : "ô" (
__»s
), "=&a" (
__d0
)

1282 : "0" (
__s
), "1" (
__c
),

1283 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1285  
__»s
;

1286 
	}
}

1288 
__STRING_INLINE
 *
__¡rchr_g
 (cÚ¡ *
__s
, 
__c
);

1290 
__STRING_INLINE
 *

1291 
	$__¡rchr_g
 (cÚ¡ *
__s
, 
__c
)

1293 
__d0
;

1294 *
__»s
;

1295 
__asm__
 
__vŞ©e__


1306 : "ô" (
__»s
), "=&a" (
__d0
)

1307 : "0" (
__s
), "1" (
__c
),

1308 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1310  
__»s
;

1311 
	}
}

1315 
	#_HAVE_STRING_ARCH_¡rchºul
 1

	)

1316 
	#__¡rchºul
(
s
, 
c
) \

1317 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) \

1318 ? ((
c
) == '\0' \

1319 ? (*è
	`__¿wmemchr
 ((
s
), 
c
) \

1320 : 
	`__¡rchºul_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1321 : 
	`__¡rchºul_g
 ((
s
), 
c
)))

	)

1323 
__STRING_INLINE
 *
__¡rchºul_c
 (cÚ¡ *
__s
, 
__c
);

1325 
__STRING_INLINE
 *

1326 
	$__¡rchºul_c
 (cÚ¡ *
__s
, 
__c
)

1328 
__d0
;

1329 *
__»s
;

1330 
__asm__
 
__vŞ©e__


1340 : "ô" (
__»s
), "=&a" (
__d0
)

1341 : "0" (
__s
), "1" (
__c
),

1342 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1344  
__»s
;

1345 
	}
}

1347 
__STRING_INLINE
 *
__¡rchºul_g
 (cÚ¡ *
__s
, 
__c
);

1349 
__STRING_INLINE
 *

1350 
	$__¡rchºul_g
 (cÚ¡ *
__s
, 
__c
)

1352 
__d0
;

1353 *
__»s
;

1354 
__asm__
 
__vŞ©e__


1365 : "ô" (
__»s
), "=&a" (
__d0
)

1366 : "0" (
__s
), "1" (
__c
),

1367 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1369  
__»s
;

1370 
	}
}

1371 #ifdeà
__USE_GNU


1372 
	#¡rchºul
(
s
, 
c
è
	`__¡rchºul
 ((s), (c))

	)

1376 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1378 
	#_HAVE_STRING_ARCH_šdex
 1

	)

1379 
	#šdex
(
s
, 
c
) \

1380 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) \

1381 ? 
	`__¡rchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1382 : 
	`__¡rchr_g
 ((
s
), (
c
))))

	)

1387 
	#_HAVE_STRING_ARCH_¡¼chr
 1

	)

1388 
	#¡¼chr
(
s
, 
c
) \

1389 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) \

1390 ? 
	`__¡¼chr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1391 : 
	`__¡¼chr_g
 ((
s
), (
c
))))

	)

1393 #ifdeà
__i686__


1394 
__STRING_INLINE
 *
__¡¼chr_c
 (cÚ¡ *
__s
, 
__c
);

1396 
__STRING_INLINE
 *

1397 
	$__¡¼chr_c
 (cÚ¡ *
__s
, 
__c
)

1399 
__d0
, 
__d1
;

1400 *
__»s
;

1401 
__asm__
 
__vŞ©e__


1409 : "=d" (
__»s
), "=&S" (
__d0
), "=&a" (
__d1
)

1410 : "0" (1), "1" (
__s
), "2" (
__c
),

1411 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1413  
__»s
 - 1;

1414 
	}
}

1416 
__STRING_INLINE
 *
__¡¼chr_g
 (cÚ¡ *
__s
, 
__c
);

1418 
__STRING_INLINE
 *

1419 
	$__¡¼chr_g
 (cÚ¡ *
__s
, 
__c
)

1421 
__d0
, 
__d1
;

1422 *
__»s
;

1423 
__asm__
 
__vŞ©e__


1432 : "=d" (
__»s
), "=&S" (
__d0
), "=&a" (
__d1
)

1433 : "0" (1), "1" (
__s
), "2" (
__c
),

1434 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1436  
__»s
 - 1;

1437 
	}
}

1439 
__STRING_INLINE
 *
__¡¼chr_c
 (cÚ¡ *
__s
, 
__c
);

1441 
__STRING_INLINE
 *

1442 
	$__¡¼chr_c
 (cÚ¡ *
__s
, 
__c
)

1444 
__d0
, 
__d1
;

1445 *
__»s
;

1446 
__asm__
 
__vŞ©e__


1456 : "=d" (
__»s
), "=&S" (
__d0
), "=&a" (
__d1
)

1457 : "0" (0), "1" (
__s
), "2" (
__c
),

1458 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1460  
__»s
;

1461 
	}
}

1463 
__STRING_INLINE
 *
__¡¼chr_g
 (cÚ¡ *
__s
, 
__c
);

1465 
__STRING_INLINE
 *

1466 
	$__¡¼chr_g
 (cÚ¡ *
__s
, 
__c
)

1468 
__d0
, 
__d1
;

1469 *
__»s
;

1470 
__asm__
 
__vŞ©e__


1481 : "ô" (
__»s
), "=&S" (
__d0
), "=&a" (
__d1
)

1482 : "0" (0), "1" (
__s
), "2" (
__c
),

1483 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1485  
__»s
;

1486 
	}
}

1490 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1492 
	#_HAVE_STRING_ARCH_ršdex
 1

	)

1493 
	#ršdex
(
s
, 
c
) \

1494 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) \

1495 ? 
	`__¡¼chr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1496 : 
	`__¡¼chr_g
 ((
s
), (
c
))))

	)

1502 
	#_HAVE_STRING_ARCH_¡rc¥n
 1

	)

1503 
	#¡rc¥n
(
s
, 
»jeù
) \

1504 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
»jeù
) &&  ((reject)[0]) == 1 \

1505 ? ((
»jeù
)[0] == '\0' \

1506 ? 
	`¡¾’
 (
s
) \

1507 : ((
»jeù
)[1] == '\0' \

1508 ? 
	`__¡rc¥n_c1
 ((
s
), (((
»jeù
)[0] << 8) & 0xff00)) \

1509 : 
	`__¡rc¥n_cg
 ((
s
), (
»jeù
), 
	`¡¾’
 (reject)))) \

1510 : 
	`__¡rc¥n_g
 ((
s
), (
»jeù
))))

	)

1512 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c1
 (cÚ¡ *
__s
, 
__»jeù
);

1514 #iâdeà
_FORCE_INLINES


1515 
__STRING_INLINE
 
size_t


1516 
	$__¡rc¥n_c1
 (cÚ¡ *
__s
, 
__»jeù
)

1518 
__d0
;

1519 *
__»s
;

1520 
__asm__
 
__vŞ©e__


1529 : "ô" (
__»s
), "=&a" (
__d0
)

1530 : "0" (
__s
), "1" (
__»jeù
),

1531 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1533  (
__»s
 - 1è- 
__s
;

1534 
	}
}

1537 
__STRING_INLINE
 
size_t
 
__¡rc¥n_cg
 (cÚ¡ *
__s
, cÚ¡ 
__»jeù
[],

1538 
size_t
 
__»jeù_Ën
);

1540 
__STRING_INLINE
 
size_t


1541 
	$__¡rc¥n_cg
 (cÚ¡ *
__s
, cÚ¡ 
__»jeù
[], 
size_t
 
__»jeù_Ën
)

1543 
__d0
, 
__d1
, 
__d2
;

1544 cÚ¡ *
__»s
;

1545 
__asm__
 
__vŞ©e__


1556 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1557 : "0" (
__s
), "d" (
__»jeù
), "g" (
__»jeù_Ën
)

1559  (
__»s
 - 1è- 
__s
;

1560 
	}
}

1562 
__STRING_INLINE
 
size_t
 
__¡rc¥n_g
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
);

1563 #ifdeà
__PIC__


1565 
__STRING_INLINE
 
size_t


1566 
	$__¡rc¥n_g
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

1568 
__d0
, 
__d1
, 
__d2
;

1569 cÚ¡ *
__»s
;

1570 
__asm__
 
__vŞ©e__


1587 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1588 : "r" (
__»jeù
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1590  (
__»s
 - 1è- 
__s
;

1591 
	}
}

1593 
__STRING_INLINE
 
size_t


1594 
	$__¡rc¥n_g
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

1596 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1597 cÚ¡ *
__»s
;

1598 
__asm__
 
__vŞ©e__


1612 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1613 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__»jeù
), "b" (__reject)

1616  (
__»s
 - 1è- 
__s
;

1617 
	}
}

1623 
	#_HAVE_STRING_ARCH_¡r¥n
 1

	)

1624 
	#¡r¥n
(
s
, 
acû±
) \

1625 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
acû±
) &&  ((accept)[0]) == 1 \

1626 ? ((
acû±
)[0] == '\0' \

1627 ? ((è(
s
), 0) \

1628 : ((
acû±
)[1] == '\0' \

1629 ? 
	`__¡r¥n_c1
 ((
s
), (((
acû±
)[0] << 8 ) & 0xff00)) \

1630 : 
	`__¡r¥n_cg
 ((
s
), (
acû±
), 
	`¡¾’
 (accept)))) \

1631 : 
	`__¡r¥n_g
 ((
s
), (
acû±
))))

	)

1633 #iâdeà
_FORCE_INLINES


1634 
__STRING_INLINE
 
size_t
 
__¡r¥n_c1
 (cÚ¡ *
__s
, 
__acû±
);

1636 
__STRING_INLINE
 
size_t


1637 
	$__¡r¥n_c1
 (cÚ¡ *
__s
, 
__acû±
)

1639 
__d0
;

1640 *
__»s
;

1642 
__asm__
 
__vŞ©e__


1648 : "ô" (
__»s
), "=&q" (
__d0
)

1649 : "0" (
__s
), "1" (
__acû±
),

1650 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
)

1652  (
__»s
 - 1è- 
__s
;

1653 
	}
}

1656 
__STRING_INLINE
 
size_t
 
__¡r¥n_cg
 (cÚ¡ *
__s
, cÚ¡ 
__acû±
[],

1657 
size_t
 
__acû±_Ën
);

1659 
__STRING_INLINE
 
size_t


1660 
	$__¡r¥n_cg
 (cÚ¡ *
__s
, cÚ¡ 
__acû±
[], 
size_t
 
__acû±_Ën
)

1662 
__d0
, 
__d1
, 
__d2
;

1663 cÚ¡ *
__»s
;

1664 
__asm__
 
__vŞ©e__


1675 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1676 : "0" (
__s
), "g" (
__acû±
), "g" (
__acû±_Ën
),

1679 "m" ( *(¡ruù { 
__x
[0xfffffff]; } *)
__s
),

1680 "m" ( *(¡ruù { 
__ex‹nsiÚ__
 
__x
[
__acû±_Ën
]; } *)
__acû±
)

1682  (
__»s
 - 1è- 
__s
;

1683 
	}
}

1685 
__STRING_INLINE
 
size_t
 
__¡r¥n_g
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
);

1686 #ifdeà
__PIC__


1688 
__STRING_INLINE
 
size_t


1689 
	$__¡r¥n_g
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

1691 
__d0
, 
__d1
, 
__d2
;

1692 cÚ¡ *
__»s
;

1693 
__asm__
 
__vŞ©e__


1709 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1710 : "d" (
__acû±
), "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (__accept)

1712  (
__»s
 - 1è- 
__s
;

1713 
	}
}

1715 
__STRING_INLINE
 
size_t


1716 
	$__¡r¥n_g
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

1718 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1719 cÚ¡ *
__»s
;

1720 
__asm__
 
__vŞ©e__


1734 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1735 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__acû±
), "b" (__accept)

1737  (
__»s
 - 1è- 
__s
;

1738 
	}
}

1743 
	#_HAVE_STRING_ARCH_¡½brk
 1

	)

1744 
	#¡½brk
(
s
, 
acû±
) \

1745 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
acû±
) &&  ((accept)[0]) == 1 \

1746 ? ((
acû±
)[0] == '\0' \

1747 ? ((è(
s
), (*) 0) \

1748 : ((
acû±
)[1] == '\0' \

1749 ? 
	`¡rchr
 ((
s
), (
acû±
)[0]) \

1750 : 
	`__¡½brk_cg
 ((
s
), (
acû±
), 
	`¡¾’
 (accept)))) \

1751 : 
	`__¡½brk_g
 ((
s
), (
acû±
))))

	)

1753 
__STRING_INLINE
 *
__¡½brk_cg
 (cÚ¡ *
__s
, cÚ¡ 
__acû±
[],

1754 
size_t
 
__acû±_Ën
);

1756 
__STRING_INLINE
 *

1757 
	$__¡½brk_cg
 (cÚ¡ *
__s
, cÚ¡ 
__acû±
[], 
size_t
 
__acû±_Ën
)

1759 
__d0
, 
__d1
, 
__d2
;

1760 *
__»s
;

1761 
__asm__
 
__vŞ©e__


1776 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1777 : "0" (
__s
), "d" (
__acû±
), "g" (
__acû±_Ën
)

1779  
__»s
;

1780 
	}
}

1782 
__STRING_INLINE
 *
__¡½brk_g
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
);

1783 #ifdeà
__PIC__


1785 
__STRING_INLINE
 *

1786 
	$__¡½brk_g
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

1788 
__d0
, 
__d1
, 
__d2
;

1789 *
__»s
;

1790 
__asm__
 
__vŞ©e__


1811 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1812 : "d" (
__acû±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1814  
__»s
;

1815 
	}
}

1817 
__STRING_INLINE
 *

1818 
	$__¡½brk_g
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

1820 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1821 *
__»s
;

1822 
__asm__
 
__vŞ©e__


1841 : "=S" (
__»s
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

1842 : "0" (
__s
), "1" (0), "2" (0xffffffff), "b" (
__acû±
)

1844  
__»s
;

1845 
	}
}

1850 
	#_HAVE_STRING_ARCH_¡r¡r
 1

	)

1851 
	#¡r¡r
(
hay¡ack
, 
ÃedË
) \

1852 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
ÃedË
) &&  ((needle)[0]) == 1 \

1853 ? ((
ÃedË
)[0] == '\0' \

1854 ? (
hay¡ack
) \

1855 : ((
ÃedË
)[1] == '\0' \

1856 ? 
	`¡rchr
 ((
hay¡ack
), (
ÃedË
)[0]) \

1857 : 
	`__¡r¡r_cg
 ((
hay¡ack
), (
ÃedË
), \

1858 
	`¡¾’
 (
ÃedË
)))) \

1859 : 
	`__¡r¡r_g
 ((
hay¡ack
), (
ÃedË
))))

	)

1863 
__STRING_INLINE
 *
__¡r¡r_cg
 (cÚ¡ *
__hay¡ack
,

1864 cÚ¡ 
__ÃedË
[],

1865 
size_t
 
__ÃedË_Ën
);

1867 
__STRING_INLINE
 *

1868 
	$__¡r¡r_cg
 (cÚ¡ *
__hay¡ack
, cÚ¡ 
__ÃedË
[],

1869 
size_t
 
__ÃedË_Ën
)

1871 
__d0
, 
__d1
, 
__d2
;

1872 *
__»s
;

1873 
__asm__
 
__vŞ©e__


1886 : "=&a" (
__»s
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

1887 : "g" (
__ÃedË_Ën
), "1" (
__hay¡ack
), "d" (
__ÃedË
)

1889  
__»s
;

1890 
	}
}

1892 
__STRING_INLINE
 *
__¡r¡r_g
 (cÚ¡ *
__hay¡ack
,

1893 cÚ¡ *
__ÃedË
);

1894 #ifdeà
__PIC__


1896 
__STRING_INLINE
 *

1897 
	$__¡r¡r_g
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

1899 
__d0
, 
__d1
, 
__d2
;

1900 *
__»s
;

1901 
__asm__
 
__vŞ©e__


1920 : "=&a" (
__»s
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

1921 : "0" (0), "1" (0xffffffff), "2" (
__hay¡ack
), "3" (
__ÃedË
),

1922 "d" (
__ÃedË
)

1924  
__»s
;

1925 
	}
}

1927 
__STRING_INLINE
 *

1928 
	$__¡r¡r_g
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

1930 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1931 *
__»s
;

1932 
__asm__
 
__vŞ©e__


1949 : "=&a" (
__»s
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1950 : "0" (0), "1" (0xffffffff), "2" (
__hay¡ack
), "3" (
__ÃedË
),

1951 "b" (
__ÃedË
)

1953  
__»s
;

1954 
	}
}

1960 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1961 #ifdeà
__i686__


1962 
	#_HAVE_STRING_ARCH_ffs
 1

	)

1963 
	#ffs
(
wÜd
è(
	`__butš_cÚ¡ªt_p
 (word) \

1964 ? 
	`__butš_ffs
 (
wÜd
) \

1965 : ({ 
__út
, 
__tmp
; \

1966 
__asm__
 
__vŞ©e__
 \

1969 : "=&r" (
__út
), "ô" (
__tmp
) \

1970 : "rm" (
wÜd
), "1" (-1)); \

1971 
__út
 + 1; }))

	)

1973 #iâdeà
ff¦


1974 
	#ff¦
(
wÜd
è
	`ffs
(wÜd)

	)

1979 #iâdeà
_FORCE_INLINES


1980 #undeà
__STRING_INLINE


	@/usr/include/bits/string2.h

20 #iâdeà
_STRING_H


24 #iâdeà
__NO_STRING_INLINES


41 #iâdeà
__STRING_INLINE


42 #ifdeà
__ılu¥lus


43 
	#__STRING_INLINE
 
šlše


	)

45 
	#__STRING_INLINE
 
__ex‹º_šlše


	)

49 #ià
_STRING_ARCH_uÇligÃd


51 
	~<’dŸn.h
>

52 
	~<b™s/ty³s.h
>

54 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


55 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

56 (((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 1] << 8 \

57 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
])

	)

58 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

59 (((((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 3] << 8 \

60 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

61 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

62 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
])

	)

64 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

65 (((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
] << 8 \

66 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 1])

	)

67 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

68 (((((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
] << 8 \

69 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

70 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

71 | ((cÚ¡ *è(cÚ¡ *è(
¤c
))[
idx
 + 3])

	)

76 
	#__STRING2_COPY_TYPE
(
N
) \

77 ¡ruù { 
__¬r
[
N
]; } \

78 
	t__©Œibu‹__
 ((
	t__·cked__
)è
	t__STRING2_COPY_ARR
##
	tN


	)

79 
	t__STRING2_COPY_TYPE
 (2);

80 
__STRING2_COPY_TYPE
 (3);

81 
__STRING2_COPY_TYPE
 (4);

82 
__STRING2_COPY_TYPE
 (5);

83 
__STRING2_COPY_TYPE
 (6);

84 
__STRING2_COPY_TYPE
 (7);

85 
__STRING2_COPY_TYPE
 (8);

86 #undeà
__STRING2_COPY_TYPE


92 
	#__¡ršg2_1b±r_p
(
__x
) \

93 ((
size_t
)(cÚ¡ *)((
__x
è+ 1è- (size_t)(cÚ¡ *)(__xè=ğ1)

	)

96 #ià!
defšed
 
_HAVE_STRING_ARCH_mem£t


97 #ià!
__GNUC_PREREQ
 (3, 0)

98 #ià
_STRING_ARCH_uÇligÃd


99 
	#mem£t
(
s
, 
c
, 
n
) \

100 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) && (n) <= 16 \

101 ? ((
n
) == 1 \

102 ? 
	`__mem£t_1
 (
s
, 
c
) \

103 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

104 : (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

105 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

106 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

108 
	#__mem£t_1
(
s
, 
c
è({ *
__s
 = (s); \

109 *((
__ušt8_t
 *è
__s
èğ(__ušt8_tè
c
; __s; })

	)

111 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

112 ({ *
__s
 = (
s
); \

114 
__ui
; \

115 
__usi
; \

116 
__uc
; \

117 } *
__u
 = 
__s
; \

118 
__ušt8_t
 
__c
 = (__ušt8_tè(
c
); \

121 (è(
n
)) \

124 
__u
->
__ui
 = 
__c
 * 0x01010101; \

125 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

127 
__u
->
__ui
 = 
__c
 * 0x01010101; \

128 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

130 
__u
->
__ui
 = 
__c
 * 0x01010101; \

131 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

133 
__u
->
__usi
 = (è
__c
 * 0x0101; \

134 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

135 
__u
->
__uc
 = (è
__c
; \

139 
__u
->
__ui
 = 
__c
 * 0x01010101; \

140 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

142 
__u
->
__ui
 = 
__c
 * 0x01010101; \

143 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

145 
__u
->
__ui
 = 
__c
 * 0x01010101; \

146 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

148 
__u
->
__usi
 = (è
__c
 * 0x0101; \

152 
__u
->
__ui
 = 
__c
 * 0x01010101; \

153 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

155 
__u
->
__ui
 = 
__c
 * 0x01010101; \

156 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

158 
__u
->
__ui
 = 
__c
 * 0x01010101; \

159 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

161 
__u
->
__uc
 = (è
__c
; \

165 
__u
->
__ui
 = 
__c
 * 0x01010101; \

166 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

168 
__u
->
__ui
 = 
__c
 * 0x01010101; \

169 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

171 
__u
->
__ui
 = 
__c
 * 0x01010101; \

172 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

174 
__u
->
__ui
 = 
__c
 * 0x01010101; \

179 
__s
; })

	)

181 
	#mem£t
(
s
, 
c
, 
n
) \

182 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

183 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

184 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

193 #ià
__GNUC_PREREQ
 (2, 91)

194 
	#__bz”o
(
s
, 
n
è
	`__butš_mem£t
 (s, '\0',‚)

	)

202 #ifdeà
__USE_GNU


203 #ià!
defšed
 
_HAVE_STRING_ARCH_mempıy
 || defšed 
_FORCE_INLINES


204 #iâdeà
_HAVE_STRING_ARCH_mempıy


205 #ià
__GNUC_PREREQ
 (3, 4)

206 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__butš_mempıy
 (de¡, src,‚)

	)

207 #–ià
__GNUC_PREREQ
 (3, 0)

208 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

209 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

210 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

211 ? 
	`__butš_memıy
 (
de¡
, 
¤c
, 
n
) + (n) \

212 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

214 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

215 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

216 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

217 ? 
	`__mempıy_sm®l
 (
de¡
, 
	`__mempıy_¬gs
 (
¤c
), 
n
) \

218 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

222 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy
 (de¡, src,‚)

	)

225 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


226 #ià
_STRING_ARCH_uÇligÃd


227 #iâdeà
_FORCE_INLINES


228 
	#__mempıy_¬gs
(
¤c
) \

229 ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[2], \

230 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[6], \

231 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

232 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

233 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

234 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

236 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , , , ,

237 
__ušt16_t
, __ušt16_t, 
__ušt32_t
,

238 
__ušt32_t
, 
size_t
);

239 
__STRING_INLINE
 *

240 
	$__mempıy_sm®l
 (*
__de¡1
,

241 
__¤c0_1
, 
__¤c2_1
, 
__¤c4_1
, 
__¤c6_1
,

242 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

243 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

244 
size_t
 
__¤ş’
)

247 
__ušt32_t
 
__ui
;

248 
__ušt16_t
 
__usi
;

249 
__uc
;

250 
__c
;

251 } *
__u
 = 
__de¡1
;

252 (è
__¤ş’
)

255 
__u
->
__c
 = 
__¤c0_1
;

256 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

259 
__u
->
__usi
 = 
__¤c0_2
;

260 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

263 
__u
->
__usi
 = 
__¤c0_2
;

264 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

265 
__u
->
__c
 = 
__¤c2_1
;

266 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

269 
__u
->
__ui
 = 
__¤c0_4
;

270 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

273 
__u
->
__ui
 = 
__¤c0_4
;

274 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

275 
__u
->
__c
 = 
__¤c4_1
;

276 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

279 
__u
->
__ui
 = 
__¤c0_4
;

280 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

281 
__u
->
__usi
 = 
__¤c4_2
;

282 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

285 
__u
->
__ui
 = 
__¤c0_4
;

286 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

287 
__u
->
__usi
 = 
__¤c4_2
;

288 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

289 
__u
->
__c
 = 
__¤c6_1
;

290 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

293 
__u
->
__ui
 = 
__¤c0_4
;

294 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

295 
__u
->
__ui
 = 
__¤c4_4
;

296 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

299  (*è
__u
;

300 
	}
}

302 #iâdeà
_FORCE_INLINES


303 
	#__mempıy_¬gs
(
¤c
) \

304 ((cÚ¡ *è(
¤c
))[0], \

305 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

306 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1] } }), \

307 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

308 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

309 ((cÚ¡ *è(
¤c
))[2] } }), \

310 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

311 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

312 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3] } }), \

313 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

314 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

315 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

316 ((cÚ¡ *è(
¤c
))[4] } }), \

317 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

318 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

319 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

320 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[5] } }), \

321 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

322 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

323 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

324 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[5], \

325 ((cÚ¡ *è(
¤c
))[6] } }), \

326 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

327 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

328 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

329 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[5], \

330 ((cÚ¡ *è(
¤c
))[6], ((cÚ¡ *è(¤c))[7] } })

	)

332 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , 
__STRING2_COPY_ARR2
,

333 
__STRING2_COPY_ARR3
,

334 
__STRING2_COPY_ARR4
,

335 
__STRING2_COPY_ARR5
,

336 
__STRING2_COPY_ARR6
,

337 
__STRING2_COPY_ARR7
,

338 
__STRING2_COPY_ARR8
, 
size_t
);

339 
__STRING_INLINE
 *

340 
	$__mempıy_sm®l
 (*
__de¡
, 
__¤c1
,

341 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

342 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

343 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

344 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

347 
__c
;

348 
__STRING2_COPY_ARR2
 
__sÿ2
;

349 
__STRING2_COPY_ARR3
 
__sÿ3
;

350 
__STRING2_COPY_ARR4
 
__sÿ4
;

351 
__STRING2_COPY_ARR5
 
__sÿ5
;

352 
__STRING2_COPY_ARR6
 
__sÿ6
;

353 
__STRING2_COPY_ARR7
 
__sÿ7
;

354 
__STRING2_COPY_ARR8
 
__sÿ8
;

355 } *
__u
 = 
__de¡
;

356 (è
__¤ş’
)

359 
__u
->
__c
 = 
__¤c1
;

362 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

365 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

368 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

371 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

374 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

377 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

380 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

383  
	`__ex‹nsiÚ__
 ((*è
__u
 + 
__¤ş’
);

384 
	}
}

392 #iâdeà
_HAVE_STRING_ARCH_¡rchr


393 *
__¿wmemchr
 (cÚ¡ *
__s
, 
__c
);

394 #ià
__GNUC_PREREQ
 (3, 2)

395 
	#¡rchr
(
s
, 
c
) \

396 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
è&& !__butš_cÚ¡ªt_°(
s
) \

397 && (
c
) == '\0' \

398 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

399 : 
	`__butš_¡rchr
 (
s
, 
c
)))

	)

401 
	#¡rchr
(
s
, 
c
) \

402 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

403 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

404 : 
	`¡rchr
 (
s
, 
c
)))

	)

410 #ià(!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)) \

411 || 
defšed
 
	g_FORCE_INLINES


412 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)

413 
	#¡rıy
(
de¡
, 
¤c
) \

414 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

415 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

416 ? 
	`__¡rıy_sm®l
 (
de¡
, 
	`__¡rıy_¬gs
 (
¤c
), \

417 
	`¡¾’
 (
¤c
) + 1) \

418 : (*è
	`memıy
 (
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1)) \

419 : 
	`¡rıy
 (
de¡
, 
¤c
)))

	)

422 #ià
_STRING_ARCH_uÇligÃd


423 #iâdeà
_FORCE_INLINES


424 
	#__¡rıy_¬gs
(
¤c
) \

425 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

426 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

427 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

428 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

430 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

431 
__ušt32_t
, __ušt32_t, 
size_t
);

432 
__STRING_INLINE
 *

433 
	$__¡rıy_sm®l
 (*
__de¡
,

434 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

435 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

436 
size_t
 
__¤ş’
)

439 
__ušt32_t
 
__ui
;

440 
__ušt16_t
 
__usi
;

441 
__uc
;

442 } *
__u
 = (*è
__de¡
;

443 (è
__¤ş’
)

446 
__u
->
__uc
 = '\0';

449 
__u
->
__usi
 = 
__¤c0_2
;

452 
__u
->
__usi
 = 
__¤c0_2
;

453 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

454 
__u
->
__uc
 = '\0';

457 
__u
->
__ui
 = 
__¤c0_4
;

460 
__u
->
__ui
 = 
__¤c0_4
;

461 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

462 
__u
->
__uc
 = '\0';

465 
__u
->
__ui
 = 
__¤c0_4
;

466 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

467 
__u
->
__usi
 = 
__¤c4_2
;

470 
__u
->
__ui
 = 
__¤c0_4
;

471 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

472 
__u
->
__usi
 = 
__¤c4_2
;

473 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

474 
__u
->
__uc
 = '\0';

477 
__u
->
__ui
 = 
__¤c0_4
;

478 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

479 
__u
->
__ui
 = 
__¤c4_4
;

482  
__de¡
;

483 
	}
}

485 #iâdeà
_FORCE_INLINES


486 
	#__¡rıy_¬gs
(
¤c
) \

487 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

488 { { ((cÚ¡ *è(
¤c
))[0], '\0' } }), \

489 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

490 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

492 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

493 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

494 ((cÚ¡ *è(
¤c
))[2], '\0' } }), \

495 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

496 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

497 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

499 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

500 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

501 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

502 ((cÚ¡ *è(
¤c
))[4], '\0' } }), \

503 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

504 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

505 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

506 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[5], \

508 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

509 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

510 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

511 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[5], \

512 ((cÚ¡ *è(
¤c
))[6], '\0' } })

	)

514 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

515 
__STRING2_COPY_ARR3
,

516 
__STRING2_COPY_ARR4
,

517 
__STRING2_COPY_ARR5
,

518 
__STRING2_COPY_ARR6
,

519 
__STRING2_COPY_ARR7
,

520 
__STRING2_COPY_ARR8
, 
size_t
);

521 
__STRING_INLINE
 *

522 
	$__¡rıy_sm®l
 (*
__de¡
,

523 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

524 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

525 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

526 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

529 
__c
;

530 
__STRING2_COPY_ARR2
 
__sÿ2
;

531 
__STRING2_COPY_ARR3
 
__sÿ3
;

532 
__STRING2_COPY_ARR4
 
__sÿ4
;

533 
__STRING2_COPY_ARR5
 
__sÿ5
;

534 
__STRING2_COPY_ARR6
 
__sÿ6
;

535 
__STRING2_COPY_ARR7
 
__sÿ7
;

536 
__STRING2_COPY_ARR8
 
__sÿ8
;

537 } *
__u
 = (*è
__de¡
;

538 (è
__¤ş’
)

541 
__u
->
__c
 = '\0';

544 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

547 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

550 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

553 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

556 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

559 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

562 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

565  
__de¡
;

566 
	}
}

572 #ifdeà
__USE_GNU


573 #ià!
defšed
 
_HAVE_STRING_ARCH_¡pıy
 || defšed 
_FORCE_INLINES


574 #iâdeà
_HAVE_STRING_ARCH_¡pıy


575 #ià
__GNUC_PREREQ
 (3, 4)

576 
	#__¡pıy
(
de¡
, 
¤c
è
	`__butš_¡pıy
 (de¡, src)

	)

577 #–ià
__GNUC_PREREQ
 (3, 0)

578 
	#__¡pıy
(
de¡
, 
¤c
) \

579 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

580 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

581 ? 
	`__butš_¡rıy
 (
de¡
, 
¤c
è+ 
	`¡¾’
 (src) \

582 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

584 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

586 
	#__¡pıy
(
de¡
, 
¤c
) \

587 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

588 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

589 ? 
	`__¡pıy_sm®l
 (
de¡
, 
	`__¡pıy_¬gs
 (
¤c
), \

590 
	`¡¾’
 (
¤c
) + 1) \

591 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

593 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

597 
	#¡pıy
(
de¡
, 
¤c
è
	`__¡pıy
 (de¡, src)

	)

600 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


601 #ià
_STRING_ARCH_uÇligÃd


602 #iâdeà
_FORCE_INLINES


603 
	#__¡pıy_¬gs
(
¤c
) \

604 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

605 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

606 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

607 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

609 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

610 
__ušt32_t
, __ušt32_t, 
size_t
);

611 
__STRING_INLINE
 *

612 
	$__¡pıy_sm®l
 (*
__de¡
,

613 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

614 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

615 
size_t
 
__¤ş’
)

618 
__ui
;

619 
__usi
;

620 
__uc
;

621 
__c
;

622 } *
__u
 = (*è
__de¡
;

623 (è
__¤ş’
)

626 
__u
->
__uc
 = '\0';

629 
__u
->
__usi
 = 
__¤c0_2
;

630 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

633 
__u
->
__usi
 = 
__¤c0_2
;

634 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

635 
__u
->
__uc
 = '\0';

638 
__u
->
__ui
 = 
__¤c0_4
;

639 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

642 
__u
->
__ui
 = 
__¤c0_4
;

643 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

644 
__u
->
__uc
 = '\0';

647 
__u
->
__ui
 = 
__¤c0_4
;

648 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

649 
__u
->
__usi
 = 
__¤c4_2
;

650 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

653 
__u
->
__ui
 = 
__¤c0_4
;

654 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

655 
__u
->
__usi
 = 
__¤c4_2
;

656 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

657 
__u
->
__uc
 = '\0';

660 
__u
->
__ui
 = 
__¤c0_4
;

661 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

662 
__u
->
__ui
 = 
__¤c4_4
;

663 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

666  &
__u
->
__c
;

667 
	}
}

669 #iâdeà
_FORCE_INLINES


670 
	#__¡pıy_¬gs
(
¤c
) \

671 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

672 { { ((cÚ¡ *è(
¤c
))[0], '\0' } }), \

673 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

674 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

676 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

677 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

678 ((cÚ¡ *è(
¤c
))[2], '\0' } }), \

679 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

680 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

681 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

683 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

684 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

685 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

686 ((cÚ¡ *è(
¤c
))[4], '\0' } }), \

687 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

688 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

689 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

690 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[5], \

692 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

693 { { ((cÚ¡ *è(
¤c
))[0], ((const *) (src))[1], \

694 ((cÚ¡ *è(
¤c
))[2], ((const *) (src))[3], \

695 ((cÚ¡ *è(
¤c
))[4], ((const *) (src))[5], \

696 ((cÚ¡ *è(
¤c
))[6], '\0' } })

	)

698 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

699 
__STRING2_COPY_ARR3
,

700 
__STRING2_COPY_ARR4
,

701 
__STRING2_COPY_ARR5
,

702 
__STRING2_COPY_ARR6
,

703 
__STRING2_COPY_ARR7
,

704 
__STRING2_COPY_ARR8
, 
size_t
);

705 
__STRING_INLINE
 *

706 
	$__¡pıy_sm®l
 (*
__de¡
,

707 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

708 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

709 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

710 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

713 
__c
;

714 
__STRING2_COPY_ARR2
 
__sÿ2
;

715 
__STRING2_COPY_ARR3
 
__sÿ3
;

716 
__STRING2_COPY_ARR4
 
__sÿ4
;

717 
__STRING2_COPY_ARR5
 
__sÿ5
;

718 
__STRING2_COPY_ARR6
 
__sÿ6
;

719 
__STRING2_COPY_ARR7
 
__sÿ7
;

720 
__STRING2_COPY_ARR8
 
__sÿ8
;

721 } *
__u
 = (*è
__de¡
;

722 (è
__¤ş’
)

725 
__u
->
__c
 = '\0';

728 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

731 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

734 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

737 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

740 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

743 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

746 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

749  
__de¡
 + 
__¤ş’
 - 1;

750 
	}
}

758 #iâdeà
_HAVE_STRING_ARCH_¡ºıy


759 #ià
__GNUC_PREREQ
 (3, 2)

760 
	#¡ºıy
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºıy
 (de¡, src,‚)

	)

762 
	#¡ºıy
(
de¡
, 
¤c
, 
n
) \

763 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

764 ? (
	`¡¾’
 (
¤c
è+ 1 >ğ((
size_t
è(
n
)) \

765 ? (*è
	`memıy
 (
de¡
, 
¤c
, 
n
) \

766 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)) \

767 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)))

	)

773 #iâdeà
_HAVE_STRING_ARCH_¡ºÿt


774 #ifdeà
_USE_STRING_ARCH_¡rchr


775 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

776 (
	`__ex‹nsiÚ__
 ({ *
__de¡
 = (
de¡
); \

777 
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

778 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

779 ? 
	`¡rÿt
 (
__de¡
, 
¤c
) \

780 : (*((*è
	`__mempıy
 (
	`¡rchr
 (
__de¡
, '\0'), \

781 
¤c
, 
n
)èğ'\0', 
__de¡
)) \

782 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
); }))

	)

783 #–ià
__GNUC_PREREQ
 (3, 2)

784 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºÿt
 (de¡, src,‚)

	)

786 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

787 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

788 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

789 ? 
	`¡rÿt
 (
de¡
, 
¤c
) \

790 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)) \

791 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)))

	)

797 #iâdeà
_HAVE_STRING_ARCH_¡rcmp


798 #ià
__GNUC_PREREQ
 (3, 2)

799 
	#¡rcmp
(
s1
, 
s2
) \

800 
__ex‹nsiÚ__
 \

801 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

802 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

803 && (
__s1_Ën
 = 
	`__butš_¡¾’
 (
s1
), 
__s2_Ën
 = __butš_¡¾’ (
s2
), \

804 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

805 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

806 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

807 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

808 && (
__s1_Ën
 = 
	`__butš_¡¾’
 (
s1
), __s1_len < 4) \

809 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

810 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

811 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

812 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

813 && (
__s2_Ën
 = 
	`__butš_¡¾’
 (
s2
), __s2_len < 4) \

814 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

815 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

816 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

817 : 
	`__butš_¡rcmp
 (
s1
, 
s2
)))); })

	)

819 
	#¡rcmp
(
s1
, 
s2
) \

820 
__ex‹nsiÚ__
 \

821 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

822 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

823 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

824 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

825 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

826 ? 
	`memcmp
 ((cÚ¡ *è(
s1
), (cÚ¡ *è(
s2
), \

827 (
__s1_Ën
 < 
__s2_Ën
 ? __s1_len : __s2_len) + 1) \

828 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

829 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

830 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

831 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s1_Ën
) \

832 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

833 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

834 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

835 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

836 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s2_Ën
) \

837 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

838 : 
	`¡rcmp
 (
s1
, 
s2
)))); })

	)

841 
	#__¡rcmp_cc
(
s1
, 
s2
, 
l
) \

842 (
	`__ex‹nsiÚ__
 ({ 
__»suÉ
 = \

843 (((cÚ¡ *è(cÚ¡ *è(
s1
))[0] \

844 - ((cÚ¡ *è(cÚ¡ *)(
s2
))[0]); \

845 ià(
l
 > 0 && 
__»suÉ
 == 0) \

847 
__»suÉ
 = (((const *) \

848 (cÚ¡ *è(
s1
))[1] \

850 (cÚ¡ *è(
s2
))[1]); \

851 ià(
l
 > 1 && 
__»suÉ
 == 0) \

853 
__»suÉ
 = \

855 (cÚ¡ *è(
s1
))[2] \

857 (cÚ¡ *è(
s2
))[2]); \

858 ià(
l
 > 2 && 
__»suÉ
 == 0) \

859 
__»suÉ
 = \

861 (cÚ¡ *è(
s1
))[3] \

863 (cÚ¡ *è(
s2
))[3]); \

866 
__»suÉ
; }))

	)

868 
	#__¡rcmp_cg
(
s1
, 
s2
, 
l1
) \

869 (
	`__ex‹nsiÚ__
 ({ cÚ¡ *
__s2
 = \

870 (cÚ¡ *è(cÚ¡ *è(
s2
); \

871 
__»suÉ
 = \

872 (((cÚ¡ *è(cÚ¡ *è(
s1
))[0] \

873 - 
__s2
[0]); \

874 ià(
l1
 > 0 && 
__»suÉ
 == 0) \

876 
__»suÉ
 = (((const *) \

877 (cÚ¡ *è(
s1
))[1] - 
__s2
[1]); \

878 ià(
l1
 > 1 && 
__»suÉ
 == 0) \

880 
__»suÉ
 = (((const *) \

881 (cÚ¡ *è(
s1
))[2] - 
__s2
[2]); \

882 ià(
l1
 > 2 && 
__»suÉ
 == 0) \

883 
__»suÉ
 = (((const *) \

884 (cÚ¡ *è(
s1
))[3] \

885 - 
__s2
[3]); \

888 
__»suÉ
; }))

	)

890 
	#__¡rcmp_gc
(
s1
, 
s2
, 
l2
è(- 
	`__¡rcmp_cg
 (s2, s1,†2))

	)

895 #iâdeà
_HAVE_STRING_ARCH_¡ºcmp


896 
	#¡ºcmp
(
s1
, 
s2
, 
n
) \

897 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) \

898 && ((
	`__butš_cÚ¡ªt_p
 (
s1
) \

899 && 
	`¡¾’
 (
s1
è< ((
size_t
è(
n
))) \

900 || (
	`__butš_cÚ¡ªt_p
 (
s2
) \

901 && 
	`¡¾’
 (
s2
è< ((
size_t
è(
n
)))) \

902 ? 
	`¡rcmp
 (
s1
, 
s2
è: 
	`¡ºcmp
 (s1, s2, 
n
)))

	)

908 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rc¥n
 || defšed 
_FORCE_INLINES


909 #iâdeà
_HAVE_STRING_ARCH_¡rc¥n


910 #ià
__GNUC_PREREQ
 (3, 2)

911 
	#¡rc¥n
(
s
, 
»jeù
) \

912 
__ex‹nsiÚ__
 \

913 ({ 
__r0
, 
__r1
, 
__r2
; \

914 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

915 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

916 ? 
	`__butš_¡rc¥n
 (
s
, 
»jeù
) \

917 : ((
__r0
 = ((cÚ¡ *è(
»jeù
))[0], __r0 == '\0') \

918 ? 
	`¡¾’
 (
s
) \

919 : ((
__r1
 = ((cÚ¡ *è(
»jeù
))[1], __r1 == '\0') \

920 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

921 : ((
__r2
 = ((cÚ¡ *è(
»jeù
))[2], __r2 == '\0') \

922 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

923 : (((cÚ¡ *è(
»jeù
))[3] == '\0' \

924 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

925 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)))))) \

926 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)); })

	)

928 
	#¡rc¥n
(
s
, 
»jeù
) \

929 
__ex‹nsiÚ__
 \

930 ({ 
__r0
, 
__r1
, 
__r2
; \

931 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

932 ? ((
__r0
 = ((cÚ¡ *è(
»jeù
))[0], __r0 == '\0') \

933 ? 
	`¡¾’
 (
s
) \

934 : ((
__r1
 = ((cÚ¡ *è(
»jeù
))[1], __r1 == '\0') \

935 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

936 : ((
__r2
 = ((cÚ¡ *è(
»jeù
))[2], __r2 == '\0') \

937 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

938 : (((cÚ¡ *è(
»jeù
))[3] == '\0' \

939 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

940 : 
	`¡rc¥n
 (
s
, 
»jeù
))))) \

941 : 
	`¡rc¥n
 (
s
, 
»jeù
)); })

	)

945 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c1
 (cÚ¡ *
__s
, 
__»jeù
);

946 
__STRING_INLINE
 
size_t


947 
	$__¡rc¥n_c1
 (cÚ¡ *
__s
, 
__»jeù
)

949 
size_t
 
__»suÉ
 = 0;

950 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù
)

951 ++
__»suÉ
;

952  
__»suÉ
;

953 
	}
}

955 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c2
 (cÚ¡ *
__s
, 
__»jeù1
,

956 
__»jeù2
);

957 
__STRING_INLINE
 
size_t


958 
	$__¡rc¥n_c2
 (cÚ¡ *
__s
, 
__»jeù1
, 
__»jeù2
)

960 
size_t
 
__»suÉ
 = 0;

961 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


962 && 
__s
[
__»suÉ
] !ğ
__»jeù2
)

963 ++
__»suÉ
;

964  
__»suÉ
;

965 
	}
}

967 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c3
 (cÚ¡ *
__s
, 
__»jeù1
,

968 
__»jeù2
, 
__»jeù3
);

969 
__STRING_INLINE
 
size_t


970 
	$__¡rc¥n_c3
 (cÚ¡ *
__s
, 
__»jeù1
, 
__»jeù2
,

971 
__»jeù3
)

973 
size_t
 
__»suÉ
 = 0;

974 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


975 && 
__s
[
__»suÉ
] !ğ
__»jeù2
 && __s[__»suÉ] !ğ
__»jeù3
)

976 ++
__»suÉ
;

977  
__»suÉ
;

978 
	}
}

984 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¥n
 || defšed 
_FORCE_INLINES


985 #iâdeà
_HAVE_STRING_ARCH_¡r¥n


986 #ià
__GNUC_PREREQ
 (3, 2)

987 
	#¡r¥n
(
s
, 
acû±
) \

988 
__ex‹nsiÚ__
 \

989 ({ 
__a0
, 
__a1
, 
__a2
; \

990 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

991 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

992 ? 
	`__butš_¡r¥n
 (
s
, 
acû±
) \

993 : ((
__a0
 = ((cÚ¡ *è(
acû±
))[0], __a0 == '\0') \

994 ? ((è(
s
), (
size_t
) 0) \

995 : ((
__a1
 = ((cÚ¡ *è(
acû±
))[1], __a1 == '\0') \

996 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

997 : ((
__a2
 = ((cÚ¡ *è(
acû±
))[2], __a2 == '\0') \

998 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

999 : (((cÚ¡ *è(
acû±
))[3] == '\0' \

1000 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1001 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)))))) \

1002 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)); })

	)

1004 
	#¡r¥n
(
s
, 
acû±
) \

1005 
__ex‹nsiÚ__
 \

1006 ({ 
__a0
, 
__a1
, 
__a2
; \

1007 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1008 ? ((
__a0
 = ((cÚ¡ *è(
acû±
))[0], __a0 == '\0') \

1009 ? ((è(
s
), (
size_t
) 0) \

1010 : ((
__a1
 = ((cÚ¡ *è(
acû±
))[1], __a1 == '\0') \

1011 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1012 : ((
__a2
 = ((cÚ¡ *è(
acû±
))[2], __a2 == '\0') \

1013 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1014 : (((cÚ¡ *è(
acû±
))[3] == '\0' \

1015 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1016 : 
	`¡r¥n
 (
s
, 
acû±
))))) \

1017 : 
	`¡r¥n
 (
s
, 
acû±
)); })

	)

1021 
__STRING_INLINE
 
size_t
 
__¡r¥n_c1
 (cÚ¡ *
__s
, 
__acû±
);

1022 
__STRING_INLINE
 
size_t


1023 
	$__¡r¥n_c1
 (cÚ¡ *
__s
, 
__acû±
)

1025 
size_t
 
__»suÉ
 = 0;

1027 
__s
[
__»suÉ
] =ğ
__acû±
)

1028 ++
__»suÉ
;

1029  
__»suÉ
;

1030 
	}
}

1032 
__STRING_INLINE
 
size_t
 
__¡r¥n_c2
 (cÚ¡ *
__s
, 
__acû±1
,

1033 
__acû±2
);

1034 
__STRING_INLINE
 
size_t


1035 
	$__¡r¥n_c2
 (cÚ¡ *
__s
, 
__acû±1
, 
__acû±2
)

1037 
size_t
 
__»suÉ
 = 0;

1039 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2
)

1040 ++
__»suÉ
;

1041  
__»suÉ
;

1042 
	}
}

1044 
__STRING_INLINE
 
size_t
 
__¡r¥n_c3
 (cÚ¡ *
__s
, 
__acû±1
,

1045 
__acû±2
, 
__acû±3
);

1046 
__STRING_INLINE
 
size_t


1047 
	$__¡r¥n_c3
 (cÚ¡ *
__s
, 
__acû±1
, 
__acû±2
, 
__acû±3
)

1049 
size_t
 
__»suÉ
 = 0;

1051 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2


1052 || 
__s
[
__»suÉ
] =ğ
__acû±3
)

1053 ++
__»suÉ
;

1054  
__»suÉ
;

1055 
	}
}

1060 #ià!
defšed
 
_HAVE_STRING_ARCH_¡½brk
 || defšed 
_FORCE_INLINES


1061 #iâdeà
_HAVE_STRING_ARCH_¡½brk


1062 #ià
__GNUC_PREREQ
 (3, 2)

1063 
	#¡½brk
(
s
, 
acû±
) \

1064 
__ex‹nsiÚ__
 \

1065 ({ 
__a0
, 
__a1
, 
__a2
; \

1066 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1067 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1068 ? 
	`__butš_¡½brk
 (
s
, 
acû±
) \

1069 : ((
__a0
 = ((cÚ¡ *è(
acû±
))[0], __a0 == '\0') \

1070 ? ((è(
s
), (*è
NULL
) \

1071 : ((
__a1
 = ((cÚ¡ *è(
acû±
))[1], __a1 == '\0') \

1072 ? 
	`__butš_¡rchr
 (
s
, 
__a0
) \

1073 : ((
__a2
 = ((cÚ¡ *è(
acû±
))[2], __a2 == '\0') \

1074 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1075 : (((cÚ¡ *è(
acû±
))[3] == '\0' \

1076 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1077 : 
	`__butš_¡½brk
 (
s
, 
acû±
)))))) \

1078 : 
	`__butš_¡½brk
 (
s
, 
acû±
)); })

	)

1080 
	#¡½brk
(
s
, 
acû±
) \

1081 
__ex‹nsiÚ__
 \

1082 ({ 
__a0
, 
__a1
, 
__a2
; \

1083 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1084 ? ((
__a0
 = ((cÚ¡ *è(
acû±
))[0], __a0 == '\0') \

1085 ? ((è(
s
), (*è
NULL
) \

1086 : ((
__a1
 = ((cÚ¡ *è(
acû±
))[1], __a1 == '\0') \

1087 ? 
	`¡rchr
 (
s
, 
__a0
) \

1088 : ((
__a2
 = ((cÚ¡ *è(
acû±
))[2], __a2 == '\0') \

1089 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1090 : (((cÚ¡ *è(
acû±
))[3] == '\0' \

1091 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1092 : 
	`¡½brk
 (
s
, 
acû±
))))) \

1093 : 
	`¡½brk
 (
s
, 
acû±
)); })

	)

1097 
__STRING_INLINE
 *
__¡½brk_c2
 (cÚ¡ *
__s
, 
__acû±1
,

1098 
__acû±2
);

1099 
__STRING_INLINE
 *

1100 
	$__¡½brk_c2
 (cÚ¡ *
__s
, 
__acû±1
, 
__acû±2
)

1103 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2
)

1104 ++
__s
;

1105  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1106 
	}
}

1108 
__STRING_INLINE
 *
__¡½brk_c3
 (cÚ¡ *
__s
, 
__acû±1
,

1109 
__acû±2
, 
__acû±3
);

1110 
__STRING_INLINE
 *

1111 
	$__¡½brk_c3
 (cÚ¡ *
__s
, 
__acû±1
, 
__acû±2
, 
__acû±3
)

1114 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2


1115 && *
__s
 !ğ
__acû±3
)

1116 ++
__s
;

1117  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1118 
	}
}

1124 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¡r
 && !
__GNUC_PREREQ
 (2, 97)

1125 
	#¡r¡r
(
hay¡ack
, 
ÃedË
) \

1126 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
ÃedË
è&& 
	`__¡ršg2_1b±r_p
 (needle) \

1127 ? (((cÚ¡ *è(
ÃedË
))[0] == '\0' \

1128 ? (*è(
size_t
è(
hay¡ack
) \

1129 : (((cÚ¡ *è(
ÃedË
))[1] == '\0' \

1130 ? 
	`¡rchr
 (
hay¡ack
, \

1131 ((cÚ¡ *è(
ÃedË
))[0]) \

1132 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
))) \

1133 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
)))

	)

1137 #ià!
defšed
 
_HAVE_STRING_ARCH_¡¹ok_r
 || defšed 
_FORCE_INLINES


1138 #iâdeà
_HAVE_STRING_ARCH_¡¹ok_r


1139 
	#__¡¹ok_r
(
s
, 
£p
, 
Ãx
) \

1140 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
£p
è&& 
	`__¡ršg2_1b±r_p
 (sep) \

1141 && ((cÚ¡ *è(
£p
))[0] != '\0' \

1142 && ((cÚ¡ *è(
£p
))[1] == '\0' \

1143 ? 
	`__¡¹ok_r_1c
 (
s
, ((cÚ¡ *è(
£p
))[0], 
Ãx
) \

1144 : 
	`__¡¹ok_r
 (
s
, 
£p
, 
Ãx
)))

	)

1147 
__STRING_INLINE
 *
__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
);

1148 
__STRING_INLINE
 *

1149 
	$__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
)

1151 *
__»suÉ
;

1152 ià(
__s
 =ğ
NULL
)

1153 
__s
 = *
__Ãx
;

1154 *
__s
 =ğ
__£p
)

1155 ++
__s
;

1156 
__»suÉ
 = 
NULL
;

1157 ià(*
__s
 != '\0')

1159 
__»suÉ
 = 
__s
++;

1160 *
__s
 != '\0')

1161 ià(*
__s
++ =ğ
__£p
)

1163 
__s
[-1] = '\0';

1167 *
__Ãx
 = 
__s
;

1168  
__»suÉ
;

1169 
	}
}

1170 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


1171 
	#¡¹ok_r
(
s
, 
£p
, 
Ãx
è
	`__¡¹ok_r
 (s, s•,‚ex)

	)

1176 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r£p
 || defšed 
_FORCE_INLINES


1177 #iâdeà
_HAVE_STRING_ARCH_¡r£p


1179 *
__¡r£p_g
 (**
__¡ršgp
, cÚ¡ *
__d–im
);

1180 
	#__¡r£p
(
s
, 
»jeù
) \

1181 
__ex‹nsiÚ__
 \

1182 ({ 
__r0
, 
__r1
, 
__r2
; \

1183 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

1184 && (
__r0
 = ((cÚ¡ *è(
»jeù
))[0], \

1185 ((cÚ¡ *è(
»jeù
))[0] != '\0') \

1186 ? ((
__r1
 = ((cÚ¡ *è(
»jeù
))[1], \

1187 ((cÚ¡ *è(
»jeù
))[1] == '\0') \

1188 ? 
	`__¡r£p_1c
 (
s
, 
__r0
) \

1189 : ((
__r2
 = ((cÚ¡ *è(
»jeù
))[2], __r2 == '\0') \

1190 ? 
	`__¡r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1191 : (((cÚ¡ *è(
»jeù
))[3] == '\0' \

1192 ? 
	`__¡r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1193 : 
	`__¡r£p_g
 (
s
, 
»jeù
)))) \

1194 : 
	`__¡r£p_g
 (
s
, 
»jeù
)); })

	)

1197 
__STRING_INLINE
 *
__¡r£p_1c
 (**
__s
, 
__»jeù
);

1198 
__STRING_INLINE
 *

1199 
	$__¡r£p_1c
 (**
__s
, 
__»jeù
)

1201 *
__»tv®
 = *
__s
;

1202 ià(
__»tv®
 !ğ
NULL
 && (*
__s
 = 
	`¡rchr
 (__»tv®, 
__»jeù
)) != NULL)

1203 *(*
__s
)++ = '\0';

1204  
__»tv®
;

1205 
	}
}

1207 
__STRING_INLINE
 *
__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
);

1208 
__STRING_INLINE
 *

1209 
	$__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
)

1211 *
__»tv®
 = *
__s
;

1212 ià(
__»tv®
 !ğ
NULL
)

1214 *
__ı
 = 
__»tv®
;

1217 ià(*
__ı
 == '\0')

1219 
__ı
 = 
NULL
;

1222 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
)

1224 *
__ı
++ = '\0';

1227 ++
__ı
;

1229 *
__s
 = 
__ı
;

1231  
__»tv®
;

1232 
	}
}

1234 
__STRING_INLINE
 *
__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
,

1235 
__»jeù3
);

1236 
__STRING_INLINE
 *

1237 
	$__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
, 
__»jeù3
)

1239 *
__»tv®
 = *
__s
;

1240 ià(
__»tv®
 !ğ
NULL
)

1242 *
__ı
 = 
__»tv®
;

1245 ià(*
__ı
 == '\0')

1247 
__ı
 = 
NULL
;

1250 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
 || *__ı =ğ
__»jeù3
)

1252 *
__ı
++ = '\0';

1255 ++
__ı
;

1257 *
__s
 = 
__ı
;

1259  
__»tv®
;

1260 
	}
}

1261 #ifdeà
__USE_BSD


1262 
	#¡r£p
(
s
, 
»jeù
è
	`__¡r£p
 (s,„ejeù)

	)

1269 #ifdeà
__USE_MISC


1271 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rdup
 || !defšed 
_HAVE_STRING_ARCH_¡ºdup


1272 
	#__Ãed_m®loc_ªd_ÿÎoc


	)

1273 
	~<¡dlib.h
>

1276 #iâdeà
_HAVE_STRING_ARCH_¡rdup


1278 *
	$__¡rdup
 (cÚ¡ *
__¡ršg
è
__THROW
 
__©Œibu‹_m®loc__
;

1279 
	#__¡rdup
(
s
) \

1280 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1281 ? (((cÚ¡ *è(
s
))[0] == '\0' \

1282 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1283 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1284 *
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1285 ià(
__»tv®
 !ğ
NULL
) \

1286 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, 
__Ën
); \

1287 
__»tv®
; 
	}
})) \

1288 : 
	`__¡rdup
 (
s
)))

	)

1290 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1291 
	#¡rdup
(
s
è
	`__¡rdup
 (s)

	)

1295 #iâdeà
_HAVE_STRING_ARCH_¡ºdup


1297 *
	$__¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

1298 
__THROW
 
__©Œibu‹_m®loc__
;

1299 
	#__¡ºdup
(
s
, 
n
) \

1300 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1301 ? (((cÚ¡ *è(
s
))[0] == '\0' \

1302 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1303 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1304 
size_t
 
__n
 = (
n
); \

1305 *
__»tv®
; \

1306 ià(
__n
 < 
__Ën
) \

1307 
__Ën
 = 
__n
 + 1; \

1308 
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1309 ià(
__»tv®
 !ğ
NULL
) \

1311 
__»tv®
[
__Ën
 - 1] = '\0'; \

1312 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, \

1313 
__Ën
 - 1); \

1315 
__»tv®
; 
	}
})) \

1316 : 
	`__¡ºdup
 (
s
, 
n
)))

	)

1318 #ifdeà
__USE_GNU


1319 
	#¡ºdup
(
s
, 
n
è
	`__¡ºdup
 (s,‚)

	)

1325 #iâdeà
_FORCE_INLINES


1326 #undeà
__STRING_INLINE


	@/usr/include/bits/string3.h

18 #iâdeà
_STRING_H


22 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

25 #iâdeà
__ılu¥lus


29 #undeà
memıy


30 #undeà
memmove


31 #undeà
mem£t


32 #undeà
¡rÿt


33 #undeà
¡rıy


34 #undeà
¡ºÿt


35 #undeà
¡ºıy


36 #ifdeà
__USE_GNU


37 #undeà
mempıy


38 #undeà
¡pıy


40 #ifdeà
__USE_BSD


41 #undeà
bcİy


42 #undeà
bz”o


47 
__fÜtify_funùiÚ
 *

48 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

49 
size_t
 
__Ën
))

51  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

52 
	}
}

54 
__fÜtify_funùiÚ
 *

55 
__NTH
 (
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__Ën
))

57  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

58 
	}
}

60 #ifdeà
__USE_GNU


61 
__fÜtify_funùiÚ
 *

62 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

63 
size_t
 
__Ën
))

65  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

66 
	}
}

75 
__fÜtify_funùiÚ
 *

76 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

78 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0

79 && (!
	`__butš_cÚ¡ªt_p
 (
__ch
) || __ch != 0))

81 
	`__w¬n_mem£t_z”o_Ën
 ();

82  
__de¡
;

84  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

85 
	}
}

87 #ifdeà
__USE_BSD


88 
__fÜtify_funùiÚ
 

89 
__NTH
 (
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__Ën
))

91 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

92 
	}
}

94 
__fÜtify_funùiÚ
 

95 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

97 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

98 
	}
}

101 
__fÜtify_funùiÚ
 *

102 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

104  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

105 
	}
}

107 #ifdeà
__USE_GNU


108 
__fÜtify_funùiÚ
 *

109 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

111  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

112 
	}
}

116 
__fÜtify_funùiÚ
 *

117 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

118 
size_t
 
__Ën
))

120  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

121 
	}
}

124 *
	$__¡²ıy_chk
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

125 
size_t
 
__de¡Ën
è
__THROW
;

126 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
, cÚ¡ *
__¤c
,

127 
size_t
 
__n
), 
¡²ıy
);

129 
__fÜtify_funùiÚ
 *

130 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
))

132 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

133 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À<ğ
	`__bos
 (
__de¡
)))

134  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

135  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

136 
	}
}

139 
__fÜtify_funùiÚ
 *

140 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

142  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

143 
	}
}

146 
__fÜtify_funùiÚ
 *

147 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

148 
size_t
 
__Ën
))

150  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

151 
	}
}

	@/usr/include/bits/stropts.h

18 #iâdeà
_STROPTS_H


22 #iâdeà
_BITS_STROPTS_H


23 
	#_BITS_STROPTS_H
 1

	)

25 
	~<b™s/ty³s.h
>

28 
	#__SID
 ('S' << 8)

	)

30 
	#I_NREAD
 (
__SID
 | 1è

	)

32 
	#I_PUSH
 (
__SID
 | 2è

	)

34 
	#I_POP
 (
__SID
 | 3è

	)

36 
	#I_LOOK
 (
__SID
 | 4è

	)

39 
	#I_FLUSH
 (
__SID
 | 5è

	)

40 
	#I_SRDOPT
 (
__SID
 | 6è

	)

41 
	#I_GRDOPT
 (
__SID
 | 7è

	)

42 
	#I_STR
 (
__SID
 | 8è

	)

44 
	#I_SETSIG
 (
__SID
 | 9è

	)

46 
	#I_GETSIG
 (
__SID
 |10è

	)

49 
	#I_FIND
 (
__SID
 |11è

	)

52 
	#I_LINK
 (
__SID
 |12è

	)

53 
	#I_UNLINK
 (
__SID
 |13è

	)

54 
	#I_PEEK
 (
__SID
 |15è

	)

58 
	#I_FDINSERT
 (
__SID
 |16è

	)

61 
	#I_SENDFD
 (
__SID
 |17è

	)

65 
	#I_RECVFD
 (
__SID
 |14è

	)

66 
	#I_SWROPT
 (
__SID
 |19è

	)

67 
	#I_GWROPT
 (
__SID
 |20è

	)

68 
	#I_LIST
 (
__SID
 |21è

	)

70 
	#I_PLINK
 (
__SID
 |22è

	)

72 
	#I_PUNLINK
 (
__SID
 |23è

	)

74 
	#I_FLUSHBAND
 (
__SID
 |28è

	)

75 
	#I_CKBAND
 (
__SID
 |29è

	)

78 
	#I_GETBAND
 (
__SID
 |30è

	)

80 
	#I_ATMARK
 (
__SID
 |31è

	)

83 
	#I_SETCLTIME
 (
__SID
 |32è

	)

86 
	#I_GETCLTIME
 (
__SID
 |33è

	)

87 
	#I_CANPUT
 (
__SID
 |34è

	)

91 
	#FMNAMESZ
 8

	)

94 
	#FLUSHR
 0x01

	)

95 
	#FLUSHW
 0x02

	)

96 
	#FLUSHRW
 0x03

	)

97 #ifdeà
__USE_GNU


98 
	#FLUSHBAND
 0x04

	)

102 
	#S_INPUT
 0x0001

	)

104 
	#S_HIPRI
 0x0002

	)

105 
	#S_OUTPUT
 0x0004

	)

107 
	#S_MSG
 0x0008

	)

110 
	#S_ERROR
 0x0010

	)

111 
	#S_HANGUP
 0x0020

	)

112 
	#S_RDNORM
 0x0040

	)

113 
	#S_WRNORM
 
S_OUTPUT


	)

114 
	#S_RDBAND
 0x0080

	)

116 
	#S_WRBAND
 0x0100

	)

118 
	#S_BANDURG
 0x0200

	)

124 
	#RS_HIPRI
 0x01

	)

127 
	#RNORM
 0x0000

	)

128 
	#RMSGD
 0x0001

	)

129 
	#RMSGN
 0x0002

	)

130 
	#RPROTDAT
 0x0004

	)

132 
	#RPROTDIS
 0x0008

	)

134 
	#RPROTNORM
 0x0010

	)

137 #ifdeà
__USE_GNU


138 
	#RPROTMASK
 0x001C

	)

142 
	#SNDZERO
 0x001

	)

144 #ifdeà
__USE_GNU


145 
	#SNDPIPE
 0x002

	)

150 
	#ANYMARK
 0x01

	)

151 
	#LASTMARK
 0x02

	)

155 #ifdeà
__USE_GNU


156 
	#MUXID_ALL
 (-1è

	)

162 
	#MSG_HIPRI
 0x01

	)

163 
	#MSG_ANY
 0x02

	)

164 
	#MSG_BAND
 0x04

	)

167 
	#MORECTL
 1

	)

169 
	#MOREDATA
 2

	)

173 
	sbªdšfo


175 
	mbi_´i
;

176 
	mbi_æag
;

179 
	s¡rbuf


181 
	mmaxËn
;

182 
	mËn
;

183 *
	mbuf
;

186 
	s¡½“k


188 
¡rbuf
 
	mùlbuf
;

189 
¡rbuf
 
	md©abuf
;

190 
t_usÿÏr_t
 
	mæags
;

193 
	s¡rfdš£¹


195 
¡rbuf
 
	mùlbuf
;

196 
¡rbuf
 
	md©abuf
;

197 
t_usÿÏr_t
 
	mæags
;

198 
	mfdes
;

199 
	moff£t
;

202 
	s¡rioùl


204 
	mic_cmd
;

205 
	mic_timout
;

206 
	mic_Ën
;

207 *
	mic_dp
;

210 
	s¡¼ecvfd


212 
	mfd
;

213 
uid_t
 
	muid
;

214 
gid_t
 
	mgid
;

215 
	m__fl
[8];

219 
	s¡r_mli¡


221 
	ml_Çme
[
FMNAMESZ
 + 1];

224 
	s¡r_li¡


226 
	m¦_nmods
;

227 
¡r_mli¡
 *
	m¦_modli¡
;

	@/usr/include/bits/sys_errlist.h

19 #iâdeà
_STDIO_H


25 #ifdeà 
__USE_BSD


26 
sys_Ã¼
;

27 cÚ¡ *cÚ¡ 
sys_”¾i¡
[];

29 #ifdeà 
__USE_GNU


30 
_sys_Ã¼
;

31 cÚ¡ *cÚ¡ 
_sys_”¾i¡
[];

	@/usr/include/bits/syslog-ldbl.h

19 #iâdeà
_SYS_SYSLOG_H


23 
	$__LDBL_REDIR_DECL
 (
sy¦og
)

25 #ifdeà
__USE_BSD


26 
	$__LDBL_REDIR_DECL
 (
vsy¦og
)

29 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


30 
	$__LDBL_REDIR_DECL
 (
__sy¦og_chk
)

32 #ifdeà
__USE_BSD


33 
	$__LDBL_REDIR_DECL
 (
__vsy¦og_chk
)

	@/usr/include/bits/syslog-path.h

19 #iâdeà
_SYS_SYSLOG_H


23 #iâdeà
_BITS_SYSLOG_PATH_H


24 
	#_BITS_SYSLOG_PATH_H
 1

	)

26 
	#_PATH_LOG
 "/dev/log"

	)

	@/usr/include/bits/syslog.h

19 #iâdeà
_SYS_SYSLOG_H


24 
	$__sy¦og_chk
 (
__´i
, 
__æag
, cÚ¡ *
__fmt
, ...)

25 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

27 #ifdeà
__va_¬g_·ck


28 
__fÜtify_funùiÚ
 

29 
	$sy¦og
 (
__´i
, cÚ¡ *
__fmt
, ...)

31 
	`__sy¦og_chk
 (
__´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

32 
	}
}

33 #–ià!
defšed
 
__ılu¥lus


34 
	#sy¦og
(
´i
, ...) \

35 
	`__sy¦og_chk
 (
´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

39 #ifdeà
__USE_BSD


40 
	$__vsy¦og_chk
 (
__´i
, 
__æag
, cÚ¡ *
__fmt
,

41 
__gnuc_va_li¡
 
__­
)

42 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

44 
__fÜtify_funùiÚ
 

45 
	$vsy¦og
 (
__´i
, cÚ¡ *
__fmt
, 
__gnuc_va_li¡
 
__­
)

47 
	`__vsy¦og_chk
 (
__´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

48 
	}
}

	@/usr/include/bits/termios.h

19 #iâdeà
_TERMIOS_H


23 
	tcc_t
;

24 
	t¥“d_t
;

25 
	ttcæag_t
;

27 
	#NCCS
 32

	)

28 
	s‹rmios


30 
tcæag_t
 
	mc_iæag
;

31 
tcæag_t
 
	mc_oæag
;

32 
tcæag_t
 
	mc_cæag
;

33 
tcæag_t
 
	mc_læag
;

34 
cc_t
 
	mc_lše
;

35 
cc_t
 
	mc_cc
[
NCCS
];

36 
¥“d_t
 
	mc_i¥“d
;

37 
¥“d_t
 
	mc_o¥“d
;

38 
	#_HAVE_STRUCT_TERMIOS_C_ISPEED
 1

	)

39 
	#_HAVE_STRUCT_TERMIOS_C_OSPEED
 1

	)

43 
	#VINTR
 0

	)

44 
	#VQUIT
 1

	)

45 
	#VERASE
 2

	)

46 
	#VKILL
 3

	)

47 
	#VEOF
 4

	)

48 
	#VTIME
 5

	)

49 
	#VMIN
 6

	)

50 
	#VSWTC
 7

	)

51 
	#VSTART
 8

	)

52 
	#VSTOP
 9

	)

53 
	#VSUSP
 10

	)

54 
	#VEOL
 11

	)

55 
	#VREPRINT
 12

	)

56 
	#VDISCARD
 13

	)

57 
	#VWERASE
 14

	)

58 
	#VLNEXT
 15

	)

59 
	#VEOL2
 16

	)

62 
	#IGNBRK
 0000001

	)

63 
	#BRKINT
 0000002

	)

64 
	#IGNPAR
 0000004

	)

65 
	#PARMRK
 0000010

	)

66 
	#INPCK
 0000020

	)

67 
	#ISTRIP
 0000040

	)

68 
	#INLCR
 0000100

	)

69 
	#IGNCR
 0000200

	)

70 
	#ICRNL
 0000400

	)

71 
	#IUCLC
 0001000

	)

72 
	#IXON
 0002000

	)

73 
	#IXANY
 0004000

	)

74 
	#IXOFF
 0010000

	)

75 
	#IMAXBEL
 0020000

	)

76 
	#IUTF8
 0040000

	)

79 
	#OPOST
 0000001

	)

80 
	#OLCUC
 0000002

	)

81 
	#ONLCR
 0000004

	)

82 
	#OCRNL
 0000010

	)

83 
	#ONOCR
 0000020

	)

84 
	#ONLRET
 0000040

	)

85 
	#OFILL
 0000100

	)

86 
	#OFDEL
 0000200

	)

87 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


88 
	#NLDLY
 0000400

	)

89 
	#NL0
 0000000

	)

90 
	#NL1
 0000400

	)

91 
	#CRDLY
 0003000

	)

92 
	#CR0
 0000000

	)

93 
	#CR1
 0001000

	)

94 
	#CR2
 0002000

	)

95 
	#CR3
 0003000

	)

96 
	#TABDLY
 0014000

	)

97 
	#TAB0
 0000000

	)

98 
	#TAB1
 0004000

	)

99 
	#TAB2
 0010000

	)

100 
	#TAB3
 0014000

	)

101 
	#BSDLY
 0020000

	)

102 
	#BS0
 0000000

	)

103 
	#BS1
 0020000

	)

104 
	#FFDLY
 0100000

	)

105 
	#FF0
 0000000

	)

106 
	#FF1
 0100000

	)

109 
	#VTDLY
 0040000

	)

110 
	#VT0
 0000000

	)

111 
	#VT1
 0040000

	)

113 #ifdeà
__USE_MISC


114 
	#XTABS
 0014000

	)

118 #ifdeà
__USE_MISC


119 
	#CBAUD
 0010017

	)

121 
	#B0
 0000000

	)

122 
	#B50
 0000001

	)

123 
	#B75
 0000002

	)

124 
	#B110
 0000003

	)

125 
	#B134
 0000004

	)

126 
	#B150
 0000005

	)

127 
	#B200
 0000006

	)

128 
	#B300
 0000007

	)

129 
	#B600
 0000010

	)

130 
	#B1200
 0000011

	)

131 
	#B1800
 0000012

	)

132 
	#B2400
 0000013

	)

133 
	#B4800
 0000014

	)

134 
	#B9600
 0000015

	)

135 
	#B19200
 0000016

	)

136 
	#B38400
 0000017

	)

137 #ifdeà
__USE_MISC


138 
	#EXTA
 
B19200


	)

139 
	#EXTB
 
B38400


	)

141 
	#CSIZE
 0000060

	)

142 
	#CS5
 0000000

	)

143 
	#CS6
 0000020

	)

144 
	#CS7
 0000040

	)

145 
	#CS8
 0000060

	)

146 
	#CSTOPB
 0000100

	)

147 
	#CREAD
 0000200

	)

148 
	#PARENB
 0000400

	)

149 
	#PARODD
 0001000

	)

150 
	#HUPCL
 0002000

	)

151 
	#CLOCAL
 0004000

	)

152 #ifdeà
__USE_MISC


153 
	#CBAUDEX
 0010000

	)

155 
	#B57600
 0010001

	)

156 
	#B115200
 0010002

	)

157 
	#B230400
 0010003

	)

158 
	#B460800
 0010004

	)

159 
	#B500000
 0010005

	)

160 
	#B576000
 0010006

	)

161 
	#B921600
 0010007

	)

162 
	#B1000000
 0010010

	)

163 
	#B1152000
 0010011

	)

164 
	#B1500000
 0010012

	)

165 
	#B2000000
 0010013

	)

166 
	#B2500000
 0010014

	)

167 
	#B3000000
 0010015

	)

168 
	#B3500000
 0010016

	)

169 
	#B4000000
 0010017

	)

170 
	#__MAX_BAUD
 
B4000000


	)

171 #ifdeà
__USE_MISC


172 
	#CIBAUD
 002003600000

	)

173 
	#CMSPAR
 010000000000

	)

174 
	#CRTSCTS
 020000000000

	)

178 
	#ISIG
 0000001

	)

179 
	#ICANON
 0000002

	)

180 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


181 
	#XCASE
 0000004

	)

183 
	#ECHO
 0000010

	)

184 
	#ECHOE
 0000020

	)

185 
	#ECHOK
 0000040

	)

186 
	#ECHONL
 0000100

	)

187 
	#NOFLSH
 0000200

	)

188 
	#TOSTOP
 0000400

	)

189 #ifdeà
__USE_MISC


190 
	#ECHOCTL
 0001000

	)

191 
	#ECHOPRT
 0002000

	)

192 
	#ECHOKE
 0004000

	)

193 
	#FLUSHO
 0010000

	)

194 
	#PENDIN
 0040000

	)

196 
	#IEXTEN
 0100000

	)

197 #ifdeà
__USE_BSD


198 
	#EXTPROC
 0200000

	)

202 
	#TCOOFF
 0

	)

203 
	#TCOON
 1

	)

204 
	#TCIOFF
 2

	)

205 
	#TCION
 3

	)

208 
	#TCIFLUSH
 0

	)

209 
	#TCOFLUSH
 1

	)

210 
	#TCIOFLUSH
 2

	)

213 
	#TCSANOW
 0

	)

214 
	#TCSADRAIN
 1

	)

215 
	#TCSAFLUSH
 2

	)

218 
	#_IOT_‹rmios
 \

219 
	`_IOT
 (
	`_IOTS
 (
cæag_t
), 4, _IOTS (
cc_t
), 
NCCS
, _IOTS (
¥“d_t
), 2)

	)

	@/usr/include/bits/time.h

23 #ià
defšed
 
__Ãed_timev®
 || defšed 
__USE_GNU


24 #iâdeà
_STRUCT_TIMEVAL


25 
	#_STRUCT_TIMEVAL
 1

	)

26 
	~<b™s/ty³s.h
>

30 
	stimev®


32 
__time_t
 
	mtv_£c
;

33 
__su£cÚds_t
 
	mtv_u£c
;

38 #iâdeà
__Ãed_timev®


39 #iâdeà
_BITS_TIME_H


40 
	#_BITS_TIME_H
 1

	)

48 
	#CLOCKS_PER_SEC
 1000000l

	)

50 #ià(!
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_POSIX
) \

51 && !
defšed
 
	g__USE_XOPEN2K


54 
	~<b™s/ty³s.h
>

55 
__syscÚf
 ();

56 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

59 #ifdeà
__USE_POSIX199309


61 
	#CLOCK_REALTIME
 0

	)

63 
	#CLOCK_MONOTONIC
 1

	)

65 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

67 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

69 
	#CLOCK_MONOTONIC_RAW
 4

	)

71 
	#CLOCK_REALTIME_COARSE
 5

	)

73 
	#CLOCK_MONOTONIC_COARSE
 6

	)

75 
	#CLOCK_BOOTTIME
 7

	)

77 
	#CLOCK_REALTIME_ALARM
 8

	)

79 
	#CLOCK_BOOTTIME_ALARM
 9

	)

82 
	#TIMER_ABSTIME
 1

	)

85 #ifdeà
__USE_GNU


86 
	~<b™s/timex.h
>

88 
__BEGIN_DECLS


91 
	$şock_adjtime
 (
__şockid_t
 
__şock_id
, 
timex
 *
__utx
è
__THROW
;

93 
__END_DECLS


99 #undeà
__Ãed_timev®


	@/usr/include/bits/types.h

23 #iâdef 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wÜdsize.h
>

30 
	t__u_ch¬
;

31 
	t__u_shÜt
;

32 
	t__u_št
;

33 
	t__u_lÚg
;

36 sigÃd 
	t__št8_t
;

37 
	t__ušt8_t
;

38 sigÃd 
	t__št16_t
;

39 
	t__ušt16_t
;

40 sigÃd 
	t__št32_t
;

41 
	t__ušt32_t
;

42 #ià
__WORDSIZE
 == 64

43 sigÃd 
	t__št64_t
;

44 
	t__ušt64_t
;

46 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

47 
__ex‹nsiÚ__
 
	t__ušt64_t
;

51 #ià
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

55 
__ex‹nsiÚ__
 
	t__quad_t
;

56 
__ex‹nsiÚ__
 
	t__u_quad_t
;

89 
	#__S16_TYPE
 

	)

90 
	#__U16_TYPE
 

	)

91 
	#__S32_TYPE
 

	)

92 
	#__U32_TYPE
 

	)

93 
	#__SLONGWORD_TYPE
 

	)

94 
	#__ULONGWORD_TYPE
 

	)

95 #ià
__WORDSIZE
 == 32

96 
	#__SQUAD_TYPE
 
__quad_t


	)

97 
	#__UQUAD_TYPE
 
__u_quad_t


	)

98 
	#__SWORD_TYPE
 

	)

99 
	#__UWORD_TYPE
 

	)

100 
	#__SLONG32_TYPE
 

	)

101 
	#__ULONG32_TYPE
 

	)

102 
	#__S64_TYPE
 
__quad_t


	)

103 
	#__U64_TYPE
 
__u_quad_t


	)

106 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

107 #–ià
__WORDSIZE
 == 64

108 
	t__SQUAD_TYPE
 

	)

109 
	t__UQUAD_TYPE
 

	)

110 
	t__SWORD_TYPE
 

	)

111 
	t__UWORD_TYPE
 

	)

112 
	t__SLONG32_TYPE
 

	)

113 
	t__ULONG32_TYPE
 

	)

114 
	t__S64_TYPE
 

	)

115 
	t__U64_TYPE
 

	)

117 
	t__STD_TYPE
 

	)

121 
	~<b™s/ty³sizes.h
>

124 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

125 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

126 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

127 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

128 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

129 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

130 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

131 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

132 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

133 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

134 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

135 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

136 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

137 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

138 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

139 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

140 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

141 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

143 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

144 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

147 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

150 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

153 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

158 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

159 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

162 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

163 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

166 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

167 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

170 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fswÜd_t
;

172 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

175 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysÿÎ_¦Úg_t
;

177 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysÿÎ_ulÚg_t
;

181 
__off64_t
 
	t__loff_t
;

182 
__quad_t
 *
	t__qaddr_t
;

183 *
	t__ÿddr_t
;

186 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

189 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

192 #undeà
__STD_TYPE


	@/usr/include/bits/uio.h

18 #ià!
defšed
 
_SYS_UIO_H
 && !defšed 
_FCNTL_H


22 #iâdeà
_BITS_UIO_H


23 
	#_BITS_UIO_H
 1

	)

25 
	~<sys/ty³s.h
>

39 
	#UIO_MAXIOV
 1024

	)

43 
	siovec


45 *
	miov_ba£
;

46 
size_t
 
	miov_Ën
;

52 #ifdeà
__USE_GNU


53 #ià
defšed
 
_SYS_UIO_H
 && !defšed 
_BITS_UIO_H_FOR_SYS_UIO_H


54 
	#_BITS_UIO_H_FOR_SYS_UIO_H
 1

	)

56 
__BEGIN_DECLS


59 
ssize_t
 
	$´oûss_vm_»adv
 (
pid_t
 
__pid
, cÚ¡ 
iovec
 *
__lvec
,

60 
__liovút
,

61 cÚ¡ 
iovec
 *
__rvec
,

62 
__riovút
,

63 
__æags
)

64 
__THROW
;

67 
ssize_t
 
	$´oûss_vm_wr™ev
 (
pid_t
 
__pid
, cÚ¡ 
iovec
 *
__lvec
,

68 
__liovút
,

69 cÚ¡ 
iovec
 *
__rvec
,

70 
__riovút
,

71 
__æags
)

72 
__THROW
;

74 
__END_DECLS


	@/usr/include/bits/unistd.h

19 #iâdeà
_UNISTD_H


23 
ssize_t
 
	$__»ad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

24 
size_t
 
__buæ’
è
__wur
;

25 
ssize_t
 
	`__REDIRECT
 (
__»ad_®Ÿs
, (
__fd
, *
__buf
,

26 
size_t
 
__nby‹s
), 
»ad
è
__wur
;

27 
ssize_t
 
	`__REDIRECT
 (
__»ad_chk_w¬n
,

28 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

29 
size_t
 
__buæ’
), 
__»ad_chk
)

30 
__wur
 
	`__w¬Ç‰r
 ("read called with bigger†engthhan size of "

33 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


34 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
)

36 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

38 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

39  
	`__»ad_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

41 ià(
__nby‹s
 > 
	`__bos0
 (
__buf
))

42  
	`__»ad_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

44  
	`__»ad_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
);

45 
	}
}

47 #ifdeà
__USE_UNIX98


48 
ssize_t
 
	$__´—d_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

49 
__off_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

50 
ssize_t
 
	$__´—d64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

51 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

52 
ssize_t
 
	`__REDIRECT
 (
__´—d_®Ÿs
,

53 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

54 
__off_t
 
__off£t
), 
´—d
è
__wur
;

55 
ssize_t
 
	`__REDIRECT
 (
__´—d64_®Ÿs
,

56 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

57 
__off64_t
 
__off£t
), 
´—d64
è
__wur
;

58 
ssize_t
 
	`__REDIRECT
 (
__´—d_chk_w¬n
,

59 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

60 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__´—d_chk
)

61 
__wur
 
	`__w¬Ç‰r
 ("pread called with bigger†engthhan size of "

63 
ssize_t
 
	`__REDIRECT
 (
__´—d64_chk_w¬n
,

64 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

65 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

66 
__´—d64_chk
)

67 
__wur
 
	`__w¬Ç‰r
 ("pread64 called with bigger†engthhan size of "

70 #iâdeà
__USE_FILE_OFFSET64


71 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


72 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off_t
 
__off£t
)

74 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

76 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

77  
	`__´—d_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

79 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

80  
	`__´—d_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

81 
	`__bos0
 (
__buf
));

83  
	`__´—d_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

84 
	}
}

86 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


87 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

89 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

91 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

92  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

94 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

95  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

96 
	`__bos0
 (
__buf
));

99  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

100 
	}
}

103 #ifdeà
__USE_LARGEFILE64


104 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


105 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

107 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

109 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

110  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

112 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

113  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

114 
	`__bos0
 (
__buf
));

117  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

118 
	}
}

122 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


123 
ssize_t
 
	$__»adlšk_chk
 (cÚ¡ *
__»¡riù
 
__·th
,

124 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

125 
size_t
 
__buæ’
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

127 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_®Ÿs
,

128 (cÚ¡ *
__»¡riù
 
__·th
,

129 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
), 
»adlšk
)

130 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

131 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_chk_w¬n
,

132 (cÚ¡ *
__»¡riù
 
__·th
,

133 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

134 
size_t
 
__buæ’
), 
__»adlšk_chk
)

135 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
	`__w¬Ç‰r
 ("readlink called with bigger†ength "

138 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
ssize_t


139 
	`__NTH
 (
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
, *__»¡riù 
__buf
,

140 
size_t
 
__Ën
))

142 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

144 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

145  
	`__»adlšk_chk
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

147 iàĞ
__Ën
 > 
	`__bos
 (
__buf
))

148  
	`__»adlšk_chk_w¬n
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

150  
	`__»adlšk_®Ÿs
 (
__·th
, 
__buf
, 
__Ën
);

151 
	}
}

154 #ifdeà
__USE_ATFILE


155 
ssize_t
 
	$__»adlšk©_chk
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

156 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

157 
size_t
 
__buæ’
)

158 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

159 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_®Ÿs
,

160 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

161 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
),

162 
»adlšk©
)

163 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

164 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_chk_w¬n
,

165 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

166 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

167 
size_t
 
__buæ’
), 
__»adlšk©_chk
)

168 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
	`__w¬Ç‰r
 ("readlinkat called with bigger "

172 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
ssize_t


173 
	`__NTH
 (
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

174 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
))

176 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

178 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

179  
	`__»adlšk©_chk
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

181 ià(
__Ën
 > 
	`__bos
 (
__buf
))

182  
	`__»adlšk©_chk_w¬n
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
,

183 
	`__bos
 (
__buf
));

185  
	`__»adlšk©_®Ÿs
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
);

186 
	}
}

189 *
	$__g‘cwd_chk
 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
)

190 
__THROW
 
__wur
;

191 *
	`__REDIRECT_NTH
 (
__g‘cwd_®Ÿs
,

192 (*
__buf
, 
size_t
 
__size
), 
g‘cwd
è
__wur
;

193 *
	`__REDIRECT_NTH
 (
__g‘cwd_chk_w¬n
,

194 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
),

195 
__g‘cwd_chk
)

196 
__wur
 
	`__w¬Ç‰r
 ("getcwd caller with bigger†engthhan size of "

199 
__fÜtify_funùiÚ
 
__wur
 *

200 
	`__NTH
 (
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
))

202 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

204 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

205  
	`__g‘cwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

207 ià(
__size
 > 
	`__bos
 (
__buf
))

208  
	`__g‘cwd_chk_w¬n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

210  
	`__g‘cwd_®Ÿs
 (
__buf
, 
__size
);

211 
	}
}

213 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


214 *
	$__g‘wd_chk
 (*
__buf
, 
size_t
 
buæ’
)

215 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

216 *
	`__REDIRECT_NTH
 (
__g‘wd_w¬n
, (*
__buf
), 
g‘wd
)

217 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("please use getcwd instead,‡s getwd "

220 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
 *

221 
	`__NTH
 (
	$g‘wd
 (*
__buf
))

223 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

224  
	`__g‘wd_chk
 (
__buf
, 
	`__bos
 (__buf));

225  
	`__g‘wd_w¬n
 (
__buf
);

226 
	}
}

229 
size_t
 
	$__cÚf¡r_chk
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

230 
size_t
 
__buæ’
è
__THROW
;

231 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_®Ÿs
, (
__Çme
, *
__buf
,

232 
size_t
 
__Ën
), 
cÚf¡r
);

233 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_chk_w¬n
,

234 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

235 
size_t
 
__buæ’
), 
__cÚf¡r_chk
)

236 
	`__w¬Ç‰r
 ("confstr called with bigger†engthhan size of destination "

239 
__fÜtify_funùiÚ
 
size_t


240 
	`__NTH
 (
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
))

242 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

244 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

245  
	`__cÚf¡r_chk
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

247 ià(
	`__bos
 (
__buf
è< 
__Ën
)

248  
	`__cÚf¡r_chk_w¬n
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

250  
	`__cÚf¡r_®Ÿs
 (
__Çme
, 
__buf
, 
__Ën
);

251 
	}
}

254 
	$__g‘groups_chk
 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
)

255 
__THROW
 
__wur
;

256 
	`__REDIRECT_NTH
 (
__g‘groups_®Ÿs
, (
__size
, 
__gid_t
 
__li¡
[]),

257 
g‘groups
è
__wur
;

258 
	`__REDIRECT_NTH
 (
__g‘groups_chk_w¬n
,

259 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
),

260 
__g‘groups_chk
)

261 
__wur
 
	`__w¬Ç‰r
 ("getgroups called with bigger group counthan what "

264 
__fÜtify_funùiÚ
 

265 
	`__NTH
 (
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]))

267 ià(
	`__bos
 (
__li¡
è!ğ(
size_t
) -1)

269 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
) || __size < 0)

270  
	`__g‘groups_chk
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

272 ià(
__size
 *  (
__gid_t
è> 
	`__bos
 (
__li¡
))

273  
	`__g‘groups_chk_w¬n
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

275  
	`__g‘groups_®Ÿs
 (
__size
, 
__li¡
);

276 
	}
}

279 
	$__‰yÇme_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

280 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

281 
	`__REDIRECT_NTH
 (
__‰yÇme_r_®Ÿs
, (
__fd
, *
__buf
,

282 
size_t
 
__buæ’
), 
‰yÇme_r
)

283 
	`__nÚnuÎ
 ((2));

284 
	`__REDIRECT_NTH
 (
__‰yÇme_r_chk_w¬n
,

285 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

286 
size_t
 
__Ä—l
), 
__‰yÇme_r_chk
)

287 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ttyname_r called with bigger buflenhan "

290 
__fÜtify_funùiÚ
 

291 
	`__NTH
 (
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

293 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

295 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

296  
	`__‰yÇme_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

298 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

299  
	`__‰yÇme_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

301  
	`__‰yÇme_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

302 
	}
}

305 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


306 
	$__g‘logš_r_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

307 
	`__nÚnuÎ
 ((1));

308 
	`__REDIRECT
 (
__g‘logš_r_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

309 
g‘logš_r
è
	`__nÚnuÎ
 ((1));

310 
	`__REDIRECT
 (
__g‘logš_r_chk_w¬n
,

311 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

312 
__g‘logš_r_chk
)

313 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("getlogin_r called with bigger buflenhan "

316 
__fÜtify_funùiÚ
 

317 
	$g‘logš_r
 (*
__buf
, 
size_t
 
__buæ’
)

319 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

321 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

322  
	`__g‘logš_r_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

324 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

325  
	`__g‘logš_r_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

327  
	`__g‘logš_r_®Ÿs
 (
__buf
, 
__buæ’
);

328 
	}
}

332 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


333 
	$__g‘ho¡Çme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

334 
__THROW
 
	`__nÚnuÎ
 ((1));

335 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

336 
g‘ho¡Çme
è
	`__nÚnuÎ
 ((1));

337 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_chk_w¬n
,

338 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

339 
__g‘ho¡Çme_chk
)

340 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("gethostname called with bigger buflenhan "

343 
__fÜtify_funùiÚ
 

344 
	`__NTH
 (
	$g‘ho¡Çme
 (*
__buf
, 
size_t
 
__buæ’
))

346 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

348 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

349  
	`__g‘ho¡Çme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

351 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

352  
	`__g‘ho¡Çme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

354  
	`__g‘ho¡Çme_®Ÿs
 (
__buf
, 
__buæ’
);

355 
	}
}

359 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

360 
	$__g‘domašÇme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

361 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

362 
	`__REDIRECT_NTH
 (
__g‘domašÇme_®Ÿs
, (*
__buf
,

363 
size_t
 
__buæ’
),

364 
g‘domašÇme
è
	`__nÚnuÎ
 ((1)è
__wur
;

365 
	`__REDIRECT_NTH
 (
__g‘domašÇme_chk_w¬n
,

366 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

367 
__g‘domašÇme_chk
)

368 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("getdomainname called with bigger "

372 
__fÜtify_funùiÚ
 

373 
	`__NTH
 (
	$g‘domašÇme
 (*
__buf
, 
size_t
 
__buæ’
))

375 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

377 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

378  
	`__g‘domašÇme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

380 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

381  
	`__g‘domašÇme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

383  
	`__g‘domašÇme_®Ÿs
 (
__buf
, 
__buæ’
);

384 
	}
}

	@/usr/include/bits/utmp.h

19 #iâdeà
_UTMP_H


23 
	~<·ths.h
>

24 
	~<sys/time.h
>

25 
	~<sys/ty³s.h
>

26 
	~<b™s/wÜdsize.h
>

29 
	#UT_LINESIZE
 32

	)

30 
	#UT_NAMESIZE
 32

	)

31 
	#UT_HOSTSIZE
 256

	)

36 
	sÏ¡log


38 #ifdeà
__WORDSIZE_TIME64_COMPAT32


39 
št32_t
 
	mÎ_time
;

41 
__time_t
 
	mÎ_time
;

43 
	mÎ_lše
[
UT_LINESIZE
];

44 
	mÎ_ho¡
[
UT_HOSTSIZE
];

50 
	sex™_¡©us


52 
	me_‹rmš©iÚ
;

53 
	me_ex™
;

58 
	sutmp


60 
	mut_ty³
;

61 
pid_t
 
	mut_pid
;

62 
	mut_lše
[
UT_LINESIZE
];

63 
	mut_id
[4];

64 
	mut_u£r
[
UT_NAMESIZE
];

65 
	mut_ho¡
[
UT_HOSTSIZE
];

66 
ex™_¡©us
 
	mut_ex™
;

71 #ifdeà
__WORDSIZE_TIME64_COMPAT32


72 
št32_t
 
	mut_£ssiÚ
;

75 
št32_t
 
	mtv_£c
;

76 
št32_t
 
	mtv_u£c
;

77 } 
	mut_tv
;

79 
	mut_£ssiÚ
;

80 
timev®
 
	mut_tv
;

83 
št32_t
 
	mut_addr_v6
[4];

84 
	m__glibc_»£rved
[20];

88 
	#ut_Çme
 
ut_u£r


	)

89 #iâdeà
_NO_UT_TIME


92 
	#ut_time
 
ut_tv
.
tv_£c


	)

94 
	#ut_xtime
 
ut_tv
.
tv_£c


	)

95 
	#ut_addr
 
ut_addr_v6
[0]

	)

99 
	#EMPTY
 0

	)

101 
	#RUN_LVL
 1

	)

102 
	#BOOT_TIME
 2

	)

103 
	#NEW_TIME
 3

	)

104 
	#OLD_TIME
 4

	)

106 
	#INIT_PROCESS
 5

	)

107 
	#LOGIN_PROCESS
 6

	)

108 
	#USER_PROCESS
 7

	)

109 
	#DEAD_PROCESS
 8

	)

111 
	#ACCOUNTING
 9

	)

114 
	#UT_UNKNOWN
 
EMPTY


	)

119 
	#_HAVE_UT_TYPE
 1

	)

120 
	#_HAVE_UT_PID
 1

	)

121 
	#_HAVE_UT_ID
 1

	)

122 
	#_HAVE_UT_TV
 1

	)

123 
	#_HAVE_UT_HOST
 1

	)

	@/usr/include/bits/utmpx.h

19 #iâdeà
_UTMPX_H


23 
	~<b™s/ty³s.h
>

24 
	~<sys/time.h
>

25 
	~<b™s/wÜdsize.h
>

28 #ifdeà
__USE_GNU


29 
	~<·ths.h
>

30 
	#_PATH_UTMPX
 
_PATH_UTMP


	)

31 
	#_PATH_WTMPX
 
_PATH_WTMP


	)

35 
	#__UT_LINESIZE
 32

	)

36 
	#__UT_NAMESIZE
 32

	)

37 
	#__UT_HOSTSIZE
 256

	)

42 
	s__ex™_¡©us


44 #ifdeà
__USE_GNU


45 
	me_‹rmš©iÚ
;

46 
	me_ex™
;

48 
	m__e_‹rmš©iÚ
;

49 
	m__e_ex™
;

55 
	sutmpx


57 
	mut_ty³
;

58 
__pid_t
 
	mut_pid
;

59 
	mut_lše
[
__UT_LINESIZE
];

60 
	mut_id
[4];

61 
	mut_u£r
[
__UT_NAMESIZE
];

62 
	mut_ho¡
[
__UT_HOSTSIZE
];

63 
__ex™_¡©us
 
	mut_ex™
;

69 #ifdeà
__WORDSIZE_TIME64_COMPAT32


70 
__št32_t
 
	mut_£ssiÚ
;

73 
__št32_t
 
	mtv_£c
;

74 
__št32_t
 
	mtv_u£c
;

75 } 
	mut_tv
;

77 
	mut_£ssiÚ
;

78 
timev®
 
	mut_tv
;

80 
__št32_t
 
	mut_addr_v6
[4];

81 
	m__glibc_»£rved
[20];

86 
	#EMPTY
 0

	)

88 #ifdeà
__USE_GNU


89 
	#RUN_LVL
 1

	)

91 
	#BOOT_TIME
 2

	)

92 
	#NEW_TIME
 3

	)

93 
	#OLD_TIME
 4

	)

95 
	#INIT_PROCESS
 5

	)

96 
	#LOGIN_PROCESS
 6

	)

97 
	#USER_PROCESS
 7

	)

98 
	#DEAD_PROCESS
 8

	)

100 #ifdeà
__USE_GNU


101 
	#ACCOUNTING
 9

	)

	@/usr/include/bits/waitflags.h

19 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


25 
	#WNOHANG
 1

	)

26 
	#WUNTRACED
 2

	)

29 
	#WSTOPPED
 2

	)

30 
	#WEXITED
 4

	)

31 
	#WCONTINUED
 8

	)

32 
	#WNOWAIT
 0x01000000

	)

34 
	#__WNOTHREAD
 0x20000000

	)

36 
	#__WALL
 0x40000000

	)

37 
	#__WCLONE
 0x80000000

	)

40 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


41 #iâdeà
__ENUM_IDTYPE_T


42 
	#__ENUM_IDTYPE_T
 1

	)

46 #undeà
P_ALL


47 #undeà
P_PID


48 #undeà
P_PGID


52 
	mP_ALL
,

53 
	mP_PID
,

54 
	mP_PGID


55 } 
	tidty³_t
;

	@/usr/include/bits/waitstatus.h

19 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


28 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

31 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

34 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

37 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

40 
	#__WIFSIGNALED
(
¡©us
) \

41 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

44 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

48 #ifdeà
WCONTINUED


49 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

53 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

58 
	#__W_CONTINUED
 0xffff

	)

59 
	#__WCOREFLAG
 0x80

	)

62 #ifdef 
__USE_BSD


64 
	~<’dŸn.h
>

66 
	uwa™


68 
	mw_¡©us
;

71 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


72 
	m__w_‹rmsig
:7;

73 
	m__w_cÜedump
:1;

74 
	m__w_»tcode
:8;

77 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


79 
	m__w_»tcode
:8;

80 
	m__w_cÜedump
:1;

81 
	m__w_‹rmsig
:7;

83 } 
	m__wa™_‹rmš©ed
;

86 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


87 
	m__w_¡İv®
:8;

88 
	m__w_¡İsig
:8;

91 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


93 
	m__w_¡İsig
:8;

94 
	m__w_¡İv®
:8;

96 } 
	m__wa™_¡İ³d
;

99 
	#w_‹rmsig
 
__wa™_‹rmš©ed
.
__w_‹rmsig


	)

100 
	#w_cÜedump
 
__wa™_‹rmš©ed
.
__w_cÜedump


	)

101 
	#w_»tcode
 
__wa™_‹rmš©ed
.
__w_»tcode


	)

102 
	#w_¡İsig
 
__wa™_¡İ³d
.
__w_¡İsig


	)

103 
	#w_¡İv®
 
__wa™_¡İ³d
.
__w_¡İv®


	)

	@/usr/include/bits/wchar-ldbl.h

19 #iâdeà
_WCHAR_H


23 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


24 
__BEGIN_NAMESPACE_C99


25 
__LDBL_REDIR_DECL
 (
fw´štf
);

26 
__LDBL_REDIR_DECL
 (
w´štf
);

27 
__LDBL_REDIR_DECL
 (
sw´štf
);

28 
__LDBL_REDIR_DECL
 (
vfw´štf
);

29 
__LDBL_REDIR_DECL
 (
vw´štf
);

30 
__LDBL_REDIR_DECL
 (
vsw´štf
);

31 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

32 && !
defšed
 
	g__REDIRECT
 \

33 && (
defšed
 
	g__STRICT_ANSI__
 || defšed 
	g__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fwsÿnf
, 
__Ædbl___isoc99_fwsÿnf
)

35 
	$__LDBL_REDIR1_DECL
 (
wsÿnf
, 
__Ædbl___isoc99_wsÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
swsÿnf
, 
__Ædbl___isoc99_swsÿnf
)

38 
	`__LDBL_REDIR_DECL
 (
fwsÿnf
);

39 
	`__LDBL_REDIR_DECL
 (
wsÿnf
);

40 
	`__LDBL_REDIR_DECL
 (
swsÿnf
);

42 
__END_NAMESPACE_C99


45 #ifdeà
__USE_ISOC99


46 
__BEGIN_NAMESPACE_C99


47 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd
, 
wc¡od
);

48 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

49 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

50 
	$__LDBL_REDIR1_DECL
 (
vfwsÿnf
, 
__Ædbl___isoc99_vfwsÿnf
)

51 
	$__LDBL_REDIR1_DECL
 (
vwsÿnf
, 
__Ædbl___isoc99_vwsÿnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vswsÿnf
, 
__Ædbl___isoc99_vswsÿnf
)

54 
	`__LDBL_REDIR_DECL
 (
vfwsÿnf
);

55 
	`__LDBL_REDIR_DECL
 (
vwsÿnf
);

56 
	`__LDBL_REDIR_DECL
 (
vswsÿnf
);

58 
__END_NAMESPACE_C99


61 #ifdeà
__USE_GNU


62 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd_l
, 
wc¡od_l
);

65 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


66 
	$__LDBL_REDIR_DECL
 (
__sw´štf_chk
)

67 
	$__LDBL_REDIR_DECL
 (
__vsw´štf_chk
)

68 #ià
__USE_FORTIFY_LEVEL
 > 1

69 
	$__LDBL_REDIR_DECL
 (
__fw´štf_chk
)

70 
	$__LDBL_REDIR_DECL
 (
__w´štf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__vfw´štf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vw´štf_chk
)

	@/usr/include/bits/wchar.h

19 #iâdeà
_BITS_WCHAR_H


20 
	#_BITS_WCHAR_H
 1

	)

33 #ifdeà
__WCHAR_MAX__


34 
	#__WCHAR_MAX
 
__WCHAR_MAX__


	)

35 #–ià
L
'\0' - 1 > 0

36 
	#__WCHAR_MAX
 (0xffffffffu + 
L
'\0')

	)

38 
	#__WCHAR_MAX
 (0x7ffffffà+ 
L
'\0')

	)

41 #ifdeà
__WCHAR_MIN__


42 
	#__WCHAR_MIN
 
__WCHAR_MIN__


	)

43 #–ià
L
'\0' - 1 > 0

44 
	#__WCHAR_MIN
 (
L
'\0' + 0)

	)

46 
	#__WCHAR_MIN
 (-
__WCHAR_MAX
 - 1)

	)

	@/usr/include/bits/wchar2.h

19 #iâdeà
_WCHAR_H


24 
wch¬_t
 *
	$__wmemıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

25 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

26 
size_t
 
__ns1
è
__THROW
;

27 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_®Ÿs
,

28 (
wch¬_t
 *
__»¡riù
 
__s1
,

29 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
),

30 
wmemıy
);

31 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_chk_w¬n
,

32 (
wch¬_t
 *
__»¡riù
 
__s1
,

33 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

34 
size_t
 
__ns1
), 
__wmemıy_chk
)

35 
	`__w¬Ç‰r
 ("wmemcpy called with†ength biggerhan size of destination "

38 
__fÜtify_funùiÚ
 
wch¬_t
 *

39 
	`__NTH
 (
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, cÚ¡ wch¬_ˆ*__»¡riù 
__s2
,

40 
size_t
 
__n
))

42 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

44 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

45  
	`__wmemıy_chk
 (
__s1
, 
__s2
, 
__n
,

46 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

48 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

49  
	`__wmemıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

50 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

52  
	`__wmemıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

53 
	}
}

56 
wch¬_t
 *
	$__wmemmove_chk
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

57 
size_t
 
__n
, size_ˆ
__ns1
è
__THROW
;

58 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_®Ÿs
, (wch¬_ˆ*
__s1
,

59 cÚ¡ 
wch¬_t
 *
__s2
,

60 
size_t
 
__n
), 
wmemmove
);

61 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¬n
,

62 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

63 
size_t
 
__n
, size_ˆ
__ns1
), 
__wmemmove_chk
)

64 
	`__w¬Ç‰r
 ("wmemmove called with†ength biggerhan size of destination "

67 
__fÜtify_funùiÚ
 
wch¬_t
 *

68 
	`__NTH
 (
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
))

70 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

72 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

73  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

74 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

76 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

77  
	`__wmemmove_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

78 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

80  
	`__wmemmove_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

81 
	}
}

84 #ifdeà
__USE_GNU


85 
wch¬_t
 *
	$__wmempıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

86 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

87 
size_t
 
__ns1
è
__THROW
;

88 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_®Ÿs
,

89 (
wch¬_t
 *
__»¡riù
 
__s1
,

90 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
,

91 
size_t
 
__n
), 
wmempıy
);

92 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_chk_w¬n
,

93 (
wch¬_t
 *
__»¡riù
 
__s1
,

94 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

95 
size_t
 
__ns1
), 
__wmempıy_chk
)

96 
	`__w¬Ç‰r
 ("wmempcpy called with†ength biggerhan size of destination "

99 
__fÜtify_funùiÚ
 
wch¬_t
 *

100 
	`__NTH
 (
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, cÚ¡ wch¬_ˆ*__»¡riù 
__s2
,

101 
size_t
 
__n
))

103 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

105 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

106  
	`__wmempıy_chk
 (
__s1
, 
__s2
, 
__n
,

107 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

109 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

110  
	`__wmempıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

111 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

113  
	`__wmempıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

114 
	}
}

118 
wch¬_t
 *
	$__wmem£t_chk
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

119 
size_t
 
__ns
è
__THROW
;

120 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_®Ÿs
, (wch¬_ˆ*
__s
, wch¬_ˆ
__c
,

121 
size_t
 
__n
), 
wmem£t
);

122 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¬n
,

123 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

124 
size_t
 
__ns
), 
__wmem£t_chk
)

125 
	`__w¬Ç‰r
 ("wmemset called with†ength biggerhan size of destination "

128 
__fÜtify_funùiÚ
 
wch¬_t
 *

129 
	`__NTH
 (
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
))

131 ià(
	`__bos0
 (
__s
è!ğ(
size_t
) -1)

133 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

134  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sè/  (
wch¬_t
));

136 ià(
__n
 > 
	`__bos0
 (
__s
è/  (
wch¬_t
))

137  
	`__wmem£t_chk_w¬n
 (
__s
, 
__c
, 
__n
,

138 
	`__bos0
 (
__s
è/  (
wch¬_t
));

140  
	`__wmem£t_®Ÿs
 (
__s
, 
__c
, 
__n
);

141 
	}
}

144 
wch¬_t
 *
	$__wcsıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

145 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

146 
size_t
 
__n
è
__THROW
;

147 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsıy_®Ÿs
,

148 (
wch¬_t
 *
__»¡riù
 
__de¡
,

149 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsıy
);

151 
__fÜtify_funùiÚ
 
wch¬_t
 *

152 
	`__NTH
 (
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
))

154 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

155  
	`__wcsıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

156  
	`__wcsıy_®Ÿs
 (
__de¡
, 
__¤c
);

157 
	}
}

160 
wch¬_t
 *
	$__wııy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

161 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

162 
size_t
 
__de¡Ën
è
__THROW
;

163 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wııy_®Ÿs
,

164 (
wch¬_t
 *
__»¡riù
 
__de¡
,

165 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wııy
);

167 
__fÜtify_funùiÚ
 
wch¬_t
 *

168 
	`__NTH
 (
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
))

170 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

171  
	`__wııy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

172  
	`__wııy_®Ÿs
 (
__de¡
, 
__¤c
);

173 
	}
}

176 
wch¬_t
 *
	$__wc¢ıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

177 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

178 
size_t
 
__de¡Ën
è
__THROW
;

179 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_®Ÿs
,

180 (
wch¬_t
 *
__»¡riù
 
__de¡
,

181 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

182 
size_t
 
__n
), 
wc¢ıy
);

183 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_chk_w¬n
,

184 (
wch¬_t
 *
__»¡riù
 
__de¡
,

185 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

186 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wc¢ıy_chk
)

187 
	`__w¬Ç‰r
 ("wcsncpy called with†ength biggerhan size of destination "

190 
__fÜtify_funùiÚ
 
wch¬_t
 *

191 
	`__NTH
 (
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
,

192 
size_t
 
__n
))

194 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

196 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

197  
	`__wc¢ıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

198 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

199 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

200  
	`__wc¢ıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

201 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

203  
	`__wc¢ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

204 
	}
}

207 
wch¬_t
 *
	$__wınıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

208 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

209 
size_t
 
__de¡Ën
è
__THROW
;

210 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_®Ÿs
,

211 (
wch¬_t
 *
__»¡riù
 
__de¡
,

212 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

213 
size_t
 
__n
), 
wınıy
);

214 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_chk_w¬n
,

215 (
wch¬_t
 *
__»¡riù
 
__de¡
,

216 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

217 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wınıy_chk
)

218 
	`__w¬Ç‰r
 ("wcpncpy called with†ength biggerhan size of destination "

221 
__fÜtify_funùiÚ
 
wch¬_t
 *

222 
	`__NTH
 (
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
,

223 
size_t
 
__n
))

225 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

227 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

228  
	`__wınıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

229 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

230 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

231  
	`__wınıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

232 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

234  
	`__wınıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

235 
	}
}

238 
wch¬_t
 *
	$__wcsÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

239 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

240 
size_t
 
__de¡Ën
è
__THROW
;

241 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsÿt_®Ÿs
,

242 (
wch¬_t
 *
__»¡riù
 
__de¡
,

243 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsÿt
);

245 
__fÜtify_funùiÚ
 
wch¬_t
 *

246 
	`__NTH
 (
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
))

248 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

249  
	`__wcsÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

250  
	`__wcsÿt_®Ÿs
 (
__de¡
, 
__¤c
);

251 
	}
}

254 
wch¬_t
 *
	$__wc¢ÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

255 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

256 
size_t
 
__n
, size_ˆ
__de¡Ën
è
__THROW
;

257 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ÿt_®Ÿs
,

258 (
wch¬_t
 *
__»¡riù
 
__de¡
,

259 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

260 
size_t
 
__n
), 
wc¢ÿt
);

262 
__fÜtify_funùiÚ
 
wch¬_t
 *

263 
	`__NTH
 (
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
,

264 
size_t
 
__n
))

266 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

267  
	`__wc¢ÿt_chk
 (
__de¡
, 
__¤c
, 
__n
,

268 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

269  
	`__wc¢ÿt_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

270 
	}
}

273 
	$__sw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

274 
__æag
, 
size_t
 
__s_Ën
,

275 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

276 
__THROW
 ;

278 
	`__REDIRECT_NTH_LDBL
 (
__sw´štf_®Ÿs
,

279 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

280 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, ...),

281 
sw´štf
);

283 #ifdeà
__va_¬g_·ck


284 
__fÜtify_funùiÚ
 

285 
	`__NTH
 (
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

286 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, ...))

288 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

289  
	`__sw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

290 
	`__bos
 (
__s
è/  (
wch¬_t
),

291 
__fmt
, 
	`__va_¬g_·ck
 ());

292  
	`__sw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¬g_·ck
 ());

293 
	}
}

294 #–ià!
defšed
 
__ılu¥lus


296 
	#sw´štf
(
s
, 
n
, ...) \

297 (
	`__bos
 (
s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

298 ? 
	`__sw´štf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

299 
	`__bos
 (
s
è/  (
wch¬_t
), 
__VA_ARGS__
) \

300 : 
	`sw´štf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

303 
	$__vsw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

304 
__æag
, 
size_t
 
__s_Ën
,

305 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

306 
__gnuc_va_li¡
 
__¬g
)

307 
__THROW
 ;

309 
	`__REDIRECT_NTH_LDBL
 (
__vsw´štf_®Ÿs
,

310 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

311 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
,

312 
__gnuc_va_li¡
 
__­
), 
vsw´štf
);

314 
__fÜtify_funùiÚ
 

315 
	`__NTH
 (
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

316 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
))

318 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

319  
	`__vsw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

320 
	`__bos
 (
__s
è/  (
wch¬_t
), 
__fmt
, 
__­
);

321  
	`__vsw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
__­
);

322 
	}
}

325 #ià
__USE_FORTIFY_LEVEL
 > 1

327 
__fw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

328 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

329 
__w´štf_chk
 (
__æag
, cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

331 
__vfw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

332 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

333 
__gnuc_va_li¡
 
__­
);

334 
__vw´štf_chk
 (
__æag
, cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

335 
__gnuc_va_li¡
 
__­
);

337 #ifdeà
__va_¬g_·ck


338 
__fÜtify_funùiÚ
 

339 
	$w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, ...)

341  
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

342 
	}
}

344 
__fÜtify_funùiÚ
 

345 
	$fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
, cÚ¡ 
wch¬_t
 *__»¡riù 
__fmt
, ...)

347  
	`__fw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

348 
	`__va_¬g_·ck
 ());

349 
	}
}

350 #–ià!
defšed
 
__ılu¥lus


351 
	#w´štf
(...) \

352 
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

353 
	#fw´štf
(
¡»am
, ...) \

354 
	`__fw´štf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

357 
__fÜtify_funùiÚ
 

358 
	$vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

360  
	`__vw´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

361 
	}
}

363 
__fÜtify_funùiÚ
 

364 
	$vfw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

365 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

367  
	`__vfw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

368 
	}
}

372 
wch¬_t
 *
	$__fg‘ws_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

373 
__FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

374 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_®Ÿs
,

375 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

376 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws
è
__wur
;

377 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_chk_w¬n
,

378 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

379 
__FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘ws_chk
)

380 
__wur
 
	`__w¬Ç‰r
 ("fgetws called with bigger sizehan†ength "

383 
__fÜtify_funùiÚ
 
__wur
 
wch¬_t
 *

384 
	$fg‘ws
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

386 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

388 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

389  
	`__fg‘ws_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

390 
__n
, 
__¡»am
);

392 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

393  
	`__fg‘ws_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

394 
__n
, 
__¡»am
);

396  
	`__fg‘ws_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

397 
	}
}

399 #ifdeà
__USE_GNU


400 
wch¬_t
 *
	$__fg‘ws_uÆocked_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
,

401 
__n
, 
__FILE
 *
__»¡riù
 
__¡»am
)

402 
__wur
;

403 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_®Ÿs
,

404 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

405 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws_uÆocked
)

406 
__wur
;

407 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_chk_w¬n
,

408 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

409 
__FILE
 *
__»¡riù
 
__¡»am
),

410 
__fg‘ws_uÆocked_chk
)

411 
__wur
 
	`__w¬Ç‰r
 ("fgetws_unlocked called with bigger sizehan†ength "

414 
__fÜtify_funùiÚ
 
__wur
 
wch¬_t
 *

415 
	$fg‘ws_uÆocked
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

417 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

419 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

420  
	`__fg‘ws_uÆocked_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

421 
__n
, 
__¡»am
);

423 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

424  
	`__fg‘ws_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

425 
__n
, 
__¡»am
);

427  
	`__fg‘ws_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

428 
	}
}

432 
size_t
 
	$__wütomb_chk
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

433 
mb¡©e_t
 *
__»¡riù
 
__p
,

434 
size_t
 
__buæ’
è
__THROW
 
__wur
;

435 
size_t
 
	`__REDIRECT_NTH
 (
__wütomb_®Ÿs
,

436 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

437 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wütomb
è
__wur
;

439 
__fÜtify_funùiÚ
 
__wur
 
size_t


440 
	`__NTH
 (
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

441 
mb¡©e_t
 *
__»¡riù
 
__ps
))

446 
	#__WCHAR_MB_LEN_MAX
 16

	)

447 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__WCHAR_MB_LEN_MAX


450 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

451  
	`__wütomb_chk
 (
__s
, 
__wch¬
, 
__ps
, 
	`__bos
 (__s));

452  
	`__wütomb_®Ÿs
 (
__s
, 
__wch¬
, 
__ps
);

453 
	}
}

456 
size_t
 
	$__mb¤towcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

457 cÚ¡ **
__»¡riù
 
__¤c
,

458 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

459 
size_t
 
__d¡Ën
è
__THROW
;

460 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_®Ÿs
,

461 (
wch¬_t
 *
__»¡riù
 
__d¡
,

462 cÚ¡ **
__»¡riù
 
__¤c
,

463 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

464 
mb¤towcs
);

465 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_chk_w¬n
,

466 (
wch¬_t
 *
__»¡riù
 
__d¡
,

467 cÚ¡ **
__»¡riù
 
__¤c
,

468 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

469 
size_t
 
__d¡Ën
), 
__mb¤towcs_chk
)

470 
	`__w¬Ç‰r
 ("mbsrtowcs called with dst buffer smallerhan†en "

473 
__fÜtify_funùiÚ
 
size_t


474 
	`__NTH
 (
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, cÚ¡ **__»¡riù 
__¤c
,

475 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

477 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

479 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

480  
	`__mb¤towcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

481 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

483 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

484  
	`__mb¤towcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

485 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

487  
	`__mb¤towcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

488 
	}
}

491 
size_t
 
	$__wc¤tombs_chk
 (*
__»¡riù
 
__d¡
,

492 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

493 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

494 
size_t
 
__d¡Ën
è
__THROW
;

495 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_®Ÿs
,

496 (*
__»¡riù
 
__d¡
,

497 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

498 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

499 
wc¤tombs
);

500 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_chk_w¬n
,

501 (*
__»¡riù
 
__d¡
,

502 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

503 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

504 
size_t
 
__d¡Ën
), 
__wc¤tombs_chk
)

505 
	`__w¬Ç‰r
 ("wcsrtombs called with dst buffer smallerhan†en");

507 
__fÜtify_funùiÚ
 
size_t


508 
	`__NTH
 (
	$wc¤tombs
 (*
__»¡riù
 
__d¡
, cÚ¡ 
wch¬_t
 **__»¡riù 
__¤c
,

509 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

511 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

513 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

514  
	`__wc¤tombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

516 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

517  
	`__wc¤tombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

519  
	`__wc¤tombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

520 
	}
}

523 #ifdeà
__USE_GNU


524 
size_t
 
	$__mb¢¹owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

525 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

526 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

527 
size_t
 
__d¡Ën
è
__THROW
;

528 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_®Ÿs
,

529 (
wch¬_t
 *
__»¡riù
 
__d¡
,

530 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

531 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

532 
mb¢¹owcs
);

533 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_chk_w¬n
,

534 (
wch¬_t
 *
__»¡riù
 
__d¡
,

535 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

536 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

537 
size_t
 
__d¡Ën
), 
__mb¢¹owcs_chk
)

538 
	`__w¬Ç‰r
 ("mbsnrtowcs called with dst buffer smallerhan†en "

541 
__fÜtify_funùiÚ
 
size_t


542 
	`__NTH
 (
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, cÚ¡ **__»¡riù 
__¤c
,

543 
size_t
 
__nmc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

545 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

547 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

548  
	`__mb¢¹owcs_chk
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

549 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

551 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

552  
	`__mb¢¹owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

553 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

555  
	`__mb¢¹owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
);

556 
	}
}

559 
size_t
 
	$__wc¢¹ombs_chk
 (*
__»¡riù
 
__d¡
,

560 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

561 
size_t
 
__nwc
, size_ˆ
__Ën
,

562 
mb¡©e_t
 *
__»¡riù
 
__ps
, 
size_t
 
__d¡Ën
)

563 
__THROW
;

564 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_®Ÿs
,

565 (*
__»¡riù
 
__d¡
,

566 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

567 
size_t
 
__nwc
, size_ˆ
__Ën
,

568 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wc¢¹ombs
);

569 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_chk_w¬n
,

570 (*
__»¡riù
 
__d¡
,

571 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

572 
size_t
 
__nwc
, size_ˆ
__Ën
,

573 
mb¡©e_t
 *
__»¡riù
 
__ps
,

574 
size_t
 
__d¡Ën
), 
__wc¢¹ombs_chk
)

575 
	`__w¬Ç‰r
 ("wcsnrtombs called with dst buffer smallerhan†en");

577 
__fÜtify_funùiÚ
 
size_t


578 
	`__NTH
 (
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
, cÚ¡ 
wch¬_t
 **__»¡riù 
__¤c
,

579 
size_t
 
__nwc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

581 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

583 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

584  
	`__wc¢¹ombs_chk
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

585 
	`__bos
 (
__d¡
));

587 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

588  
	`__wc¢¹ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

589 
	`__bos
 (
__d¡
));

591  
	`__wc¢¹ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
);

592 
	}
}

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__
 && !defšed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

9 #ifdeà
__x86_64__


10 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

12 
	#__SYSCALL_WORDSIZE
 64

	)

	@/usr/include/bits/xopen_lim.h

29 #iâdeà
_XOPEN_LIM_H


30 
	#_XOPEN_LIM_H
 1

	)

32 
	#__Ãed_IOV_MAX


	)

33 
	~<b™s/¡dio_lim.h
>

65 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

70 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

73 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

76 
	#NL_MSGMAX
 
INT_MAX


	)

80 
	#NL_NMAX
 
INT_MAX


	)

83 
	#NL_SETMAX
 
INT_MAX


	)

86 
	#NL_TEXTMAX
 
INT_MAX


	)

89 
	#NZERO
 20

	)

93 #ifdeà
INT_MAX


94 #ià
INT_MAX
 == 32767

95 
	#WORD_BIT
 16

	)

97 #ià
INT_MAX
 == 2147483647

98 
	#WORD_BIT
 32

	)

101 
	#WORD_BIT
 64

	)

104 #–ià
defšed
 
__INT_MAX__


105 #ià
__INT_MAX__
 == 32767

106 
	#WORD_BIT
 16

	)

108 #ià
__INT_MAX__
 == 2147483647

109 
	#WORD_BIT
 32

	)

112 
	#WORD_BIT
 64

	)

116 
	#WORD_BIT
 32

	)

120 #ifdeà
LONG_MAX


121 #ià
LONG_MAX
 == 2147483647

122 
	#LONG_BIT
 32

	)

125 
	#LONG_BIT
 64

	)

127 #–ià
defšed
 
__LONG_MAX__


128 #ià
__LONG_MAX__
 == 2147483647

129 
	#LONG_BIT
 32

	)

132 
	#LONG_BIT
 64

	)

135 
	~<b™s/wÜdsize.h
>

136 #ià
__WORDSIZE
 == 64

137 
	#LONG_BIT
 64

	)

139 
	#LONG_BIT
 32

	)

	@/usr/include/bits/xtitypes.h

19 #iâdeà
_STROPTS_H


23 #iâdeà
_BITS_XTITYPES_H


24 
	#_BITS_XTITYPES_H
 1

	)

26 
	~<b™s/ty³s.h
>

29 
__SLONG32_TYPE
 
	t__t_sÿÏr_t
;

30 
__ULONG32_TYPE
 
	t__t_usÿÏr_t
;

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #undeà
__USE_ISOC11


102 #undeà
__USE_ISOC99


103 #undeà
__USE_ISOC95


104 #undeà
__USE_ISOCXX11


105 #undeà
__USE_POSIX


106 #undeà
__USE_POSIX2


107 #undeà
__USE_POSIX199309


108 #undeà
__USE_POSIX199506


109 #undeà
__USE_XOPEN


110 #undeà
__USE_XOPEN_EXTENDED


111 #undeà
__USE_UNIX98


112 #undeà
__USE_XOPEN2K


113 #undeà
__USE_XOPEN2KXSI


114 #undeà
__USE_XOPEN2K8


115 #undeà
__USE_XOPEN2K8XSI


116 #undeà
__USE_LARGEFILE


117 #undeà
__USE_LARGEFILE64


118 #undeà
__USE_FILE_OFFSET64


119 #undeà
__USE_BSD


120 #undeà
__USE_SVID


121 #undeà
__USE_MISC


122 #undeà
__USE_ATFILE


123 #undeà
__USE_GNU


124 #undeà
__USE_REENTRANT


125 #undeà
__USE_FORTIFY_LEVEL


126 #undeà
__KERNEL_STRICT_NAMES


130 #iâdeà
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

143 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

150 #ifdeà
_GNU_SOURCE


151 #undeà
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #undeà
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #undeà
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #undeà
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #undeà
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #undeà
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #undeà
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #undeà
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #undeà
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(
defšed
 
_DEFAULT_SOURCE
 \

180 || (!
defšed
 
	g__STRICT_ANSI__
 \

181 && !
defšed
 
	g_ISOC99_SOURCE
 \

182 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

183 && !
defšed
 
	g_XOPEN_SOURCE
 \

184 && !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
))

185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #undeà
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #undeà
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #ià(
defšed
 
_ISOC11_SOURCE
 \

195 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

201 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

207 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

216 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifdeà
_DEFAULT_SOURCE


224 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #undeà
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #undeà
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #undeà
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #undeà
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #undeà
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #ià(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #undeà
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #ià(
_XOPEN_SOURCE
 - 0) >= 600

285 #ià(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #undeà
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #undeà
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifdeà
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifdeà
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifdeà
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #ià
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<¡dc-´edef.h
>

360 #undeà
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

369 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

372 #iâdeà
__ASSEMBLER__


373 #iâdeà
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

388 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

389 && 
defšed
 
	g__ex‹º_šlše


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/¡ubs.h
>

	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


148 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<b™s/¡dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

300 
size_t
 
	m_ä“»s_size
;

302 *
	m__·d1
;

303 *
	m__·d2
;

304 *
	m__·d3
;

305 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

314 #iâdeà
__ılu¥lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_¶us
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

322 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

323 #iâdeà
_LIBC


324 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

325 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

326 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

328 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

330 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

338 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

346 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_şo£_â
 (*
	t__cook›
);

361 #ifdeà
_GNU_SOURCE


363 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

364 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

365 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

366 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

371 
__io_»ad_â
 *
	m»ad
;

372 
__io_wr™e_â
 *
	mwr™e
;

373 
__io_£ek_â
 *
	m£ek
;

374 
__io_şo£_â
 *
	mşo£
;

375 } 
	t_IO_cook›_io_funùiÚs_t
;

376 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

378 
	g_IO_cook›_fe
;

381 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

382 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

386 #ifdeà
__ılu¥lus


390 
__und”æow
 (
_IO_FILE
 *);

391 
__uæow
 (
_IO_FILE
 *);

392 
__ov”æow
 (
_IO_FILE
 *, );

393 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

396 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

399 #ià 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

402 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

405 
	#_IO_g‘c_uÆocked
(
_å
) \

406 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

407 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

408 
	#_IO_³ekc_uÆocked
(
_å
) \

409 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

410 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

411 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

412 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

413 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

414 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

415 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

417 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_g‘wc_uÆocked
(
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

422 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

423 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

424 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

425 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

426 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

427 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

428 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

431 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

432 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

434 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

436 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

437 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

439 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

443 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

445 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

447 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

449 #ifdeà
_IO_MTSAFE_IO


450 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

451 
	#_IO_æockfe
(
_å
) \

452 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

453 
	#_IO_fuÆockfe
(
_å
) \

454 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

456 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

457 
	#_IO_æockfe
(
_å
è

	)

458 
	#_IO_fuÆockfe
(
_å
è

	)

459 
	#_IO_árylockfe
(
_å
è

	)

460 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

461 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

464 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

465 
_IO_va_li¡
, *
__»¡riù
);

466 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

467 
_IO_va_li¡
);

468 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

476 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

478 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

479 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

480 #ià
__GNUC__
 >= 2

483 #ià
defšed
 
_LIBC
 && defšed 
SHARED


484 
	~<shlib-com·t.h
>

485 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_šcom·tibË
 \

487 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

488 cÚ¡ 
_IO_¡dš_u£d
;

489 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

492 #iâdeà
_IO_fwide_maybe_šcom·tibË


493 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

497 
	#_IO_fwide
(
__å
, 
__mode
) \

498 ({ 
__»suÉ
 = (
__mode
); \

499 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

501 ià((
__å
)->
_mode
 == 0) \

503 (
__å
)->
_mode
 = -1; \

504 
__»suÉ
 = (
__å
)->
_mode
; \

506 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

507 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

509 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

510 
__»suÉ
; })

	)

513 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

514 
_IO_va_li¡
, *
__»¡riù
);

515 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

516 
_IO_va_li¡
);

517 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

518 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

521 #ifdeà
__LDBL_COMPAT


522 
	~<b™s/libio-ldbl.h
>

525 #ifdeà
__ılu¥lus


	@/usr/include/linux/filter.h

5 #iâdeà
__LINUX_FILTER_H__


6 
	#__LINUX_FILTER_H__


	)

9 
	~<lšux/ty³s.h
>

15 
	#BPF_MAJOR_VERSION
 1

	)

16 
	#BPF_MINOR_VERSION
 1

	)

23 
	ssock_f‹r
 {

24 
__u16
 
	mcode
;

25 
__u8
 
	mjt
;

26 
__u8
 
	mjf
;

27 
__u32
 
	mk
;

30 
	ssock_årog
 {

31 
	mËn
;

32 
sock_f‹r
 *
	mf‹r
;

39 
	#BPF_CLASS
(
code
è((codeè& 0x07)

	)

40 
	#BPF_LD
 0x00

	)

41 
	#BPF_LDX
 0x01

	)

42 
	#BPF_ST
 0x02

	)

43 
	#BPF_STX
 0x03

	)

44 
	#BPF_ALU
 0x04

	)

45 
	#BPF_JMP
 0x05

	)

46 
	#BPF_RET
 0x06

	)

47 
	#BPF_MISC
 0x07

	)

50 
	#BPF_SIZE
(
code
è((codeè& 0x18)

	)

51 
	#BPF_W
 0x00

	)

52 
	#BPF_H
 0x08

	)

53 
	#BPF_B
 0x10

	)

54 
	#BPF_MODE
(
code
è((codeè& 0xe0)

	)

55 
	#BPF_IMM
 0x00

	)

56 
	#BPF_ABS
 0x20

	)

57 
	#BPF_IND
 0x40

	)

58 
	#BPF_MEM
 0x60

	)

59 
	#BPF_LEN
 0x80

	)

60 
	#BPF_MSH
 0xa0

	)

63 
	#BPF_OP
(
code
è((codeè& 0xf0)

	)

64 
	#BPF_ADD
 0x00

	)

65 
	#BPF_SUB
 0x10

	)

66 
	#BPF_MUL
 0x20

	)

67 
	#BPF_DIV
 0x30

	)

68 
	#BPF_OR
 0x40

	)

69 
	#BPF_AND
 0x50

	)

70 
	#BPF_LSH
 0x60

	)

71 
	#BPF_RSH
 0x70

	)

72 
	#BPF_NEG
 0x80

	)

73 
	#BPF_MOD
 0x90

	)

74 
	#BPF_XOR
 0xa0

	)

76 
	#BPF_JA
 0x00

	)

77 
	#BPF_JEQ
 0x10

	)

78 
	#BPF_JGT
 0x20

	)

79 
	#BPF_JGE
 0x30

	)

80 
	#BPF_JSET
 0x40

	)

81 
	#BPF_SRC
(
code
è((codeè& 0x08)

	)

82 
	#BPF_K
 0x00

	)

83 
	#BPF_X
 0x08

	)

86 
	#BPF_RVAL
(
code
è((codeè& 0x18)

	)

87 
	#BPF_A
 0x10

	)

90 
	#BPF_MISCOP
(
code
è((codeè& 0xf8)

	)

91 
	#BPF_TAX
 0x00

	)

92 
	#BPF_TXA
 0x80

	)

94 #iâdeà
BPF_MAXINSNS


95 
	#BPF_MAXINSNS
 4096

	)

101 #iâdeà
BPF_STMT


102 
	#BPF_STMT
(
code
, 
k
è{ ()(code), 0, 0, k }

	)

104 #iâdeà
BPF_JUMP


105 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
è{ ()(code), jt, jf, k }

	)

111 
	#BPF_MEMWORDS
 16

	)

118 
	#SKF_AD_OFF
 (-0x1000)

	)

119 
	#SKF_AD_PROTOCOL
 0

	)

120 
	#SKF_AD_PKTTYPE
 4

	)

121 
	#SKF_AD_IFINDEX
 8

	)

122 
	#SKF_AD_NLATTR
 12

	)

123 
	#SKF_AD_NLATTR_NEST
 16

	)

124 
	#SKF_AD_MARK
 20

	)

125 
	#SKF_AD_QUEUE
 24

	)

126 
	#SKF_AD_HATYPE
 28

	)

127 
	#SKF_AD_RXHASH
 32

	)

128 
	#SKF_AD_CPU
 36

	)

129 
	#SKF_AD_ALU_XOR_X
 40

	)

130 
	#SKF_AD_VLAN_TAG
 44

	)

131 
	#SKF_AD_VLAN_TAG_PRESENT
 48

	)

132 
	#SKF_AD_PAY_OFFSET
 52

	)

133 
	#SKF_AD_MAX
 56

	)

134 
	#SKF_NET_OFF
 (-0x100000)

	)

135 
	#SKF_LL_OFF
 (-0x200000)

	)

	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

37 #iâdeà
__ASSEMBLY__


40 
	mşock_¿‹
;

41 
	mşock_ty³
;

42 
	mloİback
;

43 } 
	tsync_£rŸl_£‰šgs
;

46 
	mşock_¿‹
;

47 
	mşock_ty³
;

48 
	mloİback
;

49 
	m¦Ù_m­
;

50 } 
	t‹1_£‰šgs
;

53 
	m’codšg
;

54 
	m·r™y
;

55 } 
	t¿w_hdlc_´Ùo
;

58 
	mt391
;

59 
	mt392
;

60 
	mn391
;

61 
	mn392
;

62 
	mn393
;

63 
	mlmi
;

64 
	mdû
;

65 } 
	tä_´Ùo
;

68 
	mdlci
;

69 } 
	tä_´Ùo_pvc
;

72 
	mdlci
;

73 
	mma¡”
[
IFNAMSIZ
];

74 }
	tä_´Ùo_pvc_šfo
;

77 
	mš‹rv®
;

78 
	mtimeout
;

79 } 
	tcisco_´Ùo
;

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_BATMAN
 0x4305

	)

52 
	#ETH_P_DEC
 0x6000

	)

53 
	#ETH_P_DNA_DL
 0x6001

	)

54 
	#ETH_P_DNA_RC
 0x6002

	)

55 
	#ETH_P_DNA_RT
 0x6003

	)

56 
	#ETH_P_LAT
 0x6004

	)

57 
	#ETH_P_DIAG
 0x6005

	)

58 
	#ETH_P_CUST
 0x6006

	)

59 
	#ETH_P_SCA
 0x6007

	)

60 
	#ETH_P_TEB
 0x6558

	)

61 
	#ETH_P_RARP
 0x8035

	)

62 
	#ETH_P_ATALK
 0x809B

	)

63 
	#ETH_P_AARP
 0x80F3

	)

64 
	#ETH_P_8021Q
 0x8100

	)

65 
	#ETH_P_IPX
 0x8137

	)

66 
	#ETH_P_IPV6
 0x86DD

	)

67 
	#ETH_P_PAUSE
 0x8808

	)

68 
	#ETH_P_SLOW
 0x8809

	)

69 
	#ETH_P_WCCP
 0x883E

	)

71 
	#ETH_P_PPP_DISC
 0x8863

	)

72 
	#ETH_P_PPP_SES
 0x8864

	)

73 
	#ETH_P_MPLS_UC
 0x8847

	)

74 
	#ETH_P_MPLS_MC
 0x8848

	)

75 
	#ETH_P_ATMMPOA
 0x884ø

	)

76 
	#ETH_P_LINK_CTL
 0x886ø

	)

77 
	#ETH_P_ATMFATE
 0x8884

	)

80 
	#ETH_P_PAE
 0x888E

	)

81 
	#ETH_P_AOE
 0x88A2

	)

82 
	#ETH_P_8021AD
 0x88A8

	)

83 
	#ETH_P_802_EX1
 0x88B5

	)

84 
	#ETH_P_TIPC
 0x88CA

	)

85 
	#ETH_P_8021AH
 0x88E7

	)

86 
	#ETH_P_MVRP
 0x88F5

	)

87 
	#ETH_P_1588
 0x88F7

	)

88 
	#ETH_P_PRP
 0x88FB

	)

89 
	#ETH_P_FCOE
 0x8906

	)

90 
	#ETH_P_TDLS
 0x890D

	)

91 
	#ETH_P_FIP
 0x8914

	)

92 
	#ETH_P_QINQ1
 0x9100

	)

93 
	#ETH_P_QINQ2
 0x9200

	)

94 
	#ETH_P_QINQ3
 0x9300

	)

95 
	#ETH_P_EDSA
 0xDADA

	)

96 
	#ETH_P_AF_IUCV
 0xFBFB

	)

98 
	#ETH_P_802_3_MIN
 0x0600

	)

105 
	#ETH_P_802_3
 0x0001

	)

106 
	#ETH_P_AX25
 0x0002

	)

107 
	#ETH_P_ALL
 0x0003

	)

108 
	#ETH_P_802_2
 0x0004

	)

109 
	#ETH_P_SNAP
 0x0005

	)

110 
	#ETH_P_DDCMP
 0x0006

	)

111 
	#ETH_P_WAN_PPP
 0x0007

	)

112 
	#ETH_P_PPP_MP
 0x0008

	)

113 
	#ETH_P_LOCALTALK
 0x0009

	)

114 
	#ETH_P_CAN
 0x000C

	)

115 
	#ETH_P_CANFD
 0x000D

	)

116 
	#ETH_P_PPPTALK
 0x0010

	)

117 
	#ETH_P_TR_802_2
 0x0011

	)

118 
	#ETH_P_MOBITEX
 0x0015

	)

119 
	#ETH_P_CONTROL
 0x0016

	)

120 
	#ETH_P_IRDA
 0x0017

	)

121 
	#ETH_P_ECONET
 0x0018

	)

122 
	#ETH_P_HDLC
 0x0019

	)

123 
	#ETH_P_ARCNET
 0x001A

	)

124 
	#ETH_P_DSA
 0x001B

	)

125 
	#ETH_P_TRAILER
 0x001C

	)

126 
	#ETH_P_PHONET
 0x00F5

	)

127 
	#ETH_P_IEEE802154
 0x00F6

	)

128 
	#ETH_P_CAIF
 0x00F7

	)

134 
	s‘hhdr
 {

135 
	mh_de¡
[
ETH_ALEN
];

136 
	mh_sourû
[
ETH_ALEN
];

137 
__be16
 
	mh_´Ùo
;

138 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	t__k”Ãl_§_çmy_t
;

13 
	s__k”Ãl_sockaddr_¡Üage
 {

14 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

46 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

48 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/sys/ttydefaults.h

40 #iâdeà
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
è(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifdeà
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifdeà
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifdeà
TTYDEFCHARS


94 
cc_t
 
	g‰ydefch¬s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #undeà
TTYDEFCHARS


	@/usr/include/sys/ucontext.h

18 #iâdeà
_SYS_UCONTEXT_H


19 
	#_SYS_UCONTEXT_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<sigÇl.h
>

26 
	~<b™s/sigcÚ‹xt.h
>

28 #ifdeà
__x86_64__


31 
__ex‹nsiÚ__
 
	tg»g_t
;

34 
	#NGREG
 23

	)

37 
g»g_t
 
	tg»g£t_t
[
NGREG
];

39 #ifdeà
__USE_GNU


43 
	mREG_R8
 = 0,

44 
	#REG_R8
 
REG_R8


	)

45 
	mREG_R9
,

46 
	#REG_R9
 
REG_R9


	)

47 
	mREG_R10
,

48 
	#REG_R10
 
REG_R10


	)

49 
	mREG_R11
,

50 
	#REG_R11
 
REG_R11


	)

51 
	mREG_R12
,

52 
	#REG_R12
 
REG_R12


	)

53 
	mREG_R13
,

54 
	#REG_R13
 
REG_R13


	)

55 
	mREG_R14
,

56 
	#REG_R14
 
REG_R14


	)

57 
	mREG_R15
,

58 
	#REG_R15
 
REG_R15


	)

59 
	mREG_RDI
,

60 
	#REG_RDI
 
REG_RDI


	)

61 
	mREG_RSI
,

62 
	#REG_RSI
 
REG_RSI


	)

63 
	mREG_RBP
,

64 
	#REG_RBP
 
REG_RBP


	)

65 
	mREG_RBX
,

66 
	#REG_RBX
 
REG_RBX


	)

67 
	mREG_RDX
,

68 
	#REG_RDX
 
REG_RDX


	)

69 
	mREG_RAX
,

70 
	#REG_RAX
 
REG_RAX


	)

71 
	mREG_RCX
,

72 
	#REG_RCX
 
REG_RCX


	)

73 
	mREG_RSP
,

74 
	#REG_RSP
 
REG_RSP


	)

75 
	mREG_RIP
,

76 
	#REG_RIP
 
REG_RIP


	)

77 
	mREG_EFL
,

78 
	#REG_EFL
 
REG_EFL


	)

79 
	mREG_CSGSFS
,

80 
	#REG_CSGSFS
 
REG_CSGSFS


	)

81 
	mREG_ERR
,

82 
	#REG_ERR
 
REG_ERR


	)

83 
	mREG_TRAPNO
,

84 
	#REG_TRAPNO
 
REG_TRAPNO


	)

85 
	mREG_OLDMASK
,

86 
	#REG_OLDMASK
 
REG_OLDMASK


	)

87 
	mREG_CR2


88 
	#REG_CR2
 
REG_CR2


	)

92 
	s_libc_åx»g


94 
	msignifiÿnd
[4];

95 
	mexpÚ’t
;

96 
	m·ddšg
[3];

99 
	s_libc_xmm»g


101 
__ušt32_t
 
	m–em’t
[4];

104 
	s_libc_å¡©e


107 
__ušt16_t
 
	mcwd
;

108 
__ušt16_t
 
	mswd
;

109 
__ušt16_t
 
	máw
;

110 
__ušt16_t
 
	mfİ
;

111 
__ušt64_t
 
	mr
;

112 
__ušt64_t
 
	mrdp
;

113 
__ušt32_t
 
	mmxc¤
;

114 
__ušt32_t
 
	mmxü_mask
;

115 
_libc_åx»g
 
	m_¡
[8];

116 
_libc_xmm»g
 
	m_xmm
[16];

117 
__ušt32_t
 
	m·ddšg
[24];

121 
_libc_å¡©e
 *
	tå»g£t_t
;

126 
g»g£t_t
 
	mg»gs
;

128 
å»g£t_t
 
	må»gs
;

129 
__ex‹nsiÚ__
 
	m__»£rved1
 [8];

130 } 
	tmcÚ‹xt_t
;

133 
	sucÚ‹xt


135 
	muc_æags
;

136 
ucÚ‹xt
 *
	muc_lšk
;

137 
¡ack_t
 
	muc_¡ack
;

138 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

139 
__sig£t_t
 
	muc_sigmask
;

140 
_libc_å¡©e
 
	m__å»gs_mem
;

141 } 
	tucÚ‹xt_t
;

146 
	tg»g_t
;

149 
	#NGREG
 19

	)

152 
g»g_t
 
	tg»g£t_t
[
NGREG
];

154 #ifdeà
__USE_GNU


158 
	mREG_GS
 = 0,

159 
	#REG_GS
 
REG_GS


	)

160 
	mREG_FS
,

161 
	#REG_FS
 
REG_FS


	)

162 
	mREG_ES
,

163 
	#REG_ES
 
REG_ES


	)

164 
	mREG_DS
,

165 
	#REG_DS
 
REG_DS


	)

166 
	mREG_EDI
,

167 
	#REG_EDI
 
REG_EDI


	)

168 
	mREG_ESI
,

169 
	#REG_ESI
 
REG_ESI


	)

170 
	mREG_EBP
,

171 
	#REG_EBP
 
REG_EBP


	)

172 
	mREG_ESP
,

173 
	#REG_ESP
 
REG_ESP


	)

174 
	mREG_EBX
,

175 
	#REG_EBX
 
REG_EBX


	)

176 
	mREG_EDX
,

177 
	#REG_EDX
 
REG_EDX


	)

178 
	mREG_ECX
,

179 
	#REG_ECX
 
REG_ECX


	)

180 
	mREG_EAX
,

181 
	#REG_EAX
 
REG_EAX


	)

182 
	mREG_TRAPNO
,

183 
	#REG_TRAPNO
 
REG_TRAPNO


	)

184 
	mREG_ERR
,

185 
	#REG_ERR
 
REG_ERR


	)

186 
	mREG_EIP
,

187 
	#REG_EIP
 
REG_EIP


	)

188 
	mREG_CS
,

189 
	#REG_CS
 
REG_CS


	)

190 
	mREG_EFL
,

191 
	#REG_EFL
 
REG_EFL


	)

192 
	mREG_UESP
,

193 
	#REG_UESP
 
REG_UESP


	)

194 
	mREG_SS


195 
	#REG_SS
 
REG_SS


	)

200 
	s_libc_å»g


202 
	msignifiÿnd
[4];

203 
	mexpÚ’t
;

206 
	s_libc_å¡©e


208 
	mcw
;

209 
	msw
;

210 
	mg
;

211 
	moff
;

212 
	mcs£l
;

213 
	md©aoff
;

214 
	md©a£l
;

215 
_libc_å»g
 
	m_¡
[8];

216 
	m¡©us
;

220 
_libc_å¡©e
 *
	tå»g£t_t
;

225 
g»g£t_t
 
	mg»gs
;

228 
å»g£t_t
 
	må»gs
;

229 
	mŞdmask
;

230 
	mü2
;

231 } 
	tmcÚ‹xt_t
;

234 
	sucÚ‹xt


236 
	muc_æags
;

237 
ucÚ‹xt
 *
	muc_lšk
;

238 
¡ack_t
 
	muc_¡ack
;

239 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

240 
__sig£t_t
 
	muc_sigmask
;

241 
_libc_å¡©e
 
	m__å»gs_mem
;

242 } 
	tucÚ‹xt_t
;

	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/asm/ioctls.h

1 
	~<asm-g’”ic/ioùls.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-g’”ic/sock‘.h
>

	@/usr/include/asm/types.h

1 #iâdeà
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/bits/byteswap-16.h

19 #iâdeà
_BITS_BYTESWAP_H


23 #ifdeà
__GNUC__


24 #ià
__GNUC__
 >= 2

25 
	#__bsw­_16
(
x
) \

26 (
__ex‹nsiÚ__
 \

27 ({ 
__v
, 
__x
 = (è(
x
); \

28 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

29 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "ô" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw­_16
(
x
) \

39 (
__ex‹nsiÚ__
 \

40 ({ 
__x
 = (è(
x
); \

41 
	`__bsw­_cÚ¡ªt_16
 (
__x
); }))

	)

44 
__šlše
 

45 
	$__bsw­_16
 (
__bsx
)

47  
	`__bsw­_cÚ¡ªt_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/fcntl-linux.h

19 #iâdef 
_FCNTL_H


37 #ifdeà
__USE_GNU


38 
	~<b™s/uio.h
>

42 
	#O_ACCMODE
 0003

	)

43 
	#O_RDONLY
 00

	)

44 
	#O_WRONLY
 01

	)

45 
	#O_RDWR
 02

	)

46 #iâdeà
O_CREAT


47 
	#O_CREAT
 0100

	)

49 #iâdeà
O_EXCL


50 
	#O_EXCL
 0200

	)

52 #iâdeà
O_NOCTTY


53 
	#O_NOCTTY
 0400

	)

55 #iâdeà
O_TRUNC


56 
	#O_TRUNC
 01000

	)

58 #iâdeà
O_APPEND


59 
	#O_APPEND
 02000

	)

61 #iâdeà
O_NONBLOCK


62 
	#O_NONBLOCK
 04000

	)

64 #iâdeà
O_NDELAY


65 
	#O_NDELAY
 
O_NONBLOCK


	)

67 #iâdeà
O_SYNC


68 
	#O_SYNC
 04010000

	)

70 
	#O_FSYNC
 
O_SYNC


	)

71 #iâdeà
O_ASYNC


72 
	#O_ASYNC
 020000

	)

74 #iâdeà
__O_LARGEFILE


75 
	#__O_LARGEFILE
 0100000

	)

78 #iâdeà
__O_DIRECTORY


79 
	#__O_DIRECTORY
 0200000

	)

81 #iâdeà
__O_NOFOLLOW


82 
	#__O_NOFOLLOW
 0400000

	)

84 #iâdeà
__O_CLOEXEC


85 
	#__O_CLOEXEC
 02000000

	)

87 #iâdeà
__O_DIRECT


88 
	#__O_DIRECT
 040000

	)

90 #iâdeà
__O_NOATIME


91 
	#__O_NOATIME
 01000000

	)

93 #iâdeà
__O_PATH


94 
	#__O_PATH
 010000000

	)

96 #iâdeà
__O_DSYNC


97 
	#__O_DSYNC
 010000

	)

99 #iâdeà
__O_TMPFILE


100 
	#__O_TMPFILE
 020200000

	)

103 #iâdeà
F_GETLK


104 #iâdeà
__USE_FILE_OFFSET64


105 
	#F_GETLK
 5

	)

106 
	#F_SETLK
 6

	)

107 
	#F_SETLKW
 7

	)

109 
	#F_GETLK
 
F_GETLK64


	)

110 
	#F_SETLK
 
F_SETLK64


	)

111 
	#F_SETLKW
 
F_SETLKW64


	)

114 #iâdeà
F_GETLK64


115 
	#F_GETLK64
 12

	)

116 
	#F_SETLK64
 13

	)

117 
	#F_SETLKW64
 14

	)

120 #ifdeà
__USE_LARGEFILE64


121 
	#O_LARGEFILE
 
__O_LARGEFILE


	)

124 #ifdeà
__USE_XOPEN2K8


125 
	#O_DIRECTORY
 
__O_DIRECTORY


	)

126 
	#O_NOFOLLOW
 
__O_NOFOLLOW


	)

127 
	#O_CLOEXEC
 
__O_CLOEXEC


	)

130 #ifdeà
__USE_GNU


131 
	#O_DIRECT
 
__O_DIRECT


	)

132 
	#O_NOATIME
 
__O_NOATIME


	)

133 
	#O_PATH
 
__O_PATH


	)

134 
	#O_TMPFILE
 
__O_TMPFILE


	)

140 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


141 
	#O_DSYNC
 
__O_DSYNC


	)

142 #ià
defšed
 
__O_RSYNC


143 
	#O_RSYNC
 
__O_RSYNC


	)

145 
	#O_RSYNC
 
O_SYNC


	)

150 
	#F_DUPFD
 0

	)

151 
	#F_GETFD
 1

	)

152 
	#F_SETFD
 2

	)

153 
	#F_GETFL
 3

	)

154 
	#F_SETFL
 4

	)

156 #iâdeà
__F_SETOWN


157 
	#__F_SETOWN
 8

	)

158 
	#__F_GETOWN
 9

	)

161 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


162 
	#F_SETOWN
 
__F_SETOWN


	)

163 
	#F_GETOWN
 
__F_GETOWN


	)

166 #iâdeà
__F_SETSIG


167 
	#__F_SETSIG
 10

	)

168 
	#__F_GETSIG
 11

	)

170 #iâdeà
__F_SETOWN_EX


171 
	#__F_SETOWN_EX
 15

	)

172 
	#__F_GETOWN_EX
 16

	)

175 #ifdeà
__USE_GNU


176 
	#F_SETSIG
 
__F_SETSIG


	)

177 
	#F_GETSIG
 
__F_GETSIG


	)

178 
	#F_SETOWN_EX
 
__F_SETOWN_EX


	)

179 
	#F_GETOWN_EX
 
__F_GETOWN_EX


	)

182 #ifdeà
__USE_GNU


183 
	#F_SETLEASE
 1024

	)

184 
	#F_GETLEASE
 1025

	)

185 
	#F_NOTIFY
 1026

	)

186 
	#F_SETPIPE_SZ
 1031

	)

187 
	#F_GETPIPE_SZ
 1032

	)

189 #ifdeà
__USE_XOPEN2K8


190 
	#F_DUPFD_CLOEXEC
 1030

	)

195 
	#FD_CLOEXEC
 1

	)

197 #iâdeà
F_RDLCK


199 
	#F_RDLCK
 0

	)

200 
	#F_WRLCK
 1

	)

201 
	#F_UNLCK
 2

	)

206 #iâdeà
F_EXLCK


207 
	#F_EXLCK
 4

	)

208 
	#F_SHLCK
 8

	)

211 #ifdeà
__USE_BSD


213 
	#LOCK_SH
 1

	)

214 
	#LOCK_EX
 2

	)

215 
	#LOCK_NB
 4

	)

217 
	#LOCK_UN
 8

	)

220 #ifdeà
__USE_GNU


221 
	#LOCK_MAND
 32

	)

222 
	#LOCK_READ
 64

	)

223 
	#LOCK_WRITE
 128

	)

224 
	#LOCK_RW
 192

	)

227 #ifdeà
__USE_GNU


229 
	#DN_ACCESS
 0x00000001

	)

230 
	#DN_MODIFY
 0x00000002

	)

231 
	#DN_CREATE
 0x00000004

	)

232 
	#DN_DELETE
 0x00000008

	)

233 
	#DN_RENAME
 0x00000010

	)

234 
	#DN_ATTRIB
 0x00000020

	)

235 
	#DN_MULTISHOT
 0x80000000

	)

239 #ifdeà
__USE_GNU


241 
	e__pid_ty³


243 
	mF_OWNER_TID
 = 0,

244 
	mF_OWNER_PID
,

245 
	mF_OWNER_PGRP
,

246 
	mF_OWNER_GID
 = 
F_OWNER_PGRP


250 
	sf_owÃr_ex


252 
__pid_ty³
 
	mty³
;

253 
__pid_t
 
	mpid
;

259 #ifdef 
__USE_BSD


260 
	#FAPPEND
 
O_APPEND


	)

261 
	#FFSYNC
 
O_FSYNC


	)

262 
	#FASYNC
 
O_ASYNC


	)

263 
	#FNONBLOCK
 
O_NONBLOCK


	)

264 
	#FNDELAY
 
O_NDELAY


	)

267 #iâdeà
__POSIX_FADV_DONTNEED


268 
	#__POSIX_FADV_DONTNEED
 4

	)

269 
	#__POSIX_FADV_NOREUSE
 5

	)

272 #ifdeà
__USE_XOPEN2K


273 
	#POSIX_FADV_NORMAL
 0

	)

274 
	#POSIX_FADV_RANDOM
 1

	)

275 
	#POSIX_FADV_SEQUENTIAL
 2

	)

276 
	#POSIX_FADV_WILLNEED
 3

	)

277 
	#POSIX_FADV_DONTNEED
 
__POSIX_FADV_DONTNEED


	)

278 
	#POSIX_FADV_NOREUSE
 
__POSIX_FADV_NOREUSE


	)

282 #ifdeà
__USE_GNU


284 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

287 
	#SYNC_FILE_RANGE_WRITE
 2

	)

290 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

295 
	#SPLICE_F_MOVE
 1

	)

296 
	#SPLICE_F_NONBLOCK
 2

	)

299 
	#SPLICE_F_MORE
 4

	)

300 
	#SPLICE_F_GIFT
 8

	)

304 
	#FALLOC_FL_KEEP_SIZE
 1

	)

307 
	#FALLOC_FL_PUNCH_HOLE
 2

	)

311 
	sfe_hªdË


313 
	mhªdË_by‹s
;

314 
	mhªdË_ty³
;

316 
	mf_hªdË
[0];

320 
	#MAX_HANDLE_SZ
 128

	)

324 #ifdeà
__USE_ATFILE


325 
	#AT_FDCWD
 -100

	)

328 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

329 
	#AT_REMOVEDIR
 0x200

	)

331 
	#AT_SYMLINK_FOLLOW
 0x400

	)

332 #ifdeà
__USE_GNU


333 
	#AT_NO_AUTOMOUNT
 0x800

	)

335 
	#AT_EMPTY_PATH
 0x1000

	)

337 
	#AT_EACCESS
 0x200

	)

341 
	g__BEGIN_DECLS


343 #ifdeà
__USE_GNU


346 
ssize_t
 
	$»adah—d
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__couÁ
)

347 
__THROW
;

354 
	`sync_fe_¿nge
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__couÁ
,

355 
__æags
);

362 
ssize_t
 
	`vm¥liû
 (
__fdout
, cÚ¡ 
iovec
 *
__iov
,

363 
size_t
 
__couÁ
, 
__æags
);

369 
ssize_t
 
	`¥liû
 (
__fdš
, 
__off64_t
 *
__offš
, 
__fdout
,

370 
__off64_t
 *
__offout
, 
size_t
 
__Ën
,

371 
__æags
);

377 
ssize_t
 
	`‹e
 (
__fdš
, 
__fdout
, 
size_t
 
__Ën
,

378 
__æags
);

384 #iâdeà
__USE_FILE_OFFSET64


385 
	`çÎoÿ‹
 (
__fd
, 
__mode
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
);

387 #ifdeà
__REDIRECT


388 
	`__REDIRECT
 (
çÎoÿ‹
, (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

389 
__off64_t
 
__Ën
),

390 
çÎoÿ‹64
);

392 
	#çÎoÿ‹
 
çÎoÿ‹64


	)

395 #ifdeà
__USE_LARGEFILE64


396 
	`çÎoÿ‹64
 (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

397 
__off64_t
 
__Ën
);

402 
	$Çme_to_hªdË_©
 (
__dfd
, cÚ¡ *
__Çme
,

403 
fe_hªdË
 *
__hªdË
, *
__mÁ_id
,

404 
__æags
è
__THROW
;

410 
	`İ’_by_hªdË_©
 (
__mouÁdœfd
, 
fe_hªdË
 *
__hªdË
,

411 
__æags
);

415 
__END_DECLS


	@/usr/include/bits/libio-ldbl.h

19 #iâdeà
_IO_STDIO_H


23 
	$__LDBL_REDIR_DECL
 (
_IO_vfsÿnf
)

24 
	`__LDBL_REDIR_DECL
 (
_IO_vårštf
)

	@/usr/include/bits/local_lim.h

24 #iâdeà
NR_OPEN


25 
	#__undef_NR_OPEN


	)

27 #iâdeà
LINK_MAX


28 
	#__undef_LINK_MAX


	)

30 #iâdeà
OPEN_MAX


31 
	#__undef_OPEN_MAX


	)

33 #iâdeà
ARG_MAX


34 
	#__undef_ARG_MAX


	)

38 
	~<lšux/lim™s.h
>

41 #ifdeà
__undef_NR_OPEN


42 #undeà
NR_OPEN


43 #undeà
__undef_NR_OPEN


46 #ifdeà
__undef_LINK_MAX


47 #undeà
LINK_MAX


48 #undeà
__undef_LINK_MAX


51 #ifdeà
__undef_OPEN_MAX


52 #undeà
OPEN_MAX


53 #undeà
__undef_OPEN_MAX


56 #ifdeà
__undef_ARG_MAX


57 #undeà
ARG_MAX


58 #undeà
__undef_ARG_MAX


62 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

64 
	#PTHREAD_KEYS_MAX
 1024

	)

67 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

69 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

72 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

74 #undeà
PTHREAD_THREADS_MAX


78 
	#AIO_PRIO_DELTA_MAX
 20

	)

81 
	#PTHREAD_STACK_MIN
 16384

	)

84 
	#DELAYTIMER_MAX
 2147483647

	)

87 
	#TTY_NAME_MAX
 32

	)

90 
	#LOGIN_NAME_MAX
 256

	)

93 
	#HOST_NAME_MAX
 64

	)

96 
	#MQ_PRIO_MAX
 32768

	)

99 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/mman-linux.h

19 #iâdeà
_SYS_MMAN_H


32 
	#PROT_READ
 0x1

	)

33 
	#PROT_WRITE
 0x2

	)

34 
	#PROT_EXEC
 0x4

	)

35 
	#PROT_NONE
 0x0

	)

36 
	#PROT_GROWSDOWN
 0x01000000

	)

38 
	#PROT_GROWSUP
 0x02000000

	)

42 
	#MAP_SHARED
 0x01

	)

43 
	#MAP_PRIVATE
 0x02

	)

44 #ifdeà
__USE_MISC


45 
	#MAP_TYPE
 0x0à

	)

49 
	#MAP_FIXED
 0x10

	)

50 #ifdeà
__USE_MISC


51 
	#MAP_FILE
 0

	)

52 #ifdeà
__MAP_ANONYMOUS


53 
	#MAP_ANONYMOUS
 
__MAP_ANONYMOUS


	)

55 
	#MAP_ANONYMOUS
 0x20

	)

57 
	#MAP_ANON
 
MAP_ANONYMOUS


	)

59 
	#MAP_HUGE_SHIFT
 26

	)

60 
	#MAP_HUGE_MASK
 0x3f

	)

64 
	#MS_ASYNC
 1

	)

65 
	#MS_SYNC
 4

	)

66 
	#MS_INVALIDATE
 2

	)

69 #ifdeà
__USE_GNU


70 
	#MREMAP_MAYMOVE
 1

	)

71 
	#MREMAP_FIXED
 2

	)

75 #ifdeà
__USE_BSD


76 
	#MADV_NORMAL
 0

	)

77 
	#MADV_RANDOM
 1

	)

78 
	#MADV_SEQUENTIAL
 2

	)

79 
	#MADV_WILLNEED
 3

	)

80 
	#MADV_DONTNEED
 4

	)

81 
	#MADV_REMOVE
 9

	)

82 
	#MADV_DONTFORK
 10

	)

83 
	#MADV_DOFORK
 11

	)

84 
	#MADV_MERGEABLE
 12

	)

85 
	#MADV_UNMERGEABLE
 13

	)

86 
	#MADV_HUGEPAGE
 14

	)

87 
	#MADV_NOHUGEPAGE
 15

	)

88 
	#MADV_DONTDUMP
 16

	)

90 
	#MADV_DODUMP
 17

	)

91 
	#MADV_HWPOISON
 100

	)

95 #ifdeà
__USE_XOPEN2K


96 
	#POSIX_MADV_NORMAL
 0

	)

97 
	#POSIX_MADV_RANDOM
 1

	)

98 
	#POSIX_MADV_SEQUENTIAL
 2

	)

99 
	#POSIX_MADV_WILLNEED
 3

	)

100 
	#POSIX_MADV_DONTNEED
 4

	)

104 #iâdeà
MCL_CURRENT


105 
	#MCL_CURRENT
 1

	)

106 
	#MCL_FUTURE
 2

	)

	@/usr/include/bits/socket_type.h

19 #iâdeà
_SYS_SOCKET_H


24 
	e__sock‘_ty³


26 
	mSOCK_STREAM
 = 1,

28 
	#SOCK_STREAM
 
SOCK_STREAM


	)

29 
	mSOCK_DGRAM
 = 2,

31 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

32 
	mSOCK_RAW
 = 3,

33 
	#SOCK_RAW
 
SOCK_RAW


	)

34 
	mSOCK_RDM
 = 4,

35 
	#SOCK_RDM
 
SOCK_RDM


	)

36 
	mSOCK_SEQPACKET
 = 5,

38 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

39 
	mSOCK_DCCP
 = 6,

40 
	#SOCK_DCCP
 
SOCK_DCCP


	)

41 
	mSOCK_PACKET
 = 10,

44 
	#SOCK_PACKET
 
SOCK_PACKET


	)

49 
	mSOCK_CLOEXEC
 = 02000000,

51 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

52 
	mSOCK_NONBLOCK
 = 00004000

54 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

	@/usr/include/bits/stdio-lock.h

19 #iâdeà
_BITS_STDIO_LOCK_H


20 
	#_BITS_STDIO_LOCK_H
 1

	)

22 
	~<b™s/libc-lock.h
>

23 
	~<lowËv–lock.h
>

27 
	#_IO_lock_šex³nsive
 1

	)

29 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t_IO_lock_t
;

31 
	#_IO_lock_š™Ÿliz”
 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

33 
	#_IO_lock_š™
(
_Çme
) \

34 ((
_Çme
èğ(
_IO_lock_t
è
_IO_lock_š™Ÿliz”
 , 0)

	)

36 
	#_IO_lock_fši
(
_Çme
) \

37 ((è0)

	)

39 
	#_IO_lock_lock
(
_Çme
) \

41 *
__£lf
 = 
THREAD_SELF
; \

42 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

44 
	`Îl_lock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

45 (
_Çme
).
owÃr
 = 
__£lf
; \

47 ++(
_Çme
).
út
; \

48 } 0)

	)

50 
	#_IO_lock_Œylock
(
_Çme
) \

52 
__»suÉ
 = 0; \

53 *
__£lf
 = 
THREAD_SELF
; \

54 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

56 ià(
	`Îl_Œylock
 ((
_Çme
).
lock
) == 0) \

58 (
_Çme
).
owÃr
 = 
__£lf
; \

59 (
_Çme
).
út
 = 1; \

62 
__»suÉ
 = 
EBUSY
; \

65 ++(
_Çme
).
út
; \

66 
__»suÉ
; \

67 })

	)

69 
	#_IO_lock_uÆock
(
_Çme
) \

71 ià(--(
_Çme
).
út
 == 0) \

73 (
_Çme
).
owÃr
 = 
NULL
; \

74 
	`Îl_uÆock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

76 } 0)

	)

80 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
) \

81 
	`__libc_ş—nup_»giÚ_¡¬t
 (((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0, 
_fù
, _å)

	)

82 
	#_IO_ş—nup_»giÚ_¡¬t_nßrg
(
_fù
) \

83 
	`__libc_ş—nup_»giÚ_¡¬t
 (1, 
_fù
, 
NULL
)

	)

84 
	#_IO_ş—nup_»giÚ_’d
(
_do™
) \

85 
	`__libc_ş—nup_»giÚ_’d
 (
_do™
)

	)

87 #ià
defšed
 
_LIBC
 && !defšed 
NOT_IN_libc


89 #ifdeà
__EXCEPTIONS


90 
	#_IO_acquœe_lock
(
_å
) \

92 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

93 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_fù
))) \

94 ğ(
_å
); \

95 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

96 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
) \

98 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

99 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_ş—r_æags2_fù
))) \

100 ğ(
_å
); \

101 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

103 
	#_IO_acquœe_lock
(
_å
è
_IO_acquœe_lock_Ãeds_exû±iÚs_’abËd


	)

104 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
è
	`_IO_acquœe_lock
 (_å)

	)

106 
	#_IO_»Ëa£_lock
(
_å
è; } 0)

	)

	@/usr/include/bits/timex.h

18 #iâdef 
_BITS_TIMEX_H


19 
	#_BITS_TIMEX_H
 1

	)

21 
	~<b™s/ty³s.h
>

25 
	stimex


27 
	mmodes
;

28 
__sysÿÎ_¦Úg_t
 
	moff£t
;

29 
__sysÿÎ_¦Úg_t
 
	mäeq
;

30 
__sysÿÎ_¦Úg_t
 
	mmax”rÜ
;

31 
__sysÿÎ_¦Úg_t
 
	me¡”rÜ
;

32 
	m¡©us
;

33 
__sysÿÎ_¦Úg_t
 
	mcÚ¡ªt
;

34 
__sysÿÎ_¦Úg_t
 
	m´ecisiÚ
;

35 
__sysÿÎ_¦Úg_t
 
	mtŞ”ªû
;

36 
timev®
 
	mtime
;

37 
__sysÿÎ_¦Úg_t
 
	mtick
;

38 
__sysÿÎ_¦Úg_t
 
	mµsäeq
;

39 
__sysÿÎ_¦Úg_t
 
	mj™‹r
;

40 
	mshiá
;

41 
__sysÿÎ_¦Úg_t
 
	m¡ab
;

42 
__sysÿÎ_¦Úg_t
 
	mj™út
;

43 
__sysÿÎ_¦Úg_t
 
	mÿlút
;

44 
__sysÿÎ_¦Úg_t
 
	m”rút
;

45 
__sysÿÎ_¦Úg_t
 
	m¡bút
;

47 
	mi
;

56 
	#ADJ_OFFSET
 0x0001

	)

57 
	#ADJ_FREQUENCY
 0x0002

	)

58 
	#ADJ_MAXERROR
 0x0004

	)

59 
	#ADJ_ESTERROR
 0x0008

	)

60 
	#ADJ_STATUS
 0x0010

	)

61 
	#ADJ_TIMECONST
 0x0020

	)

62 
	#ADJ_TAI
 0x0080

	)

63 
	#ADJ_MICRO
 0x1000

	)

64 
	#ADJ_NANO
 0x2000

	)

65 
	#ADJ_TICK
 0x4000

	)

66 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

67 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

70 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

71 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

72 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

73 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

74 
	#MOD_STATUS
 
ADJ_STATUS


	)

75 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

76 
	#MOD_CLKB
 
ADJ_TICK


	)

77 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

78 
	#MOD_TAI
 
ADJ_TAI


	)

79 
	#MOD_MICRO
 
ADJ_MICRO


	)

80 
	#MOD_NANO
 
ADJ_NANO


	)

84 
	#STA_PLL
 0x0001

	)

85 
	#STA_PPSFREQ
 0x0002

	)

86 
	#STA_PPSTIME
 0x0004

	)

87 
	#STA_FLL
 0x0008

	)

89 
	#STA_INS
 0x0010

	)

90 
	#STA_DEL
 0x0020

	)

91 
	#STA_UNSYNC
 0x0040

	)

92 
	#STA_FREQHOLD
 0x0080

	)

94 
	#STA_PPSSIGNAL
 0x0100

	)

95 
	#STA_PPSJITTER
 0x0200

	)

96 
	#STA_PPSWANDER
 0x0400

	)

97 
	#STA_PPSERROR
 0x0800

	)

99 
	#STA_CLOCKERR
 0x1000

	)

100 
	#STA_NANO
 0x2000

	)

101 
	#STA_MODE
 0x4000

	)

102 
	#STA_CLK
 0x8000

	)

105 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

106 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@/usr/include/bits/typesizes.h

19 #iâdeà
_BITS_TYPES_H


23 #iâdef 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifdeà
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

75 #ifdeà
__x86_64__


79 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

82 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/gnu/stubs.h

6 #ià!
defšed
 
__x86_64__


7 
	~<gnu/¡ubs-32.h
>

9 #ià
defšed
 
__x86_64__
 && defšed 
__LP64__


10 
	~<gnu/¡ubs-64.h
>

12 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


13 
	~<gnu/¡ubs-x32.h
>

	@/usr/include/linux/errno.h

1 
	~<asm/”ºo.h
>

	@/usr/include/linux/limits.h

1 #iâdeà
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/param.h

1 #iâdeà
_LINUX_PARAM_H


2 
	#_LINUX_PARAM_H


	)

4 
	~<asm/·¿m.h
>

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__k”Ãl_fd_£t
;

29 (*
	t__k”Ãl_sighªdËr_t
)();

32 
	t__k”Ãl_key_t
;

33 
	t__k”Ãl_mqd_t
;

35 
	~<asm/posix_ty³s.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/asm-generic/ioctls.h

1 #iâdeà
__ASM_GENERIC_IOCTLS_H


2 
	#__ASM_GENERIC_IOCTLS_H


	)

4 
	~<lšux/ioùl.h
>

19 
	#TCGETS
 0x5401

	)

20 
	#TCSETS
 0x5402

	)

21 
	#TCSETSW
 0x5403

	)

22 
	#TCSETSF
 0x5404

	)

23 
	#TCGETA
 0x5405

	)

24 
	#TCSETA
 0x5406

	)

25 
	#TCSETAW
 0x5407

	)

26 
	#TCSETAF
 0x5408

	)

27 
	#TCSBRK
 0x5409

	)

28 
	#TCXONC
 0x540A

	)

29 
	#TCFLSH
 0x540B

	)

30 
	#TIOCEXCL
 0x540C

	)

31 
	#TIOCNXCL
 0x540D

	)

32 
	#TIOCSCTTY
 0x540E

	)

33 
	#TIOCGPGRP
 0x540F

	)

34 
	#TIOCSPGRP
 0x5410

	)

35 
	#TIOCOUTQ
 0x5411

	)

36 
	#TIOCSTI
 0x5412

	)

37 
	#TIOCGWINSZ
 0x5413

	)

38 
	#TIOCSWINSZ
 0x5414

	)

39 
	#TIOCMGET
 0x5415

	)

40 
	#TIOCMBIS
 0x5416

	)

41 
	#TIOCMBIC
 0x5417

	)

42 
	#TIOCMSET
 0x5418

	)

43 
	#TIOCGSOFTCAR
 0x5419

	)

44 
	#TIOCSSOFTCAR
 0x541A

	)

45 
	#FIONREAD
 0x541B

	)

46 
	#TIOCINQ
 
FIONREAD


	)

47 
	#TIOCLINUX
 0x541C

	)

48 
	#TIOCCONS
 0x541D

	)

49 
	#TIOCGSERIAL
 0x541E

	)

50 
	#TIOCSSERIAL
 0x541F

	)

51 
	#TIOCPKT
 0x5420

	)

52 
	#FIONBIO
 0x5421

	)

53 
	#TIOCNOTTY
 0x5422

	)

54 
	#TIOCSETD
 0x5423

	)

55 
	#TIOCGETD
 0x5424

	)

56 
	#TCSBRKP
 0x5425

	)

57 
	#TIOCSBRK
 0x5427

	)

58 
	#TIOCCBRK
 0x5428

	)

59 
	#TIOCGSID
 0x5429

	)

60 
	#TCGETS2
 
	`_IOR
('T', 0x2A, 
‹rmios2
)

	)

61 
	#TCSETS2
 
	`_IOW
('T', 0x2B, 
‹rmios2
)

	)

62 
	#TCSETSW2
 
	`_IOW
('T', 0x2C, 
‹rmios2
)

	)

63 
	#TCSETSF2
 
	`_IOW
('T', 0x2D, 
‹rmios2
)

	)

64 
	#TIOCGRS485
 0x542E

	)

65 #iâdeà
TIOCSRS485


66 
	#TIOCSRS485
 0x542F

	)

68 
	#TIOCGPTN
 
	`_IOR
('T', 0x30, è

	)

69 
	#TIOCSPTLCK
 
	`_IOW
('T', 0x31, è

	)

70 
	#TIOCGDEV
 
	`_IOR
('T', 0x32, è

	)

71 
	#TCGETX
 0x5432

	)

72 
	#TCSETX
 0x5433

	)

73 
	#TCSETXF
 0x5434

	)

74 
	#TCSETXW
 0x5435

	)

75 
	#TIOCSIG
 
	`_IOW
('T', 0x36, è

	)

76 
	#TIOCVHANGUP
 0x5437

	)

77 
	#TIOCGPKT
 
	`_IOR
('T', 0x38, è

	)

78 
	#TIOCGPTLCK
 
	`_IOR
('T', 0x39, è

	)

79 
	#TIOCGEXCL
 
	`_IOR
('T', 0x40, è

	)

81 
	#FIONCLEX
 0x5450

	)

82 
	#FIOCLEX
 0x5451

	)

83 
	#FIOASYNC
 0x5452

	)

84 
	#TIOCSERCONFIG
 0x5453

	)

85 
	#TIOCSERGWILD
 0x5454

	)

86 
	#TIOCSERSWILD
 0x5455

	)

87 
	#TIOCGLCKTRMIOS
 0x5456

	)

88 
	#TIOCSLCKTRMIOS
 0x5457

	)

89 
	#TIOCSERGSTRUCT
 0x5458

	)

90 
	#TIOCSERGETLSR
 0x5459

	)

91 
	#TIOCSERGETMULTI
 0x545A

	)

92 
	#TIOCSERSETMULTI
 0x545B

	)

94 
	#TIOCMIWAIT
 0x545C

	)

95 
	#TIOCGICOUNT
 0x545D

	)

101 #iâdeà
FIOQSIZE


102 
	#FIOQSIZE
 0x5460

	)

106 
	#TIOCPKT_DATA
 0

	)

107 
	#TIOCPKT_FLUSHREAD
 1

	)

108 
	#TIOCPKT_FLUSHWRITE
 2

	)

109 
	#TIOCPKT_STOP
 4

	)

110 
	#TIOCPKT_START
 8

	)

111 
	#TIOCPKT_NOSTOP
 16

	)

112 
	#TIOCPKT_DOSTOP
 32

	)

113 
	#TIOCPKT_IOCTL
 64

	)

115 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm-generic/socket.h

1 #iâdeà
__ASM_GENERIC_SOCKET_H


2 
	#__ASM_GENERIC_SOCKET_H


	)

4 
	~<asm/sockios.h
>

7 
	#SOL_SOCKET
 1

	)

9 
	#SO_DEBUG
 1

	)

10 
	#SO_REUSEADDR
 2

	)

11 
	#SO_TYPE
 3

	)

12 
	#SO_ERROR
 4

	)

13 
	#SO_DONTROUTE
 5

	)

14 
	#SO_BROADCAST
 6

	)

15 
	#SO_SNDBUF
 7

	)

16 
	#SO_RCVBUF
 8

	)

17 
	#SO_SNDBUFFORCE
 32

	)

18 
	#SO_RCVBUFFORCE
 33

	)

19 
	#SO_KEEPALIVE
 9

	)

20 
	#SO_OOBINLINE
 10

	)

21 
	#SO_NO_CHECK
 11

	)

22 
	#SO_PRIORITY
 12

	)

23 
	#SO_LINGER
 13

	)

24 
	#SO_BSDCOMPAT
 14

	)

25 
	#SO_REUSEPORT
 15

	)

26 #iâdeà
SO_PASSCRED


27 
	#SO_PASSCRED
 16

	)

28 
	#SO_PEERCRED
 17

	)

29 
	#SO_RCVLOWAT
 18

	)

30 
	#SO_SNDLOWAT
 19

	)

31 
	#SO_RCVTIMEO
 20

	)

32 
	#SO_SNDTIMEO
 21

	)

36 
	#SO_SECURITY_AUTHENTICATION
 22

	)

37 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

38 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

40 
	#SO_BINDTODEVICE
 25

	)

43 
	#SO_ATTACH_FILTER
 26

	)

44 
	#SO_DETACH_FILTER
 27

	)

45 
	#SO_GET_FILTER
 
SO_ATTACH_FILTER


	)

47 
	#SO_PEERNAME
 28

	)

48 
	#SO_TIMESTAMP
 29

	)

49 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

51 
	#SO_ACCEPTCONN
 30

	)

53 
	#SO_PEERSEC
 31

	)

54 
	#SO_PASSSEC
 34

	)

55 
	#SO_TIMESTAMPNS
 35

	)

56 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

58 
	#SO_MARK
 36

	)

60 
	#SO_TIMESTAMPING
 37

	)

61 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

63 
	#SO_PROTOCOL
 38

	)

64 
	#SO_DOMAIN
 39

	)

66 
	#SO_RXQ_OVFL
 40

	)

68 
	#SO_WIFI_STATUS
 41

	)

69 
	#SCM_WIFI_STATUS
 
SO_WIFI_STATUS


	)

70 
	#SO_PEEK_OFF
 42

	)

73 
	#SO_NOFCS
 43

	)

75 
	#SO_LOCK_FILTER
 44

	)

77 
	#SO_SELECT_ERR_QUEUE
 45

	)

79 
	#SO_BUSY_POLL
 46

	)

81 
	#SO_MAX_PACING_RATE
 47

	)

	@/usr/include/asm-generic/types.h

1 #iâdeà
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-g’”ic/št-Î64.h
>

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/param.h

1 
	~<asm-g’”ic/·¿m.h
>

	@/usr/include/asm/posix_types.h

1 #ifdeà
__i386__


2 
	~<asm/posix_ty³s_32.h
>

3 #–ià
defšed
(
__ILP32__
)

4 
	~<asm/posix_ty³s_x32.h
>

6 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/bits/libc-lock.h

19 #iâdeà
_BITS_LIBC_LOCK_H


20 
	#_BITS_LIBC_LOCK_H
 1

	)

22 
	~<±h»ad.h
>

23 
	#__Ãed_NULL


	)

24 
	~<¡ddef.h
>

27 #ifdeà
_LIBC


28 
	~<lowËv–lock.h
>

29 
	~<s.h
>

30 
	~<±h»ad-funùiÚs.h
>

31 
	~<”ºo.h
>

32 
	~<gnu/İtiÚ-groups.h
>

36 #ià
defšed
 
_LIBC
 || defšed 
_IO_MTSAFE_IO


37 #ià(
defšed
 
NOT_IN_libc
 && !defšed 
IS_IN_lib±h»ad
è|| !defšed 
_LIBC


38 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__libc_lock_»cursive_t
;

40 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t__libc_lock_»cursive_t
;

43 
__libc_lock_»cursive_İaque__
 
	t__libc_lock_»cursive_t
;

53 
	#__libc_lock_defše_»cursive
(
CLASS
,
NAME
) \

54 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

58 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

59 #ià
LLL_LOCK_INITIALIZER
 == 0

60 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

61 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

63 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

64 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

66 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

67 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

69 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

70 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

71 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

72 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

76 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

77 
	#__libc_lock_š™_»cursive
(
NAME
) \

78 ((
NAME
èğ(
__libc_lock_»cursive_t
è
_LIBC_LOCK_RECURSIVE_INITIALIZER
, 0)

	)

80 
	#__libc_lock_š™_»cursive
(
NAME
) \

82 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

84 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

85 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

86 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

87 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

88 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

90 } 0)

	)

94 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

95 
	#__libc_lock_fši_»cursive
(
NAME
è((è0)

	)

97 
	#__libc_lock_fši_»cursive
(
NAME
) \

98 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
).
mu‹x
), 0)

	)

102 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

103 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

107 
__libc_lock_lock_»cursive_â
 (
__libc_lock_»cursive_t
 *);

108 
libc_hidd’_´Ùo
 (
__libc_lock_lock_»cursive_â
);

110 #ià
__OPTION_EGLIBC_BIG_MACROS


111 
	#__libc_lock_lock_»cursive
(
NAME
) \

113 *
£lf
 = 
THREAD_SELF
; \

114 ià((
NAME
).
owÃr
 !ğ
£lf
) \

116 
	`Îl_lock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

117 (
NAME
).
owÃr
 = 
£lf
; \

119 ++(
NAME
).
út
; \

120 } 0)

	)

122 
	#__libc_lock_lock_»cursive
(
NAME
) \

123 
	`__libc_lock_lock_»cursive_â
 (&(
NAME
))

	)

126 
	#__libc_lock_lock_»cursive
(
NAME
) \

127 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

131 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

132 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

136 
__libc_lock_Œylock_»cursive_â
 (
__libc_lock_»cursive_t
 *);

137 
libc_hidd’_´Ùo
 (
__libc_lock_Œylock_»cursive_â
);

139 #ià
__OPTION_EGLIBC_BIG_MACROS


140 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

142 
»suÉ
 = 0; \

143 *
£lf
 = 
THREAD_SELF
; \

144 ià((
NAME
).
owÃr
 !ğ
£lf
) \

146 ià(
	`Îl_Œylock
 ((
NAME
).
lock
) == 0) \

148 (
NAME
).
owÃr
 = 
£lf
; \

149 (
NAME
).
út
 = 1; \

152 
»suÉ
 = 
EBUSY
; \

155 ++(
NAME
).
út
; \

156 
»suÉ
; \

157 })

	)

159 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

160 
	`__libc_lock_Œylock_»cursive_â
 (&(
NAME
))

	)

163 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

164 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
).
mu‹x
), 0)

	)

168 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

169 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

173 
__libc_lock_uÆock_»cursive_â
 (
__libc_lock_»cursive_t
 *);

174 
libc_hidd’_´Ùo
 (
__libc_lock_uÆock_»cursive_â
);

176 #ià
__OPTION_EGLIBC_BIG_MACROS


178 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

180 ià(--(
NAME
).
út
 == 0) \

182 (
NAME
).
owÃr
 = 
NULL
; \

183 
	`Îl_uÆock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

185 } 0)

	)

187 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

188 
	`__libc_lock_uÆock_»cursive_â
 (&(
NAME
))

	)

191 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

192 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
).
mu‹x
), 0)

	)

199 
_±h»ad_ş—nup_push_deãr
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

200 (*
routše
è(*), *
¬g
);

201 
	`_±h»ad_ş—nup_pİ_»¡Üe
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

202 
execu‹
);

205 
	#__libc_ş—nup_»giÚ_¡¬t
(
DOIT
, 
FCT
, 
ARG
) \

206 { 
_±h»ad_ş—nup_bufãr
 
_bufãr
; \

207 
_ava
; \

208 ià(
DOIT
) { \

209 
_ava
 = 
	`PTFAVAIL
 (
_±h»ad_ş—nup_push_deãr
); \

210 ià(
_ava
) { \

211 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_push_deãr
, (&
_bufãr
, 
FCT
, \

212 
ARG
)); \

214 
_bufãr
.
__routše
 = (
FCT
); \

215 
_bufãr
.
__¬g
 = (
ARG
); \

218 
_ava
 = 0; \

219 }

	)

222 
	#__libc_ş—nup_»giÚ_’d
(
DOIT
) \

223 ià(
_ava
) { \

224 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

225 } ià(
DOIT
) \

226 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
); \

227 
	}

	)
}

232 #ifdeà
_LIBC


233 
	~"libc-lockP.h
"

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
) (*, const *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 cÚ¡ *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_chæags


	)

11 
	#__¡ub_ç‰ach


	)

12 
	#__¡ub_fchæags


	)

13 
	#__¡ub_fd‘ach


	)

14 
	#__¡ub_g‰y


	)

15 
	#__¡ub_lchmod


	)

16 
	#__¡ub_»voke


	)

17 
	#__¡ub_£ogš


	)

18 
	#__¡ub_sig»tuº


	)

19 
	#__¡ub_s¡k


	)

20 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-x32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ü—‹_moduË


	)

13 
	#__¡ub_ç‰ach


	)

14 
	#__¡ub_fchæags


	)

15 
	#__¡ub_fd‘ach


	)

16 
	#__¡ub_g‘_k”Ãl_syms


	)

17 
	#__¡ub_g‘msg


	)

18 
	#__¡ub_g‰y


	)

19 
	#__¡ub_lchmod


	)

20 
	#__¡ub_nfs£rvùl


	)

21 
	#__¡ub_putmsg


	)

22 
	#__¡ub_qu”y_moduË


	)

23 
	#__¡ub_»voke


	)

24 
	#__¡ub_£ogš


	)

25 
	#__¡ub_sig»tuº


	)

26 
	#__¡ub_s¡k


	)

27 
	#__¡ub_¡ty


	)

28 
	#__¡ub_u£lib


	)

	@/usr/include/linux/stddef.h

	@/usr/include/asm-generic/errno.h

1 #iâdeà
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-g’”ic/”ºo-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

109 
	#ERFKILL
 132

	)

111 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/int-ll64.h

8 #iâdeà
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/b™¥”lÚg.h
>

13 #iâdeà
__ASSEMBLY__


19 
__sigÃd__
 
	t__s8
;

20 
	t__u8
;

22 
__sigÃd__
 
	t__s16
;

23 
	t__u16
;

25 
__sigÃd__
 
	t__s32
;

26 
	t__u32
;

28 #ifdeà
__GNUC__


29 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

30 
__ex‹nsiÚ__
 
	t__u64
;

32 
__sigÃd__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm-generic/param.h

1 #iâdeà
__ASM_GENERIC_PARAM_H


2 
	#__ASM_GENERIC_PARAM_H


	)

4 #iâdeà
HZ


5 
	#HZ
 100

	)

8 #iâdeà
EXEC_PAGESIZE


9 
	#EXEC_PAGESIZE
 4096

	)

12 #iâdeà
NOGROUP


13 
	#NOGROUP
 (-1)

	)

16 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/asm/posix_types_32.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_32_H


2 
	#_ASM_X86_POSIX_TYPES_32_H


	)

10 
	t__k”Ãl_mode_t
;

11 
	#__k”Ãl_mode_t
 
__k”Ãl_mode_t


	)

13 
	t__k”Ãl_c_pid_t
;

14 
	#__k”Ãl_c_pid_t
 
__k”Ãl_c_pid_t


	)

16 
	t__k”Ãl_uid_t
;

17 
	t__k”Ãl_gid_t
;

18 
	#__k”Ãl_uid_t
 
__k”Ãl_uid_t


	)

20 
	t__k”Ãl_Şd_dev_t
;

21 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

23 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_64.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_64_H


2 
	#_ASM_X86_POSIX_TYPES_64_H


	)

10 
	t__k”Ãl_Şd_uid_t
;

11 
	t__k”Ãl_Şd_gid_t
;

12 
	#__k”Ãl_Şd_uid_t
 
__k”Ãl_Şd_uid_t


	)

14 
	t__k”Ãl_Şd_dev_t
;

15 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

17 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_x32.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_X32_H


2 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

13 
	t__k”Ãl_lÚg_t
;

14 
	t__k”Ãl_ulÚg_t
;

15 
	#__k”Ãl_lÚg_t
 
__k”Ãl_lÚg_t


	)

17 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/asm/sockios.h

1 
	~<asm-g’”ic/sockios.h
>

	@/usr/include/gnu/option-groups.h

10 #iâdeà
__GNU_OPTION_GROUPS_H


11 
	#__GNU_OPTION_GROUPS_H


	)

13 
	#__OPTION_EGLIBC_ADVANCED_INET6
 1

	)

14 
	#__OPTION_EGLIBC_BACKTRACE
 1

	)

15 
	#__OPTION_EGLIBC_BIG_MACROS
 1

	)

16 
	#__OPTION_EGLIBC_BSD
 1

	)

17 
	#__OPTION_EGLIBC_CATGETS
 1

	)

18 
	#__OPTION_EGLIBC_CHARSETS
 1

	)

19 
	#__OPTION_EGLIBC_CRYPT
 1

	)

20 
	#__OPTION_EGLIBC_CRYPT_UFC
 1

	)

21 
	#__OPTION_EGLIBC_CXX_TESTS
 1

	)

22 
	#__OPTION_EGLIBC_DB_ALIASES
 1

	)

23 
	#__OPTION_EGLIBC_ENVZ
 1

	)

24 
	#__OPTION_EGLIBC_FCVT
 1

	)

25 
	#__OPTION_EGLIBC_FMTMSG
 1

	)

26 
	#__OPTION_EGLIBC_FSTAB
 1

	)

27 
	#__OPTION_EGLIBC_FTRAVERSE
 1

	)

28 
	#__OPTION_EGLIBC_GETLOGIN
 1

	)

29 
	#__OPTION_EGLIBC_IDN
 1

	)

30 
	#__OPTION_EGLIBC_INET
 1

	)

31 
	#__OPTION_EGLIBC_INET_ANL
 1

	)

32 
	#__OPTION_EGLIBC_LIBM
 1

	)

33 
	#__OPTION_EGLIBC_LOCALES
 1

	)

34 
	#__OPTION_EGLIBC_LOCALE_CODE
 1

	)

35 
	#__OPTION_EGLIBC_MEMUSAGE
 1

	)

36 
	#__OPTION_EGLIBC_NIS
 1

	)

37 
	#__OPTION_EGLIBC_NSSWITCH
 1

	)

38 
	#__OPTION_EGLIBC_RCMD
 1

	)

39 
	#__OPTION_EGLIBC_RTLD_DEBUG
 1

	)

40 
	#__OPTION_EGLIBC_SPAWN
 1

	)

41 
	#__OPTION_EGLIBC_STREAMS
 1

	)

42 
	#__OPTION_EGLIBC_SUNRPC
 1

	)

43 
	#__OPTION_EGLIBC_UTMP
 1

	)

44 
	#__OPTION_EGLIBC_UTMPX
 1

	)

45 
	#__OPTION_EGLIBC_WORDEXP
 1

	)

46 
	#__OPTION_POSIX_C_LANG_WIDE_CHAR
 1

	)

47 
	#__OPTION_POSIX_REGEXP
 1

	)

48 
	#__OPTION_POSIX_REGEXP_GLIBC
 1

	)

49 
	#__OPTION_POSIX_WIDE_CHAR_DEVICE_IO
 1

	)

	@/usr/include/linux/ioctl.h

1 #iâdeà
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/ioùl.h
>

	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifdeà
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifdeà
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 1

87 
	#__PTHREAD_SPINS
 0, 0

	)

88 #–ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 2

89 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

91 
	#__PTHREAD_SPINS
 0

	)

94 #ifdeà
__PTHREAD_MUTEX_HAVE_PREV


95 
	#PTHREAD_MUTEX_INITIALIZER
 \

96 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

97 #ifdeà
__USE_GNU


98 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

101 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

102 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

104 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

109 
	#PTHREAD_MUTEX_INITIALIZER
 \

110 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

111 #ifdeà
__USE_GNU


112 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

113 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

115 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

116 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

117 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

124 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


127 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

128 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

129 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

130 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


136 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 #ià
__WORDSIZE
 == 64

138 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

143 
	#PTHREAD_RWLOCK_INITIALIZER
 \

144 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

145 #ifdeà
__USE_GNU


146 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

149 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

151 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


152 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

153 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

154 0, 0, 0, 0 } }

	)

156 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

157 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

158 0 } }

	)

168 
	mPTHREAD_INHERIT_SCHED
,

169 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

170 
	mPTHREAD_EXPLICIT_SCHED


171 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

178 
	mPTHREAD_SCOPE_SYSTEM
,

179 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

180 
	mPTHREAD_SCOPE_PROCESS


181 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

188 
	mPTHREAD_PROCESS_PRIVATE
,

189 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

190 
	mPTHREAD_PROCESS_SHARED


191 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

197 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

201 
	s_±h»ad_ş—nup_bufãr


203 (*
	m__routše
) (*);

204 *
	m__¬g
;

205 
	m__ÿnûÉy³
;

206 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

212 
	mPTHREAD_CANCEL_ENABLE
,

213 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

214 
	mPTHREAD_CANCEL_DISABLE


215 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

219 
	mPTHREAD_CANCEL_DEFERRED
,

220 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

221 
	mPTHREAD_CANCEL_ASYNCHRONOUS


222 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

224 
	#PTHREAD_CANCELED
 ((*è-1)

	)

228 
	#PTHREAD_ONCE_INIT
 0

	)

231 #ifdeà
__USE_XOPEN2K


235 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

239 
__BEGIN_DECLS


244 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

245 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

246 *(*
__¡¬t_routše
) (*),

247 *
__»¡riù
 
__¬g
è
__THROWNL
 
__nÚnuÎ
 ((1, 3));

253 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

261 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

263 #ifdeà
__USE_GNU


266 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

274 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

275 cÚ¡ 
time¥ec
 *
__ab¡ime
);

282 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

286 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

289 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

290 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

298 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

301 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

306 *
__d‘ach¡©e
)

307 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

310 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

311 
__d‘ach¡©e
)

312 
__THROW
 
	`__nÚnuÎ
 ((1));

316 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

317 
size_t
 *
__gu¬dsize
)

318 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

321 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

322 
size_t
 
__gu¬dsize
)

323 
__THROW
 
	`__nÚnuÎ
 ((1));

327 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

328 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

333 cÚ¡ 
sched_·¿m
 *
__»¡riù


334 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

337 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


338 
__©Œ
, *
__»¡riù
 
__pŞicy
)

339 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

342 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

346 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


347 
__©Œ
, *
__»¡riù
 
__šh”™
)

348 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

351 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

352 
__šh”™
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

357 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

358 *
__»¡riù
 
__scİe
)

359 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

362 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

363 
__THROW
 
	`__nÚnuÎ
 ((1));

366 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


367 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

368 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

374 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

375 *
__¡ackaddr
)

376 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

379 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


380 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

381 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

387 
size_t
 
__¡acksize
)

388 
__THROW
 
	`__nÚnuÎ
 ((1));

390 #ifdeà
__USE_XOPEN2K


392 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

393 **
__»¡riù
 
__¡ackaddr
,

394 
size_t
 *
__»¡riù
 
__¡acksize
)

395 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

400 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

401 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

404 #ifdeà
__USE_GNU


407 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

408 
size_t
 
__ıu£tsize
,

409 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

410 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

414 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

415 
size_t
 
__ıu£tsize
,

416 
ıu_£t_t
 *
__ıu£t
)

417 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

420 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

421 
__THROW
 
	`__nÚnuÎ
 ((1));

425 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

426 
__THROW
 
	`__nÚnuÎ
 ((1));

431 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

441 cÚ¡ 
sched_·¿m
 *
__·¿m
)

442 
__THROW
 
	`__nÚnuÎ
 ((3));

445 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

446 *
__»¡riù
 
__pŞicy
,

447 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

448 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

451 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

452 
__THROW
;

455 #ifdeà
__USE_GNU


457 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

458 
size_t
 
__buæ’
)

459 
__THROW
 
	`__nÚnuÎ
 ((2));

462 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

463 
__THROW
 
	`__nÚnuÎ
 ((2));

467 #ifdeà
__USE_UNIX98


469 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

472 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

475 #ifdeà
__USE_GNU


480 
	$±h»ad_y›ld
 (è
__THROW
;

485 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

486 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

487 
__THROW
 
	`__nÚnuÎ
 ((3));

490 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

491 
ıu_£t_t
 *
__ıu£t
)

492 
__THROW
 
	`__nÚnuÎ
 ((3));

505 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

506 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

517 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

521 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

524 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

529 
	`±h»ad_‹¡ÿnûl
 ();

538 
__jmp_buf
 
__ÿnûl_jmp_buf
;

539 
__mask_was_§ved
;

540 } 
__ÿnûl_jmp_buf
[1];

541 *
__·d
[4];

542 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

545 #iâdeà
__ş—nup_fù_©Œibu‹


546 
	#__ş—nup_fù_©Œibu‹


	)

551 
	s__±h»ad_ş—nup_äame


553 (*
__ÿnûl_routše
) (*);

554 *
__ÿnûl_¬g
;

555 
__do_™
;

556 
__ÿnûl_ty³
;

559 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


560 #ifdeà
__ılu¥lus


562 şas 
	c__±h»ad_ş—nup_şass


564 (*
__ÿnûl_routše
) (*);

565 *
__ÿnûl_¬g
;

566 
__do_™
;

567 
__ÿnûl_ty³
;

569 
public
:

570 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

571 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

572 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

573 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

574 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

575 &
__ÿnûl_ty³
); 
	}
}

576 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

586 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

588 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

592 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

593 
__şäame
.
	`__£tdo™
 (
execu‹
); \

594 } 0)

	)

596 #ifdeà
__USE_GNU


600 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

602 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

603 
__şäame
.
	`__deãr
 ()

	)

608 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

609 
__şäame
.
	`__»¡Üe
 (); \

610 
__şäame
.
	`__£tdo™
 (
execu‹
); \

611 } 0)

	)

618 
__ex‹º_šlše
 

619 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

621 ià(
__äame
->
__do_™
)

622 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

623 
	}
}

632 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

634 
__±h»ad_ş—nup_äame
 
__şäame
 \

635 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

636 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

637 .
__do_™
 = 1 };

	)

641 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

642 
__şäame
.
__do_™
 = (
execu‹
); \

643 } 0)

	)

645 #ifdeà
__USE_GNU


649 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

651 
__±h»ad_ş—nup_äame
 
__şäame
 \

652 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

653 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

654 .
__do_™
 = 1 }; \

655 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

656 &
__şäame
.
__ÿnûl_ty³
)

	)

661 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

662 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

663 
__şäame
.
__do_™
 = (
execu‹
); \

664 } 0)

	)

675 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

677 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

678 (*
__ÿnûl_routše
è(*èğ(
routše
); \

679 *
__ÿnûl_¬g
 = (
¬g
); \

680 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

681 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

682 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

684 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

685 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

689 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 dØ{

	)

691 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

692 
__ş—nup_fù_©Œibu‹
;

696 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

699 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

700 ià(
execu‹
) \

701 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

702 } 0)

	)

703 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

704 
__ş—nup_fù_©Œibu‹
;

706 #ifdeà
__USE_GNU


710 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

712 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

713 (*
__ÿnûl_routše
è(*èğ(
routše
); \

714 *
__ÿnûl_¬g
 = (
¬g
); \

715 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

716 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

717 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

719 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

720 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

724 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

725 dØ{

	)

726 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

727 
__ş—nup_fù_©Œibu‹
;

732 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

735 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

736 ià(
execu‹
) \

737 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

738 
	}
} 0)

	)

739 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

740 
__ş—nup_fù_©Œibu‹
;

744 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

745 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

746 #iâdeà
SHARED


747 
	`__©Œibu‹__
 ((
__w—k__
))

753 
__jmp_buf_g
;

754 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

760 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

761 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

762 
__THROW
 
	`__nÚnuÎ
 ((1));

765 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

766 
__THROW
 
	`__nÚnuÎ
 ((1));

769 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

770 
__THROWNL
 
	`__nÚnuÎ
 ((1));

773 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

774 
__THROWNL
 
	`__nÚnuÎ
 ((1));

776 #ifdeà
__USE_XOPEN2K


778 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

779 cÚ¡ 
time¥ec
 *
__»¡riù


780 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

784 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

785 
__THROWNL
 
	`__nÚnuÎ
 ((1));

789 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

790 
__»¡riù
 
__mu‹x
,

791 *
__»¡riù
 
__´ioûšg
)

792 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

796 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

797 
__´ioûšg
,

798 *
__»¡riù
 
__Şd_ûšg
)

799 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

802 #ifdeà
__USE_XOPEN2K8


804 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

805 
__THROW
 
	`__nÚnuÎ
 ((1));

806 #ifdeà
__USE_GNU


807 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

817 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

818 
__THROW
 
	`__nÚnuÎ
 ((1));

821 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

825 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

826 
__»¡riù
 
__©Œ
,

827 *
__»¡riù
 
__psh¬ed
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

831 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

832 
__psh¬ed
)

833 
__THROW
 
	`__nÚnuÎ
 ((1));

835 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


837 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


838 
__©Œ
, *
__»¡riù
 
__kšd
)

839 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

844 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

845 
__THROW
 
	`__nÚnuÎ
 ((1));

849 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

850 
__»¡riù
 
__©Œ
,

851 *
__»¡riù
 
__´ÙocŞ
)

852 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

856 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

857 
__´ÙocŞ
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

861 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

862 
__»¡riù
 
__©Œ
,

863 *
__»¡riù
 
__´ioûšg
)

864 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

867 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 
__´ioûšg
)

869 
__THROW
 
	`__nÚnuÎ
 ((1));

871 #ifdeà
__USE_XOPEN2K


873 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 *
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 *
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

883 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

884 
__robu¡Ãss
)

885 
__THROW
 
	`__nÚnuÎ
 ((1));

886 #ifdeà
__USE_GNU


887 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

888 
__robu¡Ãss
)

889 
__THROW
 
	`__nÚnuÎ
 ((1));

894 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


899 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

900 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


901 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

904 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

905 
__THROW
 
	`__nÚnuÎ
 ((1));

908 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

909 
__THROWNL
 
	`__nÚnuÎ
 ((1));

912 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nÚnuÎ
 ((1));

915 #ifdeà
__USE_XOPEN2K


917 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

918 cÚ¡ 
time¥ec
 *
__»¡riù


919 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

923 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

924 
__THROWNL
 
	`__nÚnuÎ
 ((1));

927 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nÚnuÎ
 ((1));

930 #ifdeà
__USE_XOPEN2K


932 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

933 cÚ¡ 
time¥ec
 *
__»¡riù


934 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

938 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

939 
__THROWNL
 
	`__nÚnuÎ
 ((1));

945 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

946 
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

954 
__»¡riù
 
__©Œ
,

955 *
__»¡riù
 
__psh¬ed
)

956 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

959 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

960 
__psh¬ed
)

961 
__THROW
 
	`__nÚnuÎ
 ((1));

964 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

965 
__»¡riù
 
__©Œ
,

966 *
__»¡riù
 
__´ef
)

967 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

970 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

971 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

979 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

980 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

981 
__THROW
 
	`__nÚnuÎ
 ((1));

984 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

985 
__THROW
 
	`__nÚnuÎ
 ((1));

988 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

989 
__THROWNL
 
	`__nÚnuÎ
 ((1));

992 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

993 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1000 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1001 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

1002 
	`__nÚnuÎ
 ((1, 2));

1011 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1012 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1013 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1014 
	`__nÚnuÎ
 ((1, 2, 3));

1019 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1));

1023 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1024 
__THROW
 
	`__nÚnuÎ
 ((1));

1027 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1028 
__»¡riù
 
__©Œ
,

1029 *
__»¡riù
 
__psh¬ed
)

1030 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1033 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1034 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1036 #ifdeà
__USE_XOPEN2K


1038 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1039 
__»¡riù
 
__©Œ
,

1040 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1041 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1044 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1045 
__şockid_t
 
__şock_id
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1050 #ifdeà
__USE_XOPEN2K


1055 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1056 
__THROW
 
	`__nÚnuÎ
 ((1));

1059 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1060 
__THROW
 
	`__nÚnuÎ
 ((1));

1063 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1064 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1067 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1068 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1071 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1072 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1080 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1081 
__©Œ
, 
__couÁ
)

1082 
__THROW
 
	`__nÚnuÎ
 ((1));

1085 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1086 
__THROW
 
	`__nÚnuÎ
 ((1));

1089 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1090 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1094 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1));

1098 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1099 
__THROW
 
	`__nÚnuÎ
 ((1));

1102 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1103 
__»¡riù
 
__©Œ
,

1104 *
__»¡riù
 
__psh¬ed
)

1105 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1108 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1109 
__psh¬ed
)

1110 
__THROW
 
	`__nÚnuÎ
 ((1));

1122 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1123 (*
__de¡r_funùiÚ
) (*))

1124 
__THROW
 
	`__nÚnuÎ
 ((1));

1127 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1130 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1133 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1134 cÚ¡ *
__poš‹r
è
__THROW
 ;

1137 #ifdeà
__USE_XOPEN2K


1139 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1140 
__şockid_t
 *
__şock_id
)

1141 
__THROW
 
	`__nÚnuÎ
 ((2));

1156 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1157 (*
__·»Á
) (),

1158 (*
__chd
è()è
__THROW
;

1161 #ifdeà
__USE_EXTERN_INLINES


1163 
__ex‹º_šlše
 

1164 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1166  
__th»ad1
 =ğ
__th»ad2
;

1167 
	}
}

1170 
	g__END_DECLS


	@/usr/include/asm-generic/errno-base.h

1 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/posix_types.h

1 #iâdeà
__ASM_GENERIC_POSIX_TYPES_H


2 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

4 
	~<asm/b™¥”lÚg.h
>

13 #iâdeà
__k”Ãl_lÚg_t


14 
	t__k”Ãl_lÚg_t
;

15 
	t__k”Ãl_ulÚg_t
;

18 #iâdeà
__k”Ãl_šo_t


19 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_šo_t
;

22 #iâdeà
__k”Ãl_mode_t


23 
	t__k”Ãl_mode_t
;

26 #iâdeà
__k”Ãl_pid_t


27 
	t__k”Ãl_pid_t
;

30 #iâdeà
__k”Ãl_c_pid_t


31 
	t__k”Ãl_c_pid_t
;

34 #iâdeà
__k”Ãl_uid_t


35 
	t__k”Ãl_uid_t
;

36 
	t__k”Ãl_gid_t
;

39 #iâdeà
__k”Ãl_su£cÚds_t


40 
__k”Ãl_lÚg_t
 
	t__k”Ãl_su£cÚds_t
;

43 #iâdeà
__k”Ãl_daddr_t


44 
	t__k”Ãl_daddr_t
;

47 #iâdeà
__k”Ãl_uid32_t


48 
	t__k”Ãl_uid32_t
;

49 
	t__k”Ãl_gid32_t
;

52 #iâdeà
__k”Ãl_Şd_uid_t


53 
__k”Ãl_uid_t
 
	t__k”Ãl_Şd_uid_t
;

54 
__k”Ãl_gid_t
 
	t__k”Ãl_Şd_gid_t
;

57 #iâdeà
__k”Ãl_Şd_dev_t


58 
	t__k”Ãl_Şd_dev_t
;

65 #iâdeà
__k”Ãl_size_t


66 #ià
__BITS_PER_LONG
 != 64

67 
	t__k”Ãl_size_t
;

68 
	t__k”Ãl_ssize_t
;

69 
	t__k”Ãl_±rdiff_t
;

71 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_size_t
;

72 
__k”Ãl_lÚg_t
 
	t__k”Ãl_ssize_t
;

73 
__k”Ãl_lÚg_t
 
	t__k”Ãl_±rdiff_t
;

77 #iâdeà
__k”Ãl_fsid_t


79 
	mv®
[2];

80 } 
	t__k”Ãl_fsid_t
;

86 
__k”Ãl_lÚg_t
 
	t__k”Ãl_off_t
;

87 
	t__k”Ãl_loff_t
;

88 
__k”Ãl_lÚg_t
 
	t__k”Ãl_time_t
;

89 
__k”Ãl_lÚg_t
 
	t__k”Ãl_şock_t
;

90 
	t__k”Ãl_tim”_t
;

91 
	t__k”Ãl_şockid_t
;

92 * 
	t__k”Ãl_ÿddr_t
;

93 
	t__k”Ãl_uid16_t
;

94 
	t__k”Ãl_gid16_t
;

	@/usr/include/asm-generic/sockios.h

1 #iâdeà
__ASM_GENERIC_SOCKIOS_H


2 
	#__ASM_GENERIC_SOCKIOS_H


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

11 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/asm/bitsperlong.h

1 #iâdeà
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifdeà
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/bits/setjmp.h

19 #iâdeà
_BITS_SETJMP_H


20 
	#_BITS_SETJMP_H
 1

	)

22 #ià!
defšed
 
_SETJMP_H
 && !defšed 
_PTHREAD_H


26 
	~<b™s/wÜdsize.h
>

28 #iâdeà
_ASM


30 #ià
__WORDSIZE
 == 64

31 
	t__jmp_buf
[8];

32 #–ià
defšed
 
__x86_64__


33 
__ex‹nsiÚ__
 
	t__jmp_buf
[8];

35 
	t__jmp_buf
[6];

	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 
	#__Ãed_time_t


	)

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

34 #iâdeà
__pid_t_defšed


35 
__pid_t
 
	tpid_t
;

36 
	#__pid_t_defšed


	)

41 
	~<b™s/sched.h
>

43 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

46 
__BEGIN_DECLS


49 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

50 
__THROW
;

53 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

56 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

57 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

60 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

63 
	$sched_y›ld
 (è
__THROW
;

66 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

69 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

72 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

75 #ifdeà
__USE_GNU


77 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

78 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

80 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

81 
ıu£
)

	)

82 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

83 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

86 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

87 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

88 
ıu£
)

	)

89 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

90 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

92 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

93 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

94 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

97 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

103 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

105 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

107 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

110 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

111 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

112 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

116 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

117 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

120 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

121 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

124 
__END_DECLS


	@/usr/include/asm-generic/bitsperlong.h

1 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #iâdeà
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/asm-generic/ioctl.h

1 #iâdeà
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #iâdeà
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #iâdeà
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #iâdeà
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #iâdeà
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #iâdeà
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

66 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

67 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

68 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

69 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

74 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

75 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

79 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

80 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

83 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/bits/sched.h

20 #iâdeà
__Ãed_sched·¿m


22 #iâdeà
_SCHED_H


28 
	#SCHED_OTHER
 0

	)

29 
	#SCHED_FIFO
 1

	)

30 
	#SCHED_RR
 2

	)

31 #ifdeà
__USE_GNU


32 
	#SCHED_BATCH
 3

	)

33 
	#SCHED_IDLE
 5

	)

35 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

38 #ifdeà
__USE_GNU


40 
	#CSIGNAL
 0x000000fà

	)

41 
	#CLONE_VM
 0x00000100

	)

42 
	#CLONE_FS
 0x00000200

	)

43 
	#CLONE_FILES
 0x00000400

	)

44 
	#CLONE_SIGHAND
 0x00000800

	)

45 
	#CLONE_PTRACE
 0x00002000

	)

46 
	#CLONE_VFORK
 0x00004000

	)

48 
	#CLONE_PARENT
 0x00008000

	)

50 
	#CLONE_THREAD
 0x00010000

	)

51 
	#CLONE_NEWNS
 0x00020000

	)

52 
	#CLONE_SYSVSEM
 0x00040000

	)

53 
	#CLONE_SETTLS
 0x00080000

	)

54 
	#CLONE_PARENT_SETTID
 0x00100000

	)

56 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

58 
	#CLONE_DETACHED
 0x00400000

	)

59 
	#CLONE_UNTRACED
 0x00800000

	)

61 
	#CLONE_CHILD_SETTID
 0x01000000

	)

63 
	#CLONE_NEWUTS
 0x04000000

	)

64 
	#CLONE_NEWIPC
 0x08000000

	)

65 
	#CLONE_NEWUSER
 0x10000000

	)

66 
	#CLONE_NEWPID
 0x20000000

	)

67 
	#CLONE_NEWNET
 0x40000000

	)

68 
	#CLONE_IO
 0x80000000

	)

72 
	ssched_·¿m


74 
	m__sched_´iÜ™y
;

77 
	g__BEGIN_DECLS


79 #ifdeà
__USE_GNU


81 
şÚe
 ((*
__â
è(*
__¬g
), *
__chd_¡ack
,

82 
__æags
, *
__¬g
, ...è
__THROW
;

85 
	$unsh¬e
 (
__æags
è
__THROW
;

88 
	$sched_g‘ıu
 (è
__THROW
;

91 
	$£Šs
 (
__fd
, 
__n¡y³
è
__THROW
;

95 
__END_DECLS


99 #ià!
defšed
 
__defšed_sched·¿m
 \

100 && (
defšed
 
__Ãed_sched·¿m
 || defšed 
_SCHED_H
)

101 
	#__defšed_sched·¿m
 1

	)

103 
	s__sched_·¿m


105 
__sched_´iÜ™y
;

107 #undeà
__Ãed_sched·¿m


111 #ià
defšed
 
_SCHED_H
 && !defšed 
__ıu_£t_t_defšed


112 
	#__ıu_£t_t_defšed


	)

114 
	#__CPU_SETSIZE
 1024

	)

115 
	#__NCPUBITS
 (8 *  (
__ıu_mask
))

	)

118 
	t__ıu_mask
;

121 
	#__CPUELT
(
ıu
è((ıuè/ 
__NCPUBITS
)

	)

122 
	#__CPUMASK
(
ıu
è((
__ıu_mask
è1 << ((ıuè% 
__NCPUBITS
))

	)

127 
__ıu_mask
 
__b™s
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

128 } 
	tıu_£t_t
;

131 #ià
	`__GNUC_PREREQ
 (2, 91)

132 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

133 dØ
	`__butš_mem£t
 (
ıu£
, '\0', 
£tsize
); 0)

	)

135 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

137 
size_t
 
__i
; \

138 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

139 
__ıu_mask
 *
__b™s
 = (
ıu£
)->__bits; \

140 
__i
 = 0; __˜< 
__imax
; ++__i) \

141 
__b™s
[
__i
] = 0; \

142 
	}
} 0)

	)

144 
	#__CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
) \

145 (
__ex‹nsiÚ__
 \

146 ({ 
size_t
 
__ıu
 = (
ıu
); \

147 
__ıu
 / 8 < (
£tsize
) \

148 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

149 |ğ
	`__CPUMASK
 (
__ıu
)) \

150 : 0; }))

	)

151 
	#__CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
) \

152 (
__ex‹nsiÚ__
 \

153 ({ 
size_t
 
__ıu
 = (
ıu
); \

154 
__ıu
 / 8 < (
£tsize
) \

155 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

156 &ğ~
	`__CPUMASK
 (
__ıu
)) \

157 : 0; }))

	)

158 
	#__CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
) \

159 (
__ex‹nsiÚ__
 \

160 ({ 
size_t
 
__ıu
 = (
ıu
); \

161 
__ıu
 / 8 < (
£tsize
) \

162 ? ((((cÚ¡ 
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

163 & 
	`__CPUMASK
 (
__ıu
))) != 0 \

164 : 0; }))

	)

166 
	#__CPU_COUNT_S
(
£tsize
, 
ıu£
) \

167 
	`__sched_ıucouÁ
 (
£tsize
, 
ıu£
)

	)

169 #ià
__GNUC_PREREQ
 (2, 91)

170 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

171 (
	`__butš_memcmp
 (
ıu£1
, 
ıu£2
, 
£tsize
è=ğ0)

	)

173 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

174 (
__ex‹nsiÚ__
 \

175 ({ cÚ¡ 
__ıu_mask
 *
__¬r1
 = (
ıu£1
)->
__b™s
; \

176 cÚ¡ 
__ıu_mask
 *
__¬r2
 = (
ıu£2
)->
__b™s
; \

177 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

178 
size_t
 
__i
; \

179 
__i
 = 0; __˜< 
__imax
; ++__i) \

180 ià(
__¬r1
[
__i
] !ğ
__¬r2
[__i]) \

182 
__i
 =ğ
__imax
; }))

	)

185 
	#__CPU_OP_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, 
İ
) \

186 (
__ex‹nsiÚ__
 \

187 ({ 
ıu_£t_t
 *
__de¡
 = (
de¡£t
); \

188 cÚ¡ 
__ıu_mask
 *
__¬r1
 = (
¤c£t1
)->
__b™s
; \

189 cÚ¡ 
__ıu_mask
 *
__¬r2
 = (
¤c£t2
)->
__b™s
; \

190 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

191 
size_t
 
__i
; \

192 
__i
 = 0; __˜< 
__imax
; ++__i) \

193 ((
__ıu_mask
 *è
__de¡
->
__b™s
)[
__i
] = 
__¬r1
[__i] 
İ
 
__¬r2
[__i]; \

194 
__de¡
; }))

	)

196 
	#__CPU_ALLOC_SIZE
(
couÁ
) \

197 ((((
couÁ
è+ 
__NCPUBITS
 - 1è/ __NCPUBITSè*  (
__ıu_mask
))

	)

198 
	#__CPU_ALLOC
(
couÁ
è
	`__sched_ıu®loc
 (couÁ)

	)

199 
	#__CPU_FREE
(
ıu£t
è
	`__sched_ıuä“
 (ıu£t)

	)

201 
__BEGIN_DECLS


203 
	$__sched_ıucouÁ
 (
size_t
 
__£tsize
, cÚ¡ 
ıu_£t_t
 *
__£
)

204 
__THROW
;

205 
ıu_£t_t
 *
	$__sched_ıu®loc
 (
size_t
 
__couÁ
è
__THROW
 
__wur
;

206 
	$__sched_ıuä“
 (
ıu_£t_t
 *
__£t
è
__THROW
;

208 
__END_DECLS


	@
1
.
1
/usr/include
847
26574
agentfwd.h
algo.h
atomicio.c
atomicio.h
auth.h
bignum.c
bignum.h
buffer.c
buffer.h
channel.h
chansession.h
circbuffer.c
circbuffer.h
cli-agentfwd.c
cli-algo.c
cli-auth.c
cli-authinteract.c
cli-authpasswd.c
cli-authpubkey.c
cli-channel.c
cli-chansession.c
cli-kex.c
cli-main.c
cli-runopts.c
cli-service.c
cli-session.c
cli-tcpfwd.c
common-algo.c
common-channel.c
common-chansession.c
common-kex.c
common-runopts.c
common-session.c
compat.c
compat.h
config.h
dbmulti.c
dbutil.c
dbutil.h
debug.h
dropbearconvert.c
dropbearkey.c
dss.c
dss.h
fake-rfc2553.c
fake-rfc2553.h
gendss.c
gendss.h
genrsa.c
genrsa.h
includes.h
kex.h
keyimport.c
keyimport.h
libtomcrypt/demos/encrypt.c
libtomcrypt/demos/hashsum.c
libtomcrypt/demos/multi.c
libtomcrypt/demos/small.c
libtomcrypt/demos/test.c
libtomcrypt/demos/timing.c
libtomcrypt/demos/tv_gen.c
libtomcrypt/notes/etc/saferp_optimizer.c
libtomcrypt/notes/etc/whirlgen.c
libtomcrypt/notes/etc/whirltest.c
libtomcrypt/src/ciphers/aes/aes.c
libtomcrypt/src/ciphers/aes/aes_tab.c
libtomcrypt/src/ciphers/anubis.c
libtomcrypt/src/ciphers/blowfish.c
libtomcrypt/src/ciphers/cast5.c
libtomcrypt/src/ciphers/des.c
libtomcrypt/src/ciphers/kasumi.c
libtomcrypt/src/ciphers/khazad.c
libtomcrypt/src/ciphers/kseed.c
libtomcrypt/src/ciphers/noekeon.c
libtomcrypt/src/ciphers/rc2.c
libtomcrypt/src/ciphers/rc5.c
libtomcrypt/src/ciphers/rc6.c
libtomcrypt/src/ciphers/safer/safer.c
libtomcrypt/src/ciphers/safer/safer_tab.c
libtomcrypt/src/ciphers/safer/saferp.c
libtomcrypt/src/ciphers/skipjack.c
libtomcrypt/src/ciphers/twofish/twofish.c
libtomcrypt/src/ciphers/twofish/twofish_tab.c
libtomcrypt/src/ciphers/xtea.c
libtomcrypt/src/encauth/ccm/ccm_memory.c
libtomcrypt/src/encauth/ccm/ccm_test.c
libtomcrypt/src/encauth/eax/eax_addheader.c
libtomcrypt/src/encauth/eax/eax_decrypt.c
libtomcrypt/src/encauth/eax/eax_decrypt_verify_memory.c
libtomcrypt/src/encauth/eax/eax_done.c
libtomcrypt/src/encauth/eax/eax_encrypt.c
libtomcrypt/src/encauth/eax/eax_encrypt_authenticate_memory.c
libtomcrypt/src/encauth/eax/eax_init.c
libtomcrypt/src/encauth/eax/eax_test.c
libtomcrypt/src/encauth/gcm/gcm_add_aad.c
libtomcrypt/src/encauth/gcm/gcm_add_iv.c
libtomcrypt/src/encauth/gcm/gcm_done.c
libtomcrypt/src/encauth/gcm/gcm_gf_mult.c
libtomcrypt/src/encauth/gcm/gcm_init.c
libtomcrypt/src/encauth/gcm/gcm_memory.c
libtomcrypt/src/encauth/gcm/gcm_mult_h.c
libtomcrypt/src/encauth/gcm/gcm_process.c
libtomcrypt/src/encauth/gcm/gcm_reset.c
libtomcrypt/src/encauth/gcm/gcm_test.c
libtomcrypt/src/encauth/ocb/ocb_decrypt.c
libtomcrypt/src/encauth/ocb/ocb_decrypt_verify_memory.c
libtomcrypt/src/encauth/ocb/ocb_done_decrypt.c
libtomcrypt/src/encauth/ocb/ocb_done_encrypt.c
libtomcrypt/src/encauth/ocb/ocb_encrypt.c
libtomcrypt/src/encauth/ocb/ocb_encrypt_authenticate_memory.c
libtomcrypt/src/encauth/ocb/ocb_init.c
libtomcrypt/src/encauth/ocb/ocb_ntz.c
libtomcrypt/src/encauth/ocb/ocb_shift_xor.c
libtomcrypt/src/encauth/ocb/ocb_test.c
libtomcrypt/src/encauth/ocb/s_ocb_done.c
libtomcrypt/src/hashes/chc/chc.c
libtomcrypt/src/hashes/helper/hash_file.c
libtomcrypt/src/hashes/helper/hash_filehandle.c
libtomcrypt/src/hashes/helper/hash_memory.c
libtomcrypt/src/hashes/helper/hash_memory_multi.c
libtomcrypt/src/hashes/md2.c
libtomcrypt/src/hashes/md4.c
libtomcrypt/src/hashes/md5.c
libtomcrypt/src/hashes/rmd128.c
libtomcrypt/src/hashes/rmd160.c
libtomcrypt/src/hashes/rmd256.c
libtomcrypt/src/hashes/rmd320.c
libtomcrypt/src/hashes/sha1.c
libtomcrypt/src/hashes/sha2/sha224.c
libtomcrypt/src/hashes/sha2/sha256.c
libtomcrypt/src/hashes/sha2/sha384.c
libtomcrypt/src/hashes/sha2/sha512.c
libtomcrypt/src/hashes/tiger.c
libtomcrypt/src/hashes/whirl/whirl.c
libtomcrypt/src/hashes/whirl/whirltab.c
libtomcrypt/src/headers/tomcrypt.h
libtomcrypt/src/headers/tomcrypt_argchk.h
libtomcrypt/src/headers/tomcrypt_cfg.h
libtomcrypt/src/headers/tomcrypt_cipher.h
libtomcrypt/src/headers/tomcrypt_custom.h
libtomcrypt/src/headers/tomcrypt_hash.h
libtomcrypt/src/headers/tomcrypt_mac.h
libtomcrypt/src/headers/tomcrypt_macros.h
libtomcrypt/src/headers/tomcrypt_math.h
libtomcrypt/src/headers/tomcrypt_misc.h
libtomcrypt/src/headers/tomcrypt_pk.h
libtomcrypt/src/headers/tomcrypt_pkcs.h
libtomcrypt/src/headers/tomcrypt_prng.h
libtomcrypt/src/mac/f9/f9_done.c
libtomcrypt/src/mac/f9/f9_file.c
libtomcrypt/src/mac/f9/f9_init.c
libtomcrypt/src/mac/f9/f9_memory.c
libtomcrypt/src/mac/f9/f9_memory_multi.c
libtomcrypt/src/mac/f9/f9_process.c
libtomcrypt/src/mac/f9/f9_test.c
libtomcrypt/src/mac/hmac/hmac_done.c
libtomcrypt/src/mac/hmac/hmac_file.c
libtomcrypt/src/mac/hmac/hmac_init.c
libtomcrypt/src/mac/hmac/hmac_memory.c
libtomcrypt/src/mac/hmac/hmac_memory_multi.c
libtomcrypt/src/mac/hmac/hmac_process.c
libtomcrypt/src/mac/hmac/hmac_test.c
libtomcrypt/src/mac/omac/omac_done.c
libtomcrypt/src/mac/omac/omac_file.c
libtomcrypt/src/mac/omac/omac_init.c
libtomcrypt/src/mac/omac/omac_memory.c
libtomcrypt/src/mac/omac/omac_memory_multi.c
libtomcrypt/src/mac/omac/omac_process.c
libtomcrypt/src/mac/omac/omac_test.c
libtomcrypt/src/mac/pelican/pelican.c
libtomcrypt/src/mac/pelican/pelican_memory.c
libtomcrypt/src/mac/pelican/pelican_test.c
libtomcrypt/src/mac/pmac/pmac_done.c
libtomcrypt/src/mac/pmac/pmac_file.c
libtomcrypt/src/mac/pmac/pmac_init.c
libtomcrypt/src/mac/pmac/pmac_memory.c
libtomcrypt/src/mac/pmac/pmac_memory_multi.c
libtomcrypt/src/mac/pmac/pmac_ntz.c
libtomcrypt/src/mac/pmac/pmac_process.c
libtomcrypt/src/mac/pmac/pmac_shift_xor.c
libtomcrypt/src/mac/pmac/pmac_test.c
libtomcrypt/src/mac/xcbc/xcbc_done.c
libtomcrypt/src/mac/xcbc/xcbc_file.c
libtomcrypt/src/mac/xcbc/xcbc_init.c
libtomcrypt/src/mac/xcbc/xcbc_memory.c
libtomcrypt/src/mac/xcbc/xcbc_memory_multi.c
libtomcrypt/src/mac/xcbc/xcbc_process.c
libtomcrypt/src/mac/xcbc/xcbc_test.c
libtomcrypt/src/math/fp/ltc_ecc_fp_mulmod.c
libtomcrypt/src/math/gmp_desc.c
libtomcrypt/src/math/ltm_desc.c
libtomcrypt/src/math/multi.c
libtomcrypt/src/math/rand_prime.c
libtomcrypt/src/math/tfm_desc.c
libtomcrypt/src/misc/base64/base64_decode.c
libtomcrypt/src/misc/base64/base64_encode.c
libtomcrypt/src/misc/burn_stack.c
libtomcrypt/src/misc/crypt/crypt.c
libtomcrypt/src/misc/crypt/crypt_argchk.c
libtomcrypt/src/misc/crypt/crypt_cipher_descriptor.c
libtomcrypt/src/misc/crypt/crypt_cipher_is_valid.c
libtomcrypt/src/misc/crypt/crypt_find_cipher.c
libtomcrypt/src/misc/crypt/crypt_find_cipher_any.c
libtomcrypt/src/misc/crypt/crypt_find_cipher_id.c
libtomcrypt/src/misc/crypt/crypt_find_hash.c
libtomcrypt/src/misc/crypt/crypt_find_hash_any.c
libtomcrypt/src/misc/crypt/crypt_find_hash_id.c
libtomcrypt/src/misc/crypt/crypt_find_hash_oid.c
libtomcrypt/src/misc/crypt/crypt_find_prng.c
libtomcrypt/src/misc/crypt/crypt_fsa.c
libtomcrypt/src/misc/crypt/crypt_hash_descriptor.c
libtomcrypt/src/misc/crypt/crypt_hash_is_valid.c
libtomcrypt/src/misc/crypt/crypt_ltc_mp_descriptor.c
libtomcrypt/src/misc/crypt/crypt_prng_descriptor.c
libtomcrypt/src/misc/crypt/crypt_prng_is_valid.c
libtomcrypt/src/misc/crypt/crypt_register_cipher.c
libtomcrypt/src/misc/crypt/crypt_register_hash.c
libtomcrypt/src/misc/crypt/crypt_register_prng.c
libtomcrypt/src/misc/crypt/crypt_unregister_cipher.c
libtomcrypt/src/misc/crypt/crypt_unregister_hash.c
libtomcrypt/src/misc/crypt/crypt_unregister_prng.c
libtomcrypt/src/misc/error_to_string.c
libtomcrypt/src/misc/pkcs5/pkcs_5_1.c
libtomcrypt/src/misc/pkcs5/pkcs_5_2.c
libtomcrypt/src/misc/zeromem.c
libtomcrypt/src/modes/cbc/cbc_decrypt.c
libtomcrypt/src/modes/cbc/cbc_done.c
libtomcrypt/src/modes/cbc/cbc_encrypt.c
libtomcrypt/src/modes/cbc/cbc_getiv.c
libtomcrypt/src/modes/cbc/cbc_setiv.c
libtomcrypt/src/modes/cbc/cbc_start.c
libtomcrypt/src/modes/cfb/cfb_decrypt.c
libtomcrypt/src/modes/cfb/cfb_done.c
libtomcrypt/src/modes/cfb/cfb_encrypt.c
libtomcrypt/src/modes/cfb/cfb_getiv.c
libtomcrypt/src/modes/cfb/cfb_setiv.c
libtomcrypt/src/modes/cfb/cfb_start.c
libtomcrypt/src/modes/ctr/ctr_decrypt.c
libtomcrypt/src/modes/ctr/ctr_done.c
libtomcrypt/src/modes/ctr/ctr_encrypt.c
libtomcrypt/src/modes/ctr/ctr_getiv.c
libtomcrypt/src/modes/ctr/ctr_setiv.c
libtomcrypt/src/modes/ctr/ctr_start.c
libtomcrypt/src/modes/ctr/ctr_test.c
libtomcrypt/src/modes/ecb/ecb_decrypt.c
libtomcrypt/src/modes/ecb/ecb_done.c
libtomcrypt/src/modes/ecb/ecb_encrypt.c
libtomcrypt/src/modes/ecb/ecb_start.c
libtomcrypt/src/modes/f8/f8_decrypt.c
libtomcrypt/src/modes/f8/f8_done.c
libtomcrypt/src/modes/f8/f8_encrypt.c
libtomcrypt/src/modes/f8/f8_getiv.c
libtomcrypt/src/modes/f8/f8_setiv.c
libtomcrypt/src/modes/f8/f8_start.c
libtomcrypt/src/modes/f8/f8_test_mode.c
libtomcrypt/src/modes/lrw/lrw_decrypt.c
libtomcrypt/src/modes/lrw/lrw_done.c
libtomcrypt/src/modes/lrw/lrw_encrypt.c
libtomcrypt/src/modes/lrw/lrw_getiv.c
libtomcrypt/src/modes/lrw/lrw_process.c
libtomcrypt/src/modes/lrw/lrw_setiv.c
libtomcrypt/src/modes/lrw/lrw_start.c
libtomcrypt/src/modes/lrw/lrw_test.c
libtomcrypt/src/modes/ofb/ofb_decrypt.c
libtomcrypt/src/modes/ofb/ofb_done.c
libtomcrypt/src/modes/ofb/ofb_encrypt.c
libtomcrypt/src/modes/ofb/ofb_getiv.c
libtomcrypt/src/modes/ofb/ofb_setiv.c
libtomcrypt/src/modes/ofb/ofb_start.c
libtomcrypt/src/pk/asn1/der/bit/der_decode_bit_string.c
libtomcrypt/src/pk/asn1/der/bit/der_encode_bit_string.c
libtomcrypt/src/pk/asn1/der/bit/der_length_bit_string.c
libtomcrypt/src/pk/asn1/der/boolean/der_decode_boolean.c
libtomcrypt/src/pk/asn1/der/boolean/der_encode_boolean.c
libtomcrypt/src/pk/asn1/der/boolean/der_length_boolean.c
libtomcrypt/src/pk/asn1/der/choice/der_decode_choice.c
libtomcrypt/src/pk/asn1/der/ia5/der_decode_ia5_string.c
libtomcrypt/src/pk/asn1/der/ia5/der_encode_ia5_string.c
libtomcrypt/src/pk/asn1/der/ia5/der_length_ia5_string.c
libtomcrypt/src/pk/asn1/der/integer/der_decode_integer.c
libtomcrypt/src/pk/asn1/der/integer/der_encode_integer.c
libtomcrypt/src/pk/asn1/der/integer/der_length_integer.c
libtomcrypt/src/pk/asn1/der/object_identifier/der_decode_object_identifier.c
libtomcrypt/src/pk/asn1/der/object_identifier/der_encode_object_identifier.c
libtomcrypt/src/pk/asn1/der/object_identifier/der_length_object_identifier.c
libtomcrypt/src/pk/asn1/der/octet/der_decode_octet_string.c
libtomcrypt/src/pk/asn1/der/octet/der_encode_octet_string.c
libtomcrypt/src/pk/asn1/der/octet/der_length_octet_string.c
libtomcrypt/src/pk/asn1/der/printable_string/der_decode_printable_string.c
libtomcrypt/src/pk/asn1/der/printable_string/der_encode_printable_string.c
libtomcrypt/src/pk/asn1/der/printable_string/der_length_printable_string.c
libtomcrypt/src/pk/asn1/der/sequence/der_decode_sequence_ex.c
libtomcrypt/src/pk/asn1/der/sequence/der_decode_sequence_flexi.c
libtomcrypt/src/pk/asn1/der/sequence/der_decode_sequence_multi.c
libtomcrypt/src/pk/asn1/der/sequence/der_encode_sequence_ex.c
libtomcrypt/src/pk/asn1/der/sequence/der_encode_sequence_multi.c
libtomcrypt/src/pk/asn1/der/sequence/der_length_sequence.c
libtomcrypt/src/pk/asn1/der/sequence/der_sequence_free.c
libtomcrypt/src/pk/asn1/der/set/der_encode_set.c
libtomcrypt/src/pk/asn1/der/set/der_encode_setof.c
libtomcrypt/src/pk/asn1/der/short_integer/der_decode_short_integer.c
libtomcrypt/src/pk/asn1/der/short_integer/der_encode_short_integer.c
libtomcrypt/src/pk/asn1/der/short_integer/der_length_short_integer.c
libtomcrypt/src/pk/asn1/der/utctime/der_decode_utctime.c
libtomcrypt/src/pk/asn1/der/utctime/der_encode_utctime.c
libtomcrypt/src/pk/asn1/der/utctime/der_length_utctime.c
libtomcrypt/src/pk/asn1/der/utf8/der_decode_utf8_string.c
libtomcrypt/src/pk/asn1/der/utf8/der_encode_utf8_string.c
libtomcrypt/src/pk/asn1/der/utf8/der_length_utf8_string.c
libtomcrypt/src/pk/dsa/dsa_decrypt_key.c
libtomcrypt/src/pk/dsa/dsa_encrypt_key.c
libtomcrypt/src/pk/dsa/dsa_export.c
libtomcrypt/src/pk/dsa/dsa_free.c
libtomcrypt/src/pk/dsa/dsa_import.c
libtomcrypt/src/pk/dsa/dsa_make_key.c
libtomcrypt/src/pk/dsa/dsa_shared_secret.c
libtomcrypt/src/pk/dsa/dsa_sign_hash.c
libtomcrypt/src/pk/dsa/dsa_verify_hash.c
libtomcrypt/src/pk/dsa/dsa_verify_key.c
libtomcrypt/src/pk/ecc/ecc.c
libtomcrypt/src/pk/ecc/ecc_ansi_x963_export.c
libtomcrypt/src/pk/ecc/ecc_ansi_x963_import.c
libtomcrypt/src/pk/ecc/ecc_decrypt_key.c
libtomcrypt/src/pk/ecc/ecc_encrypt_key.c
libtomcrypt/src/pk/ecc/ecc_export.c
libtomcrypt/src/pk/ecc/ecc_free.c
libtomcrypt/src/pk/ecc/ecc_get_size.c
libtomcrypt/src/pk/ecc/ecc_import.c
libtomcrypt/src/pk/ecc/ecc_make_key.c
libtomcrypt/src/pk/ecc/ecc_shared_secret.c
libtomcrypt/src/pk/ecc/ecc_sign_hash.c
libtomcrypt/src/pk/ecc/ecc_sizes.c
libtomcrypt/src/pk/ecc/ecc_test.c
libtomcrypt/src/pk/ecc/ecc_verify_hash.c
libtomcrypt/src/pk/ecc/ltc_ecc_is_valid_idx.c
libtomcrypt/src/pk/ecc/ltc_ecc_map.c
libtomcrypt/src/pk/ecc/ltc_ecc_mul2add.c
libtomcrypt/src/pk/ecc/ltc_ecc_mulmod.c
libtomcrypt/src/pk/ecc/ltc_ecc_mulmod_timing.c
libtomcrypt/src/pk/ecc/ltc_ecc_points.c
libtomcrypt/src/pk/ecc/ltc_ecc_projective_add_point.c
libtomcrypt/src/pk/ecc/ltc_ecc_projective_dbl_point.c
libtomcrypt/src/pk/katja/katja_decrypt_key.c
libtomcrypt/src/pk/katja/katja_encrypt_key.c
libtomcrypt/src/pk/katja/katja_export.c
libtomcrypt/src/pk/katja/katja_exptmod.c
libtomcrypt/src/pk/katja/katja_free.c
libtomcrypt/src/pk/katja/katja_import.c
libtomcrypt/src/pk/katja/katja_make_key.c
libtomcrypt/src/pk/pkcs1/pkcs_1_i2osp.c
libtomcrypt/src/pk/pkcs1/pkcs_1_mgf1.c
libtomcrypt/src/pk/pkcs1/pkcs_1_oaep_decode.c
libtomcrypt/src/pk/pkcs1/pkcs_1_oaep_encode.c
libtomcrypt/src/pk/pkcs1/pkcs_1_os2ip.c
libtomcrypt/src/pk/pkcs1/pkcs_1_pss_decode.c
libtomcrypt/src/pk/pkcs1/pkcs_1_pss_encode.c
libtomcrypt/src/pk/pkcs1/pkcs_1_v1_5_decode.c
libtomcrypt/src/pk/pkcs1/pkcs_1_v1_5_encode.c
libtomcrypt/src/pk/rsa/rsa_decrypt_key.c
libtomcrypt/src/pk/rsa/rsa_encrypt_key.c
libtomcrypt/src/pk/rsa/rsa_export.c
libtomcrypt/src/pk/rsa/rsa_exptmod.c
libtomcrypt/src/pk/rsa/rsa_free.c
libtomcrypt/src/pk/rsa/rsa_import.c
libtomcrypt/src/pk/rsa/rsa_make_key.c
libtomcrypt/src/pk/rsa/rsa_sign_hash.c
libtomcrypt/src/pk/rsa/rsa_verify_hash.c
libtomcrypt/src/prngs/fortuna.c
libtomcrypt/src/prngs/rc4.c
libtomcrypt/src/prngs/rng_get_bytes.c
libtomcrypt/src/prngs/rng_make_prng.c
libtomcrypt/src/prngs/sober128.c
libtomcrypt/src/prngs/sober128tab.c
libtomcrypt/src/prngs/sprng.c
libtomcrypt/src/prngs/yarrow.c
libtomcrypt/testprof/base64_test.c
libtomcrypt/testprof/cipher_hash_test.c
libtomcrypt/testprof/der_tests.c
libtomcrypt/testprof/dsa_test.c
libtomcrypt/testprof/ecc_test.c
libtomcrypt/testprof/katja_test.c
libtomcrypt/testprof/mac_test.c
libtomcrypt/testprof/modes_test.c
libtomcrypt/testprof/pkcs_1_test.c
libtomcrypt/testprof/rsa_test.c
libtomcrypt/testprof/store_test.c
libtomcrypt/testprof/test_driver.c
libtomcrypt/testprof/tomcrypt_test.h
libtomcrypt/testprof/x86_prof.c
libtommath/bn_error.c
libtommath/bn_fast_mp_invmod.c
libtommath/bn_fast_mp_montgomery_reduce.c
libtommath/bn_fast_s_mp_mul_digs.c
libtommath/bn_fast_s_mp_mul_high_digs.c
libtommath/bn_fast_s_mp_sqr.c
libtommath/bn_mp_2expt.c
libtommath/bn_mp_abs.c
libtommath/bn_mp_add.c
libtommath/bn_mp_add_d.c
libtommath/bn_mp_addmod.c
libtommath/bn_mp_and.c
libtommath/bn_mp_clamp.c
libtommath/bn_mp_clear.c
libtommath/bn_mp_clear_multi.c
libtommath/bn_mp_cmp.c
libtommath/bn_mp_cmp_d.c
libtommath/bn_mp_cmp_mag.c
libtommath/bn_mp_cnt_lsb.c
libtommath/bn_mp_copy.c
libtommath/bn_mp_count_bits.c
libtommath/bn_mp_div.c
libtommath/bn_mp_div_2.c
libtommath/bn_mp_div_2d.c
libtommath/bn_mp_div_3.c
libtommath/bn_mp_div_d.c
libtommath/bn_mp_dr_is_modulus.c
libtommath/bn_mp_dr_reduce.c
libtommath/bn_mp_dr_setup.c
libtommath/bn_mp_exch.c
libtommath/bn_mp_expt_d.c
libtommath/bn_mp_exptmod.c
libtommath/bn_mp_exptmod_fast.c
libtommath/bn_mp_exteuclid.c
libtommath/bn_mp_fread.c
libtommath/bn_mp_fwrite.c
libtommath/bn_mp_gcd.c
libtommath/bn_mp_get_int.c
libtommath/bn_mp_grow.c
libtommath/bn_mp_init.c
libtommath/bn_mp_init_copy.c
libtommath/bn_mp_init_multi.c
libtommath/bn_mp_init_set.c
libtommath/bn_mp_init_set_int.c
libtommath/bn_mp_init_size.c
libtommath/bn_mp_invmod.c
libtommath/bn_mp_invmod_slow.c
libtommath/bn_mp_is_square.c
libtommath/bn_mp_jacobi.c
libtommath/bn_mp_karatsuba_mul.c
libtommath/bn_mp_karatsuba_sqr.c
libtommath/bn_mp_lcm.c
libtommath/bn_mp_lshd.c
libtommath/bn_mp_mod.c
libtommath/bn_mp_mod_2d.c
libtommath/bn_mp_mod_d.c
libtommath/bn_mp_montgomery_calc_normalization.c
libtommath/bn_mp_montgomery_reduce.c
libtommath/bn_mp_montgomery_setup.c
libtommath/bn_mp_mul.c
libtommath/bn_mp_mul_2.c
libtommath/bn_mp_mul_2d.c
libtommath/bn_mp_mul_d.c
libtommath/bn_mp_mulmod.c
libtommath/bn_mp_n_root.c
libtommath/bn_mp_neg.c
libtommath/bn_mp_or.c
libtommath/bn_mp_prime_fermat.c
libtommath/bn_mp_prime_is_divisible.c
libtommath/bn_mp_prime_is_prime.c
libtommath/bn_mp_prime_miller_rabin.c
libtommath/bn_mp_prime_next_prime.c
libtommath/bn_mp_prime_rabin_miller_trials.c
libtommath/bn_mp_prime_random_ex.c
libtommath/bn_mp_radix_size.c
libtommath/bn_mp_radix_smap.c
libtommath/bn_mp_rand.c
libtommath/bn_mp_read_radix.c
libtommath/bn_mp_read_signed_bin.c
libtommath/bn_mp_read_unsigned_bin.c
libtommath/bn_mp_reduce.c
libtommath/bn_mp_reduce_2k.c
libtommath/bn_mp_reduce_2k_l.c
libtommath/bn_mp_reduce_2k_setup.c
libtommath/bn_mp_reduce_2k_setup_l.c
libtommath/bn_mp_reduce_is_2k.c
libtommath/bn_mp_reduce_is_2k_l.c
libtommath/bn_mp_reduce_setup.c
libtommath/bn_mp_rshd.c
libtommath/bn_mp_set.c
libtommath/bn_mp_set_int.c
libtommath/bn_mp_shrink.c
libtommath/bn_mp_signed_bin_size.c
libtommath/bn_mp_sqr.c
libtommath/bn_mp_sqrmod.c
libtommath/bn_mp_sqrt.c
libtommath/bn_mp_sub.c
libtommath/bn_mp_sub_d.c
libtommath/bn_mp_submod.c
libtommath/bn_mp_to_signed_bin.c
libtommath/bn_mp_to_signed_bin_n.c
libtommath/bn_mp_to_unsigned_bin.c
libtommath/bn_mp_to_unsigned_bin_n.c
libtommath/bn_mp_toom_mul.c
libtommath/bn_mp_toom_sqr.c
libtommath/bn_mp_toradix.c
libtommath/bn_mp_toradix_n.c
libtommath/bn_mp_unsigned_bin_size.c
libtommath/bn_mp_xor.c
libtommath/bn_mp_zero.c
libtommath/bn_prime_tab.c
libtommath/bn_reverse.c
libtommath/bn_s_mp_add.c
libtommath/bn_s_mp_exptmod.c
libtommath/bn_s_mp_mul_digs.c
libtommath/bn_s_mp_mul_high_digs.c
libtommath/bn_s_mp_sqr.c
libtommath/bn_s_mp_sub.c
libtommath/bncore.c
libtommath/demo/demo.c
libtommath/demo/timing.c
libtommath/etc/2kprime.c
libtommath/etc/drprime.c
libtommath/etc/mersenne.c
libtommath/etc/mont.c
libtommath/etc/pprime.c
libtommath/etc/tune.c
libtommath/mtest/logtab.h
libtommath/mtest/mpi-config.h
libtommath/mtest/mpi-types.h
libtommath/mtest/mpi.c
libtommath/mtest/mpi.h
libtommath/mtest/mtest.c
libtommath/pre_gen/mpi.c
libtommath/tommath.h
libtommath/tommath_class.h
libtommath/tommath_superclass.h
list.c
list.h
listener.c
listener.h
loginrec.c
loginrec.h
netbsd_getpass.c
options.h
packet.c
packet.h
process-packet.c
progressmeter.c
progressmeter.h
queue.c
queue.h
random.c
random.h
rsa.c
rsa.h
runopts.h
scp.c
scpmisc.c
scpmisc.h
service.h
session.h
sftp-server/addrmatch.c
sftp-server/bufaux.c
sftp-server/buffer.c
sftp-server/buffer.h
sftp-server/channels.h
sftp-server/compat.c
sftp-server/compat.h
sftp-server/config.h
sftp-server/defines.h
sftp-server/entropy.h
sftp-server/includes.h
sftp-server/log.c
sftp-server/log.h
sftp-server/match.c
sftp-server/match.h
sftp-server/misc.c
sftp-server/misc.h
sftp-server/openbsd-compat/base64.h
sftp-server/openbsd-compat/bsd-cray.h
sftp-server/openbsd-compat/bsd-cygwin_util.h
sftp-server/openbsd-compat/bsd-misc.c
sftp-server/openbsd-compat/bsd-misc.h
sftp-server/openbsd-compat/bsd-nextstep.h
sftp-server/openbsd-compat/bsd-poll.h
sftp-server/openbsd-compat/bsd-statvfs.c
sftp-server/openbsd-compat/bsd-statvfs.h
sftp-server/openbsd-compat/bsd-waitpid.h
sftp-server/openbsd-compat/fake-rfc2553.h
sftp-server/openbsd-compat/fmt_scaled.c
sftp-server/openbsd-compat/getopt.c
sftp-server/openbsd-compat/getrrsetbyname.h
sftp-server/openbsd-compat/glob.h
sftp-server/openbsd-compat/openbsd-compat.h
sftp-server/openbsd-compat/port-aix.h
sftp-server/openbsd-compat/port-irix.h
sftp-server/openbsd-compat/port-linux.h
sftp-server/openbsd-compat/port-solaris.h
sftp-server/openbsd-compat/port-tun.c
sftp-server/openbsd-compat/port-tun.h
sftp-server/openbsd-compat/port-uw.h
sftp-server/openbsd-compat/pwcache.c
sftp-server/openbsd-compat/readpassphrase.h
sftp-server/openbsd-compat/sha2.h
sftp-server/openbsd-compat/sigact.h
sftp-server/openbsd-compat/strmode.c
sftp-server/openbsd-compat/strtonum.c
sftp-server/openbsd-compat/sys-queue.h
sftp-server/openbsd-compat/vis.c
sftp-server/openbsd-compat/vis.h
sftp-server/openssl/bn.h
sftp-server/openssl/opensslv.h
sftp-server/packet.h
sftp-server/platform.h
sftp-server/sftp-client.h
sftp-server/sftp-common.c
sftp-server/sftp-common.h
sftp-server/sftp-server-main.c
sftp-server/sftp-server.c
sftp-server/sftp.h
sftp-server/ssh.h
sftp-server/uidswap.h
sftp-server/xmalloc.c
sftp-server/xmalloc.h
signkey.c
signkey.h
ssh.h
sshpty.c
sshpty.h
svr-agentfwd.c
svr-algo.c
svr-auth.c
svr-authpam.c
svr-authpasswd.c
svr-authpubkey.c
svr-authpubkeyoptions.c
svr-chansession.c
svr-kex.c
svr-main.c
svr-runopts.c
svr-service.c
svr-session.c
svr-tcpfwd.c
svr-x11fwd.c
sysoptions.h
tcp-accept.c
tcpfwd.h
termcodes.c
termcodes.h
x11fwd.h
/usr/include/arpa/inet.h
/usr/include/arpa/nameser.h
/usr/include/assert.h
/usr/include/crypt.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/glob.h
/usr/include/grp.h
/usr/include/inttypes.h
/usr/include/lastlog.h
/usr/include/libgen.h
/usr/include/limits.h
/usr/include/linux/if.h
/usr/include/linux/if_tun.h
/usr/include/math.h
/usr/include/net/if.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/in_systm.h
/usr/include/netinet/ip.h
/usr/include/netinet/tcp.h
/usr/include/paths.h
/usr/include/pty.h
/usr/include/pwd.h
/usr/include/resolv.h
/usr/include/rpc/types.h
/usr/include/shadow.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/stropts.h
/usr/include/sys/bitypes.h
/usr/include/sys/cdefs.h
/usr/include/sys/dir.h
/usr/include/sys/ioctl.h
/usr/include/sys/mman.h
/usr/include/sys/mount.h
/usr/include/sys/param.h
/usr/include/sys/resource.h
/usr/include/sys/select.h
/usr/include/sys/socket.h
/usr/include/sys/stat.h
/usr/include/sys/statfs.h
/usr/include/sys/statvfs.h
/usr/include/sys/syslog.h
/usr/include/sys/sysmacros.h
/usr/include/sys/time.h
/usr/include/sys/types.h
/usr/include/sys/uio.h
/usr/include/sys/un.h
/usr/include/sys/wait.h
/usr/include/syslog.h
/usr/include/termios.h
/usr/include/time.h
/usr/include/ttyent.h
/usr/include/unistd.h
/usr/include/utime.h
/usr/include/utmp.h
/usr/include/utmpx.h
/usr/include/wchar.h
/usr/include/zlib.h
/usr/include/alloca.h
/usr/include/arpa/nameser_compat.h
/usr/include/bits/byteswap.h
/usr/include/bits/confname.h
/usr/include/bits/dirent.h
/usr/include/bits/endian.h
/usr/include/bits/environments.h
/usr/include/bits/errno.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/huge_val.h
/usr/include/bits/huge_valf.h
/usr/include/bits/huge_vall.h
/usr/include/bits/in.h
/usr/include/bits/inf.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/math-finite.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathdef.h
/usr/include/bits/mathinline.h
/usr/include/bits/mman.h
/usr/include/bits/nan.h
/usr/include/bits/netdb.h
/usr/include/bits/param.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/resource.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigset.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/stat.h
/usr/include/bits/statfs.h
/usr/include/bits/statvfs.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-bsearch.h
/usr/include/bits/stdlib-float.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/stropts.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/syslog-ldbl.h
/usr/include/bits/syslog-path.h
/usr/include/bits/syslog.h
/usr/include/bits/termios.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/uio.h
/usr/include/bits/unistd.h
/usr/include/bits/utmp.h
/usr/include/bits/utmpx.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar.h
/usr/include/bits/wchar2.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/bits/xtitypes.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/linux/filter.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_ether.h
/usr/include/linux/socket.h
/usr/include/linux/types.h
/usr/include/rpc/netdb.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/ucontext.h
/usr/include/wctype.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/asm/ioctls.h
/usr/include/asm/socket.h
/usr/include/asm/types.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/fcntl-linux.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/local_lim.h
/usr/include/bits/mman-linux.h
/usr/include/bits/socket_type.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/timex.h
/usr/include/bits/typesizes.h
/usr/include/gnu/stubs.h
/usr/include/linux/errno.h
/usr/include/linux/limits.h
/usr/include/linux/param.h
/usr/include/linux/posix_types.h
/usr/include/stdc-predef.h
/usr/include/asm-generic/ioctls.h
/usr/include/asm-generic/socket.h
/usr/include/asm-generic/types.h
/usr/include/asm/errno.h
/usr/include/asm/param.h
/usr/include/asm/posix_types.h
/usr/include/bits/libc-lock.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/gnu/stubs-x32.h
/usr/include/linux/stddef.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/param.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/asm/sockios.h
/usr/include/gnu/option-groups.h
/usr/include/linux/ioctl.h
/usr/include/pthread.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm-generic/sockios.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/ioctl.h
/usr/include/bits/setjmp.h
/usr/include/sched.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/asm-generic/ioctl.h
/usr/include/bits/sched.h
